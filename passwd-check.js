/*!
 * jQuery JavaScript Library v1.10.1
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-05-30T21:49Z
 */
function BluespotDrawer(e) {
    var t = this;
    this.controls = {}, this.dragControls = [], this.isRadiusEnabled = !1, this.isIdPopupsEnabled = !1, this.resetActionPanel = function () {
        this.actionPanel && _.each(this.actionPanel.buttons, function (e) {
            e.isPressed = !1, e.refresh()
        })
    }, this.setRadiusEnabled = function (e) {
        this.isRadiusEnabled = e, e ? this.showRadius() : this.hideRadius()
    }, this.setIdPopupsEnabled = function (e) {
        this.isIdPopupsEnabled = e, this.showIdPopups()
    }, this.onKeyDown = function (e) {
        switch (e.keyCode) {
            case 27:
                t.currentControl && t.reset()
        }
    }, this.init = function (e) {
        this.site = e, this.map = e.psMap.map;
        var t = e.buildings.find(function (e) {
            return e.id === currentBuilding.id
        });
        this.layers = $.map(t.floors, function (e) {
            return e.bluespotLayer
        }), this.listeners = [], this.addControls()
    }, this._onModelEvent = function (e, t) {
        var i;
        currentBluespotDrawer.layers.some(function (e) {
            return i = e.getFeaturesByAttribute("bluespotId", t.id)[0], null != i
        });
        var n = !1;
        switch (currentBluespotDrawer.layers.some(function (e) {
            return n = -1 != e.selectedFeatures.indexOf(i)
        }), e) {
            case"selected":
                n || currentBluespotDrawer.controls.select.select(i);
                break;
            case"unselected":
                n && currentBluespotDrawer.controls.select.unselect(i)
        }
    }, this.disableControls = function () {
        if (this.controls)for (var e in this.controls) {
            var t = this.controls[e];
            t.deactivate()
        }
    }, this.toggleMultiselectBox = function (e) {
        e ? (this.controls.select.deactivate(), this.setControlsFloor(t.floor), this.controls.multiselect.activate(), this.currentControl = "multiselect") : (this.controls.multiselect.deactivate(), this.setControlsFloor(t.floor), this.controls.select.activate(), this.currentControl = "select"), this.controls.hiddenselect.unselectAll()
    }, this.setControlsFloor = function (e) {
        this.controls.point.layer = e.bluespotLayer;
        var t = this.layers.indexOf(e.bluespotLayer);
        null == this.dragControls[t] && (this.dragControls[t] = new OpenLayers.Control.DragFeature(e.bluespotLayer, {
            onComplete: function (e) {
                var t = allBluespots[e.attributes.bluespotId];
                t && t.redrawRadius()
            }
        }), this.map.addControl(this.dragControls[t])), this.controls.drag = this.dragControls[t], [this.controls.multiselect, this.controls.select].forEach(function (t) {
            t.layers && (t.layer.destroy(), t.layers = null), t.initLayer(e.bluespotLayer), t.handlers.feature.layer = t.layer
        })
    }, this.addControls = function () {
        this.keyboardHandler || (this.keyboardHandler = new OpenLayers.Handler.Keyboard({
            setMap: function () {
            }
        }, {keydown: this.onKeyDown}), this.keyboardHandler.activate()), this.controls = {}, this.controls.point = new OpenLayers.Control.DrawFeature(this.layers[0], OpenLayers.Handler.Point), this.controls.hiddenselect = new OpenLayers.Control.SelectFeature(this.layers), this.controls.select = new OpenLayers.Control.SelectFeature(this.layers[0], {
            clickout: !0,
            toggle: !1,
            multiple: !1,
            hover: !1,
            toggleKey: "ctrlKey",
            multipleKey: "ctrlKey",
            unselectAll: function (e) {
                currentBluespotDrawer.controls.hiddenselect.unselectAll(e)
            }
        }), this.controls.multiselect = new OpenLayers.Control.SelectFeature(this.layers[0], {
            clickout: !0,
            toggle: !1,
            multiple: !1,
            hover: !1,
            toggleKey: "ctrlKey",
            multipleKey: "ctrlKey",
            box: !0,
            unselectAll: function (e) {
                currentBluespotDrawer.controls.hiddenselect.unselectAll(e)
            }
        }), [this.controls.select, this.controls.multiselect, this.controls.hiddenselect].forEach(function (e) {
            e.events.on({
                beforefeaturehighlighted: function () {
                    return !1
                }
            })
        });
        for (var e in this.controls)this.map.addControl(this.controls[e]);
        this.controls.measureTool = new DistanceMeasureController({
            onDistanceMeasuring: function (e) {
                t.site.psMap.setMapInstructions(e + " m")
            }, onDistanceMeasured: function () {
                t.reset()
            }, onDistanceMeasureCanceled: function () {
                t.reset()
            }
        }), this.controls.measureTool.deactivate(), this.layers.forEach(function (e) {
            e.events.on({
                featureselected: function (e) {
                    t.onFeatureSelected(e)
                }, featureunselected: function (e) {
                    t.onFeatureUnselected(e)
                }, featureadded: function (e) {
                    t.onFeatureAdded(e)
                }
            })
        })
    }, this.onFloorAboutToChange = function () {
        t.removeAllPopups(), t.isRadiusVisible() && t.hideRadius(), t.disableControls()
    }, this.onFloorChanged = function (e) {
        t.floor = e, t.setControlsFloor(t.floor);
        var i = t.controls[t.currentControl];
        t.currentControl && i && i.activate(), t.isRadiusEnabled ? t.showRadius() : t.hideRadius(), t.isIdPopupsEnabled && t.showIdPopups(), t.redraw()
    }, this.onFeatureSelected = function (e) {
        var i = allBluespots[e.feature.attributes.bluespotId];
        i ? t.trigger("selected", i) : log("Error: Bluespot not found " + e.feature.attributes.bluespotId)
    }, this.onFeatureUnselected = function (e) {
        var i = allBluespots[e.feature.attributes.bluespotId];
        t.trigger("unselected", i)
    }, this.addPoint = function (e, i, n, s, r, a, o, l, h, u, c) {
        var p = find_floor_by_lonlatalt(e, i, n), d = new OpenLayers.Geometry.Point(e, i);
        wgs84ToMercator(d);
        var f = new OpenLayers.Feature.Vector(d);
        f.attributes.bluespotAlt = n, f.attributes.bluespotId = s, f.attributes.bluespotLabel = r, f.attributes.bluespotBatteryLevel = o, f.attributes.daysNotSeen = l, f.attributes.isSaved = !0, f.attributes.customAttrs = h, f.attributes.comment = c, f.attributes.tags = u, f.attributes.status = a ? a : "normal", p.bluespotLayer.addFeatures(f), t.afterFeatureAdded(f)
    }, this.updateNbBeacons = function () {
        var e = 0, t = 0;
        for (var i in allBluespots)allBluespots[i].isDeleted || (e += 1), allBluespots[i].getLabel() && (t += 1);
        $("#nbr_of_beacons").html(e), $("#nbr_beacons_installed").html(t)
    }, this.onFeatureAdded = function (e) {
        var i = e.feature;
        void 0 == i.attributes.bluespotAlt && t.floor && (i.attributes.bluespotAlt = t.floor.altitude, !i.attributes.status && t.floor && (i.attributes.status = "normal", t.floor.bluespotLayer.drawFeature(i)), t.afterFeatureAdded(i))
    }, this.afterFeatureAdded = function (e) {
        var i = new Bluespot(e);
        i.displayRadius(), t.trigger("added", allBluespots[e.attributes.bluespotId])
    }, this.resetControls = function () {
        t.disableControls(), t.isRadiusEnabled ? t.showRadius() : t.hideRadius(), t.erasing = !1, t.displayingData = !1, t.currentControl = null, t.site.psMap.setMapInstructions("Drag the mouse to pan")
    }, this.reset = function () {
        t.resetControls(), t.resetActionPanel()
    }, this.setControl = function (e) {
        t.controls[e] ? t.currentControl != e ? (t.resetControls(), t.currentControl = e, t.controls[e].activate()) : t.resetControls() : t.resetControls()
    }, this.select = function () {
        t.setControl("select"), t.site.psMap.setMapInstructions("Click on a beacon to select it")
    }, this.showRadius = function () {
        t.floor.bluespotRadiusLayer && t.floor.bluespotRadiusLayer.setOpacity(1)
    }, this.isRadiusVisible = function () {
        return t.floor.bluespotRadiusLayer && 1 == t.floor.bluespotRadiusLayer.opacity
    }, this.hideRadius = function () {
        t.floor.bluespotRadiusLayer && t.floor.bluespotRadiusLayer.setOpacity(0)
    }, this.toggleRadius = function () {
        t.isRadiusVisible() ? t.hideRadius() : t.showRadius()
    }, this.showIdPopups = function () {
        if (t.isIdPopupsEnabled) {
            t.removeAllPopups();
            for (var e in allBluespots)if (allBluespots[e] && !allBluespots[e].isDeleted && allBluespots[e].floor === currentFloor) {
                var i = allBluespots[e].feature;
                allBluespots[e].getLabel();
                var n = e;
                t.showTextForFeature(i, n, 30, 25)
            }
            t.site.psMap.setMapInstructions("All beacon numbers are displayed")
        } else t.removeAllPopups()
    }, this.setBeaconAltitudes = function (e, t) {
        for (var i in allBluespots)for (var n = allBluespots[i], s = n.alt, r = 0; r < e.length; r++)if (e[r] != t[r] && e[r] == s) {
            n.setAlt(t[r]), n.redraw();
            break
        }
    }, this.showTextForFeature = function (e, i) {
        var n = new OpenLayers.Popup(null, e.geometry.getBounds().getCenterLonLat(), null, '<div class="bp-number">' + i + "</div>", null, null);
        n.backgroundColor = "pink", n.border = "2px solid #1B4755", n.autoSize = !0, e.popup = n, t.site.map.addPopup(e.popup)
    }, this.removeAllPopups = function () {
        for (; t.site.map.popups.length;)t.site.map.removePopup(t.site.map.popups[0])
    }, this.redraw = function () {
        t.floor.bluespotLayer.redraw()
    }, this.addListener = function (e) {
        t.listeners.push(e)
    }, this.removeListener = function (e) {
        var i = t.listeners.indexOf(e);
        i > -1 && t.listeners.slice(i, 1)
    }, this.trigger = function (e, i) {
        var n = [i];
        $.each(t.listeners, function (t, i) {
            i(n, e)
        })
    }, this.init(e), Interface.ensureImplements(this, ModelPainter)
}
function GeorefImageController(e) {
    var t = this;
    this.rotateTool = null, this.rotateToolPos = null, this.scaleTool = null, this.scaleToolPos = null, this.widthTool = null, this.widthToolPos = null, this.heightTool = null, this.heightToolPos = null, this.setRotationCenterButton = null, this.opacitySlider = null, this.actionPanel = null, this.dirty = !1, this.fixPointIcon = {
        path: "https://ncpasst.s3.amazonaws.com/assets/fix_point-b0ccd42c7e26bd4333e4107e2926830b.png",
        size: 24
    }, this.rotateToolIcon = {
        path: "https://ncpasst.s3.amazonaws.com/assets/rotate-305d1683b50017bd00ae0d5648928a4b.png",
        size: 16
    }, this.scaleToolIcon = {
        path: "https://ncpasst.s3.amazonaws.com/assets/scale-4196fe6c88ce2e388e253f52205e163b.png",
        size: 16
    }, this.widthToolIcon = {
        path: "https://ncpasst.s3.amazonaws.com/assets/scale-4196fe6c88ce2e388e253f52205e163b.png",
        size: 16
    }, this.heightToolIcon = {
        path: "https://ncpasst.s3.amazonaws.com/assets/scale-4196fe6c88ce2e388e253f52205e163b.png",
        size: 16
    }, this.currentGeoImg = e, this.originalValues = [e.x, e.y, e.width, e.height, e.rotation, e.opacity];
    var i = e.cornersMercator();
    this.currentCenter = new OpenLayers.LonLat(e.x, e.y), this.leftupCorner = i[0], this.rightupCorner = i[1], this.rightdownCorner = i[2], this.leftdownCorner = i[3], this.rightmiddle = new OpenLayers.LonLat((this.rightupCorner.lon + this.rightdownCorner.lon) / 2, (this.rightupCorner.lat + this.rightdownCorner.lat) / 2), this.downmidlle = new OpenLayers.LonLat((this.leftdownCorner.lon + this.rightdownCorner.lon) / 2, (this.leftdownCorner.lat + this.rightdownCorner.lat) / 2), this.currentRotation = e.rotation, this.layer = e.vectorLayer, this.dragControl = new OpenLayers.Control.DragFeature(this.layer), this.ix = t.currentGeoImg.x, this.iy = t.currentGeoImg.y, this.iWidth = t.currentGeoImg.width, this.iHeight = t.currentGeoImg.height, this.iRota = t.currentGeoImg.rotation, this.iOpa = t.currentGeoImg.getOpacity(), this.iScale = 1, this.actionPanel = new PSButtonPanel("georeferencing"), this.applyToAll = new PSFAButton({
        iconId: "fa-copy",
        title: "Allign all floors like this",
        listeners: [this]
    }), this.importKML = new PSFAButton({
        iconId: "fa-upload",
        title: "Align floor using KML",
        listeners: [this]
    }), this.measure = new PSFAButton({
        iconId: "fa-arrows-h",
        title: "Measure distance between 2 points",
        listeners: [this]
    }), this.rotate180 = new PSButton({
        iconId: "Rot180",
        title: "Rotate 180 degrees",
        listeners: [this]
    }), this.rotate90Left = new PSButton({
        iconId: "Rot90L",
        title: "Rotate 90 degrees left",
        listeners: [this]
    }), this.rotate90Right = new PSButton({
        iconId: "Rot90R",
        title: "Rotate 90 degrees right",
        listeners: [this]
    }), this.setRotationCenterButton = new PSButton({
        iconId: "Pin",
        title: "Fix a Rotation Center",
        listeners: [this]
    }), this.resetButton = new PSFAButton({
        iconId: "fa-undo",
        title: "Cancel All Changes",
        listeners: [this]
    }), this.rotationSlider = new PSSlider({
        text: "Rotation",
        min: -180,
        max: 180,
        step: 1,
        value: this.iRota,
        listeners: [this]
    }), this.opacitySlider = new PSSlider({
        text: "Opacity",
        value: this.iOpa,
        listeners: [this]
    }), this.actionPanel.buttons = [this.applyToAll, this.importKML, this.resetButton, this.measure, this.opacitySlider], this.actionPanel.addTo("map_zone_header"), this.applySameGoereferenceToAllFloors = function () {
        for (var e in floors)floors[e].blueprint && floors[e].blueprint.updateValues(this.ix, this.iy, this.iWidth, this.iHeight, this.iRota, this.iOpa);
        return psMap.setMapInstructions("All floors have been aligned like this floor"), !1
    }, this.onPSButtonClicked = function (e) {
        switch (e) {
            case this.importKML.id:
                $("#geo-form").modal("show");
                break;
            case this.applyToAll.id:
                t.applySameGoereferenceToAllFloors();
                break;
            case this.measure.id:
                t.activate_measure_tool();
                break;
            case this.resetButton.id:
                currentFloor.resetGeoreference();
                break;
            case this.setRotationCenterButton.id:
                pickAPointOnMap(georefManager.setRotationCenter);
                break;
            case this.rotate180.id:
                t.rotateMap(this.iRota + 180), this.initTools();
                break;
            case this.rotate90Left.id:
                t.rotateMap(this.iRota - 90), this.initTools();
                break;
            case this.rotate90Right.id:
                t.rotateMap(this.iRota + 90), this.initTools()
        }
        return !1
    }, this.onPSSliderChanged = function (e, i) {
        switch (e) {
            case this.opacitySlider.id:
                this.iOpa = i, this.applyValue();
                break;
            case this.rotationSlider.id:
                t.rotateMap(i), this.initTools()
        }
    }, this.applyValue = function () {
        t.currentGeoImg.updateValues(this.ix, this.iy, this.iWidth, this.iHeight, this.iRota, this.iOpa)
    }, this.applyValue(), this.initTools = function () {
        null != this.tools && this.layer.removeFeatures(this.tools), this.tools = [];
        var e = t.currentGeoImg.cornersMercator();
        this.leftupCorner = e[0], this.rightupCorner = e[1], this.rightdownCorner = e[2], this.leftdownCorner = e[3], this.rightmiddle = new OpenLayers.LonLat((this.rightupCorner.lon + this.rightdownCorner.lon) / 2, (this.rightupCorner.lat + this.rightdownCorner.lat) / 2), this.leftmiddle = new OpenLayers.LonLat((this.leftupCorner.lon + this.leftdownCorner.lon) / 2, (this.leftupCorner.lat + this.leftdownCorner.lat) / 2), this.downmidlle = new OpenLayers.LonLat((this.leftdownCorner.lon + this.rightdownCorner.lon) / 2, (this.leftdownCorner.lat + this.rightdownCorner.lat) / 2), this.upmidlle = new OpenLayers.LonLat((this.leftupCorner.lon + this.rightupCorner.lon) / 2, (this.leftupCorner.lat + this.rightupCorner.lat) / 2), this.currentRotation = this.currentGeoImg.rotation;
        var i = new OpenLayers.LonLat(t.fixPointMarker.geometry.x, t.fixPointMarker.geometry.y);
        this.rotateToolPos = rotate(i, slideX(i, norm(vector(this.leftupCorner, this.rightupCorner)) / 4), -Math.PI * this.currentRotation / 180), this.rotationLine = createDotLine(i, this.rotateToolPos), this.tools.push(this.rotationLine), this.rotateTool = createDraggableIcon(this.rotateToolPos, this.rotateToolIcon), this.tools.push(this.rotateTool), this.rightTool = createDraggableIcon(this.rightmiddle, this.scaleToolIcon), this.rightTool.style.rotation = this.currentRotation - 45, this.rightTool.attributes.currentPosition = this.rightmiddle, this.tools.push(this.rightTool), this.leftTool = createDraggableIcon(this.leftmiddle, this.scaleToolIcon), this.leftTool.style.rotation = this.currentRotation - 45, this.leftTool.attributes.currentPosition = this.leftmiddle, this.tools.push(this.leftTool), this.upTool = createDraggableIcon(this.upmidlle, this.scaleToolIcon), this.upTool.style.rotation = this.currentRotation + 45, this.upTool.attributes.currentPosition = this.upmidlle, this.tools.push(this.upTool), this.downTool = createDraggableIcon(this.downmidlle, this.scaleToolIcon), this.downTool.style.rotation = this.currentRotation + 45, this.downTool.attributes.currentPosition = this.downmidlle, this.tools.push(this.downTool), this.leftupTool = createDraggableIcon(this.leftupCorner, this.scaleToolIcon), this.leftupTool.style.rotation = this.currentRotation, this.leftupTool.attributes.currentPosition = this.leftupCorner, this.tools.push(this.leftupTool), this.rightupTool = createDraggableIcon(this.rightupCorner, this.scaleToolIcon), this.rightupTool.style.rotation = this.currentRotation + 90, this.rightupTool.attributes.currentPosition = this.rightupCorner, this.tools.push(this.rightupTool), this.rightdownTool = createDraggableIcon(this.rightdownCorner, this.scaleToolIcon), this.rightdownTool.style.rotation = this.currentRotation, this.rightdownTool.attributes.currentPosition = this.rightdownCorner, this.tools.push(this.rightdownTool), this.leftdownTool = createDraggableIcon(this.leftdownCorner, this.scaleToolIcon), this.leftdownTool.style.rotation = this.currentRotation + 90, this.leftdownTool.attributes.currentPosition = this.leftdownCorner, this.tools.push(this.leftdownTool), this.layer.addFeatures(this.tools), t.setRotationCenter(i), this.currentWidth = this.iWidth, this.currentHeight = this.iHeight, this.currentCenter = new OpenLayers.LonLat(t.currentGeoImg.x, t.currentGeoImg.y);
        var n = $("#fixpoint-lonlat"), s = new OpenLayers.LonLat(i.lon, i.lat);
        if (mercatorToWgs84(s), 0 != n.length) {
            var r = s.lon + "," + s.lat;
            n.val(r)
        }
    }, this.activate_measure_tool = function () {
        this.dragControl.deactivate();
        var e = new DistanceMeasureController(this);
        e.activate()
    }, this.onDistanceMeasuring = function (e) {
        this.actionPanel.setStatus(e + " m")
    }, this.onDistanceMeasured = function (e) {
        this.dragControl.activate(), this.actionPanel.setStatus(""), this.displayScaleDialog(e)
    }, this.onDistanceMeasureCanceled = function () {
        this.dragControl.activate(), this.actionPanel.setStatus("")
    }, this.rotateMap = function (e) {
        var i = new OpenLayers.LonLat(t.fixPointMarker.geometry.x, t.fixPointMarker.geometry.y);
        angleRad = Math.PI * e / 180;
        var n = Math.PI * t.currentRotation / 180, s = rotate(i, t.currentCenter, n - angleRad);
        t.ix = s.lon, t.iy = s.lat, t.iRota = e, t.applyValue()
    }, this.dragControl.onStart = function (e) {
        e == t.rotationLine && t.dragControl.handlers.drag.deactivate()
    }, this.dragControl.onDrag = function (e) {
        t.dirty = !0;
        var i = [t.fixPointMarker];
        if (void 0 != t.tools) {
            for (var n = 0; n < t.tools.length; n++)e != t.tools[n] && null != t.tools[n] && i.push(t.tools[n]);
            t.layer.removeFeatures(i)
        }
        if (e == t.rotateTool) {
            var s = e.attributes.currentPosition, r = new OpenLayers.LonLat(t.fixPointMarker.geometry.x, t.fixPointMarker.geometry.y), a = new OpenLayers.LonLat(r.lon + 1, r.lat), o = new OpenLayers.LonLat(e.geometry.x, e.geometry.y), l = getRotation(r, a, o);
            angle = Math.round(l * (180 / Math.PI)), t.rotateMap(angle), t.layer.removeFeatures([t.rotationLine]), t.rotationLine = createDotLine(r, o), t.layer.addFeatures([t.rotationLine]), $("#" + t.rotationSlider.controlDomId).slider("value", angle), $("#" + t.rotationSlider.valueDomId).html(angle)
        } else if (e == t.leftupTool || e == t.rightupTool || e == t.rightdownTool || e == t.leftdownTool) {
            var s = e.attributes.currentPosition, o = new OpenLayers.LonLat(e.geometry.x, e.geometry.y), r = new OpenLayers.LonLat(t.fixPointMarker.geometry.x, t.fixPointMarker.geometry.y), h = getScale(r, s, o, t.currentCenter), u = [], c = [];
            c[0] = t.currentCenter.lon - r.lon, c[1] = t.currentCenter.lat - r.lat, u[0] = c[0] * (h[0] - 1), u[1] = c[1] * (h[0] - 1), t.ix = t.currentCenter.lon + u[0], t.iy = t.currentCenter.lat + u[1], t.iWidth = t.currentWidth * h[0], t.iHeight = t.currentHeight * h[0], t.applyValue()
        } else if (e == t.rightTool || e == t.leftTool) {
            var s = e.attributes.currentPosition, o = new OpenLayers.LonLat(e.geometry.x, e.geometry.y), r = new OpenLayers.LonLat(t.fixPointMarker.geometry.x, t.fixPointMarker.geometry.y), l = Math.PI * t.currentRotation / 180, h = getScale(r, s, o, t.currentCenter);
            t.ix = t.currentCenter.lon + h[1], t.iy = t.currentCenter.lat + h[2], t.scaleWidth(h[0])
        } else if (e == t.upTool || e == t.downTool) {
            var s = e.attributes.currentPosition, o = new OpenLayers.LonLat(e.geometry.x, e.geometry.y), r = new OpenLayers.LonLat(t.fixPointMarker.geometry.x, t.fixPointMarker.geometry.y), h = getScale(r, s, o, t.currentCenter);
            t.ix = t.currentCenter.lon + h[1], t.iy = t.currentCenter.lat + h[2], t.scaleHeight(h[0])
        }
    }, this.scaleToWidthInMeter = function (e) {
        var i = t.currentGeoImg.realSizeInMeters()[0], n = e / i;
        t.scaleWidth(n), t.initTools()
    }, this.scaleToHeightInMeter = function (e) {
        var i = t.currentGeoImg.realSizeInMeters()[1], n = e / i;
        t.scaleHeight(n), t.initTools()
    }, this.scaleWidth = function (e) {
        t.iWidth = t.currentWidth * e, t.applyValue()
    }, this.scaleHeight = function (e) {
        t.iHeight = t.currentHeight * e, t.applyValue()
    }, this.dragControl.onComplete = function (e) {
        if (e == t.rotateTool) t.layer.removeFeatures([t.rotationLine]); else if (e == t.currentGeoImg.pointFeature) {
            var i = e.geometry.x - t.currentGeoImg.x, n = e.geometry.y - t.currentGeoImg.y, s = new OpenLayers.LonLat(t.fixPointMarker.geometry.x, t.fixPointMarker.geometry.y);
            t.setRotationCenter(new OpenLayers.LonLat(s.lon + i, s.lat + n)), t.ctrlDragFeature_onComplete(e.geometry.x, e.geometry.y)
        }
        t.initTools()
    }, this.ctrlDragFeature_onComplete = function (e, i) {
        this.ix = e, this.iy = i, t.applyValue()
    }, this.moveFixPointTo = function (e, i) {
        log(e);
        var n = new OpenLayers.LonLat(t.fixPointMarker.geometry.x, t.fixPointMarker.geometry.y), s = new OpenLayers.LonLat(e, i);
        wgs84ToMercator(s);
        var r = s.lon - n.lon, a = s.lat - n.lat;
        t.setRotationCenter(new OpenLayers.LonLat(s.lon, s.lat)), t.ctrlDragFeature_onComplete(t.currentGeoImg.x + r, t.currentGeoImg.y + a), t.initTools()
    }, psMap.map.addControl(this.dragControl), this.dragControl.activate(), this.setRotationCenter = function (e) {
        null != t.fixPointMarker && t.layer.removeFeatures([t.fixPointMarker]), t.fixPointMarker = createDraggableIcon(e, t.fixPointIcon), t.layer.addFeatures([t.fixPointMarker])
    }, this.setRotationCenter(this.currentCenter), this.initTools(), this.cancel = function () {
        this.deactivate(), this.currentGeoImg.updateValues(this.originalValues[0], this.originalValues[1], this.originalValues[2], this.originalValues[3], this.originalValues[4], this.originalValues[5])
    }, this.deactivate = function () {
        this.dragControl.deactivate(), this.layer.removeFeatures(this.tools), this.layer.removeFeatures([this.fixPointMarker]), this.actionPanel.remove()
    }, this.onScaleDialogOkBtnClicked = function () {
        var e = parseFloat($("#current-distance-measure").html()), i = parseFloat($("#wanted-distance-measure").val());
        if (i != e && e > 0 && i > 0) {
            var n = i / e;
            t.scaleWidth(n), t.scaleHeight(n), t.initTools(), this.hideScaleDialog()
        }
    }, this.hideScaleDialog = function () {
        $("#dialog-scale").modal("hide")
    }, this.displayScaleDialog = function (e) {
        $("#current-distance-measure").html(e), $("#wanted-distance-measure").val(e), $("#dialog-scale").modal("show")
    }
}
function LogPainter(e) {
    var t = this;
    this.site = e, this.currentControl = null, this.listeners = [], this.erasing = !1, this._onModelEvent = function (e, i) {
        switch (log("LogPainter " + e + " " + i.getInfo()), e) {
            case"selected":
                t.onLogSelected(i);
                break;
            case"unselected":
                t.onLogUnselected(i)
        }
    }, this.redraw = function () {
    }, this.addListener = function (e) {
        this.listeners.push(e)
    }, this.removeListener = function (e) {
        var t = this.listeners.indexOf(e);
        t > -1 && this.listeners.slice(t, 1)
    }, this.addToolbar = function () {
        $("#map_zone_header").append('<span id="toolbar"><span class="btn-group" id="logPainter-toggles" data-toggle="buttons"><label class="psfa-btn btn btn-default active" title="Navigate"><input type="radio" name="action" value="select" /><i class="fa fa-globe"></i></label><label class="psfa-btn btn btn-default" title="Erase log"><input type="radio" name="action" value="erase" /><i class="fa fa-trash-o"></i></label></span></span>'), $("#logPainter-toggles :input").change(function () {
            "select" == $(this).attr("value") && currentLogPainter.select(), "erase" == $(this).attr("value") && currentLogPainter.erase()
        })
    }, this.select = function () {
        this.reset()
    }, this.erase = function () {
        this.reset(), this.erasing = !0, this.site.psMap.setMapInstructions("Click on a record to delete it"), currentLog && this.onLogSelected(currentLog)
    }, this.reset = function () {
        this.site.psMap.setMapInstructions("Drag the mouse to pan"), this.erasing = !1, this.currentControl = null
    }, this.onLogSelected = function (e) {
        if (currentLog = e)if (t.erasing) {
            var i = function () {
                return confirm("Do you want to erase this log?")
            };
            i() && (e.listener = t, e.destroy(), e.erase(), t.trigger("removed", e))
        } else {
            var n = t.site.logs;
            for (var s in n)n[s].getId() == e.getId() ? n[s].showOnMap() : n[s].hideOnMap()
        }
    }, this.onLogUnselected = function (e) {
        if (e && currentLog && e.getId() == currentLog.getId()) {
            currentLog = null;
            var i = t.site.logs;
            for (var n in i)i[n].showOnMap()
        }
    }, this.onDestroySuccess = function () {
        alert("Operation success")
    }, this.onSaveSuccess = function () {
        alert("Operation success")
    }, this.onBackendFailure = function (e, t) {
        alert("ERROR: cannot save because of the following error : " + JSON.stringify(t))
    }, this.trigger = function (e, t) {
        var i = [t];
        $.each(this.listeners, function (t, n) {
            n(i, e)
        })
    }, Interface.ensureImplements(this, ModelPainter)
}
function VectorDrawer(e, t) {
    var i = this;
    this.site = t, this.map = t.map, this.vectorBlueprints = e, this.controls = {}, this.hoveredFeature = null, this.currentControl = null, this.listeners = [], this.categoryColorMap = {}, this.magnetismEnabled = !1, this.setCategoryColorMap = function (e) {
        this.categoryColorMap = e
    }, this.onPSButtonClicked = function (e) {
        switch (i.currentBtn && i.currentBtn.id != e && (i.currentBtn.isPressed = !1, i.currentBtn.refresh()), e) {
            case i.drawPolygonBtn.id:
                i.currentBtn = i.drawPolygonBtn, i.drawPolygon();
                break;
            case i.changeColorAndTextBtn.id:
                i.currentBtn = i.changeColorAndTextBtn, i.changeColorAndText();
                break;
            case i.eraseBtn.id:
                i.currentBtn = i.eraseBtn, i.erase();
                break;
            case i.btnMeasure.id:
                i.currentBtn = i.btnMeasure, i.activateMeasureTool()
        }
    }, this.addActionPanel = function () {
        this.actionPanel = new PSButtonPanel("custom-tools"), this.drawPolygonBtn = new PSFAButton({
            iconId: "fa fa-plus",
            title: "Draw polygon, double click to finish",
            listeners: [this]
        }), this.changeColorAndTextBtn = new PSFAButton({
            iconId: "fa fa-pencil",
            title: "Change meta data (name, color, category) of selected geofence",
            listeners: [this]
        }), this.eraseBtn = new PSFAButton({
            iconId: "fa fa-trash-o",
            title: "Delete selected geofence",
            listeners: [this]
        }), this.btnMeasure = new PSFAButton({
            iconId: "fa-arrows-h",
            title: "Measure distance between 2 points",
            listeners: [this]
        }), this.actionPanel.buttons = [this.drawPolygonBtn, this.changeColorAndTextBtn, this.eraseBtn, this.btnMeasure], this.actionPanel.addTo("map_zone_header")
    }, this.addToolbar = function () {
        this.controls.measureTool = new DistanceMeasureController({
            onDistanceMeasuring: function (e) {
                i.actionPanel.setStatus(e + " m")
            }, onDistanceMeasured: function () {
                i.reset()
            }, onDistanceMeasureCanceled: function () {
                i.reset()
            }
        }), this.site.psMap.setMapTitle('<span id="nbr_of_zones" class="badge badge-info">' + Object.size(allPolygons) + "</span> geofences"), $("#map_zone_header").append('<div id="polygon-dialog" class="modal fade" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="polygon-dialog-label"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close polygon-dialog-cancel"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="polygon-dialog-label">Geofence zone</h4></div><div class="modal-body clearfix"><p><label for="polygon-text">Name</label> <br/><input type="text" id="polygon-text" name="polygon-text" class="form-control"/></p><p><label for="polygon-category">Category</label> <br/><input type="text" id="polygon-category" name="polygon-category" class="form-control" list="list-categories"/><datalist id="list-categories"></datalist></p><p><label for="polygon-color">Color</label> <br/><input type="text" id="polygon-color" name="polygon-color" class="form-control" style="height:100%"/></p><p class="pull-right"><a data-toggle="collapse" data-target="#region-type">Advanced</a></p><div id="region-type" class="collapse clearfix"><h5>Zone Type</h5><p> Geographical zones have geographical boundaries. Beacon groups have a virtual border defined by proximities of the beacons inside them.</p><div class="radio radio-info"><input type="radio" id="radioPolygon" value="PolygonRegion" name="radioPolygonOrBeacon" checked><label for="radioPolygon"> Geographical zone </label></div><div class="radio"><input type="radio" id="radioBeacon" value="BeaconRegion" name="radioPolygonOrBeacon"><label for="radioBeacon"> Beacon group </label></div></div></div><div class="modal-footer"><button id="polygon-dialog-save" type="button" class="btn btn-primary">Save</button><button class="polygon-dialog-cancel btn btn-default" type="button">Cancel</button></div></div></div></div>'), this.addActionPanel(), $("#polygon-category").bind("select", function () {
            var e = currentVectorDrawer.categoryColorMap[$("#polygon-category").val()];
            e && ($("#polygon-color").val(e), $("#polygon-color").minicolors("value", e))
        }), $("#polygon-dialog-save").click(function () {
            $(this).prop("disabled", !0), $(this).text("Please wait...");
            var e = $("#polygon-color").val(), t = $("#polygon-text").val(), i = $("#polygon-category").val(), n = $("input[name=radioPolygonOrBeacon]:checked").val();
            currentVectorDrawer.onPolygonDiaglogSaveBtnClicked(e, t, i, n)
        }), $(".polygon-dialog-cancel").click(function () {
            currentVectorDrawer.onPolygonDiaglogCancelBtnClicked()
        }), $("#polygon-color").minicolors({theme: "bootstrap"})
    };
    var n = OpenLayers.Class(OpenLayers.Handler.Polygon, {
        addPoint: function (e) {
            if (i.hoveredFeature) {
                var t = this.getSketch().geometry.components[0].components[this.getCurrentPointIndex()];
                t.x = i.hoveredFeature.geometry.x, t.y = i.hoveredFeature.geometry.y, this.drawFeature()
            }
            OpenLayers.Handler.Polygon.prototype.addPoint.apply(this, [e])
        }
    });
    this.disableControls = function () {
        if (this.controls)for (key in this.controls) {
            var e = this.controls[key];
            e.deactivate()
        }
        this.vectorLayer && this.vectorLayer.events.un({
            beforefeaturemodified: this.onBeforeFeatureModified,
            afterfeaturemodified: this.onAfterFeatureModified,
            featureselected: this.onFeatureSelected,
            featureunselected: this.onFeatureUnselected,
            featureadded: this.onPolygonAdded,
            scope: i
        })
    }, this.addControls = function () {
        var e = !this.controls.polygon;
        if (e) {
            this.controls.polygon = new OpenLayers.Control.DrawFeature(this.vectorLayer, n), this.controls.select = new OpenLayers.Control.SelectFeature(this.vectorLayer), this.controls.edit = new OpenLayers.Control.SelectFeature(this.vectorLayer), this.controls.erase = new OpenLayers.Control.SelectFeature(this.vectorLayer), this.magnetismEnabled && (this.hoverHandler = new OpenLayers.Handler.Hover(this, {
                move: function (e) {
                    i.onMouseMove(e)
                }
            })), this.keyboardHandler = new OpenLayers.Handler.Keyboard(this, {keyup: i.onKeyDown}, {}), this.keyboardHandler.activate();
            for (var t in this.controls)this.map.addControl(this.controls[t])
        } else for (var t in this.controls)this.controls[t].setLayer ? this.controls[t].setLayer(this.vectorLayer) : this.controls[t].layer = this.vectorLayer;
        this.vectorLayer.events.on({
            beforefeaturemodified: this.onBeforeFeatureModified,
            afterfeaturemodified: this.onAfterFeatureModified,
            featureselected: this.onFeatureSelected,
            featureunselected: this.onFeatureUnselected,
            featureadded: this.onPolygonAdded,
            scope: i
        })
    }, this.onAfterFeatureModified = function () {
        currentPolygon && i.unselectPolygon(currentPolygon)
    }, this.onBeforeFeatureModified = function (e) {
        currentPolygon = allPolygons[e.feature.attributes.polygonId], currentPolygon && i.selectPolygon(currentPolygon)
    }, this.onFeatureSelected = function (e) {
        this.selectPolygon(allPolygons[e.feature.attributes.polygonId])
    }, this._onModelEvent = function (e, t) {
        switch (e) {
            case"selected":
                i.onPolygonSelected(t);
                break;
            case"unselected":
                i.onPolygonUnselected(t)
        }
    }, this.selectPolygon = function (e) {
        e && this.trigger("selected", e)
    }, this.unselectPolygon = function (e) {
        e && this.trigger("unselected", e)
    }, this.onPolygonSelected = function (e) {
        if (currentPolygon = e, e) {
            if (e.highlight(), "edit" == i.currentControl && i.displayPolygonDialog(), "erase" == i.currentControl) {
                var t = function () {
                    return confirm("Do you want to erase geofence " + e.name)
                };
                t() && (e.listener = i, i.persistable && e.destroy(), e.erase(), i.trigger("removed", e), currentPolygon = null)
            }
            "hide" == i.currentControl && (i.unselectPolygon(e), e.hide())
        }
    }, this.onPolygonUnselected = function (e) {
        e && (e.unhighlight(), currentPolygon && e.getId() == currentPolygon.getId() && (currentPolygon = null))
    }, this.onFeatureUnselected = function (e) {
        this.unselectPolygon(allPolygons[e.feature.attributes.polygonId])
    }, this.onPolygonAdded = function (e) {
        if (i.controls.polygon.active && e.feature != this.hoveredFeature) {
            var t = $.extend(!0, {}, OpenLayers.Feature.Vector.style["default"]);
            currentPolygon = this.vectorBlueprint.addPolygon(e.feature, t.fillColor, null), i.trigger("added", currentPolygon), currentPolygon.select(), i.displayPolygonDialog()
        }
    }, this.onMouseMove = function (e) {
        var t = this.map.getLonLatFromViewPortPx(e.xy), i = this.vectorBlueprint.getCloseGeometry(t.lon, t.lat, currentPolygon);
        null != i ? this.onHoverFeature(i) : null != this.hoveredFeature && this.outHoverFeature(this.hoveredFeature)
    }, this.onHoverFeature = function (e) {
        if (null == this.hoveredFeature || null != this.hoveredFeature && this.hoveredFeature.geometry.id != e.id) {
            this.outHoverFeature(this.hoveredFeature);
            var t = $.extend(!0, {}, OpenLayers.Feature.Vector.style["default"]);
            t.strokeColor = "#0088CC", this.hoveredFeature = new OpenLayers.Feature.Vector(e, null, selectedgraphNodeStyle), this.vectorLayer.addFeatures([this.hoveredFeature])
        }
    }, this.outHoverFeature = function () {
        null != this.hoveredFeature && (this.vectorLayer.removeFeatures([this.hoveredFeature]), this.hoveredFeature = null)
    }, this.resetControls = function () {
        this.site.psMap.setMapInstructions("Drag the mouse to pan"), this.disableControls(), this.addControls(), this.hoverHandler && this.hoverHandler.deactivate(), this.currentControl = null
    }, this.setControl = function (e) {
        this.controls[e] ? i.currentControl != e ? (this.resetControls(), this.currentControl = e, this.controls[this.currentControl].activate()) : (this.resetControls(), this.currentControl = "select", this.controls[this.currentControl].activate()) : (this.resetControls(), this.currentControl = "select", this.controls[this.currentControl].activate())
    }, this.activateMeasureTool = function () {
        i.setControl("measureTool"), i.site.psMap.setMapInstructions("Click on 2 points to measure their distance")
    }, this.drawPolygon = function () {
        this.setControl("polygon"), this.hoverHandler && this.hoverHandler.activate(), this.site.psMap.setMapInstructions("Click to add points. Double click to finish the polygon. ESC to cancel."), currentPolygon && this.unselectPolygon(currentPolygon)
    }, this.changeColorAndText = function () {
        this.setControl("edit"), "edit" == this.currentControl && (this.site.psMap.setMapInstructions("Click on a polygon to edit its color and name"), currentPolygon && this.onPolygonSelected(currentPolygon))
    }, this.select = function () {
        this.setControl("select"), this.site.psMap.setMapInstructions("Click on a polygon to select it")
    }, this.erase = function () {
        this.setControl("erase"), "erase" == this.currentControl && (this.site.psMap.setMapInstructions("Click on a polygon to delete it"), currentPolygon && this.onPolygonSelected(currentPolygon))
    }, this.onDestroySuccess = function () {
        this.hidePolygonDialog(), $("#nbr_of_zones").html(Object.size(allPolygons))
    }, this.onSaveSuccess = function () {
        this.hidePolygonDialog(), $("#nbr_of_zones").html(Object.size(allPolygons))
    }, this.onBackendFailure = function (e, t) {
        $("#nbr_of_zones").html(Object.size(allPolygons)), alert("ERROR: cannot save because of the following error : " + JSON.stringify(t)), $("#polygon-dialog-save").prop("disabled", !1), $("#polygon-dialog-save").text("Save")
    }, this.onPolygonDiaglogSaveBtnClicked = function (e, t, n, s) {
        t.length > 0 && e.length > 0 ? (currentPolygon.setColor(e), currentPolygon.setText(t), currentPolygon.setCategory(n), currentPolygon.setType(s), currentPolygon.setBuilding(currentBuilding.id), i.categoryColorMap[n] = e, i.persistable ? (currentPolygon.listener = i, currentPolygon.save()) : this.hidePolygonDialog(), i.trigger("updated", currentPolygon), i.unselectPolygon(currentPolygon), i.controls[i.currentControl].activate()) : (alert("ERROR: Name and color cannot be empty"), $("#polygon-dialog-save").prop("disabled", !1), $("#polygon-dialog-save").text("Save"))
    }, this.onPolygonDiaglogCancelBtnClicked = function () {
        if ("edit" == i.currentControl) this.hidePolygonDialog(), i.controls[i.currentControl].activate(); else if (currentPolygon) {
            var e = function () {
                return confirm("Do you want to abort?")
            };
            e() && currentPolygon && (currentPolygon.erase(), i.trigger("removed", currentPolygon), this.hidePolygonDialog(), i.controls[i.currentControl].activate(), currentPolygon = null)
        }
    }, this.polygonDialogIsVisible = function () {
        return $("#polygon-dialog").is(":visible")
    }, this.hidePolygonDialog = function () {
        $("#polygon-dialog").modal("hide")
    }, this.loadCategorySelector = function (e) {
        $(e).html("");
        for (var t in this.categoryColorMap)$(e).append('<option value="' + t + '">')
    }, this.displayPolygonDialog = function () {
        currentPolygon && (this.controls[this.currentControl].deactivate(), $("#polygon-dialog-save").prop("disabled", !1), $("#polygon-dialog-save").text("Save"), $("#polygon-color").val(currentPolygon.color), $("#polygon-color").minicolors("value", currentPolygon.color), $("#polygon-text").val(currentPolygon.text), $("#polygon-category").val(currentPolygon.category), this.loadCategorySelector("#list-categories"), "PolygonRegion" == currentPolygon.type ? ($("input[name=radioPolygonOrBeacon][value=PolygonRegion]").prop("checked", !0), $("input[name=radioPolygonOrBeacon][value=BeaconRegion]").prop("checked", !1)) : ($("input[name=radioPolygonOrBeacon][value=PolygonRegion]").prop("checked", !1), $("input[name=radioPolygonOrBeacon][value=BeaconRegion]").prop("checked", !0)), $("#polygon-dialog").modal({
            backdrop: "static",
            keyboard: !1
        }))
    }, this.resetActionPanel = function () {
        this.actionPanel && _.each(this.actionPanel.buttons, function (e) {
            e.isPressed = !1, e.refresh()
        })
    }, this.onKeyDown = function (e) {
        switch (e.keyCode) {
            case 27:
                i.reset()
        }
    }, this.reset = function () {
        i.polygonDialogIsVisible() ? (log("VectorDrawer ESC when polygon dialog visible"), i.onPolygonDiaglogCancelBtnClicked()) : i.currentControl && (log("VectorDrawer ESC when having current control"), i.resetActionPanel(), i.setControl("select"))
    }, this.onFloorAboutToChange = function () {
        this.vectorBlueprint && this.vectorBlueprint.hide(), this.disableControls()
    }, this.onFloorChanged = function (e) {
        if (e) {
            var t = e.id;
            this.vectorBlueprint = this.vectorBlueprints[t], this.vectorLayer = this.vectorBlueprint.layer, this.addControls(), this.currentControl && this.controls[this.currentControl] && this.controls[this.currentControl].activate(), this.vectorBlueprint.show()
        }
    }, this.addListener = function (e) {
        this.listeners.push(e)
    }, this.removeListener = function (e) {
        var t = this.listeners.indexOf(e);
        t > -1 && this.listeners.slice(t, 1)
    }, this.trigger = function (e, t) {
        var i = [t];
        $.each(this.listeners, function (t, n) {
            n(i, e)
        })
    }, this.redraw = function () {
        this.vectorBlueprint.layer.redraw()
    }, Interface.ensureImplements(this, ModelPainter)
}
function get_color_map_from_values(e) {
    for (var t = {}, i = e[0], n = e[0], s = 0; s < e.length; s++)e[s] < i && (i = e[s]), e[s] > n && (n = e[s]);
    if (n > i)for (var s = 0; s < e.length; s++) {
        var r = e[s], a = parseInt(100 * (r / n)), o = RAINBOW_COLOR_34[33 - parseInt(a / 3)], l = "rgb(" + Math.round(255 * o[0]) + "," + Math.round(255 * o[1]) + "," + Math.round(255 * o[2]) + ")";
        t[r] = l
    }
    return t
}
function componentToHex(e) {
    e = Math.round(e);
    var t = e.toString(16);
    return 1 == t.length ? "0" + t : t
}
function rgbToHex(e, t, i) {
    return "#" + componentToHex(e) + componentToHex(t) + componentToHex(i)
}
function hexToRgb(e) {
    var t = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);
    return t ? {r: parseInt(t[1], 16), g: parseInt(t[2], 16), b: parseInt(t[3], 16)} : null
}
function create_heatmap_legend(e, t, i) {
    html = "<table>";
    for (var n = 0; n < RAINBOW_COLOR_34.length; n++) {
        var s = rgbToHex(255 * RAINBOW_COLOR_34[n][0], 255 * RAINBOW_COLOR_34[n][1], 255 * RAINBOW_COLOR_34[n][2]), r = Math.round(3 * (34 - n) * ((i - t) / 100)) + t;
        html += '<tr><td width="150" bgcolor="' + s + '"></td>', html += '<td width="40">' + r + "</td></tr>"
    }
    html += "</table>", $("#" + e).html(html)
}
function createCookie(e, t, i) {
    if (i) {
        var n = new Date;
        n.setTime(n.getTime() + 1e3 * 60 * 60 * 24 * i);
        var s = "; expires=" + n.toGMTString()
    } else var s = "";
    document.cookie = e + "=" + t + s + "; path=/"
}
function readCookie(e) {
    for (var t = e + "=", i = document.cookie.split(";"), n = 0; n < i.length; n++) {
        for (var s = i[n]; " " == s.charAt(0);)s = s.substring(1, s.length);
        if (0 == s.indexOf(t))return s.substring(t.length, s.length)
    }
    return null
}
function eraseCookie(e) {
    createCookie(e, "", -1)
}
function slideX(e, t) {
    return new OpenLayers.LonLat(e.lon + t, e.lat)
}
function slideY(e, t) {
    return new OpenLayers.LonLat(e.lon, e.lat + t)
}
function slide(e, t) {
    var i = slideX(e, t[0]);
    return slideY(i, t[1])
}
function rotate(e, t, i) {
    var n = e.lon + (t.lon - e.lon) * Math.cos(i) - (t.lat - e.lat) * Math.sin(i), s = e.lat + (t.lon - e.lon) * Math.sin(i) + (t.lat - e.lat) * Math.cos(i);
    return new OpenLayers.LonLat(n, s)
}
function getScale(e, t, i, n) {
    var s = [];
    s[0] = t.lon - n.lon, s[1] = t.lat - n.lat;
    var r = [];
    r[0] = i.lon - e.lon, r[1] = i.lat - e.lat;
    var a = [];
    a[0] = -e.lon + n.lon, a[1] = -e.lat + n.lat;
    var o = [];
    o[0] = t.lon - e.lon, o[1] = t.lat - e.lat;
    var l = scalProduct(r, s) / scalProduct(o, s), h = [];
    return h[0] = s[0] * (l - 1) * scalProduct(a, s) / (norm(s) * norm(s)), h[1] = s[1] * (l - 1) * scalProduct(a, s) / (norm(s) * norm(s)), [l, h[0], h[1]]
}
function getRotation(e, t, i) {
    var n = [];
    n[0] = t.lon - e.lon, n[1] = t.lat - e.lat;
    var s = [];
    s[0] = i.lon - e.lon, s[1] = i.lat - e.lat;
    var r;
    return r = -Math.atan2(vectProduct(n, s), scalProduct(n, s))
}
function norm(e) {
    var t = Math.sqrt(e[0] * e[0] + e[1] * e[1]);
    return t
}
function vector(e, t) {
    var i = [];
    return i[0] = t.lon - e.lon, i[1] = t.lat - e.lat, i
}
function scalProduct(e, t) {
    return e[0] * t[0] + e[1] * t[1]
}
function vectProduct(e, t) {
    return e[0] * t[1] - e[1] * t[0]
}
function licenceRemainingDays() {
    var e = 1e3;
    return e
}
function timeHMSString() {
    var e = new Date;
    return padStr(e.getHours()) + ":" + padStr(e.getMinutes()) + ":" + padStr(e.getSeconds())
}
function padStr(e) {
    return 10 > e ? "0" + e : "" + e
}
function enableRippleEffect() {
    $(".ripple-effect").click(function (e) {
        var t = $(this);
        0 == t.find(".ink").length && t.append("<span class='ink'></span>");
        var i = t.find(".ink");
        if (i.removeClass("animate"), !i.height() && !i.width()) {
            var n = Math.max(t.outerWidth(), t.outerHeight());
            i.css({height: n, width: n})
        }
        var s = e.pageX - t.offset().left - i.width() / 2, r = e.pageY - t.offset().top - i.height() / 2;
        i.css({top: r + "px", left: s + "px"}).addClass("animate")
    })
}
function dbg() {
    return !0
}
function rgb2hex(e) {
    for (var t = 255 * e[2] | 255 * e[1] << 8 | 255 * e[0] << 16, i = t.toString(16); i.length < 6;)i = "0" + i;
    return "#" + i
}
function enableSubmit(e) {
    e ? $(".submit-control").show() : $(".submit-control").hide()
}
function filterList(e, t) {
    var i = $("<form>").attr({"class": "filterform", action: "#"}), n = $("<input>").attr({
        "class": "filterinput",
        type: "text"
    });
    $(i).append(n).appendTo(e), $(n).change(function () {
        var e = $(this).val();
        t(e)
    }).keyup(function () {
        $(this).change()
    })
}
function log(e) {
    console.log(e)
}
function notify(e) {
    show_notification(e, "success")
}
function error(e) {
    show_notification(e, "error")
}
function show_notification(e, t) {
    var i = '<a id="notification-close-btn" href="#" onclick="$(\'#application-notice\').html(\'\');"><img src="https://ncpasst.s3.amazonaws.com/assets/close-ef14a7ebb243d06085a91e7f3f788ffb.png"></a>';
    e = i + '<div class="alert alert-' + t + '">' + e + "</div>", $("#application-notice").html(e), $("#application-notice").effect("shake")
}
function progressBar(e, t) {
    for (var i = "progtrckr-done", n = '<ol class="progtrckr">', s = 0; s < deploymentSteps.length; s++)i = e > s ? "progtrckr-done" : s == e ? "progtrckr-current" : "progtrckr-todo", s == t && (i += " progtrckr-displayed"), n += '<li class="' + i + '">', n += deploymentStepLinks && deploymentStepLinks[s] ? '<a href="' + deploymentStepLinks[s] + '">' + (s + 1) + " - " + deploymentSteps[s] + "</a>" : s + 1 + " - " + deploymentSteps[s], n += "</li>";
    n += "</ol>", document.getElementById("progress-tracker").innerHTML = n
}
function contact_support_team(e, t) {
    var i = "support-naocloud@polestar.eu", n = "NAO Cloud Support Request - " + e, s = "Message from NAO Cloud user " + e + ":";
    $("#" + t).html('<a href="mailto:' + i + "?subject=" + n + "&body=" + s + '">Contact our support team</a>')
}
function contact_sales_team(e, t, i, n, s) {
    var r = t, a = "NAO Cloud - " + s + " - " + e, o = "Message from NAO Cloud user " + e + ":";
    $("#" + i).html('<a href="mailto:' + r + "?subject=" + a + "&body=" + o + '">' + n + "</a>")
}
function getLonlatArrayFromFeature(e) {
    polygon_json = [];
    var t = e.components;
    "OpenLayers.Geometry.Polygon" == e.CLASS_NAME && (t = e.components[0].components);
    for (var i = 0; i < t.length; i++) {
        var n = t[i], s = new OpenLayers.Geometry.Point(n.x, n.y);
        mercatorToWgs84(s), polygon_json[i] = [s.x, s.y]
    }
    return polygon_json
}
function createDotLine(e, t, i) {
    i || (i = "blue");
    var n = {
        fillColor: i,
        strokeColor: i,
        fillOpacity: .5,
        strokeWidth: 1,
        strokeDashstyle: "dot"
    }, s = new OpenLayers.Geometry.Point(e.lon, e.lat), r = new OpenLayers.Geometry.Point(t.lon, t.lat), a = new OpenLayers.Geometry.LineString([s, r]), o = new OpenLayers.Feature.Vector(a, null, n);
    return o
}
function createMarker(e, t) {
    if (null == t)var t = {
        iconPath: "https://ncpasst.s3.amazonaws.com/assets/marker-ac249723e43febe676dff1c531341e31.png",
        size: [21, 25]
    };
    var i = new OpenLayers.Size(t.size[0], t.size[1]), n = new OpenLayers.Pixel(-(i.w / 2), -i.h), s = new OpenLayers.Icon(t.iconPath, i, n), r = new OpenLayers.Marker(e, s.clone()), a = new OpenLayers.Feature(psMap.markersLayer, e);
    return r.feature = a, psMap.markersLayer.addMarker(r), r
}
function createDraggableIcon(e, t) {
    var i = t.path, n = t.size, s = n / 2, r = {
        pointRadius: s,
        externalGraphic: i,
        graphicXOffset: -s,
        graphicYOffset: -s
    }, a = new OpenLayers.Geometry.Point(e.lon, e.lat), o = new OpenLayers.Feature.Vector(a, null, r);
    return o
}
function pickAPointOnMap(e) {
    for (var t = [], i = psMap.map.controls.length - 1; i >= 0; i--)psMap.map.controls[i].active && (psMap.map.controls[i].deactivate(), t.push(psMap.map.controls[i]));
    var n = new OpenLayers.Control.DrawFeature(psMap.markersLayer, OpenLayers.Handler.Point, {
        callbacks: {
            done: function (i) {
                var n = new OpenLayers.LonLat(i.x, i.y);
                this.deactivate(), psMap.map.removeControl(this);
                for (var s = t.length - 1; s >= 0; s--)t[s].activate();
                e(n)
            }
        }
    });
    psMap.map.addControl(n), n.activate()
}
function pointTo(e, t, i) {
    if (null != psMap) {
        psMap.goto(e, t);
        var n = wgs84ToMercator(new OpenLayers.LonLat(e, t));
        popup = new OpenLayers.Popup("Info", n, new OpenLayers.Size(100, 20), i, !0), psMap.map.addPopup(popup, !0)
    }
}
function wgs84ToMercator(e) {
    var t = new OpenLayers.Projection("EPSG:4326"), i = new OpenLayers.Projection("EPSG:900913");
    return e.transform(t, i)
}
function mercatorToWgs84(e) {
    var t = new OpenLayers.Projection("EPSG:4326"), i = new OpenLayers.Projection("EPSG:900913");
    return e.transform(i, t)
}
function activateRightClick(e, t, i) {
    document.getElementById("site-map").oncontextmenu = function (e) {
        return e = e ? e : window.event, e.preventDefault ? (e.preventDefault(), void 0) : !1
    };
    var n = new OpenLayers.Control.Click({eventMethods: {click: e, rightclick: t, dblrightclick: i}});
    site.map.addControl(n), n.activate()
}
function ModelTable(e, t, i) {
    var n = this;
    this.initialize = function (e, t, i) {
        this.id = "table_" + data_table_counter, data_table_counter += 1, this.table = null, this.divDOMID = "#" + t, this.headers = [], this.dataToDisplay = [], this.extraData = [], this.status_types = [], this.actions = {}, this.lastSelectedRows = [], this.defaultHiddenColumns = [], this.pageLength = "undefined" != typeof i ? i : 20, this.lastSelectedIndex = 0, this.currentSelectedModels = [];
        var n = this._buildHeadersFromJsonData(e);
        this._buildDataFromJsonData(e), n && this._buildDetailsColumn(), $(this.divDOMID).html('<table cellpadding="0" cellspacing="0" border="0" class="display datatable" id=' + this.id + "></table>");
        var s = "<select>";
        s += '<option value="10">10</option>', s += '<option value="20">20</option>', s += '<option value="30">30</option>', s += "</select>", this.table = $("#" + this.id).dataTable({
            bJQueryUI: !1,
            bProcessing: !1,
            sPaginationType: "simple",
            bDeferRender: !1,
            aaData: this.dataToDisplay,
            aoColumns: this.headers,
            columnDefs: [{targets: this.defaultHiddenColumns, visible: !1}, {targets: "_all", defaultContent: "N/A"}],
            bSortClasses: !1,
            aaSorting: [[0, "asc"]],
            sDom: '<".dataTables_header"<"#mt-actions"><"#mt-config"<"#mt-search.col-md-8"fr><"#dt-states-filter.dropdown col-md-2"><"#mt-columns.col-md-2">>>t',
            iDisplayLength: this.pageLength,
            oLanguage: {sSearch: "", sLengthMenu: s},
            createdRow: this._onCreatedRow,
            rowCallback: this._onRowCallback,
            autoWidth: !1
        }), this._bindUICallbacks(), $(".dataTables_filter input")[0].placeholder = "Search", $($(".dataTables_filter input")[0]).addClass("form-control");
        var r = new $.fn.dataTable.ColVis(this.table, {buttonText: '<i class="fa fa-gear"></i>'});
        $("#mt-columns").append(r.button())
    }, this._buildHeadersFromJsonData = function (e) {
        for (var t, i, n = !1, s = 0, r = e.headers.length; r > s; s++)t = this.headers.push({
            sTitle: e.headers[s][0],
            sType: e.headers[s][1],
            sClass: "ps_datatable_cell"
        }), i = e.headers[s][2], "undefined" == typeof i || "hidden" !== i && "details" !== i || ("details" === i && (n = !0), this.defaultHiddenColumns.push(t - 1));
        return n
    }, this.buildRowForModel = function (e) {
        var t = [], i = {};
        $.each(n.headers, function (i, n) {
            var s, r = n.sTitle.split("(")[0].toLowerCase().trim().toCamelCase();
            s = e.properties && void 0 != e.properties[r] ? e.properties[r] : $.isFunction(e[r]) ? e[r]() : e[r], t.push(s)
        }), i.model = e, i.callbackId = null;
        var s = n.extraData.push(i);
        return t.push(s - 1), t
    }, this.updateModel = function (e) {
        for (var t = n.dataToDisplay.length - 1; t >= 0; t--) {
            var i = n.dataToDisplay[t], s = i[i.length - 1], r = n.extraData[s].model;
            if (e.getId() == r.getId()) {
                var a = n.buildRowForModel(e);
                n.dataToDisplay[t] = a;
                break
            }
        }
    }, this.addModel = function (e) {
        var t = this.buildRowForModel(e);
        n.dataToDisplay.push(t)
    }, this.removeModel = function (e) {
        for (var t = n.dataToDisplay.length - 1; t >= 0; t--) {
            var i = n.dataToDisplay[t], s = i[i.length - 1], r = n.extraData[s].model;
            if (e.getId() == r.getId()) {
                n.dataToDisplay.splice(t, 1);
                break
            }
        }
    }, this._buildDataFromJsonData = function (e) {
        $.each(e.data, function (e, t) {
            n.addModel(t)
        })
    }, this._buildDetailsColumn = function () {
        var e = this.headers.length;
        this.headers.push({
            sTitle: "Details",
            sType: "html",
            sClass: "ps_datatable_cell",
            bVisible: !0
        }), $.each(this.dataToDisplay, function (t, i) {
            var s = '<a class="view_details" href="#"><img id="' + n.id + "_show_details_" + t + '" class="show_details" src="' + ICON_SHOW_MORE + '"></a>';
            s += '<a class="view_details" href="#"><img id="' + n.id + "_hide_details_" + t + '" class="hide_details invisible" src="' + ICON_HIDE_MORE + '"></a>', s += '<div class="div_details" id="' + n.id + "_div_details_" + t + '"></div>', i.splice(e, 0, s)
        })
    }, this.getNbOfModelsPerState = function (e, t) {
        var i = 0, s = e.source;
        return $.each(n.dataToDisplay, function (e, r) {
            var a = r[r.length - 1], o = n.extraData[a].model;
            "undefined" != typeof o.status_type ? $.isFunction(o.status_type[s]) ? o.status_type[s]() == t && (i += 1) : o.status_type[s] == t && (i += 1) : o.properties && o.properties[s] && o.properties[s] == t && (i += 1)
        }), i
    }, this.getStatesForStatusType = function (e) {
        for (var t = {}, i = e.source, s = n.dataToDisplay.length - 1; s >= 0; s--) {
            var r = n.dataToDisplay[s], a = r[r.length - 1], o = n.extraData[a].model, l = null;
            "undefined" != typeof o.status_type ? l = $.isFunction(o.status_type[i]) ? o.status_type[i]() : o.status_type[i] : o.properties && o.properties[i] && o.properties[i] == l && (l = o.properties[i]), l && (t[l] = "")
        }
        return t
    }, this.loadFilterAndTitlesForStatusType = function (e) {
        var t = "", i = 0;
        if (e.states || (e.states = this.getStatesForStatusType(e)), Object.keys(e.states).length > 0) {
            var s = '<div class="button-group"><button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="fa fa-filter"></span></button><ul class="dropdown-menu dropdown-menu-right">';
            $.each(e.states, function (r, a) {
                var o = n.getNbOfModelsPerState(e, r);
                i += o;
                var l = "default";
                switch (a) {
                    case"good":
                        l = "success";
                        break;
                    case"bad":
                        l = "danger";
                        break;
                    case"warning":
                        l = "warning";
                        break;
                    case"normal":
                        l = "info"
                }
                s += '<div class="dt-state checkbox checkbox-circle checkbox-' + l + '"><input type="checkbox" id="model-state-' + r + '" name="' + r + '" value="' + a + '" checked>', s += '<label for="model-state-' + r + '">' + r + "</label></div>", t += ' <span class="label label-' + l + '">' + o + '<span class="hidden-xs"> ' + r + "</span></span> "
            }), s += "</ul></div>", t += ' <span id="nbr_of_beacons" class="label label-info">' + i + '<span class="hidden-xs"> Total</span></span>', e.statesFilterHtml = s, e.titleHtml = t
        }
    }, this._buildStatusTypeSelectorFromJsonData = function (e) {
        this.status_types = e.status_types;
        var t = '<div id="dt-status-types-filter">';
        t += '<select class="hidden">', $.each(this.status_types, function (e, i) {
            t += '<option id="' + e + '">' + i.name + "</option>", n.loadFilterAndTitlesForStatusType(i)
        }), t += "</select>", t += "</div>", $("#mt-actions").append(t), $("#dt-status-types-filter select").on("change", function () {
            var e = n.status_types[$("option:selected", this).attr("id")];
            n.onStatusTypeChanged(e)
        }), $("#dt-status-types-filter select").trigger("change")
    }, this._bindUICallbacks = function () {
        this._createDetailsDiv(), this._initiateMultiselection()
    }, this._createDetailsDiv = function () {
        $("#" + n.id + " img.show_details").on("click", function () {
            var e, t = null, i = n.headers.length;
            for (e = 1; i > e; e++)n.table.fnSettings().aoColumns[e].bVisible || t++;
            if (t > 0) {
                var s = $(this).parents("tr")[0], r = "", a = n.table.fnGetData(s), o = $(this).parents("td").children("div").attr("id"), l = o.replace("" + n.id + "_div_details_", "");
                for ($("#" + n.id + " .div_details").hide(), $("#" + n.id + " img.hide_details").hide(), $("#" + n.id + " img.show_details").show(), r += '<table cellpadding="0" cellspacing="0" border="0">', e = 1, i = n.headers.length; i > e; e++)n.table.fnSettings().aoColumns[e].bVisible || (r += '<tr><td class="div_details_headers">' + n.headers[e].sTitle + '</td><td class="div_details_datas"> : ' + a[e] + "</td></tr>");
                r += "</table>", $("#" + o).html(r);
                var h = $(this).parents("td").children("a");
                return h.children("#" + n.id + "_hide_details_" + l).removeClass("invisible"), h.children("#" + n.id + "_show_details_" + l).toggle(), h.children("#" + n.id + "_hide_details_" + l).toggle(), $("#" + o).show(), !1
            }
        }), $("#" + n.id + " img.hide_details").on("click", function () {
            $(this).parents("td").children("a").children("img").toggle(), $("#" + n.id + " div.div_details").hide()
        })
    }, this._initiateMultiselection = function () {
        var e = $("#" + n.id + " tbody");
        e.on("click", "tr", function (t) {
            var i = [];
            if (0 === t.button)if (t.ctrlKey || t.shiftKey)if (t.ctrlKey && !t.shiftKey) i = n.currentSelectedModels.slice(), $(this).hasClass("row_selected") ? n._removeModelFrom(i, n.getModel($(this))) : i.push(n.getModel($(this))); else if (!t.ctrlKey && t.shiftKey) {
                var s = n._selectFromPivotRowTo(this, e);
                i = $.map(s, function (e) {
                    return n.getModel(e)
                })
            } else {
                i = n.currentSelectedModels.slice(0, -1);
                var s = n._selectFromPivotRowTo(this, e), r = $.map(s, function (e) {
                    return n.getModel(e)
                });
                i = i.concat(r)
            } else(n.currentSelectedModels.length > 1 || !$(this).hasClass("row_selected")) && i.push(n.getModel($(this)));
            i.length > 0 ? n._onRowClickedCb(i, "selected") : n._onRowClickedCb(i, "unselected");
            var a = _.difference(n.currentSelectedModels, i);
            a.length && n._onRowClickedCb(a, "unselected"), n.currentSelectedModels = i
        })
    }, this._selectFromPivotRowTo = function (e, t) {
        for (var i = [], s = _.last(n.currentSelectedModels).fullRow.row, r = $("tr", t), a = r.index(e), o = r.index(s), l = Math.min(a, o), h = Math.max(a, o), u = l; h >= u; u++)a > o ? i.unshift(r.eq(u)) : i.push(r.eq(u));
        return i
    }, this._removeModelFrom = function (e, t) {
        for (var i = 0, n = e.length; e[i] !== t && n > i;)i++;
        i >= n || e.splice(i, 1)
    }, this._clearBrowserTextSelection = function () {
        window.getSelection ? window.getSelection().empty ? window.getSelection().empty() : window.getSelection().removeAllRanges && window.getSelection().removeAllRanges() : document.selection && document.selection.empty()
    }, this._onRowClickedCb = function () {
    }, this._onModelsFiltered = function () {
    }, this._onStatusTypeSourceChanged = function () {
    }, this.redraw = function () {
        this.table.api().draw(!1)
    }, this.reload = function () {
        this.table.fnClearTable(), this.dataToDisplay.length > 0 && this.table.fnAddData(this.dataToDisplay), this.currentStatusType && this.setStatusType({
            name: this.currentStatusType.name,
            source: this.currentStatusType.source,
            states: this.currentStatusType.states
        })
    }, this._onRowCallback = function (e, t) {
        var i = t[t.length - 1], s = n.extraData[i];
        s && (s.model.isSelected() ? $(e).addClass("row_selected") : $(e).removeClass("row_selected"))
    }, this._onModelEvent = function (e, t) {
        switch (log("ModelTable " + e + " " + t.getInfo()), e) {
            case"hide":
                n.table.api().row(t.fullRow.row).remove();
                break;
            case"show":
                n.table.api().row.add(t.fullRow.data);
                break;
            case"selected":
                n.currentSelectedModels.push(t);
                break;
            case"unselected":
                n._removeModelFrom(n.currentSelectedModels, t);
                break;
            case"data_updated":
                n.updateModel(t), n.reload()
        }
    }, this._onCreatedRow = function (e, t) {
        var i = t[t.length - 1], s = n.extraData[i];
        s && (s.model.fullRow = {row: e, data: t}, s.model.addListener(n._onModelEvent))
    }, this.getCurrentModelsStatus = function () {
        return this.currentStatusType
    }, this.getSelectedRows = function () {
        return $("#" + this.id + " tr.row_selected")
    }, this.getDisplayedRows = function () {
        return $("#" + this.id + " tbody tr")
    }, this.getRows = function () {
        return this.table.api().rows().data()
    }, this.getRowData = function (e) {
        return this.table.api().row(e).data()
    }, this.getModel = function (e) {
        var t = this.getRowData(e), i = t[t.length - 1], s = n.extraData[i];
        return s.model
    }, this.setStatusType = function (e) {
        this.currentStatusType = e, this.loadFilterAndTitlesForStatusType(e);
        var t = $("#dt-states-filter");
        $(".dt-state", t).detach(), t.html(e.statesFilterHtml), $("#mt-title").html(e.titleHtml), this._onStatusTypeSourceChanged(e.source, e.states), $("input", t).on("change", function () {
            var i = $("input[type=checkbox]:checked", t);
            n.onStatesFilterChanged(e, i)
        })
    }, this.reloadCurrentStatusType = function () {
        this.currentStatusType && (this.currentStatusType.states = this.getStatesForStatusType(this.currentStatusType), this.setStatusType(this.currentStatusType))
    }, this.onStatusTypeSourceChanged = function (e) {
        this._onStatusTypeSourceChanged = e
    }, this.onModelsFiltered = function (e) {
        this._onModelsFiltered = e
    }, this.onRowClicked = function (e) {
        this._onRowClickedCb = e
    }, this.onStatusTypeChanged = function (e) {
        this.setStatusType(e);
        var t = $("#dt-states-filter input[type=checkbox]");
        t.trigger("change")
    }, this.onStatesFilterChanged = function (e, t) {
        var i = e.source, s = $.map(t, function (e) {
            return $(e).attr("name")
        }), r = [], a = [];
        $.each(n.dataToDisplay, function (e, t) {
            var o = t[t.length - 1], l = n.extraData[o].model, h = !1;
            "undefined" != typeof l.status_type ? $.isFunction(l.status_type[i]) ? $.inArray(l.status_type[i](), s) > -1 && (r.push(t), h = !0) : $.inArray(l.status_type[i], s) > -1 && (r.push(t), h = !0) : l.properties && l.properties[i] && $.inArray(l.properties[i], s) > -1 && (r.push(t), h = !0), h && a.push(l)
        }), this._onModelsFiltered(a)
    }, this.switchPageForModel = function (e) {
        this.table.fnGetPageOfRow(e.fullRow.row)
    }, this.initialize(e, t, i)
}
function showMap() {
    $("#table_zone").hide(), $("#map_zone").show()
}
function showList() {
    $("#map_zone").hide(), $("#table_zone").show()
}
function compareArrays(e, t) {
    if (e.length !== t.length)return !1;
    for (var i = 0; i < e.length; i++)if (e[i] !== t[i])return !1;
    return !0
}
function AccessPoint(e, t, i, n, s, r, a) {
    this.bssid = e, this.technology = t, this.min = i, this.max = n, this.lon = s, this.lat = r, this.alt = a, this.floor = find_floor_by_lonlatalt(s, r, a), this.create = function () {
        var t = new OpenLayers.Geometry.Point(this.lon, this.lat);
        wgs84ToMercator(t);
        var i = new OpenLayers.Feature.Vector(t, {description: e}, {
            externalGraphic: "https://ncpasst.s3.amazonaws.com/assets/marker-ac249723e43febe676dff1c531341e31.png",
            graphicHeight: 25,
            graphicWidth: 21,
            graphicXOffset: -12,
            graphicYOffset: -25
        });
        this.floor.apLayer.addFeatures(i)
    }, this.toJson = function () {
        return {lat: this.lat, lon: this.lon, display_name: this.bssid}
    }
}
function Bluespot(e) {
    var t = this;
    this.init = function (e) {
        this.properties = {}, this.feature = e, this.id = e.attributes.bluespotId, this.status = e.attributes.status, this.isSaved = e.attributes.isSaved, this.isDeleted = !1, this.listeners = [], this.tags = e.attributes.tags, this.comment = e.attributes.comment, this.id || (this.id = bluespotMaxId + 1), this.id > bluespotMaxId && (bluespotMaxId = this.id), allBluespots[this.id] = this, this.feature.attributes.bluespotId = this.id, this.setAlt(e.attributes.bluespotAlt), this.setCurrentDataAsOriginalData()
    }, this.getTags = function () {
        var e = "";
        return void 0 != this.tags && (e = this.tags.join(", ")), e
    }, this.setCurrentDataAsOriginalData = function () {
        this.orgLon = this.lon(), this.orgLat = this.lat(), this.orgLabel = this.getLabel(), this.orgAlt = this.alt, this.orgComment = this.comment
    }, this.onSaved = function () {
        this.setCurrentDataAsOriginalData(), this.isSaved = !0, this.isDeleted && delete allBluespots[this.id]
    }, this.getFloor = function () {
        return this.floor
    }, this.getCenter = function () {
        return new OpenLayers.LonLat(this.orgLon, this.orgLat).transform("EPSG:4326", "EPSG:3857")
    }, this.status_type = {
        implantation_status: "Required", installation_status: function () {
            return "undefined" != typeof t.properties.isInstalled ? t.properties.isInstalled === !1 ? "Not installed" : "Installed" : "undefined" == typeof t.label() || "" === t.label() || null === t.label() ? "Not installed" : "Installed"
        }, pdb_status: function () {
            return t.feature.attributes.customAttrs.in_pdb === !0 ? "Used" : "Not used"
        }
    }, this.seen = function () {
        return "undefined" == typeof t.properties.daysNotSeen || t.properties.daysNotSeen < 0 ? "never seen" : t.properties.daysNotSeen
    }, this.endOfLife = function () {
        return "undefined" == typeof t.properties.daysBeforeOrAfterEndOfLife || null === t.properties.daysBeforeOrAfterEndOfLife ? "unknown" : t.properties.daysBeforeOrAfterEndOfLife < -365 ? "in " + (Math.abs(t.properties.daysBeforeOrAfterEndOfLife) / 365).toFixed(1) + " years" : t.properties.daysBeforeOrAfterEndOfLife < -30 ? "in " + (Math.abs(t.properties.daysBeforeOrAfterEndOfLife) / 30).toFixed(1) + " months" : t.properties.daysBeforeOrAfterEndOfLife < 0 ? "in " + Math.abs(t.properties.daysBeforeOrAfterEndOfLife) + " days" : t.properties.daysBeforeOrAfterEndOfLife > 0 ? t.properties.daysBeforeOrAfterEndOfLife + " days ago" : "today"
    }, this.isDirty = function () {
        return this.isDeleted || this.isNew() || this.hasChangedPosition() || this.hasChangedLabel() || this.hasChangedAlt() || this.hasChangedComment()
    }, this.isNew = function () {
        return !this.isSaved
    }, this.hasChangedPosition = function () {
        return this.orgLon !== this.lon() || this.orgLat !== this.lat()
    }, this.hasChangedLabel = function () {
        return this.orgLabel !== this.getLabel()
    }, this.hasChangedAlt = function () {
        return this.orgAlt !== this.alt
    }, this.hasChangedComment = function () {
        return this.orgComment !== this.comment
    }, this.setLabel = function (e) {
        this.feature.attributes.bluespotLabel = e
    }, this.getLabel = function () {
        var e = "";
        return this.feature && (e = this.feature.attributes.bluespotLabel), e
    }, this.label = function () {
        return this.getLabel()
    }, this.setStatus = function (e) {
        this.status = e, null != this.feature && (this.feature.attributes.status = e)
    }, this.displayRadius = function () {
        if (this.floor.bluespotRadiusLayer) {
            var e = new OpenLayers.Projection("EPSG:4326"), t = site.map.getProjectionObject();
            this.radiusFeature = new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(this.lon(), this.lat()).transform(e, t), {bluespotId: this.id}), this.floor.bluespotRadiusLayer.addFeatures(this.radiusFeature)
        }
    }, this.removeRadius = function () {
        this.radiusFeature && (this.floor.bluespotRadiusLayer.removeFeatures(this.radiusFeature), this.radiusFeature = null)
    }, this.redrawRadius = function () {
        this.removeRadius(), this.displayRadius()
    }, this.toJson = function () {
        var e = {number: this.id, deleted: !0};
        return this.isDeleted || (e = {
            lon: this.lon(),
            lat: this.lat(),
            alt: this.alt,
            number: this.id,
            label: this.getLabel(),
            comment: this.comment,
            building_id: currentBuilding.id
        }), e
    }, this.lon = function () {
        var e = null;
        if (this.feature) {
            var t = new OpenLayers.Geometry.Point(this.feature.geometry.x, this.feature.geometry.y);
            mercatorToWgs84(t), e = t.x
        }
        return e
    }, this.lat = function () {
        var e = null;
        if (this.feature) {
            var t = new OpenLayers.Geometry.Point(this.feature.geometry.x, this.feature.geometry.y);
            mercatorToWgs84(t), e = t.y
        }
        return e
    }, this.erase = function () {
        this.feature && (this.floor.bluespotLayer.removeFeatures([this.feature]), this.feature = null), this.radiusFeature && this.floor.bluespotRadiusLayer && (this.floor.bluespotRadiusLayer.removeFeatures([this.radiusFeature]), this.radiusFeature = null), this.trigger("removed"), this.isDeleted = !0
    }, this.select = function () {
        this.previousStatus = this.status, this.setStatus("select"), this.trigger("selected")
    }, this.unselect = function () {
        this.previousStatus && (this.setStatus(this.previousStatus), delete this.previousStatus, this.trigger("unselected"))
    }, this.isSelected = function () {
        return "select" === this.status
    }, this.redraw = function () {
        this.feature.layer == this.floor.bluespotLayer ? this.floor.bluespotLayer.redraw(this.feature) : (this.feature.layer.removeFeatures([this.feature]), this.floor.bluespotLayer.addFeatures([this.feature]))
    }, this.setAlt = function (e) {
        this.feature.attributes.bluespotAlt = e, this.alt = this.feature.attributes.bluespotAlt, this.floor = find_floor_by_lonlatalt(this.lon(), this.lat(), this.alt)
    }, this.highlight = function () {
        this.select(), this.redraw()
    }, this.unhighlight = function () {
        this.unselect(), this.redraw()
    }, this.getFloor = function () {
        var e = find_floor_by_lonlatalt(0, 0, this.alt);
        return e
    }, this.centerOnMap = function () {
        var e = this.getFloor();
        e.setAsCurrent(), site.psMap.centerFeature(this.feature)
    }, this.hide = function () {
        this.feature.style = {visibility: "hidden"}, this.trigger("hide")
    }, this.show = function () {
        this.feature.style = null, this.trigger("show")
    }, this.hidden = function () {
        return this.feature.style && "hidden" === this.feature.style.visibility
    }, this.addListener = function (e) {
        this.listeners.indexOf(e) < 0 && this.listeners.push(e)
    }, this.getId = function () {
        return this.id
    }, this.getInfo = function () {
        var e = "";
        return this.label() && (e += "Label: " + this.label() + " "), this.endOfLife() && "unknown" != this.endOfLife() && (e += "Estimated end of life: " + this.endOfLife() + " "), this.seen() && "never seen" != this.seen() && (e += "Seen: " + this.seen() + " "), this.lon() && (e += "Lon: " + this.lon() + " "), this.lat() && (e += "Lat: " + this.lat() + " "), e
    }, this.removeListener = function (e) {
        var t;
        switch ($.type(e)) {
            case"function":
                t = this.listeners.indexOf(e);
                break;
            case"number":
                t = e;
                break;
            default:
                return !1
        }
        t > -1 && this.listeners.splice(t, 1)
    }, this.trigger = function (e) {
        var t = this;
        $.each(this.listeners, function (i, n) {
            n.call(null, e, t)
        })
    }, this.init(e)
}
function Building(e, t, i) {
    var n = this;
    this.id = e, this.name = t, this.site = i, this.site.addBuilding(this), this.floors = [], this.preloadInfo = {}, this.addFloor = function (e) {
        n.floors.push(e)
    }, this.removeFloor = function (e) {
        for (var t = this.floors.length - 1; t >= 0; t--)if (this.floors[t].id == e.id) {
            this.floors.remove(t);
            break
        }
    }, this.setAsCurrent = function () {
        $(".floor-selected").removeClass("floor-selected"), $("#building-" + n.id + "-floors").toggle()
    }, this.getGroundFloor = function () {
        for (var e = null, t = this.floors.length - 1; t >= 0; t--) {
            var i = this.floors[t].level_number;
            if (0 == i)return this.floors[t];
            (null == e || i > 0 && i < e.level_number) && (e = this.floors[t])
        }
        return e
    }
}
function Floor(e, t, i, n, s, r, a) {
    var o = this;
    this.id = e, this.name = t, this.level_number = i, this.altitude = n, this.building = s, this.building && this.building.addFloor(this), this.listeners = [], this.blueprint = r, this.blueprint_json = a, this.graphLayer = new OpenLayers.Layer.Vector("GraphLvl" + this.id), this.logLayer = new OpenLayers.Layer.Vector("LogsLvl" + this.id), this.apLayer = new OpenLayers.Layer.Vector("APsLvl" + this.id), this.heatmapLayer = new OpenLayers.Layer.Vector("Heatmap" + this.id);
    var l = {
        externalGraphic: "https://ncpasst.s3.amazonaws.com/assets/bluespot-efb3674d8b6b422e93d599411f31ac52.png",
        graphicHeight: 30,
        graphicWidth: 30,
        graphicXOffset: -28,
        graphicYOffset: -28
    }, h = {
        normal: "https://ncpasst.s3.amazonaws.com/assets/bluespot-efb3674d8b6b422e93d599411f31ac52.png",
        good: {externalGraphic: "https://ncpasst.s3.amazonaws.com/assets/bluespot_green-4592c2713c987af1caf7b12f0a345114.png"},
        unknown: {externalGraphic: "https://ncpasst.s3.amazonaws.com/assets/bluespot_grey-9a360960a99067dc1f554a9db892df93.png"},
        bad: {externalGraphic: "https://ncpasst.s3.amazonaws.com/assets/bluespot_red-3b787ff187181280486c76ab5946f391.png"},
        warning: {externalGraphic: "https://ncpasst.s3.amazonaws.com/assets/bluespot_orange-93483a4294be6ad59c07a4b31261e030.png"},
        select: {externalGraphic: "https://ncpasst.s3.amazonaws.com/assets/bluespot_pink-7cc06f58103ac3ab8684e476c576febd.png"}
    }, u = new OpenLayers.StyleMap(l);
    u.addUniqueValueRules("default", "status", h), this.bluespotLayer = new OpenLayers.Layer.Vector("Bluespots" + this.id, {styleMap: u});
    var c = new OpenLayers.Style({
        fillColor: "#64a0d4",
        strokeColor: "#64a0d4",
        strokeOpacity: .1,
        strokeWidth: 0,
        fillOpacity: .2,
        pointRadius: "${dynamic_radius}"
    }, {
        context: {
            dynamic_radius: function () {
                return 30 / site.map.getResolution()
            }
        }
    }), p = new OpenLayers.StyleMap({"default": c});
    this.bluespotRadiusLayer = new OpenLayers.Layer.Vector("BluespotsRadius" + this.id, {styleMap: p}), this.additionalLayers = [this.graphLayer, this.logLayer, this.apLayer, this.heatmapLayer, this.bluespotRadiusLayer, this.bluespotLayer], site.map.addLayers(this.additionalLayers), this.heatmap = null, this.toJson = function () {
        var e = {};
        return e.id = this.id, e.name = this.name, e.number = this.level_number, e.polygons = [], this.blueprint_json && (e.polygons = this.blueprint_json.getPolygonsInJson()), e
    }, this.setHeatmap = function (e) {
        this.heatmap = e
    }, this.to_label = function () {
        var e = "overview" == this.id ? "Site overview" : this.building.name + " / " + this.name;
        return e
    }, this.addPOI = function (e) {
        if (e instanceof Array)for (var t = 0; t < e.length; t++)o.pois.push(e[t]); else o.pois.push(e)
    }, this.removePOI = function (e) {
        for (var t = this.pois.length - 1; t >= 0; t--)if (this.pois[t].id == e.id) {
            this.pois.remove(t);
            break
        }
    }, this.addListener = function (e) {
        this.listeners.push(e)
    }, this.removeListener = function (e) {
        this.listeners.slice(e)
    }, this.setAsCurrent = function () {
        $.each(this.listeners, function (e, t) {
            t.onFloorAboutToChange(currentFloor)
        });
        for (var e in floors)floors[e].id == this.id ? (floors[e].show(), $("#floor-" + this.id + ".olButton").addClass("active")) : (floors[e].hide(), floors[e].deactivateHandlers(), $("#floor-" + floors[e].id + ".olButton").removeClass("active"));
        currentFloor = this, this.activateHandlers(), graphController && graphController.changeCurrentFloor(), this.building && this.building.site.savePreferenceFloorId(), $.each(this.listeners, function (e, t) {
            t.onFloorChanged(o)
        })
    }, this.isCurrentFloor = function () {
        return currentFloor && this.id == currentFloor.id
    }, this.show = function () {
        var e, t = this.additionalLayers.length;
        for (e = 0; t > e; e++)this.additionalLayers[e].setOpacity(1);
        this.blueprint && this.blueprint.show(), this.blueprint_json && this.blueprint_json.show(), null != this.heatmap && this.heatmap.show()
    }, this.hide = function () {
        var e, t = this.additionalLayers.length;
        for (e = 0; t > e; e++)this.additionalLayers[e].setOpacity(0);
        this.blueprint && this.blueprint.hide(), this.blueprint_json && this.blueprint_json.hide(), null != this.heatmap && this.heatmap.hide()
    }, this.setOpacity = function (e) {
        e >= 1 ? e = 1 : 0 >= e && (e = 0);
        for (var t = 0; t < this.additionalLayers.length; t++)this.additionalLayers[t].setOpacity(e);
        this.blueprint && this.blueprint.setOpacity(e), this.blueprint_json && this.blueprint_json.setOpacity(e)
    }, this.getOpacity = function () {
        var e = 0;
        this.blueprint ? e = this.blueprint.getOpacity() : this.blueprint_json && (e = this.blueprint_json.getOpacity())
    }, this.setAsReference = function () {
        $("#floor-" + o.id).addClass("floor-reference")
    }, this.unsetAsReference = function () {
        $("#floor-" + o.id).removeClass("floor-reference")
    }, this.upStairs = function () {
        for (var e = null, t = o.building.floors, i = 0; t.length > 1 && i < t.length && !e;)t[i].altitude == o.altitude && t[i - 1] && (e = t[i - 1]), i++;
        return e
    }, this.downStairs = function () {
        for (var e = null, t = o.building.floors, i = 0; t.length > 1 && i < t.length && !e;)t[i].altitude == o.altitude && t[i + 1] && (e = t[i + 1]), i++;
        return e
    }, this.adjust = function () {
        this.blueprint && (georefManager && georefManager.deactivate(), georefManager = new GeorefImageController(this.blueprint))
    }, this.resetGeoreference = function () {
        this.blueprint && (this.blueprint.resetGeoreference(), this.adjust())
    }, this.onKeyDown = function () {
    }, this.handlers = {keyboard: new OpenLayers.Handler.Keyboard(this, {keydown: this.onKeyDown})}, this.activateHandlers = function () {
        this.handlers.keyboard.setMap(site.map), this.handlers.keyboard.activate()
    }, this.deactivateHandlers = function () {
        this.handlers.keyboard.deactivate()
    }, this.area = function () {
        var e = void 0;
        if (this.blueprint) {
            var t = this.blueprint.realSizeInMeters();
            e = t[0] * t[1]
        }
        return e
    }
}
function find_floor_by_lonlatalt(e, t, i) {
    var n = null, s = -1e3;
    if ("undefined" != typeof i && null !== i) {
        i = Math.round(2 * i) / 2;
        for (var r in floors) {
            if (floors[r].altitude == i) {
                n = floors[r];
                break
            }
            floors[r].altitude < i && floors[r].altitude > s && (n = floors[r], s = floors[r].altitude)
        }
    }
    return n || (n = floors.overview), n
}
function find_floor_by_level_number(e) {
    var t = null;
    for (var i in floors)if (floors[i].level_number == e) {
        t = floors[i];
        break
    }
    return t
}
function add_floor_to_list(e, t, i, n, s) {
    $("#add-floor-btn").click();
    var r = $("div.floor-form").filter(function () {
        return "" == $(this).find("input:text:first")[0].value
    })[0];
    $($(r).find("h5")[0]).html(t), $(r).find("input:text")[0].value = t, $(r).find("input:text")[1] && ($(r).find("input:text")[1].value = n), $(r).find("img")[0].src = s, $(r).find("select")[0].value = i;
    var a = new RegExp("building_floors_attributes_([0-9]+)_"), o = $($(r).find("input:text")[0]).attr("id").match(a)[1];
    html = '<input id="building_floors_attributes_' + o + '_id" type="hidden" value="' + e + '" name="building[floors_attributes][' + o + '][id]">', $(r).append(html), $("#save-building-btn").show()
}
function GeorefImage(e, t, i, n) {
    var s = this;
    this.imagePath = i, this.opacity = 1, this.map = e, this.original_latlonbox = n, this.setAsAlwaysOnScreen = function () {
        var e = site.map.getCenter().lon, t = site.map.getCenter().lat, i = 2e3;
        this.pointFeature.geometry.setBounds(new OpenLayers.Bounds(e - i, t - i, e + i, t + i))
    }, this.resetGeoreference = function () {
        this.extractGeoreferenceFromLatLonBox(this.original_latlonbox), this.vectorLayer.drawFeature(this.pointFeature)
    }, this.extractGeoreferenceFromLatLonBox = function (e) {
        if ("undefined" != typeof e && null != e) {
            var t = (e.north + e.south) / 2, n = (e.east + e.west) / 2, s = wgs84ToMercator(new OpenLayers.LonLat(n, t)), r = s.lon, a = s.lat, o = wgs84ToMercator(new OpenLayers.Geometry.Point(e.west, e.north)), l = wgs84ToMercator(new OpenLayers.Geometry.Point(e.east, e.north)), h = wgs84ToMercator(new OpenLayers.Geometry.Point(e.west, e.south)), u = o.distanceTo(l), c = o.distanceTo(h), p = Math.round(-e.rotation);
            this.x = r, this.y = a, this.width = u, this.height = c, this.rotation = p
        } else {
            var d = new Image;
            d.src = i;
            var u = d.width, c = d.height, f = Math.ceil(350 * this.map.getResolution());
            if (u > f) {
                var m = f / u;
                u = f, c = Math.ceil(m * c)
            }
            if (this.x = this.map.getCenter().lon, this.y = this.map.getCenter().lat, this.width = u, this.height = c, this.rotation = 0, 0 === u || 0 === c) {
                var g = this;
                d.onload = function () {
                    g.resetGeoreference()
                }
            }
        }
    }, this.extractGeoreferenceFromLatLonBox(n), this.context = {
        getW: function () {
            return s.width / e.getResolution()
        }, getH: function () {
            return s.height / e.getResolution()
        }, getR: function () {
            return s.rotation
        }, getXO: function () {
            return .5 * (-s.width / e.getResolution())
        }, getYO: function () {
            return .5 * (-s.height / e.getResolution())
        }, getOpa: function () {
            return s.opacity
        }
    };
    var r = {
        externalGraphic: this.imagePath,
        graphicWidth: "${getW}",
        graphicHeight: "${getH}",
        rotation: "${getR}",
        graphicXOffset: "${getXO}",
        graphicYOffset: "${getYO}",
        fillOpacity: "${getOpa}"
    }, a = new OpenLayers.Style(r, {context: this.context});
    this.vectorLayer = new OpenLayers.Layer.Vector(t), this.vectorLayer.styleMap = a, e.addLayers([this.vectorLayer]);
    var o = new OpenLayers.Geometry.Point(this.x, this.y);
    this.pointFeature = new OpenLayers.Feature.Vector(o), this.setAsAlwaysOnScreen(), this.vectorLayer.addFeatures([this.pointFeature]), this.ctrlDragFeature = null, this.setAsDraggable = function (t) {
        null != t && (this.ctrlDragFeature = new OpenLayers.Control.DragFeature(this.vectorLayer), this.ctrlDragFeature.onComplete = function () {
            s.x = s.pointFeature.geometry.x, s.y = s.pointFeature.geometry.y, t(s.x, s.y)
        }, e.addControl(this.ctrlDragFeature), this.ctrlDragFeature.activate())
    }, this.disableDragControl = function () {
        null != this.ctrlDragFeature && this.ctrlDragFeature.deactivate()
    }, this.enableDragControl = function () {
        null != this.ctrlDragFeature && this.ctrlDragFeature.activate()
    }, this.getGeoreference = function () {
        var e = this.getLatLonBox(), t = JSON.stringify(e);
        return t
    }, this.updateValues = function (e, t, i, n, s, r) {
        this.opacity = r >= 1 ? 1 : 0 >= r ? 0 : r, this.width = i, this.height = n, this.rotation = s, this.x = e, this.y = t, this.pointFeature.geometry.x = this.x, this.pointFeature.geometry.y = this.y, this.vectorLayer.drawFeature(this.pointFeature);
        var a = $("#floor-width"), o = $("#floor-height");
        if (0 != a.length && 0 != o.length) {
            var l = this.realSizeInMeters();
            a.val(l[0]), o.val(l[1])
        }
    }, this.show = function () {
        this.vectorLayer.setOpacity(this.opacity)
    }, this.hide = function () {
        this.vectorLayer.setOpacity(0)
    }, this.setOpacity = function (e) {
        0 >= e ? (this.vectorLayer.removeFeatures([this.pointFeature]), this.vectorLayer.setOpacity(0)) : (this.vectorLayer.addFeatures([this.pointFeature]), this.vectorLayer.setOpacity(e), this.opacity = e)
    }, this.getOpacity = function () {
        return this.vectorLayer.opacity
    }, this.realSize = function () {
        this.x, this.y;
        var e = new Image;
        e.src = this.imagePath;
        var t = [e.width, e.height];
        return t
    }, this.realSizeInMeters = function () {
        var e = currentFloor.blueprint.cornersMercator(), t = new OpenLayers.Geometry.Point(e[0].lon, e[0].lat), i = new OpenLayers.Geometry.Point(e[1].lon, e[1].lat), n = new OpenLayers.Geometry.Point(e[2].lon, e[2].lat), s = new OpenLayers.Geometry.LineString([t, i]), r = new OpenLayers.Geometry.LineString([i, n]), a = s.getGeodesicLength(new OpenLayers.Projection("EPSG:900913")), o = r.getGeodesicLength(new OpenLayers.Projection("EPSG:900913"));
        return [a, o]
    }, this.sizeRatio = function () {
        var e = this.realSize(), t = this.vectorLayer.styleMap.context.getW(this.pointFeature), i = this.vectorLayer.styleMap.context.getH(this.pointFeature), n = [t / e[0], i / e[1]];
        return n
    }, this.pixelToMercator = function (t, i, n) {
        var s = this.x, r = this.y, a = new Image;
        a.src = this.imagePath;
        var o, l = this.vectorLayer.styleMap.context.getW(this.pointFeature), h = this.vectorLayer.styleMap.context.getH(this.pointFeature), u = this.vectorLayer.styleMap.context.getXO(this.pointFeature), c = this.vectorLayer.styleMap.context.getYO(this.pointFeature), p = s + u * e.getResolution(), d = r - c * e.getResolution(), f = p + t * e.getResolution() * (l / a.width), m = d - i * e.getResolution() * (h / a.height);
        if (n) o = new OpenLayers.LonLat(f, m); else {
            var g = this.vectorLayer.styleMap.context.getR(this.pointFeature), y = g * Math.PI / 180, v = s + (f - s) * Math.cos(y) + (m - r) * Math.sin(y), b = r + (m - r) * Math.cos(y) - (f - s) * Math.sin(y);
            o = new OpenLayers.LonLat(v, b)
        }
        return o
    }, this.cornersMercator = function () {
        var e = this.imagePath, t = new Image;
        t.src = e;
        var i = this.pixelToMercator(0, 0), n = this.pixelToMercator(t.width, 0), s = this.pixelToMercator(t.width, t.height), r = this.pixelToMercator(0, t.height);
        return [i, n, s, r]
    }, this.toKML = function () {
        var e = this.imagePath, t = this.getLatLonBox(), i = "";
        return i += '<?xml version="1.0" encoding="UTF-8"?>\r\n', i += '<kml xmlns="http://earth.google.com/kml/2.1">\r\n', i += "<GroundOverlay>\r\n", i += "  <name>GeorefImage</name>\r\n", i += "  <Icon>\r\n", i += "    <href>http://localhost:3000" + e + "</href>\r\n", i += "    <viewBoundScale>1.00</viewBoundScale>\r\n", i += "  </Icon>\r\n", i += "  <LatLonBox>\r\n", i += "    <north>" + t.north + "</north>\r\n", i += "    <south>" + t.south + "</south>\r\n", i += "    <east>" + t.east + "</east>\r\n", i += "    <west>" + t.west + "</west>\r\n", i += "    <rotation>" + t.rotation + "</rotation>\r\n", i += "  </LatLonBox>\r\n", i += "</GroundOverlay>\r\n", i += "</kml>"
    }, this.fromKML = function (e) {
        var t = !1;
        regex = /\<north\>(.*)\<\/north\>$/gm;
        var i = regex.exec(e);
        regex = /\<south\>(.*)\<\/south\>$/gm;
        var n = regex.exec(e);
        regex = /\<east\>(.*)\<\/east\>$/gm;
        var s = regex.exec(e);
        regex = /\<west\>(.*)\<\/west\>$/gm;
        var r = regex.exec(e);
        regex = /\<rotation\>(.*)\<\/rotation\>$/gm;
        var a = regex.exec(e);
        if (i && n && s && r) {
            var o = {
                north: parseFloat(i[1]),
                south: parseFloat(n[1]),
                east: parseFloat(s[1]),
                west: parseFloat(r[1]),
                rotation: parseFloat(a[1])
            };
            o.north < o.south && (o.rotation += 180), o.east < o.west && (o.rotation += 180), this.extractGeoreferenceFromLatLonBox(o), this.pointFeature.geometry.x = this.x, this.pointFeature.geometry.y = this.y, this.vectorLayer.drawFeature(this.pointFeature), t = !0
        }
        return t
    }, this.getLatLonBox = function () {
        var e = new Image;
        e.src = this.imagePath;
        var t = this.vectorLayer.styleMap.context.getR(this.pointFeature), i = mercatorToWgs84(this.pixelToMercator(0, 0, !0)), n = mercatorToWgs84(this.pixelToMercator(e.width, 0, !0)), s = mercatorToWgs84(this.pixelToMercator(0, e.height, !0)), r = {
            north: parseFloat(i.lat.toFixed(12)),
            south: parseFloat(s.lat.toFixed(12)),
            east: parseFloat(n.lon.toFixed(12)),
            west: parseFloat(i.lon.toFixed(12)),
            rotation: parseFloat(-t.toFixed(12))
        };
        return r
    }, this.toWorldfile = function () {
        var e = this.imagePath, t = new Image;
        t.src = e;
        var i = mercatorToWgs84(this.pixelToMercator(0, 0)), n = mercatorToWgs84(this.pixelToMercator(t.width, 0)), s = mercatorToWgs84(this.pixelToMercator(0, t.height)), r = (n.lon - i.lon) / t.width, a = (s.lon - i.lon) / t.width, o = (n.lat - i.lat) / t.height, l = (s.lat - i.lat) / t.height, h = [r, o, a, l, i.lon, i.lat];
        return h
    }, this.pixelToWgs84 = function (e, t) {
        var i = mercatorToWgs84(this.pixelToMercator(e, t));
        return i
    }
}
function Graph() {
    var e = this;
    this.nodes = {}, this.segments = {}, this.length = function () {
        var t = 0;
        for (var i in e.segments)e.segments[i] && (t += e.segments[i].length());
        return t
    }, this.addNode = function (t) {
        t && (e.nodes[t.id] = t)
    }, this.deleteOnFloor = function (e) {
        if (e) {
            for (var t in this.segments) {
                var i = this.segments[t];
                i.isTransition || i.floor.id != e.id || this.removeSegment(i)
            }
            this.removeLonelyNodes()
        }
    }, this.removeNode = function (t) {
        t.floor && t.floor.graphLayer.removeFeatures([t.feature]), t.feature && t.feature.destroy(), delete e.nodes[t.id]
    }, this.removeNodeAndItsConnectedSegments = function (t) {
        for (; t.connectedSegments.length > 0;)e.removeSegment(t.connectedSegments[0]);
        this.removeNode(t)
    }, this.removeLonelyNodes = function () {
        for (var e in this.nodes)0 == this.nodes[e].connectedSegments.length && this.removeNode(this.nodes[e])
    }, this.addSegment = function (t) {
        t && (e.segments[t.id] = t)
    }, this.removeSegment = function (t) {
        if (t) {
            for (var i = 0; 2 > i; i++)t.nodes[i].removeConnectedSegment(t);
            t.floor.graphLayer.removeFeatures([t.feature]), t.feature.destroy(), delete e.segments[t.id]
        }
    }, this.reDrawNodesOnCurrentFloor = function () {
        for (var t in e.nodes)e.nodes[t].floor == currentFloor && e.nodes[t].redraw()
    }, this.reDrawSegmentsOnCurrentFloor = function () {
        for (var t in e.segments)e.segments[t].floor == currentFloor && e.segments[t].redraw()
    }, this.redrawOnCurrentFloor = function () {
        this.reDrawSegmentsOnCurrentFloor(), this.reDrawNodesOnCurrentFloor()
    }, this.getCloseFeature = function (e, t, i) {
        var n = new OpenLayers.Geometry.Point(e, t), s = 1, r = 1, a = null;
        for (var o in this.nodes) {
            var l = this.nodes[o];
            if (l.floor == currentFloor && (null == i || l.feature.id != i.id)) {
                var h = l.point.distanceTo(n);
                if (s >= h) {
                    a = l.feature;
                    break
                }
            }
        }
        if (null == a)for (var o in this.segments) {
            var u = this.segments[o];
            if (!u.isTransition && u.floor == currentFloor && (null == i || u.nodes[0].feature.id != i.id && u.nodes[1].feature.id != i.id)) {
                var h = n.distanceTo(u.feature.geometry);
                if (r >= h) {
                    a = u.feature;
                    break
                }
            }
        }
        return a
    }, this.toJson = function () {
        var e = {};
        e.id = site.id, e.sys = "wgs84", e.n = [], e.d = [], e.d[0] = {lvl: []}, e.cl = [];
        for (var t in this.nodes)e.n.push(this.nodes[t].toJson());
        floor_id_to_segments = {}, transitions = [];
        for (var i in this.segments) {
            var n = this.segments[i];
            this.nodes[n.nodes[0].id] && this.nodes[n.nodes[1].id] && (this.segments[i].isTransition ? transitions.push(n) : floor_id_to_segments[n.floor.id] ? floor_id_to_segments[n.floor.id].push(n) : floor_id_to_segments[n.floor.id] = [n])
        }
        for (var s in floor_id_to_segments) {
            for (var r = {
                id: s,
                z: floors[s].level_number,
                n: floors[s].to_label(),
                l: []
            }, i = floor_id_to_segments[s].length - 1; i >= 0; i--) {
                var n = floor_id_to_segments[s][i];
                r.l.push(n.toJson())
            }
            e.d[0].lvl.push(r)
        }
        for (var i = transitions.length - 1; i >= 0; i--)e.cl.push(transitions[i].toJson());
        return e
    }, this.fromJson = function (t) {
        for (var i in e.nodes)e.removeNodeAndItsConnectedSegments(e.nodes[i]);
        var n = t.n, s = t.cl;
        if (void 0 != n && void 0 != s) {
            for (var i = 0; i < n.length; i++) {
                if ("wgs84" == t.sys)var r = n[i].mx, a = n[i].my;
                var o = new OpenLayers.Geometry.Point(r, a);
                wgs84ToMercator(o), new GraphNode(n[i].id, this, o)
            }
            if (t.d[0])for (var i = 0; i < t.d[0].lvl.length; i++)for (var l = t.d[0].lvl[i], h = l.l.length - 1; h >= 0; h--) {
                var u = floors[l.id];
                if (u || (u = find_floor_by_level_number(parseInt(l.z))), u) {
                    var c = l.l[h];
                    this.nodes[c.n1] && this.nodes[c.n2] && (this.nodes[c.n1].setFloor(u), this.nodes[c.n2].setFloor(u), new GraphSegment(c.id, this, [this.nodes[c.n1], this.nodes[c.n2]], c.t))
                } else log("can not find floor for ID " + l.id + " and level number " + l.z)
            }
            for (var i = 0; i < s.length; i++)this.nodes[s[i].n1] && this.nodes[s[i].n2] && this.nodes[s[i].n1].floor && this.nodes[s[i].n2].floor && new GraphSegment(s[i].id, this, [this.nodes[s[i].n1], this.nodes[s[i].n2]], s[i].t);
            e.redrawOnCurrentFloor()
        }
    }
}
function GraphNode(e, t, i, n) {
    var s = this;
    this.id = e, this.graph = t, this.point = i, this.status = "normal", this.style = graphNodeStyle, this.redraw = function () {
        this.feature && this.floor.graphLayer.removeFeatures([this.feature]), this.feature = new OpenLayers.Feature.Vector(this.point, this.attributes, this.style), this.point = this.feature.geometry, graphController && this.floor.graphLayer.addFeatures([this.feature])
    }, this.setFloor = function (e) {
        this.floor = e, this.attributes = {id: this.id, floor_id: this.floor.id}, this.redraw()
    }, n && this.setFloor(n), this.connectedSegments = [], this.graph.addNode(this), this.changeStatus = function (e) {
        switch (e) {
            case"normal":
                this.style = this.connectedSegments.length > 1 ? graphNodeStyle : graphExtremityStyle;
                break;
            case"up":
                this.style = upTransitionMarkerStyle;
                break;
            case"down":
                this.style = downTransitionMarkerStyle;
                break;
            case"updown":
                this.style = updownTransitionMarkerStyle
        }
        this.redraw(), this.status = e
    }, this.addConnectedSegment = function (e) {
        if (s.connectedSegments.push(e), e.isTransition) {
            var t = "up", i = e.nodes[0];
            i == this && (i = e.nodes[1]), t = this.floor.altitude < i.floor.altitude ? "normal" == this.status || "up" == this.status ? "up" : "updown" : "normal" == this.status || "down" == this.status ? "down" : "updown", this.status != t && this.changeStatus(t)
        }
        "normal" == this.status && (this.style = this.connectedSegments.length > 1 ? graphNodeStyle : graphExtremityStyle)
    }, this.removeConnectedSegment = function (e) {
        for (var t = 0; t < s.connectedSegments.length; t++)if (s.connectedSegments[t].id == e.id) {
            s.connectedSegments.splice(t, 1);
            break
        }
        if (s.connectedSegments.length > 0 && e.isTransition) {
            var i = "up", n = e.nodes[0];
            n == this && (n = e.nodes[1]), i = this.floor.altitude < n.floor.altitude ? "down" == this.status || "updown" == this.status ? "down" : "normal" : "up" == this.status || "updown" == this.status ? "up" : "normal", this.status != i && this.changeStatus(i)
        }
        "normal" == this.status && (this.style = this.connectedSegments.length > 1 ? graphNodeStyle : graphExtremityStyle)
    }, this.setCoordinates = function (e) {
        s.feature.geometry.x = e.x, s.feature.geometry.y = e.y, s.point = s.feature.geometry
    }, this.connectedNodes = function () {
        for (var e = [], t = this.connectedSegments.length - 1; t >= 0; t--)for (var i = this.connectedSegments[t], n = i.nodes.length - 1; n >= 0; n--)i.nodes[n] != this && e.push(i.nodes[n]);
        return e
    }, this.isConnectedTo = function (e) {
        var t = this.connectedNodes();
        return t.indexOf(e) > -1
    }, this.toJson = function () {
        var e = new OpenLayers.Geometry.Point(this.point.x, this.point.y);
        mercatorToWgs84(e);
        var t = {id: this.id, mx: e.x, my: e.y};
        return t
    }, this.fromJson = function () {
    }
}
function GraphSegment(e, t, i, n) {
    this.id = e, this.graph = t, this.nodes = i, this.type = n, this.isTransition = this.nodes[0].floor.id != this.nodes[1].floor.id, this.floor = this.isTransition ? i[0].floor.altitude < i[1].floor.altitude ? i[0].floor : i[1].floor : i[0].floor;
    var s, r = new OpenLayers.Geometry.LineString([i[0].point, i[1].point]), a = {
        id: this.id,
        isTransition: this.isTransition
    };
    switch (this.type) {
        case 0:
            s = graphSegmentIndoorStyle;
            break;
        case 1:
            s = graphSegmentOutdoorStyle;
            break;
        case 2:
            s = graphBuildingTransitionStyle;
            break;
        default:
            s = graphSegmentStyle
    }
    this.isTransition && (s = graphTransitionStyle), this.graph.addSegment(this), this.nodes[0].addConnectedSegment(this), this.nodes[1].addConnectedSegment(this), this.redraw = function () {
        this.feature && this.floor.graphLayer.removeFeatures([this.feature]), this.feature = new OpenLayers.Feature.Vector(r, a, s), this.floor.graphLayer.addFeatures(this.feature)
    }, this.redraw(), this.toJson = function () {
        var e = {id: this.id, n1: this.nodes[0].id, n2: this.nodes[1].id, t: this.type};
        return e
    }, this.fromJson = function () {
    }, this.length = function () {
        var e = 0;
        return this.feature && (e = this.feature.geometry.getGeodesicLength(new OpenLayers.Projection("EPSG:900913"))), e
    }
}
function Intersection(e, t) {
    this.point = e, this.segments = t
}
function MeasurementLog(e, t, i) {
    var n = this;
    this.id = null, this.markers = [], this.points = [], this.backendListener = null, this.listeners = [], this.floor = null, this.center = null, this.features = [], this.properties = {}, this._isSelected = !1, this.isHidden = !1, this.initialize = function (e, t, i) {
        this.id = e, this.markers = t, this.points = [], this.properties = i;
        for (var n = 0; n < this.markers.length; n++) {
            var s = this.markers[n], r = new OpenLayers.Geometry.Point(s[0], s[1]);
            this.center || (this.center = new OpenLayers.LonLat(s[0], s[1]).transform("EPSG:4326", "EPSG:3857")), wgs84ToMercator(r), this.points.push(r)
        }
        for (var n = 0; n < this.markers.length - 1; n++) {
            var a = this.markers[n], o = this.markers[n + 1], l = a[2] < o[2] ? a : o, h = find_floor_by_lonlatalt(l[0], l[1], l[2]);
            if (h) {
                this.floor || (this.floor = h);
                var u = new OpenLayers.Geometry.LineString([this.points[n], this.points[n + 1]]), c = {
                    id: this.id,
                    type: "MeasurementLog"
                }, p = new OpenLayers.Feature.Vector(u, c, logSegmentStyle);
                h.logLayer.addFeatures([p]), this.features.push(p)
            } else log("can not find floor for marker " + l)
        }
    }, this.status_type = {
        measurement_type: function () {
            return n.measurement_type || (n.measurement_type = n.properties.ble && n.properties.wifi ? "BLE & Wi-Fi" : n.properties.ble ? "BLE" : n.properties.wifi ? "Wi-Fi" : "Empty"), n.measurement_type
        }
    }, this.addListener = function (e) {
        this.listeners.indexOf(e) < 0 && this.listeners.push(e)
    }, this.removeListener = function (e) {
        var t;
        switch ($.type(e)) {
            case"function":
                t = this.listeners.indexOf(e);
                break;
            case"number":
                t = e;
                break;
            default:
                return !1
        }
        t > -1 && this.listeners.splice(t, 1)
    }, this.trigger = function (e) {
        var t = this;
        $.each(this.listeners, function (i, n) {
            n.call(null, e, t)
        })
    }, this.select = function () {
        this.highlight(), this._isSelected = !0, this.trigger("selected")
    }, this.unselect = function () {
        this._isSelected && (this.unhighlight(), this._isSelected = !1, this.trigger("unselected"))
    }, this.isSelected = function () {
        return this._isSelected
    }, this.show = function () {
        for (var e = 0; e < this.features.length; e++)this.features[e].style.display = "";
        this.redraw(), this.isHidden = !1, this.trigger("show")
    }, this.hide = function () {
        for (var e = 0; e < this.features.length; e++)this.features[e].style.display = "none";
        this.redraw(), this.isHidden = !0, this.trigger("hide")
    }, this.hidden = function () {
        return this.isHidden
    }, this.redraw = function () {
        for (var e = 0; e < this.features.length; e++)this.features[e].layer.drawFeature(this.features[e])
    }, this.setStatus = function () {
    }, this.getCenter = function () {
        return this.center
    }, this.getFloor = function () {
        return this.floor
    }, this.getInfo = function () {
        var e = "Markers : " + this.markers.length + " ";
        return e
    }, this.getId = function () {
        return this.id
    }, this.highlight = function () {
        for (var e = 0; e < this.features.length; e++)this.features[e].style = logSegmentHighlightStyle, this.redraw()
    }, this.unhighlight = function () {
        for (var e = 0; e < this.features.length; e++)this.features[e].style = logSegmentStyle, this.redraw()
    }, this.erase = function () {
        for (var e = 0; e < this.features.length; e++)this.features[e].layer.removeFeatures([this.features[e]]);
        this.features = [], delete site.logs[this.id]
    }, this.destroy = function () {
        var e = new Backend.MeasurementLog({id: this.id});
        e.destroy(function (e, t) {
            e ? n.onDestroySuccess() : n.onBackendFailure(t.responseJSON)
        })
    }, this.save = function () {
        var e = this.persistableData(), t = new Backend.MeasurementLog(e);
        t.save(function (e, t) {
            e ? n.onSaveSuccess(t.responseJSON) : n.onBackendFailure(t.responseJSON)
        })
    }, this.onSaveSuccess = function (e) {
        e && this.setId(e.id), this.backendListener && this.backendListener.onSaveSuccess(n, e)
    }, this.onBackendFailure = function (e) {
        this.backendListener && this.backendListener.onBackendFailure(n, e)
    }, this.onDestroySuccess = function (e) {
        this.backendListener && this.backendListener.onDestroySuccess(n, e)
    }, this.setId = function (e) {
        e && (this.id = e)
    }, this.persistableData = function () {
        return {}
    }, this.showOnMap = function () {
        for (var e = 0; e < this.features.length; e++)this.features[e].style.display = "";
        this.redraw()
    }, this.hideOnMap = function () {
        for (var e = 0; e < this.features.length; e++)this.features[e].style.display = "none";
        this.redraw()
    }, this.initialize(e, t, i), Interface.ensureImplements(this, MapTableModel), Interface.ensureImplements(this, BackendResource)
}
function backend(e) {
    this.Region = Model("region", function () {
        this.persistence(Model.REST, "/" + e + "regions")
    }), this.MeasurementLog = Model("measurement_log", function () {
        this.persistence(Model.REST, "/" + e + "measurement_logs")
    })
}
function Polygon() {
    var e = this;
    this.id = void 0, this.feature = null, this.blueprint = null, this.color = null, this.text = null, this.category = null, this.type = "PolygonRegion", this.listener = null, this.building_id = null, this._isSelected = !1, this.listeners = [], this.getId = function () {
        return this.id
    }, this.addListener = function (e) {
        this.listeners.indexOf(e) < 0 && this.listeners.push(e)
    }, this.removeListener = function (e) {
        var t;
        switch ($.type(e)) {
            case"function":
                t = this.listeners.indexOf(e);
                break;
            case"number":
                t = e;
                break;
            default:
                return !1
        }
        t > -1 && this.listeners.splice(t, 1)
    }, this.status_type = {
        implantation_status: "Required", category_status: function () {
            return "" === e.category || null === e.category ? "default" : e.category
        }
    }, this.getInfo = function () {
        var e = "Selected " + this.name + " - ";
        return e += "(" + this.area() + "m²)"
    }, this.trigger = function (e) {
        var t = this;
        $.each(this.listeners, function (i, n) {
            n.call(null, e, t)
        })
    }, this.select = function () {
        this._isSelected = !0, this.trigger("selected")
    }, this.unselect = function () {
        this._isSelected && (this._isSelected = !1, this.trigger("unselected"))
    }, this.isSelected = function () {
        return this._isSelected
    }, this.setStatus = function () {
    }, this.getCenter = function () {
        var e = null;
        return this.feature && (e = this.feature.geometry.getBounds().getCenterLonLat()), e
    }, this.destroy = function () {
        var t = new Backend.Region({id: this.id});
        t.destroy(function (t, i) {
            t ? e.onDestroySuccess() : e.onBackendFailure(i.responseJSON)
        })
    }, this.save = function () {
        var t = this.persistableData(), i = new Backend.Region(t);
        i.save(function (t, i) {
            t ? e.onSaveSuccess(i.responseJSON) : e.onBackendFailure(i.responseJSON)
        })
    }, this.onSaveSuccess = function (t) {
        t && this.setId(t.id), this.listener && this.listener.onSaveSuccess(e, t)
    }, this.onBackendFailure = function (t) {
        this.listener && this.listener.onBackendFailure(e, t)
    }, this.onDestroySuccess = function (t) {
        this.listener && this.listener.onDestroySuccess(e, t)
    }, this.setId = function (e) {
        e && (this.id = e, allPolygons[this.id] = this, this.feature && (this.feature.attributes = {
            label: this.text,
            polygonId: this.id,
            color: this.color
        }))
    }, this.getAltitude = function () {
        return this.blueprint.altitude
    }, this.persistableData = function () {
        var e = {};
        return e.id = this.id, e.name = this.text, e.color = this.color, e.category = this.category, e.type = this.type, e.building_id = this.building_id, this.feature && (e.polygon = JSON.stringify(getLonlatArrayFromFeature(this.feature.geometry)), e.alt = this.getAltitude()), site && (e.site_id = site.id), e
    }, this.init = function (e, t, i, n, s, r, a) {
        this.feature = e, this.blueprint = t, this.setColor(i), this.setText(n), this.setCategory(s), this.setType(a), r && this.setId(r)
    }, this.redraw = function () {
        this.feature && this.blueprint.layer.drawFeature(this.feature)
    }, this.setColor = function (e) {
        this.color = e, this.feature && (this.feature.attributes.color = this.color)
    }, this.setText = function (e) {
        this.text = e, this.name = e, this.feature && (this.feature.attributes.label = this.text)
    }, this.setCategory = function (e) {
        e || (e = "default"), this.category = e, this.feature && (this.feature.attributes.category = this.category)
    }, this.setType = function (e) {
        e || (e = "PolygonRegion"), this.type = e, this.feature && (this.feature.attributes.type = this.type)
    }, this.setBuilding = function (e) {
        e || (e = currentBuilding.id), this.building_id = e, this.feature && (this.feature.attributes.building_id = this.building_id)
    }, this.draw = function () {
        this.feature && this.blueprint.layer.addFeatures(this.feature)
    }, this.highlight = function () {
        this.feature && (this.feature.attributes.strokeColor = "#0088CC", this.feature.attributes.strokeWidth = 5, this.redraw())
    }, this.unhighlight = function () {
        this.feature && (this.feature.attributes.strokeColor = "#333333", this.feature.attributes.strokeWidth = .5, this.redraw())
    }, this.getFloor = function () {
        var e = this.getAltitude(), t = find_floor_by_lonlatalt(0, 0, e);
        return t
    }, this.centerOnMap = function () {
        var e = this.getFloor();
        e.setAsCurrent(), site.psMap.centerFeature(this.feature)
    }, this.showPopupWithId = function () {
        if (this.feature) {
            var e = '<div class="left_boxs">';
            e += this.text, e += "</div>", popup = new OpenLayers.Popup.FramedCloud("popup", this.feature.geometry.getBounds().getCenterLonLat(), null, e, null, !1, null), popup.panMapIfOutOfView = !0, popup.autoSize = !0, this.feature.popup = popup, site.map.addPopup(popup)
        }
    }, this.erase = function () {
        this.feature && (this.blueprint.layer.removeFeatures([this.feature]), this.feature = null), delete allPolygons[this.id]
    }, this.hide = function () {
        if (this.feature) {
            var e = this.feature.layer.styleMap, t = $.extend({}, e.createSymbolizer(this.feature), {display: "none"});
            this.feature.style = t, this.redraw(), this.isHidden = !0, this.trigger("hide")
        }
    }, this.show = function () {
        this.feature && (this.feature.style = null, this.redraw(), this.isHidden = !1, this.trigger("show"))
    }, this.hidden = function () {
        return this.isHidden
    }, this.area = function () {
        var e = 0;
        return this.feature && (e = Math.abs(Math.floor(this.feature.geometry.getGeodesicArea(new OpenLayers.Projection("EPSG:900913"))))), e
    }, Interface.ensureImplements(this, MapTableModel)
}
function find_polygon_by_name(e) {
    var t = null;
    for (var i in allPolygons)if (allPolygons[i].name == e) {
        t = allPolygons[i];
        break
    }
    return t
}
function PSLayerSelector(e, t) {
    this.init = function (e) {
        var t = "nc-layer-selector", i = '<div class="btn-group"><span class="dropdown" id="nc-layer-selector-dropdown"><button type="button" class="psfa-btn btn btn-default dropdown-toggle" data-toggle="dropdown" title="Visibility of layers"><span class="fa fa-eye"></span></button><ul class="dropdown-menu pull-right" id="' + t + '"></ul>' + "</span>" + "</div>";
        $("#" + e).append(i), this.layerSelectorPanel = new PSButtonPanel(t), this.mBeaconLayerToggler = new PSChecbox({
            value: "BeaconLayer",
            name: "Beacons",
            listeners: [this]
        }), this.mGeofenceLayerToggler = new PSChecbox({
            value: "GeofenceLayer",
            name: "Geofences",
            listeners: [this]
        }), this.mAPLayerToggler = new PSChecbox({
            value: "APLayer",
            name: "Access Points",
            listeners: [this]
        }), this.mGraphLayerToggler = new PSChecbox({
            value: "GraphLayer",
            name: "Walkways",
            listeners: [this]
        }), this.mMapLayerToggler = new PSChecbox({
            value: "MapLayer",
            name: "Floor plans",
            listeners: [this]
        }), this.mTrajLayerToggler = new PSChecbox({
            value: "TrajLayer",
            name: "Calibration logs",
            listeners: [this]
        }), this.layerSelectorPanel.buttons = [this.mBeaconLayerToggler, this.mGeofenceLayerToggler, this.mGraphLayerToggler, this.mTrajLayerToggler, this.mAPLayerToggler], this.layerSelectorPanel.addTo(t)
    }, this.onPSButtonClicked = function (e) {
        var t = null;
        for (var i in this.floors)switch (t = this.floors[i], e) {
            case this.mBeaconLayerToggler.id:
                t.bluespotLayer.setVisibility(!t.bluespotLayer.getVisibility());
                break;
            case this.mGeofenceLayerToggler.id:
                if (currentVectorDrawer && currentVectorDrawer.vectorBlueprints) {
                    var n = currentVectorDrawer.vectorBlueprints[i];
                    if (n && n.layer) {
                        var s = n.layer;
                        s.setVisibility(!s.getVisibility())
                    }
                }
                break;
            case this.mMapLayerToggler.id:
                t.blueprintLayer.setVisibility(!t.blueprintLayer.getVisibility());
                break;
            case this.mGraphLayerToggler.id:
                t.graphLayer.setVisibility(!t.graphLayer.getVisibility());
                break;
            case this.mTrajLayerToggler.id:
                t.logLayer.setVisibility(!t.logLayer.getVisibility());
                break;
            case this.mAPLayerToggler.id:
                t.apLayer.setVisibility(!t.apLayer.getVisibility())
        }
        return !1
    }, this.floors = t, this.init(e)
}
function PSMap(e, t) {
    var i = this;
    this.DOM_COMMON_TOOLS = "common-map-tools", this.DOM_INSTRUCTIONS = "map-instructions", this.MSG_DEFAULT = "Drag the mouse to pan", this.listeners = [], this.generateMapZone = function (e) {
        var t = '<div id="map" class="panel panel-default"><div id="map_zone_header" class="panel-heading clearfix"><span id="map-title"></span><span id="' + this.DOM_COMMON_TOOLS + '" class="pull-right" style="margin-right:5px;">' + '<a id="fullscreen-toggles" data-fullscreen="off" class="psfa-btn btn btn-default" title="Fullscreen"><span class="glyphicon glyphicon-fullscreen"></span></a>' + "</span>" + "</div>" + '<div id="map-left-col"></div>' + '<div id="map-right-col">' + '<div id="' + this.DOM_INSTRUCTIONS + '">' + this.MSG_DEFAULT + "</div>" + '<div class="olMap" id="site-map"></div>' + "</div>" + '<div id="map_zone_footer" class="panel-footer text-muted small text-right">' + 'Copyright <a href="http://www.openstreetmap.org">OpenStreetMap</a> contributors. The data is available under the <a href="http://www.openstreetmap.org/copyright">Open Database Licence</a>. ' + "</div>" + "</div>";
        $("#" + e).html(t), $("#fullscreen-toggles").click(function () {
            var e = $(this).find("span");
            "off" == $(this).data("fullscreen") ? (psMap.enableFullScreen(), $(this).data("fullscreen", "on"), e.removeClass("glyphicon glyphicon-fullscreen"), e.addClass("fa fa-compress")) : (psMap.disableFullScreen(), $(this).data("fullscreen", "off"), e.removeClass("fa fa-compress"), e.addClass("glyphicon glyphicon-fullscreen"))
        }), $("#map_zone_header").tooltip()
    }, licenceRemainingDays() > 0 ? this.generateMapZone("map-container") : $("#map-container").html("Licence expired. Please contact Pole Star."), this.addListener = function (e) {
        this.listeners.push(e)
    }, this.useLeftColumn = function () {
        var e = '<a id="leftcol-toggles" data-leftcolumn="on" class="psfa-btn btn btn-default" title="Left column visibility"><span class="fa fa-columns"></span></a>';
        $("#common-map-tools").append(e), $("#leftcol-toggles").click(function () {
            $(this).find("span"), "on" == $(this).data("leftcolumn") ? (psMap.hideLeftColumn(), $(this).data("leftcolumn", "off")) : (psMap.displayLeftColumn(), $(this).data("leftcolumn", "on"))
        }), this.displayLeftColumn()
    }, this.updateSize = function () {
        this.map && this.map.updateSize();
        for (var e = 0; e < this.listeners.length; e++)this.listeners[e].onMapResized()
    }, this.disableFullScreen = function () {
        var e = "map";
        document.getElementById(e).removeAttribute("style"), document.getElementById("site-map").removeAttribute("style"), this.updateSize()
    }, this.enableFullScreen = function () {
        var e = "map";
        $("#" + e).css("position", "fixed"), $("#" + e).css("top", "0"), $("#" + e).css("left", "0"), $("#" + e).css("width", "100%"), $("#" + e).css("height", "100%"), $("#" + e).css("z-index", "2000"), $("#site-map").css("height", $(window).height() - 35), this.updateSize()
    }, this.displayLeftColumn = function () {
        $("#map-left-col").removeClass("hidden"), $("#map-left-col").addClass("col-md-3"), $("#map-left-col").css("padding", "5px"), $("#map-right-col").addClass("col-md-9"), $("#map-left-col").css("height", "605px"), $("#map-left-col").css("overflow", "auto"), this.updateSize()
    }, this.hideLeftColumn = function () {
        $("#map-left-col").addClass("hidden"), $("#map-left-col").removeClass("col-md-3"), document.getElementById("map-left-col").removeAttribute("style"), $("#map-left-col").css("padding", "0px"), $("#map-right-col").removeClass("col-md-9"), this.updateSize()
    }, this.centerFeature = function (e) {
        var t = e.geometry.bounds;
        this.map.setCenter(t.getCenterLonLat())
    }, this.map = new OpenLayers.Map("site-map", {
        projection: new OpenLayers.Projection("EPSG:900913"),
        displayProjection: new OpenLayers.Projection("EPSG:4326"),
        fractionalZoom: !0,
        controls: [new OpenLayers.Control.MousePosition({numDigits: 9}), new OpenLayers.Control.Navigation],
        theme: null
    }), this.map.addControl(new OpenLayers.Control.Zoom), this.mapLayer = new OpenLayers.Layer.OSM("OSM", ["//a.tile.openstreetmap.org/${z}/${x}/${y}.png", "//b.tile.openstreetmap.org/${z}/${x}/${y}.png", "//c.tile.openstreetmap.org/${z}/${x}/${y}.png"], {
        resolutions: allResolutions.slice(e, t),
        serverResolutions: [156543.03390625, 78271.516953125, 39135.7584765625, 19567.87923828125, 9783.939619140625, 4891.9698095703125, 2445.9849047851562, 1222.9924523925781, 611.4962261962891, 305.74811309814453, 152.87405654907226, 76.43702827453613, 38.218514137268066, 19.109257068634033, 9.554628534317017, 4.777314267158508, 2.388657133579254, 1.194328566789627, .5971642833948135],
        transitionEffect: "resize",
        isBaseLayer: !0
    }), this.markersLayer = new OpenLayers.Layer.Markers("Markers");
    var n = new OpenLayers.Size(21, 25), s = new OpenLayers.Pixel(-(n.w / 2), -n.h);
    this.markerIcon = new OpenLayers.Icon("https://ncpasst.s3.amazonaws.com/assets/marker-ac249723e43febe676dff1c531341e31.png", n, s), this.map.addLayers([this.mapLayer, this.markersLayer]), i.markers = [], this.setMapInstructions = function (e) {
        e || (e = "Drag the mouse to pan"), $("#" + this.DOM_INSTRUCTIONS).html(e)
    }, this.setMapTitle = function (e) {
        $("#map-title").html(e)
    }, this.addMapAttribution = function (e) {
        $("#map_zone_footer").append(e)
    }, this.addMarkers = function (e) {
        for (var t = e.length - 1; t >= 0; t--) {
            var n = e[t], s = wgs84ToMercator(new OpenLayers.LonLat(n.lon, n.lat)), r = new OpenLayers.Feature(this.markersLayer, s);
            r.popupClass = OpenLayers.Class(OpenLayers.Popup.AnchoredBubble, {autoSize: !0});
            var a = "";
            a = n.site_id ? '<a href="/sites/' + n.site_id + '">' + n.display_name + "</a>" : n.address ? '<a href="#" onclick="psMap.goto(' + n.lon + "," + n.lat + "); psMap.fillAddressForm('" + n.address.road + "','" + n.address.city + "','" + n.address.postcode + "','" + n.address.country_code + "');\">" + n.display_name + "</a>" : '<a href="#" onclick="psMap.goto(' + n.lon + "," + n.lat + ');">' + n.display_name + "</a>", r.data.popupContentHTML = a, r.data.overflow = "auto", n.display_name || (r.popup = r.createPopup(!0), i.map.addPopup(r.popup), r.popup.show());
            var o = new OpenLayers.Marker(s, this.markerIcon.clone());
            o.feature = r, i.markers.push(o);
            var l = function (e) {
                for (var t = i.markers.length - 1; t >= 0; t--)null != i.markers[t].feature.popup && i.markers[t].feature.popup.hide();
                null == this.feature.popup ? (this.feature.popup = this.feature.createPopup(!0), i.map.addPopup(this.feature.popup), this.feature.popup.show()) : this.feature.popup.show(), OpenLayers.Event.stop(e)
            };
            o.events.register("mousedown", o, l), this.markersLayer.addMarker(o)
        }
        this.markersLayer.getDataExtent()
    }, this.currentMarker = null, this.drawControl = null, this.drawMarker = function () {
        this.drawControl = new OpenLayers.Control.DrawFeature(this.markersLayer, OpenLayers.Handler.Point, {
            callbacks: {
                done: function (e) {
                    null != i.currentMarker && (i.currentMarker.feature.destroy(), i.markersLayer.removeMarker(i.currentMarker));
                    var t = new OpenLayers.LonLat(e.x, e.y), n = mercatorToWgs84(t.clone()), s = new OpenLayers.Size(21, 25), r = new OpenLayers.Pixel(-(s.w / 2), -s.h), a = new OpenLayers.Icon("https://ncpasst.s3.amazonaws.com/assets/marker-ac249723e43febe676dff1c531341e31.png", s, r), o = new OpenLayers.Marker(t, a.clone()), l = new OpenLayers.Feature(i.markersLayer, t);
                    l.popupClass = OpenLayers.Class(OpenLayers.Popup.AnchoredBubble, {autoSize: !0});
                    var h = 'Click <a href="/sites/new?longitude=' + n.lon + "&latitude=" + n.lat + '">Here</a> to create a site with this coordinates!';
                    l.data.popupContentHTML = h, l.data.overflow = "auto", l.createPopup(!1), i.map.addPopup(l.popup), l.popup.show(), o.feature = l, i.markersLayer.addMarker(o), i.currentMarker = o
                }
            }
        }), this.map.addControl(this.drawControl), this.drawControl.activate()
    }, this.clearAllMarkers = function () {
        for (var e = this.markers.length - 1; e >= 0; e--)this.markersLayer.removeMarker(this.markers[e]), null != this.markers[e].feature.popup && this.markers[e].feature.destroy();
        null != this.drawControl && this.drawControl.deactivate(), this.markers = [], null != i.currentMarker && (i.currentMarker.feature.destroy(), i.markersLayer.removeMarker(i.currentMarker))
    }, this.goto = function (e, t) {
        var i = wgs84ToMercator(new OpenLayers.LonLat(e, t));
        this.map.setCenter(i, 17)
    }, this.fillAddressForm = function (e, t, i, n) {
        $("#site_street") && ($("#site_street").val(e), $("#site_city").val(t), $("#site_postal_code").val(i), $("#site_country").val(n.toUpperCase()))
    }, this.buildAddressSearchForm = function (e) {
        var t = $("<div>").attr({
            id: "address-search-form",
            "class": "filterform input-group"
        }), n = $("<input>").attr({
            "class": "filterinput form-control",
            type: "text",
            placeholder: "Search by address"
        }), s = '<span class="input-group-addon"><span class="fa fa-search"></span></span>';
        $(t).append(n).appendTo(e), $(t).append(s), $("input").placeholder(), $(n).change(function () {
            var e = $(this).val();
            if (/^[-]*\d+[.]\d+[, ]+[-]*\d+[.]\d+$/.test(e)) {
                var t = e.split(/[, ]+/)[1], n = e.split(/[, ]+/)[0], s = wgs84ToMercator(new OpenLayers.LonLat(t, n));
                psMap.map.setCenter(s, 18)
            } else {
                var r = "//nominatim.openstreetmap.org/search";
                $("#site-list").html("We are searching, please wait..."), $.getJSON(r + "?q=" + encodeURIComponent(e) + "&format=json&addressdetails=1", function (t) {
                    if (i.clearAllMarkers(), t.length > 0) {
                        i.addMarkers(t);
                        for (var n = [], s = t.length - 1; s >= 0; s--) {
                            var r = t[s];
                            n.push('<li class="list-group-item"><a href="#" onclick="psMap.goto(' + r.lon + "," + r.lat + "); psMap.fillAddressForm('" + r.address.road + "','" + r.address.city + "','" + r.address.postcode + "','" + r.address.country_code + "'); return false;\">" + r.display_name + "</a></li>"), $("#site-list").html(n.join("")), 0 == s && psMap.goto(r.lon, r.lat, r.address.road, r.address.city, r.address.postcode, r.address.country_code)
                        }
                    } else $("#site-list").html('No result, please check your address or search on <a href="https://maps.google.com/maps?q=' + e + '" target="_blank">google maps</a> and enter the lat,lon coordinates.')
                })
            }
        })
    }
}
function Site(e, t, i, n) {
    var s = this;
    if (this.id = e, this.graph = new Graph, this.buildings = [], this.logs = {}, this.aps = [], this.originalLon = t, this.originalLat = i, !psMap) {
        var r = 0, a = allResolutions.length - 1;
        this.id > 0 && (r = 14), psMap = new PSMap(r, a)
    }
    this.psMap = psMap, this.map = psMap.map, this.toJson = function () {
        var e = {};
        e.name = "A Site", e.buildings = [], e.buildings[0] = {}, e.buildings[0].name = "A Building", e.buildings[0].floors = [];
        for (var t = currentBuilding.floors, i = 0; i < t.length; i++) {
            var n = t[i];
            e.buildings[0].floors[i] = n.toJson()
        }
        return e
    }, this.area = function () {
        for (var e = 0, t = currentBuilding.floors, i = 0; i < t.length; i++) {
            var n = t[i].area();
            n && (e += n)
        }
        return 0 == e && (e = void 0), e
    }, this.loadCurrentFloor = function () {
        var e = this.loadPreferenceFloorId();
        if (e && floors[e]) floors[e].setAsCurrent(); else if (!currentFloor && currentBuilding && currentBuilding.floors[0]) {
            var t = currentBuilding.getGroundFloor();
            t ? t.setAsCurrent() : currentBuilding.floors[0].setAsCurrent()
        }
    }, this.savePreference = function (e, t) {
        var i = "prefs_site_" + this.id + "_" + e;
        createCookie(i, t, 30)
    }, this.loadPreference = function (e) {
        var t = "prefs_site_" + this.id + "_" + e;
        return readCookie(t)
    }, this.savePreferenceFloorId = function () {
        currentFloor && this.savePreference("floor_id", currentFloor.id)
    }, this.savePreferenceViewCenterAndZoomLevel = function () {
        if (this.map) {
            var e = this.map.getCenter();
            mercatorToWgs84(e), this.savePreference("lon", e.lon), this.savePreference("lat", e.lat), this.savePreference("zoom_level", this.map.getZoom())
        }
    }, this.loadPreferenceFloorId = function () {
        return this.loadPreference("floor_id")
    }, this.loadPreferenceZoomlevel = function () {
        return this.loadPreference("zoom_level")
    }, this.loadPreferenceLon = function () {
        return this.loadPreference("lon")
    }, this.loadPreferenceLat = function () {
        return this.loadPreference("lat")
    }, this.loadViewCenterAndZoomLevel = function (e, t, i) {
        this.loadPreferenceLon() && this.loadPreferenceLat() && (e = this.loadPreferenceLon(), t = this.loadPreferenceLat()), this.lon = e, this.lat = t, this.center = wgs84ToMercator(new OpenLayers.LonLat(e, t)), this.zoom_level = this.loadPreferenceZoomlevel(), this.zoom_level || (this.zoom_level = this.map.getZoomForResolution(i)), this.map.setCenter(this.center, this.zoom_level), this.map.events.register("moveend", this.map, function () {
            site.savePreferenceViewCenterAndZoomLevel()
        })
    }, this.loadViewCenterAndZoomLevel(t, i, n), this.addBuilding = function (e) {
        s.buildings.push(e)
    }, this.hide = function () {
        $("#site-map").addClass("invisible")
    }, this.recenter = function () {
        this.lon = this.originalLon, this.lat = this.originalLat, this.center = wgs84ToMercator(new OpenLayers.LonLat(this.lon, this.lat)), this.map.setCenter(this.center, this.zoom_level)
    }, this.removeBuilding = function (e) {
        for (var t = this.buildings.length - 1; t >= 0; t--)if (this.buildings[t].id == e.id) {
            this.buildings.remove(t);
            break
        }
    }, this.show = function () {
        $("#site-map").removeClass("invisible")
    }, this.drawGraph = function () {
        null === graphController ? graphController = new GraphController("map_zone_header") : (graphController.addActionPanel("map_zone_header"), graphController.reinit())
    }, this.drawFloorSelector = function () {
        null === floorController && (floorController = new FloorController, this.psMap.addListener(floorController)), this.map.addControl(floorController)
    }, this.refreshGraph = function () {
        var e = this.graph.toJson();
        this.graph.fromJson(e)
    }, this.loadMicelloMap = function () {
        micelloMapController = new MicelloMapController, micelloMapController.loadCommunityFromSite(this)
    }
}
function filterSiteList(e) {
    return list = $("#site-list"), e ? ($(list).find("a:Contains(" + e + ")").parent().show(), $(list).find("a:not(:Contains(" + e + "))").parent().hide()) : $(list).find("li").show(), !1
}
function escapeDotFromOpenlayersIds(e) {
    return e.replace(/\./g, "\\\\.")
}
function VectorBlueprint(e) {
    this.vectorPolygons = [], this.linestringFeatures = [], this.pointsFeatures = [], this.map = null, this.layer = null, this.opacity = 1, this.name = e ? e : "VectorBlueprint", this.init = function (e) {
        this.map = e;
        var t = {
            label: "${getLabel}",
            fillColor: "${getColor}",
            strokeColor: "${getStrokeColor}",
            strokeWidth: "${getStrokeWidth}",
            strokeOpacity: 1,
            fillOpacity: .7,
            pointRadius: 7
        }, i = {
            getLabel: function (e) {
                var t = "", i = e.attributes.label;
                if (i) {
                    var n = e.geometry.getBounds().getSize().w / e.layer.map.getResolution();
                    t = n > 7 * i.length ? i : ""
                }
                return t
            }, getColor: function (e) {
                var t = e.attributes.color;
                return t || (t = "#0088CC"), t
            }, getStrokeColor: function (e) {
                var t = e.attributes.strokeColor;
                return t || (t = "#333333"), t
            }, getStrokeWidth: function (e) {
                var t = e.attributes.strokeWidth;
                return t || (t = .5), t
            }
        }, n = new OpenLayers.Style(t, {context: i});
        this.layer = new OpenLayers.Layer.Vector(this.name, {styleMap: new OpenLayers.StyleMap(n)}), this.map.addLayers([this.layer])
    }, this.setData = function (e) {
        this.draw(e)
    }, this.draw = function (e) {
        if (this.layer && e.polygons)for (var t = 0; t < e.polygons.length; t++)if (e.polygons[t]) {
            for (var i = e.polygons[t][0], n = e.polygons[t][2], s = e.polygons[t][3], r = e.polygons[t][5], a = e.polygons[t][6], o = e.polygons[t][7], l = [], h = 0; h < i.length; h++) {
                var u = i[h], c = new OpenLayers.Geometry.Point(u[0], u[1]);
                wgs84ToMercator(c), l.push(c)
            }
            var p = new OpenLayers.Geometry.LinearRing(l), d = new OpenLayers.Feature.Vector(p, null, null), f = this.addPolygon(d, n, s, r, a, o);
            f.draw()
        }
    }, this.addPolygon = function (e, t, i, n, s, r) {
        var a = new Polygon;
        return e.geometry.getCentroid = function () {
            var e = this.getBounds().getCenterLonLat(), t = new OpenLayers.Geometry.Point(e.lon, e.lat);
            return t
        }, a.init(e, this, t, i, n, s, r), this.vectorPolygons.push(a), a
    }, this.setOpacity = function (e) {
        this.layer && (this.opacity = e, this.layer.setOpacity(e))
    }, this.getOpacity = function () {
        var e = 0;
        return this.layer && (e = this.layer.opacity), e
    }, this.show = function () {
        this.layer && this.layer.setOpacity(this.opacity)
    }, this.hide = function () {
        this.layer && this.layer.setOpacity(0)
    }, this.getCloseGeometry = function (e, t, i) {
        for (var n = new OpenLayers.Geometry.Point(e, t), s = 2, r = null, a = 0; a < this.vectorPolygons.length && null == r; a++) {
            var o = this.vectorPolygons[a];
            if (o.feature && (!i || o.feature.id != i.id)) {
                var l = o.feature.geometry.components;
                if ("OpenLayers.Geometry.Polygon" == o.feature.geometry.CLASS_NAME && (l = o.feature.geometry.components[0].components), l)for (var h = 0; h < l.length && null == r; h++) {
                    var u = l[h], c = u.distanceTo(n);
                    s >= c && (r = u)
                }
            }
        }
        return r
    }, this.getPolygonsInJson = function (e) {
        for (var t = [], i = 0; i < this.vectorPolygons.length; i++) {
            var n = this.vectorPolygons[i], s = [];
            if (s[0] = [], s[1] = 0, s[2] = n.color, s[3] = n.text, s[5] = n.category, "undefined" != typeof e && (s[4] = e), n.feature) {
                var r = n.feature.geometry.components;
                "OpenLayers.Geometry.Polygon" == n.feature.geometry.CLASS_NAME && (r = n.feature.geometry.components[0].components);
                for (var a = 0; a < r.length; a++) {
                    var o = r[a], l = new OpenLayers.Geometry.Point(o.x, o.y);
                    mercatorToWgs84(l), s[0][a] = [l.x, l.y]
                }
                t.push(s)
            }
        }
        return t
    }
}
function stop_return_key(e) {
    var e = e ? e : event ? event : null, t = e.target ? e.target : e.srcElement ? e.srcElement : null;
    return 13 != e.keyCode || "text" != t.type && "textarea" != t.type ? void 0 : !1
}
function deny_submit_on_enter() {
    document.onkeypress = stop_return_key
}
function init_dragdrop_upload() {
    var e = "drop-zone", t = "mouse-over", i = $("#" + e), n = i.offset().left, s = i.outerWidth() + n, r = i.offset().top, a = i.outerHeight() + r, o = i.find("input");
    document.getElementById(e).addEventListener("dragover", function (e) {
        e.preventDefault(), e.stopPropagation(), i.addClass(t);
        var l = e.pageX, h = e.pageY;
        n > l || l > s || r > h || h > a ? o.offset({top: -400, left: -400}) : o.offset({top: h - 15, left: l - 50})
    }, !0), $("#" + e).mousemove(function (e) {
        var t = e.pageX, i = e.pageY;
        n > t || t > s || r > i || i > a ? o.offset({top: -400, left: -400}) : o.offset({top: i - 15, left: t - 50})
    }), document.getElementById(e).addEventListener("drop", function () {
        $("#" + e).removeClass(t)
    }, !0)
}
function generate_guid() {
    return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function (e) {
        var t = 0 | 16 * Math.random(), i = "x" == e ? t : 8 | 3 & t;
        return i.toString(16)
    })
}
function PSButton(e) {
    var t = this;
    buttonCounter += 1, this.id = "btn-" + e.iconId + "-" + buttonCounter, this.iconId = e.iconId, this.params = e, this.addTo = function (e) {
        var i = BUTTON_ICONS[this.iconId][0], n = BUTTON_ICONS[this.iconId][1], s = 24 * (i - 1), r = 24 * (n - 1), a = {background: "url(" + BUTTON_PANEL + ") no-repeat scroll -" + s + "px -" + r + "px transparent"}, o = {opacity: .8}, l = {opacity: 1}, h = '<a id="' + this.id + '"';
        h += this.params.action ? 'href="#" onclick=' + this.params.action + " " : this.params.link ? 'href="' + this.params.link + '" ' : 'href="#" ', this.params.opt && (h += this.params.opt), h += ">", h += '<img class="icons_main"', this.params.title && (h += 'title="' + this.params.title + '"'), h += 'src="' + TRANSPARENT_IMG + '">', this.params.text && (h += this.params.text), h += "</a>", $("#" + e).append(h), $("#" + this.id).children("img").css(a), this.params.text ? $("#" + this.id).hover(function () {
            $(this).children("img").css(o)
        }, function () {
            $(this).children("img").css(l)
        }) : $("#" + this.id).children("img").hover(function () {
            $(this).css(o)
        }, function () {
            $(this).css(l)
        }), this.params.listeners && $("#" + this.id).click(function () {
            return t.notifyListeners(), !1
        })
    }, this.notifyListeners = function () {
        if (this.params.listeners)for (var e = 0; e < this.params.listeners.length; e++)this.params.listeners[e].onPSButtonClicked(this.id);
        return !1
    }, this.params.parent && this.addTo(this.params.parent)
}
function loadMicelloMap() {
    site.loadMicelloMap()
}
function drawGraph() {
    site.drawGraph()
}
function showDetails() {
    $(".div_details").toggle()
}
function PSChecbox(e) {
    var t = this;
    this.init = function (e) {
        checBoxCounter += 1, this.params = e, this.id = "ckb-" + this.params.value + "-" + checBoxCounter, this.params.parent && this.addTo(this.params.parent)
    }, this.addTo = function (e) {
        html = "", html += '<div class="checkbox checkbox-circle checkbox-info"><input type="checkbox" id="' + this.id + '" name="' + this.params.name + '" value="' + this.params.value + '" checked>', html += '<label for="' + this.id + '">' + this.params.name + "</label></div>", $("#" + e).append(html), $("#" + this.id).on("change", function () {
            t.notifyListeners()
        })
    }, this.notifyListeners = function () {
        if (this.params.listeners)for (var e = 0; e < this.params.listeners.length; e++)this.params.listeners[e].onPSButtonClicked(this.id);
        return !1
    }, this.init(e)
}
function DataTable(e, t, i) {
    var n = this;
    this.id = "table_" + data_table_counter, data_table_counter += 1, this.table = null, this.divDOMID = "#" + t, this.headers = [], this.dataToDisplay = [], this.actions = {}, this.lastSelectedRow = null, this.pageLength = "undefined" != typeof i ? i : 50;
    for (var s = !1, r = 0; r < e.headers.length; r++) {
        if (0 == e.headers[r][2])var s = !0;
        this.headers.push({
            sTitle: e.headers[r][0],
            sType: e.headers[r][1],
            sClass: "ps_datatable_cell",
            bVisible: e.headers[r][2]
        })
    }
    if (this.dataToDisplay = e.data, s) {
        this.headers.push({sTitle: "Details", sType: "html", sClass: "ps_datatable_cell", bVisible: !0});
        for (var r = 0; r < this.dataToDisplay.length; r++) {
            var a = '<a class="view_details" href="#"><img id="' + n.id + "_show_details_" + r + '" class="show_details" src="' + ICON_SHOW_MORE + '"></a>                                <a class="view_details" href="#"><img id="' + n.id + "_hide_details_" + r + '" class="hide_details invisible" src="' + ICON_HIDE_MORE + '"></a>                                <div class="div_details" id="' + n.id + "_div_details_" + r + '"></div>';
            this.dataToDisplay[r].push(a)
        }
    }
    $(this.divDOMID).html('<table cellpadding="0" cellspacing="0" border="0" class="display datatable" id=' + this.id + "></table>"), this.table = $("#" + this.id).dataTable({
        bJQueryUI: !1,
        bProcessing: !1,
        sPaginationType: "full_numbers",
        bDeferRender: !1,
        aaData: this.dataToDisplay,
        aoColumns: this.headers,
        bSortClasses: !1,
        aaSorting: [[1, "asc"]],
        sDom: '<"H"r<"#actionsPlaceHolder">>t<"F"ip>',
        iDisplayLength: this.pageLength,
        oLanguage: {
            sSearch: "",
            sLengthMenu: '<select><option value="50">50</option><option value="75">75</option><option value="100">100</option></select>'
        }
    });
    var o = data_table_counter - 1, l = '<p id="actions_table_' + o + '"></p>';
    $("#actionsPlaceHolder").html(l), n = this, $("document").keypress(function (e) {
        40 == e.keyCode && alert("ca marche!")
    }), $("#" + n.id + " tbody tr td a img.show_details").bind("click", function () {
        for (var e = null, t = 1; t < n.headers.length; t++)n.table.fnSettings().aoColumns[t].bVisible || e++;
        if (e > 0) {
            var i = $(this).parents("tr")[0], s = "", r = n.table.fnGetData(i), a = $(this).parents("td").children("div").attr("id"), o = a.replace("" + n.id + "_div_details_", "");
            $("#" + n.id + " tbody tr td .div_details").hide(), $("#" + n.id + " tbody tr td a img.hide_details").hide(), $("#" + n.id + " tbody tr td a img.show_details").show(), s += '<table cellpadding="0" cellspacing="0" border="0">';
            for (var t = 1; t < n.headers.length; t++)n.table.fnSettings().aoColumns[t].bVisible || (s += '<tr><td class="div_details_headers">' + n.headers[t].sTitle + '</td><td class="div_details_datas"> : ' + r[t] + "</td></tr>");
            return s += "</table>", $("#" + a).html(s), $(this).parents("td").children("a").children("#" + n.id + "_hide_details_" + o).removeClass("invisible"), $(this).parents("td").children("a").children("#" + n.id + "_show_details_" + o).toggle(), $(this).parents("td").children("a").children("#" + n.id + "_hide_details_" + o).toggle(), $("#" + a).show(), !1
        }
    }), $("#" + n.id + " tbody tr td a img.hide_details").bind("click", function () {
        $(this).parents("td").children("a").children("img").toggle(), $("#" + n.id + " tbody tr td div.div_details").hide()
    }), $("#" + n.id + " tbody").on("click", "tr", function (e) {
        if (null == n.lastSelectedRow && (n.lastSelectedRow = this), e.shiftKey) {
            e.preventDefault();
            for (var t = $("#" + n.id + " tbody tr").index(this), i = $("#" + n.id + " tbody tr").index(n.lastSelectedRow), s = Math.min(t, i); s <= Math.max(t, i); s++)$("#" + n.id + " tbody tr").eq(s).hasClass("row_selected") || $("#" + n.id + " tbody tr").eq(s).addClass("row_selected");
            window.getSelection ? window.getSelection().empty ? window.getSelection().empty() : window.getSelection().removeAllRanges && window.getSelection().removeAllRanges() : document.selection && document.selection.empty()
        } else e.metaKey || e.ctrlKey ? (e.preventDefault(), $(this).hasClass("row_selected") ? $(this).removeClass("row_selected") : $(this).addClass("row_selected")) : $(this).hasClass("row_selected") ? $(this).removeClass("row_selected") : (n.table.$("tr.row_selected").removeClass("row_selected"), $(this).addClass("row_selected"));
        n.lastSelectedRow = this
    }), this.onPSButtonClicked = function (e) {
        var t = null;
        for (var i in this.actions) {
            var n = this.actions[i];
            if (n.buttonId == e) {
                t = i;
                break
            }
        }
        this.callExternalFunction(t)
    }, this.getSelectedRows = function (e) {
        return e.$("tr.row_selected")
    }, this.addRow = function () {
        var e = $(window).width(), t = $(window).height(), i = $("#tableFormContainer"), s = this.generateForm("add");
        i.html(s), $("#submitFormButton").click(function () {
            for (var e = "", t = [], s = 0; s < n.headers.length; s++) {
                var r = n.headers[s].sTitle, a = $("input[id=" + r + "]").val();
                e += r + "=" + a + "&", t.push(a)
            }
            e += "format=json", console.log(e), $.ajax({
                url: "http://open.mapquestapi.com/nominatim/v1/search?",
                data: {q: "toulouse", format: "json"},
                cache: !1,
                dataType: "json",
                success: function (e) {
                    if (e.length > 0) {
                        $("#overlay").remove(), i.html(""), i.css({border: 0});
                        var s = t.length - 1;
                        t[s] = '<a class="view_details" href="#"><img id="' + n.id + "_show_details_" + t[0] + '" class="show_details" src="' + ICON_SHOW_MORE + '"></a>                                                                    <a class="view_details" href="#"><img id="' + n.id + "_hide_details_" + t[0] + '" class="hide_details invisible" src="' + ICON_HIDE_MORE + '"></a>                                                                    <div class="div_details" id="' + n.id + "_div_details_" + t[0] + '"></div>', n.table.fnAddData(t)
                    }
                },
                error: function (e, t, i) {
                    alert(i + "\n" + t + "\n" + e.statusText)
                }
            })
        }), $("#resetFormButton").click(function () {
            $("#tableForm")[0].reset()
        }), i.css({
            border: "1px solid #dddddd",
            top: Math.round(t / 2) - i.height() / 2 + "px",
            left: Math.round(e / 2) - i.width() / 2 + "px",
            zIndex: 100,
            display: "block"
        }), $("<div/>", {
            id: "overlay",
            css: {position: "absolute", height: "200%", width: "200%", left: 0, top: 0, background: "#000", zIndex: 99}
        }).appendTo("body"), $("#overlay").animate({opacity: .5}, 0), $("#overlay").click(function () {
            $(this).remove(), i.html(""), i.css({border: 0, display: "none"})
        })
    }, this.editRow = function (e) {
        this.table.fnGetData(e[0]);
        var t = $(window).width(), i = $(window).height(), s = $("#tableFormContainer");
        if (e.length > 1) alert("error: you can't edit multiple rows at the same time"); else if (0 !== e.length) {
            var r = this.generateForm("edit");
            s.html(r);
            for (var a = [], o = 1; o < n.headers.length; o++) {
                var l = n.headers[o].sTitle;
                a.push($("input[id=" + l + "]").val())
            }
            $("#submitFormButton").click(function () {
                for (var t = "", i = [], r = 0; r < n.headers.length; r++) {
                    var o = n.headers[r].sTitle, l = $("input[id=" + o + "]").val();
                    t += o + "=" + l + "&", i.push(l)
                }
                t += "format=json", console.log(t), compareArrays(a, i) ? console.log("you didn't change any values") : $.ajax({
                    url: "http://open.mapquestapi.com/nominatim/v1/search?",
                    data: {q: "toulouse", format: "json"},
                    cache: !1,
                    dataType: "json",
                    success: function (t) {
                        if (t.length > 0) {
                            $("#overlay").remove(), s.html(""), s.css({border: 0});
                            var r = i.length - 1;
                            i[r] = '<a class="view_details" href="#"><img id="' + n.id + "_show_details_" + i[0] + '" class="show_details" src="' + ICON_SHOW_MORE + '"></a>                                                                                            <a class="view_details" href="#"><img id="' + n.id + "_hide_details_" + i[0] + '" class="hide_details invisible" src="' + ICON_HIDE_MORE + '"></a>                                                                                            <div class="div_details" id="' + n.id + "_div_details_" + i[0] + '"></div>', 0 === n.table.fnUpdate(i, e[0]) || alert("error: failed to update the row")
                        }
                    },
                    error: function (e, t, i) {
                        alert(i + "\n" + t + "\n" + e.statusText)
                    }
                })
            }), $("#resetFormButton").click(function () {
                $("#tableForm")[0].reset()
            }), s.css({
                border: "1px solid #dddddd",
                top: Math.round(i / 2) - s.height() / 2 + "px",
                left: Math.round(t / 2) - s.width() / 2 + "px",
                zIndex: 100,
                display: "block"
            }), $("<div/>", {
                id: "overlay",
                css: {
                    position: "absolute",
                    height: "200%",
                    width: "200%",
                    left: 0,
                    top: 0,
                    background: "#000",
                    zIndex: 99
                }
            }).appendTo("body"), $("#overlay").animate({opacity: .5}, 0), $("#overlay").click(function () {
                $(this).remove(), s.html(""), s.css({border: 0, display: "none"})
            })
        }
    }, this.deleteRow = function (e) {
        if (0 !== e.length) {
            for (var t = "IDs=", i = [], s = 0; s < e.length; s++) {
                var r = this.table.fnGetData(e[s]);
                i.push(r[1])
            }
            t += i, t += "&format=json", console.log(t), $.ajax({
                url: "http://open.mapquestapi.com/nominatim/v1/search?",
                data: {q: "toulouse", format: "json"},
                cache: !1,
                dataType: "json",
                success: function (t) {
                    if (t.length > 0)for (var i = 0; i < e.length; i++)n.table.fnDeleteRow(e[i], this.onRowDeleted)
                },
                error: function (e, t, i) {
                    alert(i + "\n" + t + "\n" + e.statusText)
                }
            })
        }
    }, this.generateForm = function (e) {
        var t = "", i = "";
        if ("add" == e) {
            t = '<form  name="tableForm" id="tableForm" action="file:///D:/polestarSdk/SDK_dev_box/309.htm" method="post" enctype="application/x-www-form-urlencoded">', t += "<fieldset>", t += "<legend>New row</legend>";
            for (var n = 0; n < this.headers.length; n++) {
                var s = 0, r = this.headers[n].sTitle;
                if ("html" === this.headers[n].sType); else {
                    switch (this.headers[n].sType) {
                        case"string":
                            i = "text";
                            break;
                        case"numeric":
                            i = "number";
                            break;
                        case"date":
                            i = "date";
                            break;
                        default:
                            i = "text"
                    }
                    t += '<label for="' + r + '">' + r + '</label><input type="' + i + '" id="' + r + '" name="' + r + '" tabindex="' + s + '" value="" /></br>'
                }
                s++
            }
            t += '<a id="submitFormButton" class="btn btn-lg btn-primary" href="#">Add</a>', t += '<a id="resetFormButton" class="btn btn-lg btn-primary" name="Reset" value="reset">Reset</button>', t += "</fieldset>", t += "</form>"
        } else if ("edit" == e) {
            var a = this.getSelectedRows(this.table);
            t = '<form  name="tableForm" id="tableForm" action="file:///D:/polestarSdk/SDK_dev_box/309.htm" method="post" enctype="application/x-www-form-urlencoded">', t += "<fieldset>", t += "<legend>Edit row</legend>";
            for (var n = 0; n < this.headers.length; n++) {
                var s = 0, r = this.headers[n].sTitle, o = this.table.fnGetData(a[0]);
                if ("html" === this.headers[n].sType); else {
                    switch (this.headers[n].sType) {
                        case"string":
                            i = "text";
                            break;
                        case"numeric":
                            i = "number";
                            break;
                        case"date":
                            i = "date";
                            break;
                        default:
                            i = "text"
                    }
                    t += '<label for="' + r + '">' + r + '</label><input type="' + i + '" id="' + r + '" name="' + r + '" tabindex="' + s + '" value="' + o[n] + '" />'
                }
                s++
            }
            t += '<a id="submitFormButton" class="btn btn-lg btn-primary" href="#">Save</a>', t += '<a id="resetFormButton" class="btn btn-lg btn-primary" name="Reset" value="reset">Reset</button>', t += "</fieldset>", t += "</form>"
        }
        return t
    }, this.callExternalFunction = function (e) {
        var t = "hello";
        this.actions[e].func(this, t)
    }, this.onRowDeleted = function () {
        console.log("Row Deleted")
    }
}
function newRow(e) {
    e.addRow()
}
function editSelectedRow(e) {
    var t = e.getSelectedRows(e.table);
    e.editRow(t)
}
function deleteSelectedRow(e) {
    var t = e.getSelectedRows(e.table);
    e.deleteRow(t)
}
function sendThemEmail() {
    alert("sendThemEmail")
}
function callThem(e, t) {
    alert(t)
}
function showMap() {
    $("#table_zone").hide(), $("#map_zone").show()
}
function showList() {
    $("#map_zone").hide(), $("#table_zone").show()
}
function compareArrays(e, t) {
    if (e.length !== t.length)return !1;
    for (var i = 0; i < e.length; i++)if (e[i] !== t[i])return !1;
    return !0
}
function PSFAButton(e) {
    var t = this;
    this.init = function (e) {
        PSFAButtonCounter += 1, this.params = e, this.isPressed = !1, this.id = "psfa-btn-" + this.params.value + "-" + PSFAButtonCounter, this.params.btnType || (this.params.btnType = "default"), this.params.size || (this.params.size = ""), this.params.parent && this.addTo(this.params.parent)
    }, this.getIcon = function () {
        return '<span class="fa ' + this.params.iconId + '">'
    }, this.getHtml = function () {
        var e = "btn " + this.params.size + " btn-" + this.params.btnType + " psfa-btn";
        t.isPressed && (e += " psfa-btn-pressed");
        var i = '<a id="' + this.id + '" class="' + e + '" title="' + this.params.title + '">' + this.getIcon() + "</span></a>";
        return i
    }, this.addTo = function (e) {
        $("#" + e).append(this.getHtml()), $("#" + this.id).on("click", function () {
            t.isPressed = !t.isPressed, t.refresh(), t.notifyListeners()
        })
    }, this.updateIcon = function (e) {
        this.params.iconId = e, this.refresh()
    }, this.reset = function () {
        this.isPressed = !1, this.refresh()
    }, this.refresh = function () {
        this.isPressed ? $("#" + this.id).addClass("psfa-btn-pressed") : $("#" + this.id).removeClass("psfa-btn-pressed"), $("#" + this.id).html(this.getIcon())
    }, this.notifyListeners = function () {
        if (this.params.listeners)for (var e = 0; e < this.params.listeners.length; e++)this.params.listeners[e].onPSButtonClicked(this.id);
        return !1
    }, this.init(e)
}
function initMapButtonPanel() {
    mapButtonPanels = initButtonPanels(mapButtonPanelConfig, "map_zone_header")
}
function initTableButtonPanel() {
    initButtonPanels(tableButtonPanelConfig, "just-for-test"), initButtonPanels(tableButtonPanelConfig, "actions_table_0")
}
function initPanelsFromConfig(e, t) {
    var i = {};
    for (var n in e) {
        i[n] = new PSButtonPanel(n);
        for (var s = [], r = 0; r < e[n].length; r++) {
            var a = new PSButton({iconId: e[n][r][1], title: e[n][r][0], action: e[n][r][2] + "();"});
            s.push(a)
        }
        i[n].buttons = s, i[n].addTo(t)
    }
    return i
}
function PSButtonPanel(e) {
    this.domId = "panel-" + e + "-" + panelCounter, this.buttons = [], this.css_klass = "hidden-xs", this.remove = function () {
        $("#" + this.domId).remove()
    }, this.addBtn = function (e) {
        var t = _.find(this.buttons, function (t) {
            return t.id == e.id
        });
        t || (this.buttons.push(btn), this.refresh())
    }, this.addTo = function (e) {
        if (e && void 0 != e) {
            panelCounter += 1;
            var t = '<span id="' + this.domId + '" class="' + this.css_klass + '"></span>';
            $("#" + e).append(t), this.refresh()
        }
    }, this.refresh = function () {
        $("#" + this.domId).empty();
        for (var e = 0; e < this.buttons.length; e++)this.buttons[e].addTo(this.domId)
    }, this.setStatus = function (e) {
        psMap && psMap.setMapInstructions(e)
    }
}
function PSSlider(e) {
    var t = this;
    sliderCounter += 1, this.id = "slider_" + sliderCounter, this.valueDomId = this.id + "_value", this.controlDomId = this.id + "_control", this.dataDomId = this.id + "_data", this.params = {
        min: 0,
        max: 1,
        step: .1,
        range: !1,
        value: .5,
        values: null,
        text: null,
        parent: null,
        listeners: null,
        slide: function (e, i) {
            if ($("#" + t.valueDomId).html(i.value), t.params.listeners)for (var n = 0; n < t.params.listeners.length; n++)t.params.listeners[n].onPSSliderChanged(t.id, i.value)
        }
    }, this.addTo = function (e) {
        var t = '<span id="' + this.dataDomId + '" class="sliderData">';
        this.params.text && (t += '<span class="sliderText">' + this.params.text + " :</span>"), t += '<span id="' + this.valueDomId + '" class="sliderValue">' + this.params.value + "</span>", t += "</span>", $("#" + e).append(t);
        var i = "";
        this.params.width && (i = 'style="width:' + this.params.width + 'px"'), t = "", t += '<div id="' + this.controlDomId + '" class="slider_control" ' + i + "></div>", $("#" + e).append(t), $("#" + this.controlDomId).slider(this.params)
    }, this.setParams = function (e) {
        for (var t in e)this.params[t] = e[t];
        this.params.parent && this.addTo(this.params.parent)
    }, this.setParams(e)
}
!function (e, t) {
    function i(e) {
        var t = e.length, i = ut.type(e);
        return ut.isWindow(e) ? !1 : 1 === e.nodeType && t ? !0 : "array" === i || "function" !== i && (0 === t || "number" == typeof t && t > 0 && t - 1 in e)
    }

    function n(e) {
        var t = St[e] = {};
        return ut.each(e.match(pt) || [], function (e, i) {
            t[i] = !0
        }), t
    }

    function s(e, i, n, s) {
        if (ut.acceptData(e)) {
            var r, a, o = ut.expando, l = e.nodeType, h = l ? ut.cache : e, u = l ? e[o] : e[o] && o;
            if (u && h[u] && (s || h[u].data) || n !== t || "string" != typeof i)return u || (u = l ? e[o] = tt.pop() || ut.guid++ : o), h[u] || (h[u] = l ? {} : {toJSON: ut.noop}), ("object" == typeof i || "function" == typeof i) && (s ? h[u] = ut.extend(h[u], i) : h[u].data = ut.extend(h[u].data, i)), a = h[u], s || (a.data || (a.data = {}), a = a.data), n !== t && (a[ut.camelCase(i)] = n), "string" == typeof i ? (r = a[i], null == r && (r = a[ut.camelCase(i)])) : r = a, r
        }
    }

    function r(e, t, i) {
        if (ut.acceptData(e)) {
            var n, s, r = e.nodeType, a = r ? ut.cache : e, l = r ? e[ut.expando] : ut.expando;
            if (a[l]) {
                if (t && (n = i ? a[l] : a[l].data)) {
                    ut.isArray(t) ? t = t.concat(ut.map(t, ut.camelCase)) : t in n ? t = [t] : (t = ut.camelCase(t), t = t in n ? [t] : t.split(" ")), s = t.length;
                    for (; s--;)delete n[t[s]];
                    if (i ? !o(n) : !ut.isEmptyObject(n))return
                }
                (i || (delete a[l].data, o(a[l]))) && (r ? ut.cleanData([e], !0) : ut.support.deleteExpando || a != a.window ? delete a[l] : a[l] = null)
            }
        }
    }

    function a(e, i, n) {
        if (n === t && 1 === e.nodeType) {
            var s = "data-" + i.replace(Tt, "-$1").toLowerCase();
            if (n = e.getAttribute(s), "string" == typeof n) {
                try {
                    n = "true" === n ? !0 : "false" === n ? !1 : "null" === n ? null : +n + "" === n ? +n : _t.test(n) ? ut.parseJSON(n) : n
                } catch (r) {
                }
                ut.data(e, i, n)
            } else n = t
        }
        return n
    }

    function o(e) {
        var t;
        for (t in e)if (("data" !== t || !ut.isEmptyObject(e[t])) && "toJSON" !== t)return !1;
        return !0
    }

    function l() {
        return !0
    }

    function h() {
        return !1
    }

    function u() {
        try {
            return Z.activeElement
        } catch (e) {
        }
    }

    function c(e, t) {
        do e = e[t]; while (e && 1 !== e.nodeType);
        return e
    }

    function p(e, t, i) {
        if (ut.isFunction(t))return ut.grep(e, function (e, n) {
            return !!t.call(e, n, e) !== i
        });
        if (t.nodeType)return ut.grep(e, function (e) {
            return e === t !== i
        });
        if ("string" == typeof t) {
            if (Ht.test(t))return ut.filter(t, e, i);
            t = ut.filter(t, e)
        }
        return ut.grep(e, function (e) {
            return ut.inArray(e, t) >= 0 !== i
        })
    }

    function d(e) {
        var t = Vt.split("|"), i = e.createDocumentFragment();
        if (i.createElement)for (; t.length;)i.createElement(t.pop());
        return i
    }

    function f(e, t) {
        return ut.nodeName(e, "table") && ut.nodeName(1 === t.nodeType ? t : t.firstChild, "tr") ? e.getElementsByTagName("tbody")[0] || e.appendChild(e.ownerDocument.createElement("tbody")) : e
    }

    function m(e) {
        return e.type = (null !== ut.find.attr(e, "type")) + "/" + e.type, e
    }

    function g(e) {
        var t = si.exec(e.type);
        return t ? e.type = t[1] : e.removeAttribute("type"), e
    }

    function y(e, t) {
        for (var i, n = 0; null != (i = e[n]); n++)ut._data(i, "globalEval", !t || ut._data(t[n], "globalEval"))
    }

    function v(e, t) {
        if (1 === t.nodeType && ut.hasData(e)) {
            var i, n, s, r = ut._data(e), a = ut._data(t, r), o = r.events;
            if (o) {
                delete a.handle, a.events = {};
                for (i in o)for (n = 0, s = o[i].length; s > n; n++)ut.event.add(t, i, o[i][n])
            }
            a.data && (a.data = ut.extend({}, a.data))
        }
    }

    function b(e, t) {
        var i, n, s;
        if (1 === t.nodeType) {
            if (i = t.nodeName.toLowerCase(), !ut.support.noCloneEvent && t[ut.expando]) {
                s = ut._data(t);
                for (n in s.events)ut.removeEvent(t, n, s.handle);
                t.removeAttribute(ut.expando)
            }
            "script" === i && t.text !== e.text ? (m(t).text = e.text, g(t)) : "object" === i ? (t.parentNode && (t.outerHTML = e.outerHTML), ut.support.html5Clone && e.innerHTML && !ut.trim(t.innerHTML) && (t.innerHTML = e.innerHTML)) : "input" === i && ti.test(e.type) ? (t.defaultChecked = t.checked = e.checked, t.value !== e.value && (t.value = e.value)) : "option" === i ? t.defaultSelected = t.selected = e.defaultSelected : ("input" === i || "textarea" === i) && (t.defaultValue = e.defaultValue)
        }
    }

    function L(e, i) {
        var n, s, r = 0, a = typeof e.getElementsByTagName !== X ? e.getElementsByTagName(i || "*") : typeof e.querySelectorAll !== X ? e.querySelectorAll(i || "*") : t;
        if (!a)for (a = [], n = e.childNodes || e; null != (s = n[r]); r++)!i || ut.nodeName(s, i) ? a.push(s) : ut.merge(a, L(s, i));
        return i === t || i && ut.nodeName(e, i) ? ut.merge([e], a) : a
    }

    function w(e) {
        ti.test(e.type) && (e.defaultChecked = e.checked)
    }

    function O(e, t) {
        if (t in e)return t;
        for (var i = t.charAt(0).toUpperCase() + t.slice(1), n = t, s = xi.length; s--;)if (t = xi[s] + i, t in e)return t;
        return n
    }

    function C(e, t) {
        return e = t || e, "none" === ut.css(e, "display") || !ut.contains(e.ownerDocument, e)
    }

    function x(e, t) {
        for (var i, n, s, r = [], a = 0, o = e.length; o > a; a++)n = e[a], n.style && (r[a] = ut._data(n, "olddisplay"), i = n.style.display, t ? (r[a] || "none" !== i || (n.style.display = ""), "" === n.style.display && C(n) && (r[a] = ut._data(n, "olddisplay", E(n.nodeName)))) : r[a] || (s = C(n), (i && "none" !== i || !s) && ut._data(n, "olddisplay", s ? i : ut.css(n, "display"))));
        for (a = 0; o > a; a++)n = e[a], n.style && (t && "none" !== n.style.display && "" !== n.style.display || (n.style.display = t ? r[a] || "" : "none"));
        return e
    }

    function S(e, t, i) {
        var n = yi.exec(t);
        return n ? Math.max(0, n[1] - (i || 0)) + (n[2] || "px") : t
    }

    function _(e, t, i, n, s) {
        for (var r = i === (n ? "border" : "content") ? 4 : "width" === t ? 1 : 0, a = 0; 4 > r; r += 2)"margin" === i && (a += ut.css(e, i + Ci[r], !0, s)), n ? ("content" === i && (a -= ut.css(e, "padding" + Ci[r], !0, s)), "margin" !== i && (a -= ut.css(e, "border" + Ci[r] + "Width", !0, s))) : (a += ut.css(e, "padding" + Ci[r], !0, s), "padding" !== i && (a += ut.css(e, "border" + Ci[r] + "Width", !0, s)));
        return a
    }

    function T(e, t, i) {
        var n = !0, s = "width" === t ? e.offsetWidth : e.offsetHeight, r = ui(e), a = ut.support.boxSizing && "border-box" === ut.css(e, "boxSizing", !1, r);
        if (0 >= s || null == s) {
            if (s = ci(e, t, r), (0 > s || null == s) && (s = e.style[t]), vi.test(s))return s;
            n = a && (ut.support.boxSizingReliable || s === e.style[t]), s = parseFloat(s) || 0
        }
        return s + _(e, t, i || (a ? "border" : "content"), n, r) + "px"
    }

    function E(e) {
        var t = Z, i = Li[e];
        return i || (i = N(e, t), "none" !== i && i || (hi = (hi || ut("<iframe frameborder='0' width='0' height='0'/>").css("cssText", "display:block !important")).appendTo(t.documentElement), t = (hi[0].contentWindow || hi[0].contentDocument).document, t.write("<!doctype html><html><body>"), t.close(), i = N(e, t), hi.detach()), Li[e] = i), i
    }

    function N(e, t) {
        var i = ut(t.createElement(e)).appendTo(t.body), n = ut.css(i[0], "display");
        return i.remove(), n
    }

    function P(e, t, i, n) {
        var s;
        if (ut.isArray(t)) ut.each(t, function (t, s) {
            i || _i.test(e) ? n(e, s) : P(e + "[" + ("object" == typeof s ? t : "") + "]", s, i, n)
        }); else if (i || "object" !== ut.type(t)) n(e, t); else for (s in t)P(e + "[" + s + "]", t[s], i, n)
    }

    function M(e) {
        return function (t, i) {
            "string" != typeof t && (i = t, t = "*");
            var n, s = 0, r = t.toLowerCase().match(pt) || [];
            if (ut.isFunction(i))for (; n = r[s++];)"+" === n[0] ? (n = n.slice(1) || "*", (e[n] = e[n] || []).unshift(i)) : (e[n] = e[n] || []).push(i)
        }
    }

    function k(e, t, i, n) {
        function s(o) {
            var l;
            return r[o] = !0, ut.each(e[o] || [], function (e, o) {
                var h = o(t, i, n);
                return "string" != typeof h || a || r[h] ? a ? !(l = h) : void 0 : (t.dataTypes.unshift(h), s(h), !1)
            }), l
        }

        var r = {}, a = e === Gi;
        return s(t.dataTypes[0]) || !r["*"] && s("*")
    }

    function F(e, i) {
        var n, s, r = ut.ajaxSettings.flatOptions || {};
        for (s in i)i[s] !== t && ((r[s] ? e : n || (n = {}))[s] = i[s]);
        return n && ut.extend(!0, e, n), e
    }

    function D(e, i, n) {
        for (var s, r, a, o, l = e.contents, h = e.dataTypes; "*" === h[0];)h.shift(), r === t && (r = e.mimeType || i.getResponseHeader("Content-Type"));
        if (r)for (o in l)if (l[o] && l[o].test(r)) {
            h.unshift(o);
            break
        }
        if (h[0] in n) a = h[0]; else {
            for (o in n) {
                if (!h[0] || e.converters[o + " " + h[0]]) {
                    a = o;
                    break
                }
                s || (s = o)
            }
            a = a || s
        }
        return a ? (a !== h[0] && h.unshift(a), n[a]) : void 0
    }

    function A(e, t, i, n) {
        var s, r, a, o, l, h = {}, u = e.dataTypes.slice();
        if (u[1])for (a in e.converters)h[a.toLowerCase()] = e.converters[a];
        for (r = u.shift(); r;)if (e.responseFields[r] && (i[e.responseFields[r]] = t), !l && n && e.dataFilter && (t = e.dataFilter(t, e.dataType)), l = r, r = u.shift())if ("*" === r) r = l; else if ("*" !== l && l !== r) {
            if (a = h[l + " " + r] || h["* " + r], !a)for (s in h)if (o = s.split(" "), o[1] === r && (a = h[l + " " + o[0]] || h["* " + o[0]])) {
                a === !0 ? a = h[s] : h[s] !== !0 && (r = o[0], u.unshift(o[1]));
                break
            }
            if (a !== !0)if (a && e["throws"]) t = a(t); else try {
                t = a(t)
            } catch (c) {
                return {state: "parsererror", error: a ? c : "No conversion from " + l + " to " + r}
            }
        }
        return {state: "success", data: t}
    }

    function I() {
        try {
            return new e.XMLHttpRequest
        } catch (t) {
        }
    }

    function R() {
        try {
            return new e.ActiveXObject("Microsoft.XMLHTTP")
        } catch (t) {
        }
    }

    function z() {
        return setTimeout(function () {
            Ji = t
        }), Ji = ut.now()
    }

    function B(e, t, i) {
        for (var n, s = (rn[t] || []).concat(rn["*"]), r = 0, a = s.length; a > r; r++)if (n = s[r].call(i, t, e))return n
    }

    function U(e, t, i) {
        var n, s, r = 0, a = sn.length, o = ut.Deferred().always(function () {
            delete l.elem
        }), l = function () {
            if (s)return !1;
            for (var t = Ji || z(), i = Math.max(0, h.startTime + h.duration - t), n = i / h.duration || 0, r = 1 - n, a = 0, l = h.tweens.length; l > a; a++)h.tweens[a].run(r);
            return o.notifyWith(e, [h, r, i]), 1 > r && l ? i : (o.resolveWith(e, [h]), !1)
        }, h = o.promise({
            elem: e,
            props: ut.extend({}, t),
            opts: ut.extend(!0, {specialEasing: {}}, i),
            originalProperties: t,
            originalOptions: i,
            startTime: Ji || z(),
            duration: i.duration,
            tweens: [],
            createTween: function (t, i) {
                var n = ut.Tween(e, h.opts, t, i, h.opts.specialEasing[t] || h.opts.easing);
                return h.tweens.push(n), n
            },
            stop: function (t) {
                var i = 0, n = t ? h.tweens.length : 0;
                if (s)return this;
                for (s = !0; n > i; i++)h.tweens[i].run(1);
                return t ? o.resolveWith(e, [h, t]) : o.rejectWith(e, [h, t]), this
            }
        }), u = h.props;
        for (j(u, h.opts.specialEasing); a > r; r++)if (n = sn[r].call(h, e, u, h.opts))return n;
        return ut.map(u, B, h), ut.isFunction(h.opts.start) && h.opts.start.call(e, h), ut.fx.timer(ut.extend(l, {
            elem: e,
            anim: h,
            queue: h.opts.queue
        })), h.progress(h.opts.progress).done(h.opts.done, h.opts.complete).fail(h.opts.fail).always(h.opts.always)
    }

    function j(e, t) {
        var i, n, s, r, a;
        for (i in e)if (n = ut.camelCase(i), s = t[n], r = e[i], ut.isArray(r) && (s = r[1], r = e[i] = r[0]), i !== n && (e[n] = r, delete e[i]), a = ut.cssHooks[n], a && "expand" in a) {
            r = a.expand(r), delete e[n];
            for (i in r)i in e || (e[i] = r[i], t[i] = s)
        } else t[n] = s
    }

    function H(e, t, i) {
        var n, s, r, a, o, l, h = this, u = {}, c = e.style, p = e.nodeType && C(e), d = ut._data(e, "fxshow");
        i.queue || (o = ut._queueHooks(e, "fx"), null == o.unqueued && (o.unqueued = 0, l = o.empty.fire, o.empty.fire = function () {
            o.unqueued || l()
        }), o.unqueued++, h.always(function () {
            h.always(function () {
                o.unqueued--, ut.queue(e, "fx").length || o.empty.fire()
            })
        })), 1 === e.nodeType && ("height" in t || "width" in t) && (i.overflow = [c.overflow, c.overflowX, c.overflowY], "inline" === ut.css(e, "display") && "none" === ut.css(e, "float") && (ut.support.inlineBlockNeedsLayout && "inline" !== E(e.nodeName) ? c.zoom = 1 : c.display = "inline-block")), i.overflow && (c.overflow = "hidden", ut.support.shrinkWrapBlocks || h.always(function () {
            c.overflow = i.overflow[0], c.overflowX = i.overflow[1], c.overflowY = i.overflow[2]
        }));
        for (n in t)if (s = t[n], en.exec(s)) {
            if (delete t[n], r = r || "toggle" === s, s === (p ? "hide" : "show"))continue;
            u[n] = d && d[n] || ut.style(e, n)
        }
        if (!ut.isEmptyObject(u)) {
            d ? "hidden" in d && (p = d.hidden) : d = ut._data(e, "fxshow", {}), r && (d.hidden = !p), p ? ut(e).show() : h.done(function () {
                ut(e).hide()
            }), h.done(function () {
                var t;
                ut._removeData(e, "fxshow");
                for (t in u)ut.style(e, t, u[t])
            });
            for (n in u)a = B(p ? d[n] : 0, n, h), n in d || (d[n] = a.start, p && (a.end = a.start, a.start = "width" === n || "height" === n ? 1 : 0))
        }
    }

    function G(e, t, i, n, s) {
        return new G.prototype.init(e, t, i, n, s)
    }

    function $(e, t) {
        var i, n = {height: e}, s = 0;
        for (t = t ? 1 : 0; 4 > s; s += 2 - t)i = Ci[s], n["margin" + i] = n["padding" + i] = e;
        return t && (n.opacity = n.width = e), n
    }

    function W(e) {
        return ut.isWindow(e) ? e : 9 === e.nodeType ? e.defaultView || e.parentWindow : !1
    }

    var V, q, X = typeof t, Y = e.location, Z = e.document, K = Z.documentElement, J = e.jQuery, Q = e.$, et = {}, tt = [], it = "1.10.1", nt = tt.concat, st = tt.push, rt = tt.slice, at = tt.indexOf, ot = et.toString, lt = et.hasOwnProperty, ht = it.trim, ut = function (e, t) {
        return new ut.fn.init(e, t, q)
    }, ct = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source, pt = /\S+/g, dt = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, ft = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/, mt = /^<(\w+)\s*\/?>(?:<\/\1>|)$/, gt = /^[\],:{}\s]*$/, yt = /(?:^|:|,)(?:\s*\[)+/g, vt = /\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g, bt = /"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g, Lt = /^-ms-/, wt = /-([\da-z])/gi, Ot = function (e, t) {
        return t.toUpperCase()
    }, Ct = function (e) {
        (Z.addEventListener || "load" === e.type || "complete" === Z.readyState) && (xt(), ut.ready())
    }, xt = function () {
        Z.addEventListener ? (Z.removeEventListener("DOMContentLoaded", Ct, !1), e.removeEventListener("load", Ct, !1)) : (Z.detachEvent("onreadystatechange", Ct), e.detachEvent("onload", Ct))
    };
    ut.fn = ut.prototype = {
        jquery: it, constructor: ut, init: function (e, i, n) {
            var s, r;
            if (!e)return this;
            if ("string" == typeof e) {
                if (s = "<" === e.charAt(0) && ">" === e.charAt(e.length - 1) && e.length >= 3 ? [null, e, null] : ft.exec(e), !s || !s[1] && i)return !i || i.jquery ? (i || n).find(e) : this.constructor(i).find(e);
                if (s[1]) {
                    if (i = i instanceof ut ? i[0] : i, ut.merge(this, ut.parseHTML(s[1], i && i.nodeType ? i.ownerDocument || i : Z, !0)), mt.test(s[1]) && ut.isPlainObject(i))for (s in i)ut.isFunction(this[s]) ? this[s](i[s]) : this.attr(s, i[s]);
                    return this
                }
                if (r = Z.getElementById(s[2]), r && r.parentNode) {
                    if (r.id !== s[2])return n.find(e);
                    this.length = 1, this[0] = r
                }
                return this.context = Z, this.selector = e, this
            }
            return e.nodeType ? (this.context = this[0] = e, this.length = 1, this) : ut.isFunction(e) ? n.ready(e) : (e.selector !== t && (this.selector = e.selector, this.context = e.context), ut.makeArray(e, this))
        }, selector: "", length: 0, toArray: function () {
            return rt.call(this)
        }, get: function (e) {
            return null == e ? this.toArray() : 0 > e ? this[this.length + e] : this[e]
        }, pushStack: function (e) {
            var t = ut.merge(this.constructor(), e);
            return t.prevObject = this, t.context = this.context, t
        }, each: function (e, t) {
            return ut.each(this, e, t)
        }, ready: function (e) {
            return ut.ready.promise().done(e), this
        }, slice: function () {
            return this.pushStack(rt.apply(this, arguments))
        }, first: function () {
            return this.eq(0)
        }, last: function () {
            return this.eq(-1)
        }, eq: function (e) {
            var t = this.length, i = +e + (0 > e ? t : 0);
            return this.pushStack(i >= 0 && t > i ? [this[i]] : [])
        }, map: function (e) {
            return this.pushStack(ut.map(this, function (t, i) {
                return e.call(t, i, t)
            }))
        }, end: function () {
            return this.prevObject || this.constructor(null)
        }, push: st, sort: [].sort, splice: [].splice
    }, ut.fn.init.prototype = ut.fn, ut.extend = ut.fn.extend = function () {
        var e, i, n, s, r, a, o = arguments[0] || {}, l = 1, h = arguments.length, u = !1;
        for ("boolean" == typeof o && (u = o, o = arguments[1] || {}, l = 2), "object" == typeof o || ut.isFunction(o) || (o = {}), h === l && (o = this, --l); h > l; l++)if (null != (r = arguments[l]))for (s in r)e = o[s], n = r[s], o !== n && (u && n && (ut.isPlainObject(n) || (i = ut.isArray(n))) ? (i ? (i = !1, a = e && ut.isArray(e) ? e : []) : a = e && ut.isPlainObject(e) ? e : {}, o[s] = ut.extend(u, a, n)) : n !== t && (o[s] = n));
        return o
    }, ut.extend({
        expando: "jQuery" + (it + Math.random()).replace(/\D/g, ""), noConflict: function (t) {
            return e.$ === ut && (e.$ = Q), t && e.jQuery === ut && (e.jQuery = J), ut
        }, isReady: !1, readyWait: 1, holdReady: function (e) {
            e ? ut.readyWait++ : ut.ready(!0)
        }, ready: function (e) {
            if (e === !0 ? !--ut.readyWait : !ut.isReady) {
                if (!Z.body)return setTimeout(ut.ready);
                ut.isReady = !0, e !== !0 && --ut.readyWait > 0 || (V.resolveWith(Z, [ut]), ut.fn.trigger && ut(Z).trigger("ready").off("ready"))
            }
        }, isFunction: function (e) {
            return "function" === ut.type(e)
        }, isArray: Array.isArray || function (e) {
            return "array" === ut.type(e)
        }, isWindow: function (e) {
            return null != e && e == e.window
        }, isNumeric: function (e) {
            return !isNaN(parseFloat(e)) && isFinite(e)
        }, type: function (e) {
            return null == e ? String(e) : "object" == typeof e || "function" == typeof e ? et[ot.call(e)] || "object" : typeof e
        }, isPlainObject: function (e) {
            var i;
            if (!e || "object" !== ut.type(e) || e.nodeType || ut.isWindow(e))return !1;
            try {
                if (e.constructor && !lt.call(e, "constructor") && !lt.call(e.constructor.prototype, "isPrototypeOf"))return !1
            } catch (n) {
                return !1
            }
            if (ut.support.ownLast)for (i in e)return lt.call(e, i);
            for (i in e);
            return i === t || lt.call(e, i)
        }, isEmptyObject: function (e) {
            var t;
            for (t in e)return !1;
            return !0
        }, error: function (e) {
            throw new Error(e)
        }, parseHTML: function (e, t, i) {
            if (!e || "string" != typeof e)return null;
            "boolean" == typeof t && (i = t, t = !1), t = t || Z;
            var n = mt.exec(e), s = !i && [];
            return n ? [t.createElement(n[1])] : (n = ut.buildFragment([e], t, s), s && ut(s).remove(), ut.merge([], n.childNodes))
        }, parseJSON: function (t) {
            return e.JSON && e.JSON.parse ? e.JSON.parse(t) : null === t ? t : "string" == typeof t && (t = ut.trim(t), t && gt.test(t.replace(vt, "@").replace(bt, "]").replace(yt, ""))) ? new Function("return " + t)() : (ut.error("Invalid JSON: " + t), void 0)
        }, parseXML: function (i) {
            var n, s;
            if (!i || "string" != typeof i)return null;
            try {
                e.DOMParser ? (s = new DOMParser, n = s.parseFromString(i, "text/xml")) : (n = new ActiveXObject("Microsoft.XMLDOM"), n.async = "false", n.loadXML(i))
            } catch (r) {
                n = t
            }
            return n && n.documentElement && !n.getElementsByTagName("parsererror").length || ut.error("Invalid XML: " + i), n
        }, noop: function () {
        }, globalEval: function (t) {
            t && ut.trim(t) && (e.execScript || function (t) {
                e.eval.call(e, t)
            })(t)
        }, camelCase: function (e) {
            return e.replace(Lt, "ms-").replace(wt, Ot)
        }, nodeName: function (e, t) {
            return e.nodeName && e.nodeName.toLowerCase() === t.toLowerCase()
        }, each: function (e, t, n) {
            var s, r = 0, a = e.length, o = i(e);
            if (n) {
                if (o)for (; a > r && (s = t.apply(e[r], n), s !== !1); r++); else for (r in e)if (s = t.apply(e[r], n), s === !1)break
            } else if (o)for (; a > r && (s = t.call(e[r], r, e[r]), s !== !1); r++); else for (r in e)if (s = t.call(e[r], r, e[r]), s === !1)break;
            return e
        }, trim: ht && !ht.call("﻿ ") ? function (e) {
            return null == e ? "" : ht.call(e)
        } : function (e) {
            return null == e ? "" : (e + "").replace(dt, "")
        }, makeArray: function (e, t) {
            var n = t || [];
            return null != e && (i(Object(e)) ? ut.merge(n, "string" == typeof e ? [e] : e) : st.call(n, e)), n
        }, inArray: function (e, t, i) {
            var n;
            if (t) {
                if (at)return at.call(t, e, i);
                for (n = t.length, i = i ? 0 > i ? Math.max(0, n + i) : i : 0; n > i; i++)if (i in t && t[i] === e)return i
            }
            return -1
        }, merge: function (e, i) {
            var n = i.length, s = e.length, r = 0;
            if ("number" == typeof n)for (; n > r; r++)e[s++] = i[r]; else for (; i[r] !== t;)e[s++] = i[r++];
            return e.length = s, e
        }, grep: function (e, t, i) {
            var n, s = [], r = 0, a = e.length;
            for (i = !!i; a > r; r++)n = !!t(e[r], r), i !== n && s.push(e[r]);
            return s
        }, map: function (e, t, n) {
            var s, r = 0, a = e.length, o = i(e), l = [];
            if (o)for (; a > r; r++)s = t(e[r], r, n), null != s && (l[l.length] = s); else for (r in e)s = t(e[r], r, n), null != s && (l[l.length] = s);
            return nt.apply([], l)
        }, guid: 1, proxy: function (e, i) {
            var n, s, r;
            return "string" == typeof i && (r = e[i], i = e, e = r), ut.isFunction(e) ? (n = rt.call(arguments, 2), s = function () {
                return e.apply(i || this, n.concat(rt.call(arguments)))
            }, s.guid = e.guid = e.guid || ut.guid++, s) : t
        }, access: function (e, i, n, s, r, a, o) {
            var l = 0, h = e.length, u = null == n;
            if ("object" === ut.type(n)) {
                r = !0;
                for (l in n)ut.access(e, i, l, n[l], !0, a, o)
            } else if (s !== t && (r = !0, ut.isFunction(s) || (o = !0), u && (o ? (i.call(e, s), i = null) : (u = i, i = function (e, t, i) {
                    return u.call(ut(e), i)
                })), i))for (; h > l; l++)i(e[l], n, o ? s : s.call(e[l], l, i(e[l], n)));
            return r ? e : u ? i.call(e) : h ? i(e[0], n) : a
        }, now: function () {
            return (new Date).getTime()
        }, swap: function (e, t, i, n) {
            var s, r, a = {};
            for (r in t)a[r] = e.style[r], e.style[r] = t[r];
            s = i.apply(e, n || []);
            for (r in t)e.style[r] = a[r];
            return s
        }
    }), ut.ready.promise = function (t) {
        if (!V)if (V = ut.Deferred(), "complete" === Z.readyState) setTimeout(ut.ready); else if (Z.addEventListener) Z.addEventListener("DOMContentLoaded", Ct, !1), e.addEventListener("load", Ct, !1); else {
            Z.attachEvent("onreadystatechange", Ct), e.attachEvent("onload", Ct);
            var i = !1;
            try {
                i = null == e.frameElement && Z.documentElement
            } catch (n) {
            }
            i && i.doScroll && function s() {
                if (!ut.isReady) {
                    try {
                        i.doScroll("left")
                    } catch (e) {
                        return setTimeout(s, 50)
                    }
                    xt(), ut.ready()
                }
            }()
        }
        return V.promise(t)
    }, ut.each("Boolean Number String Function Array Date RegExp Object Error".split(" "), function (e, t) {
        et["[object " + t + "]"] = t.toLowerCase()
    }), q = ut(Z), /*!
     * Sizzle CSS Selector Engine v1.9.4-pre
     * http://sizzlejs.com/
     *
     * Copyright 2013 jQuery Foundation, Inc. and other contributors
     * Released under the MIT license
     * http://jquery.org/license
     *
     * Date: 2013-05-27
     */
        function (e, t) {
            function i(e, t, i, n) {
                var s, r, a, o, l, h, u, c, p, d;
                if ((t ? t.ownerDocument || t : $) !== I && A(t), t = t || I, i = i || [], !e || "string" != typeof e)return i;
                if (1 !== (o = t.nodeType) && 9 !== o)return [];
                if (z && !n) {
                    if (s = Ct.exec(e))if (a = s[1]) {
                        if (9 === o) {
                            if (r = t.getElementById(a), !r || !r.parentNode)return i;
                            if (r.id === a)return i.push(r), i
                        } else if (t.ownerDocument && (r = t.ownerDocument.getElementById(a)) && H(t, r) && r.id === a)return i.push(r), i
                    } else {
                        if (s[2])return st.apply(i, t.getElementsByTagName(e)), i;
                        if ((a = s[3]) && T.getElementsByClassName && t.getElementsByClassName)return st.apply(i, t.getElementsByClassName(a)), i
                    }
                    if (T.qsa && (!B || !B.test(e))) {
                        if (c = u = G, p = t, d = 9 === o && e, 1 === o && "object" !== t.nodeName.toLowerCase()) {
                            for (h = m(e), (u = t.getAttribute("id")) ? c = u.replace(_t, "\\$&") : t.setAttribute("id", c), c = "[id='" + c + "'] ", l = h.length; l--;)h[l] = c + g(h[l]);
                            p = yt.test(e) && t.parentNode || t, d = h.join(",")
                        }
                        if (d)try {
                            return st.apply(i, p.querySelectorAll(d)), i
                        } catch (f) {
                        } finally {
                            u || t.removeAttribute("id")
                        }
                    }
                }
                return x(e.replace(ft, "$1"), t, i, n)
            }

            function n(e) {
                return Ot.test(e + "")
            }

            function s() {
                function e(i, n) {
                    return t.push(i += " ") > N.cacheLength && delete e[t.shift()], e[i] = n
                }

                var t = [];
                return e
            }

            function r(e) {
                return e[G] = !0, e
            }

            function a(e) {
                var t = I.createElement("div");
                try {
                    return !!e(t)
                } catch (i) {
                    return !1
                } finally {
                    t.parentNode && t.parentNode.removeChild(t), t = null
                }
            }

            function o(e, t, i) {
                e = e.split("|");
                for (var n, s = e.length, r = i ? null : t; s--;)(n = N.attrHandle[e[s]]) && n !== t || (N.attrHandle[e[s]] = r)
            }

            function l(e, t) {
                var i = e.getAttributeNode(t);
                return i && i.specified ? i.value : e[t] === !0 ? t.toLowerCase() : null
            }

            function h(e, t) {
                return e.getAttribute(t, "type" === t.toLowerCase() ? 1 : 2)
            }

            function u(e) {
                return "input" === e.nodeName.toLowerCase() ? e.defaultValue : void 0
            }

            function c(e, t) {
                var i = t && e, n = i && 1 === e.nodeType && 1 === t.nodeType && (~t.sourceIndex || Q) - (~e.sourceIndex || Q);
                if (n)return n;
                if (i)for (; i = i.nextSibling;)if (i === t)return -1;
                return e ? 1 : -1
            }

            function p(e) {
                return function (t) {
                    var i = t.nodeName.toLowerCase();
                    return "input" === i && t.type === e
                }
            }

            function d(e) {
                return function (t) {
                    var i = t.nodeName.toLowerCase();
                    return ("input" === i || "button" === i) && t.type === e
                }
            }

            function f(e) {
                return r(function (t) {
                    return t = +t, r(function (i, n) {
                        for (var s, r = e([], i.length, t), a = r.length; a--;)i[s = r[a]] && (i[s] = !(n[s] = i[s]))
                    })
                })
            }

            function m(e, t) {
                var n, s, r, a, o, l, h, u = X[e + " "];
                if (u)return t ? 0 : u.slice(0);
                for (o = e, l = [], h = N.preFilter; o;) {
                    (!n || (s = mt.exec(o))) && (s && (o = o.slice(s[0].length) || o), l.push(r = [])), n = !1, (s = gt.exec(o)) && (n = s.shift(), r.push({
                        value: n,
                        type: s[0].replace(ft, " ")
                    }), o = o.slice(n.length));
                    for (a in N.filter)!(s = wt[a].exec(o)) || h[a] && !(s = h[a](s)) || (n = s.shift(), r.push({
                        value: n,
                        type: a,
                        matches: s
                    }), o = o.slice(n.length));
                    if (!n)break
                }
                return t ? o.length : o ? i.error(e) : X(e, l).slice(0)
            }

            function g(e) {
                for (var t = 0, i = e.length, n = ""; i > t; t++)n += e[t].value;
                return n
            }

            function y(e, t, i) {
                var n = t.dir, s = i && "parentNode" === n, r = V++;
                return t.first ? function (t, i, r) {
                    for (; t = t[n];)if (1 === t.nodeType || s)return e(t, i, r)
                } : function (t, i, a) {
                    var o, l, h, u = W + " " + r;
                    if (a) {
                        for (; t = t[n];)if ((1 === t.nodeType || s) && e(t, i, a))return !0
                    } else for (; t = t[n];)if (1 === t.nodeType || s)if (h = t[G] || (t[G] = {}), (l = h[n]) && l[0] === u) {
                        if ((o = l[1]) === !0 || o === E)return o === !0
                    } else if (l = h[n] = [u], l[1] = e(t, i, a) || E, l[1] === !0)return !0
                }
            }

            function v(e) {
                return e.length > 1 ? function (t, i, n) {
                    for (var s = e.length; s--;)if (!e[s](t, i, n))return !1;
                    return !0
                } : e[0]
            }

            function b(e, t, i, n, s) {
                for (var r, a = [], o = 0, l = e.length, h = null != t; l > o; o++)(r = e[o]) && (!i || i(r, n, s)) && (a.push(r), h && t.push(o));
                return a
            }

            function L(e, t, i, n, s, a) {
                return n && !n[G] && (n = L(n)), s && !s[G] && (s = L(s, a)), r(function (r, a, o, l) {
                    var h, u, c, p = [], d = [], f = a.length, m = r || C(t || "*", o.nodeType ? [o] : o, []), g = !e || !r && t ? m : b(m, p, e, o, l), y = i ? s || (r ? e : f || n) ? [] : a : g;
                    if (i && i(g, y, o, l), n)for (h = b(y, d), n(h, [], o, l), u = h.length; u--;)(c = h[u]) && (y[d[u]] = !(g[d[u]] = c));
                    if (r) {
                        if (s || e) {
                            if (s) {
                                for (h = [], u = y.length; u--;)(c = y[u]) && h.push(g[u] = c);
                                s(null, y = [], h, l)
                            }
                            for (u = y.length; u--;)(c = y[u]) && (h = s ? at.call(r, c) : p[u]) > -1 && (r[h] = !(a[h] = c))
                        }
                    } else y = b(y === a ? y.splice(f, y.length) : y), s ? s(null, a, y, l) : st.apply(a, y)
                })
            }

            function w(e) {
                for (var t, i, n, s = e.length, r = N.relative[e[0].type], a = r || N.relative[" "], o = r ? 1 : 0, l = y(function (e) {
                    return e === t
                }, a, !0), h = y(function (e) {
                    return at.call(t, e) > -1
                }, a, !0), u = [function (e, i, n) {
                    return !r && (n || i !== F) || ((t = i).nodeType ? l(e, i, n) : h(e, i, n))
                }]; s > o; o++)if (i = N.relative[e[o].type]) u = [y(v(u), i)]; else {
                    if (i = N.filter[e[o].type].apply(null, e[o].matches), i[G]) {
                        for (n = ++o; s > n && !N.relative[e[n].type]; n++);
                        return L(o > 1 && v(u), o > 1 && g(e.slice(0, o - 1).concat({value: " " === e[o - 2].type ? "*" : ""})).replace(ft, "$1"), i, n > o && w(e.slice(o, n)), s > n && w(e = e.slice(n)), s > n && g(e))
                    }
                    u.push(i)
                }
                return v(u)
            }

            function O(e, t) {
                var n = 0, s = t.length > 0, a = e.length > 0, o = function (r, o, l, h, u) {
                    var c, p, d, f = [], m = 0, g = "0", y = r && [], v = null != u, L = F, w = r || a && N.find.TAG("*", u && o.parentNode || o), O = W += null == L ? 1 : Math.random() || .1;
                    for (v && (F = o !== I && o, E = n); null != (c = w[g]); g++) {
                        if (a && c) {
                            for (p = 0; d = e[p++];)if (d(c, o, l)) {
                                h.push(c);
                                break
                            }
                            v && (W = O, E = ++n)
                        }
                        s && ((c = !d && c) && m--, r && y.push(c))
                    }
                    if (m += g, s && g !== m) {
                        for (p = 0; d = t[p++];)d(y, f, o, l);
                        if (r) {
                            if (m > 0)for (; g--;)y[g] || f[g] || (f[g] = it.call(h));
                            f = b(f)
                        }
                        st.apply(h, f), v && !r && f.length > 0 && m + t.length > 1 && i.uniqueSort(h)
                    }
                    return v && (W = O, F = L), y
                };
                return s ? r(o) : o
            }

            function C(e, t, n) {
                for (var s = 0, r = t.length; r > s; s++)i(e, t[s], n);
                return n
            }

            function x(e, t, i, n) {
                var s, r, a, o, l, h = m(e);
                if (!n && 1 === h.length) {
                    if (r = h[0] = h[0].slice(0), r.length > 2 && "ID" === (a = r[0]).type && T.getById && 9 === t.nodeType && z && N.relative[r[1].type]) {
                        if (t = (N.find.ID(a.matches[0].replace(Tt, Et), t) || [])[0], !t)return i;
                        e = e.slice(r.shift().value.length)
                    }
                    for (s = wt.needsContext.test(e) ? 0 : r.length; s-- && (a = r[s], !N.relative[o = a.type]);)if ((l = N.find[o]) && (n = l(a.matches[0].replace(Tt, Et), yt.test(r[0].type) && t.parentNode || t))) {
                        if (r.splice(s, 1), e = n.length && g(r), !e)return st.apply(i, n), i;
                        break
                    }
                }
                return k(e, h)(n, t, !z, i, yt.test(e)), i
            }

            function S() {
            }

            var _, T, E, N, P, M, k, F, D, A, I, R, z, B, U, j, H, G = "sizzle" + -new Date, $ = e.document, W = 0, V = 0, q = s(), X = s(), Y = s(), Z = !1, K = function () {
                return 0
            }, J = typeof t, Q = 1 << 31, et = {}.hasOwnProperty, tt = [], it = tt.pop, nt = tt.push, st = tt.push, rt = tt.slice, at = tt.indexOf || function (e) {
                    for (var t = 0, i = this.length; i > t; t++)if (this[t] === e)return t;
                    return -1
                }, ot = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped", lt = "[\\x20\\t\\r\\n\\f]", ht = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+", ct = ht.replace("w", "w#"), pt = "\\[" + lt + "*(" + ht + ")" + lt + "*(?:([*^$|!~]?=)" + lt + "*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|(" + ct + ")|)|)" + lt + "*\\]", dt = ":(" + ht + ")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|" + pt.replace(3, 8) + ")*)|.*)\\)|)", ft = new RegExp("^" + lt + "+|((?:^|[^\\\\])(?:\\\\.)*)" + lt + "+$", "g"), mt = new RegExp("^" + lt + "*," + lt + "*"), gt = new RegExp("^" + lt + "*([>+~]|" + lt + ")" + lt + "*"), yt = new RegExp(lt + "*[+~]"), vt = new RegExp("=" + lt + "*([^\\]'\"]*)" + lt + "*\\]", "g"), bt = new RegExp(dt), Lt = new RegExp("^" + ct + "$"), wt = {
                ID: new RegExp("^#(" + ht + ")"),
                CLASS: new RegExp("^\\.(" + ht + ")"),
                TAG: new RegExp("^(" + ht.replace("w", "w*") + ")"),
                ATTR: new RegExp("^" + pt),
                PSEUDO: new RegExp("^" + dt),
                CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + lt + "*(even|odd|(([+-]|)(\\d*)n|)" + lt + "*(?:([+-]|)" + lt + "*(\\d+)|))" + lt + "*\\)|)", "i"),
                bool: new RegExp("^(?:" + ot + ")$", "i"),
                needsContext: new RegExp("^" + lt + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + lt + "*((?:-\\d)?\\d*)" + lt + "*\\)|)(?=[^-]|$)", "i")
            }, Ot = /^[^{]+\{\s*\[native \w/, Ct = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/, xt = /^(?:input|select|textarea|button)$/i, St = /^h\d$/i, _t = /'|\\/g, Tt = new RegExp("\\\\([\\da-f]{1,6}" + lt + "?|(" + lt + ")|.)", "ig"), Et = function (e, t, i) {
                var n = "0x" + t - 65536;
                return n !== n || i ? t : 0 > n ? String.fromCharCode(n + 65536) : String.fromCharCode(55296 | n >> 10, 56320 | 1023 & n)
            };
            try {
                st.apply(tt = rt.call($.childNodes), $.childNodes), tt[$.childNodes.length].nodeType
            } catch (Nt) {
                st = {
                    apply: tt.length ? function (e, t) {
                        nt.apply(e, rt.call(t))
                    } : function (e, t) {
                        for (var i = e.length, n = 0; e[i++] = t[n++];);
                        e.length = i - 1
                    }
                }
            }
            M = i.isXML = function (e) {
                var t = e && (e.ownerDocument || e).documentElement;
                return t ? "HTML" !== t.nodeName : !1
            }, T = i.support = {}, A = i.setDocument = function (e) {
                var t = e ? e.ownerDocument || e : $, i = t.parentWindow;
                return t !== I && 9 === t.nodeType && t.documentElement ? (I = t, R = t.documentElement, z = !M(t), i && i.frameElement && i.attachEvent("onbeforeunload", function () {
                    A()
                }), T.attributes = a(function (e) {
                    return e.innerHTML = "<a href='#'></a>", o("type|href|height|width", h, "#" === e.firstChild.getAttribute("href")), o(ot, l, null == e.getAttribute("disabled")), e.className = "i", !e.getAttribute("className")
                }), T.input = a(function (e) {
                    return e.innerHTML = "<input>", e.firstChild.setAttribute("value", ""), "" === e.firstChild.getAttribute("value")
                }), o("value", u, T.attributes && T.input), T.getElementsByTagName = a(function (e) {
                    return e.appendChild(t.createComment("")), !e.getElementsByTagName("*").length
                }), T.getElementsByClassName = a(function (e) {
                    return e.innerHTML = "<div class='a'></div><div class='a i'></div>", e.firstChild.className = "i", 2 === e.getElementsByClassName("i").length
                }), T.getById = a(function (e) {
                    return R.appendChild(e).id = G, !t.getElementsByName || !t.getElementsByName(G).length
                }), T.getById ? (N.find.ID = function (e, t) {
                    if (typeof t.getElementById !== J && z) {
                        var i = t.getElementById(e);
                        return i && i.parentNode ? [i] : []
                    }
                }, N.filter.ID = function (e) {
                    var t = e.replace(Tt, Et);
                    return function (e) {
                        return e.getAttribute("id") === t
                    }
                }) : (delete N.find.ID, N.filter.ID = function (e) {
                    var t = e.replace(Tt, Et);
                    return function (e) {
                        var i = typeof e.getAttributeNode !== J && e.getAttributeNode("id");
                        return i && i.value === t
                    }
                }), N.find.TAG = T.getElementsByTagName ? function (e, t) {
                    return typeof t.getElementsByTagName !== J ? t.getElementsByTagName(e) : void 0
                } : function (e, t) {
                    var i, n = [], s = 0, r = t.getElementsByTagName(e);
                    if ("*" === e) {
                        for (; i = r[s++];)1 === i.nodeType && n.push(i);
                        return n
                    }
                    return r
                }, N.find.CLASS = T.getElementsByClassName && function (e, t) {
                        return typeof t.getElementsByClassName !== J && z ? t.getElementsByClassName(e) : void 0
                    }, U = [], B = [], (T.qsa = n(t.querySelectorAll)) && (a(function (e) {
                    e.innerHTML = "<select><option selected=''></option></select>", e.querySelectorAll("[selected]").length || B.push("\\[" + lt + "*(?:value|" + ot + ")"), e.querySelectorAll(":checked").length || B.push(":checked")
                }), a(function (e) {
                    var i = t.createElement("input");
                    i.setAttribute("type", "hidden"), e.appendChild(i).setAttribute("t", ""), e.querySelectorAll("[t^='']").length && B.push("[*^$]=" + lt + "*(?:''|\"\")"), e.querySelectorAll(":enabled").length || B.push(":enabled", ":disabled"), e.querySelectorAll("*,:x"), B.push(",.*:")
                })), (T.matchesSelector = n(j = R.webkitMatchesSelector || R.mozMatchesSelector || R.oMatchesSelector || R.msMatchesSelector)) && a(function (e) {
                    T.disconnectedMatch = j.call(e, "div"), j.call(e, "[s!='']:x"), U.push("!=", dt)
                }), B = B.length && new RegExp(B.join("|")), U = U.length && new RegExp(U.join("|")), H = n(R.contains) || R.compareDocumentPosition ? function (e, t) {
                    var i = 9 === e.nodeType ? e.documentElement : e, n = t && t.parentNode;
                    return e === n || !(!n || 1 !== n.nodeType || !(i.contains ? i.contains(n) : e.compareDocumentPosition && 16 & e.compareDocumentPosition(n)))
                } : function (e, t) {
                    if (t)for (; t = t.parentNode;)if (t === e)return !0;
                    return !1
                }, T.sortDetached = a(function (e) {
                    return 1 & e.compareDocumentPosition(t.createElement("div"))
                }), K = R.compareDocumentPosition ? function (e, i) {
                    if (e === i)return Z = !0, 0;
                    var n = i.compareDocumentPosition && e.compareDocumentPosition && e.compareDocumentPosition(i);
                    return n ? 1 & n || !T.sortDetached && i.compareDocumentPosition(e) === n ? e === t || H($, e) ? -1 : i === t || H($, i) ? 1 : D ? at.call(D, e) - at.call(D, i) : 0 : 4 & n ? -1 : 1 : e.compareDocumentPosition ? -1 : 1
                } : function (e, i) {
                    var n, s = 0, r = e.parentNode, a = i.parentNode, o = [e], l = [i];
                    if (e === i)return Z = !0, 0;
                    if (!r || !a)return e === t ? -1 : i === t ? 1 : r ? -1 : a ? 1 : D ? at.call(D, e) - at.call(D, i) : 0;
                    if (r === a)return c(e, i);
                    for (n = e; n = n.parentNode;)o.unshift(n);
                    for (n = i; n = n.parentNode;)l.unshift(n);
                    for (; o[s] === l[s];)s++;
                    return s ? c(o[s], l[s]) : o[s] === $ ? -1 : l[s] === $ ? 1 : 0
                }, t) : I
            }, i.matches = function (e, t) {
                return i(e, null, null, t)
            }, i.matchesSelector = function (e, t) {
                if ((e.ownerDocument || e) !== I && A(e), t = t.replace(vt, "='$1']"), !(!T.matchesSelector || !z || U && U.test(t) || B && B.test(t)))try {
                    var n = j.call(e, t);
                    if (n || T.disconnectedMatch || e.document && 11 !== e.document.nodeType)return n
                } catch (s) {
                }
                return i(t, I, null, [e]).length > 0
            }, i.contains = function (e, t) {
                return (e.ownerDocument || e) !== I && A(e), H(e, t)
            }, i.attr = function (e, i) {
                (e.ownerDocument || e) !== I && A(e);
                var n = N.attrHandle[i.toLowerCase()], s = n && et.call(N.attrHandle, i.toLowerCase()) ? n(e, i, !z) : t;
                return s === t ? T.attributes || !z ? e.getAttribute(i) : (s = e.getAttributeNode(i)) && s.specified ? s.value : null : s
            }, i.error = function (e) {
                throw new Error("Syntax error, unrecognized expression: " + e)
            }, i.uniqueSort = function (e) {
                var t, i = [], n = 0, s = 0;
                if (Z = !T.detectDuplicates, D = !T.sortStable && e.slice(0), e.sort(K), Z) {
                    for (; t = e[s++];)t === e[s] && (n = i.push(s));
                    for (; n--;)e.splice(i[n], 1)
                }
                return e
            }, P = i.getText = function (e) {
                var t, i = "", n = 0, s = e.nodeType;
                if (s) {
                    if (1 === s || 9 === s || 11 === s) {
                        if ("string" == typeof e.textContent)return e.textContent;
                        for (e = e.firstChild; e; e = e.nextSibling)i += P(e)
                    } else if (3 === s || 4 === s)return e.nodeValue
                } else for (; t = e[n]; n++)i += P(t);
                return i
            }, N = i.selectors = {
                cacheLength: 50,
                createPseudo: r,
                match: wt,
                attrHandle: {},
                find: {},
                relative: {
                    ">": {dir: "parentNode", first: !0},
                    " ": {dir: "parentNode"},
                    "+": {dir: "previousSibling", first: !0},
                    "~": {dir: "previousSibling"}
                },
                preFilter: {
                    ATTR: function (e) {
                        return e[1] = e[1].replace(Tt, Et), e[3] = (e[4] || e[5] || "").replace(Tt, Et), "~=" === e[2] && (e[3] = " " + e[3] + " "), e.slice(0, 4)
                    }, CHILD: function (e) {
                        return e[1] = e[1].toLowerCase(), "nth" === e[1].slice(0, 3) ? (e[3] || i.error(e[0]), e[4] = +(e[4] ? e[5] + (e[6] || 1) : 2 * ("even" === e[3] || "odd" === e[3])), e[5] = +(e[7] + e[8] || "odd" === e[3])) : e[3] && i.error(e[0]), e
                    }, PSEUDO: function (e) {
                        var i, n = !e[5] && e[2];
                        return wt.CHILD.test(e[0]) ? null : (e[3] && e[4] !== t ? e[2] = e[4] : n && bt.test(n) && (i = m(n, !0)) && (i = n.indexOf(")", n.length - i) - n.length) && (e[0] = e[0].slice(0, i), e[2] = n.slice(0, i)), e.slice(0, 3))
                    }
                },
                filter: {
                    TAG: function (e) {
                        var t = e.replace(Tt, Et).toLowerCase();
                        return "*" === e ? function () {
                            return !0
                        } : function (e) {
                            return e.nodeName && e.nodeName.toLowerCase() === t
                        }
                    }, CLASS: function (e) {
                        var t = q[e + " "];
                        return t || (t = new RegExp("(^|" + lt + ")" + e + "(" + lt + "|$)")) && q(e, function (e) {
                                return t.test("string" == typeof e.className && e.className || typeof e.getAttribute !== J && e.getAttribute("class") || "")
                            })
                    }, ATTR: function (e, t, n) {
                        return function (s) {
                            var r = i.attr(s, e);
                            return null == r ? "!=" === t : t ? (r += "", "=" === t ? r === n : "!=" === t ? r !== n : "^=" === t ? n && 0 === r.indexOf(n) : "*=" === t ? n && r.indexOf(n) > -1 : "$=" === t ? n && r.slice(-n.length) === n : "~=" === t ? (" " + r + " ").indexOf(n) > -1 : "|=" === t ? r === n || r.slice(0, n.length + 1) === n + "-" : !1) : !0
                        }
                    }, CHILD: function (e, t, i, n, s) {
                        var r = "nth" !== e.slice(0, 3), a = "last" !== e.slice(-4), o = "of-type" === t;
                        return 1 === n && 0 === s ? function (e) {
                            return !!e.parentNode
                        } : function (t, i, l) {
                            var h, u, c, p, d, f, m = r !== a ? "nextSibling" : "previousSibling", g = t.parentNode, y = o && t.nodeName.toLowerCase(), v = !l && !o;
                            if (g) {
                                if (r) {
                                    for (; m;) {
                                        for (c = t; c = c[m];)if (o ? c.nodeName.toLowerCase() === y : 1 === c.nodeType)return !1;
                                        f = m = "only" === e && !f && "nextSibling"
                                    }
                                    return !0
                                }
                                if (f = [a ? g.firstChild : g.lastChild], a && v) {
                                    for (u = g[G] || (g[G] = {}), h = u[e] || [], d = h[0] === W && h[1], p = h[0] === W && h[2], c = d && g.childNodes[d]; c = ++d && c && c[m] || (p = d = 0) || f.pop();)if (1 === c.nodeType && ++p && c === t) {
                                        u[e] = [W, d, p];
                                        break
                                    }
                                } else if (v && (h = (t[G] || (t[G] = {}))[e]) && h[0] === W) p = h[1]; else for (; (c = ++d && c && c[m] || (p = d = 0) || f.pop()) && ((o ? c.nodeName.toLowerCase() !== y : 1 !== c.nodeType) || !++p || (v && ((c[G] || (c[G] = {}))[e] = [W, p]), c !== t)););
                                return p -= s, p === n || 0 === p % n && p / n >= 0
                            }
                        }
                    }, PSEUDO: function (e, t) {
                        var n, s = N.pseudos[e] || N.setFilters[e.toLowerCase()] || i.error("unsupported pseudo: " + e);
                        return s[G] ? s(t) : s.length > 1 ? (n = [e, e, "", t], N.setFilters.hasOwnProperty(e.toLowerCase()) ? r(function (e, i) {
                            for (var n, r = s(e, t), a = r.length; a--;)n = at.call(e, r[a]), e[n] = !(i[n] = r[a])
                        }) : function (e) {
                            return s(e, 0, n)
                        }) : s
                    }
                },
                pseudos: {
                    not: r(function (e) {
                        var t = [], i = [], n = k(e.replace(ft, "$1"));
                        return n[G] ? r(function (e, t, i, s) {
                            for (var r, a = n(e, null, s, []), o = e.length; o--;)(r = a[o]) && (e[o] = !(t[o] = r))
                        }) : function (e, s, r) {
                            return t[0] = e, n(t, null, r, i), !i.pop()
                        }
                    }), has: r(function (e) {
                        return function (t) {
                            return i(e, t).length > 0
                        }
                    }), contains: r(function (e) {
                        return function (t) {
                            return (t.textContent || t.innerText || P(t)).indexOf(e) > -1
                        }
                    }), lang: r(function (e) {
                        return Lt.test(e || "") || i.error("unsupported lang: " + e), e = e.replace(Tt, Et).toLowerCase(), function (t) {
                            var i;
                            do if (i = z ? t.lang : t.getAttribute("xml:lang") || t.getAttribute("lang"))return i = i.toLowerCase(), i === e || 0 === i.indexOf(e + "-"); while ((t = t.parentNode) && 1 === t.nodeType);
                            return !1
                        }
                    }), target: function (t) {
                        var i = e.location && e.location.hash;
                        return i && i.slice(1) === t.id
                    }, root: function (e) {
                        return e === R
                    }, focus: function (e) {
                        return e === I.activeElement && (!I.hasFocus || I.hasFocus()) && !!(e.type || e.href || ~e.tabIndex)
                    }, enabled: function (e) {
                        return e.disabled === !1
                    }, disabled: function (e) {
                        return e.disabled === !0
                    }, checked: function (e) {
                        var t = e.nodeName.toLowerCase();
                        return "input" === t && !!e.checked || "option" === t && !!e.selected
                    }, selected: function (e) {
                        return e.parentNode && e.parentNode.selectedIndex, e.selected === !0
                    }, empty: function (e) {
                        for (e = e.firstChild; e; e = e.nextSibling)if (e.nodeName > "@" || 3 === e.nodeType || 4 === e.nodeType)return !1;
                        return !0
                    }, parent: function (e) {
                        return !N.pseudos.empty(e)
                    }, header: function (e) {
                        return St.test(e.nodeName)
                    }, input: function (e) {
                        return xt.test(e.nodeName)
                    }, button: function (e) {
                        var t = e.nodeName.toLowerCase();
                        return "input" === t && "button" === e.type || "button" === t
                    }, text: function (e) {
                        var t;
                        return "input" === e.nodeName.toLowerCase() && "text" === e.type && (null == (t = e.getAttribute("type")) || t.toLowerCase() === e.type)
                    }, first: f(function () {
                        return [0]
                    }), last: f(function (e, t) {
                        return [t - 1]
                    }), eq: f(function (e, t, i) {
                        return [0 > i ? i + t : i]
                    }), even: f(function (e, t) {
                        for (var i = 0; t > i; i += 2)e.push(i);
                        return e
                    }), odd: f(function (e, t) {
                        for (var i = 1; t > i; i += 2)e.push(i);
                        return e
                    }), lt: f(function (e, t, i) {
                        for (var n = 0 > i ? i + t : i; --n >= 0;)e.push(n);
                        return e
                    }), gt: f(function (e, t, i) {
                        for (var n = 0 > i ? i + t : i; ++n < t;)e.push(n);
                        return e
                    })
                }
            };
            for (_ in{radio: !0, checkbox: !0, file: !0, password: !0, image: !0})N.pseudos[_] = p(_);
            for (_ in{submit: !0, reset: !0})N.pseudos[_] = d(_);
            k = i.compile = function (e, t) {
                var i, n = [], s = [], r = Y[e + " "];
                if (!r) {
                    for (t || (t = m(e)), i = t.length; i--;)r = w(t[i]), r[G] ? n.push(r) : s.push(r);
                    r = Y(e, O(s, n))
                }
                return r
            }, N.pseudos.nth = N.pseudos.eq, S.prototype = N.filters = N.pseudos, N.setFilters = new S, T.sortStable = G.split("").sort(K).join("") === G, A(), [0, 0].sort(K), T.detectDuplicates = Z, ut.find = i, ut.expr = i.selectors, ut.expr[":"] = ut.expr.pseudos, ut.unique = i.uniqueSort, ut.text = i.getText, ut.isXMLDoc = i.isXML, ut.contains = i.contains
        }(e);
    var St = {};
    ut.Callbacks = function (e) {
        e = "string" == typeof e ? St[e] || n(e) : ut.extend({}, e);
        var i, s, r, a, o, l, h = [], u = !e.once && [], c = function (t) {
            for (s = e.memory && t, r = !0, o = l || 0, l = 0, a = h.length, i = !0; h && a > o; o++)if (h[o].apply(t[0], t[1]) === !1 && e.stopOnFalse) {
                s = !1;
                break
            }
            i = !1, h && (u ? u.length && c(u.shift()) : s ? h = [] : p.disable())
        }, p = {
            add: function () {
                if (h) {
                    var t = h.length;
                    !function n(t) {
                        ut.each(t, function (t, i) {
                            var s = ut.type(i);
                            "function" === s ? e.unique && p.has(i) || h.push(i) : i && i.length && "string" !== s && n(i)
                        })
                    }(arguments), i ? a = h.length : s && (l = t, c(s))
                }
                return this
            }, remove: function () {
                return h && ut.each(arguments, function (e, t) {
                    for (var n; (n = ut.inArray(t, h, n)) > -1;)h.splice(n, 1), i && (a >= n && a--, o >= n && o--)
                }), this
            }, has: function (e) {
                return e ? ut.inArray(e, h) > -1 : !(!h || !h.length)
            }, empty: function () {
                return h = [], a = 0, this
            }, disable: function () {
                return h = u = s = t, this
            }, disabled: function () {
                return !h
            }, lock: function () {
                return u = t, s || p.disable(), this
            }, locked: function () {
                return !u
            }, fireWith: function (e, t) {
                return t = t || [], t = [e, t.slice ? t.slice() : t], !h || r && !u || (i ? u.push(t) : c(t)), this
            }, fire: function () {
                return p.fireWith(this, arguments), this
            }, fired: function () {
                return !!r
            }
        };
        return p
    }, ut.extend({
        Deferred: function (e) {
            var t = [["resolve", "done", ut.Callbacks("once memory"), "resolved"], ["reject", "fail", ut.Callbacks("once memory"), "rejected"], ["notify", "progress", ut.Callbacks("memory")]], i = "pending", n = {
                state: function () {
                    return i
                }, always: function () {
                    return s.done(arguments).fail(arguments), this
                }, then: function () {
                    var e = arguments;
                    return ut.Deferred(function (i) {
                        ut.each(t, function (t, r) {
                            var a = r[0], o = ut.isFunction(e[t]) && e[t];
                            s[r[1]](function () {
                                var e = o && o.apply(this, arguments);
                                e && ut.isFunction(e.promise) ? e.promise().done(i.resolve).fail(i.reject).progress(i.notify) : i[a + "With"](this === n ? i.promise() : this, o ? [e] : arguments)
                            })
                        }), e = null
                    }).promise()
                }, promise: function (e) {
                    return null != e ? ut.extend(e, n) : n
                }
            }, s = {};
            return n.pipe = n.then, ut.each(t, function (e, r) {
                var a = r[2], o = r[3];
                n[r[1]] = a.add, o && a.add(function () {
                    i = o
                }, t[1 ^ e][2].disable, t[2][2].lock), s[r[0]] = function () {
                    return s[r[0] + "With"](this === s ? n : this, arguments), this
                }, s[r[0] + "With"] = a.fireWith
            }), n.promise(s), e && e.call(s, s), s
        }, when: function (e) {
            var t, i, n, s = 0, r = rt.call(arguments), a = r.length, o = 1 !== a || e && ut.isFunction(e.promise) ? a : 0, l = 1 === o ? e : ut.Deferred(), h = function (e, i, n) {
                return function (s) {
                    i[e] = this, n[e] = arguments.length > 1 ? rt.call(arguments) : s, n === t ? l.notifyWith(i, n) : --o || l.resolveWith(i, n)
                }
            };
            if (a > 1)for (t = new Array(a), i = new Array(a), n = new Array(a); a > s; s++)r[s] && ut.isFunction(r[s].promise) ? r[s].promise().done(h(s, n, r)).fail(l.reject).progress(h(s, i, t)) : --o;
            return o || l.resolveWith(n, r), l.promise()
        }
    }), ut.support = function (t) {
        var i, n, s, r, a, o, l, h, u, c = Z.createElement("div");
        if (c.setAttribute("className", "t"), c.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", i = c.getElementsByTagName("*") || [], n = c.getElementsByTagName("a")[0], !n || !n.style || !i.length)return t;
        r = Z.createElement("select"), o = r.appendChild(Z.createElement("option")), s = c.getElementsByTagName("input")[0], n.style.cssText = "top:1px;float:left;opacity:.5", t.getSetAttribute = "t" !== c.className, t.leadingWhitespace = 3 === c.firstChild.nodeType, t.tbody = !c.getElementsByTagName("tbody").length, t.htmlSerialize = !!c.getElementsByTagName("link").length, t.style = /top/.test(n.getAttribute("style")), t.hrefNormalized = "/a" === n.getAttribute("href"), t.opacity = /^0.5/.test(n.style.opacity), t.cssFloat = !!n.style.cssFloat, t.checkOn = !!s.value, t.optSelected = o.selected, t.enctype = !!Z.createElement("form").enctype, t.html5Clone = "<:nav></:nav>" !== Z.createElement("nav").cloneNode(!0).outerHTML, t.inlineBlockNeedsLayout = !1, t.shrinkWrapBlocks = !1, t.pixelPosition = !1, t.deleteExpando = !0, t.noCloneEvent = !0, t.reliableMarginRight = !0, t.boxSizingReliable = !0, s.checked = !0, t.noCloneChecked = s.cloneNode(!0).checked, r.disabled = !0, t.optDisabled = !o.disabled;
        try {
            delete c.test
        } catch (p) {
            t.deleteExpando = !1
        }
        s = Z.createElement("input"), s.setAttribute("value", ""), t.input = "" === s.getAttribute("value"), s.value = "t", s.setAttribute("type", "radio"), t.radioValue = "t" === s.value, s.setAttribute("checked", "t"), s.setAttribute("name", "t"), a = Z.createDocumentFragment(), a.appendChild(s), t.appendChecked = s.checked, t.checkClone = a.cloneNode(!0).cloneNode(!0).lastChild.checked, c.attachEvent && (c.attachEvent("onclick", function () {
            t.noCloneEvent = !1
        }), c.cloneNode(!0).click());
        for (u in{
            submit: !0,
            change: !0,
            focusin: !0
        })c.setAttribute(l = "on" + u, "t"), t[u + "Bubbles"] = l in e || c.attributes[l].expando === !1;
        c.style.backgroundClip = "content-box", c.cloneNode(!0).style.backgroundClip = "", t.clearCloneStyle = "content-box" === c.style.backgroundClip;
        for (u in ut(t))break;
        return t.ownLast = "0" !== u, ut(function () {
            var i, n, s, r = "padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;", a = Z.getElementsByTagName("body")[0];
            a && (i = Z.createElement("div"), i.style.cssText = "border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px", a.appendChild(i).appendChild(c), c.innerHTML = "<table><tr><td></td><td>t</td></tr></table>", s = c.getElementsByTagName("td"), s[0].style.cssText = "padding:0;margin:0;border:0;display:none", h = 0 === s[0].offsetHeight, s[0].style.display = "", s[1].style.display = "none", t.reliableHiddenOffsets = h && 0 === s[0].offsetHeight, c.innerHTML = "", c.style.cssText = "box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;", ut.swap(a, null != a.style.zoom ? {zoom: 1} : {}, function () {
                t.boxSizing = 4 === c.offsetWidth
            }), e.getComputedStyle && (t.pixelPosition = "1%" !== (e.getComputedStyle(c, null) || {}).top, t.boxSizingReliable = "4px" === (e.getComputedStyle(c, null) || {width: "4px"}).width, n = c.appendChild(Z.createElement("div")), n.style.cssText = c.style.cssText = r, n.style.marginRight = n.style.width = "0", c.style.width = "1px", t.reliableMarginRight = !parseFloat((e.getComputedStyle(n, null) || {}).marginRight)), typeof c.style.zoom !== X && (c.innerHTML = "", c.style.cssText = r + "width:1px;padding:1px;display:inline;zoom:1", t.inlineBlockNeedsLayout = 3 === c.offsetWidth, c.style.display = "block", c.innerHTML = "<div></div>", c.firstChild.style.width = "5px", t.shrinkWrapBlocks = 3 !== c.offsetWidth, t.inlineBlockNeedsLayout && (a.style.zoom = 1)), a.removeChild(i), i = c = s = n = null)
        }), i = r = a = o = n = s = null, t
    }({});
    var _t = /(?:\{[\s\S]*\}|\[[\s\S]*\])$/, Tt = /([A-Z])/g;
    ut.extend({
        cache: {},
        noData: {applet: !0, embed: !0, object: "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},
        hasData: function (e) {
            return e = e.nodeType ? ut.cache[e[ut.expando]] : e[ut.expando], !!e && !o(e)
        },
        data: function (e, t, i) {
            return s(e, t, i)
        },
        removeData: function (e, t) {
            return r(e, t)
        },
        _data: function (e, t, i) {
            return s(e, t, i, !0)
        },
        _removeData: function (e, t) {
            return r(e, t, !0)
        },
        acceptData: function (e) {
            if (e.nodeType && 1 !== e.nodeType && 9 !== e.nodeType)return !1;
            var t = e.nodeName && ut.noData[e.nodeName.toLowerCase()];
            return !t || t !== !0 && e.getAttribute("classid") === t
        }
    }), ut.fn.extend({
        data: function (e, i) {
            var n, s, r = null, o = 0, l = this[0];
            if (e === t) {
                if (this.length && (r = ut.data(l), 1 === l.nodeType && !ut._data(l, "parsedAttrs"))) {
                    for (n = l.attributes; o < n.length; o++)s = n[o].name, 0 === s.indexOf("data-") && (s = ut.camelCase(s.slice(5)), a(l, s, r[s]));
                    ut._data(l, "parsedAttrs", !0)
                }
                return r
            }
            return "object" == typeof e ? this.each(function () {
                ut.data(this, e)
            }) : arguments.length > 1 ? this.each(function () {
                ut.data(this, e, i)
            }) : l ? a(l, e, ut.data(l, e)) : null
        }, removeData: function (e) {
            return this.each(function () {
                ut.removeData(this, e)
            })
        }
    }), ut.extend({
        queue: function (e, t, i) {
            var n;
            return e ? (t = (t || "fx") + "queue", n = ut._data(e, t), i && (!n || ut.isArray(i) ? n = ut._data(e, t, ut.makeArray(i)) : n.push(i)), n || []) : void 0
        }, dequeue: function (e, t) {
            t = t || "fx";
            var i = ut.queue(e, t), n = i.length, s = i.shift(), r = ut._queueHooks(e, t), a = function () {
                ut.dequeue(e, t)
            };
            "inprogress" === s && (s = i.shift(), n--), s && ("fx" === t && i.unshift("inprogress"), delete r.stop, s.call(e, a, r)), !n && r && r.empty.fire()
        }, _queueHooks: function (e, t) {
            var i = t + "queueHooks";
            return ut._data(e, i) || ut._data(e, i, {
                    empty: ut.Callbacks("once memory").add(function () {
                        ut._removeData(e, t + "queue"), ut._removeData(e, i)
                    })
                })
        }
    }), ut.fn.extend({
        queue: function (e, i) {
            var n = 2;
            return "string" != typeof e && (i = e, e = "fx", n--), arguments.length < n ? ut.queue(this[0], e) : i === t ? this : this.each(function () {
                var t = ut.queue(this, e, i);
                ut._queueHooks(this, e), "fx" === e && "inprogress" !== t[0] && ut.dequeue(this, e)
            })
        }, dequeue: function (e) {
            return this.each(function () {
                ut.dequeue(this, e)
            })
        }, delay: function (e, t) {
            return e = ut.fx ? ut.fx.speeds[e] || e : e, t = t || "fx", this.queue(t, function (t, i) {
                var n = setTimeout(t, e);
                i.stop = function () {
                    clearTimeout(n)
                }
            })
        }, clearQueue: function (e) {
            return this.queue(e || "fx", [])
        }, promise: function (e, i) {
            var n, s = 1, r = ut.Deferred(), a = this, o = this.length, l = function () {
                --s || r.resolveWith(a, [a])
            };
            for ("string" != typeof e && (i = e, e = t), e = e || "fx"; o--;)n = ut._data(a[o], e + "queueHooks"), n && n.empty && (s++, n.empty.add(l));
            return l(), r.promise(i)
        }
    });
    var Et, Nt, Pt = /[\t\r\n\f]/g, Mt = /\r/g, kt = /^(?:input|select|textarea|button|object)$/i, Ft = /^(?:a|area)$/i, Dt = /^(?:checked|selected)$/i, At = ut.support.getSetAttribute, It = ut.support.input;
    ut.fn.extend({
        attr: function (e, t) {
            return ut.access(this, ut.attr, e, t, arguments.length > 1)
        }, removeAttr: function (e) {
            return this.each(function () {
                ut.removeAttr(this, e)
            })
        }, prop: function (e, t) {
            return ut.access(this, ut.prop, e, t, arguments.length > 1)
        }, removeProp: function (e) {
            return e = ut.propFix[e] || e, this.each(function () {
                try {
                    this[e] = t, delete this[e]
                } catch (i) {
                }
            })
        }, addClass: function (e) {
            var t, i, n, s, r, a = 0, o = this.length, l = "string" == typeof e && e;
            if (ut.isFunction(e))return this.each(function (t) {
                ut(this).addClass(e.call(this, t, this.className))
            });
            if (l)for (t = (e || "").match(pt) || []; o > a; a++)if (i = this[a], n = 1 === i.nodeType && (i.className ? (" " + i.className + " ").replace(Pt, " ") : " ")) {
                for (r = 0; s = t[r++];)n.indexOf(" " + s + " ") < 0 && (n += s + " ");
                i.className = ut.trim(n)
            }
            return this
        }, removeClass: function (e) {
            var t, i, n, s, r, a = 0, o = this.length, l = 0 === arguments.length || "string" == typeof e && e;
            if (ut.isFunction(e))return this.each(function (t) {
                ut(this).removeClass(e.call(this, t, this.className))
            });
            if (l)for (t = (e || "").match(pt) || []; o > a; a++)if (i = this[a], n = 1 === i.nodeType && (i.className ? (" " + i.className + " ").replace(Pt, " ") : "")) {
                for (r = 0; s = t[r++];)for (; n.indexOf(" " + s + " ") >= 0;)n = n.replace(" " + s + " ", " ");
                i.className = e ? ut.trim(n) : ""
            }
            return this
        }, toggleClass: function (e, t) {
            var i = typeof e, n = "boolean" == typeof t;
            return ut.isFunction(e) ? this.each(function (i) {
                ut(this).toggleClass(e.call(this, i, this.className, t), t)
            }) : this.each(function () {
                if ("string" === i)for (var s, r = 0, a = ut(this), o = t, l = e.match(pt) || []; s = l[r++];)o = n ? o : !a.hasClass(s), a[o ? "addClass" : "removeClass"](s); else(i === X || "boolean" === i) && (this.className && ut._data(this, "__className__", this.className), this.className = this.className || e === !1 ? "" : ut._data(this, "__className__") || "")
            })
        }, hasClass: function (e) {
            for (var t = " " + e + " ", i = 0, n = this.length; n > i; i++)if (1 === this[i].nodeType && (" " + this[i].className + " ").replace(Pt, " ").indexOf(t) >= 0)return !0;
            return !1
        }, val: function (e) {
            var i, n, s, r = this[0];
            {
                if (arguments.length)return s = ut.isFunction(e), this.each(function (i) {
                    var r;
                    1 === this.nodeType && (r = s ? e.call(this, i, ut(this).val()) : e, null == r ? r = "" : "number" == typeof r ? r += "" : ut.isArray(r) && (r = ut.map(r, function (e) {
                        return null == e ? "" : e + ""
                    })), n = ut.valHooks[this.type] || ut.valHooks[this.nodeName.toLowerCase()], n && "set" in n && n.set(this, r, "value") !== t || (this.value = r))
                });
                if (r)return n = ut.valHooks[r.type] || ut.valHooks[r.nodeName.toLowerCase()], n && "get" in n && (i = n.get(r, "value")) !== t ? i : (i = r.value, "string" == typeof i ? i.replace(Mt, "") : null == i ? "" : i)
            }
        }
    }), ut.extend({
        valHooks: {
            option: {
                get: function (e) {
                    var t = ut.find.attr(e, "value");
                    return null != t ? t : e.text
                }
            }, select: {
                get: function (e) {
                    for (var t, i, n = e.options, s = e.selectedIndex, r = "select-one" === e.type || 0 > s, a = r ? null : [], o = r ? s + 1 : n.length, l = 0 > s ? o : r ? s : 0; o > l; l++)if (i = n[l], !(!i.selected && l !== s || (ut.support.optDisabled ? i.disabled : null !== i.getAttribute("disabled")) || i.parentNode.disabled && ut.nodeName(i.parentNode, "optgroup"))) {
                        if (t = ut(i).val(), r)return t;
                        a.push(t)
                    }
                    return a
                }, set: function (e, t) {
                    for (var i, n, s = e.options, r = ut.makeArray(t), a = s.length; a--;)n = s[a], (n.selected = ut.inArray(ut(n).val(), r) >= 0) && (i = !0);
                    return i || (e.selectedIndex = -1), r
                }
            }
        }, attr: function (e, i, n) {
            var s, r, a = e.nodeType;
            if (e && 3 !== a && 8 !== a && 2 !== a)return typeof e.getAttribute === X ? ut.prop(e, i, n) : (1 === a && ut.isXMLDoc(e) || (i = i.toLowerCase(), s = ut.attrHooks[i] || (ut.expr.match.bool.test(i) ? Nt : Et)), n === t ? s && "get" in s && null !== (r = s.get(e, i)) ? r : (r = ut.find.attr(e, i), null == r ? t : r) : null !== n ? s && "set" in s && (r = s.set(e, n, i)) !== t ? r : (e.setAttribute(i, n + ""), n) : (ut.removeAttr(e, i), void 0))
        }, removeAttr: function (e, t) {
            var i, n, s = 0, r = t && t.match(pt);
            if (r && 1 === e.nodeType)for (; i = r[s++];)n = ut.propFix[i] || i, ut.expr.match.bool.test(i) ? It && At || !Dt.test(i) ? e[n] = !1 : e[ut.camelCase("default-" + i)] = e[n] = !1 : ut.attr(e, i, ""), e.removeAttribute(At ? i : n)
        }, attrHooks: {
            type: {
                set: function (e, t) {
                    if (!ut.support.radioValue && "radio" === t && ut.nodeName(e, "input")) {
                        var i = e.value;
                        return e.setAttribute("type", t), i && (e.value = i), t
                    }
                }
            }
        }, propFix: {"for": "htmlFor", "class": "className"}, prop: function (e, i, n) {
            var s, r, a, o = e.nodeType;
            if (e && 3 !== o && 8 !== o && 2 !== o)return a = 1 !== o || !ut.isXMLDoc(e), a && (i = ut.propFix[i] || i, r = ut.propHooks[i]), n !== t ? r && "set" in r && (s = r.set(e, n, i)) !== t ? s : e[i] = n : r && "get" in r && null !== (s = r.get(e, i)) ? s : e[i]
        }, propHooks: {
            tabIndex: {
                get: function (e) {
                    var t = ut.find.attr(e, "tabindex");
                    return t ? parseInt(t, 10) : kt.test(e.nodeName) || Ft.test(e.nodeName) && e.href ? 0 : -1
                }
            }
        }
    }), Nt = {
        set: function (e, t, i) {
            return t === !1 ? ut.removeAttr(e, i) : It && At || !Dt.test(i) ? e.setAttribute(!At && ut.propFix[i] || i, i) : e[ut.camelCase("default-" + i)] = e[i] = !0, i
        }
    }, ut.each(ut.expr.match.bool.source.match(/\w+/g), function (e, i) {
        var n = ut.expr.attrHandle[i] || ut.find.attr;
        ut.expr.attrHandle[i] = It && At || !Dt.test(i) ? function (e, i, s) {
            var r = ut.expr.attrHandle[i], a = s ? t : (ut.expr.attrHandle[i] = t) != n(e, i, s) ? i.toLowerCase() : null;
            return ut.expr.attrHandle[i] = r, a
        } : function (e, i, n) {
            return n ? t : e[ut.camelCase("default-" + i)] ? i.toLowerCase() : null
        }
    }), It && At || (ut.attrHooks.value = {
        set: function (e, t, i) {
            return ut.nodeName(e, "input") ? (e.defaultValue = t, void 0) : Et && Et.set(e, t, i)
        }
    }), At || (Et = {
        set: function (e, i, n) {
            var s = e.getAttributeNode(n);
            return s || e.setAttributeNode(s = e.ownerDocument.createAttribute(n)), s.value = i += "", "value" === n || i === e.getAttribute(n) ? i : t
        }
    }, ut.expr.attrHandle.id = ut.expr.attrHandle.name = ut.expr.attrHandle.coords = function (e, i, n) {
        var s;
        return n ? t : (s = e.getAttributeNode(i)) && "" !== s.value ? s.value : null
    }, ut.valHooks.button = {
        get: function (e, i) {
            var n = e.getAttributeNode(i);
            return n && n.specified ? n.value : t
        }, set: Et.set
    }, ut.attrHooks.contenteditable = {
        set: function (e, t, i) {
            Et.set(e, "" === t ? !1 : t, i)
        }
    }, ut.each(["width", "height"], function (e, t) {
        ut.attrHooks[t] = {
            set: function (e, i) {
                return "" === i ? (e.setAttribute(t, "auto"), i) : void 0
            }
        }
    })), ut.support.hrefNormalized || ut.each(["href", "src"], function (e, t) {
        ut.propHooks[t] = {
            get: function (e) {
                return e.getAttribute(t, 4)
            }
        }
    }), ut.support.style || (ut.attrHooks.style = {
        get: function (e) {
            return e.style.cssText || t
        }, set: function (e, t) {
            return e.style.cssText = t + ""
        }
    }), ut.support.optSelected || (ut.propHooks.selected = {
        get: function (e) {
            var t = e.parentNode;
            return t && (t.selectedIndex, t.parentNode && t.parentNode.selectedIndex), null
        }
    }), ut.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function () {
        ut.propFix[this.toLowerCase()] = this
    }), ut.support.enctype || (ut.propFix.enctype = "encoding"), ut.each(["radio", "checkbox"], function () {
        ut.valHooks[this] = {
            set: function (e, t) {
                return ut.isArray(t) ? e.checked = ut.inArray(ut(e).val(), t) >= 0 : void 0
            }
        }, ut.support.checkOn || (ut.valHooks[this].get = function (e) {
            return null === e.getAttribute("value") ? "on" : e.value
        })
    });
    var Rt = /^(?:input|select|textarea)$/i, zt = /^key/, Bt = /^(?:mouse|contextmenu)|click/, Ut = /^(?:focusinfocus|focusoutblur)$/, jt = /^([^.]*)(?:\.(.+)|)$/;
    ut.event = {
        global: {},
        add: function (e, i, n, s, r) {
            var a, o, l, h, u, c, p, d, f, m, g, y = ut._data(e);
            if (y) {
                for (n.handler && (h = n, n = h.handler, r = h.selector), n.guid || (n.guid = ut.guid++), (o = y.events) || (o = y.events = {}), (c = y.handle) || (c = y.handle = function (e) {
                    return typeof ut === X || e && ut.event.triggered === e.type ? t : ut.event.dispatch.apply(c.elem, arguments)
                }, c.elem = e), i = (i || "").match(pt) || [""], l = i.length; l--;)a = jt.exec(i[l]) || [], f = g = a[1], m = (a[2] || "").split(".").sort(), f && (u = ut.event.special[f] || {}, f = (r ? u.delegateType : u.bindType) || f, u = ut.event.special[f] || {}, p = ut.extend({
                    type: f,
                    origType: g,
                    data: s,
                    handler: n,
                    guid: n.guid,
                    selector: r,
                    needsContext: r && ut.expr.match.needsContext.test(r),
                    namespace: m.join(".")
                }, h), (d = o[f]) || (d = o[f] = [], d.delegateCount = 0, u.setup && u.setup.call(e, s, m, c) !== !1 || (e.addEventListener ? e.addEventListener(f, c, !1) : e.attachEvent && e.attachEvent("on" + f, c))), u.add && (u.add.call(e, p), p.handler.guid || (p.handler.guid = n.guid)), r ? d.splice(d.delegateCount++, 0, p) : d.push(p), ut.event.global[f] = !0);
                e = null
            }
        },
        remove: function (e, t, i, n, s) {
            var r, a, o, l, h, u, c, p, d, f, m, g = ut.hasData(e) && ut._data(e);
            if (g && (u = g.events)) {
                for (t = (t || "").match(pt) || [""], h = t.length; h--;)if (o = jt.exec(t[h]) || [], d = m = o[1], f = (o[2] || "").split(".").sort(), d) {
                    for (c = ut.event.special[d] || {}, d = (n ? c.delegateType : c.bindType) || d, p = u[d] || [], o = o[2] && new RegExp("(^|\\.)" + f.join("\\.(?:.*\\.|)") + "(\\.|$)"), l = r = p.length; r--;)a = p[r], !s && m !== a.origType || i && i.guid !== a.guid || o && !o.test(a.namespace) || n && n !== a.selector && ("**" !== n || !a.selector) || (p.splice(r, 1), a.selector && p.delegateCount--, c.remove && c.remove.call(e, a));
                    l && !p.length && (c.teardown && c.teardown.call(e, f, g.handle) !== !1 || ut.removeEvent(e, d, g.handle), delete u[d])
                } else for (d in u)ut.event.remove(e, d + t[h], i, n, !0);
                ut.isEmptyObject(u) && (delete g.handle, ut._removeData(e, "events"))
            }
        },
        trigger: function (i, n, s, r) {
            var a, o, l, h, u, c, p, d = [s || Z], f = lt.call(i, "type") ? i.type : i, m = lt.call(i, "namespace") ? i.namespace.split(".") : [];
            if (l = c = s = s || Z, 3 !== s.nodeType && 8 !== s.nodeType && !Ut.test(f + ut.event.triggered) && (f.indexOf(".") >= 0 && (m = f.split("."), f = m.shift(), m.sort()), o = f.indexOf(":") < 0 && "on" + f, i = i[ut.expando] ? i : new ut.Event(f, "object" == typeof i && i), i.isTrigger = r ? 2 : 3, i.namespace = m.join("."), i.namespace_re = i.namespace ? new RegExp("(^|\\.)" + m.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, i.result = t, i.target || (i.target = s), n = null == n ? [i] : ut.makeArray(n, [i]), u = ut.event.special[f] || {}, r || !u.trigger || u.trigger.apply(s, n) !== !1)) {
                if (!r && !u.noBubble && !ut.isWindow(s)) {
                    for (h = u.delegateType || f, Ut.test(h + f) || (l = l.parentNode); l; l = l.parentNode)d.push(l), c = l;
                    c === (s.ownerDocument || Z) && d.push(c.defaultView || c.parentWindow || e)
                }
                for (p = 0; (l = d[p++]) && !i.isPropagationStopped();)i.type = p > 1 ? h : u.bindType || f, a = (ut._data(l, "events") || {})[i.type] && ut._data(l, "handle"), a && a.apply(l, n), a = o && l[o], a && ut.acceptData(l) && a.apply && a.apply(l, n) === !1 && i.preventDefault();
                if (i.type = f, !r && !i.isDefaultPrevented() && (!u._default || u._default.apply(d.pop(), n) === !1) && ut.acceptData(s) && o && s[f] && !ut.isWindow(s)) {
                    c = s[o], c && (s[o] = null), ut.event.triggered = f;
                    try {
                        s[f]()
                    } catch (g) {
                    }
                    ut.event.triggered = t, c && (s[o] = c)
                }
                return i.result
            }
        },
        dispatch: function (e) {
            e = ut.event.fix(e);
            var i, n, s, r, a, o = [], l = rt.call(arguments), h = (ut._data(this, "events") || {})[e.type] || [], u = ut.event.special[e.type] || {};
            if (l[0] = e, e.delegateTarget = this, !u.preDispatch || u.preDispatch.call(this, e) !== !1) {
                for (o = ut.event.handlers.call(this, e, h), i = 0; (r = o[i++]) && !e.isPropagationStopped();)for (e.currentTarget = r.elem, a = 0; (s = r.handlers[a++]) && !e.isImmediatePropagationStopped();)(!e.namespace_re || e.namespace_re.test(s.namespace)) && (e.handleObj = s, e.data = s.data, n = ((ut.event.special[s.origType] || {}).handle || s.handler).apply(r.elem, l), n !== t && (e.result = n) === !1 && (e.preventDefault(), e.stopPropagation()));
                return u.postDispatch && u.postDispatch.call(this, e), e.result
            }
        },
        handlers: function (e, i) {
            var n, s, r, a, o = [], l = i.delegateCount, h = e.target;
            if (l && h.nodeType && (!e.button || "click" !== e.type))for (; h != this; h = h.parentNode || this)if (1 === h.nodeType && (h.disabled !== !0 || "click" !== e.type)) {
                for (r = [], a = 0; l > a; a++)s = i[a], n = s.selector + " ", r[n] === t && (r[n] = s.needsContext ? ut(n, this).index(h) >= 0 : ut.find(n, this, null, [h]).length), r[n] && r.push(s);
                r.length && o.push({elem: h, handlers: r})
            }
            return l < i.length && o.push({elem: this, handlers: i.slice(l)}), o
        },
        fix: function (e) {
            if (e[ut.expando])return e;
            var t, i, n, s = e.type, r = e, a = this.fixHooks[s];
            for (a || (this.fixHooks[s] = a = Bt.test(s) ? this.mouseHooks : zt.test(s) ? this.keyHooks : {}), n = a.props ? this.props.concat(a.props) : this.props, e = new ut.Event(r), t = n.length; t--;)i = n[t], e[i] = r[i];
            return e.target || (e.target = r.srcElement || Z), 3 === e.target.nodeType && (e.target = e.target.parentNode), e.metaKey = !!e.metaKey, a.filter ? a.filter(e, r) : e
        },
        props: "altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
        fixHooks: {},
        keyHooks: {
            props: "char charCode key keyCode".split(" "), filter: function (e, t) {
                return null == e.which && (e.which = null != t.charCode ? t.charCode : t.keyCode), e
            }
        },
        mouseHooks: {
            props: "button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
            filter: function (e, i) {
                var n, s, r, a = i.button, o = i.fromElement;
                return null == e.pageX && null != i.clientX && (s = e.target.ownerDocument || Z, r = s.documentElement, n = s.body, e.pageX = i.clientX + (r && r.scrollLeft || n && n.scrollLeft || 0) - (r && r.clientLeft || n && n.clientLeft || 0), e.pageY = i.clientY + (r && r.scrollTop || n && n.scrollTop || 0) - (r && r.clientTop || n && n.clientTop || 0)), !e.relatedTarget && o && (e.relatedTarget = o === e.target ? i.toElement : o), e.which || a === t || (e.which = 1 & a ? 1 : 2 & a ? 3 : 4 & a ? 2 : 0), e
            }
        },
        special: {
            load: {noBubble: !0}, focus: {
                trigger: function () {
                    if (this !== u() && this.focus)try {
                        return this.focus(), !1
                    } catch (e) {
                    }
                }, delegateType: "focusin"
            }, blur: {
                trigger: function () {
                    return this === u() && this.blur ? (this.blur(), !1) : void 0
                }, delegateType: "focusout"
            }, click: {
                trigger: function () {
                    return ut.nodeName(this, "input") && "checkbox" === this.type && this.click ? (this.click(), !1) : void 0
                }, _default: function (e) {
                    return ut.nodeName(e.target, "a")
                }
            }, beforeunload: {
                postDispatch: function (e) {
                    e.result !== t && (e.originalEvent.returnValue = e.result)
                }
            }
        },
        simulate: function (e, t, i, n) {
            var s = ut.extend(new ut.Event, i, {type: e, isSimulated: !0, originalEvent: {}});
            n ? ut.event.trigger(s, null, t) : ut.event.dispatch.call(t, s), s.isDefaultPrevented() && i.preventDefault()
        }
    }, ut.removeEvent = Z.removeEventListener ? function (e, t, i) {
        e.removeEventListener && e.removeEventListener(t, i, !1)
    } : function (e, t, i) {
        var n = "on" + t;
        e.detachEvent && (typeof e[n] === X && (e[n] = null), e.detachEvent(n, i))
    }, ut.Event = function (e, t) {
        return this instanceof ut.Event ? (e && e.type ? (this.originalEvent = e, this.type = e.type, this.isDefaultPrevented = e.defaultPrevented || e.returnValue === !1 || e.getPreventDefault && e.getPreventDefault() ? l : h) : this.type = e, t && ut.extend(this, t), this.timeStamp = e && e.timeStamp || ut.now(), this[ut.expando] = !0, void 0) : new ut.Event(e, t)
    }, ut.Event.prototype = {
        isDefaultPrevented: h,
        isPropagationStopped: h,
        isImmediatePropagationStopped: h,
        preventDefault: function () {
            var e = this.originalEvent;
            this.isDefaultPrevented = l, e && (e.preventDefault ? e.preventDefault() : e.returnValue = !1)
        },
        stopPropagation: function () {
            var e = this.originalEvent;
            this.isPropagationStopped = l, e && (e.stopPropagation && e.stopPropagation(), e.cancelBubble = !0)
        },
        stopImmediatePropagation: function () {
            this.isImmediatePropagationStopped = l, this.stopPropagation()
        }
    }, ut.each({mouseenter: "mouseover", mouseleave: "mouseout"}, function (e, t) {
        ut.event.special[e] = {
            delegateType: t, bindType: t, handle: function (e) {
                var i, n = this, s = e.relatedTarget, r = e.handleObj;
                return (!s || s !== n && !ut.contains(n, s)) && (e.type = r.origType, i = r.handler.apply(this, arguments), e.type = t), i
            }
        }
    }), ut.support.submitBubbles || (ut.event.special.submit = {
        setup: function () {
            return ut.nodeName(this, "form") ? !1 : (ut.event.add(this, "click._submit keypress._submit", function (e) {
                var i = e.target, n = ut.nodeName(i, "input") || ut.nodeName(i, "button") ? i.form : t;
                n && !ut._data(n, "submitBubbles") && (ut.event.add(n, "submit._submit", function (e) {
                    e._submit_bubble = !0
                }), ut._data(n, "submitBubbles", !0))
            }), void 0)
        }, postDispatch: function (e) {
            e._submit_bubble && (delete e._submit_bubble, this.parentNode && !e.isTrigger && ut.event.simulate("submit", this.parentNode, e, !0))
        }, teardown: function () {
            return ut.nodeName(this, "form") ? !1 : (ut.event.remove(this, "._submit"), void 0)
        }
    }), ut.support.changeBubbles || (ut.event.special.change = {
        setup: function () {
            return Rt.test(this.nodeName) ? (("checkbox" === this.type || "radio" === this.type) && (ut.event.add(this, "propertychange._change", function (e) {
                "checked" === e.originalEvent.propertyName && (this._just_changed = !0)
            }), ut.event.add(this, "click._change", function (e) {
                this._just_changed && !e.isTrigger && (this._just_changed = !1), ut.event.simulate("change", this, e, !0)
            })), !1) : (ut.event.add(this, "beforeactivate._change", function (e) {
                var t = e.target;
                Rt.test(t.nodeName) && !ut._data(t, "changeBubbles") && (ut.event.add(t, "change._change", function (e) {
                    !this.parentNode || e.isSimulated || e.isTrigger || ut.event.simulate("change", this.parentNode, e, !0)
                }), ut._data(t, "changeBubbles", !0))
            }), void 0)
        }, handle: function (e) {
            var t = e.target;
            return this !== t || e.isSimulated || e.isTrigger || "radio" !== t.type && "checkbox" !== t.type ? e.handleObj.handler.apply(this, arguments) : void 0
        }, teardown: function () {
            return ut.event.remove(this, "._change"), !Rt.test(this.nodeName)
        }
    }), ut.support.focusinBubbles || ut.each({focus: "focusin", blur: "focusout"}, function (e, t) {
        var i = 0, n = function (e) {
            ut.event.simulate(t, e.target, ut.event.fix(e), !0)
        };
        ut.event.special[t] = {
            setup: function () {
                0 === i++ && Z.addEventListener(e, n, !0)
            }, teardown: function () {
                0 === --i && Z.removeEventListener(e, n, !0)
            }
        }
    }), ut.fn.extend({
        on: function (e, i, n, s, r) {
            var a, o;
            if ("object" == typeof e) {
                "string" != typeof i && (n = n || i, i = t);
                for (a in e)this.on(a, i, n, e[a], r);
                return this
            }
            if (null == n && null == s ? (s = i, n = i = t) : null == s && ("string" == typeof i ? (s = n, n = t) : (s = n, n = i, i = t)), s === !1) s = h; else if (!s)return this;
            return 1 === r && (o = s, s = function (e) {
                return ut().off(e), o.apply(this, arguments)
            }, s.guid = o.guid || (o.guid = ut.guid++)), this.each(function () {
                ut.event.add(this, e, s, n, i)
            })
        }, one: function (e, t, i, n) {
            return this.on(e, t, i, n, 1)
        }, off: function (e, i, n) {
            var s, r;
            if (e && e.preventDefault && e.handleObj)return s = e.handleObj, ut(e.delegateTarget).off(s.namespace ? s.origType + "." + s.namespace : s.origType, s.selector, s.handler), this;
            if ("object" == typeof e) {
                for (r in e)this.off(r, i, e[r]);
                return this
            }
            return (i === !1 || "function" == typeof i) && (n = i, i = t), n === !1 && (n = h), this.each(function () {
                ut.event.remove(this, e, n, i)
            })
        }, trigger: function (e, t) {
            return this.each(function () {
                ut.event.trigger(e, t, this)
            })
        }, triggerHandler: function (e, t) {
            var i = this[0];
            return i ? ut.event.trigger(e, t, i, !0) : void 0
        }
    });
    var Ht = /^.[^:#\[\.,]*$/, Gt = /^(?:parents|prev(?:Until|All))/, $t = ut.expr.match.needsContext, Wt = {
        children: !0,
        contents: !0,
        next: !0,
        prev: !0
    };
    ut.fn.extend({
        find: function (e) {
            var t, i = [], n = this, s = n.length;
            if ("string" != typeof e)return this.pushStack(ut(e).filter(function () {
                for (t = 0; s > t; t++)if (ut.contains(n[t], this))return !0
            }));
            for (t = 0; s > t; t++)ut.find(e, n[t], i);
            return i = this.pushStack(s > 1 ? ut.unique(i) : i), i.selector = this.selector ? this.selector + " " + e : e, i
        }, has: function (e) {
            var t, i = ut(e, this), n = i.length;
            return this.filter(function () {
                for (t = 0; n > t; t++)if (ut.contains(this, i[t]))return !0
            })
        }, not: function (e) {
            return this.pushStack(p(this, e || [], !0))
        }, filter: function (e) {
            return this.pushStack(p(this, e || [], !1))
        }, is: function (e) {
            return !!p(this, "string" == typeof e && $t.test(e) ? ut(e) : e || [], !1).length
        }, closest: function (e, t) {
            for (var i, n = 0, s = this.length, r = [], a = $t.test(e) || "string" != typeof e ? ut(e, t || this.context) : 0; s > n; n++)for (i = this[n]; i && i !== t; i = i.parentNode)if (i.nodeType < 11 && (a ? a.index(i) > -1 : 1 === i.nodeType && ut.find.matchesSelector(i, e))) {
                i = r.push(i);
                break
            }
            return this.pushStack(r.length > 1 ? ut.unique(r) : r)
        }, index: function (e) {
            return e ? "string" == typeof e ? ut.inArray(this[0], ut(e)) : ut.inArray(e.jquery ? e[0] : e, this) : this[0] && this[0].parentNode ? this.first().prevAll().length : -1
        }, add: function (e, t) {
            var i = "string" == typeof e ? ut(e, t) : ut.makeArray(e && e.nodeType ? [e] : e), n = ut.merge(this.get(), i);
            return this.pushStack(ut.unique(n))
        }, addBack: function (e) {
            return this.add(null == e ? this.prevObject : this.prevObject.filter(e))
        }
    }), ut.each({
        parent: function (e) {
            var t = e.parentNode;
            return t && 11 !== t.nodeType ? t : null
        }, parents: function (e) {
            return ut.dir(e, "parentNode")
        }, parentsUntil: function (e, t, i) {
            return ut.dir(e, "parentNode", i)
        }, next: function (e) {
            return c(e, "nextSibling")
        }, prev: function (e) {
            return c(e, "previousSibling")
        }, nextAll: function (e) {
            return ut.dir(e, "nextSibling")
        }, prevAll: function (e) {
            return ut.dir(e, "previousSibling")
        }, nextUntil: function (e, t, i) {
            return ut.dir(e, "nextSibling", i)
        }, prevUntil: function (e, t, i) {
            return ut.dir(e, "previousSibling", i)
        }, siblings: function (e) {
            return ut.sibling((e.parentNode || {}).firstChild, e)
        }, children: function (e) {
            return ut.sibling(e.firstChild)
        }, contents: function (e) {
            return ut.nodeName(e, "iframe") ? e.contentDocument || e.contentWindow.document : ut.merge([], e.childNodes)
        }
    }, function (e, t) {
        ut.fn[e] = function (i, n) {
            var s = ut.map(this, t, i);
            return "Until" !== e.slice(-5) && (n = i), n && "string" == typeof n && (s = ut.filter(n, s)), this.length > 1 && (Wt[e] || (s = ut.unique(s)), Gt.test(e) && (s = s.reverse())), this.pushStack(s)
        }
    }), ut.extend({
        filter: function (e, t, i) {
            var n = t[0];
            return i && (e = ":not(" + e + ")"), 1 === t.length && 1 === n.nodeType ? ut.find.matchesSelector(n, e) ? [n] : [] : ut.find.matches(e, ut.grep(t, function (e) {
                return 1 === e.nodeType
            }))
        }, dir: function (e, i, n) {
            for (var s = [], r = e[i]; r && 9 !== r.nodeType && (n === t || 1 !== r.nodeType || !ut(r).is(n));)1 === r.nodeType && s.push(r), r = r[i];
            return s
        }, sibling: function (e, t) {
            for (var i = []; e; e = e.nextSibling)1 === e.nodeType && e !== t && i.push(e);
            return i
        }
    });
    var Vt = "abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video", qt = / jQuery\d+="(?:null|\d+)"/g, Xt = new RegExp("<(?:" + Vt + ")[\\s/>]", "i"), Yt = /^\s+/, Zt = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi, Kt = /<([\w:]+)/, Jt = /<tbody/i, Qt = /<|&#?\w+;/, ei = /<(?:script|style|link)/i, ti = /^(?:checkbox|radio)$/i, ii = /checked\s*(?:[^=]|=\s*.checked.)/i, ni = /^$|\/(?:java|ecma)script/i, si = /^true\/(.*)/, ri = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g, ai = {
        option: [1, "<select multiple='multiple'>", "</select>"],
        legend: [1, "<fieldset>", "</fieldset>"],
        area: [1, "<map>", "</map>"],
        param: [1, "<object>", "</object>"],
        thead: [1, "<table>", "</table>"],
        tr: [2, "<table><tbody>", "</tbody></table>"],
        col: [2, "<table><tbody></tbody><colgroup>", "</colgroup></table>"],
        td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
        _default: ut.support.htmlSerialize ? [0, "", ""] : [1, "X<div>", "</div>"]
    }, oi = d(Z), li = oi.appendChild(Z.createElement("div"));
    ai.optgroup = ai.option, ai.tbody = ai.tfoot = ai.colgroup = ai.caption = ai.thead, ai.th = ai.td, ut.fn.extend({
        text: function (e) {
            return ut.access(this, function (e) {
                return e === t ? ut.text(this) : this.empty().append((this[0] && this[0].ownerDocument || Z).createTextNode(e))
            }, null, e, arguments.length)
        }, append: function () {
            return this.domManip(arguments, function (e) {
                if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                    var t = f(this, e);
                    t.appendChild(e)
                }
            })
        }, prepend: function () {
            return this.domManip(arguments, function (e) {
                if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                    var t = f(this, e);
                    t.insertBefore(e, t.firstChild)
                }
            })
        }, before: function () {
            return this.domManip(arguments, function (e) {
                this.parentNode && this.parentNode.insertBefore(e, this)
            })
        }, after: function () {
            return this.domManip(arguments, function (e) {
                this.parentNode && this.parentNode.insertBefore(e, this.nextSibling)
            })
        }, remove: function (e, t) {
            for (var i, n = e ? ut.filter(e, this) : this, s = 0; null != (i = n[s]); s++)t || 1 !== i.nodeType || ut.cleanData(L(i)), i.parentNode && (t && ut.contains(i.ownerDocument, i) && y(L(i, "script")), i.parentNode.removeChild(i));
            return this
        }, empty: function () {
            for (var e, t = 0; null != (e = this[t]); t++) {
                for (1 === e.nodeType && ut.cleanData(L(e, !1)); e.firstChild;)e.removeChild(e.firstChild);
                e.options && ut.nodeName(e, "select") && (e.options.length = 0)
            }
            return this
        }, clone: function (e, t) {
            return e = null == e ? !1 : e, t = null == t ? e : t, this.map(function () {
                return ut.clone(this, e, t)
            })
        }, html: function (e) {
            return ut.access(this, function (e) {
                var i = this[0] || {}, n = 0, s = this.length;
                if (e === t)return 1 === i.nodeType ? i.innerHTML.replace(qt, "") : t;
                if (!("string" != typeof e || ei.test(e) || !ut.support.htmlSerialize && Xt.test(e) || !ut.support.leadingWhitespace && Yt.test(e) || ai[(Kt.exec(e) || ["", ""])[1].toLowerCase()])) {
                    e = e.replace(Zt, "<$1></$2>");
                    try {
                        for (; s > n; n++)i = this[n] || {}, 1 === i.nodeType && (ut.cleanData(L(i, !1)), i.innerHTML = e);
                        i = 0
                    } catch (r) {
                    }
                }
                i && this.empty().append(e)
            }, null, e, arguments.length)
        }, replaceWith: function () {
            var e = ut.map(this, function (e) {
                return [e.nextSibling, e.parentNode]
            }), t = 0;
            return this.domManip(arguments, function (i) {
                var n = e[t++], s = e[t++];
                s && (n && n.parentNode !== s && (n = this.nextSibling), ut(this).remove(), s.insertBefore(i, n))
            }, !0), t ? this : this.remove()
        }, detach: function (e) {
            return this.remove(e, !0)
        }, domManip: function (e, t, i) {
            e = nt.apply([], e);
            var n, s, r, a, o, l, h = 0, u = this.length, c = this, p = u - 1, d = e[0], f = ut.isFunction(d);
            if (f || !(1 >= u || "string" != typeof d || ut.support.checkClone) && ii.test(d))return this.each(function (n) {
                var s = c.eq(n);
                f && (e[0] = d.call(this, n, s.html())), s.domManip(e, t, i)
            });
            if (u && (l = ut.buildFragment(e, this[0].ownerDocument, !1, !i && this), n = l.firstChild, 1 === l.childNodes.length && (l = n), n)) {
                for (a = ut.map(L(l, "script"), m), r = a.length; u > h; h++)s = l, h !== p && (s = ut.clone(s, !0, !0), r && ut.merge(a, L(s, "script"))), t.call(this[h], s, h);
                if (r)for (o = a[a.length - 1].ownerDocument, ut.map(a, g), h = 0; r > h; h++)s = a[h], ni.test(s.type || "") && !ut._data(s, "globalEval") && ut.contains(o, s) && (s.src ? ut._evalUrl(s.src) : ut.globalEval((s.text || s.textContent || s.innerHTML || "").replace(ri, "")));
                l = n = null
            }
            return this
        }
    }), ut.each({
        appendTo: "append",
        prependTo: "prepend",
        insertBefore: "before",
        insertAfter: "after",
        replaceAll: "replaceWith"
    }, function (e, t) {
        ut.fn[e] = function (e) {
            for (var i, n = 0, s = [], r = ut(e), a = r.length - 1; a >= n; n++)i = n === a ? this : this.clone(!0), ut(r[n])[t](i), st.apply(s, i.get());
            return this.pushStack(s)
        }
    }), ut.extend({
        clone: function (e, t, i) {
            var n, s, r, a, o, l = ut.contains(e.ownerDocument, e);
            if (ut.support.html5Clone || ut.isXMLDoc(e) || !Xt.test("<" + e.nodeName + ">") ? r = e.cloneNode(!0) : (li.innerHTML = e.outerHTML, li.removeChild(r = li.firstChild)), !(ut.support.noCloneEvent && ut.support.noCloneChecked || 1 !== e.nodeType && 11 !== e.nodeType || ut.isXMLDoc(e)))for (n = L(r), o = L(e), a = 0; null != (s = o[a]); ++a)n[a] && b(s, n[a]);
            if (t)if (i)for (o = o || L(e), n = n || L(r), a = 0; null != (s = o[a]); a++)v(s, n[a]); else v(e, r);
            return n = L(r, "script"), n.length > 0 && y(n, !l && L(e, "script")), n = o = s = null, r
        }, buildFragment: function (e, t, i, n) {
            for (var s, r, a, o, l, h, u, c = e.length, p = d(t), f = [], m = 0; c > m; m++)if (r = e[m], r || 0 === r)if ("object" === ut.type(r)) ut.merge(f, r.nodeType ? [r] : r); else if (Qt.test(r)) {
                for (o = o || p.appendChild(t.createElement("div")), l = (Kt.exec(r) || ["", ""])[1].toLowerCase(), u = ai[l] || ai._default, o.innerHTML = u[1] + r.replace(Zt, "<$1></$2>") + u[2], s = u[0]; s--;)o = o.lastChild;
                if (!ut.support.leadingWhitespace && Yt.test(r) && f.push(t.createTextNode(Yt.exec(r)[0])), !ut.support.tbody)for (r = "table" !== l || Jt.test(r) ? "<table>" !== u[1] || Jt.test(r) ? 0 : o : o.firstChild, s = r && r.childNodes.length; s--;)ut.nodeName(h = r.childNodes[s], "tbody") && !h.childNodes.length && r.removeChild(h);
                for (ut.merge(f, o.childNodes), o.textContent = ""; o.firstChild;)o.removeChild(o.firstChild);
                o = p.lastChild
            } else f.push(t.createTextNode(r));
            for (o && p.removeChild(o), ut.support.appendChecked || ut.grep(L(f, "input"), w), m = 0; r = f[m++];)if ((!n || -1 === ut.inArray(r, n)) && (a = ut.contains(r.ownerDocument, r), o = L(p.appendChild(r), "script"), a && y(o), i))for (s = 0; r = o[s++];)ni.test(r.type || "") && i.push(r);
            return o = null, p
        }, cleanData: function (e, t) {
            for (var i, n, s, r, a = 0, o = ut.expando, l = ut.cache, h = ut.support.deleteExpando, u = ut.event.special; null != (i = e[a]); a++)if ((t || ut.acceptData(i)) && (s = i[o], r = s && l[s])) {
                if (r.events)for (n in r.events)u[n] ? ut.event.remove(i, n) : ut.removeEvent(i, n, r.handle);
                l[s] && (delete l[s], h ? delete i[o] : typeof i.removeAttribute !== X ? i.removeAttribute(o) : i[o] = null, tt.push(s))
            }
        }, _evalUrl: function (e) {
            return ut.ajax({url: e, type: "GET", dataType: "script", async: !1, global: !1, "throws": !0})
        }
    }), ut.fn.extend({
        wrapAll: function (e) {
            if (ut.isFunction(e))return this.each(function (t) {
                ut(this).wrapAll(e.call(this, t))
            });
            if (this[0]) {
                var t = ut(e, this[0].ownerDocument).eq(0).clone(!0);
                this[0].parentNode && t.insertBefore(this[0]), t.map(function () {
                    for (var e = this; e.firstChild && 1 === e.firstChild.nodeType;)e = e.firstChild;
                    return e
                }).append(this)
            }
            return this
        }, wrapInner: function (e) {
            return ut.isFunction(e) ? this.each(function (t) {
                ut(this).wrapInner(e.call(this, t))
            }) : this.each(function () {
                var t = ut(this), i = t.contents();
                i.length ? i.wrapAll(e) : t.append(e)
            })
        }, wrap: function (e) {
            var t = ut.isFunction(e);
            return this.each(function (i) {
                ut(this).wrapAll(t ? e.call(this, i) : e)
            })
        }, unwrap: function () {
            return this.parent().each(function () {
                ut.nodeName(this, "body") || ut(this).replaceWith(this.childNodes)
            }).end()
        }
    });
    var hi, ui, ci, pi = /alpha\([^)]*\)/i, di = /opacity\s*=\s*([^)]*)/, fi = /^(top|right|bottom|left)$/, mi = /^(none|table(?!-c[ea]).+)/, gi = /^margin/, yi = new RegExp("^(" + ct + ")(.*)$", "i"), vi = new RegExp("^(" + ct + ")(?!px)[a-z%]+$", "i"), bi = new RegExp("^([+-])=(" + ct + ")", "i"), Li = {BODY: "block"}, wi = {
        position: "absolute",
        visibility: "hidden",
        display: "block"
    }, Oi = {
        letterSpacing: 0,
        fontWeight: 400
    }, Ci = ["Top", "Right", "Bottom", "Left"], xi = ["Webkit", "O", "Moz", "ms"];
    ut.fn.extend({
        css: function (e, i) {
            return ut.access(this, function (e, i, n) {
                var s, r, a = {}, o = 0;
                if (ut.isArray(i)) {
                    for (r = ui(e), s = i.length; s > o; o++)a[i[o]] = ut.css(e, i[o], !1, r);
                    return a
                }
                return n !== t ? ut.style(e, i, n) : ut.css(e, i)
            }, e, i, arguments.length > 1)
        }, show: function () {
            return x(this, !0)
        }, hide: function () {
            return x(this)
        }, toggle: function (e) {
            var t = "boolean" == typeof e;
            return this.each(function () {
                (t ? e : C(this)) ? ut(this).show() : ut(this).hide()
            })
        }
    }), ut.extend({
        cssHooks: {
            opacity: {
                get: function (e, t) {
                    if (t) {
                        var i = ci(e, "opacity");
                        return "" === i ? "1" : i
                    }
                }
            }
        },
        cssNumber: {
            columnCount: !0,
            fillOpacity: !0,
            fontWeight: !0,
            lineHeight: !0,
            opacity: !0,
            orphans: !0,
            widows: !0,
            zIndex: !0,
            zoom: !0
        },
        cssProps: {"float": ut.support.cssFloat ? "cssFloat" : "styleFloat"},
        style: function (e, i, n, s) {
            if (e && 3 !== e.nodeType && 8 !== e.nodeType && e.style) {
                var r, a, o, l = ut.camelCase(i), h = e.style;
                if (i = ut.cssProps[l] || (ut.cssProps[l] = O(h, l)), o = ut.cssHooks[i] || ut.cssHooks[l], n === t)return o && "get" in o && (r = o.get(e, !1, s)) !== t ? r : h[i];
                if (a = typeof n, "string" === a && (r = bi.exec(n)) && (n = (r[1] + 1) * r[2] + parseFloat(ut.css(e, i)), a = "number"), !(null == n || "number" === a && isNaN(n) || ("number" !== a || ut.cssNumber[l] || (n += "px"), ut.support.clearCloneStyle || "" !== n || 0 !== i.indexOf("background") || (h[i] = "inherit"), o && "set" in o && (n = o.set(e, n, s)) === t)))try {
                    h[i] = n
                } catch (u) {
                }
            }
        },
        css: function (e, i, n, s) {
            var r, a, o, l = ut.camelCase(i);
            return i = ut.cssProps[l] || (ut.cssProps[l] = O(e.style, l)), o = ut.cssHooks[i] || ut.cssHooks[l], o && "get" in o && (a = o.get(e, !0, n)), a === t && (a = ci(e, i, s)), "normal" === a && i in Oi && (a = Oi[i]), "" === n || n ? (r = parseFloat(a), n === !0 || ut.isNumeric(r) ? r || 0 : a) : a
        }
    }), e.getComputedStyle ? (ui = function (t) {
        return e.getComputedStyle(t, null)
    }, ci = function (e, i, n) {
        var s, r, a, o = n || ui(e), l = o ? o.getPropertyValue(i) || o[i] : t, h = e.style;
        return o && ("" !== l || ut.contains(e.ownerDocument, e) || (l = ut.style(e, i)), vi.test(l) && gi.test(i) && (s = h.width, r = h.minWidth, a = h.maxWidth, h.minWidth = h.maxWidth = h.width = l, l = o.width, h.width = s, h.minWidth = r, h.maxWidth = a)), l
    }) : Z.documentElement.currentStyle && (ui = function (e) {
        return e.currentStyle
    }, ci = function (e, i, n) {
        var s, r, a, o = n || ui(e), l = o ? o[i] : t, h = e.style;
        return null == l && h && h[i] && (l = h[i]), vi.test(l) && !fi.test(i) && (s = h.left, r = e.runtimeStyle, a = r && r.left, a && (r.left = e.currentStyle.left), h.left = "fontSize" === i ? "1em" : l, l = h.pixelLeft + "px", h.left = s, a && (r.left = a)), "" === l ? "auto" : l
    }), ut.each(["height", "width"], function (e, t) {
        ut.cssHooks[t] = {
            get: function (e, i, n) {
                return i ? 0 === e.offsetWidth && mi.test(ut.css(e, "display")) ? ut.swap(e, wi, function () {
                    return T(e, t, n)
                }) : T(e, t, n) : void 0
            }, set: function (e, i, n) {
                var s = n && ui(e);
                return S(e, i, n ? _(e, t, n, ut.support.boxSizing && "border-box" === ut.css(e, "boxSizing", !1, s), s) : 0)
            }
        }
    }), ut.support.opacity || (ut.cssHooks.opacity = {
        get: function (e, t) {
            return di.test((t && e.currentStyle ? e.currentStyle.filter : e.style.filter) || "") ? .01 * parseFloat(RegExp.$1) + "" : t ? "1" : ""
        }, set: function (e, t) {
            var i = e.style, n = e.currentStyle, s = ut.isNumeric(t) ? "alpha(opacity=" + 100 * t + ")" : "", r = n && n.filter || i.filter || "";
            i.zoom = 1, (t >= 1 || "" === t) && "" === ut.trim(r.replace(pi, "")) && i.removeAttribute && (i.removeAttribute("filter"), "" === t || n && !n.filter) || (i.filter = pi.test(r) ? r.replace(pi, s) : r + " " + s)
        }
    }), ut(function () {
        ut.support.reliableMarginRight || (ut.cssHooks.marginRight = {
            get: function (e, t) {
                return t ? ut.swap(e, {display: "inline-block"}, ci, [e, "marginRight"]) : void 0
            }
        }), !ut.support.pixelPosition && ut.fn.position && ut.each(["top", "left"], function (e, t) {
            ut.cssHooks[t] = {
                get: function (e, i) {
                    return i ? (i = ci(e, t), vi.test(i) ? ut(e).position()[t] + "px" : i) : void 0
                }
            }
        })
    }), ut.expr && ut.expr.filters && (ut.expr.filters.hidden = function (e) {
        return e.offsetWidth <= 0 && e.offsetHeight <= 0 || !ut.support.reliableHiddenOffsets && "none" === (e.style && e.style.display || ut.css(e, "display"))
    }, ut.expr.filters.visible = function (e) {
        return !ut.expr.filters.hidden(e)
    }), ut.each({margin: "", padding: "", border: "Width"}, function (e, t) {
        ut.cssHooks[e + t] = {
            expand: function (i) {
                for (var n = 0, s = {}, r = "string" == typeof i ? i.split(" ") : [i]; 4 > n; n++)s[e + Ci[n] + t] = r[n] || r[n - 2] || r[0];
                return s
            }
        }, gi.test(e) || (ut.cssHooks[e + t].set = S)
    });
    var Si = /%20/g, _i = /\[\]$/, Ti = /\r?\n/g, Ei = /^(?:submit|button|image|reset|file)$/i, Ni = /^(?:input|select|textarea|keygen)/i;
    ut.fn.extend({
        serialize: function () {
            return ut.param(this.serializeArray())
        }, serializeArray: function () {
            return this.map(function () {
                var e = ut.prop(this, "elements");
                return e ? ut.makeArray(e) : this
            }).filter(function () {
                var e = this.type;
                return this.name && !ut(this).is(":disabled") && Ni.test(this.nodeName) && !Ei.test(e) && (this.checked || !ti.test(e))
            }).map(function (e, t) {
                var i = ut(this).val();
                return null == i ? null : ut.isArray(i) ? ut.map(i, function (e) {
                    return {name: t.name, value: e.replace(Ti, "\r\n")}
                }) : {name: t.name, value: i.replace(Ti, "\r\n")}
            }).get()
        }
    }), ut.param = function (e, i) {
        var n, s = [], r = function (e, t) {
            t = ut.isFunction(t) ? t() : null == t ? "" : t, s[s.length] = encodeURIComponent(e) + "=" + encodeURIComponent(t)
        };
        if (i === t && (i = ut.ajaxSettings && ut.ajaxSettings.traditional), ut.isArray(e) || e.jquery && !ut.isPlainObject(e)) ut.each(e, function () {
            r(this.name, this.value)
        }); else for (n in e)P(n, e[n], i, r);
        return s.join("&").replace(Si, "+")
    }, ut.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function (e, t) {
        ut.fn[t] = function (e, i) {
            return arguments.length > 0 ? this.on(t, null, e, i) : this.trigger(t)
        }
    }), ut.fn.extend({
        hover: function (e, t) {
            return this.mouseenter(e).mouseleave(t || e)
        }, bind: function (e, t, i) {
            return this.on(e, null, t, i)
        }, unbind: function (e, t) {
            return this.off(e, null, t)
        }, delegate: function (e, t, i, n) {
            return this.on(t, e, i, n)
        }, undelegate: function (e, t, i) {
            return 1 === arguments.length ? this.off(e, "**") : this.off(t, e || "**", i)
        }
    });
    var Pi, Mi, ki = ut.now(), Fi = /\?/, Di = /#.*$/, Ai = /([?&])_=[^&]*/, Ii = /^(.*?):[ \t]*([^\r\n]*)\r?$/gm, Ri = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/, zi = /^(?:GET|HEAD)$/, Bi = /^\/\//, Ui = /^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/, ji = ut.fn.load, Hi = {}, Gi = {}, $i = "*/".concat("*");
    try {
        Mi = Y.href
    } catch (Wi) {
        Mi = Z.createElement("a"), Mi.href = "", Mi = Mi.href
    }
    Pi = Ui.exec(Mi.toLowerCase()) || [], ut.fn.load = function (e, i, n) {
        if ("string" != typeof e && ji)return ji.apply(this, arguments);
        var s, r, a, o = this, l = e.indexOf(" ");
        return l >= 0 && (s = e.slice(l, e.length), e = e.slice(0, l)), ut.isFunction(i) ? (n = i, i = t) : i && "object" == typeof i && (a = "POST"), o.length > 0 && ut.ajax({
            url: e,
            type: a,
            dataType: "html",
            data: i
        }).done(function (e) {
            r = arguments, o.html(s ? ut("<div>").append(ut.parseHTML(e)).find(s) : e)
        }).complete(n && function (e, t) {
                o.each(n, r || [e.responseText, t, e])
            }), this
    }, ut.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function (e, t) {
        ut.fn[t] = function (e) {
            return this.on(t, e)
        }
    }), ut.extend({
        active: 0,
        lastModified: {},
        etag: {},
        ajaxSettings: {
            url: Mi,
            type: "GET",
            isLocal: Ri.test(Pi[1]),
            global: !0,
            processData: !0,
            async: !0,
            contentType: "application/x-www-form-urlencoded; charset=UTF-8",
            accepts: {
                "*": $i,
                text: "text/plain",
                html: "text/html",
                xml: "application/xml, text/xml",
                json: "application/json, text/javascript"
            },
            contents: {xml: /xml/, html: /html/, json: /json/},
            responseFields: {xml: "responseXML", text: "responseText", json: "responseJSON"},
            converters: {"* text": String, "text html": !0, "text json": ut.parseJSON, "text xml": ut.parseXML},
            flatOptions: {url: !0, context: !0}
        },
        ajaxSetup: function (e, t) {
            return t ? F(F(e, ut.ajaxSettings), t) : F(ut.ajaxSettings, e)
        },
        ajaxPrefilter: M(Hi),
        ajaxTransport: M(Gi),
        ajax: function (e, i) {
            function n(e, i, n, s) {
                var r, c, v, b, w, C = i;
                2 !== L && (L = 2, l && clearTimeout(l), u = t, o = s || "", O.readyState = e > 0 ? 4 : 0, r = e >= 200 && 300 > e || 304 === e, n && (b = D(p, O, n)), b = A(p, b, O, r), r ? (p.ifModified && (w = O.getResponseHeader("Last-Modified"), w && (ut.lastModified[a] = w), w = O.getResponseHeader("etag"), w && (ut.etag[a] = w)), 204 === e || "HEAD" === p.type ? C = "nocontent" : 304 === e ? C = "notmodified" : (C = b.state, c = b.data, v = b.error, r = !v)) : (v = C, (e || !C) && (C = "error", 0 > e && (e = 0))), O.status = e, O.statusText = (i || C) + "", r ? m.resolveWith(d, [c, C, O]) : m.rejectWith(d, [O, C, v]), O.statusCode(y), y = t, h && f.trigger(r ? "ajaxSuccess" : "ajaxError", [O, p, r ? c : v]), g.fireWith(d, [O, C]), h && (f.trigger("ajaxComplete", [O, p]), --ut.active || ut.event.trigger("ajaxStop")))
            }

            "object" == typeof e && (i = e, e = t), i = i || {};
            var s, r, a, o, l, h, u, c, p = ut.ajaxSetup({}, i), d = p.context || p, f = p.context && (d.nodeType || d.jquery) ? ut(d) : ut.event, m = ut.Deferred(), g = ut.Callbacks("once memory"), y = p.statusCode || {}, v = {}, b = {}, L = 0, w = "canceled", O = {
                readyState: 0,
                getResponseHeader: function (e) {
                    var t;
                    if (2 === L) {
                        if (!c)for (c = {}; t = Ii.exec(o);)c[t[1].toLowerCase()] = t[2];
                        t = c[e.toLowerCase()]
                    }
                    return null == t ? null : t
                },
                getAllResponseHeaders: function () {
                    return 2 === L ? o : null
                },
                setRequestHeader: function (e, t) {
                    var i = e.toLowerCase();
                    return L || (e = b[i] = b[i] || e, v[e] = t), this
                },
                overrideMimeType: function (e) {
                    return L || (p.mimeType = e), this
                },
                statusCode: function (e) {
                    var t;
                    if (e)if (2 > L)for (t in e)y[t] = [y[t], e[t]]; else O.always(e[O.status]);
                    return this
                },
                abort: function (e) {
                    var t = e || w;
                    return u && u.abort(t), n(0, t), this
                }
            };
            if (m.promise(O).complete = g.add, O.success = O.done, O.error = O.fail, p.url = ((e || p.url || Mi) + "").replace(Di, "").replace(Bi, Pi[1] + "//"), p.type = i.method || i.type || p.method || p.type, p.dataTypes = ut.trim(p.dataType || "*").toLowerCase().match(pt) || [""], null == p.crossDomain && (s = Ui.exec(p.url.toLowerCase()), p.crossDomain = !(!s || s[1] === Pi[1] && s[2] === Pi[2] && (s[3] || ("http:" === s[1] ? "80" : "443")) === (Pi[3] || ("http:" === Pi[1] ? "80" : "443")))), p.data && p.processData && "string" != typeof p.data && (p.data = ut.param(p.data, p.traditional)), k(Hi, p, i, O), 2 === L)return O;
            h = p.global, h && 0 === ut.active++ && ut.event.trigger("ajaxStart"), p.type = p.type.toUpperCase(), p.hasContent = !zi.test(p.type), a = p.url, p.hasContent || (p.data && (a = p.url += (Fi.test(a) ? "&" : "?") + p.data, delete p.data), p.cache === !1 && (p.url = Ai.test(a) ? a.replace(Ai, "$1_=" + ki++) : a + (Fi.test(a) ? "&" : "?") + "_=" + ki++)), p.ifModified && (ut.lastModified[a] && O.setRequestHeader("If-Modified-Since", ut.lastModified[a]), ut.etag[a] && O.setRequestHeader("If-None-Match", ut.etag[a])), (p.data && p.hasContent && p.contentType !== !1 || i.contentType) && O.setRequestHeader("Content-Type", p.contentType), O.setRequestHeader("Accept", p.dataTypes[0] && p.accepts[p.dataTypes[0]] ? p.accepts[p.dataTypes[0]] + ("*" !== p.dataTypes[0] ? ", " + $i + "; q=0.01" : "") : p.accepts["*"]);
            for (r in p.headers)O.setRequestHeader(r, p.headers[r]);
            if (p.beforeSend && (p.beforeSend.call(d, O, p) === !1 || 2 === L))return O.abort();
            w = "abort";
            for (r in{success: 1, error: 1, complete: 1})O[r](p[r]);
            if (u = k(Gi, p, i, O)) {
                O.readyState = 1, h && f.trigger("ajaxSend", [O, p]), p.async && p.timeout > 0 && (l = setTimeout(function () {
                    O.abort("timeout")
                }, p.timeout));
                try {
                    L = 1, u.send(v, n)
                } catch (C) {
                    if (!(2 > L))throw C;
                    n(-1, C)
                }
            } else n(-1, "No Transport");
            return O
        },
        getJSON: function (e, t, i) {
            return ut.get(e, t, i, "json")
        },
        getScript: function (e, i) {
            return ut.get(e, t, i, "script")
        }
    }), ut.each(["get", "post"], function (e, i) {
        ut[i] = function (e, n, s, r) {
            return ut.isFunction(n) && (r = r || s, s = n, n = t), ut.ajax({
                url: e,
                type: i,
                dataType: r,
                data: n,
                success: s
            })
        }
    }), ut.ajaxSetup({
        accepts: {script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
        contents: {script: /(?:java|ecma)script/},
        converters: {
            "text script": function (e) {
                return ut.globalEval(e), e
            }
        }
    }), ut.ajaxPrefilter("script", function (e) {
        e.cache === t && (e.cache = !1), e.crossDomain && (e.type = "GET", e.global = !1)
    }), ut.ajaxTransport("script", function (e) {
        if (e.crossDomain) {
            var i, n = Z.head || ut("head")[0] || Z.documentElement;
            return {
                send: function (t, s) {
                    i = Z.createElement("script"), i.async = !0, e.scriptCharset && (i.charset = e.scriptCharset), i.src = e.url, i.onload = i.onreadystatechange = function (e, t) {
                        (t || !i.readyState || /loaded|complete/.test(i.readyState)) && (i.onload = i.onreadystatechange = null, i.parentNode && i.parentNode.removeChild(i), i = null, t || s(200, "success"))
                    }, n.insertBefore(i, n.firstChild)
                }, abort: function () {
                    i && i.onload(t, !0)
                }
            }
        }
    });
    var Vi = [], qi = /(=)\?(?=&|$)|\?\?/;
    ut.ajaxSetup({
        jsonp: "callback", jsonpCallback: function () {
            var e = Vi.pop() || ut.expando + "_" + ki++;
            return this[e] = !0, e
        }
    }), ut.ajaxPrefilter("json jsonp", function (i, n, s) {
        var r, a, o, l = i.jsonp !== !1 && (qi.test(i.url) ? "url" : "string" == typeof i.data && !(i.contentType || "").indexOf("application/x-www-form-urlencoded") && qi.test(i.data) && "data");
        return l || "jsonp" === i.dataTypes[0] ? (r = i.jsonpCallback = ut.isFunction(i.jsonpCallback) ? i.jsonpCallback() : i.jsonpCallback, l ? i[l] = i[l].replace(qi, "$1" + r) : i.jsonp !== !1 && (i.url += (Fi.test(i.url) ? "&" : "?") + i.jsonp + "=" + r), i.converters["script json"] = function () {
            return o || ut.error(r + " was not called"), o[0]
        }, i.dataTypes[0] = "json", a = e[r], e[r] = function () {
            o = arguments
        }, s.always(function () {
            e[r] = a, i[r] && (i.jsonpCallback = n.jsonpCallback, Vi.push(r)), o && ut.isFunction(a) && a(o[0]), o = a = t
        }), "script") : void 0
    });
    var Xi, Yi, Zi = 0, Ki = e.ActiveXObject && function () {
            var e;
            for (e in Xi)Xi[e](t, !0)
        };
    ut.ajaxSettings.xhr = e.ActiveXObject ? function () {
        return !this.isLocal && I() || R()
    } : I, Yi = ut.ajaxSettings.xhr(), ut.support.cors = !!Yi && "withCredentials" in Yi, Yi = ut.support.ajax = !!Yi, Yi && ut.ajaxTransport(function (i) {
        if (!i.crossDomain || ut.support.cors) {
            var n;
            return {
                send: function (s, r) {
                    var a, o, l = i.xhr();
                    if (i.username ? l.open(i.type, i.url, i.async, i.username, i.password) : l.open(i.type, i.url, i.async), i.xhrFields)for (o in i.xhrFields)l[o] = i.xhrFields[o];
                    i.mimeType && l.overrideMimeType && l.overrideMimeType(i.mimeType), i.crossDomain || s["X-Requested-With"] || (s["X-Requested-With"] = "XMLHttpRequest");
                    try {
                        for (o in s)l.setRequestHeader(o, s[o])
                    } catch (h) {
                    }
                    l.send(i.hasContent && i.data || null), n = function (e, s) {
                        var o, h, u, c;
                        try {
                            if (n && (s || 4 === l.readyState))if (n = t, a && (l.onreadystatechange = ut.noop, Ki && delete Xi[a]), s) 4 !== l.readyState && l.abort(); else {
                                c = {}, o = l.status, h = l.getAllResponseHeaders(), "string" == typeof l.responseText && (c.text = l.responseText);
                                try {
                                    u = l.statusText
                                } catch (p) {
                                    u = ""
                                }
                                o || !i.isLocal || i.crossDomain ? 1223 === o && (o = 204) : o = c.text ? 200 : 404
                            }
                        } catch (d) {
                            s || r(-1, d)
                        }
                        c && r(o, u, c, h)
                    }, i.async ? 4 === l.readyState ? setTimeout(n) : (a = ++Zi, Ki && (Xi || (Xi = {}, ut(e).unload(Ki)), Xi[a] = n), l.onreadystatechange = n) : n()
                }, abort: function () {
                    n && n(t, !0)
                }
            }
        }
    });
    var Ji, Qi, en = /^(?:toggle|show|hide)$/, tn = new RegExp("^(?:([+-])=|)(" + ct + ")([a-z%]*)$", "i"), nn = /queueHooks$/, sn = [H], rn = {
        "*": [function (e, t) {
            var i = this.createTween(e, t), n = i.cur(), s = tn.exec(t), r = s && s[3] || (ut.cssNumber[e] ? "" : "px"), a = (ut.cssNumber[e] || "px" !== r && +n) && tn.exec(ut.css(i.elem, e)), o = 1, l = 20;
            if (a && a[3] !== r) {
                r = r || a[3], s = s || [], a = +n || 1;
                do o = o || ".5", a /= o, ut.style(i.elem, e, a + r); while (o !== (o = i.cur() / n) && 1 !== o && --l)
            }
            return s && (a = i.start = +a || +n || 0, i.unit = r, i.end = s[1] ? a + (s[1] + 1) * s[2] : +s[2]), i
        }]
    };
    ut.Animation = ut.extend(U, {
        tweener: function (e, t) {
            ut.isFunction(e) ? (t = e, e = ["*"]) : e = e.split(" ");
            for (var i, n = 0, s = e.length; s > n; n++)i = e[n], rn[i] = rn[i] || [], rn[i].unshift(t)
        }, prefilter: function (e, t) {
            t ? sn.unshift(e) : sn.push(e)
        }
    }), ut.Tween = G, G.prototype = {
        constructor: G, init: function (e, t, i, n, s, r) {
            this.elem = e, this.prop = i, this.easing = s || "swing", this.options = t, this.start = this.now = this.cur(), this.end = n, this.unit = r || (ut.cssNumber[i] ? "" : "px")
        }, cur: function () {
            var e = G.propHooks[this.prop];
            return e && e.get ? e.get(this) : G.propHooks._default.get(this)
        }, run: function (e) {
            var t, i = G.propHooks[this.prop];
            return this.pos = t = this.options.duration ? ut.easing[this.easing](e, this.options.duration * e, 0, 1, this.options.duration) : e, this.now = (this.end - this.start) * t + this.start, this.options.step && this.options.step.call(this.elem, this.now, this), i && i.set ? i.set(this) : G.propHooks._default.set(this), this
        }
    }, G.prototype.init.prototype = G.prototype, G.propHooks = {
        _default: {
            get: function (e) {
                var t;
                return null == e.elem[e.prop] || e.elem.style && null != e.elem.style[e.prop] ? (t = ut.css(e.elem, e.prop, ""), t && "auto" !== t ? t : 0) : e.elem[e.prop]
            }, set: function (e) {
                ut.fx.step[e.prop] ? ut.fx.step[e.prop](e) : e.elem.style && (null != e.elem.style[ut.cssProps[e.prop]] || ut.cssHooks[e.prop]) ? ut.style(e.elem, e.prop, e.now + e.unit) : e.elem[e.prop] = e.now
            }
        }
    }, G.propHooks.scrollTop = G.propHooks.scrollLeft = {
        set: function (e) {
            e.elem.nodeType && e.elem.parentNode && (e.elem[e.prop] = e.now)
        }
    }, ut.each(["toggle", "show", "hide"], function (e, t) {
        var i = ut.fn[t];
        ut.fn[t] = function (e, n, s) {
            return null == e || "boolean" == typeof e ? i.apply(this, arguments) : this.animate($(t, !0), e, n, s)
        }
    }), ut.fn.extend({
        fadeTo: function (e, t, i, n) {
            return this.filter(C).css("opacity", 0).show().end().animate({opacity: t}, e, i, n)
        }, animate: function (e, t, i, n) {
            var s = ut.isEmptyObject(e), r = ut.speed(t, i, n), a = function () {
                var t = U(this, ut.extend({}, e), r);
                (s || ut._data(this, "finish")) && t.stop(!0)
            };
            return a.finish = a, s || r.queue === !1 ? this.each(a) : this.queue(r.queue, a)
        }, stop: function (e, i, n) {
            var s = function (e) {
                var t = e.stop;
                delete e.stop, t(n)
            };
            return "string" != typeof e && (n = i, i = e, e = t), i && e !== !1 && this.queue(e || "fx", []), this.each(function () {
                var t = !0, i = null != e && e + "queueHooks", r = ut.timers, a = ut._data(this);
                if (i) a[i] && a[i].stop && s(a[i]); else for (i in a)a[i] && a[i].stop && nn.test(i) && s(a[i]);
                for (i = r.length; i--;)r[i].elem !== this || null != e && r[i].queue !== e || (r[i].anim.stop(n), t = !1, r.splice(i, 1));
                (t || !n) && ut.dequeue(this, e)
            })
        }, finish: function (e) {
            return e !== !1 && (e = e || "fx"), this.each(function () {
                var t, i = ut._data(this), n = i[e + "queue"], s = i[e + "queueHooks"], r = ut.timers, a = n ? n.length : 0;
                for (i.finish = !0, ut.queue(this, e, []), s && s.stop && s.stop.call(this, !0), t = r.length; t--;)r[t].elem === this && r[t].queue === e && (r[t].anim.stop(!0), r.splice(t, 1));
                for (t = 0; a > t; t++)n[t] && n[t].finish && n[t].finish.call(this);
                delete i.finish
            })
        }
    }), ut.each({
        slideDown: $("show"),
        slideUp: $("hide"),
        slideToggle: $("toggle"),
        fadeIn: {opacity: "show"},
        fadeOut: {opacity: "hide"},
        fadeToggle: {opacity: "toggle"}
    }, function (e, t) {
        ut.fn[e] = function (e, i, n) {
            return this.animate(t, e, i, n)
        }
    }), ut.speed = function (e, t, i) {
        var n = e && "object" == typeof e ? ut.extend({}, e) : {
            complete: i || !i && t || ut.isFunction(e) && e,
            duration: e,
            easing: i && t || t && !ut.isFunction(t) && t
        };
        return n.duration = ut.fx.off ? 0 : "number" == typeof n.duration ? n.duration : n.duration in ut.fx.speeds ? ut.fx.speeds[n.duration] : ut.fx.speeds._default, (null == n.queue || n.queue === !0) && (n.queue = "fx"), n.old = n.complete, n.complete = function () {
            ut.isFunction(n.old) && n.old.call(this), n.queue && ut.dequeue(this, n.queue)
        }, n
    }, ut.easing = {
        linear: function (e) {
            return e
        }, swing: function (e) {
            return .5 - Math.cos(e * Math.PI) / 2
        }
    }, ut.timers = [], ut.fx = G.prototype.init, ut.fx.tick = function () {
        var e, i = ut.timers, n = 0;
        for (Ji = ut.now(); n < i.length; n++)e = i[n], e() || i[n] !== e || i.splice(n--, 1);
        i.length || ut.fx.stop(), Ji = t
    }, ut.fx.timer = function (e) {
        e() && ut.timers.push(e) && ut.fx.start()
    }, ut.fx.interval = 13, ut.fx.start = function () {
        Qi || (Qi = setInterval(ut.fx.tick, ut.fx.interval))
    }, ut.fx.stop = function () {
        clearInterval(Qi), Qi = null
    }, ut.fx.speeds = {
        slow: 600,
        fast: 200,
        _default: 400
    }, ut.fx.step = {}, ut.expr && ut.expr.filters && (ut.expr.filters.animated = function (e) {
        return ut.grep(ut.timers, function (t) {
            return e === t.elem
        }).length
    }), ut.fn.offset = function (e) {
        if (arguments.length)return e === t ? this : this.each(function (t) {
            ut.offset.setOffset(this, e, t)
        });
        var i, n, s = {top: 0, left: 0}, r = this[0], a = r && r.ownerDocument;
        if (a)return i = a.documentElement, ut.contains(i, r) ? (typeof r.getBoundingClientRect !== X && (s = r.getBoundingClientRect()), n = W(a), {
            top: s.top + (n.pageYOffset || i.scrollTop) - (i.clientTop || 0),
            left: s.left + (n.pageXOffset || i.scrollLeft) - (i.clientLeft || 0)
        }) : s
    }, ut.offset = {
        setOffset: function (e, t, i) {
            var n = ut.css(e, "position");
            "static" === n && (e.style.position = "relative");
            var s, r, a = ut(e), o = a.offset(), l = ut.css(e, "top"), h = ut.css(e, "left"), u = ("absolute" === n || "fixed" === n) && ut.inArray("auto", [l, h]) > -1, c = {}, p = {};
            u ? (p = a.position(), s = p.top, r = p.left) : (s = parseFloat(l) || 0, r = parseFloat(h) || 0), ut.isFunction(t) && (t = t.call(e, i, o)), null != t.top && (c.top = t.top - o.top + s), null != t.left && (c.left = t.left - o.left + r), "using" in t ? t.using.call(e, c) : a.css(c)
        }
    }, ut.fn.extend({
        position: function () {
            if (this[0]) {
                var e, t, i = {top: 0, left: 0}, n = this[0];
                return "fixed" === ut.css(n, "position") ? t = n.getBoundingClientRect() : (e = this.offsetParent(), t = this.offset(), ut.nodeName(e[0], "html") || (i = e.offset()), i.top += ut.css(e[0], "borderTopWidth", !0), i.left += ut.css(e[0], "borderLeftWidth", !0)), {
                    top: t.top - i.top - ut.css(n, "marginTop", !0),
                    left: t.left - i.left - ut.css(n, "marginLeft", !0)
                }
            }
        }, offsetParent: function () {
            return this.map(function () {
                for (var e = this.offsetParent || K; e && !ut.nodeName(e, "html") && "static" === ut.css(e, "position");)e = e.offsetParent;
                return e || K
            })
        }
    }), ut.each({scrollLeft: "pageXOffset", scrollTop: "pageYOffset"}, function (e, i) {
        var n = /Y/.test(i);
        ut.fn[e] = function (s) {
            return ut.access(this, function (e, s, r) {
                var a = W(e);
                return r === t ? a ? i in a ? a[i] : a.document.documentElement[s] : e[s] : (a ? a.scrollTo(n ? ut(a).scrollLeft() : r, n ? r : ut(a).scrollTop()) : e[s] = r, void 0)
            }, e, s, arguments.length, null)
        }
    }), ut.each({Height: "height", Width: "width"}, function (e, i) {
        ut.each({padding: "inner" + e, content: i, "": "outer" + e}, function (n, s) {
            ut.fn[s] = function (s, r) {
                var a = arguments.length && (n || "boolean" != typeof s), o = n || (s === !0 || r === !0 ? "margin" : "border");
                return ut.access(this, function (i, n, s) {
                    var r;
                    return ut.isWindow(i) ? i.document.documentElement["client" + e] : 9 === i.nodeType ? (r = i.documentElement, Math.max(i.body["scroll" + e], r["scroll" + e], i.body["offset" + e], r["offset" + e], r["client" + e])) : s === t ? ut.css(i, n, o) : ut.style(i, n, s, o)
                }, i, a ? s : t, a, null)
            }
        })
    }), ut.fn.size = function () {
        return this.length
    }, ut.fn.andSelf = ut.fn.addBack, "object" == typeof module && module && "object" == typeof module.exports ? module.exports = ut : (e.jQuery = e.$ = ut, "function" == typeof define && define.amd && define("jquery", [], function () {
        return ut
    }))
}(window), /* ========================================================================
 * Bootstrap: affix.js v3.3.5
 * http://getbootstrap.com/javascript/#affix
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
    +function (e) {
        "use strict";
        function t(t) {
            return this.each(function () {
                var n = e(this), s = n.data("bs.affix"), r = "object" == typeof t && t;
                s || n.data("bs.affix", s = new i(this, r)), "string" == typeof t && s[t]()
            })
        }

        var i = function (t, n) {
            this.options = e.extend({}, i.DEFAULTS, n), this.$target = e(this.options.target).on("scroll.bs.affix.data-api", e.proxy(this.checkPosition, this)).on("click.bs.affix.data-api", e.proxy(this.checkPositionWithEventLoop, this)), this.$element = e(t), this.affixed = null, this.unpin = null, this.pinnedOffset = null, this.checkPosition()
        };
        i.VERSION = "3.3.5", i.RESET = "affix affix-top affix-bottom", i.DEFAULTS = {
            offset: 0,
            target: window
        }, i.prototype.getState = function (e, t, i, n) {
            var s = this.$target.scrollTop(), r = this.$element.offset(), a = this.$target.height();
            if (null != i && "top" == this.affixed)return i > s ? "top" : !1;
            if ("bottom" == this.affixed)return null != i ? s + this.unpin <= r.top ? !1 : "bottom" : e - n >= s + a ? !1 : "bottom";
            var o = null == this.affixed, l = o ? s : r.top, h = o ? a : t;
            return null != i && i >= s ? "top" : null != n && l + h >= e - n ? "bottom" : !1
        }, i.prototype.getPinnedOffset = function () {
            if (this.pinnedOffset)return this.pinnedOffset;
            this.$element.removeClass(i.RESET).addClass("affix");
            var e = this.$target.scrollTop(), t = this.$element.offset();
            return this.pinnedOffset = t.top - e
        }, i.prototype.checkPositionWithEventLoop = function () {
            setTimeout(e.proxy(this.checkPosition, this), 1)
        }, i.prototype.checkPosition = function () {
            if (this.$element.is(":visible")) {
                var t = this.$element.height(), n = this.options.offset, s = n.top, r = n.bottom, a = Math.max(e(document).height(), e(document.body).height());
                "object" != typeof n && (r = s = n), "function" == typeof s && (s = n.top(this.$element)), "function" == typeof r && (r = n.bottom(this.$element));
                var o = this.getState(a, t, s, r);
                if (this.affixed != o) {
                    null != this.unpin && this.$element.css("top", "");
                    var l = "affix" + (o ? "-" + o : ""), h = e.Event(l + ".bs.affix");
                    if (this.$element.trigger(h), h.isDefaultPrevented())return;
                    this.affixed = o, this.unpin = "bottom" == o ? this.getPinnedOffset() : null, this.$element.removeClass(i.RESET).addClass(l).trigger(l.replace("affix", "affixed") + ".bs.affix")
                }
                "bottom" == o && this.$element.offset({top: a - t - r})
            }
        };
        var n = e.fn.affix;
        e.fn.affix = t, e.fn.affix.Constructor = i, e.fn.affix.noConflict = function () {
            return e.fn.affix = n, this
        }, e(window).on("load", function () {
            e('[data-spy="affix"]').each(function () {
                var i = e(this), n = i.data();
                n.offset = n.offset || {}, null != n.offsetBottom && (n.offset.bottom = n.offsetBottom), null != n.offsetTop && (n.offset.top = n.offsetTop), t.call(i, n)
            })
        })
    }(jQuery), /* ========================================================================
 * Bootstrap: alert.js v3.3.5
 * http://getbootstrap.com/javascript/#alerts
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
    +function (e) {
        "use strict";
        function t(t) {
            return this.each(function () {
                var i = e(this), s = i.data("bs.alert");
                s || i.data("bs.alert", s = new n(this)), "string" == typeof t && s[t].call(i)
            })
        }

        var i = '[data-dismiss="alert"]', n = function (t) {
            e(t).on("click", i, this.close)
        };
        n.VERSION = "3.3.5", n.TRANSITION_DURATION = 150, n.prototype.close = function (t) {
            function i() {
                a.detach().trigger("closed.bs.alert").remove()
            }

            var s = e(this), r = s.attr("data-target");
            r || (r = s.attr("href"), r = r && r.replace(/.*(?=#[^\s]*$)/, ""));
            var a = e(r);
            t && t.preventDefault(), a.length || (a = s.closest(".alert")), a.trigger(t = e.Event("close.bs.alert")), t.isDefaultPrevented() || (a.removeClass("in"), e.support.transition && a.hasClass("fade") ? a.one("bsTransitionEnd", i).emulateTransitionEnd(n.TRANSITION_DURATION) : i())
        };
        var s = e.fn.alert;
        e.fn.alert = t, e.fn.alert.Constructor = n, e.fn.alert.noConflict = function () {
            return e.fn.alert = s, this
        }, e(document).on("click.bs.alert.data-api", i, n.prototype.close)
    }(jQuery), /* ========================================================================
 * Bootstrap: button.js v3.3.5
 * http://getbootstrap.com/javascript/#buttons
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
    +function (e) {
        "use strict";
        function t(t) {
            return this.each(function () {
                var n = e(this), s = n.data("bs.button"), r = "object" == typeof t && t;
                s || n.data("bs.button", s = new i(this, r)), "toggle" == t ? s.toggle() : t && s.setState(t)
            })
        }

        var i = function (t, n) {
            this.$element = e(t), this.options = e.extend({}, i.DEFAULTS, n), this.isLoading = !1
        };
        i.VERSION = "3.3.5", i.DEFAULTS = {loadingText: "loading..."}, i.prototype.setState = function (t) {
            var i = "disabled", n = this.$element, s = n.is("input") ? "val" : "html", r = n.data();
            t += "Text", null == r.resetText && n.data("resetText", n[s]()), setTimeout(e.proxy(function () {
                n[s](null == r[t] ? this.options[t] : r[t]), "loadingText" == t ? (this.isLoading = !0, n.addClass(i).attr(i, i)) : this.isLoading && (this.isLoading = !1, n.removeClass(i).removeAttr(i))
            }, this), 0)
        }, i.prototype.toggle = function () {
            var e = !0, t = this.$element.closest('[data-toggle="buttons"]');
            if (t.length) {
                var i = this.$element.find("input");
                "radio" == i.prop("type") ? (i.prop("checked") && (e = !1), t.find(".active").removeClass("active"), this.$element.addClass("active")) : "checkbox" == i.prop("type") && (i.prop("checked") !== this.$element.hasClass("active") && (e = !1), this.$element.toggleClass("active")), i.prop("checked", this.$element.hasClass("active")), e && i.trigger("change")
            } else this.$element.attr("aria-pressed", !this.$element.hasClass("active")), this.$element.toggleClass("active")
        };
        var n = e.fn.button;
        e.fn.button = t, e.fn.button.Constructor = i, e.fn.button.noConflict = function () {
            return e.fn.button = n, this
        }, e(document).on("click.bs.button.data-api", '[data-toggle^="button"]', function (i) {
            var n = e(i.target);
            n.hasClass("btn") || (n = n.closest(".btn")), t.call(n, "toggle"), e(i.target).is('input[type="radio"]') || e(i.target).is('input[type="checkbox"]') || i.preventDefault()
        }).on("focus.bs.button.data-api blur.bs.button.data-api", '[data-toggle^="button"]', function (t) {
            e(t.target).closest(".btn").toggleClass("focus", /^focus(in)?$/.test(t.type))
        })
    }(jQuery), /* ========================================================================
 * Bootstrap: carousel.js v3.3.5
 * http://getbootstrap.com/javascript/#carousel
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
    +function (e) {
        "use strict";
        function t(t) {
            return this.each(function () {
                var n = e(this), s = n.data("bs.carousel"), r = e.extend({}, i.DEFAULTS, n.data(), "object" == typeof t && t), a = "string" == typeof t ? t : r.slide;
                s || n.data("bs.carousel", s = new i(this, r)), "number" == typeof t ? s.to(t) : a ? s[a]() : r.interval && s.pause().cycle()
            })
        }

        var i = function (t, i) {
            this.$element = e(t), this.$indicators = this.$element.find(".carousel-indicators"), this.options = i, this.paused = null, this.sliding = null, this.interval = null, this.$active = null, this.$items = null, this.options.keyboard && this.$element.on("keydown.bs.carousel", e.proxy(this.keydown, this)), "hover" == this.options.pause && !("ontouchstart" in document.documentElement) && this.$element.on("mouseenter.bs.carousel", e.proxy(this.pause, this)).on("mouseleave.bs.carousel", e.proxy(this.cycle, this))
        };
        i.VERSION = "3.3.5", i.TRANSITION_DURATION = 600, i.DEFAULTS = {
            interval: 5e3,
            pause: "hover",
            wrap: !0,
            keyboard: !0
        }, i.prototype.keydown = function (e) {
            if (!/input|textarea/i.test(e.target.tagName)) {
                switch (e.which) {
                    case 37:
                        this.prev();
                        break;
                    case 39:
                        this.next();
                        break;
                    default:
                        return
                }
                e.preventDefault()
            }
        }, i.prototype.cycle = function (t) {
            return t || (this.paused = !1), this.interval && clearInterval(this.interval), this.options.interval && !this.paused && (this.interval = setInterval(e.proxy(this.next, this), this.options.interval)), this
        }, i.prototype.getItemIndex = function (e) {
            return this.$items = e.parent().children(".item"), this.$items.index(e || this.$active)
        }, i.prototype.getItemForDirection = function (e, t) {
            var i = this.getItemIndex(t), n = "prev" == e && 0 === i || "next" == e && i == this.$items.length - 1;
            if (n && !this.options.wrap)return t;
            var s = "prev" == e ? -1 : 1, r = (i + s) % this.$items.length;
            return this.$items.eq(r)
        }, i.prototype.to = function (e) {
            var t = this, i = this.getItemIndex(this.$active = this.$element.find(".item.active"));
            return e > this.$items.length - 1 || 0 > e ? void 0 : this.sliding ? this.$element.one("slid.bs.carousel", function () {
                t.to(e)
            }) : i == e ? this.pause().cycle() : this.slide(e > i ? "next" : "prev", this.$items.eq(e))
        }, i.prototype.pause = function (t) {
            return t || (this.paused = !0), this.$element.find(".next, .prev").length && e.support.transition && (this.$element.trigger(e.support.transition.end), this.cycle(!0)), this.interval = clearInterval(this.interval), this
        }, i.prototype.next = function () {
            return this.sliding ? void 0 : this.slide("next")
        }, i.prototype.prev = function () {
            return this.sliding ? void 0 : this.slide("prev")
        }, i.prototype.slide = function (t, n) {
            var s = this.$element.find(".item.active"), r = n || this.getItemForDirection(t, s), a = this.interval, o = "next" == t ? "left" : "right", l = this;
            if (r.hasClass("active"))return this.sliding = !1;
            var h = r[0], u = e.Event("slide.bs.carousel", {relatedTarget: h, direction: o});
            if (this.$element.trigger(u), !u.isDefaultPrevented()) {
                if (this.sliding = !0, a && this.pause(), this.$indicators.length) {
                    this.$indicators.find(".active").removeClass("active");
                    var c = e(this.$indicators.children()[this.getItemIndex(r)]);
                    c && c.addClass("active")
                }
                var p = e.Event("slid.bs.carousel", {relatedTarget: h, direction: o});
                return e.support.transition && this.$element.hasClass("slide") ? (r.addClass(t), r[0].offsetWidth, s.addClass(o), r.addClass(o), s.one("bsTransitionEnd", function () {
                    r.removeClass([t, o].join(" ")).addClass("active"), s.removeClass(["active", o].join(" ")), l.sliding = !1, setTimeout(function () {
                        l.$element.trigger(p)
                    }, 0)
                }).emulateTransitionEnd(i.TRANSITION_DURATION)) : (s.removeClass("active"), r.addClass("active"), this.sliding = !1, this.$element.trigger(p)), a && this.cycle(), this
            }
        };
        var n = e.fn.carousel;
        e.fn.carousel = t, e.fn.carousel.Constructor = i, e.fn.carousel.noConflict = function () {
            return e.fn.carousel = n, this
        };
        var s = function (i) {
            var n, s = e(this), r = e(s.attr("data-target") || (n = s.attr("href")) && n.replace(/.*(?=#[^\s]+$)/, ""));
            if (r.hasClass("carousel")) {
                var a = e.extend({}, r.data(), s.data()), o = s.attr("data-slide-to");
                o && (a.interval = !1), t.call(r, a), o && r.data("bs.carousel").to(o), i.preventDefault()
            }
        };
        e(document).on("click.bs.carousel.data-api", "[data-slide]", s).on("click.bs.carousel.data-api", "[data-slide-to]", s), e(window).on("load", function () {
            e('[data-ride="carousel"]').each(function () {
                var i = e(this);
                t.call(i, i.data())
            })
        })
    }(jQuery), /* ========================================================================
 * Bootstrap: collapse.js v3.3.5
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
    +function (e) {
        "use strict";
        function t(t) {
            var i, n = t.attr("data-target") || (i = t.attr("href")) && i.replace(/.*(?=#[^\s]+$)/, "");
            return e(n)
        }

        function i(t) {
            return this.each(function () {
                var i = e(this), s = i.data("bs.collapse"), r = e.extend({}, n.DEFAULTS, i.data(), "object" == typeof t && t);
                !s && r.toggle && /show|hide/.test(t) && (r.toggle = !1), s || i.data("bs.collapse", s = new n(this, r)), "string" == typeof t && s[t]()
            })
        }

        var n = function (t, i) {
            this.$element = e(t), this.options = e.extend({}, n.DEFAULTS, i), this.$trigger = e('[data-toggle="collapse"][href="#' + t.id + '"],' + '[data-toggle="collapse"][data-target="#' + t.id + '"]'), this.transitioning = null, this.options.parent ? this.$parent = this.getParent() : this.addAriaAndCollapsedClass(this.$element, this.$trigger), this.options.toggle && this.toggle()
        };
        n.VERSION = "3.3.5", n.TRANSITION_DURATION = 350, n.DEFAULTS = {toggle: !0}, n.prototype.dimension = function () {
            var e = this.$element.hasClass("width");
            return e ? "width" : "height"
        }, n.prototype.show = function () {
            if (!this.transitioning && !this.$element.hasClass("in")) {
                var t, s = this.$parent && this.$parent.children(".panel").children(".in, .collapsing");
                if (!(s && s.length && (t = s.data("bs.collapse"), t && t.transitioning))) {
                    var r = e.Event("show.bs.collapse");
                    if (this.$element.trigger(r), !r.isDefaultPrevented()) {
                        s && s.length && (i.call(s, "hide"), t || s.data("bs.collapse", null));
                        var a = this.dimension();
                        this.$element.removeClass("collapse").addClass("collapsing")[a](0).attr("aria-expanded", !0), this.$trigger.removeClass("collapsed").attr("aria-expanded", !0), this.transitioning = 1;
                        var o = function () {
                            this.$element.removeClass("collapsing").addClass("collapse in")[a](""), this.transitioning = 0, this.$element.trigger("shown.bs.collapse")
                        };
                        if (!e.support.transition)return o.call(this);
                        var l = e.camelCase(["scroll", a].join("-"));
                        this.$element.one("bsTransitionEnd", e.proxy(o, this)).emulateTransitionEnd(n.TRANSITION_DURATION)[a](this.$element[0][l])
                    }
                }
            }
        }, n.prototype.hide = function () {
            if (!this.transitioning && this.$element.hasClass("in")) {
                var t = e.Event("hide.bs.collapse");
                if (this.$element.trigger(t), !t.isDefaultPrevented()) {
                    var i = this.dimension();
                    this.$element[i](this.$element[i]())[0].offsetHeight, this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded", !1), this.$trigger.addClass("collapsed").attr("aria-expanded", !1), this.transitioning = 1;
                    var s = function () {
                        this.transitioning = 0, this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")
                    };
                    return e.support.transition ? (this.$element[i](0).one("bsTransitionEnd", e.proxy(s, this)).emulateTransitionEnd(n.TRANSITION_DURATION), void 0) : s.call(this)
                }
            }
        }, n.prototype.toggle = function () {
            this[this.$element.hasClass("in") ? "hide" : "show"]()
        }, n.prototype.getParent = function () {
            return e(this.options.parent).find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]').each(e.proxy(function (i, n) {
                var s = e(n);
                this.addAriaAndCollapsedClass(t(s), s)
            }, this)).end()
        }, n.prototype.addAriaAndCollapsedClass = function (e, t) {
            var i = e.hasClass("in");
            e.attr("aria-expanded", i), t.toggleClass("collapsed", !i).attr("aria-expanded", i)
        };
        var s = e.fn.collapse;
        e.fn.collapse = i, e.fn.collapse.Constructor = n, e.fn.collapse.noConflict = function () {
            return e.fn.collapse = s, this
        }, e(document).on("click.bs.collapse.data-api", '[data-toggle="collapse"]', function (n) {
            var s = e(this);
            s.attr("data-target") || n.preventDefault();
            var r = t(s), a = r.data("bs.collapse"), o = a ? "toggle" : s.data();
            i.call(r, o)
        })
    }(jQuery), /* ========================================================================
 * Bootstrap: dropdown.js v3.3.5
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
    +function (e) {
        "use strict";
        function t(t) {
            var i = t.attr("data-target");
            i || (i = t.attr("href"), i = i && /#[A-Za-z]/.test(i) && i.replace(/.*(?=#[^\s]*$)/, ""));
            var n = i && e(i);
            return n && n.length ? n : t.parent()
        }

        function i(i) {
            i && 3 === i.which || (e(s).remove(), e(r).each(function () {
                var n = e(this), s = t(n), r = {relatedTarget: this};
                s.hasClass("open") && (i && "click" == i.type && /input|textarea/i.test(i.target.tagName) && e.contains(s[0], i.target) || (s.trigger(i = e.Event("hide.bs.dropdown", r)), i.isDefaultPrevented() || (n.attr("aria-expanded", "false"), s.removeClass("open").trigger("hidden.bs.dropdown", r))))
            }))
        }

        function n(t) {
            return this.each(function () {
                var i = e(this), n = i.data("bs.dropdown");
                n || i.data("bs.dropdown", n = new a(this)), "string" == typeof t && n[t].call(i)
            })
        }

        var s = ".dropdown-backdrop", r = '[data-toggle="dropdown"]', a = function (t) {
            e(t).on("click.bs.dropdown", this.toggle)
        };
        a.VERSION = "3.3.5", a.prototype.toggle = function (n) {
            var s = e(this);
            if (!s.is(".disabled, :disabled")) {
                var r = t(s), a = r.hasClass("open");
                if (i(), !a) {
                    "ontouchstart" in document.documentElement && !r.closest(".navbar-nav").length && e(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(e(this)).on("click", i);
                    var o = {relatedTarget: this};
                    if (r.trigger(n = e.Event("show.bs.dropdown", o)), n.isDefaultPrevented())return;
                    s.trigger("focus").attr("aria-expanded", "true"), r.toggleClass("open").trigger("shown.bs.dropdown", o)
                }
                return !1
            }
        }, a.prototype.keydown = function (i) {
            if (/(38|40|27|32)/.test(i.which) && !/input|textarea/i.test(i.target.tagName)) {
                var n = e(this);
                if (i.preventDefault(), i.stopPropagation(), !n.is(".disabled, :disabled")) {
                    var s = t(n), a = s.hasClass("open");
                    if (!a && 27 != i.which || a && 27 == i.which)return 27 == i.which && s.find(r).trigger("focus"), n.trigger("click");
                    var o = " li:not(.disabled):visible a", l = s.find(".dropdown-menu" + o);
                    if (l.length) {
                        var h = l.index(i.target);
                        38 == i.which && h > 0 && h--, 40 == i.which && h < l.length - 1 && h++, ~h || (h = 0), l.eq(h).trigger("focus")
                    }
                }
            }
        };
        var o = e.fn.dropdown;
        e.fn.dropdown = n, e.fn.dropdown.Constructor = a, e.fn.dropdown.noConflict = function () {
            return e.fn.dropdown = o, this
        }, e(document).on("click.bs.dropdown.data-api", i).on("click.bs.dropdown.data-api", ".dropdown form", function (e) {
            e.stopPropagation()
        }).on("click.bs.dropdown.data-api", r, a.prototype.toggle).on("keydown.bs.dropdown.data-api", r, a.prototype.keydown).on("keydown.bs.dropdown.data-api", ".dropdown-menu", a.prototype.keydown)
    }(jQuery), /* ========================================================================
 * Bootstrap: tab.js v3.3.5
 * http://getbootstrap.com/javascript/#tabs
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
    +function (e) {
        "use strict";
        function t(t) {
            return this.each(function () {
                var n = e(this), s = n.data("bs.tab");
                s || n.data("bs.tab", s = new i(this)), "string" == typeof t && s[t]()
            })
        }

        var i = function (t) {
            this.element = e(t)
        };
        i.VERSION = "3.3.5", i.TRANSITION_DURATION = 150, i.prototype.show = function () {
            var t = this.element, i = t.closest("ul:not(.dropdown-menu)"), n = t.data("target");
            if (n || (n = t.attr("href"), n = n && n.replace(/.*(?=#[^\s]*$)/, "")), !t.parent("li").hasClass("active")) {
                var s = i.find(".active:last a"), r = e.Event("hide.bs.tab", {relatedTarget: t[0]}), a = e.Event("show.bs.tab", {relatedTarget: s[0]});
                if (s.trigger(r), t.trigger(a), !a.isDefaultPrevented() && !r.isDefaultPrevented()) {
                    var o = e(n);
                    this.activate(t.closest("li"), i), this.activate(o, o.parent(), function () {
                        s.trigger({type: "hidden.bs.tab", relatedTarget: t[0]}), t.trigger({
                            type: "shown.bs.tab",
                            relatedTarget: s[0]
                        })
                    })
                }
            }
        }, i.prototype.activate = function (t, n, s) {
            function r() {
                a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded", !1), t.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded", !0), o ? (t[0].offsetWidth, t.addClass("in")) : t.removeClass("fade"), t.parent(".dropdown-menu").length && t.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded", !0), s && s()
            }

            var a = n.find("> .active"), o = s && e.support.transition && (a.length && a.hasClass("fade") || !!n.find("> .fade").length);
            a.length && o ? a.one("bsTransitionEnd", r).emulateTransitionEnd(i.TRANSITION_DURATION) : r(), a.removeClass("in")
        };
        var n = e.fn.tab;
        e.fn.tab = t, e.fn.tab.Constructor = i, e.fn.tab.noConflict = function () {
            return e.fn.tab = n, this
        };
        var s = function (i) {
            i.preventDefault(), t.call(e(this), "show")
        };
        e(document).on("click.bs.tab.data-api", '[data-toggle="tab"]', s).on("click.bs.tab.data-api", '[data-toggle="pill"]', s)
    }(jQuery), /* ========================================================================
 * Bootstrap: transition.js v3.3.5
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
    +function (e) {
        "use strict";
        function t() {
            var e = document.createElement("bootstrap"), t = {
                WebkitTransition: "webkitTransitionEnd",
                MozTransition: "transitionend",
                OTransition: "oTransitionEnd otransitionend",
                transition: "transitionend"
            };
            for (var i in t)if (void 0 !== e.style[i])return {end: t[i]};
            return !1
        }

        e.fn.emulateTransitionEnd = function (t) {
            var i = !1, n = this;
            e(this).one("bsTransitionEnd", function () {
                i = !0
            });
            var s = function () {
                i || e(n).trigger(e.support.transition.end)
            };
            return setTimeout(s, t), this
        }, e(function () {
            e.support.transition = t(), e.support.transition && (e.event.special.bsTransitionEnd = {
                bindType: e.support.transition.end,
                delegateType: e.support.transition.end,
                handle: function (t) {
                    return e(t.target).is(this) ? t.handleObj.handler.apply(this, arguments) : void 0
                }
            })
        })
    }(jQuery), /* ========================================================================
 * Bootstrap: scrollspy.js v3.3.5
 * http://getbootstrap.com/javascript/#scrollspy
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
    +function (e) {
        "use strict";
        function t(i, n) {
            this.$body = e(document.body), this.$scrollElement = e(i).is(document.body) ? e(window) : e(i), this.options = e.extend({}, t.DEFAULTS, n), this.selector = (this.options.target || "") + " .nav li > a", this.offsets = [], this.targets = [], this.activeTarget = null, this.scrollHeight = 0, this.$scrollElement.on("scroll.bs.scrollspy", e.proxy(this.process, this)), this.refresh(), this.process()
        }

        function i(i) {
            return this.each(function () {
                var n = e(this), s = n.data("bs.scrollspy"), r = "object" == typeof i && i;
                s || n.data("bs.scrollspy", s = new t(this, r)), "string" == typeof i && s[i]()
            })
        }

        t.VERSION = "3.3.5", t.DEFAULTS = {offset: 10}, t.prototype.getScrollHeight = function () {
            return this.$scrollElement[0].scrollHeight || Math.max(this.$body[0].scrollHeight, document.documentElement.scrollHeight)
        }, t.prototype.refresh = function () {
            var t = this, i = "offset", n = 0;
            this.offsets = [], this.targets = [], this.scrollHeight = this.getScrollHeight(), e.isWindow(this.$scrollElement[0]) || (i = "position", n = this.$scrollElement.scrollTop()), this.$body.find(this.selector).map(function () {
                var t = e(this), s = t.data("target") || t.attr("href"), r = /^#./.test(s) && e(s);
                return r && r.length && r.is(":visible") && [[r[i]().top + n, s]] || null
            }).sort(function (e, t) {
                return e[0] - t[0]
            }).each(function () {
                t.offsets.push(this[0]), t.targets.push(this[1])
            })
        }, t.prototype.process = function () {
            var e, t = this.$scrollElement.scrollTop() + this.options.offset, i = this.getScrollHeight(), n = this.options.offset + i - this.$scrollElement.height(), s = this.offsets, r = this.targets, a = this.activeTarget;
            if (this.scrollHeight != i && this.refresh(), t >= n)return a != (e = r[r.length - 1]) && this.activate(e);
            if (a && t < s[0])return this.activeTarget = null, this.clear();
            for (e = s.length; e--;)a != r[e] && t >= s[e] && (void 0 === s[e + 1] || t < s[e + 1]) && this.activate(r[e])
        }, t.prototype.activate = function (t) {
            this.activeTarget = t, this.clear();
            var i = this.selector + '[data-target="' + t + '"],' + this.selector + '[href="' + t + '"]', n = e(i).parents("li").addClass("active");
            n.parent(".dropdown-menu").length && (n = n.closest("li.dropdown").addClass("active")), n.trigger("activate.bs.scrollspy")
        }, t.prototype.clear = function () {
            e(this.selector).parentsUntil(this.options.target, ".active").removeClass("active")
        };
        var n = e.fn.scrollspy;
        e.fn.scrollspy = i, e.fn.scrollspy.Constructor = t, e.fn.scrollspy.noConflict = function () {
            return e.fn.scrollspy = n, this
        }, e(window).on("load.bs.scrollspy.data-api", function () {
            e('[data-spy="scroll"]').each(function () {
                var t = e(this);
                i.call(t, t.data())
            })
        })
    }(jQuery), /* ========================================================================
 * Bootstrap: modal.js v3.3.5
 * http://getbootstrap.com/javascript/#modals
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
    +function (e) {
        "use strict";
        function t(t, n) {
            return this.each(function () {
                var s = e(this), r = s.data("bs.modal"), a = e.extend({}, i.DEFAULTS, s.data(), "object" == typeof t && t);
                r || s.data("bs.modal", r = new i(this, a)), "string" == typeof t ? r[t](n) : a.show && r.show(n)
            })
        }

        var i = function (t, i) {
            this.options = i, this.$body = e(document.body), this.$element = e(t), this.$dialog = this.$element.find(".modal-dialog"), this.$backdrop = null, this.isShown = null, this.originalBodyPad = null, this.scrollbarWidth = 0, this.ignoreBackdropClick = !1, this.options.remote && this.$element.find(".modal-content").load(this.options.remote, e.proxy(function () {
                this.$element.trigger("loaded.bs.modal")
            }, this))
        };
        i.VERSION = "3.3.5", i.TRANSITION_DURATION = 300, i.BACKDROP_TRANSITION_DURATION = 150, i.DEFAULTS = {
            backdrop: !0,
            keyboard: !0,
            show: !0
        }, i.prototype.toggle = function (e) {
            return this.isShown ? this.hide() : this.show(e)
        }, i.prototype.show = function (t) {
            var n = this, s = e.Event("show.bs.modal", {relatedTarget: t});
            this.$element.trigger(s), this.isShown || s.isDefaultPrevented() || (this.isShown = !0, this.checkScrollbar(), this.setScrollbar(), this.$body.addClass("modal-open"), this.escape(), this.resize(), this.$element.on("click.dismiss.bs.modal", '[data-dismiss="modal"]', e.proxy(this.hide, this)), this.$dialog.on("mousedown.dismiss.bs.modal", function () {
                n.$element.one("mouseup.dismiss.bs.modal", function (t) {
                    e(t.target).is(n.$element) && (n.ignoreBackdropClick = !0)
                })
            }), this.backdrop(function () {
                var s = e.support.transition && n.$element.hasClass("fade");
                n.$element.parent().length || n.$element.appendTo(n.$body), n.$element.show().scrollTop(0), n.adjustDialog(), s && n.$element[0].offsetWidth, n.$element.addClass("in"), n.enforceFocus();
                var r = e.Event("shown.bs.modal", {relatedTarget: t});
                s ? n.$dialog.one("bsTransitionEnd", function () {
                    n.$element.trigger("focus").trigger(r)
                }).emulateTransitionEnd(i.TRANSITION_DURATION) : n.$element.trigger("focus").trigger(r)
            }))
        }, i.prototype.hide = function (t) {
            t && t.preventDefault(), t = e.Event("hide.bs.modal"), this.$element.trigger(t), this.isShown && !t.isDefaultPrevented() && (this.isShown = !1, this.escape(), this.resize(), e(document).off("focusin.bs.modal"), this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"), this.$dialog.off("mousedown.dismiss.bs.modal"), e.support.transition && this.$element.hasClass("fade") ? this.$element.one("bsTransitionEnd", e.proxy(this.hideModal, this)).emulateTransitionEnd(i.TRANSITION_DURATION) : this.hideModal())
        }, i.prototype.enforceFocus = function () {
            e(document).off("focusin.bs.modal").on("focusin.bs.modal", e.proxy(function (e) {
                this.$element[0] === e.target || this.$element.has(e.target).length || this.$element.trigger("focus")
            }, this))
        }, i.prototype.escape = function () {
            this.isShown && this.options.keyboard ? this.$element.on("keydown.dismiss.bs.modal", e.proxy(function (e) {
                27 == e.which && this.hide()
            }, this)) : this.isShown || this.$element.off("keydown.dismiss.bs.modal")
        }, i.prototype.resize = function () {
            this.isShown ? e(window).on("resize.bs.modal", e.proxy(this.handleUpdate, this)) : e(window).off("resize.bs.modal")
        }, i.prototype.hideModal = function () {
            var e = this;
            this.$element.hide(), this.backdrop(function () {
                e.$body.removeClass("modal-open"), e.resetAdjustments(), e.resetScrollbar(), e.$element.trigger("hidden.bs.modal")
            })
        }, i.prototype.removeBackdrop = function () {
            this.$backdrop && this.$backdrop.remove(), this.$backdrop = null
        }, i.prototype.backdrop = function (t) {
            var n = this, s = this.$element.hasClass("fade") ? "fade" : "";
            if (this.isShown && this.options.backdrop) {
                var r = e.support.transition && s;
                if (this.$backdrop = e(document.createElement("div")).addClass("modal-backdrop " + s).appendTo(this.$body), this.$element.on("click.dismiss.bs.modal", e.proxy(function (e) {
                        return this.ignoreBackdropClick ? (this.ignoreBackdropClick = !1, void 0) : (e.target === e.currentTarget && ("static" == this.options.backdrop ? this.$element[0].focus() : this.hide()), void 0)
                    }, this)), r && this.$backdrop[0].offsetWidth, this.$backdrop.addClass("in"), !t)return;
                r ? this.$backdrop.one("bsTransitionEnd", t).emulateTransitionEnd(i.BACKDROP_TRANSITION_DURATION) : t()
            } else if (!this.isShown && this.$backdrop) {
                this.$backdrop.removeClass("in");
                var a = function () {
                    n.removeBackdrop(), t && t()
                };
                e.support.transition && this.$element.hasClass("fade") ? this.$backdrop.one("bsTransitionEnd", a).emulateTransitionEnd(i.BACKDROP_TRANSITION_DURATION) : a()
            } else t && t()
        }, i.prototype.handleUpdate = function () {
            this.adjustDialog()
        }, i.prototype.adjustDialog = function () {
            var e = this.$element[0].scrollHeight > document.documentElement.clientHeight;
            this.$element.css({
                paddingLeft: !this.bodyIsOverflowing && e ? this.scrollbarWidth : "",
                paddingRight: this.bodyIsOverflowing && !e ? this.scrollbarWidth : ""
            })
        }, i.prototype.resetAdjustments = function () {
            this.$element.css({paddingLeft: "", paddingRight: ""})
        }, i.prototype.checkScrollbar = function () {
            var e = window.innerWidth;
            if (!e) {
                var t = document.documentElement.getBoundingClientRect();
                e = t.right - Math.abs(t.left)
            }
            this.bodyIsOverflowing = document.body.clientWidth < e, this.scrollbarWidth = this.measureScrollbar()
        }, i.prototype.setScrollbar = function () {
            var e = parseInt(this.$body.css("padding-right") || 0, 10);
            this.originalBodyPad = document.body.style.paddingRight || "", this.bodyIsOverflowing && this.$body.css("padding-right", e + this.scrollbarWidth)
        }, i.prototype.resetScrollbar = function () {
            this.$body.css("padding-right", this.originalBodyPad)
        }, i.prototype.measureScrollbar = function () {
            var e = document.createElement("div");
            e.className = "modal-scrollbar-measure", this.$body.append(e);
            var t = e.offsetWidth - e.clientWidth;
            return this.$body[0].removeChild(e), t
        };
        var n = e.fn.modal;
        e.fn.modal = t, e.fn.modal.Constructor = i, e.fn.modal.noConflict = function () {
            return e.fn.modal = n, this
        }, e(document).on("click.bs.modal.data-api", '[data-toggle="modal"]', function (i) {
            var n = e(this), s = n.attr("href"), r = e(n.attr("data-target") || s && s.replace(/.*(?=#[^\s]+$)/, "")), a = r.data("bs.modal") ? "toggle" : e.extend({remote: !/#/.test(s) && s}, r.data(), n.data());
            n.is("a") && i.preventDefault(), r.one("show.bs.modal", function (e) {
                e.isDefaultPrevented() || r.one("hidden.bs.modal", function () {
                    n.is(":visible") && n.trigger("focus")
                })
            }), t.call(r, a, this)
        })
    }(jQuery), /* ========================================================================
 * Bootstrap: tooltip.js v3.3.5
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
    +function (e) {
        "use strict";
        function t(t) {
            return this.each(function () {
                var n = e(this), s = n.data("bs.tooltip"), r = "object" == typeof t && t;
                (s || !/destroy|hide/.test(t)) && (s || n.data("bs.tooltip", s = new i(this, r)), "string" == typeof t && s[t]())
            })
        }

        var i = function (e, t) {
            this.type = null, this.options = null, this.enabled = null, this.timeout = null, this.hoverState = null, this.$element = null, this.inState = null, this.init("tooltip", e, t)
        };
        i.VERSION = "3.3.5", i.TRANSITION_DURATION = 150, i.DEFAULTS = {
            animation: !0,
            placement: "top",
            selector: !1,
            template: '<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',
            trigger: "hover focus",
            title: "",
            delay: 0,
            html: !1,
            container: !1,
            viewport: {selector: "body", padding: 0}
        }, i.prototype.init = function (t, i, n) {
            if (this.enabled = !0, this.type = t, this.$element = e(i), this.options = this.getOptions(n), this.$viewport = this.options.viewport && e(e.isFunction(this.options.viewport) ? this.options.viewport.call(this, this.$element) : this.options.viewport.selector || this.options.viewport), this.inState = {
                    click: !1,
                    hover: !1,
                    focus: !1
                }, this.$element[0] instanceof document.constructor && !this.options.selector)throw new Error("`selector` option must be specified when initializing " + this.type + " on the window.document object!");
            for (var s = this.options.trigger.split(" "), r = s.length; r--;) {
                var a = s[r];
                if ("click" == a) this.$element.on("click." + this.type, this.options.selector, e.proxy(this.toggle, this)); else if ("manual" != a) {
                    var o = "hover" == a ? "mouseenter" : "focusin", l = "hover" == a ? "mouseleave" : "focusout";
                    this.$element.on(o + "." + this.type, this.options.selector, e.proxy(this.enter, this)), this.$element.on(l + "." + this.type, this.options.selector, e.proxy(this.leave, this))
                }
            }
            this.options.selector ? this._options = e.extend({}, this.options, {
                trigger: "manual",
                selector: ""
            }) : this.fixTitle()
        }, i.prototype.getDefaults = function () {
            return i.DEFAULTS
        }, i.prototype.getOptions = function (t) {
            return t = e.extend({}, this.getDefaults(), this.$element.data(), t), t.delay && "number" == typeof t.delay && (t.delay = {
                show: t.delay,
                hide: t.delay
            }), t
        }, i.prototype.getDelegateOptions = function () {
            var t = {}, i = this.getDefaults();
            return this._options && e.each(this._options, function (e, n) {
                i[e] != n && (t[e] = n)
            }), t
        }, i.prototype.enter = function (t) {
            var i = t instanceof this.constructor ? t : e(t.currentTarget).data("bs." + this.type);
            return i || (i = new this.constructor(t.currentTarget, this.getDelegateOptions()), e(t.currentTarget).data("bs." + this.type, i)), t instanceof e.Event && (i.inState["focusin" == t.type ? "focus" : "hover"] = !0), i.tip().hasClass("in") || "in" == i.hoverState ? (i.hoverState = "in", void 0) : (clearTimeout(i.timeout), i.hoverState = "in", i.options.delay && i.options.delay.show ? (i.timeout = setTimeout(function () {
                "in" == i.hoverState && i.show()
            }, i.options.delay.show), void 0) : i.show())
        }, i.prototype.isInStateTrue = function () {
            for (var e in this.inState)if (this.inState[e])return !0;
            return !1
        }, i.prototype.leave = function (t) {
            var i = t instanceof this.constructor ? t : e(t.currentTarget).data("bs." + this.type);
            return i || (i = new this.constructor(t.currentTarget, this.getDelegateOptions()), e(t.currentTarget).data("bs." + this.type, i)), t instanceof e.Event && (i.inState["focusout" == t.type ? "focus" : "hover"] = !1), i.isInStateTrue() ? void 0 : (clearTimeout(i.timeout), i.hoverState = "out", i.options.delay && i.options.delay.hide ? (i.timeout = setTimeout(function () {
                "out" == i.hoverState && i.hide()
            }, i.options.delay.hide), void 0) : i.hide())
        }, i.prototype.show = function () {
            var t = e.Event("show.bs." + this.type);
            if (this.hasContent() && this.enabled) {
                this.$element.trigger(t);
                var n = e.contains(this.$element[0].ownerDocument.documentElement, this.$element[0]);
                if (t.isDefaultPrevented() || !n)return;
                var s = this, r = this.tip(), a = this.getUID(this.type);
                this.setContent(), r.attr("id", a), this.$element.attr("aria-describedby", a), this.options.animation && r.addClass("fade");
                var o = "function" == typeof this.options.placement ? this.options.placement.call(this, r[0], this.$element[0]) : this.options.placement, l = /\s?auto?\s?/i, h = l.test(o);
                h && (o = o.replace(l, "") || "top"), r.detach().css({
                    top: 0,
                    left: 0,
                    display: "block"
                }).addClass(o).data("bs." + this.type, this), this.options.container ? r.appendTo(this.options.container) : r.insertAfter(this.$element), this.$element.trigger("inserted.bs." + this.type);
                var u = this.getPosition(), c = r[0].offsetWidth, p = r[0].offsetHeight;
                if (h) {
                    var d = o, f = this.getPosition(this.$viewport);
                    o = "bottom" == o && u.bottom + p > f.bottom ? "top" : "top" == o && u.top - p < f.top ? "bottom" : "right" == o && u.right + c > f.width ? "left" : "left" == o && u.left - c < f.left ? "right" : o, r.removeClass(d).addClass(o)
                }
                var m = this.getCalculatedOffset(o, u, c, p);
                this.applyPlacement(m, o);
                var g = function () {
                    var e = s.hoverState;
                    s.$element.trigger("shown.bs." + s.type), s.hoverState = null, "out" == e && s.leave(s)
                };
                e.support.transition && this.$tip.hasClass("fade") ? r.one("bsTransitionEnd", g).emulateTransitionEnd(i.TRANSITION_DURATION) : g()
            }
        }, i.prototype.applyPlacement = function (t, i) {
            var n = this.tip(), s = n[0].offsetWidth, r = n[0].offsetHeight, a = parseInt(n.css("margin-top"), 10), o = parseInt(n.css("margin-left"), 10);
            isNaN(a) && (a = 0), isNaN(o) && (o = 0), t.top += a, t.left += o, e.offset.setOffset(n[0], e.extend({
                using: function (e) {
                    n.css({top: Math.round(e.top), left: Math.round(e.left)})
                }
            }, t), 0), n.addClass("in");
            var l = n[0].offsetWidth, h = n[0].offsetHeight;
            "top" == i && h != r && (t.top = t.top + r - h);
            var u = this.getViewportAdjustedDelta(i, t, l, h);
            u.left ? t.left += u.left : t.top += u.top;
            var c = /top|bottom/.test(i), p = c ? 2 * u.left - s + l : 2 * u.top - r + h, d = c ? "offsetWidth" : "offsetHeight";
            n.offset(t), this.replaceArrow(p, n[0][d], c)
        }, i.prototype.replaceArrow = function (e, t, i) {
            this.arrow().css(i ? "left" : "top", 50 * (1 - e / t) + "%").css(i ? "top" : "left", "")
        }, i.prototype.setContent = function () {
            var e = this.tip(), t = this.getTitle();
            e.find(".tooltip-inner")[this.options.html ? "html" : "text"](t), e.removeClass("fade in top bottom left right")
        }, i.prototype.hide = function (t) {
            function n() {
                "in" != s.hoverState && r.detach(), s.$element.removeAttr("aria-describedby").trigger("hidden.bs." + s.type), t && t()
            }

            var s = this, r = e(this.$tip), a = e.Event("hide.bs." + this.type);
            return this.$element.trigger(a), a.isDefaultPrevented() ? void 0 : (r.removeClass("in"), e.support.transition && r.hasClass("fade") ? r.one("bsTransitionEnd", n).emulateTransitionEnd(i.TRANSITION_DURATION) : n(), this.hoverState = null, this)
        }, i.prototype.fixTitle = function () {
            var e = this.$element;
            (e.attr("title") || "string" != typeof e.attr("data-original-title")) && e.attr("data-original-title", e.attr("title") || "").attr("title", "")
        }, i.prototype.hasContent = function () {
            return this.getTitle()
        }, i.prototype.getPosition = function (t) {
            t = t || this.$element;
            var i = t[0], n = "BODY" == i.tagName, s = i.getBoundingClientRect();
            null == s.width && (s = e.extend({}, s, {width: s.right - s.left, height: s.bottom - s.top}));
            var r = n ? {
                top: 0,
                left: 0
            } : t.offset(), a = {scroll: n ? document.documentElement.scrollTop || document.body.scrollTop : t.scrollTop()}, o = n ? {
                width: e(window).width(),
                height: e(window).height()
            } : null;
            return e.extend({}, s, a, o, r)
        }, i.prototype.getCalculatedOffset = function (e, t, i, n) {
            return "bottom" == e ? {
                top: t.top + t.height,
                left: t.left + t.width / 2 - i / 2
            } : "top" == e ? {
                top: t.top - n,
                left: t.left + t.width / 2 - i / 2
            } : "left" == e ? {
                top: t.top + t.height / 2 - n / 2,
                left: t.left - i
            } : {top: t.top + t.height / 2 - n / 2, left: t.left + t.width}
        }, i.prototype.getViewportAdjustedDelta = function (e, t, i, n) {
            var s = {top: 0, left: 0};
            if (!this.$viewport)return s;
            var r = this.options.viewport && this.options.viewport.padding || 0, a = this.getPosition(this.$viewport);
            if (/right|left/.test(e)) {
                var o = t.top - r - a.scroll, l = t.top + r - a.scroll + n;
                o < a.top ? s.top = a.top - o : l > a.top + a.height && (s.top = a.top + a.height - l)
            } else {
                var h = t.left - r, u = t.left + r + i;
                h < a.left ? s.left = a.left - h : u > a.right && (s.left = a.left + a.width - u)
            }
            return s
        }, i.prototype.getTitle = function () {
            var e, t = this.$element, i = this.options;
            return e = t.attr("data-original-title") || ("function" == typeof i.title ? i.title.call(t[0]) : i.title)
        }, i.prototype.getUID = function (e) {
            do e += ~~(1e6 * Math.random()); while (document.getElementById(e));
            return e
        }, i.prototype.tip = function () {
            if (!this.$tip && (this.$tip = e(this.options.template), 1 != this.$tip.length))throw new Error(this.type + " `template` option must consist of exactly 1 top-level element!");
            return this.$tip
        }, i.prototype.arrow = function () {
            return this.$arrow = this.$arrow || this.tip().find(".tooltip-arrow")
        }, i.prototype.enable = function () {
            this.enabled = !0
        }, i.prototype.disable = function () {
            this.enabled = !1
        }, i.prototype.toggleEnabled = function () {
            this.enabled = !this.enabled
        }, i.prototype.toggle = function (t) {
            var i = this;
            t && (i = e(t.currentTarget).data("bs." + this.type), i || (i = new this.constructor(t.currentTarget, this.getDelegateOptions()), e(t.currentTarget).data("bs." + this.type, i))), t ? (i.inState.click = !i.inState.click, i.isInStateTrue() ? i.enter(i) : i.leave(i)) : i.tip().hasClass("in") ? i.leave(i) : i.enter(i)
        }, i.prototype.destroy = function () {
            var e = this;
            clearTimeout(this.timeout), this.hide(function () {
                e.$element.off("." + e.type).removeData("bs." + e.type), e.$tip && e.$tip.detach(), e.$tip = null, e.$arrow = null, e.$viewport = null
            })
        };
        var n = e.fn.tooltip;
        e.fn.tooltip = t, e.fn.tooltip.Constructor = i, e.fn.tooltip.noConflict = function () {
            return e.fn.tooltip = n, this
        }
    }(jQuery), /* ========================================================================
 * Bootstrap: popover.js v3.3.5
 * http://getbootstrap.com/javascript/#popovers
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
    +function (e) {
        "use strict";
        function t(t) {
            return this.each(function () {
                var n = e(this), s = n.data("bs.popover"), r = "object" == typeof t && t;
                (s || !/destroy|hide/.test(t)) && (s || n.data("bs.popover", s = new i(this, r)), "string" == typeof t && s[t]())
            })
        }

        var i = function (e, t) {
            this.init("popover", e, t)
        };
        if (!e.fn.tooltip)throw new Error("Popover requires tooltip.js");
        i.VERSION = "3.3.5", i.DEFAULTS = e.extend({}, e.fn.tooltip.Constructor.DEFAULTS, {
            placement: "right",
            trigger: "click",
            content: "",
            template: '<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'
        }), i.prototype = e.extend({}, e.fn.tooltip.Constructor.prototype), i.prototype.constructor = i, i.prototype.getDefaults = function () {
            return i.DEFAULTS
        }, i.prototype.setContent = function () {
            var e = this.tip(), t = this.getTitle(), i = this.getContent();
            e.find(".popover-title")[this.options.html ? "html" : "text"](t), e.find(".popover-content").children().detach().end()[this.options.html ? "string" == typeof i ? "html" : "append" : "text"](i), e.removeClass("fade top bottom left right in"), e.find(".popover-title").html() || e.find(".popover-title").hide()
        }, i.prototype.hasContent = function () {
            return this.getTitle() || this.getContent()
        }, i.prototype.getContent = function () {
            var e = this.$element, t = this.options;
            return e.attr("data-content") || ("function" == typeof t.content ? t.content.call(e[0]) : t.content)
        }, i.prototype.arrow = function () {
            return this.$arrow = this.$arrow || this.tip().find(".arrow")
        };
        var n = e.fn.popover;
        e.fn.popover = t, e.fn.popover.Constructor = i, e.fn.popover.noConflict = function () {
            return e.fn.popover = n, this
        }
    }(jQuery), /*
 * jQuery MiniColors: A tiny color picker built on jQuery
 *
 * Copyright Cory LaViska for A Beautiful Site, LLC. (http://www.abeautifulsite.net/)
 *
 * Licensed under the MIT license: http://opensource.org/licenses/MIT
 *
 */
jQuery && function (e) {
    function t(t, i) {
        var n = e('<div class="minicolors" />'), s = e.minicolors.defaults;
        t.data("minicolors-initialized") || (i = e.extend(!0, {}, s, i), n.addClass("minicolors-theme-" + i.theme).toggleClass("minicolors-with-opacity", i.opacity), void 0 !== i.position && e.each(i.position.split(" "), function () {
            n.addClass("minicolors-position-" + this)
        }), t.addClass("minicolors-input").data("minicolors-initialized", !1).data("minicolors-settings", i).prop("size", 7).wrap(n).after('<div class="minicolors-panel minicolors-slider-' + i.control + '">' + '<div class="minicolors-slider">' + '<div class="minicolors-picker"></div>' + "</div>" + '<div class="minicolors-opacity-slider">' + '<div class="minicolors-picker"></div>' + "</div>" + '<div class="minicolors-grid">' + '<div class="minicolors-grid-inner"></div>' + '<div class="minicolors-picker"><div></div></div>' + "</div>" + "</div>"), i.inline || (t.after('<span class="minicolors-swatch"><span class="minicolors-swatch-color"></span></span>'), t.next(".minicolors-swatch").on("click", function (e) {
            e.preventDefault(), t.focus()
        })), t.parent().find(".minicolors-panel").on("selectstart", function () {
            return !1
        }).end(), i.inline && t.parent().addClass("minicolors-inline"), o(t, !1), t.data("minicolors-initialized", !0))
    }

    function i(e) {
        var t = e.parent();
        e.removeData("minicolors-initialized").removeData("minicolors-settings").removeProp("size").removeClass("minicolors-input"), t.before(e).remove()
    }

    function n(e) {
        var t = e.parent(), i = t.find(".minicolors-panel"), n = e.data("minicolors-settings");
        !e.data("minicolors-initialized") || e.prop("disabled") || t.hasClass("minicolors-inline") || t.hasClass("minicolors-focus") || (s(), t.addClass("minicolors-focus"), i.stop(!0, !0).fadeIn(n.showSpeed, function () {
            n.show && n.show.call(e.get(0))
        }))
    }

    function s() {
        e(".minicolors-focus").each(function () {
            var t = e(this), i = t.find(".minicolors-input"), n = t.find(".minicolors-panel"), s = i.data("minicolors-settings");
            n.fadeOut(s.hideSpeed, function () {
                s.hide && s.hide.call(i.get(0)), t.removeClass("minicolors-focus")
            })
        })
    }

    function r(e, t, i) {
        var n, s, r, o, l = e.parents(".minicolors").find(".minicolors-input"), h = l.data("minicolors-settings"), u = e.find("[class$=-picker]"), c = e.offset().left, p = e.offset().top, d = Math.round(t.pageX - c), f = Math.round(t.pageY - p), m = i ? h.animationSpeed : 0;
        t.originalEvent.changedTouches && (d = t.originalEvent.changedTouches[0].pageX - c, f = t.originalEvent.changedTouches[0].pageY - p), 0 > d && (d = 0), 0 > f && (f = 0), d > e.width() && (d = e.width()), f > e.height() && (f = e.height()), e.parent().is(".minicolors-slider-wheel") && u.parent().is(".minicolors-grid") && (n = 75 - d, s = 75 - f, r = Math.sqrt(n * n + s * s), o = Math.atan2(s, n), 0 > o && (o += 2 * Math.PI), r > 75 && (r = 75, d = 75 - 75 * Math.cos(o), f = 75 - 75 * Math.sin(o)), d = Math.round(d), f = Math.round(f)), e.is(".minicolors-grid") ? u.stop(!0).animate({
            top: f + "px",
            left: d + "px"
        }, m, h.animationEasing, function () {
            a(l, e)
        }) : u.stop(!0).animate({top: f + "px"}, m, h.animationEasing, function () {
            a(l, e)
        })
    }

    function a(e, t) {
        function i(e, t) {
            var i, n;
            return e.length && t ? (i = e.offset().left, n = e.offset().top, {
                x: i - t.offset().left + e.outerWidth() / 2,
                y: n - t.offset().top + e.outerHeight() / 2
            }) : null
        }

        var n, s, r, a, o, h, u, p = e.val(), f = e.attr("data-opacity"), m = e.parent(), y = e.data("minicolors-settings"), v = m.find(".minicolors-swatch"), b = m.find(".minicolors-grid"), L = m.find(".minicolors-slider"), w = m.find(".minicolors-opacity-slider"), O = b.find("[class$=-picker]"), C = L.find("[class$=-picker]"), x = w.find("[class$=-picker]"), S = i(O, b), _ = i(C, L), T = i(x, w);
        if (t.is(".minicolors-grid, .minicolors-slider")) {
            switch (y.control) {
                case"wheel":
                    a = b.width() / 2 - S.x, o = b.height() / 2 - S.y, h = Math.sqrt(a * a + o * o), u = Math.atan2(o, a), 0 > u && (u += 2 * Math.PI), h > 75 && (h = 75, S.x = 69 - 75 * Math.cos(u), S.y = 69 - 75 * Math.sin(u)), s = d(h / .75, 0, 100), n = d(180 * u / Math.PI, 0, 360), r = d(100 - Math.floor(_.y * (100 / L.height())), 0, 100), p = g({
                        h: n,
                        s: s,
                        b: r
                    }), L.css("backgroundColor", g({h: n, s: s, b: 100}));
                    break;
                case"saturation":
                    n = d(parseInt(S.x * (360 / b.width()), 10), 0, 360), s = d(100 - Math.floor(_.y * (100 / L.height())), 0, 100), r = d(100 - Math.floor(S.y * (100 / b.height())), 0, 100), p = g({
                        h: n,
                        s: s,
                        b: r
                    }), L.css("backgroundColor", g({
                        h: n,
                        s: 100,
                        b: r
                    })), m.find(".minicolors-grid-inner").css("opacity", s / 100);
                    break;
                case"brightness":
                    n = d(parseInt(S.x * (360 / b.width()), 10), 0, 360), s = d(100 - Math.floor(S.y * (100 / b.height())), 0, 100), r = d(100 - Math.floor(_.y * (100 / L.height())), 0, 100), p = g({
                        h: n,
                        s: s,
                        b: r
                    }), L.css("backgroundColor", g({
                        h: n,
                        s: s,
                        b: 100
                    })), m.find(".minicolors-grid-inner").css("opacity", 1 - r / 100);
                    break;
                default:
                    n = d(360 - parseInt(_.y * (360 / L.height()), 10), 0, 360), s = d(Math.floor(S.x * (100 / b.width())), 0, 100), r = d(100 - Math.floor(S.y * (100 / b.height())), 0, 100), p = g({
                        h: n,
                        s: s,
                        b: r
                    }), b.css("backgroundColor", g({h: n, s: 100, b: 100}))
            }
            e.val(c(p, y.letterCase))
        }
        t.is(".minicolors-opacity-slider") && (f = y.opacity ? parseFloat(1 - T.y / w.height()).toFixed(2) : 1, y.opacity && e.attr("data-opacity", f)), v.find("SPAN").css({
            backgroundColor: p,
            opacity: f
        }), l(e, p, f)
    }

    function o(e, t) {
        var i, n, s, r, a, o, h, u = e.parent(), f = e.data("minicolors-settings"), m = u.find(".minicolors-swatch"), v = u.find(".minicolors-grid"), b = u.find(".minicolors-slider"), L = u.find(".minicolors-opacity-slider"), w = v.find("[class$=-picker]"), O = b.find("[class$=-picker]"), C = L.find("[class$=-picker]");
        switch (i = c(p(e.val(), !0), f.letterCase), i || (i = c(p(f.defaultValue, !0), f.letterCase)), n = y(i), t || e.val(i), f.opacity && (s = "" === e.attr("data-opacity") ? 1 : d(parseFloat(e.attr("data-opacity")).toFixed(2), 0, 1), isNaN(s) && (s = 1), e.attr("data-opacity", s), m.find("SPAN").css("opacity", s), a = d(L.height() - L.height() * s, 0, L.height()), C.css("top", a + "px")), m.find("SPAN").css("backgroundColor", i), f.control) {
            case"wheel":
                o = d(Math.ceil(.75 * n.s), 0, v.height() / 2), h = n.h * Math.PI / 180, r = d(75 - Math.cos(h) * o, 0, v.width()), a = d(75 - Math.sin(h) * o, 0, v.height()), w.css({
                    top: a + "px",
                    left: r + "px"
                }), a = 150 - n.b / (100 / v.height()), "" === i && (a = 0), O.css("top", a + "px"), b.css("backgroundColor", g({
                    h: n.h,
                    s: n.s,
                    b: 100
                }));
                break;
            case"saturation":
                r = d(5 * n.h / 12, 0, 150), a = d(v.height() - Math.ceil(n.b / (100 / v.height())), 0, v.height()), w.css({
                    top: a + "px",
                    left: r + "px"
                }), a = d(b.height() - n.s * (b.height() / 100), 0, b.height()), O.css("top", a + "px"), b.css("backgroundColor", g({
                    h: n.h,
                    s: 100,
                    b: n.b
                })), u.find(".minicolors-grid-inner").css("opacity", n.s / 100);
                break;
            case"brightness":
                r = d(5 * n.h / 12, 0, 150), a = d(v.height() - Math.ceil(n.s / (100 / v.height())), 0, v.height()), w.css({
                    top: a + "px",
                    left: r + "px"
                }), a = d(b.height() - n.b * (b.height() / 100), 0, b.height()), O.css("top", a + "px"), b.css("backgroundColor", g({
                    h: n.h,
                    s: n.s,
                    b: 100
                })), u.find(".minicolors-grid-inner").css("opacity", 1 - n.b / 100);
                break;
            default:
                r = d(Math.ceil(n.s / (100 / v.width())), 0, v.width()), a = d(v.height() - Math.ceil(n.b / (100 / v.height())), 0, v.height()), w.css({
                    top: a + "px",
                    left: r + "px"
                }), a = d(b.height() - n.h / (360 / b.height()), 0, b.height()), O.css("top", a + "px"), v.css("backgroundColor", g({
                    h: n.h,
                    s: 100,
                    b: 100
                }))
        }
        e.data("minicolors-initialized") && l(e, i, s)
    }

    function l(e, t, i) {
        var n = e.data("minicolors-settings"), s = e.data("minicolors-lastChange");
        s && s.hex === t && s.opacity === i || (e.data("minicolors-lastChange", {
            hex: t,
            opacity: i
        }), n.change && (n.changeDelay ? (clearTimeout(e.data("minicolors-changeTimeout")), e.data("minicolors-changeTimeout", setTimeout(function () {
            n.change.call(e.get(0), t, i)
        }, n.changeDelay))) : n.change.call(e.get(0), t, i)), e.trigger("change").trigger("input"))
    }

    function h(t) {
        var i = p(e(t).val(), !0), n = b(i), s = e(t).attr("data-opacity");
        return n ? (void 0 !== s && e.extend(n, {a: parseFloat(s)}), n) : null
    }

    function u(t, i) {
        var n = p(e(t).val(), !0), s = b(n), r = e(t).attr("data-opacity");
        return s ? (void 0 === r && (r = 1), i ? "rgba(" + s.r + ", " + s.g + ", " + s.b + ", " + parseFloat(r) + ")" : "rgb(" + s.r + ", " + s.g + ", " + s.b + ")") : null
    }

    function c(e, t) {
        return "uppercase" === t ? e.toUpperCase() : e.toLowerCase()
    }

    function p(e, t) {
        return e = e.replace(/[^A-F0-9]/gi, ""), 3 !== e.length && 6 !== e.length ? "" : (3 === e.length && t && (e = e[0] + e[0] + e[1] + e[1] + e[2] + e[2]), "#" + e)
    }

    function d(e, t, i) {
        return t > e && (e = t), e > i && (e = i), e
    }

    function f(e) {
        var t = {}, i = Math.round(e.h), n = Math.round(255 * e.s / 100), s = Math.round(255 * e.b / 100);
        if (0 === n) t.r = t.g = t.b = s; else {
            var r = s, a = (255 - n) * s / 255, o = (r - a) * (i % 60) / 60;
            360 === i && (i = 0), 60 > i ? (t.r = r, t.b = a, t.g = a + o) : 120 > i ? (t.g = r, t.b = a, t.r = r - o) : 180 > i ? (t.g = r, t.r = a, t.b = a + o) : 240 > i ? (t.b = r, t.r = a, t.g = r - o) : 300 > i ? (t.b = r, t.g = a, t.r = a + o) : 360 > i ? (t.r = r, t.g = a, t.b = r - o) : (t.r = 0, t.g = 0, t.b = 0)
        }
        return {r: Math.round(t.r), g: Math.round(t.g), b: Math.round(t.b)}
    }

    function m(t) {
        var i = [t.r.toString(16), t.g.toString(16), t.b.toString(16)];
        return e.each(i, function (e, t) {
            1 === t.length && (i[e] = "0" + t)
        }), "#" + i.join("")
    }

    function g(e) {
        return m(f(e))
    }

    function y(e) {
        var t = v(b(e));
        return 0 === t.s && (t.h = 360), t
    }

    function v(e) {
        var t = {h: 0, s: 0, b: 0}, i = Math.min(e.r, e.g, e.b), n = Math.max(e.r, e.g, e.b), s = n - i;
        return t.b = n, t.s = 0 !== n ? 255 * s / n : 0, t.h = 0 !== t.s ? e.r === n ? (e.g - e.b) / s : e.g === n ? 2 + (e.b - e.r) / s : 4 + (e.r - e.g) / s : -1, t.h *= 60, t.h < 0 && (t.h += 360), t.s *= 100 / 255, t.b *= 100 / 255, t
    }

    function b(e) {
        return e = parseInt(e.indexOf("#") > -1 ? e.substring(1) : e, 16), {r: e >> 16, g: (65280 & e) >> 8, b: 255 & e}
    }

    e.minicolors = {
        defaults: {
            animationSpeed: 50,
            animationEasing: "swing",
            change: null,
            changeDelay: 0,
            control: "hue",
            defaultValue: "",
            hide: null,
            hideSpeed: 100,
            inline: !1,
            letterCase: "lowercase",
            opacity: !1,
            position: "bottom left",
            show: null,
            showSpeed: 100,
            theme: "default"
        }
    }, e.extend(e.fn, {
        minicolors: function (r, a) {
            switch (r) {
                case"destroy":
                    return e(this).each(function () {
                        i(e(this))
                    }), e(this);
                case"hide":
                    return s(), e(this);
                case"opacity":
                    return void 0 === a ? e(this).attr("data-opacity") : (e(this).each(function () {
                        o(e(this).attr("data-opacity", a))
                    }), e(this));
                case"rgbObject":
                    return h(e(this), "rgbaObject" === r);
                case"rgbString":
                case"rgbaString":
                    return u(e(this), "rgbaString" === r);
                case"settings":
                    return void 0 === a ? e(this).data("minicolors-settings") : (e(this).each(function () {
                        var t = e(this).data("minicolors-settings") || {};
                        i(e(this)), e(this).minicolors(e.extend(!0, t, a))
                    }), e(this));
                case"show":
                    return n(e(this).eq(0)), e(this);
                case"value":
                    return void 0 === a ? e(this).val() : (e(this).each(function () {
                        o(e(this).val(a))
                    }), e(this));
                default:
                    return "create" !== r && (a = r), e(this).each(function () {
                        t(e(this), a)
                    }), e(this)
            }
        }
    }), e(document).on("mousedown.minicolors touchstart.minicolors", function (t) {
        e(t.target).parents().add(t.target).hasClass("minicolors") || s()
    }).on("mousedown.minicolors touchstart.minicolors", ".minicolors-grid, .minicolors-slider, .minicolors-opacity-slider", function (t) {
        var i = e(this);
        t.preventDefault(), e(document).data("minicolors-target", i), r(i, t, !0)
    }).on("mousemove.minicolors touchmove.minicolors", function (t) {
        var i = e(document).data("minicolors-target");
        i && r(i, t)
    }).on("mouseup.minicolors touchend.minicolors", function () {
        e(this).removeData("minicolors-target")
    }).on("mousedown.minicolors touchstart.minicolors", ".minicolors-swatch", function (t) {
        var i = e(this).parent().find(".minicolors-input");
        t.preventDefault(), n(i)
    }).on("focus.minicolors", ".minicolors-input", function () {
        var t = e(this);
        t.data("minicolors-initialized") && n(t)
    }).on("blur.minicolors", ".minicolors-input", function () {
        var t = e(this), i = t.data("minicolors-settings");
        t.data("minicolors-initialized") && (t.val(p(t.val(), !0)), "" === t.val() && t.val(p(i.defaultValue, !0)), t.val(c(t.val(), i.letterCase)))
    }).on("keydown.minicolors", ".minicolors-input", function (t) {
        var i = e(this);
        if (i.data("minicolors-initialized"))switch (t.keyCode) {
            case 9:
                s();
                break;
            case 13:
            case 27:
                s(), i.blur()
        }
    }).on("keyup.minicolors", ".minicolors-input", function () {
        var t = e(this);
        t.data("minicolors-initialized") && o(t, !0)
    }).on("paste.minicolors", ".minicolors-input", function () {
        var t = e(this);
        t.data("minicolors-initialized") && setTimeout(function () {
            o(t, !0)
        }, 1)
    })
}(jQuery), function (e, t) {
    e.rails !== t && e.error("jquery-ujs has already been loaded!");
    var i;
    e.rails = i = {
        linkClickSelector: "a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",
        buttonClickSelector: "button[data-remote]",
        inputChangeSelector: "select[data-remote], input[data-remote], textarea[data-remote]",
        formSubmitSelector: "form",
        formInputClickSelector: "form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",
        disableSelector: "input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",
        enableSelector: "input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",
        requiredInputSelector: "input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",
        fileInputSelector: "input[type=file]",
        linkDisableSelector: "a[data-disable-with]",
        CSRFProtection: function (t) {
            var i = e('meta[name="csrf-token"]').attr("content");
            i && t.setRequestHeader("X-CSRF-Token", i)
        },
        fire: function (t, i, n) {
            var s = e.Event(i);
            return t.trigger(s, n), s.result !== !1
        },
        confirm: function (e) {
            return confirm(e)
        },
        ajax: function (t) {
            return e.ajax(t)
        },
        href: function (e) {
            return e.attr("href")
        },
        handleRemote: function (n) {
            var s, r, a, o, l, h, u, c;
            if (i.fire(n, "ajax:before")) {
                if (o = n.data("cross-domain"), l = o === t ? null : o, h = n.data("with-credentials") || null, u = n.data("type") || e.ajaxSettings && e.ajaxSettings.dataType, n.is("form")) {
                    s = n.attr("method"), r = n.attr("action"), a = n.serializeArray();
                    var p = n.data("ujs:submit-button");
                    p && (a.push(p), n.data("ujs:submit-button", null))
                } else n.is(i.inputChangeSelector) ? (s = n.data("method"), r = n.data("url"), a = n.serialize(), n.data("params") && (a = a + "&" + n.data("params"))) : n.is(i.buttonClickSelector) ? (s = n.data("method") || "get", r = n.data("url"), a = n.serialize(), n.data("params") && (a = a + "&" + n.data("params"))) : (s = n.data("method"), r = i.href(n), a = n.data("params") || null);
                c = {
                    type: s || "GET", data: a, dataType: u, beforeSend: function (e, s) {
                        return s.dataType === t && e.setRequestHeader("accept", "*/*;q=0.5, " + s.accepts.script), i.fire(n, "ajax:beforeSend", [e, s])
                    }, success: function (e, t, i) {
                        n.trigger("ajax:success", [e, t, i])
                    }, complete: function (e, t) {
                        n.trigger("ajax:complete", [e, t])
                    }, error: function (e, t, i) {
                        n.trigger("ajax:error", [e, t, i])
                    }, crossDomain: l
                }, h && (c.xhrFields = {withCredentials: h}), r && (c.url = r);
                var d = i.ajax(c);
                return n.trigger("ajax:send", d), d
            }
            return !1
        },
        handleMethod: function (n) {
            var s = i.href(n), r = n.data("method"), a = n.attr("target"), o = e("meta[name=csrf-token]").attr("content"), l = e("meta[name=csrf-param]").attr("content"), h = e('<form method="post" action="' + s + '"></form>'), u = '<input name="_method" value="' + r + '" type="hidden" />';
            l !== t && o !== t && (u += '<input name="' + l + '" value="' + o + '" type="hidden" />'), a && h.attr("target", a), h.hide().append(u).appendTo("body"), h.submit()
        },
        disableFormElements: function (t) {
            t.find(i.disableSelector).each(function () {
                var t = e(this), i = t.is("button") ? "html" : "val";
                t.data("ujs:enable-with", t[i]()), t[i](t.data("disable-with")), t.prop("disabled", !0)
            })
        },
        enableFormElements: function (t) {
            t.find(i.enableSelector).each(function () {
                var t = e(this), i = t.is("button") ? "html" : "val";
                t.data("ujs:enable-with") && t[i](t.data("ujs:enable-with")), t.prop("disabled", !1)
            })
        },
        allowAction: function (e) {
            var t, n = e.data("confirm"), s = !1;
            return n ? (i.fire(e, "confirm") && (s = i.confirm(n), t = i.fire(e, "confirm:complete", [s])), s && t) : !0
        },
        blankInputs: function (t, i, n) {
            var s, r, a = e(), o = i || "input,textarea", l = t.find(o);
            return l.each(function () {
                if (s = e(this), r = s.is("input[type=checkbox],input[type=radio]") ? s.is(":checked") : s.val(), !r == !n) {
                    if (s.is("input[type=radio]") && l.filter('input[type=radio]:checked[name="' + s.attr("name") + '"]').length)return !0;
                    a = a.add(s)
                }
            }), a.length ? a : !1
        },
        nonBlankInputs: function (e, t) {
            return i.blankInputs(e, t, !0)
        },
        stopEverything: function (t) {
            return e(t.target).trigger("ujs:everythingStopped"), t.stopImmediatePropagation(), !1
        },
        disableElement: function (e) {
            e.data("ujs:enable-with", e.html()), e.html(e.data("disable-with")), e.bind("click.railsDisable", function (e) {
                return i.stopEverything(e)
            })
        },
        enableElement: function (e) {
            e.data("ujs:enable-with") !== t && (e.html(e.data("ujs:enable-with")), e.removeData("ujs:enable-with")), e.unbind("click.railsDisable")
        }
    }, i.fire(e(document), "rails:attachBindings") && (e.ajaxPrefilter(function (e, t, n) {
        e.crossDomain || i.CSRFProtection(n)
    }), e(document).delegate(i.linkDisableSelector, "ajax:complete", function () {
        i.enableElement(e(this))
    }), e(document).delegate(i.linkClickSelector, "click.rails", function (n) {
        var s = e(this), r = s.data("method"), a = s.data("params");
        if (!i.allowAction(s))return i.stopEverything(n);
        if (s.is(i.linkDisableSelector) && i.disableElement(s), s.data("remote") !== t) {
            if (!(!n.metaKey && !n.ctrlKey || r && "GET" !== r || a))return !0;
            var o = i.handleRemote(s);
            return o === !1 ? i.enableElement(s) : o.error(function () {
                i.enableElement(s)
            }), !1
        }
        return s.data("method") ? (i.handleMethod(s), !1) : void 0
    }), e(document).delegate(i.buttonClickSelector, "click.rails", function (t) {
        var n = e(this);
        return i.allowAction(n) ? (i.handleRemote(n), !1) : i.stopEverything(t)
    }), e(document).delegate(i.inputChangeSelector, "change.rails", function (t) {
        var n = e(this);
        return i.allowAction(n) ? (i.handleRemote(n), !1) : i.stopEverything(t)
    }), e(document).delegate(i.formSubmitSelector, "submit.rails", function (n) {
        var s = e(this), r = s.data("remote") !== t, a = i.blankInputs(s, i.requiredInputSelector), o = i.nonBlankInputs(s, i.fileInputSelector);
        if (!i.allowAction(s))return i.stopEverything(n);
        if (a && s.attr("novalidate") == t && i.fire(s, "ajax:aborted:required", [a]))return i.stopEverything(n);
        if (r) {
            if (o) {
                setTimeout(function () {
                    i.disableFormElements(s)
                }, 13);
                var l = i.fire(s, "ajax:aborted:file", [o]);
                return l || setTimeout(function () {
                    i.enableFormElements(s)
                }, 13), l
            }
            return i.handleRemote(s), !1
        }
        setTimeout(function () {
            i.disableFormElements(s)
        }, 13)
    }), e(document).delegate(i.formInputClickSelector, "click.rails", function (t) {
        var n = e(this);
        if (!i.allowAction(n))return i.stopEverything(t);
        var s = n.attr("name"), r = s ? {name: s, value: n.val()} : null;
        n.closest("form").data("ujs:submit-button", r)
    }), e(document).delegate(i.formSubmitSelector, "ajax:beforeSend.rails", function (t) {
        this == t.target && i.disableFormElements(e(this))
    }), e(document).delegate(i.formSubmitSelector, "ajax:complete.rails", function (t) {
        this == t.target && i.enableFormElements(e(this))
    }), e(function () {
        var t = e("meta[name=csrf-token]").attr("content"), i = e("meta[name=csrf-param]").attr("content");
        e('form input[name="' + i + '"]').val(t)
    }))
}(jQuery), /*
 * jQuery UI Widget 1.10.0+amd
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */
    function (e) {
        "function" == typeof define && define.amd ? define(["jquery"], e) : e(jQuery)
    }(function (e, t) {
        var i = 0, n = Array.prototype.slice, s = e.cleanData;
        e.cleanData = function (t) {
            for (var i, n = 0; null != (i = t[n]); n++)try {
                e(i).triggerHandler("remove")
            } catch (r) {
            }
            s(t)
        }, e.widget = function (t, i, n) {
            var s, r, a, o, l = {}, h = t.split(".")[0];
            t = t.split(".")[1], s = h + "-" + t, n || (n = i, i = e.Widget), e.expr[":"][s.toLowerCase()] = function (t) {
                return !!e.data(t, s)
            }, e[h] = e[h] || {}, r = e[h][t], a = e[h][t] = function (e, t) {
                return this._createWidget ? (arguments.length && this._createWidget(e, t), void 0) : new a(e, t)
            }, e.extend(a, r, {
                version: n.version,
                _proto: e.extend({}, n),
                _childConstructors: []
            }), o = new i, o.options = e.widget.extend({}, o.options), e.each(n, function (t, n) {
                return e.isFunction(n) ? (l[t] = function () {
                    var e = function () {
                        return i.prototype[t].apply(this, arguments)
                    }, s = function (e) {
                        return i.prototype[t].apply(this, e)
                    };
                    return function () {
                        var t, i = this._super, r = this._superApply;
                        return this._super = e, this._superApply = s, t = n.apply(this, arguments), this._super = i, this._superApply = r, t
                    }
                }(), void 0) : (l[t] = n, void 0)
            }), a.prototype = e.widget.extend(o, {widgetEventPrefix: r ? o.widgetEventPrefix : t}, l, {
                constructor: a,
                namespace: h,
                widgetName: t,
                widgetFullName: s
            }), r ? (e.each(r._childConstructors, function (t, i) {
                var n = i.prototype;
                e.widget(n.namespace + "." + n.widgetName, a, i._proto)
            }), delete r._childConstructors) : i._childConstructors.push(a), e.widget.bridge(t, a)
        }, e.widget.extend = function (i) {
            for (var s, r, a = n.call(arguments, 1), o = 0, l = a.length; l > o; o++)for (s in a[o])r = a[o][s], a[o].hasOwnProperty(s) && r !== t && (i[s] = e.isPlainObject(r) ? e.isPlainObject(i[s]) ? e.widget.extend({}, i[s], r) : e.widget.extend({}, r) : r);
            return i
        }, e.widget.bridge = function (i, s) {
            var r = s.prototype.widgetFullName || i;
            e.fn[i] = function (a) {
                var o = "string" == typeof a, l = n.call(arguments, 1), h = this;
                return a = !o && l.length ? e.widget.extend.apply(null, [a].concat(l)) : a, o ? this.each(function () {
                    var n, s = e.data(this, r);
                    return s ? e.isFunction(s[a]) && "_" !== a.charAt(0) ? (n = s[a].apply(s, l), n !== s && n !== t ? (h = n && n.jquery ? h.pushStack(n.get()) : n, !1) : void 0) : e.error("no such method '" + a + "' for " + i + " widget instance") : e.error("cannot call methods on " + i + " prior to initialization; " + "attempted to call method '" + a + "'")
                }) : this.each(function () {
                    var t = e.data(this, r);
                    t ? t.option(a || {})._init() : e.data(this, r, new s(a, this))
                }), h
            }
        }, e.Widget = function () {
        }, e.Widget._childConstructors = [], e.Widget.prototype = {
            widgetName: "widget",
            widgetEventPrefix: "",
            defaultElement: "<div>",
            options: {disabled: !1, create: null},
            _createWidget: function (t, n) {
                n = e(n || this.defaultElement || this)[0], this.element = e(n), this.uuid = i++, this.eventNamespace = "." + this.widgetName + this.uuid, this.options = e.widget.extend({}, this.options, this._getCreateOptions(), t), this.bindings = e(), this.hoverable = e(), this.focusable = e(), n !== this && (e.data(n, this.widgetFullName, this), this._on(!0, this.element, {
                    remove: function (e) {
                        e.target === n && this.destroy()
                    }
                }), this.document = e(n.style ? n.ownerDocument : n.document || n), this.window = e(this.document[0].defaultView || this.document[0].parentWindow)), this._create(), this._trigger("create", null, this._getCreateEventData()), this._init()
            },
            _getCreateOptions: e.noop,
            _getCreateEventData: e.noop,
            _create: e.noop,
            _init: e.noop,
            destroy: function () {
                this._destroy(), this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)), this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled " + "ui-state-disabled"), this.bindings.unbind(this.eventNamespace), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")
            },
            _destroy: e.noop,
            widget: function () {
                return this.element
            },
            option: function (i, n) {
                var s, r, a, o = i;
                if (0 === arguments.length)return e.widget.extend({}, this.options);
                if ("string" == typeof i)if (o = {}, s = i.split("."), i = s.shift(), s.length) {
                    for (r = o[i] = e.widget.extend({}, this.options[i]), a = 0; a < s.length - 1; a++)r[s[a]] = r[s[a]] || {}, r = r[s[a]];
                    if (i = s.pop(), n === t)return r[i] === t ? null : r[i];
                    r[i] = n
                } else {
                    if (n === t)return this.options[i] === t ? null : this.options[i];
                    o[i] = n
                }
                return this._setOptions(o), this
            },
            _setOptions: function (e) {
                var t;
                for (t in e)this._setOption(t, e[t]);
                return this
            },
            _setOption: function (e, t) {
                return this.options[e] = t, "disabled" === e && (this.widget().toggleClass(this.widgetFullName + "-disabled ui-state-disabled", !!t).attr("aria-disabled", t), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")), this
            },
            enable: function () {
                return this._setOption("disabled", !1)
            },
            disable: function () {
                return this._setOption("disabled", !0)
            },
            _on: function (t, i, n) {
                var s, r = this;
                "boolean" != typeof t && (n = i, i = t, t = !1), n ? (i = s = e(i), this.bindings = this.bindings.add(i)) : (n = i, i = this.element, s = this.widget()), e.each(n, function (n, a) {
                    function o() {
                        return t || r.options.disabled !== !0 && !e(this).hasClass("ui-state-disabled") ? ("string" == typeof a ? r[a] : a).apply(r, arguments) : void 0
                    }

                    "string" != typeof a && (o.guid = a.guid = a.guid || o.guid || e.guid++);
                    var l = n.match(/^(\w+)\s*(.*)$/), h = l[1] + r.eventNamespace, u = l[2];
                    u ? s.delegate(u, h, o) : i.bind(h, o)
                })
            },
            _off: function (e, t) {
                t = (t || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace, e.unbind(t).undelegate(t)
            },
            _delay: function (e, t) {
                function i() {
                    return ("string" == typeof e ? n[e] : e).apply(n, arguments)
                }

                var n = this;
                return setTimeout(i, t || 0)
            },
            _hoverable: function (t) {
                this.hoverable = this.hoverable.add(t), this._on(t, {
                    mouseenter: function (t) {
                        e(t.currentTarget).addClass("ui-state-hover")
                    }, mouseleave: function (t) {
                        e(t.currentTarget).removeClass("ui-state-hover")
                    }
                })
            },
            _focusable: function (t) {
                this.focusable = this.focusable.add(t), this._on(t, {
                    focusin: function (t) {
                        e(t.currentTarget).addClass("ui-state-focus")
                    }, focusout: function (t) {
                        e(t.currentTarget).removeClass("ui-state-focus")
                    }
                })
            },
            _trigger: function (t, i, n) {
                var s, r, a = this.options[t];
                if (n = n || {}, i = e.Event(i), i.type = (t === this.widgetEventPrefix ? t : this.widgetEventPrefix + t).toLowerCase(), i.target = this.element[0], r = i.originalEvent)for (s in r)s in i || (i[s] = r[s]);
                return this.element.trigger(i, n), !(e.isFunction(a) && a.apply(this.element[0], [i].concat(n)) === !1 || i.isDefaultPrevented())
            }
        }, e.each({show: "fadeIn", hide: "fadeOut"}, function (t, i) {
            e.Widget.prototype["_" + t] = function (n, s, r) {
                "string" == typeof s && (s = {effect: s});
                var a, o = s ? s === !0 || "number" == typeof s ? i : s.effect || i : t;
                s = s || {}, "number" == typeof s && (s = {duration: s}), a = !e.isEmptyObject(s), s.complete = r, s.delay && n.delay(s.delay), a && e.effects && e.effects.effect[o] ? n[t](s) : o !== t && n[o] ? n[o](s.duration, s.easing, r) : n.queue(function (i) {
                    e(this)[t](), r && r.call(n[0]), i()
                })
            }
        })
    }), /*
 * jQuery Iframe Transport Plugin 1.6.1
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2011, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */
    function (e) {
        "use strict";
        "function" == typeof define && define.amd ? define(["jquery"], e) : e(window.jQuery)
    }(function (e) {
        "use strict";
        var t = 0;
        e.ajaxTransport("iframe", function (i) {
            if (i.async) {
                var n, s, r;
                return {
                    send: function (a, o) {
                        n = e('<form style="display:none;"></form>'), n.attr("accept-charset", i.formAcceptCharset), r = /\?/.test(i.url) ? "&" : "?", "DELETE" === i.type ? (i.url = i.url + r + "_method=DELETE", i.type = "POST") : "PUT" === i.type ? (i.url = i.url + r + "_method=PUT", i.type = "POST") : "PATCH" === i.type && (i.url = i.url + r + "_method=PATCH", i.type = "POST"), s = e('<iframe src="javascript:false;" name="iframe-transport-' + (t += 1) + '"></iframe>').bind("load", function () {
                            var t, r = e.isArray(i.paramName) ? i.paramName : [i.paramName];
                            s.unbind("load").bind("load", function () {
                                var t;
                                try {
                                    if (t = s.contents(), !t.length || !t[0].firstChild)throw new Error
                                } catch (i) {
                                    t = void 0
                                }
                                o(200, "success", {iframe: t}), e('<iframe src="javascript:false;"></iframe>').appendTo(n), n.remove()
                            }), n.prop("target", s.prop("name")).prop("action", i.url).prop("method", i.type), i.formData && e.each(i.formData, function (t, i) {
                                e('<input type="hidden"/>').prop("name", i.name).val(i.value).appendTo(n)
                            }), i.fileInput && i.fileInput.length && "POST" === i.type && (t = i.fileInput.clone(), i.fileInput.after(function (e) {
                                return t[e]
                            }), i.paramName && i.fileInput.each(function (t) {
                                e(this).prop("name", r[t] || i.paramName)
                            }), n.append(i.fileInput).prop("enctype", "multipart/form-data").prop("encoding", "multipart/form-data")), n.submit(), t && t.length && i.fileInput.each(function (i, n) {
                                var s = e(t[i]);
                                e(n).prop("name", s.prop("name")), s.replaceWith(n)
                            })
                        }), n.append(s).appendTo(document.body)
                    }, abort: function () {
                        s && s.unbind("load").prop("src", "javascript".concat(":false;")), n && n.remove()
                    }
                }
            }
        }), e.ajaxSetup({
            converters: {
                "iframe text": function (t) {
                    return t && e(t[0].body).text()
                }, "iframe json": function (t) {
                    return t && e.parseJSON(e(t[0].body).text())
                }, "iframe html": function (t) {
                    return t && e(t[0].body).html()
                }, "iframe script": function (t) {
                    return t && e.globalEval(e(t[0].body).text())
                }
            }
        })
    }), /*
 * jQuery File Upload Plugin 5.21
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2010, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */
    function (e) {
        "use strict";
        "function" == typeof define && define.amd ? define(["jquery", "jquery.ui.widget"], e) : e(window.jQuery)
    }(function (e) {
        "use strict";
        e.support.xhrFileUpload = !(!window.XMLHttpRequestUpload || !window.FileReader), e.support.xhrFormDataFileUpload = !!window.FormData, e.propHooks.elements = {
            get: function (t) {
                return e.nodeName(t, "form") ? e.grep(t.elements, function (t) {
                    return !e.nodeName(t, "input") || "file" !== t.type
                }) : null
            }
        }, e.widget("blueimp.fileupload", {
            options: {
                dropZone: e(document),
                pasteZone: e(document),
                fileInput: void 0,
                replaceFileInput: !0,
                paramName: void 0,
                singleFileUploads: !0,
                limitMultiFileUploads: void 0,
                sequentialUploads: !1,
                limitConcurrentUploads: void 0,
                forceIframeTransport: !1,
                redirect: void 0,
                redirectParamName: void 0,
                postMessage: void 0,
                multipart: !0,
                maxChunkSize: void 0,
                uploadedBytes: void 0,
                recalculateProgress: !0,
                progressInterval: 100,
                bitrateInterval: 500,
                formData: function (e) {
                    return e.serializeArray()
                },
                add: function (e, t) {
                    t.submit()
                },
                processData: !1,
                contentType: !1,
                cache: !1
            },
            _refreshOptionsList: ["fileInput", "dropZone", "pasteZone", "multipart", "forceIframeTransport"],
            _BitrateTimer: function () {
                this.timestamp = +new Date, this.loaded = 0, this.bitrate = 0, this.getBitrate = function (e, t, i) {
                    var n = e - this.timestamp;
                    return (!this.bitrate || !i || n > i) && (this.bitrate = 8 * (t - this.loaded) * (1e3 / n), this.loaded = t, this.timestamp = e), this.bitrate
                }
            },
            _isXHRUpload: function (t) {
                return !t.forceIframeTransport && (!t.multipart && e.support.xhrFileUpload || e.support.xhrFormDataFileUpload)
            },
            _getFormData: function (t) {
                var i;
                return "function" == typeof t.formData ? t.formData(t.form) : e.isArray(t.formData) ? t.formData : t.formData ? (i = [], e.each(t.formData, function (e, t) {
                    i.push({name: e, value: t})
                }), i) : []
            },
            _getTotal: function (t) {
                var i = 0;
                return e.each(t, function (e, t) {
                    i += t.size || 1
                }), i
            },
            _onProgress: function (e, t) {
                if (e.lengthComputable) {
                    var i, n, s = +new Date;
                    if (t._time && t.progressInterval && s - t._time < t.progressInterval && e.loaded !== e.total)return;
                    t._time = s, i = t.total || this._getTotal(t.files), n = parseInt(e.loaded / e.total * (t.chunkSize || i), 10) + (t.uploadedBytes || 0), this._loaded += n - (t.loaded || t.uploadedBytes || 0), t.lengthComputable = !0, t.loaded = n, t.total = i, t.bitrate = t._bitrateTimer.getBitrate(s, n, t.bitrateInterval), this._trigger("progress", e, t), this._trigger("progressall", e, {
                        lengthComputable: !0,
                        loaded: this._loaded,
                        total: this._total,
                        bitrate: this._bitrateTimer.getBitrate(s, this._loaded, t.bitrateInterval)
                    })
                }
            },
            _initProgressListener: function (t) {
                var i = this, n = t.xhr ? t.xhr() : e.ajaxSettings.xhr();
                n.upload && (e(n.upload).bind("progress", function (e) {
                    var n = e.originalEvent;
                    e.lengthComputable = n.lengthComputable, e.loaded = n.loaded, e.total = n.total, i._onProgress(e, t)
                }), t.xhr = function () {
                    return n
                })
            },
            _initXHRData: function (t) {
                var i, n = t.files[0], s = t.multipart || !e.support.xhrFileUpload, r = t.paramName[0];
                t.headers = t.headers || {}, t.contentRange && (t.headers["Content-Range"] = t.contentRange), s ? e.support.xhrFormDataFileUpload && (t.postMessage ? (i = this._getFormData(t), t.blob ? i.push({
                    name: r,
                    value: t.blob
                }) : e.each(t.files, function (e, n) {
                    i.push({name: t.paramName[e] || r, value: n})
                })) : (t.formData instanceof FormData ? i = t.formData : (i = new FormData, e.each(this._getFormData(t), function (e, t) {
                    i.append(t.name, t.value)
                })), t.blob ? (t.headers["Content-Disposition"] = 'attachment; filename="' + encodeURI(n.name) + '"', i.append(r, t.blob, n.name)) : e.each(t.files, function (e, n) {
                    (window.Blob && n instanceof Blob || window.File && n instanceof File) && i.append(t.paramName[e] || r, n, n.name)
                })), t.data = i) : (t.headers["Content-Disposition"] = 'attachment; filename="' + encodeURI(n.name) + '"', t.contentType = n.type, t.data = t.blob || n), t.blob = null
            },
            _initIframeSettings: function (t) {
                t.dataType = "iframe " + (t.dataType || ""), t.formData = this._getFormData(t), t.redirect && e("<a></a>").prop("href", t.url).prop("host") !== location.host && t.formData.push({
                    name: t.redirectParamName || "redirect",
                    value: t.redirect
                })
            },
            _initDataSettings: function (e) {
                this._isXHRUpload(e) ? (this._chunkedUpload(e, !0) || (e.data || this._initXHRData(e), this._initProgressListener(e)), e.postMessage && (e.dataType = "postmessage " + (e.dataType || ""))) : this._initIframeSettings(e, "iframe")
            },
            _getParamName: function (t) {
                var i = e(t.fileInput), n = t.paramName;
                return n ? e.isArray(n) || (n = [n]) : (n = [], i.each(function () {
                    for (var t = e(this), i = t.prop("name") || "files[]", s = (t.prop("files") || [1]).length; s;)n.push(i), s -= 1
                }), n.length || (n = [i.prop("name") || "files[]"])), n
            },
            _initFormSettings: function (t) {
                t.form && t.form.length || (t.form = e(t.fileInput.prop("form")), t.form.length || (t.form = e(this.options.fileInput.prop("form")))), t.paramName = this._getParamName(t), t.url || (t.url = t.form.prop("action") || location.href), t.type = (t.type || t.form.prop("method") || "").toUpperCase(), "POST" !== t.type && "PUT" !== t.type && "PATCH" !== t.type && (t.type = "POST"), t.formAcceptCharset || (t.formAcceptCharset = t.form.attr("accept-charset"))
            },
            _getAJAXSettings: function (t) {
                var i = e.extend({}, this.options, t);
                return this._initFormSettings(i), this._initDataSettings(i), i
            },
            _enhancePromise: function (e) {
                return e.success = e.done, e.error = e.fail, e.complete = e.always, e
            },
            _getXHRPromise: function (t, i, n) {
                var s = e.Deferred(), r = s.promise();
                return i = i || this.options.context || r, t === !0 ? s.resolveWith(i, n) : t === !1 && s.rejectWith(i, n), r.abort = s.promise, this._enhancePromise(r)
            },
            _getUploadedBytes: function (e) {
                var t = e.getResponseHeader("Range"), i = t && t.split("-"), n = i && i.length > 1 && parseInt(i[1], 10);
                return n && n + 1
            },
            _chunkedUpload: function (t, i) {
                var n, s, r = this, a = t.files[0], o = a.size, l = t.uploadedBytes = t.uploadedBytes || 0, h = t.maxChunkSize || o, u = a.slice || a.webkitSlice || a.mozSlice, c = e.Deferred(), p = c.promise();
                return this._isXHRUpload(t) && u && (l || o > h) && !t.data ? i ? !0 : l >= o ? (a.error = "Uploaded bytes exceed file size", this._getXHRPromise(!1, t.context, [null, "error", a.error])) : (s = function () {
                    var i = e.extend({}, t);
                    i.blob = u.call(a, l, l + h, a.type), i.chunkSize = i.blob.size, i.contentRange = "bytes " + l + "-" + (l + i.chunkSize - 1) + "/" + o, r._initXHRData(i), r._initProgressListener(i), n = (r._trigger("chunksend", null, i) !== !1 && e.ajax(i) || r._getXHRPromise(!1, i.context)).done(function (n, a, h) {
                        l = r._getUploadedBytes(h) || l + i.chunkSize, (!i.loaded || i.loaded < i.total) && r._onProgress(e.Event("progress", {
                            lengthComputable: !0,
                            loaded: l - i.uploadedBytes,
                            total: l - i.uploadedBytes
                        }), i), t.uploadedBytes = i.uploadedBytes = l, i.result = n, i.textStatus = a, i.jqXHR = h, r._trigger("chunkdone", null, i), r._trigger("chunkalways", null, i), o > l ? s() : c.resolveWith(i.context, [n, a, h])
                    }).fail(function (e, t, n) {
                        i.jqXHR = e, i.textStatus = t, i.errorThrown = n, r._trigger("chunkfail", null, i), r._trigger("chunkalways", null, i), c.rejectWith(i.context, [e, t, n])
                    })
                }, this._enhancePromise(p), p.abort = function () {
                    return n.abort()
                }, s(), p) : !1
            },
            _beforeSend: function (e, t) {
                0 === this._active && (this._trigger("start"), this._bitrateTimer = new this._BitrateTimer), this._active += 1, this._loaded += t.uploadedBytes || 0, this._total += this._getTotal(t.files)
            },
            _onDone: function (t, i, n, s) {
                if (!this._isXHRUpload(s) || !s.loaded || s.loaded < s.total) {
                    var r = this._getTotal(s.files) || 1;
                    this._onProgress(e.Event("progress", {lengthComputable: !0, loaded: r, total: r}), s)
                }
                s.result = t, s.textStatus = i, s.jqXHR = n, this._trigger("done", null, s)
            },
            _onFail: function (e, t, i, n) {
                n.jqXHR = e, n.textStatus = t, n.errorThrown = i, this._trigger("fail", null, n), n.recalculateProgress && (this._loaded -= n.loaded || n.uploadedBytes || 0, this._total -= n.total || this._getTotal(n.files))
            },
            _onAlways: function (e, t, i, n) {
                this._active -= 1, this._trigger("always", null, n), 0 === this._active && (this._trigger("stop"), this._loaded = this._total = 0, this._bitrateTimer = null)
            },
            _onSend: function (t, i) {
                var n, s, r, a, o = this, l = o._getAJAXSettings(i), h = function () {
                    return o._sending += 1, l._bitrateTimer = new o._BitrateTimer, n = n || ((s || o._trigger("send", t, l) === !1) && o._getXHRPromise(!1, l.context, s) || o._chunkedUpload(l) || e.ajax(l)).done(function (e, t, i) {
                            o._onDone(e, t, i, l)
                        }).fail(function (e, t, i) {
                            o._onFail(e, t, i, l)
                        }).always(function (e, t, i) {
                            if (o._sending -= 1, o._onAlways(e, t, i, l), l.limitConcurrentUploads && l.limitConcurrentUploads > o._sending)for (var n, s = o._slots.shift(); s;) {
                                if (n = s.state ? "pending" === s.state() : !s.isRejected()) {
                                    s.resolve();
                                    break
                                }
                                s = o._slots.shift()
                            }
                        })
                };
                return this._beforeSend(t, l), this.options.sequentialUploads || this.options.limitConcurrentUploads && this.options.limitConcurrentUploads <= this._sending ? (this.options.limitConcurrentUploads > 1 ? (r = e.Deferred(), this._slots.push(r), a = r.pipe(h)) : a = this._sequence = this._sequence.pipe(h, h), a.abort = function () {
                    return s = [void 0, "abort", "abort"], n ? n.abort() : (r && r.rejectWith(l.context, s), h())
                }, this._enhancePromise(a)) : h()
            },
            _onAdd: function (t, i) {
                var n, s, r, a, o = this, l = !0, h = e.extend({}, this.options, i), u = h.limitMultiFileUploads, c = this._getParamName(h);
                if ((h.singleFileUploads || u) && this._isXHRUpload(h))if (!h.singleFileUploads && u)for (r = [], n = [], a = 0; a < i.files.length; a += u)r.push(i.files.slice(a, a + u)), s = c.slice(a, a + u), s.length || (s = c), n.push(s); else n = c; else r = [i.files], n = [c];
                return i.originalFiles = i.files, e.each(r || i.files, function (s, a) {
                    var h = e.extend({}, i);
                    return h.files = r ? a : [a], h.paramName = n[s], h.submit = function () {
                        return h.jqXHR = this.jqXHR = o._trigger("submit", t, this) !== !1 && o._onSend(t, this), this.jqXHR
                    }, l = o._trigger("add", t, h)
                }), l
            },
            _replaceFileInput: function (t) {
                var i = t.clone(!0);
                e("<form></form>").append(i)[0].reset(), t.after(i).detach(), e.cleanData(t.unbind("remove")), this.options.fileInput = this.options.fileInput.map(function (e, n) {
                    return n === t[0] ? i[0] : n
                }), t[0] === this.element[0] && (this.element = i)
            },
            _handleFileTreeEntry: function (t, i) {
                var n, s = this, r = e.Deferred(), a = function (e) {
                    e && !e.entry && (e.entry = t), r.resolve([e])
                };
                return i = i || "", t.isFile ? t._file ? (t._file.relativePath = i, r.resolve(t._file)) : t.file(function (e) {
                    e.relativePath = i, r.resolve(e)
                }, a) : t.isDirectory ? (n = t.createReader(), n.readEntries(function (e) {
                    s._handleFileTreeEntries(e, i + t.name + "/").done(function (e) {
                        r.resolve(e)
                    }).fail(a)
                }, a)) : r.resolve([]), r.promise()
            },
            _handleFileTreeEntries: function (t, i) {
                var n = this;
                return e.when.apply(e, e.map(t, function (e) {
                    return n._handleFileTreeEntry(e, i)
                })).pipe(function () {
                    return Array.prototype.concat.apply([], arguments)
                })
            },
            _getDroppedFiles: function (t) {
                t = t || {};
                var i = t.items;
                return i && i.length && (i[0].webkitGetAsEntry || i[0].getAsEntry) ? this._handleFileTreeEntries(e.map(i, function (e) {
                    var t;
                    return e.webkitGetAsEntry ? (t = e.webkitGetAsEntry(), t && (t._file = e.getAsFile()), t) : e.getAsEntry()
                })) : e.Deferred().resolve(e.makeArray(t.files)).promise()
            },
            _getSingleFileInputFiles: function (t) {
                t = e(t);
                var i, n, s = t.prop("webkitEntries") || t.prop("entries");
                if (s && s.length)return this._handleFileTreeEntries(s);
                if (i = e.makeArray(t.prop("files")), i.length) void 0 === i[0].name && i[0].fileName && e.each(i, function (e, t) {
                    t.name = t.fileName, t.size = t.fileSize
                }); else {
                    if (n = t.prop("value"), !n)return e.Deferred().resolve([]).promise();
                    i = [{name: n.replace(/^.*\\/, "")}]
                }
                return e.Deferred().resolve(i).promise()
            },
            _getFileInputFiles: function (t) {
                return t instanceof e && 1 !== t.length ? e.when.apply(e, e.map(t, this._getSingleFileInputFiles)).pipe(function () {
                    return Array.prototype.concat.apply([], arguments)
                }) : this._getSingleFileInputFiles(t)
            },
            _onChange: function (t) {
                var i = this, n = {fileInput: e(t.target), form: e(t.target.form)};
                this._getFileInputFiles(n.fileInput).always(function (e) {
                    n.files = e, i.options.replaceFileInput && i._replaceFileInput(n.fileInput), i._trigger("change", t, n) !== !1 && i._onAdd(t, n)
                })
            },
            _onPaste: function (t) {
                var i = t.originalEvent.clipboardData, n = i && i.items || [], s = {files: []};
                return e.each(n, function (e, t) {
                    var i = t.getAsFile && t.getAsFile();
                    i && s.files.push(i)
                }), this._trigger("paste", t, s) === !1 || this._onAdd(t, s) === !1 ? !1 : void 0
            },
            _onDrop: function (e) {
                var t = this, i = e.dataTransfer = e.originalEvent.dataTransfer, n = {};
                i && i.files && i.files.length && e.preventDefault(), this._getDroppedFiles(i).always(function (i) {
                    n.files = i, t._trigger("drop", e, n) !== !1 && t._onAdd(e, n)
                })
            },
            _onDragOver: function (t) {
                var i = t.dataTransfer = t.originalEvent.dataTransfer;
                return this._trigger("dragover", t) === !1 ? !1 : (i && -1 !== e.inArray("Files", i.types) && (i.dropEffect = "copy", t.preventDefault()), void 0)
            },
            _initEventHandlers: function () {
                this._isXHRUpload(this.options) && (this._on(this.options.dropZone, {
                    dragover: this._onDragOver,
                    drop: this._onDrop
                }), this._on(this.options.pasteZone, {paste: this._onPaste})), this._on(this.options.fileInput, {change: this._onChange})
            },
            _destroyEventHandlers: function () {
                this._off(this.options.dropZone, "dragover drop"), this._off(this.options.pasteZone, "paste"), this._off(this.options.fileInput, "change")
            },
            _setOption: function (t, i) {
                var n = -1 !== e.inArray(t, this._refreshOptionsList);
                n && this._destroyEventHandlers(), this._super(t, i), n && (this._initSpecialOptions(), this._initEventHandlers())
            },
            _initSpecialOptions: function () {
                var t = this.options;
                void 0 === t.fileInput ? t.fileInput = this.element.is('input[type="file"]') ? this.element : this.element.find('input[type="file"]') : t.fileInput instanceof e || (t.fileInput = e(t.fileInput)), t.dropZone instanceof e || (t.dropZone = e(t.dropZone)), t.pasteZone instanceof e || (t.pasteZone = e(t.pasteZone))
            },
            _create: function () {
                var t = this.options;
                e.extend(t, e(this.element[0].cloneNode(!1)).data()), this._initSpecialOptions(), this._slots = [], this._sequence = this._getXHRPromise(!0), this._sending = this._active = this._loaded = this._total = 0, this._initEventHandlers()
            },
            _destroy: function () {
                this._destroyEventHandlers()
            },
            add: function (t) {
                var i = this;
                t && !this.options.disabled && (t.fileInput && !t.files ? this._getFileInputFiles(t.fileInput).always(function (e) {
                    t.files = e, i._onAdd(null, t)
                }) : (t.files = e.makeArray(t.files), this._onAdd(null, t)))
            },
            send: function (t) {
                if (t && !this.options.disabled) {
                    if (t.fileInput && !t.files) {
                        var i, n, s = this, r = e.Deferred(), a = r.promise();
                        return a.abort = function () {
                            return n = !0, i ? i.abort() : (r.reject(null, "abort", "abort"), a)
                        }, this._getFileInputFiles(t.fileInput).always(function (e) {
                            n || (t.files = e, i = s._onSend(null, t).then(function (e, t, i) {
                                r.resolve(e, t, i)
                            }, function (e, t, i) {
                                r.reject(e, t, i)
                            }))
                        }), this._enhancePromise(a)
                    }
                    if (t.files = e.makeArray(t.files), t.files.length)return this._onSend(null, t)
                }
                return this._getXHRPromise(!1, t && t.context)
            }
        })
    }), /*
 * JavaScript Templates 2.1.0
 * https://github.com/blueimp/JavaScript-Templates
 *
 * Copyright 2011, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 *
 * Inspired by John Resig's JavaScript Micro-Templating:
 * http://ejohn.org/blog/javascript-micro-templating/
 */
    function (e) {
        "use strict";
        var t = function (e, i) {
            var n = /[^\w\-\.:]/.test(e) ? new Function(t.arg + ",tmpl", "var _e=tmpl.encode" + t.helper + ",_s='" + e.replace(t.regexp, t.func) + "';return _s;") : t.cache[e] = t.cache[e] || t(t.load(e));
            return i ? n(i, t) : function (e) {
                return n(e, t)
            }
        };
        t.cache = {}, t.load = function (e) {
            return document.getElementById(e).innerHTML
        }, t.regexp = /([\s'\\])(?![^%]*%\})|(?:\{%(=|#)([\s\S]+?)%\})|(\{%)|(%\})/g, t.func = function (e, t, i, n, s, r) {
            return t ? {
                "\n": "\\n",
                "\r": "\\r",
                "	": "\\t",
                " ": " "
            }[e] || "\\" + e : i ? "=" === i ? "'+_e(" + n + ")+'" : "'+(" + n + "||'')+'" : s ? "';" : r ? "_s+='" : void 0
        }, t.encReg = /[<>&"'\x00]/g, t.encMap = {
            "<": "&lt;",
            ">": "&gt;",
            "&": "&amp;",
            '"': "&quot;",
            "'": "&#39;"
        }, t.encode = function (e) {
            return String(e || "").replace(t.encReg, function (e) {
                return t.encMap[e] || ""
            })
        }, t.arg = "o", t.helper = ",print=function(s,e){_s+=e&&(s||'')||_e(s);},include=function(s,d){_s+=tmpl(s,d);}", "function" == typeof define && define.amd ? define(function () {
            return t
        }) : e.tmpl = t
    }(this), function (e) {
    "use strict";
    var t = {
        i18n: {
            ar: {
                months: ["كانون الثاني", "شباط", "آذار", "نيسان", "مايو", "حزيران", "تموز", "آب", "أيلول", "تشرين الأول", "تشرين الثاني", "كانون الأول"],
                dayOfWeek: ["ن", "ث", "ع", "خ", "ج", "س", "ح"]
            },
            ro: {
                months: ["ianuarie", "februarie", "martie", "aprilie", "mai", "iunie", "iulie", "august", "septembrie", "octombrie", "noiembrie", "decembrie"],
                dayOfWeek: ["l", "ma", "mi", "j", "v", "s", "d"]
            },
            id: {
                months: ["Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "November", "Desember"],
                dayOfWeek: ["Sen", "Sel", "Rab", "Kam", "Jum", "Sab", "Min"]
            },
            bg: {
                months: ["Януари", "Февруари", "Март", "Април", "Май", "Юни", "Юли", "Август", "Септември", "Октомври", "Ноември", "Декември"],
                dayOfWeek: ["Нд", "Пн", "Вт", "Ср", "Чт", "Пт", "Сб"]
            },
            fa: {
                months: ["فروردین", "اردیبهشت", "خرداد", "تیر", "مرداد", "شهریور", "مهر", "آبان", "آذر", "دی", "بهمن", "اسفند"],
                dayOfWeek: ["یکشنبه", "دوشنبه", "سه شنبه", "چهارشنبه", "پنجشنبه", "جمعه", "شنبه"]
            },
            ru: {
                months: ["Январь", "Февраль", "Март", "Апрель", "Май", "Июнь", "Июль", "Август", "Сентябрь", "Октябрь", "Ноябрь", "Декабрь"],
                dayOfWeek: ["Вск", "Пн", "Вт", "Ср", "Чт", "Пт", "Сб"]
            },
            uk: {
                months: ["Січень", "Лютий", "Березень", "Квітень", "Травень", "Червень", "Липень", "Серпень", "Вересень", "Жовтень", "Листопад", "Грудень"],
                dayOfWeek: ["Ндл", "Пнд", "Втр", "Срд", "Чтв", "Птн", "Сбт"]
            },
            en: {
                months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
                dayOfWeek: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]
            },
            el: {
                months: ["Ιανουάριος", "Φεβρουάριος", "Μάρτιος", "Απρίλιος", "Μάιος", "Ιούνιος", "Ιούλιος", "Αύγουστος", "Σεπτέμβριος", "Οκτώβριος", "Νοέμβριος", "Δεκέμβριος"],
                dayOfWeek: ["Κυρ", "Δευ", "Τρι", "Τετ", "Πεμ", "Παρ", "Σαβ"]
            },
            de: {
                months: ["Januar", "Februar", "März", "April", "Mai", "Juni", "Juli", "August", "September", "Oktober", "November", "Dezember"],
                dayOfWeek: ["So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"]
            },
            nl: {
                months: ["januari", "februari", "maart", "april", "mei", "juni", "juli", "augustus", "september", "oktober", "november", "december"],
                dayOfWeek: ["zo", "ma", "di", "wo", "do", "vr", "za"]
            },
            tr: {
                months: ["Ocak", "Şubat", "Mart", "Nisan", "Mayıs", "Haziran", "Temmuz", "Ağustos", "Eylül", "Ekim", "Kasım", "Aralık"],
                dayOfWeek: ["Paz", "Pts", "Sal", "Çar", "Per", "Cum", "Cts"]
            },
            fr: {
                months: ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Décembre"],
                dayOfWeek: ["Dim", "Lun", "Mar", "Mer", "Jeu", "Ven", "Sam"]
            },
            es: {
                months: ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
                dayOfWeek: ["Dom", "Lun", "Mar", "Mié", "Jue", "Vie", "Sáb"]
            },
            th: {
                months: ["มกราคม", "กุมภาพันธ์", "มีนาคม", "เมษายน", "พฤษภาคม", "มิถุนายน", "กรกฎาคม", "สิงหาคม", "กันยายน", "ตุลาคม", "พฤศจิกายน", "ธันวาคม"],
                dayOfWeek: ["อา.", "จ.", "อ.", "พ.", "พฤ.", "ศ.", "ส."]
            },
            pl: {
                months: ["styczeń", "luty", "marzec", "kwiecień", "maj", "czerwiec", "lipiec", "sierpień", "wrzesień", "październik", "listopad", "grudzień"],
                dayOfWeek: ["nd", "pn", "wt", "śr", "cz", "pt", "sb"]
            },
            pt: {
                months: ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"],
                dayOfWeek: ["Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sab"]
            },
            ch: {
                months: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],
                dayOfWeek: ["日", "一", "二", "三", "四", "五", "六"]
            },
            se: {
                months: ["Januari", "Februari", "Mars", "April", "Maj", "Juni", "Juli", "Augusti", "September", "Oktober", "November", "December"],
                dayOfWeek: ["Sön", "Mån", "Tis", "Ons", "Tor", "Fre", "Lör"]
            },
            kr: {
                months: ["1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월"],
                dayOfWeek: ["일", "월", "화", "수", "목", "금", "토"]
            },
            it: {
                months: ["Gennaio", "Febbraio", "Marzo", "Aprile", "Maggio", "Giugno", "Luglio", "Agosto", "Settembre", "Ottobre", "Novembre", "Dicembre"],
                dayOfWeek: ["Dom", "Lun", "Mar", "Mer", "Gio", "Ven", "Sab"]
            },
            da: {
                months: ["January", "Februar", "Marts", "April", "Maj", "Juni", "July", "August", "September", "Oktober", "November", "December"],
                dayOfWeek: ["Søn", "Man", "Tir", "Ons", "Tor", "Fre", "Lør"]
            },
            no: {
                months: ["Januar", "Februar", "Mars", "April", "Mai", "Juni", "Juli", "August", "September", "Oktober", "November", "Desember"],
                dayOfWeek: ["Søn", "Man", "Tir", "Ons", "Tor", "Fre", "Lør"]
            },
            ja: {
                months: ["1月", "2月", "3月", "4月", "5月", "6月", "7月", "8月", "9月", "10月", "11月", "12月"],
                dayOfWeek: ["日", "月", "火", "水", "木", "金", "土"]
            },
            vi: {
                months: ["Tháng 1", "Tháng 2", "Tháng 3", "Tháng 4", "Tháng 5", "Tháng 6", "Tháng 7", "Tháng 8", "Tháng 9", "Tháng 10", "Tháng 11", "Tháng 12"],
                dayOfWeek: ["CN", "T2", "T3", "T4", "T5", "T6", "T7"]
            },
            sl: {
                months: ["Januar", "Februar", "Marec", "April", "Maj", "Junij", "Julij", "Avgust", "September", "Oktober", "November", "December"],
                dayOfWeek: ["Ned", "Pon", "Tor", "Sre", "Čet", "Pet", "Sob"]
            },
            cs: {
                months: ["Leden", "Únor", "Březen", "Duben", "Květen", "Červen", "Červenec", "Srpen", "Září", "Říjen", "Listopad", "Prosinec"],
                dayOfWeek: ["Ne", "Po", "Út", "St", "Čt", "Pá", "So"]
            },
            hu: {
                months: ["Január", "Február", "Március", "Április", "Május", "Június", "Július", "Augusztus", "Szeptember", "Október", "November", "December"],
                dayOfWeek: ["Va", "Hé", "Ke", "Sze", "Cs", "Pé", "Szo"]
            },
            az: {
                months: ["Yanvar", "Fevral", "Mart", "Aprel", "May", "Iyun", "Iyul", "Avqust", "Sentyabr", "Oktyabr", "Noyabr", "Dekabr"],
                dayOfWeek: ["B", "Be", "Ça", "Ç", "Ca", "C", "Ş"]
            },
            bs: {
                months: ["Januar", "Februar", "Mart", "April", "Maj", "Jun", "Jul", "Avgust", "Septembar", "Oktobar", "Novembar", "Decembar"],
                dayOfWeek: ["Ned", "Pon", "Uto", "Sri", "Čet", "Pet", "Sub"]
            },
            ca: {
                months: ["Gener", "Febrer", "Març", "Abril", "Maig", "Juny", "Juliol", "Agost", "Setembre", "Octubre", "Novembre", "Desembre"],
                dayOfWeek: ["Dg", "Dl", "Dt", "Dc", "Dj", "Dv", "Ds"]
            },
            "en-GB": {
                months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
                dayOfWeek: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]
            },
            et: {
                months: ["Jaanuar", "Veebruar", "Märts", "Aprill", "Mai", "Juuni", "Juuli", "August", "September", "Oktoober", "November", "Detsember"],
                dayOfWeek: ["P", "E", "T", "K", "N", "R", "L"]
            },
            eu: {
                months: ["Urtarrila", "Otsaila", "Martxoa", "Apirila", "Maiatza", "Ekaina", "Uztaila", "Abuztua", "Iraila", "Urria", "Azaroa", "Abendua"],
                dayOfWeek: ["Ig.", "Al.", "Ar.", "Az.", "Og.", "Or.", "La."]
            },
            fi: {
                months: ["Tammikuu", "Helmikuu", "Maaliskuu", "Huhtikuu", "Toukokuu", "Kesäkuu", "Heinäkuu", "Elokuu", "Syyskuu", "Lokakuu", "Marraskuu", "Joulukuu"],
                dayOfWeek: ["Su", "Ma", "Ti", "Ke", "To", "Pe", "La"]
            },
            gl: {
                months: ["Xan", "Feb", "Maz", "Abr", "Mai", "Xun", "Xul", "Ago", "Set", "Out", "Nov", "Dec"],
                dayOfWeek: ["Dom", "Lun", "Mar", "Mer", "Xov", "Ven", "Sab"]
            },
            hr: {
                months: ["Siječanj", "Veljača", "Ožujak", "Travanj", "Svibanj", "Lipanj", "Srpanj", "Kolovoz", "Rujan", "Listopad", "Studeni", "Prosinac"],
                dayOfWeek: ["Ned", "Pon", "Uto", "Sri", "Čet", "Pet", "Sub"]
            },
            ko: {
                months: ["1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월"],
                dayOfWeek: ["일", "월", "화", "수", "목", "금", "토"]
            },
            lt: {
                months: ["Sausio", "Vasario", "Kovo", "Balandžio", "Gegužės", "Birželio", "Liepos", "Rugpjūčio", "Rugsėjo", "Spalio", "Lapkričio", "Gruodžio"],
                dayOfWeek: ["Sek", "Pir", "Ant", "Tre", "Ket", "Pen", "Šeš"]
            },
            lv: {
                months: ["Janvāris", "Februāris", "Marts", "Aprīlis ", "Maijs", "Jūnijs", "Jūlijs", "Augusts", "Septembris", "Oktobris", "Novembris", "Decembris"],
                dayOfWeek: ["Sv", "Pr", "Ot", "Tr", "Ct", "Pk", "St"]
            },
            mk: {
                months: ["јануари", "февруари", "март", "април", "мај", "јуни", "јули", "август", "септември", "октомври", "ноември", "декември"],
                dayOfWeek: ["нед", "пон", "вто", "сре", "чет", "пет", "саб"]
            },
            mn: {
                months: ["1-р сар", "2-р сар", "3-р сар", "4-р сар", "5-р сар", "6-р сар", "7-р сар", "8-р сар", "9-р сар", "10-р сар", "11-р сар", "12-р сар"],
                dayOfWeek: ["Дав", "Мяг", "Лха", "Пүр", "Бсн", "Бям", "Ням"]
            },
            "pt-BR": {
                months: ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"],
                dayOfWeek: ["Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sáb"]
            },
            sk: {
                months: ["Január", "Február", "Marec", "Apríl", "Máj", "Jún", "Júl", "August", "September", "Október", "November", "December"],
                dayOfWeek: ["Ne", "Po", "Ut", "St", "Št", "Pi", "So"]
            },
            sq: {
                months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
                dayOfWeek: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]
            },
            "sr-YU": {
                months: ["Januar", "Februar", "Mart", "April", "Maj", "Jun", "Jul", "Avgust", "Septembar", "Oktobar", "Novembar", "Decembar"],
                dayOfWeek: ["Ned", "Pon", "Uto", "Sre", "čet", "Pet", "Sub"]
            },
            sr: {
                months: ["јануар", "фебруар", "март", "април", "мај", "јун", "јул", "август", "септембар", "октобар", "новембар", "децембар"],
                dayOfWeek: ["нед", "пон", "уто", "сре", "чет", "пет", "суб"]
            },
            sv: {
                months: ["Januari", "Februari", "Mars", "April", "Maj", "Juni", "Juli", "Augusti", "September", "Oktober", "November", "December"],
                dayOfWeek: ["Sön", "Mån", "Tis", "Ons", "Tor", "Fre", "Lör"]
            },
            "zh-TW": {
                months: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],
                dayOfWeek: ["日", "一", "二", "三", "四", "五", "六"]
            },
            zh: {
                months: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],
                dayOfWeek: ["日", "一", "二", "三", "四", "五", "六"]
            },
            he: {
                months: ["ינואר", "פברואר", "מרץ", "אפריל", "מאי", "יוני", "יולי", "אוגוסט", "ספטמבר", "אוקטובר", "נובמבר", "דצמבר"],
                dayOfWeek: ["א'", "ב'", "ג'", "ד'", "ה'", "ו'", "שבת"]
            }
        },
        value: "",
        lang: "en",
        format: "Y/m/d H:i",
        formatTime: "H:i",
        formatDate: "Y/m/d",
        startDate: !1,
        step: 60,
        monthChangeSpinner: !0,
        closeOnDateSelect: !1,
        closeOnWithoutClick: !0,
        closeOnInputClick: !0,
        timepicker: !0,
        datepicker: !0,
        weeks: !1,
        defaultTime: !1,
        defaultDate: !1,
        minDate: !1,
        maxDate: !1,
        minTime: !1,
        maxTime: !1,
        allowTimes: [],
        opened: !1,
        initTime: !0,
        inline: !1,
        theme: "",
        onSelectDate: function () {
        },
        onSelectTime: function () {
        },
        onChangeMonth: function () {
        },
        onChangeYear: function () {
        },
        onChangeDateTime: function () {
        },
        onShow: function () {
        },
        onClose: function () {
        },
        onGenerate: function () {
        },
        withoutCopyright: !0,
        inverseButton: !1,
        hours12: !1,
        next: "xdsoft_next",
        prev: "xdsoft_prev",
        dayOfWeekStart: 0,
        parentID: "body",
        timeHeightInTimePicker: 25,
        timepickerScrollbar: !0,
        todayButton: !0,
        defaultSelect: !0,
        scrollMonth: !0,
        scrollTime: !0,
        scrollInput: !0,
        lazyInit: !1,
        mask: !1,
        validateOnBlur: !0,
        allowBlank: !0,
        yearStart: 1950,
        yearEnd: 2050,
        style: "",
        id: "",
        fixed: !1,
        roundTime: "round",
        className: "",
        weekends: [],
        disabledDates: [],
        yearOffset: 0,
        beforeShowDay: null,
        enterLikeTab: !0
    };
    Array.prototype.indexOf || (Array.prototype.indexOf = function (e, t) {
        var i, n;
        for (i = t || 0, n = this.length; n > i; i += 1)if (this[i] === e)return i;
        return -1
    }), Date.prototype.countDaysInMonth = function () {
        return new Date(this.getFullYear(), this.getMonth() + 1, 0).getDate()
    }, e.fn.xdsoftScroller = function (t) {
        return this.each(function () {
            var i, n, s, r, a, o = e(this), l = function (e) {
                var t, i = {x: 0, y: 0};
                return "touchstart" === e.type || "touchmove" === e.type || "touchend" === e.type || "touchcancel" === e.type ? (t = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0], i.x = t.clientX, i.y = t.clientY) : ("mousedown" === e.type || "mouseup" === e.type || "mousemove" === e.type || "mouseover" === e.type || "mouseout" === e.type || "mouseenter" === e.type || "mouseleave" === e.type) && (i.x = e.clientX, i.y = e.clientY), i
            }, h = 100, u = !1, c = 0, p = 0, d = 0, f = !1, m = 0, g = function () {
            };
            return "hide" === t ? (o.find(".xdsoft_scrollbar").hide(), void 0) : (e(this).hasClass("xdsoft_scroller_box") || (i = o.children().eq(0), n = o[0].clientHeight, s = i[0].offsetHeight, r = e('<div class="xdsoft_scrollbar"></div>'), a = e('<div class="xdsoft_scroller"></div>'), r.append(a), o.addClass("xdsoft_scroller_box").append(r), g = function (e) {
                var t = l(e).y - c + m;
                0 > t && (t = 0), t + a[0].offsetHeight > d && (t = d - a[0].offsetHeight), o.trigger("scroll_element.xdsoft_scroller", [h ? t / h : 0])
            }, a.on("touchstart.xdsoft_scroller mousedown.xdsoft_scroller", function (i) {
                n || o.trigger("resize_scroll.xdsoft_scroller", [t]), c = l(i).y, m = parseInt(a.css("margin-top"), 10), d = r[0].offsetHeight, "mousedown" === i.type ? (document && e(document.body).addClass("xdsoft_noselect"), e([document.body, window]).on("mouseup.xdsoft_scroller", function s() {
                    e([document.body, window]).off("mouseup.xdsoft_scroller", s).off("mousemove.xdsoft_scroller", g).removeClass("xdsoft_noselect")
                }), e(document.body).on("mousemove.xdsoft_scroller", g)) : (f = !0, i.stopPropagation(), i.preventDefault())
            }).on("touchmove", function (e) {
                f && (e.preventDefault(), g(e))
            }).on("touchend touchcancel", function () {
                f = !1, m = 0
            }), o.on("scroll_element.xdsoft_scroller", function (e, t) {
                n || o.trigger("resize_scroll.xdsoft_scroller", [t, !0]), t = t > 1 ? 1 : 0 > t || isNaN(t) ? 0 : t, a.css("margin-top", h * t), setTimeout(function () {
                    i.css("marginTop", -parseInt((i[0].offsetHeight - n) * t, 10))
                }, 10)
            }).on("resize_scroll.xdsoft_scroller", function (e, t, l) {
                var u, c;
                n = o[0].clientHeight, s = i[0].offsetHeight, u = n / s, c = u * r[0].offsetHeight, u > 1 ? a.hide() : (a.show(), a.css("height", parseInt(c > 10 ? c : 10, 10)), h = r[0].offsetHeight - a[0].offsetHeight, l !== !0 && o.trigger("scroll_element.xdsoft_scroller", [t || Math.abs(parseInt(i.css("marginTop"), 10)) / (s - n)]))
            }), o.on("mousewheel", function (e) {
                var t = Math.abs(parseInt(i.css("marginTop"), 10));
                return t -= 20 * e.deltaY, 0 > t && (t = 0), o.trigger("scroll_element.xdsoft_scroller", [t / (s - n)]), e.stopPropagation(), !1
            }), o.on("touchstart", function (e) {
                u = l(e), p = Math.abs(parseInt(i.css("marginTop"), 10))
            }), o.on("touchmove", function (e) {
                if (u) {
                    e.preventDefault();
                    var t = l(e);
                    o.trigger("scroll_element.xdsoft_scroller", [(p - (t.y - u.y)) / (s - n)])
                }
            }), o.on("touchend touchcancel", function () {
                u = !1, p = 0
            })), o.trigger("resize_scroll.xdsoft_scroller", [t]), void 0)
        })
    }, e.fn.datetimepicker = function (i) {
        var n, s, r, a = 48, o = 57, l = 96, h = 105, u = 17, c = 46, p = 13, d = 27, f = 8, m = 37, g = 38, y = 39, v = 40, b = 9, L = 116, w = 65, O = 67, C = 86, x = 90, S = 89, _ = !1, T = e.isPlainObject(i) || !i ? e.extend(!0, {}, t, i) : e.extend(!0, {}, t), E = 0, N = function (e) {
            e.on("open.xdsoft focusin.xdsoft mousedown.xdsoft", function t() {
                e.is(":disabled") || e.is(":hidden") || !e.is(":visible") || e.data("xdsoft_datetimepicker") || (clearTimeout(E), E = setTimeout(function () {
                    e.data("xdsoft_datetimepicker") || n(e), e.off("open.xdsoft focusin.xdsoft mousedown.xdsoft", t).trigger("open.xdsoft")
                }, 100))
            })
        };
        return n = function (t) {
            function n() {
                var e, i = !1;
                return T.startDate ? i = r.strToDate(T.startDate) : (i = T.value || (t && t.val && t.val() ? t.val() : ""), i ? i = r.strToDateTime(i) : T.defaultDate && (i = r.strToDate(T.defaultDate), T.defaultTime && (e = r.strtotime(T.defaultTime), i.setHours(e.getHours()), i.setMinutes(e.getMinutes())))), i && r.isValidDate(i) ? k.data("changed", !0) : i = "", i || 0
            }

            var s, E, N, P, M, k = e("<div " + (T.id ? 'id="' + T.id + '"' : "") + " " + (T.style ? 'style="' + T.style + '"' : "") + ' class="xdsoft_datetimepicker xdsoft_' + T.theme + " xdsoft_noselect " + (T.weeks ? " xdsoft_showweeks" : "") + T.className + '"></div>'), F = e('<div class="xdsoft_copyright"><a target="_blank" href="http://xdsoft.net/jqplugins/datetimepicker/">xdsoft.net</a></div>'), D = e('<div class="xdsoft_datepicker active"></div>'), A = e('<div class="xdsoft_mounthpicker"><button type="button" class="xdsoft_prev"></button><button type="button" class="xdsoft_today_button"></button><div class="xdsoft_label xdsoft_month"><span></span><i></i></div><div class="xdsoft_label xdsoft_year"><span></span><i></i></div><button type="button" class="xdsoft_next"></button></div>'), I = e('<div class="xdsoft_calendar"></div>'), R = e('<div class="xdsoft_timepicker active"><button type="button" class="xdsoft_prev"></button><div class="xdsoft_time_box"></div><button type="button" class="xdsoft_next"></button></div>'), z = R.find(".xdsoft_time_box").eq(0), B = e('<div class="xdsoft_time_variant"></div>'), U = e('<div class="xdsoft_select xdsoft_monthselect"><div></div></div>'), j = e('<div class="xdsoft_select xdsoft_yearselect"><div></div></div>'), H = !1, G = 0, $ = 0;
            A.find(".xdsoft_month span").after(U), A.find(".xdsoft_year span").after(j), A.find(".xdsoft_month,.xdsoft_year").on("mousedown.xdsoft", function (t) {
                var i, n, s = e(this).find(".xdsoft_select").eq(0), a = 0, o = 0, l = s.is(":visible");
                for (A.find(".xdsoft_select").hide(), r.currentTime && (a = r.currentTime[e(this).hasClass("xdsoft_month") ? "getMonth" : "getFullYear"]()), s[l ? "hide" : "show"](), i = s.find("div.xdsoft_option"), n = 0; n < i.length && i.eq(n).data("value") !== a; n += 1)o += i[0].offsetHeight;
                return s.xdsoftScroller(o / (s.children()[0].offsetHeight - s[0].clientHeight)), t.stopPropagation(), !1
            }), A.find(".xdsoft_select").xdsoftScroller().on("mousedown.xdsoft", function (e) {
                e.stopPropagation(), e.preventDefault()
            }).on("mousedown.xdsoft", ".xdsoft_option", function () {
                var t = r.currentTime.getFullYear();
                r && r.currentTime && r.currentTime[e(this).parent().parent().hasClass("xdsoft_monthselect") ? "setMonth" : "setFullYear"](e(this).data("value")), e(this).parent().parent().hide(), k.trigger("xchange.xdsoft"), T.onChangeMonth && e.isFunction(T.onChangeMonth) && T.onChangeMonth.call(k, r.currentTime, k.data("input")), t !== r.currentTime.getFullYear() && e.isFunction(T.onChangeYear) && T.onChangeYear.call(k, r.currentTime, k.data("input"))
            }), k.setOptions = function (i) {
                if (T = e.extend(!0, {}, T, i), i.allowTimes && e.isArray(i.allowTimes) && i.allowTimes.length && (T.allowTimes = e.extend(!0, [], i.allowTimes)), i.weekends && e.isArray(i.weekends) && i.weekends.length && (T.weekends = e.extend(!0, [], i.weekends)), i.disabledDates && e.isArray(i.disabledDates) && i.disabledDates.length && (T.disabledDates = e.extend(!0, [], i.disabledDates)), !T.open && !T.opened || T.inline || t.trigger("open.xdsoft"), T.inline && (H = !0, k.addClass("xdsoft_inline"), t.after(k).hide()), T.inverseButton && (T.next = "xdsoft_prev", T.prev = "xdsoft_next"), T.datepicker ? D.addClass("active") : D.removeClass("active"), T.timepicker ? R.addClass("active") : R.removeClass("active"), T.value && (t && t.val && t.val(T.value), r.setCurrentTime(T.value)), T.dayOfWeekStart = isNaN(T.dayOfWeekStart) ? 0 : parseInt(T.dayOfWeekStart, 10) % 7, T.timepickerScrollbar || z.xdsoftScroller("hide"), T.minDate && /^-(.*)$/.test(T.minDate) && (T.minDate = r.strToDateTime(T.minDate).dateFormat(T.formatDate)), T.maxDate && /^\+(.*)$/.test(T.maxDate) && (T.maxDate = r.strToDateTime(T.maxDate).dateFormat(T.formatDate)), A.find(".xdsoft_today_button").css("visibility", T.todayButton ? "visible" : "hidden"), T.mask) {
                    var n = function (e) {
                        try {
                            if (document.selection && document.selection.createRange) {
                                var t = document.selection.createRange();
                                return t.getBookmark().charCodeAt(2) - 2
                            }
                            if (e.setSelectionRange)return e.selectionStart
                        } catch (i) {
                            return 0
                        }
                    }, s = function (e, t) {
                        if (e = "string" == typeof e || e instanceof String ? document.getElementById(e) : e, !e)return !1;
                        if (e.createTextRange) {
                            var i = e.createTextRange();
                            return i.collapse(!0), i.moveEnd("character", t), i.moveStart("character", t), i.select(), !0
                        }
                        return e.setSelectionRange ? (e.setSelectionRange(t, t), !0) : !1
                    }, E = function (e, t) {
                        var i = e.replace(/([\[\]\/\{\}\(\)\-\.\+]{1})/g, "\\$1").replace(/_/g, "{digit+}").replace(/([0-9]{1})/g, "{digit$1}").replace(/\{digit([0-9]{1})\}/g, "[0-$1_]{1}").replace(/\{digit[\+]\}/g, "[0-9_]{1}");
                        return new RegExp(i).test(t)
                    };
                    t.off("keydown.xdsoft"), T.mask === !0 && (T.mask = T.format.replace(/Y/g, "9999").replace(/F/g, "9999").replace(/m/g, "19").replace(/d/g, "39").replace(/H/g, "29").replace(/i/g, "59").replace(/s/g, "59")), "string" === e.type(T.mask) && (E(T.mask, t.val()) || t.val(T.mask.replace(/[0-9]/g, "_")), t.on("keydown.xdsoft", function (i) {
                        var r, N, P = this.value, M = i.which;
                        if (M >= a && o >= M || M >= l && h >= M || M === f || M === c) {
                            for (r = n(this), N = M !== f && M !== c ? String.fromCharCode(M >= l && h >= M ? M - a : M) : "_", M !== f && M !== c || !r || (r -= 1, N = "_"); /[^0-9_]/.test(T.mask.substr(r, 1)) && r < T.mask.length && r > 0;)r += M === f || M === c ? -1 : 1;
                            if (P = P.substr(0, r) + N + P.substr(r + 1), "" === e.trim(P)) P = T.mask.replace(/[0-9]/g, "_"); else if (r === T.mask.length)return i.preventDefault(), !1;
                            for (r += M === f || M === c ? 0 : 1; /[^0-9_]/.test(T.mask.substr(r, 1)) && r < T.mask.length && r > 0;)r += M === f || M === c ? -1 : 1;
                            E(T.mask, P) ? (this.value = P, s(this, r)) : "" === e.trim(P) ? this.value = T.mask.replace(/[0-9]/g, "_") : t.trigger("error_input.xdsoft")
                        } else if (-1 !== [w, O, C, x, S].indexOf(M) && _ || -1 !== [d, g, v, m, y, L, u, b, p].indexOf(M))return !0;
                        return i.preventDefault(), !1
                    }))
                }
                T.validateOnBlur && t.off("blur.xdsoft").on("blur.xdsoft", function () {
                    T.allowBlank && !e.trim(e(this).val()).length ? (e(this).val(null), k.data("xdsoft_datetime").empty()) : Date.parseDate(e(this).val(), T.format) ? k.data("xdsoft_datetime").setCurrentTime(e(this).val()) : (e(this).val(r.now().dateFormat(T.format)), k.data("xdsoft_datetime").setCurrentTime(e(this).val())), k.trigger("changedatetime.xdsoft")
                }), T.dayOfWeekStartPrev = 0 === T.dayOfWeekStart ? 6 : T.dayOfWeekStart - 1, k.trigger("xchange.xdsoft").trigger("afterOpen.xdsoft")
            }, k.data("options", T).on("mousedown.xdsoft", function (e) {
                return e.stopPropagation(), e.preventDefault(), j.hide(), U.hide(), !1
            }), z.append(B), z.xdsoftScroller(), k.on("afterOpen.xdsoft", function () {
                z.xdsoftScroller()
            }), k.append(D).append(R), T.withoutCopyright !== !0 && k.append(F), D.append(A).append(I), e(T.parentID).append(k), s = function () {
                var t = this;
                t.now = function (e) {
                    var i, n, s = new Date;
                    return !e && T.defaultDate && (i = t.strToDate(T.defaultDate), s.setFullYear(i.getFullYear()), s.setMonth(i.getMonth()), s.setDate(i.getDate())), T.yearOffset && s.setFullYear(s.getFullYear() + T.yearOffset), !e && T.defaultTime && (n = t.strtotime(T.defaultTime), s.setHours(n.getHours()), s.setMinutes(n.getMinutes())), s
                }, t.isValidDate = function (e) {
                    return "[object Date]" !== Object.prototype.toString.call(e) ? !1 : !isNaN(e.getTime())
                }, t.setCurrentTime = function (e) {
                    t.currentTime = "string" == typeof e ? t.strToDateTime(e) : t.isValidDate(e) ? e : t.now(), k.trigger("xchange.xdsoft")
                }, t.empty = function () {
                    t.currentTime = null
                }, t.getCurrentTime = function () {
                    return t.currentTime
                }, t.nextMonth = function () {
                    var i, n = t.currentTime.getMonth() + 1;
                    return 12 === n && (t.currentTime.setFullYear(t.currentTime.getFullYear() + 1), n = 0), i = t.currentTime.getFullYear(), t.currentTime.setDate(Math.min(new Date(t.currentTime.getFullYear(), n + 1, 0).getDate(), t.currentTime.getDate())), t.currentTime.setMonth(n), T.onChangeMonth && e.isFunction(T.onChangeMonth) && T.onChangeMonth.call(k, r.currentTime, k.data("input")), i !== t.currentTime.getFullYear() && e.isFunction(T.onChangeYear) && T.onChangeYear.call(k, r.currentTime, k.data("input")), k.trigger("xchange.xdsoft"), n
                }, t.prevMonth = function () {
                    var i = t.currentTime.getMonth() - 1;
                    return -1 === i && (t.currentTime.setFullYear(t.currentTime.getFullYear() - 1), i = 11), t.currentTime.setDate(Math.min(new Date(t.currentTime.getFullYear(), i + 1, 0).getDate(), t.currentTime.getDate())), t.currentTime.setMonth(i), T.onChangeMonth && e.isFunction(T.onChangeMonth) && T.onChangeMonth.call(k, r.currentTime, k.data("input")), k.trigger("xchange.xdsoft"), i
                }, t.getWeekOfYear = function (e) {
                    var t = new Date(e.getFullYear(), 0, 1);
                    return Math.ceil(((e - t) / 864e5 + t.getDay() + 1) / 7)
                }, t.strToDateTime = function (e) {
                    var i, n, s = [];
                    return e && e instanceof Date && t.isValidDate(e) ? e : (s = /^(\+|\-)(.*)$/.exec(e), s && (s[2] = Date.parseDate(s[2], T.formatDate)), s && s[2] ? (i = s[2].getTime() - 6e4 * s[2].getTimezoneOffset(), n = new Date(r.now().getTime() + parseInt(s[1] + "1", 10) * i)) : n = e ? Date.parseDate(e, T.format) : t.now(), t.isValidDate(n) || (n = t.now()), n)
                }, t.strToDate = function (e) {
                    if (e && e instanceof Date && t.isValidDate(e))return e;
                    var i = e ? Date.parseDate(e, T.formatDate) : t.now(!0);
                    return t.isValidDate(i) || (i = t.now(!0)), i
                }, t.strtotime = function (e) {
                    if (e && e instanceof Date && t.isValidDate(e))return e;
                    var i = e ? Date.parseDate(e, T.formatTime) : t.now(!0);
                    return t.isValidDate(i) || (i = t.now(!0)), i
                }, t.str = function () {
                    return t.currentTime.dateFormat(T.format)
                }, t.currentTime = this.now()
            }, r = new s, A.find(".xdsoft_today_button").on("mousedown.xdsoft", function () {
                k.data("changed", !0), r.setCurrentTime(0), k.trigger("afterOpen.xdsoft")
            }).on("dblclick.xdsoft", function () {
                t.val(r.str()), k.trigger("close.xdsoft")
            }), A.find(".xdsoft_prev,.xdsoft_next").on("mousedown.xdsoft", function () {
                var t = e(this), i = 0, n = !1;
                !function s(e) {
                    r.currentTime.getMonth(), t.hasClass(T.next) ? r.nextMonth() : t.hasClass(T.prev) && r.prevMonth(), T.monthChangeSpinner && (n || (i = setTimeout(s, e || 100)))
                }(500), e([document.body, window]).on("mouseup.xdsoft", function a() {
                    clearTimeout(i), n = !0, e([document.body, window]).off("mouseup.xdsoft", a)
                })
            }), R.find(".xdsoft_prev,.xdsoft_next").on("mousedown.xdsoft", function () {
                var t = e(this), i = 0, n = !1, s = 110;
                !function r(e) {
                    var a = z[0].clientHeight, o = B[0].offsetHeight, l = Math.abs(parseInt(B.css("marginTop"), 10));
                    t.hasClass(T.next) && o - a - T.timeHeightInTimePicker >= l ? B.css("marginTop", "-" + (l + T.timeHeightInTimePicker) + "px") : t.hasClass(T.prev) && l - T.timeHeightInTimePicker >= 0 && B.css("marginTop", "-" + (l - T.timeHeightInTimePicker) + "px"), z.trigger("scroll_element.xdsoft_scroller", [Math.abs(parseInt(B.css("marginTop"), 10) / (o - a))]), s = s > 10 ? 10 : s - 10, n || (i = setTimeout(r, e || s))
                }(500), e([document.body, window]).on("mouseup.xdsoft", function a() {
                    clearTimeout(i), n = !0, e([document.body, window]).off("mouseup.xdsoft", a)
                })
            }), E = 0, k.on("xchange.xdsoft", function (t) {
                clearTimeout(E), E = setTimeout(function () {
                    for (var t, n, s, a, o, l, h, u = "", c = new Date(r.currentTime.getFullYear(), r.currentTime.getMonth(), 1, 12, 0, 0), p = 0, d = r.now(), f = !1, m = !1, g = [], y = !0, v = "", b = ""; c.getDay() !== T.dayOfWeekStart;)c.setDate(c.getDate() - 1);
                    for (u += "<table><thead><tr>", T.weeks && (u += "<th></th>"), t = 0; 7 > t; t += 1)u += "<th>" + T.i18n[T.lang].dayOfWeek[(t + T.dayOfWeekStart) % 7] + "</th>";
                    for (u += "</tr></thead>", u += "<tbody>", T.maxDate !== !1 && (f = r.strToDate(T.maxDate), f = new Date(f.getFullYear(), f.getMonth(), f.getDate(), 23, 59, 59, 999)), T.minDate !== !1 && (m = r.strToDate(T.minDate), m = new Date(m.getFullYear(), m.getMonth(), m.getDate())); p < r.currentTime.countDaysInMonth() || c.getDay() !== T.dayOfWeekStart || r.currentTime.getMonth() === c.getMonth();)g = [], p += 1, n = c.getDate(), s = c.getFullYear(), a = c.getMonth(), o = r.getWeekOfYear(c), g.push("xdsoft_date"), l = T.beforeShowDay && e.isFunction(T.beforeShowDay.call) ? T.beforeShowDay.call(k, c) : null, f !== !1 && c > f || m !== !1 && m > c || l && l[0] === !1 ? g.push("xdsoft_disabled") : -1 !== T.disabledDates.indexOf(c.dateFormat(T.formatDate)) && g.push("xdsoft_disabled"), l && "" !== l[1] && g.push(l[1]), r.currentTime.getMonth() !== a && g.push("xdsoft_other_month"), (T.defaultSelect || k.data("changed")) && r.currentTime.dateFormat(T.formatDate) === c.dateFormat(T.formatDate) && g.push("xdsoft_current"), d.dateFormat(T.formatDate) === c.dateFormat(T.formatDate) && g.push("xdsoft_today"), (0 === c.getDay() || 6 === c.getDay() || -1 === T.weekends.indexOf(c.dateFormat(T.formatDate))) && g.push("xdsoft_weekend"), T.beforeShowDay && e.isFunction(T.beforeShowDay) && g.push(T.beforeShowDay(c)), y && (u += "<tr>", y = !1, T.weeks && (u += "<th>" + o + "</th>")), u += '<td data-date="' + n + '" data-month="' + a + '" data-year="' + s + '"' + ' class="xdsoft_date xdsoft_day_of_week' + c.getDay() + " " + g.join(" ") + '">' + "<div>" + n + "</div>" + "</td>", c.getDay() === T.dayOfWeekStartPrev && (u += "</tr>", y = !0), c.setDate(n + 1);
                    if (u += "</tbody></table>", I.html(u), A.find(".xdsoft_label span").eq(0).text(T.i18n[T.lang].months[r.currentTime.getMonth()]), A.find(".xdsoft_label span").eq(1).text(r.currentTime.getFullYear()), v = "", b = "", a = "", h = function (e, t) {
                            var i = r.now();
                            i.setHours(e), e = parseInt(i.getHours(), 10), i.setMinutes(t), t = parseInt(i.getMinutes(), 10), g = [], (T.maxTime !== !1 && r.strtotime(T.maxTime).getTime() < i.getTime() || T.minTime !== !1 && r.strtotime(T.minTime).getTime() > i.getTime()) && g.push("xdsoft_disabled"), (T.initTime || T.defaultSelect || k.data("changed")) && parseInt(r.currentTime.getHours(), 10) === parseInt(e, 10) && (T.step > 59 || Math[T.roundTime](r.currentTime.getMinutes() / T.step) * T.step === parseInt(t, 10)) && (T.defaultSelect || k.data("changed") ? g.push("xdsoft_current") : T.initTime && g.push("xdsoft_init_time")), parseInt(d.getHours(), 10) === parseInt(e, 10) && parseInt(d.getMinutes(), 10) === parseInt(t, 10) && g.push("xdsoft_today"), v += '<div class="xdsoft_time ' + g.join(" ") + '" data-hour="' + e + '" data-minute="' + t + '">' + i.dateFormat(T.formatTime) + "</div>"
                        }, T.allowTimes && e.isArray(T.allowTimes) && T.allowTimes.length)for (p = 0; p < T.allowTimes.length; p += 1)b = r.strtotime(T.allowTimes[p]).getHours(), a = r.strtotime(T.allowTimes[p]).getMinutes(), h(b, a); else for (p = 0, t = 0; p < (T.hours12 ? 12 : 24); p += 1)for (t = 0; 60 > t; t += T.step)b = (10 > p ? "0" : "") + p, a = (10 > t ? "0" : "") + t, h(b, a);
                    for (B.html(v), i = "", p = 0, p = parseInt(T.yearStart, 10) + T.yearOffset; p <= parseInt(T.yearEnd, 10) + T.yearOffset; p += 1)i += '<div class="xdsoft_option ' + (r.currentTime.getFullYear() === p ? "xdsoft_current" : "") + '" data-value="' + p + '">' + p + "</div>";
                    for (j.children().eq(0).html(i), p = 0, i = ""; 11 >= p; p += 1)i += '<div class="xdsoft_option ' + (r.currentTime.getMonth() === p ? "xdsoft_current" : "") + '" data-value="' + p + '">' + T.i18n[T.lang].months[p] + "</div>";
                    U.children().eq(0).html(i), e(k).trigger("generate.xdsoft")
                }, 10), t.stopPropagation()
            }).on("afterOpen.xdsoft", function () {
                if (T.timepicker) {
                    var e, t, i, n;
                    B.find(".xdsoft_current").length ? e = ".xdsoft_current" : B.find(".xdsoft_init_time").length && (e = ".xdsoft_init_time"), e ? (t = z[0].clientHeight, i = B[0].offsetHeight, n = B.find(e).index() * T.timeHeightInTimePicker + 1, n > i - t && (n = i - t), z.trigger("scroll_element.xdsoft_scroller", [parseInt(n, 10) / (i - t)])) : z.trigger("scroll_element.xdsoft_scroller", [0])
                }
            }), N = 0, I.on("click.xdsoft", "td", function (i) {
                i.stopPropagation(), N += 1;
                var n = e(this), s = r.currentTime;
                return (void 0 === s || null === s) && (r.currentTime = r.now(), s = r.currentTime), n.hasClass("xdsoft_disabled") ? !1 : (s.setDate(1), s.setFullYear(n.data("year")), s.setMonth(n.data("month")), s.setDate(n.data("date")), k.trigger("select.xdsoft", [s]), t.val(r.str()), (N > 1 || T.closeOnDateSelect === !0 || 0 === T.closeOnDateSelect && !T.timepicker) && !T.inline && k.trigger("close.xdsoft"), T.onSelectDate && e.isFunction(T.onSelectDate) && T.onSelectDate.call(k, r.currentTime, k.data("input"), i), k.data("changed", !0), k.trigger("xchange.xdsoft"), k.trigger("changedatetime.xdsoft"), setTimeout(function () {
                    N = 0
                }, 200), void 0)
            }), B.on("click.xdsoft", "div", function (t) {
                t.stopPropagation();
                var i = e(this), n = r.currentTime;
                return (void 0 === n || null === n) && (r.currentTime = r.now(), n = r.currentTime), i.hasClass("xdsoft_disabled") ? !1 : (n.setHours(i.data("hour")), n.setMinutes(i.data("minute")), k.trigger("select.xdsoft", [n]), k.data("input").val(r.str()), T.inline || k.trigger("close.xdsoft"), T.onSelectTime && e.isFunction(T.onSelectTime) && T.onSelectTime.call(k, r.currentTime, k.data("input"), t), k.data("changed", !0), k.trigger("xchange.xdsoft"), k.trigger("changedatetime.xdsoft"), void 0)
            }), D.on("mousewheel.xdsoft", function (e) {
                return T.scrollMonth ? (e.deltaY < 0 ? r.nextMonth() : r.prevMonth(), !1) : !0
            }), t.on("mousewheel.xdsoft", function (e) {
                return T.scrollInput ? !T.datepicker && T.timepicker ? (P = B.find(".xdsoft_current").length ? B.find(".xdsoft_current").eq(0).index() : 0, P + e.deltaY >= 0 && P + e.deltaY < B.children().length && (P += e.deltaY), B.children().eq(P).length && B.children().eq(P).trigger("mousedown"), !1) : T.datepicker && !T.timepicker ? (D.trigger(e, [e.deltaY, e.deltaX, e.deltaY]), t.val && t.val(r.str()), k.trigger("changedatetime.xdsoft"), !1) : void 0 : !0
            }), k.on("changedatetime.xdsoft", function (t) {
                if (T.onChangeDateTime && e.isFunction(T.onChangeDateTime)) {
                    var i = k.data("input");
                    T.onChangeDateTime.call(k, r.currentTime, i, t), delete T.value, i.trigger("change")
                }
            }).on("generate.xdsoft", function () {
                T.onGenerate && e.isFunction(T.onGenerate) && T.onGenerate.call(k, r.currentTime, k.data("input")), H && (k.trigger("afterOpen.xdsoft"), H = !1)
            }).on("click.xdsoft", function (e) {
                e.stopPropagation()
            }), P = 0, M = function () {
                var t = k.data("input").offset(), i = t.top + k.data("input")[0].offsetHeight - 1, n = t.left, s = "absolute";
                T.fixed ? (i -= e(window).scrollTop(), n -= e(window).scrollLeft(), s = "fixed") : (i + k[0].offsetHeight > e(window).height() + e(window).scrollTop() && (i = t.top - k[0].offsetHeight + 1), 0 > i && (i = 0), n + k[0].offsetWidth > e(window).width() && (n = e(window).width() - k[0].offsetWidth)), k.css({
                    left: n,
                    top: i,
                    position: s
                })
            }, k.on("open.xdsoft", function (t) {
                var i = !0;
                T.onShow && e.isFunction(T.onShow) && (i = T.onShow.call(k, r.currentTime, k.data("input"), t)), i !== !1 && (k.show(), M(), e(window).off("resize.xdsoft", M).on("resize.xdsoft", M), T.closeOnWithoutClick && e([document.body, window]).on("mousedown.xdsoft", function n() {
                    k.trigger("close.xdsoft"), e([document.body, window]).off("mousedown.xdsoft", n)
                }))
            }).on("close.xdsoft", function (t) {
                var i = !0;
                A.find(".xdsoft_month,.xdsoft_year").find(".xdsoft_select").hide(), T.onClose && e.isFunction(T.onClose) && (i = T.onClose.call(k, r.currentTime, k.data("input"), t)), i === !1 || T.opened || T.inline || k.hide(), t.stopPropagation()
            }).on("toggle.xdsoft", function () {
                k.is(":visible") ? k.trigger("close.xdsoft") : k.trigger("open.xdsoft")
            }).data("input", t), G = 0, $ = 0, k.data("xdsoft_datetime", r), k.setOptions(T), r.setCurrentTime(n()), t.data("xdsoft_datetimepicker", k).on("open.xdsoft focusin.xdsoft mousedown.xdsoft", function () {
                t.is(":disabled") || t.is(":hidden") || !t.is(":visible") || t.data("xdsoft_datetimepicker").is(":visible") && T.closeOnInputClick || (clearTimeout(G), G = setTimeout(function () {
                    t.is(":disabled") || t.is(":hidden") || !t.is(":visible") || (H = !0, r.setCurrentTime(n()), k.trigger("open.xdsoft"))
                }, 100))
            }).on("keydown.xdsoft", function (t) {
                var i, n = (this.value, t.which);
                return -1 !== [p].indexOf(n) && T.enterLikeTab ? (i = e("input:visible,textarea:visible"), k.trigger("close.xdsoft"), i.eq(i.index(this) + 1).focus(), !1) : -1 !== [b].indexOf(n) ? (k.trigger("close.xdsoft"), !0) : void 0
            })
        }, s = function (t) {
            var i = t.data("xdsoft_datetimepicker");
            i && (i.data("xdsoft_datetime", null), i.remove(), t.data("xdsoft_datetimepicker", null).off(".xdsoft"), e(window).off("resize.xdsoft"), e([window, document.body]).off("mousedown.xdsoft"), t.unmousewheel && t.unmousewheel())
        }, e(document).off("keydown.xdsoftctrl keyup.xdsoftctrl").on("keydown.xdsoftctrl", function (e) {
            e.keyCode === u && (_ = !0)
        }).on("keyup.xdsoftctrl", function (e) {
            e.keyCode === u && (_ = !1)
        }), this.each(function () {
            var t = e(this).data("xdsoft_datetimepicker");
            if (t) {
                if ("string" === e.type(i))switch (i) {
                    case"show":
                        e(this).select().focus(), t.trigger("open.xdsoft");
                        break;
                    case"hide":
                        t.trigger("close.xdsoft");
                        break;
                    case"toggle":
                        t.trigger("toggle.xdsoft");
                        break;
                    case"destroy":
                        s(e(this));
                        break;
                    case"reset":
                        this.value = this.defaultValue, this.value && t.data("xdsoft_datetime").isValidDate(Date.parseDate(this.value, T.format)) || t.data("changed", !1), t.data("xdsoft_datetime").setCurrentTime(this.value)
                } else t.setOptions(i);
                return 0
            }
            "string" !== e.type(i) && (!T.lazyInit || T.open || T.inline ? n(e(this)) : N(e(this)))
        })
    }, e.fn.datetimepicker.defaults = t
}(jQuery), function () {/*! Copyright (c) 2013 Brandon Aaron (http://brandon.aaron.sh)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Version: 3.1.12
 *
 * Requires: jQuery 1.2.2+
 */
    !function (e) {
        "function" == typeof define && define.amd ? define(["jquery"], e) : "object" == typeof exports ? module.exports = e : e(jQuery)
    }(function (e) {
        function t(t) {
            var a = t || window.event, o = l.call(arguments, 1), h = 0, c = 0, p = 0, d = 0, f = 0, m = 0;
            if (t = e.event.fix(a), t.type = "mousewheel", "detail" in a && (p = -1 * a.detail), "wheelDelta" in a && (p = a.wheelDelta), "wheelDeltaY" in a && (p = a.wheelDeltaY), "wheelDeltaX" in a && (c = -1 * a.wheelDeltaX), "axis" in a && a.axis === a.HORIZONTAL_AXIS && (c = -1 * p, p = 0), h = 0 === p ? c : p, "deltaY" in a && (p = -1 * a.deltaY, h = p), "deltaX" in a && (c = a.deltaX, 0 === p && (h = -1 * c)), 0 !== p || 0 !== c) {
                if (1 === a.deltaMode) {
                    var g = e.data(this, "mousewheel-line-height");
                    h *= g, p *= g, c *= g
                } else if (2 === a.deltaMode) {
                    var y = e.data(this, "mousewheel-page-height");
                    h *= y, p *= y, c *= y
                }
                if (d = Math.max(Math.abs(p), Math.abs(c)), (!r || r > d) && (r = d, n(a, d) && (r /= 40)), n(a, d) && (h /= 40, c /= 40, p /= 40), h = Math[h >= 1 ? "floor" : "ceil"](h / r), c = Math[c >= 1 ? "floor" : "ceil"](c / r), p = Math[p >= 1 ? "floor" : "ceil"](p / r), u.settings.normalizeOffset && this.getBoundingClientRect) {
                    var v = this.getBoundingClientRect();
                    f = t.clientX - v.left, m = t.clientY - v.top
                }
                return t.deltaX = c, t.deltaY = p, t.deltaFactor = r, t.offsetX = f, t.offsetY = m, t.deltaMode = 0, o.unshift(t, h, c, p), s && clearTimeout(s), s = setTimeout(i, 200), (e.event.dispatch || e.event.handle).apply(this, o)
            }
        }

        function i() {
            r = null
        }

        function n(e, t) {
            return u.settings.adjustOldDeltas && "mousewheel" === e.type && 0 === t % 120
        }

        var s, r, a = ["wheel", "mousewheel", "DOMMouseScroll", "MozMousePixelScroll"], o = "onwheel" in document || document.documentMode >= 9 ? ["wheel"] : ["mousewheel", "DomMouseScroll", "MozMousePixelScroll"], l = Array.prototype.slice;
        if (e.event.fixHooks)for (var h = a.length; h;)e.event.fixHooks[a[--h]] = e.event.mouseHooks;
        var u = e.event.special.mousewheel = {
            version: "3.1.12", setup: function () {
                if (this.addEventListener)for (var i = o.length; i;)this.addEventListener(o[--i], t, !1); else this.onmousewheel = t;
                e.data(this, "mousewheel-line-height", u.getLineHeight(this)), e.data(this, "mousewheel-page-height", u.getPageHeight(this))
            }, teardown: function () {
                if (this.removeEventListener)for (var i = o.length; i;)this.removeEventListener(o[--i], t, !1); else this.onmousewheel = null;
                e.removeData(this, "mousewheel-line-height"), e.removeData(this, "mousewheel-page-height")
            }, getLineHeight: function (t) {
                var i = e(t), n = i["offsetParent" in e.fn ? "offsetParent" : "parent"]();
                return n.length || (n = e("body")), parseInt(n.css("fontSize"), 10) || parseInt(i.css("fontSize"), 10) || 16
            }, getPageHeight: function (t) {
                return e(t).height()
            }, settings: {adjustOldDeltas: !0, normalizeOffset: !0}
        };
        e.fn.extend({
            mousewheel: function (e) {
                return e ? this.bind("mousewheel", e) : this.trigger("mousewheel")
            }, unmousewheel: function (e) {
                return this.unbind("mousewheel", e)
            }
        })
    }), /*
     * Copyright (C) 2004 Baron Schwartz <baron at sequent dot org>
     *
     * This program is free software; you can redistribute it and/or modify it
     * under the terms of the GNU Lesser General Public License as published by the
     * Free Software Foundation, version 2.1.
     *
     * This program is distributed in the hope that it will be useful, but WITHOUT
     * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
     * FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License for more
     * details.
     */
        Date.parseFunctions = {count: 0}, Date.parseRegexes = [], Date.formatFunctions = {count: 0}, Date.prototype.dateFormat = function (e) {
        if ("unixtime" == e)return parseInt(this.getTime() / 1e3);
        null == Date.formatFunctions[e] && Date.createNewFormat(e);
        var t = Date.formatFunctions[e];
        return this[t]()
    }, Date.createNewFormat = function (format) {
        var funcName = "format" + Date.formatFunctions.count++;
        Date.formatFunctions[format] = funcName;
        for (var code = "Date.prototype." + funcName + " = function() {return ", special = !1, ch = "", i = 0; i < format.length; ++i)ch = format.charAt(i), special || "\\" != ch ? special ? (special = !1, code += "'" + String.escape(ch) + "' + ") : code += Date.getFormatCode(ch) : special = !0;
        eval(code.substring(0, code.length - 3) + ";}")
    }, Date.getFormatCode = function (e) {
        switch (e) {
            case"d":
                return "String.leftPad(this.getDate(), 2, '0') + ";
            case"D":
                return "Date.dayNames[this.getDay()].substring(0, 3) + ";
            case"j":
                return "this.getDate() + ";
            case"l":
                return "Date.dayNames[this.getDay()] + ";
            case"S":
                return "this.getSuffix() + ";
            case"w":
                return "this.getDay() + ";
            case"z":
                return "this.getDayOfYear() + ";
            case"W":
                return "this.getWeekOfYear() + ";
            case"F":
                return "Date.monthNames[this.getMonth()] + ";
            case"m":
                return "String.leftPad(this.getMonth() + 1, 2, '0') + ";
            case"M":
                return "Date.monthNames[this.getMonth()].substring(0, 3) + ";
            case"n":
                return "(this.getMonth() + 1) + ";
            case"t":
                return "this.getDaysInMonth() + ";
            case"L":
                return "(this.isLeapYear() ? 1 : 0) + ";
            case"Y":
                return "this.getFullYear() + ";
            case"y":
                return "('' + this.getFullYear()).substring(2, 4) + ";
            case"a":
                return "(this.getHours() < 12 ? 'am' : 'pm') + ";
            case"A":
                return "(this.getHours() < 12 ? 'AM' : 'PM') + ";
            case"g":
                return "((this.getHours() %12) ? this.getHours() % 12 : 12) + ";
            case"G":
                return "this.getHours() + ";
            case"h":
                return "String.leftPad((this.getHours() %12) ? this.getHours() % 12 : 12, 2, '0') + ";
            case"H":
                return "String.leftPad(this.getHours(), 2, '0') + ";
            case"i":
                return "String.leftPad(this.getMinutes(), 2, '0') + ";
            case"s":
                return "String.leftPad(this.getSeconds(), 2, '0') + ";
            case"O":
                return "this.getGMTOffset() + ";
            case"T":
                return "this.getTimezone() + ";
            case"Z":
                return "(this.getTimezoneOffset() * -60) + ";
            default:
                return "'" + String.escape(e) + "' + "
        }
    }, Date.parseDate = function (e, t) {
        if ("unixtime" == t)return new Date(isNaN(parseInt(e)) ? 0 : 1e3 * parseInt(e));
        null == Date.parseFunctions[t] && Date.createParser(t);
        var i = Date.parseFunctions[t];
        return Date[i](e)
    }, Date.createParser = function (format) {
        var funcName = "parse" + Date.parseFunctions.count++, regexNum = Date.parseRegexes.length, currentGroup = 1;
        Date.parseFunctions[format] = funcName;
        for (var code = "Date." + funcName + " = function(input) {\nvar y = -1, m = -1, d = -1, h = -1, i = -1, s = -1, z = -1;\nvar d = new Date();\ny = d.getFullYear();\nm = d.getMonth();\nd = d.getDate();\nvar results = input.match(Date.parseRegexes[" + regexNum + "]);\nif (results && results.length > 0) {", regex = "", special = !1, ch = "", i = 0; i < format.length; ++i)ch = format.charAt(i), special || "\\" != ch ? special ? (special = !1, regex += String.escape(ch)) : (obj = Date.formatCodeToRegex(ch, currentGroup), currentGroup += obj.g, regex += obj.s, obj.g && obj.c && (code += obj.c)) : special = !0;
        code += "if (y > 0 && z > 0){\nvar doyDate = new Date(y,0);\ndoyDate.setDate(z);\nm = doyDate.getMonth();\nd = doyDate.getDate();\n}", code += "if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0 && s >= 0)\n{return new Date(y, m, d, h, i, s);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0)\n{return new Date(y, m, d, h, i);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0)\n{return new Date(y, m, d, h);}\nelse if (y > 0 && m >= 0 && d > 0)\n{return new Date(y, m, d);}\nelse if (y > 0 && m >= 0)\n{return new Date(y, m);}\nelse if (y > 0)\n{return new Date(y);}\n}return null;}", Date.parseRegexes[regexNum] = new RegExp("^" + regex + "$"), eval(code)
    }, Date.formatCodeToRegex = function (e, t) {
        switch (e) {
            case"D":
                return {g: 0, c: null, s: "(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)"};
            case"j":
            case"d":
                return {g: 1, c: "d = parseInt(results[" + t + "], 10);\n", s: "(\\d{1,2})"};
            case"l":
                return {g: 0, c: null, s: "(?:" + Date.dayNames.join("|") + ")"};
            case"S":
                return {g: 0, c: null, s: "(?:st|nd|rd|th)"};
            case"w":
                return {g: 0, c: null, s: "\\d"};
            case"z":
                return {g: 1, c: "z = parseInt(results[" + t + "], 10);\n", s: "(\\d{1,3})"};
            case"W":
                return {g: 0, c: null, s: "(?:\\d{2})"};
            case"F":
                return {
                    g: 1,
                    c: "m = parseInt(Date.monthNumbers[results[" + t + "].substring(0, 3)], 10);\n",
                    s: "(" + Date.monthNames.join("|") + ")"
                };
            case"M":
                return {
                    g: 1,
                    c: "m = parseInt(Date.monthNumbers[results[" + t + "]], 10);\n",
                    s: "(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)"
                };
            case"n":
            case"m":
                return {g: 1, c: "m = parseInt(results[" + t + "], 10) - 1;\n", s: "(\\d{1,2})"};
            case"t":
                return {g: 0, c: null, s: "\\d{1,2}"};
            case"L":
                return {g: 0, c: null, s: "(?:1|0)"};
            case"Y":
                return {g: 1, c: "y = parseInt(results[" + t + "], 10);\n", s: "(\\d{4})"};
            case"y":
                return {
                    g: 1,
                    c: "var ty = parseInt(results[" + t + "], 10);\ny = ty > Date.y2kYear ? 1900 + ty : 2000 + ty;\n",
                    s: "(\\d{1,2})"
                };
            case"a":
                return {
                    g: 1,
                    c: "if (results[" + t + "] == 'am') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",
                    s: "(am|pm)"
                };
            case"A":
                return {
                    g: 1,
                    c: "if (results[" + t + "] == 'AM') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",
                    s: "(AM|PM)"
                };
            case"g":
            case"G":
            case"h":
            case"H":
                return {g: 1, c: "h = parseInt(results[" + t + "], 10);\n", s: "(\\d{1,2})"};
            case"i":
                return {g: 1, c: "i = parseInt(results[" + t + "], 10);\n", s: "(\\d{2})"};
            case"s":
                return {g: 1, c: "s = parseInt(results[" + t + "], 10);\n", s: "(\\d{2})"};
            case"O":
                return {g: 0, c: null, s: "[+-]\\d{4}"};
            case"T":
                return {g: 0, c: null, s: "[A-Z]{3}"};
            case"Z":
                return {g: 0, c: null, s: "[+-]\\d{1,5}"};
            default:
                return {g: 0, c: null, s: String.escape(e)}
        }
    }, Date.prototype.getTimezone = function () {
        return this.toString().replace(/^.*? ([A-Z]{3}) [0-9]{4}.*$/, "$1").replace(/^.*?\(([A-Z])[a-z]+ ([A-Z])[a-z]+ ([A-Z])[a-z]+\)$/, "$1$2$3")
    }, Date.prototype.getGMTOffset = function () {
        return (this.getTimezoneOffset() > 0 ? "-" : "+") + String.leftPad(Math.floor(Math.abs(this.getTimezoneOffset()) / 60), 2, "0") + String.leftPad(Math.abs(this.getTimezoneOffset()) % 60, 2, "0")
    }, Date.prototype.getDayOfYear = function () {
        var e = 0;
        Date.daysInMonth[1] = this.isLeapYear() ? 29 : 28;
        for (var t = 0; t < this.getMonth(); ++t)e += Date.daysInMonth[t];
        return e + this.getDate()
    }, Date.prototype.getWeekOfYear = function () {
        var e = this.getDayOfYear() + (4 - this.getDay()), t = new Date(this.getFullYear(), 0, 1), i = 7 - t.getDay() + 4;
        return String.leftPad(Math.ceil((e - i) / 7) + 1, 2, "0")
    }, Date.prototype.isLeapYear = function () {
        var e = this.getFullYear();
        return 0 == (3 & e) && (e % 100 || 0 == e % 400 && e)
    }, Date.prototype.getFirstDayOfMonth = function () {
        var e = (this.getDay() - (this.getDate() - 1)) % 7;
        return 0 > e ? e + 7 : e
    }, Date.prototype.getLastDayOfMonth = function () {
        var e = (this.getDay() + (Date.daysInMonth[this.getMonth()] - this.getDate())) % 7;
        return 0 > e ? e + 7 : e
    }, Date.prototype.getDaysInMonth = function () {
        return Date.daysInMonth[1] = this.isLeapYear() ? 29 : 28, Date.daysInMonth[this.getMonth()]
    }, Date.prototype.getSuffix = function () {
        switch (this.getDate()) {
            case 1:
            case 21:
            case 31:
                return "st";
            case 2:
            case 22:
                return "nd";
            case 3:
            case 23:
                return "rd";
            default:
                return "th"
        }
    }, String.escape = function (e) {
        return e.replace(/('|\\)/g, "\\$1")
    }, String.leftPad = function (e, t, i) {
        var n = new String(e);
        for (null == i && (i = " "); n.length < t;)n = i + n;
        return n
    }, Date.daysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31], Date.monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"], Date.dayNames = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"], Date.y2kYear = 50, Date.monthNumbers = {
        Jan: 0,
        Feb: 1,
        Mar: 2,
        Apr: 3,
        May: 4,
        Jun: 5,
        Jul: 6,
        Aug: 7,
        Sep: 8,
        Oct: 9,
        Nov: 10,
        Dec: 11
    }, Date.patterns = {
        ISO8601LongPattern: "Y-m-d H:i:s",
        ISO8601ShortPattern: "Y-m-d",
        ShortDatePattern: "n/j/Y",
        LongDatePattern: "l, F d, Y",
        FullDateTimePattern: "l, F d, Y g:i:s A",
        MonthDayPattern: "F d",
        ShortTimePattern: "g:i A",
        LongTimePattern: "g:i:s A",
        SortableDateTimePattern: "Y-m-d\\TH:i:s",
        UniversalSortableDateTimePattern: "Y-m-d H:i:sO",
        YearMonthPattern: "F, Y"
    }
}(), function (e, t, i) {
    var n = function (n) {
        function s(e) {
            var t, i, r = {};
            n.each(e, function (n) {
                (t = n.match(/^([^A-Z]+?)([A-Z])/)) && -1 !== "a aa ai ao as b fn i m o s ".indexOf(t[1] + " ") && (i = n.replace(t[0], t[2].toLowerCase()), r[i] = n, "o" === t[1] && s(e[n]))
            }), e._hungarianMap = r
        }

        function r(e, t, a) {
            e._hungarianMap || s(e);
            var o;
            n.each(t, function (s) {
                o = e._hungarianMap[s], o === i || !a && t[o] !== i || ("o" === o.charAt(0) ? (t[o] || (t[o] = {}), n.extend(!0, t[o], t[s]), r(e[o], t[o], a)) : t[o] = t[s])
            })
        }

        function a(e) {
            var t = Vt.defaults.oLanguage, i = e.sZeroRecords;
            !e.sEmptyTable && i && "No data available in table" === t.sEmptyTable && At(e, e, "sZeroRecords", "sEmptyTable"), !e.sLoadingRecords && i && "Loading..." === t.sLoadingRecords && At(e, e, "sZeroRecords", "sLoadingRecords"), e.sInfoThousands && (e.sThousands = e.sInfoThousands), (e = e.sDecimal) && $t(e)
        }

        function o(e) {
            if (fi(e, "ordering", "bSort"), fi(e, "orderMulti", "bSortMulti"), fi(e, "orderClasses", "bSortClasses"), fi(e, "orderCellsTop", "bSortCellsTop"), fi(e, "order", "aaSorting"), fi(e, "orderFixed", "aaSortingFixed"), fi(e, "paging", "bPaginate"), fi(e, "pagingType", "sPaginationType"), fi(e, "pageLength", "iDisplayLength"), fi(e, "searching", "bFilter"), e = e.aoSearchCols)for (var t = 0, i = e.length; i > t; t++)e[t] && r(Vt.models.oSearch, e[t])
        }

        function l(e) {
            fi(e, "orderable", "bSortable"), fi(e, "orderData", "aDataSort"), fi(e, "orderSequence", "asSorting"), fi(e, "orderDataType", "sortDataType");
            var t = e.aDataSort;
            t && !n.isArray(t) && (e.aDataSort = [t])
        }

        function h(e) {
            var e = e.oBrowser, t = n("<div/>").css({
                position: "absolute",
                top: 0,
                left: 0,
                height: 1,
                width: 1,
                overflow: "hidden"
            }).append(n("<div/>").css({
                position: "absolute",
                top: 1,
                left: 1,
                width: 100,
                overflow: "scroll"
            }).append(n('<div class="test"/>').css({width: "100%", height: 10}))).appendTo("body"), i = t.find(".test");
            e.bScrollOversize = 100 === i[0].offsetWidth, e.bScrollbarLeft = 1 !== Math.round(i.offset().left), t.remove()
        }

        function u(e, t, n, s, r, a) {
            var o, l = !1;
            for (n !== i && (o = n, l = !0); s !== r;)e.hasOwnProperty(s) && (o = l ? t(o, e[s], s, e) : e[s], l = !0, s += a);
            return o
        }

        function c(e, i) {
            var s = Vt.defaults.column, r = e.aoColumns.length, s = n.extend({}, Vt.models.oColumn, s, {
                nTh: i ? i : t.createElement("th"),
                sTitle: s.sTitle ? s.sTitle : i ? i.innerHTML : "",
                aDataSort: s.aDataSort ? s.aDataSort : [r],
                mData: s.mData ? s.mData : r,
                idx: r
            });
            e.aoColumns.push(s), s = e.aoPreSearchCols, s[r] = n.extend({}, Vt.models.oSearch, s[r]), p(e, r, n(i).data())
        }

        function p(e, t, s) {
            var t = e.aoColumns[t], a = e.oClasses, o = n(t.nTh);
            if (!t.sWidthOrig) {
                t.sWidthOrig = o.attr("width") || null;
                var h = (o.attr("style") || "").match(/width:\s*(\d+[pxem%]+)/);
                h && (t.sWidthOrig = h[1])
            }
            s !== i && null !== s && (l(s), r(Vt.defaults.column, s), s.mDataProp !== i && !s.mData && (s.mData = s.mDataProp), s.sType && (t._sManualType = s.sType), s.className && !s.sClass && (s.sClass = s.className), n.extend(t, s), At(t, s, "sWidth", "sWidthOrig"), s.iDataSort !== i && (t.aDataSort = [s.iDataSort]), At(t, s, "aDataSort"));
            var u = t.mData, c = S(u), p = t.mRender ? S(t.mRender) : null, s = function (e) {
                return "string" == typeof e && -1 !== e.indexOf("@")
            };
            t._bAttrSrc = n.isPlainObject(u) && (s(u.sort) || s(u.type) || s(u.filter)), t.fnGetData = function (e, t, n) {
                var s = c(e, t, i, n);
                return p && t ? p(s, t, e, n) : s
            }, t.fnSetData = function (e, t, i) {
                return _(u)(e, t, i)
            }, "number" != typeof u && (e._rowReadObject = !0), e.oFeatures.bSort || (t.bSortable = !1, o.addClass(a.sSortableNone)), e = -1 !== n.inArray("asc", t.asSorting), s = -1 !== n.inArray("desc", t.asSorting), t.bSortable && (e || s) ? e && !s ? (t.sSortingClass = a.sSortableAsc, t.sSortingClassJUI = a.sSortJUIAscAllowed) : !e && s ? (t.sSortingClass = a.sSortableDesc, t.sSortingClassJUI = a.sSortJUIDescAllowed) : (t.sSortingClass = a.sSortable, t.sSortingClassJUI = a.sSortJUI) : (t.sSortingClass = a.sSortableNone, t.sSortingClassJUI = "")
        }

        function d(e) {
            if (!1 !== e.oFeatures.bAutoWidth) {
                var t = e.aoColumns;
                gt(e);
                for (var i = 0, n = t.length; n > i; i++)t[i].nTh.style.width = t[i].sWidth
            }
            t = e.oScroll, ("" !== t.sY || "" !== t.sX) && ft(e), Bt(e, null, "column-sizing", [e])
        }

        function f(e, t) {
            var i = y(e, "bVisible");
            return "number" == typeof i[t] ? i[t] : null
        }

        function m(e, t) {
            var i = y(e, "bVisible"), i = n.inArray(t, i);
            return -1 !== i ? i : null
        }

        function g(e) {
            return y(e, "bVisible").length
        }

        function y(e, t) {
            var i = [];
            return n.map(e.aoColumns, function (e, n) {
                e[t] && i.push(n)
            }), i
        }

        function v(e) {
            var t, n, s, r, a, o, l, h, u, c = e.aoColumns, p = e.aoData, d = Vt.ext.type.detect;
            for (t = 0, n = c.length; n > t; t++)if (l = c[t], u = [], !l.sType && l._sManualType) l.sType = l._sManualType; else if (!l.sType) {
                for (s = 0, r = d.length; r > s; s++) {
                    for (a = 0, o = p.length; o > a && (u[a] === i && (u[a] = O(e, a, t, "type")), h = d[s](u[a], e), h || s === d.length - 1) && "html" !== h; a++);
                    if (h) {
                        l.sType = h;
                        break
                    }
                }
                l.sType || (l.sType = "string")
            }
        }

        function b(e, t, s, r) {
            var a, o, l, h, u, p, d = e.aoColumns;
            if (t)for (a = t.length - 1; a >= 0; a--) {
                p = t[a];
                var f = p.targets !== i ? p.targets : p.aTargets;
                for (n.isArray(f) || (f = [f]), o = 0, l = f.length; l > o; o++)if ("number" == typeof f[o] && 0 <= f[o]) {
                    for (; d.length <= f[o];)c(e);
                    r(f[o], p)
                } else if ("number" == typeof f[o] && 0 > f[o]) r(d.length + f[o], p); else if ("string" == typeof f[o])for (h = 0, u = d.length; u > h; h++)("_all" == f[o] || n(d[h].nTh).hasClass(f[o])) && r(h, p)
            }
            if (s)for (a = 0, e = s.length; e > a; a++)r(a, s[a])
        }

        function L(e, t, i, s) {
            var r = e.aoData.length, a = n.extend(!0, {}, Vt.models.oRow, {src: i ? "dom" : "data"});
            a._aData = t, e.aoData.push(a);
            for (var t = e.aoColumns, a = 0, o = t.length; o > a; a++)i && C(e, r, a, O(e, r, a)), t[a].sType = null;
            return e.aiDisplayMaster.push(r), (i || !e.oFeatures.bDeferRender) && k(e, r, i, s), r
        }

        function w(e, t) {
            var i;
            return t instanceof n || (t = n(t)), t.map(function (t, n) {
                return i = M(e, n), L(e, i.data, n, i.cells)
            })
        }

        function O(e, t, n, s) {
            var r = e.iDraw, a = e.aoColumns[n], o = e.aoData[t]._aData, l = a.sDefaultContent, n = a.fnGetData(o, s, {
                settings: e,
                row: t,
                col: n
            });
            if (n === i)return e.iDrawError != r && null === l && (Dt(e, 0, "Requested unknown parameter " + ("function" == typeof a.mData ? "{function}" : "'" + a.mData + "'") + " for row " + t, 4), e.iDrawError = r), l;
            if (n !== o && null !== n || null === l) {
                if ("function" == typeof n)return n.call(o)
            } else n = l;
            return null === n && "display" == s ? "" : n
        }

        function C(e, t, i, n) {
            e.aoColumns[i].fnSetData(e.aoData[t]._aData, n, {settings: e, row: t, col: i})
        }

        function x(e) {
            return n.map(e.match(/(\\.|[^\.])+/g), function (e) {
                return e.replace(/\\./g, ".")
            })
        }

        function S(e) {
            if (n.isPlainObject(e)) {
                var t = {};
                return n.each(e, function (e, i) {
                    i && (t[e] = S(i))
                }), function (e, n, s, r) {
                    var a = t[n] || t._;
                    return a !== i ? a(e, n, s, r) : e
                }
            }
            if (null === e)return function (e) {
                return e
            };
            if ("function" == typeof e)return function (t, i, n, s) {
                return e(t, i, n, s)
            };
            if ("string" == typeof e && (-1 !== e.indexOf(".") || -1 !== e.indexOf("[") || -1 !== e.indexOf("("))) {
                var s = function (e, t, n) {
                    var r, a;
                    if ("" !== n) {
                        a = x(n);
                        for (var o = 0, l = a.length; l > o; o++) {
                            if (n = a[o].match(mi), r = a[o].match(gi), n) {
                                for (a[o] = a[o].replace(mi, ""), "" !== a[o] && (e = e[a[o]]), r = [], a.splice(0, o + 1), a = a.join("."), o = 0, l = e.length; l > o; o++)r.push(s(e[o], t, a));
                                e = n[0].substring(1, n[0].length - 1), e = "" === e ? r : r.join(e);
                                break
                            }
                            if (r) a[o] = a[o].replace(gi, ""), e = e[a[o]](); else {
                                if (null === e || e[a[o]] === i)return i;
                                e = e[a[o]]
                            }
                        }
                    }
                    return e
                };
                return function (t, i) {
                    return s(t, i, e)
                }
            }
            return function (t) {
                return t[e]
            }
        }

        function _(e) {
            if (n.isPlainObject(e))return _(e._);
            if (null === e)return function () {
            };
            if ("function" == typeof e)return function (t, i, n) {
                e(t, "set", i, n)
            };
            if ("string" == typeof e && (-1 !== e.indexOf(".") || -1 !== e.indexOf("[") || -1 !== e.indexOf("("))) {
                var t = function (e, n, s) {
                    var r, s = x(s);
                    r = s[s.length - 1];
                    for (var a, o, l = 0, h = s.length - 1; h > l; l++) {
                        if (a = s[l].match(mi), o = s[l].match(gi), a) {
                            for (s[l] = s[l].replace(mi, ""), e[s[l]] = [], r = s.slice(), r.splice(0, l + 1), a = r.join("."), o = 0, h = n.length; h > o; o++)r = {}, t(r, n[o], a), e[s[l]].push(r);
                            return
                        }
                        o && (s[l] = s[l].replace(gi, ""), e = e[s[l]](n)), (null === e[s[l]] || e[s[l]] === i) && (e[s[l]] = {}), e = e[s[l]]
                    }
                    r.match(gi) ? e[r.replace(gi, "")](n) : e[r.replace(mi, "")] = n
                };
                return function (i, n) {
                    return t(i, n, e)
                }
            }
            return function (t, i) {
                t[e] = i
            }
        }

        function T(e) {
            return hi(e.aoData, "_aData")
        }

        function E(e) {
            e.aoData.length = 0, e.aiDisplayMaster.length = 0, e.aiDisplay.length = 0
        }

        function N(e, t, n) {
            for (var s = -1, r = 0, a = e.length; a > r; r++)e[r] == t ? s = r : e[r] > t && e[r]--;
            -1 != s && n === i && e.splice(s, 1)
        }

        function P(e, t, n, s) {
            var r, a = e.aoData[t], o = function (i, n) {
                for (; i.childNodes.length;)i.removeChild(i.firstChild);
                i.innerHTML = O(e, t, n, "display")
            };
            if ("dom" !== n && (n && "auto" !== n || "dom" !== a.src)) {
                var l = a.anCells;
                if (l)if (s !== i) o(l[s], s); else for (n = 0, r = l.length; r > n; n++)o(l[n], n)
            } else a._aData = M(e, a, s, s === i ? i : a._aData).data;
            if (a._aSortData = null, a._aFilterData = null, o = e.aoColumns, s !== i) o[s].sType = null; else {
                for (n = 0, r = o.length; r > n; n++)o[n].sType = null;
                F(a)
            }
        }

        function M(e, t, s, r) {
            var a, o, l = [], h = t.firstChild, u = 0, c = e.aoColumns, p = e._rowReadObject, r = r || p ? {} : [], d = function (e, t) {
                if ("string" == typeof e) {
                    var i = e.indexOf("@");
                    -1 !== i && (i = e.substring(i + 1), _(e)(r, t.getAttribute(i)))
                }
            }, e = function (e) {
                (s === i || s === u) && (a = c[u], o = n.trim(e.innerHTML), a && a._bAttrSrc ? (_(a.mData._)(r, o), d(a.mData.sort, e), d(a.mData.type, e), d(a.mData.filter, e)) : p ? (a._setter || (a._setter = _(a.mData)), a._setter(r, o)) : r[u] = o), u++
            };
            if (h)for (; h;)t = h.nodeName.toUpperCase(), ("TD" == t || "TH" == t) && (e(h), l.push(h)), h = h.nextSibling; else for (l = t.anCells, h = 0, t = l.length; t > h; h++)e(l[h]);
            return {data: r, cells: l}
        }

        function k(e, i, n, s) {
            var r, a, o, l, h, u = e.aoData[i], c = u._aData, p = [];
            if (null === u.nTr) {
                for (r = n || t.createElement("tr"), u.nTr = r, u.anCells = p, r._DT_RowIndex = i, F(u), l = 0, h = e.aoColumns.length; h > l; l++)o = e.aoColumns[l], a = n ? s[l] : t.createElement(o.sCellType), p.push(a), (!n || o.mRender || o.mData !== l) && (a.innerHTML = O(e, i, l, "display")), o.sClass && (a.className += " " + o.sClass), o.bVisible && !n ? r.appendChild(a) : !o.bVisible && n && a.parentNode.removeChild(a), o.fnCreatedCell && o.fnCreatedCell.call(e.oInstance, a, O(e, i, l), c, i, l);
                Bt(e, "aoRowCreatedCallback", null, [r, c, i])
            }
            u.nTr.setAttribute("role", "row")
        }

        function F(e) {
            var t = e.nTr, i = e._aData;
            if (t) {
                if (i.DT_RowId && (t.id = i.DT_RowId), i.DT_RowClass) {
                    var s = i.DT_RowClass.split(" ");
                    e.__rowc = e.__rowc ? di(e.__rowc.concat(s)) : s, n(t).removeClass(e.__rowc.join(" ")).addClass(i.DT_RowClass)
                }
                i.DT_RowAttr && n(t).attr(i.DT_RowAttr), i.DT_RowData && n(t).data(i.DT_RowData)
            }
        }

        function D(e) {
            var t, i, s, r, a, o = e.nTHead, l = e.nTFoot, h = 0 === n("th, td", o).length, u = e.oClasses, c = e.aoColumns;
            for (h && (r = n("<tr/>").appendTo(o)), t = 0, i = c.length; i > t; t++)a = c[t], s = n(a.nTh).addClass(a.sClass), h && s.appendTo(r), e.oFeatures.bSort && (s.addClass(a.sSortingClass), !1 !== a.bSortable && (s.attr("tabindex", e.iTabIndex).attr("aria-controls", e.sTableId), Et(e, a.nTh, t))), a.sTitle != s.html() && s.html(a.sTitle), jt(e, "header")(e, s, a, u);
            if (h && B(e.aoHeader, o), n(o).find(">tr").attr("role", "row"), n(o).find(">tr>th, >tr>td").addClass(u.sHeaderTH), n(l).find(">tr>th, >tr>td").addClass(u.sFooterTH), null !== l)for (e = e.aoFooter[0], t = 0, i = e.length; i > t; t++)a = c[t], a.nTf = e[t].cell, a.sClass && n(a.nTf).addClass(a.sClass)
        }

        function A(e, t, s) {
            var r, a, o, l, h = [], u = [], c = e.aoColumns.length;
            if (t) {
                for (s === i && (s = !1), r = 0, a = t.length; a > r; r++) {
                    for (h[r] = t[r].slice(), h[r].nTr = t[r].nTr, o = c - 1; o >= 0; o--)!e.aoColumns[o].bVisible && !s && h[r].splice(o, 1);
                    u.push([])
                }
                for (r = 0, a = h.length; a > r; r++) {
                    if (e = h[r].nTr)for (; o = e.firstChild;)e.removeChild(o);
                    for (o = 0, t = h[r].length; t > o; o++)if (l = c = 1, u[r][o] === i) {
                        for (e.appendChild(h[r][o].cell), u[r][o] = 1; h[r + c] !== i && h[r][o].cell == h[r + c][o].cell;)u[r + c][o] = 1, c++;
                        for (; h[r][o + l] !== i && h[r][o].cell == h[r][o + l].cell;) {
                            for (s = 0; c > s; s++)u[r + s][o + l] = 1;
                            l++
                        }
                        n(h[r][o].cell).attr("rowspan", c).attr("colspan", l)
                    }
                }
            }
        }

        function I(e) {
            var t = Bt(e, "aoPreDrawCallback", "preDraw", [e]);
            if (-1 !== n.inArray(!1, t)) pt(e, !1); else {
                var t = [], s = 0, r = e.asStripeClasses, a = r.length, o = e.oLanguage, l = e.iInitDisplayStart, h = "ssp" == Ht(e), u = e.aiDisplay;
                e.bDrawing = !0, l !== i && -1 !== l && (e._iDisplayStart = h ? l : l >= e.fnRecordsDisplay() ? 0 : l, e.iInitDisplayStart = -1);
                var l = e._iDisplayStart, c = e.fnDisplayEnd();
                if (e.bDeferLoading) e.bDeferLoading = !1, e.iDraw++, pt(e, !1); else if (h) {
                    if (!e.bDestroying && !H(e))return
                } else e.iDraw++;
                if (0 !== u.length)for (o = h ? e.aoData.length : c, h = h ? 0 : l; o > h; h++) {
                    var p = u[h], d = e.aoData[p];
                    if (null === d.nTr && k(e, p), p = d.nTr, 0 !== a) {
                        var f = r[s % a];
                        d._sRowStripe != f && (n(p).removeClass(d._sRowStripe).addClass(f), d._sRowStripe = f)
                    }
                    Bt(e, "aoRowCallback", null, [p, d._aData, s, h]), t.push(p), s++
                } else s = o.sZeroRecords, 1 == e.iDraw && "ajax" == Ht(e) ? s = o.sLoadingRecords : o.sEmptyTable && 0 === e.fnRecordsTotal() && (s = o.sEmptyTable), t[0] = n("<tr/>", {"class": a ? r[0] : ""}).append(n("<td />", {
                    valign: "top",
                    colSpan: g(e),
                    "class": e.oClasses.sRowEmpty
                }).html(s))[0];
                Bt(e, "aoHeaderCallback", "header", [n(e.nTHead).children("tr")[0], T(e), l, c, u]), Bt(e, "aoFooterCallback", "footer", [n(e.nTFoot).children("tr")[0], T(e), l, c, u]), r = n(e.nTBody), r.children().detach(), r.append(n(t)), Bt(e, "aoDrawCallback", "draw", [e]), e.bSorted = !1, e.bFiltered = !1, e.bDrawing = !1
            }
        }

        function R(e, t) {
            var i = e.oFeatures, n = i.bFilter;
            i.bSort && St(e), n ? q(e, e.oPreviousSearch) : e.aiDisplay = e.aiDisplayMaster.slice(), !0 !== t && (e._iDisplayStart = 0), e._drawHold = t, I(e), e._drawHold = !1
        }

        function z(e) {
            var t = e.oClasses, i = n(e.nTable), i = n("<div/>").insertBefore(i), s = e.oFeatures, r = n("<div/>", {
                id: e.sTableId + "_wrapper",
                "class": t.sWrapper + (e.nTFoot ? "" : " " + t.sNoFooter)
            });
            e.nHolding = i[0], e.nTableWrapper = r[0], e.nTableReinsertBefore = e.nTable.nextSibling;
            for (var a, o, l, h, u, c, p = e.sDom.split(""), d = 0; d < p.length; d++) {
                if (a = null, o = p[d], "<" == o) {
                    if (l = n("<div/>")[0], h = p[d + 1], "'" == h || '"' == h) {
                        for (u = "", c = 2; p[d + c] != h;)u += p[d + c], c++;
                        "H" == u ? u = t.sJUIHeader : "F" == u && (u = t.sJUIFooter), -1 != u.indexOf(".") ? (h = u.split("."), l.id = h[0].substr(1, h[0].length - 1), l.className = h[1]) : "#" == u.charAt(0) ? l.id = u.substr(1, u.length - 1) : l.className = u, d += c
                    }
                    r.append(l), r = n(l)
                } else if (">" == o) r = r.parent(); else if ("l" == o && s.bPaginate && s.bLengthChange) a = lt(e); else if ("f" == o && s.bFilter) a = V(e); else if ("r" == o && s.bProcessing) a = ct(e); else if ("t" == o) a = dt(e); else if ("i" == o && s.bInfo) a = it(e); else if ("p" == o && s.bPaginate) a = ht(e); else if (0 !== Vt.ext.feature.length)for (l = Vt.ext.feature, c = 0, h = l.length; h > c; c++)if (o == l[c].cFeature) {
                    a = l[c].fnInit(e);
                    break
                }
                a && (l = e.aanFeatures, l[o] || (l[o] = []), l[o].push(a), r.append(a))
            }
            i.replaceWith(r)
        }

        function B(e, t) {
            var i, s, r, a, o, l, h, u, c, p, d = n(t).children("tr");
            for (e.splice(0, e.length), r = 0, l = d.length; l > r; r++)e.push([]);
            for (r = 0, l = d.length; l > r; r++)for (i = d[r], s = i.firstChild; s;) {
                if ("TD" == s.nodeName.toUpperCase() || "TH" == s.nodeName.toUpperCase()) {
                    for (u = 1 * s.getAttribute("colspan"), c = 1 * s.getAttribute("rowspan"), u = u && 0 !== u && 1 !== u ? u : 1, c = c && 0 !== c && 1 !== c ? c : 1, a = 0, o = e[r]; o[a];)a++;
                    for (h = a, p = 1 === u ? !0 : !1, o = 0; u > o; o++)for (a = 0; c > a; a++)e[r + a][h + o] = {
                        cell: s,
                        unique: p
                    }, e[r + a].nTr = i
                }
                s = s.nextSibling
            }
        }

        function U(e, t, i) {
            var n = [];
            i || (i = e.aoHeader, t && (i = [], B(i, t)));
            for (var t = 0, s = i.length; s > t; t++)for (var r = 0, a = i[t].length; a > r; r++)!i[t][r].unique || n[r] && e.bSortCellsTop || (n[r] = i[t][r].cell);
            return n
        }

        function j(e, t, i) {
            if (Bt(e, "aoServerParams", "serverParams", [t]), t && n.isArray(t)) {
                var s = {}, r = /(.*?)\[\]$/;
                n.each(t, function (e, t) {
                    var i = t.name.match(r);
                    i ? (i = i[0], s[i] || (s[i] = []), s[i].push(t.value)) : s[t.name] = t.value
                }), t = s
            }
            var a, o = e.ajax, l = e.oInstance, h = function (t) {
                Bt(e, null, "xhr", [e, t, e.jqXHR]), i(t)
            };
            if (n.isPlainObject(o) && o.data) {
                a = o.data;
                var u = n.isFunction(a) ? a(t, e) : a, t = n.isFunction(a) && u ? u : n.extend(!0, t, u);
                delete o.data
            }
            u = {
                data: t, success: function (t) {
                    var i = t.error || t.sError;
                    i && Dt(e, 0, i), e.json = t, h(t)
                }, dataType: "json", cache: !1, type: e.sServerMethod, error: function (t, i) {
                    var s = Bt(e, null, "xhr", [e, null, e.jqXHR]);
                    -1 === n.inArray(!0, s) && ("parsererror" == i ? Dt(e, 0, "Invalid JSON response", 1) : 4 === t.readyState && Dt(e, 0, "Ajax error", 7)), pt(e, !1)
                }
            }, e.oAjaxData = t, Bt(e, null, "preXhr", [e, t]), e.fnServerData ? e.fnServerData.call(l, e.sAjaxSource, n.map(t, function (e, t) {
                return {name: t, value: e}
            }), h, e) : e.sAjaxSource || "string" == typeof o ? e.jqXHR = n.ajax(n.extend(u, {url: o || e.sAjaxSource})) : n.isFunction(o) ? e.jqXHR = o.call(l, t, h, e) : (e.jqXHR = n.ajax(n.extend(u, o)), o.data = a)
        }

        function H(e) {
            return e.bAjaxDataGet ? (e.iDraw++, pt(e, !0), j(e, G(e), function (t) {
                $(e, t)
            }), !1) : !0
        }

        function G(e) {
            var t, i, s, r, a = e.aoColumns, o = a.length, l = e.oFeatures, h = e.oPreviousSearch, u = e.aoPreSearchCols, c = [], p = xt(e);
            t = e._iDisplayStart, i = !1 !== l.bPaginate ? e._iDisplayLength : -1;
            var d = function (e, t) {
                c.push({name: e, value: t})
            };
            d("sEcho", e.iDraw), d("iColumns", o), d("sColumns", hi(a, "sName").join(",")), d("iDisplayStart", t), d("iDisplayLength", i);
            var f = {
                draw: e.iDraw,
                columns: [],
                order: [],
                start: t,
                length: i,
                search: {value: h.sSearch, regex: h.bRegex}
            };
            for (t = 0; o > t; t++)s = a[t], r = u[t], i = "function" == typeof s.mData ? "function" : s.mData, f.columns.push({
                data: i,
                name: s.sName,
                searchable: s.bSearchable,
                orderable: s.bSortable,
                search: {value: r.sSearch, regex: r.bRegex}
            }), d("mDataProp_" + t, i), l.bFilter && (d("sSearch_" + t, r.sSearch), d("bRegex_" + t, r.bRegex), d("bSearchable_" + t, s.bSearchable)), l.bSort && d("bSortable_" + t, s.bSortable);
            return l.bFilter && (d("sSearch", h.sSearch), d("bRegex", h.bRegex)), l.bSort && (n.each(p, function (e, t) {
                f.order.push({column: t.col, dir: t.dir}), d("iSortCol_" + e, t.col), d("sSortDir_" + e, t.dir)
            }), d("iSortingCols", p.length)), a = Vt.ext.legacy.ajax, null === a ? e.sAjaxSource ? c : f : a ? c : f
        }

        function $(e, t) {
            var n = W(e, t), s = t.sEcho !== i ? t.sEcho : t.draw, r = t.iTotalRecords !== i ? t.iTotalRecords : t.recordsTotal, a = t.iTotalDisplayRecords !== i ? t.iTotalDisplayRecords : t.recordsFiltered;
            if (s) {
                if (1 * s < e.iDraw)return;
                e.iDraw = 1 * s
            }
            for (E(e), e._iRecordsTotal = parseInt(r, 10), e._iRecordsDisplay = parseInt(a, 10), s = 0, r = n.length; r > s; s++)L(e, n[s]);
            e.aiDisplay = e.aiDisplayMaster.slice(), e.bAjaxDataGet = !1, I(e), e._bInitComplete || at(e, t), e.bAjaxDataGet = !0, pt(e, !1)
        }

        function W(e, t) {
            var s = n.isPlainObject(e.ajax) && e.ajax.dataSrc !== i ? e.ajax.dataSrc : e.sAjaxDataProp;
            return "data" === s ? t.aaData || t[s] : "" !== s ? S(s)(t) : t
        }

        function V(e) {
            var i = e.oClasses, s = e.sTableId, r = e.oLanguage, a = e.oPreviousSearch, o = e.aanFeatures, l = '<input type="search" class="' + i.sFilterInput + '"/>', h = r.sSearch, h = h.match(/_INPUT_/) ? h.replace("_INPUT_", l) : h + l, i = n("<div/>", {
                id: o.f ? null : s + "_filter",
                "class": i.sFilter
            }).append(n("<label/>").append(h)), o = function () {
                var t = this.value ? this.value : "";
                t != a.sSearch && (q(e, {
                    sSearch: t,
                    bRegex: a.bRegex,
                    bSmart: a.bSmart,
                    bCaseInsensitive: a.bCaseInsensitive
                }), e._iDisplayStart = 0, I(e))
            }, l = null !== e.searchDelay ? e.searchDelay : "ssp" === Ht(e) ? 400 : 0, u = n("input", i).val(a.sSearch).attr("placeholder", r.sSearchPlaceholder).bind("keyup.DT search.DT input.DT paste.DT cut.DT", l ? yt(o, l) : o).bind("keypress.DT", function (e) {
                return 13 == e.keyCode ? !1 : void 0
            }).attr("aria-controls", s);
            return n(e.nTable).on("search.dt.DT", function (i, n) {
                if (e === n)try {
                    u[0] !== t.activeElement && u.val(a.sSearch)
                } catch (s) {
                }
            }), i[0]
        }

        function q(e, t, n) {
            var s = e.oPreviousSearch, r = e.aoPreSearchCols, a = function (e) {
                s.sSearch = e.sSearch, s.bRegex = e.bRegex, s.bSmart = e.bSmart, s.bCaseInsensitive = e.bCaseInsensitive
            };
            if (v(e), "ssp" != Ht(e)) {
                for (Z(e, t.sSearch, n, t.bEscapeRegex !== i ? !t.bEscapeRegex : t.bRegex, t.bSmart, t.bCaseInsensitive), a(t), t = 0; t < r.length; t++)Y(e, r[t].sSearch, t, r[t].bEscapeRegex !== i ? !r[t].bEscapeRegex : r[t].bRegex, r[t].bSmart, r[t].bCaseInsensitive);
                X(e)
            } else a(t);
            e.bFiltered = !0, Bt(e, null, "search", [e])
        }

        function X(e) {
            for (var t, i, n = Vt.ext.search, s = e.aiDisplay, r = 0, a = n.length; a > r; r++) {
                for (var o = [], l = 0, h = s.length; h > l; l++)i = s[l], t = e.aoData[i], n[r](e, t._aFilterData, i, t._aData, l) && o.push(i);
                s.length = 0, s.push.apply(s, o)
            }
        }

        function Y(e, t, i, n, s, r) {
            if ("" !== t)for (var a = e.aiDisplay, n = K(t, n, s, r), s = a.length - 1; s >= 0; s--)t = e.aoData[a[s]]._aFilterData[i], n.test(t) || a.splice(s, 1)
        }

        function Z(e, t, i, n, s, r) {
            var a, n = K(t, n, s, r), s = e.oPreviousSearch.sSearch, r = e.aiDisplayMaster;
            if (0 !== Vt.ext.search.length && (i = !0), a = Q(e), 0 >= t.length) e.aiDisplay = r.slice(); else for ((a || i || s.length > t.length || 0 !== t.indexOf(s) || e.bSorted) && (e.aiDisplay = r.slice()), t = e.aiDisplay, i = t.length - 1; i >= 0; i--)n.test(e.aoData[t[i]]._sFilterRow) || t.splice(i, 1)
        }

        function K(e, t, i, s) {
            return e = t ? e : J(e), i && (e = "^(?=.*?" + n.map(e.match(/"[^"]+"|[^ ]+/g) || [""], function (e) {
                    if ('"' === e.charAt(0))var t = e.match(/^"(.*)"$/), e = t ? t[1] : e;
                    return e.replace('"', "")
                }).join(")(?=.*?") + ").*$"), RegExp(e, s ? "i" : "")
        }

        function J(e) {
            return e.replace(ii, "\\$1")
        }

        function Q(e) {
            var t, i, n, s, r, a, o, l, h = e.aoColumns, u = Vt.ext.type.search;
            for (t = !1, i = 0, s = e.aoData.length; s > i; i++)if (l = e.aoData[i], !l._aFilterData) {
                for (a = [], n = 0, r = h.length; r > n; n++)t = h[n], t.bSearchable ? (o = O(e, i, n, "filter"), u[t.sType] && (o = u[t.sType](o)), null === o && (o = ""), "string" != typeof o && o.toString && (o = o.toString())) : o = "", o.indexOf && -1 !== o.indexOf("&") && (yi.innerHTML = o, o = vi ? yi.textContent : yi.innerText), o.replace && (o = o.replace(/[\r\n]/g, "")), a.push(o);
                l._aFilterData = a, l._sFilterRow = a.join("  "), t = !0
            }
            return t
        }

        function et(e) {
            return {search: e.sSearch, smart: e.bSmart, regex: e.bRegex, caseInsensitive: e.bCaseInsensitive}
        }

        function tt(e) {
            return {sSearch: e.search, bSmart: e.smart, bRegex: e.regex, bCaseInsensitive: e.caseInsensitive}
        }

        function it(e) {
            var t = e.sTableId, i = e.aanFeatures.i, s = n("<div/>", {
                "class": e.oClasses.sInfo,
                id: i ? null : t + "_info"
            });
            return i || (e.aoDrawCallback.push({
                fn: nt,
                sName: "information"
            }), s.attr("role", "status").attr("aria-live", "polite"), n(e.nTable).attr("aria-describedby", t + "_info")), s[0]
        }

        function nt(e) {
            var t = e.aanFeatures.i;
            if (0 !== t.length) {
                var i = e.oLanguage, s = e._iDisplayStart + 1, r = e.fnDisplayEnd(), a = e.fnRecordsTotal(), o = e.fnRecordsDisplay(), l = o ? i.sInfo : i.sInfoEmpty;
                o !== a && (l += " " + i.sInfoFiltered), l += i.sInfoPostFix, l = st(e, l), i = i.fnInfoCallback, null !== i && (l = i.call(e.oInstance, e, s, r, a, o, l)), n(t).html(l)
            }
        }

        function st(e, t) {
            var i = e.fnFormatNumber, n = e._iDisplayStart + 1, s = e._iDisplayLength, r = e.fnRecordsDisplay(), a = -1 === s;
            return t.replace(/_START_/g, i.call(e, n)).replace(/_END_/g, i.call(e, e.fnDisplayEnd())).replace(/_MAX_/g, i.call(e, e.fnRecordsTotal())).replace(/_TOTAL_/g, i.call(e, r)).replace(/_PAGE_/g, i.call(e, a ? 1 : Math.ceil(n / s))).replace(/_PAGES_/g, i.call(e, a ? 1 : Math.ceil(r / s)))
        }

        function rt(e) {
            var t, i, n, s = e.iInitDisplayStart, r = e.aoColumns;
            if (i = e.oFeatures, e.bInitialised) {
                for (z(e), D(e), A(e, e.aoHeader), A(e, e.aoFooter), pt(e, !0), i.bAutoWidth && gt(e), t = 0, i = r.length; i > t; t++)n = r[t], n.sWidth && (n.nTh.style.width = Ot(n.sWidth));
                R(e), r = Ht(e), "ssp" != r && ("ajax" == r ? j(e, [], function (i) {
                    var n = W(e, i);
                    for (t = 0; t < n.length; t++)L(e, n[t]);
                    e.iInitDisplayStart = s, R(e), pt(e, !1), at(e, i)
                }, e) : (pt(e, !1), at(e)))
            } else setTimeout(function () {
                rt(e)
            }, 200)
        }

        function at(e, t) {
            e._bInitComplete = !0, t && d(e), Bt(e, "aoInitComplete", "init", [e, t])
        }

        function ot(e, t) {
            var i = parseInt(t, 10);
            e._iDisplayLength = i, Ut(e), Bt(e, null, "length", [e, i])
        }

        function lt(e) {
            for (var t = e.oClasses, i = e.sTableId, s = e.aLengthMenu, r = n.isArray(s[0]), a = r ? s[0] : s, s = r ? s[1] : s, r = n("<select/>", {
                name: i + "_length",
                "aria-controls": i,
                "class": t.sLengthSelect
            }), o = 0, l = a.length; l > o; o++)r[0][o] = new Option(s[o], a[o]);
            var h = n("<div><label/></div>").addClass(t.sLength);
            return e.aanFeatures.l || (h[0].id = i + "_length"), h.children().append(e.oLanguage.sLengthMenu.replace("_MENU_", r[0].outerHTML)), n("select", h).val(e._iDisplayLength).bind("change.DT", function () {
                ot(e, n(this).val()), I(e)
            }), n(e.nTable).bind("length.dt.DT", function (t, i, s) {
                e === i && n("select", h).val(s)
            }), h[0]
        }

        function ht(e) {
            var t = e.sPaginationType, i = Vt.ext.pager[t], s = "function" == typeof i, r = function (e) {
                I(e)
            }, t = n("<div/>").addClass(e.oClasses.sPaging + t)[0], a = e.aanFeatures;
            return s || i.fnInit(e, t, r), a.p || (t.id = e.sTableId + "_paginate", e.aoDrawCallback.push({
                fn: function (e) {
                    if (s) {
                        var t, n = e._iDisplayStart, o = e._iDisplayLength, l = e.fnRecordsDisplay(), h = -1 === o, n = h ? 0 : Math.ceil(n / o), o = h ? 1 : Math.ceil(l / o), l = i(n, o), h = 0;
                        for (t = a.p.length; t > h; h++)jt(e, "pageButton")(e, a.p[h], h, l, n, o)
                    } else i.fnUpdate(e, r)
                }, sName: "pagination"
            })), t
        }

        function ut(e, t, i) {
            var n = e._iDisplayStart, s = e._iDisplayLength, r = e.fnRecordsDisplay();
            return 0 === r || -1 === s ? n = 0 : "number" == typeof t ? (n = t * s, n > r && (n = 0)) : "first" == t ? n = 0 : "previous" == t ? (n = s >= 0 ? n - s : 0, 0 > n && (n = 0)) : "next" == t ? r > n + s && (n += s) : "last" == t ? n = Math.floor((r - 1) / s) * s : Dt(e, 0, "Unknown paging action: " + t, 5), t = e._iDisplayStart !== n, e._iDisplayStart = n, t && (Bt(e, null, "page", [e]), i && I(e)), t
        }

        function ct(e) {
            return n("<div/>", {
                id: e.aanFeatures.r ? null : e.sTableId + "_processing",
                "class": e.oClasses.sProcessing
            }).html(e.oLanguage.sProcessing).insertBefore(e.nTable)[0]
        }

        function pt(e, t) {
            e.oFeatures.bProcessing && n(e.aanFeatures.r).css("display", t ? "block" : "none"), Bt(e, null, "processing", [e, t])
        }

        function dt(e) {
            var t = n(e.nTable);
            t.attr("role", "grid");
            var i = e.oScroll;
            if ("" === i.sX && "" === i.sY)return e.nTable;
            var s = i.sX, r = i.sY, a = e.oClasses, o = t.children("caption"), l = o.length ? o[0]._captionSide : null, h = n(t[0].cloneNode(!1)), u = n(t[0].cloneNode(!1)), c = t.children("tfoot");
            i.sX && "100%" === t.attr("width") && t.removeAttr("width"), c.length || (c = null), i = n("<div/>", {"class": a.sScrollWrapper}).append(n("<div/>", {"class": a.sScrollHead}).css({
                overflow: "hidden",
                position: "relative",
                border: 0,
                width: s ? s ? Ot(s) : null : "100%"
            }).append(n("<div/>", {"class": a.sScrollHeadInner}).css({
                "box-sizing": "content-box",
                width: i.sXInner || "100%"
            }).append(h.removeAttr("id").css("margin-left", 0).append("top" === l ? o : null).append(t.children("thead"))))).append(n("<div/>", {"class": a.sScrollBody}).css({
                overflow: "auto",
                height: r ? Ot(r) : null,
                width: s ? Ot(s) : null
            }).append(t)), c && i.append(n("<div/>", {"class": a.sScrollFoot}).css({
                overflow: "hidden",
                border: 0,
                width: s ? s ? Ot(s) : null : "100%"
            }).append(n("<div/>", {"class": a.sScrollFootInner}).append(u.removeAttr("id").css("margin-left", 0).append("bottom" === l ? o : null).append(t.children("tfoot")))));
            var t = i.children(), p = t[0], a = t[1], d = c ? t[2] : null;
            return s && n(a).on("scroll.DT", function () {
                var e = this.scrollLeft;
                p.scrollLeft = e, c && (d.scrollLeft = e)
            }), e.nScrollHead = p, e.nScrollBody = a, e.nScrollFoot = d, e.aoDrawCallback.push({
                fn: ft,
                sName: "scrolling"
            }), i[0]
        }

        function ft(e) {
            var t, i, s, r, a, o, l = e.oScroll, h = l.sX, u = l.sXInner, c = l.sY, p = l.iBarWidth, d = n(e.nScrollHead), m = d[0].style, g = d.children("div"), y = g[0].style, v = g.children("table"), g = e.nScrollBody, b = n(g), L = g.style, w = n(e.nScrollFoot).children("div"), O = w.children("table"), C = n(e.nTHead), x = n(e.nTable), S = x[0], _ = S.style, T = e.nTFoot ? n(e.nTFoot) : null, E = e.oBrowser, N = E.bScrollOversize, P = [], M = [], k = [], F = function (e) {
                e = e.style, e.paddingTop = "0", e.paddingBottom = "0", e.borderTopWidth = "0", e.borderBottomWidth = "0", e.height = 0
            };
            x.children("thead, tfoot").remove(), a = C.clone().prependTo(x), t = C.find("tr"), s = a.find("tr"), a.find("th, td").removeAttr("tabindex"), T && (r = T.clone().prependTo(x), i = T.find("tr"), r = r.find("tr")), h || (L.width = "100%", d[0].style.width = "100%"), n.each(U(e, a), function (t, i) {
                o = f(e, t), i.style.width = e.aoColumns[o].sWidth
            }), T && mt(function (e) {
                e.style.width = ""
            }, r), l.bCollapse && "" !== c && (L.height = b[0].offsetHeight + C[0].offsetHeight + "px"), d = x.outerWidth(), "" === h ? (_.width = "100%", N && (x.find("tbody").height() > g.offsetHeight || "scroll" == b.css("overflow-y")) && (_.width = Ot(x.outerWidth() - p))) : "" !== u ? _.width = Ot(u) : d == b.width() && b.height() < x.height() ? (_.width = Ot(d - p), x.outerWidth() > d - p && (_.width = Ot(d))) : _.width = Ot(d), d = x.outerWidth(), mt(F, s), mt(function (e) {
                k.push(e.innerHTML), P.push(Ot(n(e).css("width")))
            }, s), mt(function (e, t) {
                e.style.width = P[t]
            }, t), n(s).height(0), T && (mt(F, r), mt(function (e) {
                M.push(Ot(n(e).css("width")))
            }, r), mt(function (e, t) {
                e.style.width = M[t]
            }, i), n(r).height(0)), mt(function (e, t) {
                e.innerHTML = '<div class="dataTables_sizing" style="height:0;overflow:hidden;">' + k[t] + "</div>", e.style.width = P[t]
            }, s), T && mt(function (e, t) {
                e.innerHTML = "", e.style.width = M[t]
            }, r), x.outerWidth() < d ? (i = g.scrollHeight > g.offsetHeight || "scroll" == b.css("overflow-y") ? d + p : d, N && (g.scrollHeight > g.offsetHeight || "scroll" == b.css("overflow-y")) && (_.width = Ot(i - p)), ("" === h || "" !== u) && Dt(e, 1, "Possible column misalignment", 6)) : i = "100%", L.width = Ot(i), m.width = Ot(i), T && (e.nScrollFoot.style.width = Ot(i)), !c && N && (L.height = Ot(S.offsetHeight + p)), c && l.bCollapse && (L.height = Ot(c), l = h && S.offsetWidth > g.offsetWidth ? p : 0, S.offsetHeight < g.offsetHeight && (L.height = Ot(S.offsetHeight + l))), l = x.outerWidth(), v[0].style.width = Ot(l), y.width = Ot(l), v = x.height() > g.clientHeight || "scroll" == b.css("overflow-y"), E = "padding" + (E.bScrollbarLeft ? "Left" : "Right"), y[E] = v ? p + "px" : "0px", T && (O[0].style.width = Ot(l), w[0].style.width = Ot(l), w[0].style[E] = v ? p + "px" : "0px"), b.scroll(), !e.bSorted && !e.bFiltered || e._drawHold || (g.scrollTop = 0)
        }

        function mt(e, t, i) {
            for (var n, s, r = 0, a = 0, o = t.length; o > a;) {
                for (n = t[a].firstChild, s = i ? i[a].firstChild : null; n;)1 === n.nodeType && (i ? e(n, s, r) : e(n, r), r++), n = n.nextSibling, s = i ? s.nextSibling : null;
                a++
            }
        }

        function gt(t) {
            var i, s, r = t.nTable, a = t.aoColumns, o = t.oScroll, l = o.sY, h = o.sX, u = o.sXInner, c = a.length, o = y(t, "bVisible"), p = n("th", t.nTHead), f = r.getAttribute("width"), m = r.parentNode, v = !1;
            for ((i = r.style.width) && -1 !== i.indexOf("%") && (f = i), i = 0; i < o.length; i++)s = a[o[i]], null !== s.sWidth && (s.sWidth = vt(s.sWidthOrig, m), v = !0);
            if (v || h || l || c != g(t) || c != p.length) {
                c = n(r).clone().css("visibility", "hidden").removeAttr("id"), c.find("tbody tr").remove();
                var b = n("<tr/>").appendTo(c.find("tbody"));
                for (c.find("tfoot th, tfoot td").css("width", ""), p = U(t, c.find("thead")[0]), i = 0; i < o.length; i++)s = a[o[i]], p[i].style.width = null !== s.sWidthOrig && "" !== s.sWidthOrig ? Ot(s.sWidthOrig) : "";
                if (t.aoData.length)for (i = 0; i < o.length; i++)v = o[i], s = a[v], n(Lt(t, v)).clone(!1).append(s.sContentPadding).appendTo(b);
                if (c.appendTo(m), h && u ? c.width(u) : h ? (c.css("width", "auto"), c.width() < m.offsetWidth && c.width(m.offsetWidth)) : l ? c.width(m.offsetWidth) : f && c.width(f), bt(t, c[0]), h) {
                    for (i = u = 0; i < o.length; i++)s = a[o[i]], l = n(p[i]).outerWidth(), u += null === s.sWidthOrig ? l : parseInt(s.sWidth, 10) + l - n(p[i]).width();
                    c.width(Ot(u)), r.style.width = Ot(u)
                }
                for (i = 0; i < o.length; i++)s = a[o[i]], (l = n(p[i]).width()) && (s.sWidth = Ot(l));
                r.style.width = Ot(c.css("width")), c.remove()
            } else for (i = 0; c > i; i++)a[i].sWidth = Ot(p.eq(i).width());
            f && (r.style.width = Ot(f)), !f && !h || t._reszEvt || (r = function () {
                n(e).bind("resize.DT-" + t.sInstance, yt(function () {
                    d(t)
                }))
            }, t.oBrowser.bScrollOversize ? setTimeout(r, 1e3) : r(), t._reszEvt = !0)
        }

        function yt(e, t) {
            var n, s, r = t !== i ? t : 200;
            return function () {
                var t = this, a = +new Date, o = arguments;
                n && n + r > a ? (clearTimeout(s), s = setTimeout(function () {
                    n = i, e.apply(t, o)
                }, r)) : (n = a, e.apply(t, o))
            }
        }

        function vt(e, i) {
            if (!e)return 0;
            var s = n("<div/>").css("width", Ot(e)).appendTo(i || t.body), r = s[0].offsetWidth;
            return s.remove(), r
        }

        function bt(e, t) {
            var i = e.oScroll;
            (i.sX || i.sY) && (i = i.sX ? 0 : i.iBarWidth, t.style.width = Ot(n(t).outerWidth() - i))
        }

        function Lt(e, t) {
            var i = wt(e, t);
            if (0 > i)return null;
            var s = e.aoData[i];
            return s.nTr ? s.anCells[t] : n("<td/>").html(O(e, i, t, "display"))[0]
        }

        function wt(e, t) {
            for (var i, n = -1, s = -1, r = 0, a = e.aoData.length; a > r; r++)i = O(e, r, t, "display") + "", i = i.replace(bi, ""), i.length > n && (n = i.length, s = r);
            return s
        }

        function Ot(e) {
            return null === e ? "0px" : "number" == typeof e ? 0 > e ? "0px" : e + "px" : e.match(/\d$/) ? e + "px" : e
        }

        function Ct() {
            var e = Vt.__scrollbarWidth;
            if (e === i) {
                var t = n("<p/>").css({
                    position: "absolute",
                    top: 0,
                    left: 0,
                    width: "100%",
                    height: 150,
                    padding: 0,
                    overflow: "scroll",
                    visibility: "hidden"
                }).appendTo("body"), e = t[0].offsetWidth - t[0].clientWidth;
                Vt.__scrollbarWidth = e, t.remove()
            }
            return e
        }

        function xt(e) {
            var t, s, r, a, o, l, h = [], u = e.aoColumns;
            t = e.aaSortingFixed, s = n.isPlainObject(t);
            var c = [];
            for (r = function (e) {
                e.length && !n.isArray(e[0]) ? c.push(e) : c.push.apply(c, e)
            }, n.isArray(t) && r(t), s && t.pre && r(t.pre), r(e.aaSorting), s && t.post && r(t.post), e = 0; e < c.length; e++)for (l = c[e][0], r = u[l].aDataSort, t = 0, s = r.length; s > t; t++)a = r[t], o = u[a].sType || "string", c[e]._idx === i && (c[e]._idx = n.inArray(c[e][1], u[a].asSorting)), h.push({
                src: l,
                col: a,
                dir: c[e][1],
                index: c[e]._idx,
                type: o,
                formatter: Vt.ext.type.order[o + "-pre"]
            });
            return h
        }

        function St(e) {
            var t, i, n, s, r = [], a = Vt.ext.type.order, o = e.aoData, l = 0, h = e.aiDisplayMaster;
            for (v(e), s = xt(e), t = 0, i = s.length; i > t; t++)n = s[t], n.formatter && l++, Pt(e, n.col);
            if ("ssp" != Ht(e) && 0 !== s.length) {
                for (t = 0, i = h.length; i > t; t++)r[h[t]] = t;
                l === s.length ? h.sort(function (e, t) {
                    var i, n, a, l, h = s.length, u = o[e]._aSortData, c = o[t]._aSortData;
                    for (a = 0; h > a; a++)if (l = s[a], i = u[l.col], n = c[l.col], i = n > i ? -1 : i > n ? 1 : 0, 0 !== i)return "asc" === l.dir ? i : -i;
                    return i = r[e], n = r[t], n > i ? -1 : i > n ? 1 : 0
                }) : h.sort(function (e, t) {
                    var i, n, l, h, u = s.length, c = o[e]._aSortData, p = o[t]._aSortData;
                    for (l = 0; u > l; l++)if (h = s[l], i = c[h.col], n = p[h.col], h = a[h.type + "-" + h.dir] || a["string-" + h.dir], i = h(i, n), 0 !== i)return i;
                    return i = r[e], n = r[t], n > i ? -1 : i > n ? 1 : 0
                })
            }
            e.bSorted = !0
        }

        function _t(e) {
            for (var t, i, n = e.aoColumns, s = xt(e), e = e.oLanguage.oAria, r = 0, a = n.length; a > r; r++) {
                i = n[r];
                var o = i.asSorting;
                t = i.sTitle.replace(/<.*?>/g, "");
                var l = i.nTh;
                l.removeAttribute("aria-sort"), i.bSortable && (0 < s.length && s[0].col == r ? (l.setAttribute("aria-sort", "asc" == s[0].dir ? "ascending" : "descending"), i = o[s[0].index + 1] || o[0]) : i = o[0], t += "asc" === i ? e.sSortAscending : e.sSortDescending), l.setAttribute("aria-label", t)
            }
        }

        function Tt(e, t, s, r) {
            var a = e.aaSorting, o = e.aoColumns[t].asSorting, l = function (e, t) {
                var s = e._idx;
                return s === i && (s = n.inArray(e[1], o)), s + 1 < o.length ? s + 1 : t ? null : 0
            };
            "number" == typeof a[0] && (a = e.aaSorting = [a]), s && e.oFeatures.bSortMulti ? (s = n.inArray(t, hi(a, "0")), -1 !== s ? (t = l(a[s], !0), null === t && 1 === a.length && (t = 0), null === t ? a.splice(s, 1) : (a[s][1] = o[t], a[s]._idx = t)) : (a.push([t, o[0], 0]), a[a.length - 1]._idx = 0)) : a.length && a[0][0] == t ? (t = l(a[0]), a.length = 1, a[0][1] = o[t], a[0]._idx = t) : (a.length = 0, a.push([t, o[0]]), a[0]._idx = 0), R(e), "function" == typeof r && r(e)
        }

        function Et(e, t, i, n) {
            var s = e.aoColumns[i];
            Rt(t, {}, function (t) {
                !1 !== s.bSortable && (e.oFeatures.bProcessing ? (pt(e, !0), setTimeout(function () {
                    Tt(e, i, t.shiftKey, n), "ssp" !== Ht(e) && pt(e, !1)
                }, 0)) : Tt(e, i, t.shiftKey, n))
            })
        }

        function Nt(e) {
            var t, i, s = e.aLastSort, r = e.oClasses.sSortColumn, a = xt(e), o = e.oFeatures;
            if (o.bSort && o.bSortClasses) {
                for (o = 0, t = s.length; t > o; o++)i = s[o].src, n(hi(e.aoData, "anCells", i)).removeClass(r + (2 > o ? o + 1 : 3));
                for (o = 0, t = a.length; t > o; o++)i = a[o].src, n(hi(e.aoData, "anCells", i)).addClass(r + (2 > o ? o + 1 : 3))
            }
            e.aLastSort = a
        }

        function Pt(e, t) {
            var i, n = e.aoColumns[t], s = Vt.ext.order[n.sSortDataType];
            s && (i = s.call(e.oInstance, e, t, m(e, t)));
            for (var r, a = Vt.ext.type.order[n.sType + "-pre"], o = 0, l = e.aoData.length; l > o; o++)n = e.aoData[o], n._aSortData || (n._aSortData = []), (!n._aSortData[t] || s) && (r = s ? i[o] : O(e, o, t, "sort"), n._aSortData[t] = a ? a(r) : r)
        }

        function Mt(e) {
            if (e.oFeatures.bStateSave && !e.bDestroying) {
                var t = {
                    time: +new Date,
                    start: e._iDisplayStart,
                    length: e._iDisplayLength,
                    order: n.extend(!0, [], e.aaSorting),
                    search: et(e.oPreviousSearch),
                    columns: n.map(e.aoColumns, function (t, i) {
                        return {visible: t.bVisible, search: et(e.aoPreSearchCols[i])}
                    })
                };
                Bt(e, "aoStateSaveParams", "stateSaveParams", [e, t]), e.oSavedState = t, e.fnStateSaveCallback.call(e.oInstance, e, t)
            }
        }

        function kt(e) {
            var t, s, r = e.aoColumns;
            if (e.oFeatures.bStateSave) {
                var a = e.fnStateLoadCallback.call(e.oInstance, e);
                if (a && a.time && (t = Bt(e, "aoStateLoadParams", "stateLoadParams", [e, a]), -1 === n.inArray(!1, t) && (t = e.iStateDuration, !(t > 0 && a.time < +new Date - 1e3 * t) && r.length === a.columns.length))) {
                    for (e.oLoadedState = n.extend(!0, {}, a), a.start !== i && (e._iDisplayStart = a.start, e.iInitDisplayStart = a.start), a.length !== i && (e._iDisplayLength = a.length), a.order !== i && (e.aaSorting = [], n.each(a.order, function (t, i) {
                        e.aaSorting.push(i[0] >= r.length ? [0, i[1]] : i)
                    })), a.search !== i && n.extend(e.oPreviousSearch, tt(a.search)), t = 0, s = a.columns.length; s > t; t++) {
                        var o = a.columns[t];
                        o.visible !== i && (r[t].bVisible = o.visible), o.search !== i && n.extend(e.aoPreSearchCols[t], tt(o.search))
                    }
                    Bt(e, "aoStateLoaded", "stateLoaded", [e, a])
                }
            }
        }

        function Ft(e) {
            var t = Vt.settings, e = n.inArray(e, hi(t, "nTable"));
            return -1 !== e ? t[e] : null
        }

        function Dt(t, i, n, s) {
            if (n = "DataTables warning: " + (null !== t ? "table id=" + t.sTableId + " - " : "") + n, s && (n += ". For more information about this error, please see http://datatables.net/tn/" + s), i) e.console && console.log && console.log(n); else if (i = Vt.ext, i = i.sErrMode || i.errMode, Bt(t, null, "error", [t, s, n]), "alert" == i) alert(n); else {
                if ("throw" == i)throw Error(n);
                "function" == typeof i && i(t, s, n)
            }
        }

        function At(e, t, s, r) {
            n.isArray(s) ? n.each(s, function (i, s) {
                n.isArray(s) ? At(e, t, s[0], s[1]) : At(e, t, s)
            }) : (r === i && (r = s), t[s] !== i && (e[r] = t[s]))
        }

        function It(e, t, i) {
            var s, r;
            for (r in t)t.hasOwnProperty(r) && (s = t[r], n.isPlainObject(s) ? (n.isPlainObject(e[r]) || (e[r] = {}), n.extend(!0, e[r], s)) : e[r] = i && "data" !== r && "aaData" !== r && n.isArray(s) ? s.slice() : s);
            return e
        }

        function Rt(e, t, i) {
            n(e).bind("click.DT", t, function (t) {
                e.blur(), i(t)
            }).bind("keypress.DT", t, function (e) {
                13 === e.which && (e.preventDefault(), i(e))
            }).bind("selectstart.DT", function () {
                return !1
            })
        }

        function zt(e, t, i, n) {
            i && e[t].push({fn: i, sName: n})
        }

        function Bt(e, t, i, s) {
            var r = [];
            return t && (r = n.map(e[t].slice().reverse(), function (t) {
                return t.fn.apply(e.oInstance, s)
            })), null !== i && (t = n.Event(i + ".dt"), n(e.nTable).trigger(t, s), r.push(t.result)), r
        }

        function Ut(e) {
            var t = e._iDisplayStart, i = e.fnDisplayEnd(), n = e._iDisplayLength;
            t >= i && (t = i - n), t -= t % n, (-1 === n || 0 > t) && (t = 0), e._iDisplayStart = t
        }

        function jt(e, t) {
            var i = e.renderer, s = Vt.ext.renderer[t];
            return n.isPlainObject(i) && i[t] ? s[i[t]] || s._ : "string" == typeof i ? s[i] || s._ : s._
        }

        function Ht(e) {
            return e.oFeatures.bServerSide ? "ssp" : e.ajax || e.sAjaxSource ? "ajax" : "dom"
        }

        function Gt(e, t) {
            var i = [], i = Ii.numbers_length, n = Math.floor(i / 2);
            return i >= t ? i = ci(0, t) : n >= e ? (i = ci(0, i - 2), i.push("ellipsis"), i.push(t - 1)) : (e >= t - 1 - n ? i = ci(t - (i - 2), t) : (i = ci(e - n + 2, e + n - 1), i.push("ellipsis"), i.push(t - 1)), i.splice(0, 0, "ellipsis"), i.splice(0, 0, 0)), i.DT_el = "span", i
        }

        function $t(e) {
            n.each({
                num: function (t) {
                    return Ri(t, e)
                }, "num-fmt": function (t) {
                    return Ri(t, e, ni)
                }, "html-num": function (t) {
                    return Ri(t, e, Qt)
                }, "html-num-fmt": function (t) {
                    return Ri(t, e, Qt, ni)
                }
            }, function (t, i) {
                qt.type.order[t + e + "-pre"] = i, t.match(/^html\-/) && (qt.type.search[t + e] = qt.type.search.html)
            })
        }

        function Wt(e) {
            return function () {
                var t = [Ft(this[Vt.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));
                return Vt.ext.internal[e].apply(this, t)
            }
        }

        var Vt, qt, Xt, Yt, Zt, Kt = {}, Jt = /[\r\n]/g, Qt = /<.*?>/g, ei = /^[\w\+\-]/, ti = /[\w\+\-]$/, ii = RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\|\\$|\\^|\\-)", "g"), ni = /[',$\u00a3\u20ac\u00a5%\u2009\u202F\u20BD\u20a9\u20BArfk]/gi, si = function (e) {
            return e && !0 !== e && "-" !== e ? !1 : !0
        }, ri = function (e) {
            var t = parseInt(e, 10);
            return !isNaN(t) && isFinite(e) ? t : null
        }, ai = function (e, t) {
            return Kt[t] || (Kt[t] = RegExp(J(t), "g")), "string" == typeof e && "." !== t ? e.replace(/\./g, "").replace(Kt[t], ".") : e
        }, oi = function (e, t, i) {
            var n = "string" == typeof e;
            return si(e) ? !0 : (t && n && (e = ai(e, t)), i && n && (e = e.replace(ni, "")), !isNaN(parseFloat(e)) && isFinite(e))
        }, li = function (e, t, i) {
            return si(e) ? !0 : si(e) || "string" == typeof e ? oi(e.replace(Qt, ""), t, i) ? !0 : null : null
        }, hi = function (e, t, n) {
            var s = [], r = 0, a = e.length;
            if (n !== i)for (; a > r; r++)e[r] && e[r][t] && s.push(e[r][t][n]); else for (; a > r; r++)e[r] && s.push(e[r][t]);
            return s
        }, ui = function (e, t, n, s) {
            var r = [], a = 0, o = t.length;
            if (s !== i)for (; o > a; a++)e[t[a]][n] && r.push(e[t[a]][n][s]); else for (; o > a; a++)r.push(e[t[a]][n]);
            return r
        }, ci = function (e, t) {
            var n, s = [];
            t === i ? (t = 0, n = e) : (n = t, t = e);
            for (var r = t; n > r; r++)s.push(r);
            return s
        }, pi = function (e) {
            for (var t = [], i = 0, n = e.length; n > i; i++)e[i] && t.push(e[i]);
            return t
        }, di = function (e) {
            var t, i, n, s = [], r = e.length, a = 0;
            i = 0;
            e:for (; r > i; i++) {
                for (t = e[i], n = 0; a > n; n++)if (s[n] === t)continue e;
                s.push(t), a++
            }
            return s
        }, fi = function (e, t, n) {
            e[t] !== i && (e[n] = e[t])
        }, mi = /\[.*?\]$/, gi = /\(\)$/, yi = n("<div>")[0], vi = yi.textContent !== i, bi = /<.*?>/g;
        Vt = function (e) {
            this.$ = function (e, t) {
                return this.api(!0).$(e, t)
            }, this._ = function (e, t) {
                return this.api(!0).rows(e, t).data()
            }, this.api = function (e) {
                return e ? new Xt(Ft(this[qt.iApiIndex])) : new Xt(this)
            }, this.fnAddData = function (e, t) {
                var s = this.api(!0), r = n.isArray(e) && (n.isArray(e[0]) || n.isPlainObject(e[0])) ? s.rows.add(e) : s.row.add(e);
                return (t === i || t) && s.draw(), r.flatten().toArray()
            }, this.fnAdjustColumnSizing = function (e) {
                var t = this.api(!0).columns.adjust(), n = t.settings()[0], s = n.oScroll;
                e === i || e ? t.draw(!1) : ("" !== s.sX || "" !== s.sY) && ft(n)
            }, this.fnClearTable = function (e) {
                var t = this.api(!0).clear();
                (e === i || e) && t.draw()
            }, this.fnClose = function (e) {
                this.api(!0).row(e).child.hide()
            }, this.fnDeleteRow = function (e, t, n) {
                var s = this.api(!0), e = s.rows(e), r = e.settings()[0], a = r.aoData[e[0][0]];
                return e.remove(), t && t.call(this, r, a), (n === i || n) && s.draw(), a
            }, this.fnDestroy = function (e) {
                this.api(!0).destroy(e)
            }, this.fnDraw = function (e) {
                this.api(!0).draw(e)
            }, this.fnFilter = function (e, t, n, s, r, a) {
                r = this.api(!0), null === t || t === i ? r.search(e, n, s, a) : r.column(t).search(e, n, s, a), r.draw()
            }, this.fnGetData = function (e, t) {
                var n = this.api(!0);
                if (e !== i) {
                    var s = e.nodeName ? e.nodeName.toLowerCase() : "";
                    return t !== i || "td" == s || "th" == s ? n.cell(e, t).data() : n.row(e).data() || null
                }
                return n.data().toArray()
            }, this.fnGetNodes = function (e) {
                var t = this.api(!0);
                return e !== i ? t.row(e).node() : t.rows().nodes().flatten().toArray()
            }, this.fnGetPosition = function (e) {
                var t = this.api(!0), i = e.nodeName.toUpperCase();
                return "TR" == i ? t.row(e).index() : "TD" == i || "TH" == i ? (e = t.cell(e).index(), [e.row, e.columnVisible, e.column]) : null
            }, this.fnIsOpen = function (e) {
                return this.api(!0).row(e).child.isShown()
            }, this.fnOpen = function (e, t, i) {
                return this.api(!0).row(e).child(t, i).show().child()[0]
            }, this.fnPageChange = function (e, t) {
                var n = this.api(!0).page(e);
                (t === i || t) && n.draw(!1)
            }, this.fnSetColumnVis = function (e, t, n) {
                e = this.api(!0).column(e).visible(t), (n === i || n) && e.columns.adjust().draw()
            }, this.fnSettings = function () {
                return Ft(this[qt.iApiIndex])
            }, this.fnSort = function (e) {
                this.api(!0).order(e).draw()
            }, this.fnSortListener = function (e, t, i) {
                this.api(!0).order.listener(e, t, i)
            }, this.fnUpdate = function (e, t, n, s, r) {
                var a = this.api(!0);
                return n === i || null === n ? a.row(t).data(e) : a.cell(t, n).data(e), (r === i || r) && a.columns.adjust(), (s === i || s) && a.draw(), 0
            }, this.fnVersionCheck = qt.fnVersionCheck;
            var t = this, s = e === i, u = this.length;
            s && (e = {}), this.oApi = this.internal = qt.internal;
            for (var d in Vt.ext.internal)d && (this[d] = Wt(d));
            return this.each(function () {
                var d, f = {}, f = u > 1 ? It(f, e, !0) : e, m = 0, g = this.getAttribute("id"), y = !1, v = Vt.defaults, O = n(this);
                if ("table" != this.nodeName.toLowerCase()) Dt(null, 0, "Non-table node initialisation (" + this.nodeName + ")", 2); else {
                    o(v), l(v.column), r(v, v, !0), r(v.column, v.column, !0), r(v, n.extend(f, O.data()));
                    var C = Vt.settings, m = 0;
                    for (d = C.length; d > m; m++) {
                        var x = C[m];
                        if (x.nTable == this || x.nTHead.parentNode == this || x.nTFoot && x.nTFoot.parentNode == this) {
                            if (m = f.bRetrieve !== i ? f.bRetrieve : v.bRetrieve, s || m)return x.oInstance;
                            if (f.bDestroy !== i ? f.bDestroy : v.bDestroy) {
                                x.oInstance.fnDestroy();
                                break
                            }
                            return Dt(x, 0, "Cannot reinitialise DataTable", 3), void 0
                        }
                        if (x.sTableId == this.id) {
                            C.splice(m, 1);
                            break
                        }
                    }
                    (null === g || "" === g) && (this.id = g = "DataTables_Table_" + Vt.ext._unique++);
                    var S = n.extend(!0, {}, Vt.models.oSettings, {
                        sDestroyWidth: O[0].style.width,
                        sInstance: g,
                        sTableId: g
                    });
                    S.nTable = this, S.oApi = t.internal, S.oInit = f, C.push(S), S.oInstance = 1 === t.length ? t : O.dataTable(), o(f), f.oLanguage && a(f.oLanguage), f.aLengthMenu && !f.iDisplayLength && (f.iDisplayLength = n.isArray(f.aLengthMenu[0]) ? f.aLengthMenu[0][0] : f.aLengthMenu[0]), f = It(n.extend(!0, {}, v), f), At(S.oFeatures, f, "bPaginate bLengthChange bFilter bSort bSortMulti bInfo bProcessing bAutoWidth bSortClasses bServerSide bDeferRender".split(" ")), At(S, f, ["asStripeClasses", "ajax", "fnServerData", "fnFormatNumber", "sServerMethod", "aaSorting", "aaSortingFixed", "aLengthMenu", "sPaginationType", "sAjaxSource", "sAjaxDataProp", "iStateDuration", "sDom", "bSortCellsTop", "iTabIndex", "fnStateLoadCallback", "fnStateSaveCallback", "renderer", "searchDelay", ["iCookieDuration", "iStateDuration"], ["oSearch", "oPreviousSearch"], ["aoSearchCols", "aoPreSearchCols"], ["iDisplayLength", "_iDisplayLength"], ["bJQueryUI", "bJUI"]]), At(S.oScroll, f, [["sScrollX", "sX"], ["sScrollXInner", "sXInner"], ["sScrollY", "sY"], ["bScrollCollapse", "bCollapse"]]), At(S.oLanguage, f, "fnInfoCallback"), zt(S, "aoDrawCallback", f.fnDrawCallback, "user"), zt(S, "aoServerParams", f.fnServerParams, "user"), zt(S, "aoStateSaveParams", f.fnStateSaveParams, "user"), zt(S, "aoStateLoadParams", f.fnStateLoadParams, "user"), zt(S, "aoStateLoaded", f.fnStateLoaded, "user"), zt(S, "aoRowCallback", f.fnRowCallback, "user"), zt(S, "aoRowCreatedCallback", f.fnCreatedRow, "user"), zt(S, "aoHeaderCallback", f.fnHeaderCallback, "user"), zt(S, "aoFooterCallback", f.fnFooterCallback, "user"), zt(S, "aoInitComplete", f.fnInitComplete, "user"), zt(S, "aoPreDrawCallback", f.fnPreDrawCallback, "user"), g = S.oClasses, f.bJQueryUI ? (n.extend(g, Vt.ext.oJUIClasses, f.oClasses), f.sDom === v.sDom && "lfrtip" === v.sDom && (S.sDom = '<"H"lfr>t<"F"ip>'), S.renderer ? n.isPlainObject(S.renderer) && !S.renderer.header && (S.renderer.header = "jqueryui") : S.renderer = "jqueryui") : n.extend(g, Vt.ext.classes, f.oClasses), O.addClass(g.sTable), ("" !== S.oScroll.sX || "" !== S.oScroll.sY) && (S.oScroll.iBarWidth = Ct()), !0 === S.oScroll.sX && (S.oScroll.sX = "100%"), S.iInitDisplayStart === i && (S.iInitDisplayStart = f.iDisplayStart, S._iDisplayStart = f.iDisplayStart), null !== f.iDeferLoading && (S.bDeferLoading = !0, m = n.isArray(f.iDeferLoading), S._iRecordsDisplay = m ? f.iDeferLoading[0] : f.iDeferLoading, S._iRecordsTotal = m ? f.iDeferLoading[1] : f.iDeferLoading);
                    var _ = S.oLanguage;
                    n.extend(!0, _, f.oLanguage), "" !== _.sUrl && (n.ajax({
                        dataType: "json",
                        url: _.sUrl,
                        success: function (e) {
                            a(e), r(v.oLanguage, e), n.extend(!0, _, e), rt(S)
                        },
                        error: function () {
                            rt(S)
                        }
                    }), y = !0), null === f.asStripeClasses && (S.asStripeClasses = [g.sStripeOdd, g.sStripeEven]);
                    var m = S.asStripeClasses, T = O.children("tbody").find("tr").eq(0);
                    if (-1 !== n.inArray(!0, n.map(m, function (e) {
                            return T.hasClass(e)
                        })) && (n("tbody tr", this).removeClass(m.join(" ")), S.asDestroyStripes = m.slice()), C = [], m = this.getElementsByTagName("thead"), 0 !== m.length && (B(S.aoHeader, m[0]), C = U(S)), null === f.aoColumns)for (x = [], m = 0, d = C.length; d > m; m++)x.push(null); else x = f.aoColumns;
                    for (m = 0, d = x.length; d > m; m++)c(S, C ? C[m] : null);
                    if (b(S, f.aoColumnDefs, x, function (e, t) {
                            p(S, e, t)
                        }), T.length) {
                        var E = function (e, t) {
                            return null !== e.getAttribute("data-" + t) ? t : null
                        };
                        n.each(M(S, T[0]).cells, function (e, t) {
                            var n = S.aoColumns[e];
                            if (n.mData === e) {
                                var s = E(t, "sort") || E(t, "order"), r = E(t, "filter") || E(t, "search");
                                (null !== s || null !== r) && (n.mData = {
                                    _: e + ".display",
                                    sort: null !== s ? e + ".@data-" + s : i,
                                    type: null !== s ? e + ".@data-" + s : i,
                                    filter: null !== r ? e + ".@data-" + r : i
                                }, p(S, e))
                            }
                        })
                    }
                    var N = S.oFeatures;
                    if (f.bStateSave && (N.bStateSave = !0, kt(S, f), zt(S, "aoDrawCallback", Mt, "state_save")), f.aaSorting === i)for (C = S.aaSorting, m = 0, d = C.length; d > m; m++)C[m][1] = S.aoColumns[m].asSorting[0];
                    if (Nt(S), N.bSort && zt(S, "aoDrawCallback", function () {
                            if (S.bSorted) {
                                var e = xt(S), t = {};
                                n.each(e, function (e, i) {
                                    t[i.src] = i.dir
                                }), Bt(S, null, "order", [S, e, t]), _t(S)
                            }
                        }), zt(S, "aoDrawCallback", function () {
                            (S.bSorted || "ssp" === Ht(S) || N.bDeferRender) && Nt(S)
                        }, "sc"), h(S), m = O.children("caption").each(function () {
                            this._captionSide = O.css("caption-side")
                        }), d = O.children("thead"), 0 === d.length && (d = n("<thead/>").appendTo(this)), S.nTHead = d[0], d = O.children("tbody"), 0 === d.length && (d = n("<tbody/>").appendTo(this)), S.nTBody = d[0], d = O.children("tfoot"), 0 === d.length && 0 < m.length && ("" !== S.oScroll.sX || "" !== S.oScroll.sY) && (d = n("<tfoot/>").appendTo(this)), 0 === d.length || 0 === d.children().length ? O.addClass(g.sNoFooter) : 0 < d.length && (S.nTFoot = d[0], B(S.aoFooter, S.nTFoot)), f.aaData)for (m = 0; m < f.aaData.length; m++)L(S, f.aaData[m]); else(S.bDeferLoading || "dom" == Ht(S)) && w(S, n(S.nTBody).children("tr"));
                    S.aiDisplay = S.aiDisplayMaster.slice(), S.bInitialised = !0, !1 === y && rt(S)
                }
            }), t = null, this
        };
        var Li = [], wi = Array.prototype, Oi = function (e) {
            var t, i, s = Vt.settings, r = n.map(s, function (e) {
                return e.nTable
            });
            return e ? e.nTable && e.oApi ? [e] : e.nodeName && "table" === e.nodeName.toLowerCase() ? (t = n.inArray(e, r), -1 !== t ? [s[t]] : null) : e && "function" == typeof e.settings ? e.settings().toArray() : ("string" == typeof e ? i = n(e) : e instanceof n && (i = e), i ? i.map(function () {
                return t = n.inArray(this, r), -1 !== t ? s[t] : null
            }).toArray() : void 0) : []
        };
        Xt = function (e, t) {
            if (!(this instanceof Xt))return new Xt(e, t);
            var i = [], s = function (e) {
                (e = Oi(e)) && i.push.apply(i, e)
            };
            if (n.isArray(e))for (var r = 0, a = e.length; a > r; r++)s(e[r]); else s(e);
            this.context = di(i), t && this.push.apply(this, t.toArray ? t.toArray() : t), this.selector = {
                rows: null,
                cols: null,
                opts: null
            }, Xt.extend(this, this, Li)
        }, Vt.Api = Xt, Xt.prototype = {
            any: function () {
                return 0 !== this.flatten().length
            },
            concat: wi.concat,
            context: [],
            each: function (e) {
                for (var t = 0, i = this.length; i > t; t++)e.call(this, this[t], t, this);
                return this
            },
            eq: function (e) {
                var t = this.context;
                return t.length > e ? new Xt(t[e], this[e]) : null
            },
            filter: function (e) {
                var t = [];
                if (wi.filter) t = wi.filter.call(this, e, this); else for (var i = 0, n = this.length; n > i; i++)e.call(this, this[i], i, this) && t.push(this[i]);
                return new Xt(this.context, t)
            },
            flatten: function () {
                var e = [];
                return new Xt(this.context, e.concat.apply(e, this.toArray()))
            },
            join: wi.join,
            indexOf: wi.indexOf || function (e, t) {
                for (var i = t || 0, n = this.length; n > i; i++)if (this[i] === e)return i;
                return -1
            },
            iterator: function (e, t, n, s) {
                var r, a, o, l, h, u, c, p = [], d = this.context, f = this.selector;
                for ("string" == typeof e && (s = n, n = t, t = e, e = !1), a = 0, o = d.length; o > a; a++) {
                    var m = new Xt(d[a]);
                    if ("table" === t) r = n.call(m, d[a], a), r !== i && p.push(r); else if ("columns" === t || "rows" === t) r = n.call(m, d[a], this[a], a), r !== i && p.push(r); else if ("column" === t || "column-rows" === t || "row" === t || "cell" === t)for (c = this[a], "column-rows" === t && (u = Ti(d[a], f.opts)), l = 0, h = c.length; h > l; l++)r = c[l], r = "cell" === t ? n.call(m, d[a], r.row, r.column, a, l) : n.call(m, d[a], r, a, l, u), r !== i && p.push(r)
                }
                return p.length || s ? (e = new Xt(d, e ? p.concat.apply([], p) : p), t = e.selector, t.rows = f.rows, t.cols = f.cols, t.opts = f.opts, e) : this
            },
            lastIndexOf: wi.lastIndexOf || function () {
                return this.indexOf.apply(this.toArray.reverse(), arguments)
            },
            length: 0,
            map: function (e) {
                var t = [];
                if (wi.map) t = wi.map.call(this, e, this); else for (var i = 0, n = this.length; n > i; i++)t.push(e.call(this, this[i], i));
                return new Xt(this.context, t)
            },
            pluck: function (e) {
                return this.map(function (t) {
                    return t[e]
                })
            },
            pop: wi.pop,
            push: wi.push,
            reduce: wi.reduce || function (e, t) {
                return u(this, e, t, 0, this.length, 1)
            },
            reduceRight: wi.reduceRight || function (e, t) {
                return u(this, e, t, this.length - 1, -1, -1)
            },
            reverse: wi.reverse,
            selector: null,
            shift: wi.shift,
            sort: wi.sort,
            splice: wi.splice,
            toArray: function () {
                return wi.slice.call(this)
            },
            to$: function () {
                return n(this)
            },
            toJQuery: function () {
                return n(this)
            },
            unique: function () {
                return new Xt(this.context, di(this))
            },
            unshift: wi.unshift
        }, Xt.extend = function (e, t, i) {
            if (i.length && t && (t instanceof Xt || t.__dt_wrapper)) {
                var s, r, a, o = function (e, t, i) {
                    return function () {
                        var n = t.apply(e, arguments);
                        return Xt.extend(n, n, i.methodExt), n
                    }
                };
                for (s = 0, r = i.length; r > s; s++)a = i[s], t[a.name] = "function" == typeof a.val ? o(e, a.val, a) : n.isPlainObject(a.val) ? {} : a.val, t[a.name].__dt_wrapper = !0, Xt.extend(e, t[a.name], a.propExt)
            }
        }, Xt.register = Yt = function (e, t) {
            if (n.isArray(e))for (var i = 0, s = e.length; s > i; i++)Xt.register(e[i], t); else for (var r, a, o = e.split("."), l = Li, i = 0, s = o.length; s > i; i++) {
                r = (a = -1 !== o[i].indexOf("()")) ? o[i].replace("()", "") : o[i];
                var h;
                e:{
                    h = 0;
                    for (var u = l.length; u > h; h++)if (l[h].name === r) {
                        h = l[h];
                        break e
                    }
                    h = null
                }
                h || (h = {
                    name: r,
                    val: {},
                    methodExt: [],
                    propExt: []
                }, l.push(h)), i === s - 1 ? h.val = t : l = a ? h.methodExt : h.propExt
            }
        }, Xt.registerPlural = Zt = function (e, t, s) {
            Xt.register(e, s), Xt.register(t, function () {
                var e = s.apply(this, arguments);
                return e === this ? this : e instanceof Xt ? e.length ? n.isArray(e[0]) ? new Xt(e.context, e[0]) : e[0] : i : e
            })
        }, Yt("tables()", function (e) {
            var t;
            if (e) {
                t = Xt;
                var i = this.context;
                if ("number" == typeof e) e = [i[e]]; else var s = n.map(i, function (e) {
                    return e.nTable
                }), e = n(s).filter(e).map(function () {
                    var e = n.inArray(this, s);
                    return i[e]
                }).toArray();
                t = new t(e)
            } else t = this;
            return t
        }), Yt("table()", function (e) {
            var e = this.tables(e), t = e.context;
            return t.length ? new Xt(t[0]) : e
        }), Zt("tables().nodes()", "table().node()", function () {
            return this.iterator("table", function (e) {
                return e.nTable
            }, 1)
        }), Zt("tables().body()", "table().body()", function () {
            return this.iterator("table", function (e) {
                return e.nTBody
            }, 1)
        }), Zt("tables().header()", "table().header()", function () {
            return this.iterator("table", function (e) {
                return e.nTHead
            }, 1)
        }), Zt("tables().footer()", "table().footer()", function () {
            return this.iterator("table", function (e) {
                return e.nTFoot
            }, 1)
        }), Zt("tables().containers()", "table().container()", function () {
            return this.iterator("table", function (e) {
                return e.nTableWrapper
            }, 1)
        }), Yt("draw()", function (e) {
            return this.iterator("table", function (t) {
                R(t, !1 === e)
            })
        }), Yt("page()", function (e) {
            return e === i ? this.page.info().page : this.iterator("table", function (t) {
                ut(t, e)
            })
        }), Yt("page.info()", function () {
            if (0 === this.context.length)return i;
            var e = this.context[0], t = e._iDisplayStart, n = e._iDisplayLength, s = e.fnRecordsDisplay(), r = -1 === n;
            return {
                page: r ? 0 : Math.floor(t / n),
                pages: r ? 1 : Math.ceil(s / n),
                start: t,
                end: e.fnDisplayEnd(),
                length: n,
                recordsTotal: e.fnRecordsTotal(),
                recordsDisplay: s
            }
        }), Yt("page.len()", function (e) {
            return e === i ? 0 !== this.context.length ? this.context[0]._iDisplayLength : i : this.iterator("table", function (t) {
                ot(t, e)
            })
        });
        var Ci = function (e, t, i) {
            if (i) {
                var n = new Xt(e);
                n.one("draw", function () {
                    i(n.ajax.json())
                })
            }
            "ssp" == Ht(e) ? R(e, t) : (pt(e, !0), j(e, [], function (i) {
                E(e);
                for (var i = W(e, i), n = 0, s = i.length; s > n; n++)L(e, i[n]);
                R(e, t), pt(e, !1)
            }))
        };
        Yt("ajax.json()", function () {
            var e = this.context;
            return 0 < e.length ? e[0].json : void 0
        }), Yt("ajax.params()", function () {
            var e = this.context;
            return 0 < e.length ? e[0].oAjaxData : void 0
        }), Yt("ajax.reload()", function (e, t) {
            return this.iterator("table", function (i) {
                Ci(i, !1 === t, e)
            })
        }), Yt("ajax.url()", function (e) {
            var t = this.context;
            return e === i ? 0 === t.length ? i : (t = t[0], t.ajax ? n.isPlainObject(t.ajax) ? t.ajax.url : t.ajax : t.sAjaxSource) : this.iterator("table", function (t) {
                n.isPlainObject(t.ajax) ? t.ajax.url = e : t.ajax = e
            })
        }), Yt("ajax.url().load()", function (e, t) {
            return this.iterator("table", function (i) {
                Ci(i, !1 === t, e)
            })
        });
        var xi = function (e, t, s, r, a) {
            var o, l, h, u, c, p, d = [];
            for (h = typeof t, t && "string" !== h && "function" !== h && t.length !== i || (t = [t]), h = 0, u = t.length; u > h; h++)for (l = t[h] && t[h].split ? t[h].split(",") : [t[h]], c = 0, p = l.length; p > c; c++)(o = s("string" == typeof l[c] ? n.trim(l[c]) : l[c])) && o.length && d.push.apply(d, o);
            if (e = qt.selector[e], e.length)for (h = 0, u = e.length; u > h; h++)d = e[h](r, a, d);
            return d
        }, Si = function (e) {
            return e || (e = {}), e.filter && e.search === i && (e.search = e.filter), n.extend({
                search: "none",
                order: "current",
                page: "all"
            }, e)
        }, _i = function (e) {
            for (var t = 0, i = e.length; i > t; t++)if (0 < e[t].length)return e[0] = e[t], e[0].length = 1, e.length = 1, e.context = [e.context[t]], e;
            return e.length = 0, e
        }, Ti = function (e, t) {
            var i, s, r, a = [], o = e.aiDisplay;
            i = e.aiDisplayMaster;
            var l = t.search;
            if (s = t.order, r = t.page, "ssp" == Ht(e))return "removed" === l ? [] : ci(0, i.length);
            if ("current" == r)for (i = e._iDisplayStart, s = e.fnDisplayEnd(); s > i; i++)a.push(o[i]); else if ("current" == s || "applied" == s) a = "none" == l ? i.slice() : "applied" == l ? o.slice() : n.map(i, function (e) {
                return -1 === n.inArray(e, o) ? e : null
            }); else if ("index" == s || "original" == s)for (i = 0, s = e.aoData.length; s > i; i++)"none" == l ? a.push(i) : (r = n.inArray(i, o), (-1 === r && "removed" == l || r >= 0 && "applied" == l) && a.push(i));
            return a
        };
        Yt("rows()", function (e, t) {
            e === i ? e = "" : n.isPlainObject(e) && (t = e, e = "");
            var t = Si(t), s = this.iterator("table", function (i) {
                var s = t;
                return xi("row", e, function (e) {
                    var t = ri(e);
                    if (null !== t && !s)return [t];
                    var r = Ti(i, s);
                    return null !== t && -1 !== n.inArray(t, r) ? [t] : e ? "function" == typeof e ? n.map(r, function (t) {
                        var n = i.aoData[t];
                        return e(t, n._aData, n.nTr) ? t : null
                    }) : (t = pi(ui(i.aoData, r, "nTr")), e.nodeName && -1 !== n.inArray(e, t) ? [e._DT_RowIndex] : n(t).filter(e).map(function () {
                        return this._DT_RowIndex
                    }).toArray()) : r
                }, i, s)
            }, 1);
            return s.selector.rows = e, s.selector.opts = t, s
        }), Yt("rows().nodes()", function () {
            return this.iterator("row", function (e, t) {
                return e.aoData[t].nTr || i
            }, 1)
        }), Yt("rows().data()", function () {
            return this.iterator(!0, "rows", function (e, t) {
                return ui(e.aoData, t, "_aData")
            }, 1)
        }), Zt("rows().cache()", "row().cache()", function (e) {
            return this.iterator("row", function (t, i) {
                var n = t.aoData[i];
                return "search" === e ? n._aFilterData : n._aSortData
            }, 1)
        }), Zt("rows().invalidate()", "row().invalidate()", function (e) {
            return this.iterator("row", function (t, i) {
                P(t, i, e)
            })
        }), Zt("rows().indexes()", "row().index()", function () {
            return this.iterator("row", function (e, t) {
                return t
            }, 1)
        }), Zt("rows().remove()", "row().remove()", function () {
            var e = this;
            return this.iterator("row", function (t, i, s) {
                var r = t.aoData;
                r.splice(i, 1);
                for (var a = 0, o = r.length; o > a; a++)null !== r[a].nTr && (r[a].nTr._DT_RowIndex = a);
                n.inArray(i, t.aiDisplay), N(t.aiDisplayMaster, i), N(t.aiDisplay, i), N(e[s], i, !1), Ut(t)
            })
        }), Yt("rows.add()", function (e) {
            var t = this.iterator("table", function (t) {
                var i, n, s, r = [];
                for (n = 0, s = e.length; s > n; n++)i = e[n], i.nodeName && "TR" === i.nodeName.toUpperCase() ? r.push(w(t, i)[0]) : r.push(L(t, i));
                return r
            }, 1), i = this.rows(-1);
            return i.pop(), i.push.apply(i, t.toArray()), i
        }), Yt("row()", function (e, t) {
            return _i(this.rows(e, t))
        }), Yt("row().data()", function (e) {
            var t = this.context;
            return e === i ? t.length && this.length ? t[0].aoData[this[0]]._aData : i : (t[0].aoData[this[0]]._aData = e, P(t[0], this[0], "data"), this)
        }), Yt("row().node()", function () {
            var e = this.context;
            return e.length && this.length ? e[0].aoData[this[0]].nTr || null : null
        }), Yt("row.add()", function (e) {
            e instanceof n && e.length && (e = e[0]);
            var t = this.iterator("table", function (t) {
                return e.nodeName && "TR" === e.nodeName.toUpperCase() ? w(t, e)[0] : L(t, e)
            });
            return this.row(t[0])
        });
        var Ei = function (e, t) {
            var n = e.context;
            n.length && (n = n[0].aoData[t !== i ? t : e[0]], n._details && (n._details.remove(), n._detailsShow = i, n._details = i))
        }, Ni = function (e, t) {
            var i = e.context;
            if (i.length && e.length) {
                var n = i[0].aoData[e[0]];
                if (n._details) {
                    (n._detailsShow = t) ? n._details.insertAfter(n.nTr) : n._details.detach();
                    var s = i[0], r = new Xt(s), a = s.aoData;
                    r.off("draw.dt.DT_details column-visibility.dt.DT_details destroy.dt.DT_details"), 0 < hi(a, "_details").length && (r.on("draw.dt.DT_details", function (e, t) {
                        s === t && r.rows({page: "current"}).eq(0).each(function (e) {
                            e = a[e], e._detailsShow && e._details.insertAfter(e.nTr)
                        })
                    }), r.on("column-visibility.dt.DT_details", function (e, t) {
                        if (s === t)for (var i, n = g(t), r = 0, o = a.length; o > r; r++)i = a[r], i._details && i._details.children("td[colspan]").attr("colspan", n)
                    }), r.on("destroy.dt.DT_details", function (e, t) {
                        if (s === t)for (var i = 0, n = a.length; n > i; i++)a[i]._details && Ei(r, i)
                    }))
                }
            }
        };
        Yt("row().child()", function (e, t) {
            var s = this.context;
            if (e === i)return s.length && this.length ? s[0].aoData[this[0]]._details : i;
            if (!0 === e) this.child.show(); else if (!1 === e) Ei(this); else if (s.length && this.length) {
                var r = s[0], s = s[0].aoData[this[0]], a = [], o = function (e, t) {
                    if (n.isArray(e) || e instanceof n)for (var i = 0, s = e.length; s > i; i++)o(e[i], t); else e.nodeName && "tr" === e.nodeName.toLowerCase() ? a.push(e) : (i = n("<tr><td/></tr>").addClass(t), n("td", i).addClass(t).html(e)[0].colSpan = g(r), a.push(i[0]))
                };
                o(e, t), s._details && s._details.remove(), s._details = n(a), s._detailsShow && s._details.insertAfter(s.nTr)
            }
            return this
        }), Yt(["row().child.show()", "row().child().show()"], function () {
            return Ni(this, !0), this
        }), Yt(["row().child.hide()", "row().child().hide()"], function () {
            return Ni(this, !1), this
        }), Yt(["row().child.remove()", "row().child().remove()"], function () {
            return Ei(this), this
        }), Yt("row().child.isShown()", function () {
            var e = this.context;
            return e.length && this.length ? e[0].aoData[this[0]]._detailsShow || !1 : !1
        });
        var Pi = /^(.+):(name|visIdx|visible)$/, Mi = function (e, t, i, n, s) {
            for (var i = [], n = 0, r = s.length; r > n; n++)i.push(O(e, s[n], t));
            return i
        };
        Yt("columns()", function (e, t) {
            e === i ? e = "" : n.isPlainObject(e) && (t = e, e = "");
            var t = Si(t), s = this.iterator("table", function (i) {
                var s = e, r = t, a = i.aoColumns, o = hi(a, "sName"), l = hi(a, "nTh");
                return xi("column", s, function (e) {
                    var t = ri(e);
                    if ("" === e)return ci(a.length);
                    if (null !== t)return [t >= 0 ? t : a.length + t];
                    if ("function" == typeof e) {
                        var s = Ti(i, r);
                        return n.map(a, function (t, n) {
                            return e(n, Mi(i, n, 0, 0, s), l[n]) ? n : null
                        })
                    }
                    var h = "string" == typeof e ? e.match(Pi) : "";
                    if (!h)return n(l).filter(e).map(function () {
                        return n.inArray(this, l)
                    }).toArray();
                    switch (h[2]) {
                        case"visIdx":
                        case"visible":
                            if (t = parseInt(h[1], 10), 0 > t) {
                                var u = n.map(a, function (e, t) {
                                    return e.bVisible ? t : null
                                });
                                return [u[u.length + t]]
                            }
                            return [f(i, t)];
                        case"name":
                            return n.map(o, function (e, t) {
                                return e === h[1] ? t : null
                            })
                    }
                }, i, r)
            }, 1);
            return s.selector.cols = e, s.selector.opts = t, s
        }), Zt("columns().header()", "column().header()", function () {
            return this.iterator("column", function (e, t) {
                return e.aoColumns[t].nTh
            }, 1)
        }), Zt("columns().footer()", "column().footer()", function () {
            return this.iterator("column", function (e, t) {
                return e.aoColumns[t].nTf
            }, 1)
        }), Zt("columns().data()", "column().data()", function () {
            return this.iterator("column-rows", Mi, 1)
        }), Zt("columns().dataSrc()", "column().dataSrc()", function () {
            return this.iterator("column", function (e, t) {
                return e.aoColumns[t].mData
            }, 1)
        }), Zt("columns().cache()", "column().cache()", function (e) {
            return this.iterator("column-rows", function (t, i, n, s, r) {
                return ui(t.aoData, r, "search" === e ? "_aFilterData" : "_aSortData", i)
            }, 1)
        }), Zt("columns().nodes()", "column().nodes()", function () {
            return this.iterator("column-rows", function (e, t, i, n, s) {
                return ui(e.aoData, s, "anCells", t)
            }, 1)
        }), Zt("columns().visible()", "column().visible()", function (e, t) {
            return this.iterator("column", function (s, r) {
                if (e === i)return s.aoColumns[r].bVisible;
                var a, o, l, h = s.aoColumns, u = h[r], c = s.aoData;
                if (e !== i && u.bVisible !== e) {
                    if (e) {
                        var p = n.inArray(!0, hi(h, "bVisible"), r + 1);
                        for (a = 0, o = c.length; o > a; a++)l = c[a].nTr, h = c[a].anCells, l && l.insertBefore(h[r], h[p] || null)
                    } else n(hi(s.aoData, "anCells", r)).detach();
                    u.bVisible = e, A(s, s.aoHeader), A(s, s.aoFooter), (t === i || t) && (d(s), (s.oScroll.sX || s.oScroll.sY) && ft(s)), Bt(s, null, "column-visibility", [s, r, e]), Mt(s)
                }
            })
        }), Zt("columns().indexes()", "column().index()", function (e) {
            return this.iterator("column", function (t, i) {
                return "visible" === e ? m(t, i) : i
            }, 1)
        }), Yt("columns.adjust()", function () {
            return this.iterator("table", function (e) {
                d(e)
            }, 1)
        }), Yt("column.index()", function (e, t) {
            if (0 !== this.context.length) {
                var i = this.context[0];
                if ("fromVisible" === e || "toData" === e)return f(i, t);
                if ("fromData" === e || "toVisible" === e)return m(i, t)
            }
        }), Yt("column()", function (e, t) {
            return _i(this.columns(e, t))
        }), Yt("cells()", function (e, t, s) {
            if (n.isPlainObject(e) && (e.row === i ? (s = e, e = null) : (s = t, t = null)), n.isPlainObject(t) && (s = t, t = null), null === t || t === i)return this.iterator("table", function (t) {
                var r, a, o, l, h, u, c, p = e, d = Si(s), f = t.aoData, m = Ti(t, d), g = pi(ui(f, m, "anCells")), y = n([].concat.apply([], g)), v = t.aoColumns.length;
                return xi("cell", p, function (e) {
                    var s = "function" == typeof e;
                    if (null === e || e === i || s) {
                        for (a = [], o = 0, l = m.length; l > o; o++)for (r = m[o], h = 0; v > h; h++)u = {
                            row: r,
                            column: h
                        }, s ? (c = t.aoData[r], e(u, O(t, r, h), c.anCells ? c.anCells[h] : null) && a.push(u)) : a.push(u);
                        return a
                    }
                    return n.isPlainObject(e) ? [e] : y.filter(e).map(function (e, t) {
                        return r = t.parentNode._DT_RowIndex, {row: r, column: n.inArray(t, f[r].anCells)}
                    }).toArray()
                }, t, d)
            });
            var r, a, o, l, h, u = this.columns(t, s), c = this.rows(e, s), p = this.iterator("table", function (e, t) {
                for (r = [], a = 0, o = c[t].length; o > a; a++)for (l = 0, h = u[t].length; h > l; l++)r.push({
                    row: c[t][a],
                    column: u[t][l]
                });
                return r
            }, 1);
            return n.extend(p.selector, {cols: t, rows: e, opts: s}), p
        }), Zt("cells().nodes()", "cell().node()", function () {
            return this.iterator("cell", function (e, t, n) {
                return (e = e.aoData[t].anCells) ? e[n] : i
            }, 1)
        }), Yt("cells().data()", function () {
            return this.iterator("cell", function (e, t, i) {
                return O(e, t, i)
            }, 1)
        }), Zt("cells().cache()", "cell().cache()", function (e) {
            return e = "search" === e ? "_aFilterData" : "_aSortData", this.iterator("cell", function (t, i, n) {
                return t.aoData[i][e][n]
            }, 1)
        }), Zt("cells().render()", "cell().render()", function (e) {
            return this.iterator("cell", function (t, i, n) {
                return O(t, i, n, e)
            }, 1)
        }), Zt("cells().indexes()", "cell().index()", function () {
            return this.iterator("cell", function (e, t, i) {
                return {row: t, column: i, columnVisible: m(e, i)}
            }, 1)
        }), Zt("cells().invalidate()", "cell().invalidate()", function (e) {
            return this.iterator("cell", function (t, i, n) {
                P(t, i, e, n)
            })
        }), Yt("cell()", function (e, t, i) {
            return _i(this.cells(e, t, i))
        }), Yt("cell().data()", function (e) {
            var t = this.context, n = this[0];
            return e === i ? t.length && n.length ? O(t[0], n[0].row, n[0].column) : i : (C(t[0], n[0].row, n[0].column, e), P(t[0], n[0].row, "data", n[0].column), this)
        }), Yt("order()", function (e, t) {
            var s = this.context;
            return e === i ? 0 !== s.length ? s[0].aaSorting : i : ("number" == typeof e ? e = [[e, t]] : n.isArray(e[0]) || (e = Array.prototype.slice.call(arguments)), this.iterator("table", function (t) {
                t.aaSorting = e.slice()
            }))
        }), Yt("order.listener()", function (e, t, i) {
            return this.iterator("table", function (n) {
                Et(n, e, t, i)
            })
        }), Yt(["columns().order()", "column().order()"], function (e) {
            var t = this;
            return this.iterator("table", function (i, s) {
                var r = [];
                n.each(t[s], function (t, i) {
                    r.push([i, e])
                }), i.aaSorting = r
            })
        }), Yt("search()", function (e, t, s, r) {
            var a = this.context;
            return e === i ? 0 !== a.length ? a[0].oPreviousSearch.sSearch : i : this.iterator("table", function (i) {
                i.oFeatures.bFilter && q(i, n.extend({}, i.oPreviousSearch, {
                    sSearch: e + "",
                    bRegex: null === t ? !1 : t,
                    bSmart: null === s ? !0 : s,
                    bCaseInsensitive: null === r ? !0 : r
                }), 1)
            })
        }), Zt("columns().search()", "column().search()", function (e, t, s, r) {
            return this.iterator("column", function (a, o) {
                var l = a.aoPreSearchCols;
                return e === i ? l[o].sSearch : (a.oFeatures.bFilter && (n.extend(l[o], {
                    sSearch: e + "",
                    bRegex: null === t ? !1 : t,
                    bSmart: null === s ? !0 : s,
                    bCaseInsensitive: null === r ? !0 : r
                }), q(a, a.oPreviousSearch, 1)), void 0)
            })
        }), Yt("state()", function () {
            return this.context.length ? this.context[0].oSavedState : null
        }), Yt("state.clear()", function () {
            return this.iterator("table", function (e) {
                e.fnStateSaveCallback.call(e.oInstance, e, {})
            })
        }), Yt("state.loaded()", function () {
            return this.context.length ? this.context[0].oLoadedState : null
        }), Yt("state.save()", function () {
            return this.iterator("table", function (e) {
                Mt(e)
            })
        }), Vt.versionCheck = Vt.fnVersionCheck = function (e) {
            for (var t, i, n = Vt.version.split("."), e = e.split("."), s = 0, r = e.length; r > s; s++)if (t = parseInt(n[s], 10) || 0, i = parseInt(e[s], 10) || 0, t !== i)return t > i;
            return !0
        }, Vt.isDataTable = Vt.fnIsDataTable = function (e) {
            var t = n(e).get(0), i = !1;
            return n.each(Vt.settings, function (e, s) {
                var r = s.nScrollHead ? n("table", s.nScrollHead)[0] : null, a = s.nScrollFoot ? n("table", s.nScrollFoot)[0] : null;
                (s.nTable === t || r === t || a === t) && (i = !0)
            }), i
        }, Vt.tables = Vt.fnTables = function (e) {
            return n.map(Vt.settings, function (t) {
                return !e || e && n(t.nTable).is(":visible") ? t.nTable : void 0
            })
        }, Vt.util = {throttle: yt, escapeRegex: J}, Vt.camelToHungarian = r, Yt("$()", function (e, t) {
            var i = this.rows(t).nodes(), i = n(i);
            return n([].concat(i.filter(e).toArray(), i.find(e).toArray()))
        }), n.each(["on", "one", "off"], function (e, t) {
            Yt(t + "()", function () {
                var e = Array.prototype.slice.call(arguments);
                e[0].match(/\.dt\b/) || (e[0] += ".dt");
                var i = n(this.tables().nodes());
                return i[t].apply(i, e), this
            })
        }), Yt("clear()", function () {
            return this.iterator("table", function (e) {
                E(e)
            })
        }), Yt("settings()", function () {
            return new Xt(this.context, this.context)
        }), Yt("init()", function () {
            var e = this.context;
            return e.length ? e[0].oInit : null
        }), Yt("data()", function () {
            return this.iterator("table", function (e) {
                return hi(e.aoData, "_aData")
            }).flatten()
        }), Yt("destroy()", function (t) {
            return t = t || !1, this.iterator("table", function (i) {
                var s, r = i.nTableWrapper.parentNode, a = i.oClasses, o = i.nTable, l = i.nTBody, h = i.nTHead, u = i.nTFoot, c = n(o), l = n(l), p = n(i.nTableWrapper), d = n.map(i.aoData, function (e) {
                    return e.nTr
                });
                i.bDestroying = !0, Bt(i, "aoDestroyCallback", "destroy", [i]), t || new Xt(i).columns().visible(!0), p.unbind(".DT").find(":not(tbody *)").unbind(".DT"), n(e).unbind(".DT-" + i.sInstance), o != h.parentNode && (c.children("thead").detach(), c.append(h)), u && o != u.parentNode && (c.children("tfoot").detach(), c.append(u)), c.detach(), p.detach(), i.aaSorting = [], i.aaSortingFixed = [], Nt(i), n(d).removeClass(i.asStripeClasses.join(" ")), n("th, td", h).removeClass(a.sSortable + " " + a.sSortableAsc + " " + a.sSortableDesc + " " + a.sSortableNone), i.bJUI && (n("th span." + a.sSortIcon + ", td span." + a.sSortIcon, h).detach(), n("th, td", h).each(function () {
                    var e = n("div." + a.sSortJUIWrapper, this);
                    n(this).append(e.contents()), e.detach()
                })), !t && r && r.insertBefore(o, i.nTableReinsertBefore), l.children().detach(), l.append(d), c.css("width", i.sDestroyWidth).removeClass(a.sTable), (s = i.asDestroyStripes.length) && l.children().each(function (e) {
                    n(this).addClass(i.asDestroyStripes[e % s])
                }), r = n.inArray(i, Vt.settings), -1 !== r && Vt.settings.splice(r, 1)
            })
        }), n.each(["column", "row", "cell"], function (e, t) {
            Yt(t + "s().every()", function (e) {
                return this.iterator(t, function (i, n, s) {
                    e.call(new Xt(i)[t](n, s))
                })
            })
        }), Yt("i18n()", function (e, t, s) {
            var r = this.context[0], e = S(e)(r.oLanguage);
            return e === i && (e = t), s !== i && n.isPlainObject(e) && (e = e[s] !== i ? e[s] : e._), e.replace("%d", s)
        }), Vt.version = "1.10.7", Vt.settings = [], Vt.models = {}, Vt.models.oSearch = {
            bCaseInsensitive: !0,
            sSearch: "",
            bRegex: !1,
            bSmart: !0
        }, Vt.models.oRow = {
            nTr: null,
            anCells: null,
            _aData: [],
            _aSortData: null,
            _aFilterData: null,
            _sFilterRow: null,
            _sRowStripe: "",
            src: null
        }, Vt.models.oColumn = {
            idx: null,
            aDataSort: null,
            asSorting: null,
            bSearchable: null,
            bSortable: null,
            bVisible: null,
            _sManualType: null,
            _bAttrSrc: !1,
            fnCreatedCell: null,
            fnGetData: null,
            fnSetData: null,
            mData: null,
            mRender: null,
            nTh: null,
            nTf: null,
            sClass: null,
            sContentPadding: null,
            sDefaultContent: null,
            sName: null,
            sSortDataType: "std",
            sSortingClass: null,
            sSortingClassJUI: null,
            sTitle: null,
            sType: null,
            sWidth: null,
            sWidthOrig: null
        }, Vt.defaults = {
            aaData: null,
            aaSorting: [[0, "asc"]],
            aaSortingFixed: [],
            ajax: null,
            aLengthMenu: [10, 25, 50, 100],
            aoColumns: null,
            aoColumnDefs: null,
            aoSearchCols: [],
            asStripeClasses: null,
            bAutoWidth: !0,
            bDeferRender: !1,
            bDestroy: !1,
            bFilter: !0,
            bInfo: !0,
            bJQueryUI: !1,
            bLengthChange: !0,
            bPaginate: !0,
            bProcessing: !1,
            bRetrieve: !1,
            bScrollCollapse: !1,
            bServerSide: !1,
            bSort: !0,
            bSortMulti: !0,
            bSortCellsTop: !1,
            bSortClasses: !0,
            bStateSave: !1,
            fnCreatedRow: null,
            fnDrawCallback: null,
            fnFooterCallback: null,
            fnFormatNumber: function (e) {
                return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g, this.oLanguage.sThousands)
            },
            fnHeaderCallback: null,
            fnInfoCallback: null,
            fnInitComplete: null,
            fnPreDrawCallback: null,
            fnRowCallback: null,
            fnServerData: null,
            fnServerParams: null,
            fnStateLoadCallback: function (e) {
                try {
                    return JSON.parse((-1 === e.iStateDuration ? sessionStorage : localStorage).getItem("DataTables_" + e.sInstance + "_" + location.pathname))
                } catch (t) {
                }
            },
            fnStateLoadParams: null,
            fnStateLoaded: null,
            fnStateSaveCallback: function (e, t) {
                try {
                    (-1 === e.iStateDuration ? sessionStorage : localStorage).setItem("DataTables_" + e.sInstance + "_" + location.pathname, JSON.stringify(t))
                } catch (i) {
                }
            },
            fnStateSaveParams: null,
            iStateDuration: 7200,
            iDeferLoading: null,
            iDisplayLength: 10,
            iDisplayStart: 0,
            iTabIndex: 0,
            oClasses: {},
            oLanguage: {
                oAria: {
                    sSortAscending: ": activate to sort column ascending",
                    sSortDescending: ": activate to sort column descending"
                },
                oPaginate: {sFirst: "First", sLast: "Last", sNext: "Next", sPrevious: "Previous"},
                sEmptyTable: "No data available in table",
                sInfo: "Showing _START_ to _END_ of _TOTAL_ entries",
                sInfoEmpty: "Showing 0 to 0 of 0 entries",
                sInfoFiltered: "(filtered from _MAX_ total entries)",
                sInfoPostFix: "",
                sDecimal: "",
                sThousands: ",",
                sLengthMenu: "Show _MENU_ entries",
                sLoadingRecords: "Loading...",
                sProcessing: "Processing...",
                sSearch: "Search:",
                sSearchPlaceholder: "",
                sUrl: "",
                sZeroRecords: "No matching records found"
            },
            oSearch: n.extend({}, Vt.models.oSearch),
            sAjaxDataProp: "data",
            sAjaxSource: null,
            sDom: "lfrtip",
            searchDelay: null,
            sPaginationType: "simple_numbers",
            sScrollX: "",
            sScrollXInner: "",
            sScrollY: "",
            sServerMethod: "GET",
            renderer: null
        }, s(Vt.defaults), Vt.defaults.column = {
            aDataSort: null,
            iDataSort: -1,
            asSorting: ["asc", "desc"],
            bSearchable: !0,
            bSortable: !0,
            bVisible: !0,
            fnCreatedCell: null,
            mData: null,
            mRender: null,
            sCellType: "td",
            sClass: "",
            sContentPadding: "",
            sDefaultContent: null,
            sName: "",
            sSortDataType: "std",
            sTitle: null,
            sType: null,
            sWidth: null
        }, s(Vt.defaults.column), Vt.models.oSettings = {
            oFeatures: {
                bAutoWidth: null,
                bDeferRender: null,
                bFilter: null,
                bInfo: null,
                bLengthChange: null,
                bPaginate: null,
                bProcessing: null,
                bServerSide: null,
                bSort: null,
                bSortMulti: null,
                bSortClasses: null,
                bStateSave: null
            },
            oScroll: {bCollapse: null, iBarWidth: 0, sX: null, sXInner: null, sY: null},
            oLanguage: {fnInfoCallback: null},
            oBrowser: {bScrollOversize: !1, bScrollbarLeft: !1},
            ajax: null,
            aanFeatures: [],
            aoData: [],
            aiDisplay: [],
            aiDisplayMaster: [],
            aoColumns: [],
            aoHeader: [],
            aoFooter: [],
            oPreviousSearch: {},
            aoPreSearchCols: [],
            aaSorting: null,
            aaSortingFixed: [],
            asStripeClasses: null,
            asDestroyStripes: [],
            sDestroyWidth: 0,
            aoRowCallback: [],
            aoHeaderCallback: [],
            aoFooterCallback: [],
            aoDrawCallback: [],
            aoRowCreatedCallback: [],
            aoPreDrawCallback: [],
            aoInitComplete: [],
            aoStateSaveParams: [],
            aoStateLoadParams: [],
            aoStateLoaded: [],
            sTableId: "",
            nTable: null,
            nTHead: null,
            nTFoot: null,
            nTBody: null,
            nTableWrapper: null,
            bDeferLoading: !1,
            bInitialised: !1,
            aoOpenRows: [],
            sDom: null,
            searchDelay: null,
            sPaginationType: "two_button",
            iStateDuration: 0,
            aoStateSave: [],
            aoStateLoad: [],
            oSavedState: null,
            oLoadedState: null,
            sAjaxSource: null,
            sAjaxDataProp: null,
            bAjaxDataGet: !0,
            jqXHR: null,
            json: i,
            oAjaxData: i,
            fnServerData: null,
            aoServerParams: [],
            sServerMethod: null,
            fnFormatNumber: null,
            aLengthMenu: null,
            iDraw: 0,
            bDrawing: !1,
            iDrawError: -1,
            _iDisplayLength: 10,
            _iDisplayStart: 0,
            _iRecordsTotal: 0,
            _iRecordsDisplay: 0,
            bJUI: null,
            oClasses: {},
            bFiltered: !1,
            bSorted: !1,
            bSortCellsTop: null,
            oInit: null,
            aoDestroyCallback: [],
            fnRecordsTotal: function () {
                return "ssp" == Ht(this) ? 1 * this._iRecordsTotal : this.aiDisplayMaster.length
            },
            fnRecordsDisplay: function () {
                return "ssp" == Ht(this) ? 1 * this._iRecordsDisplay : this.aiDisplay.length
            },
            fnDisplayEnd: function () {
                var e = this._iDisplayLength, t = this._iDisplayStart, i = t + e, n = this.aiDisplay.length, s = this.oFeatures, r = s.bPaginate;
                return s.bServerSide ? !1 === r || -1 === e ? t + n : Math.min(t + e, this._iRecordsDisplay) : !r || i > n || -1 === e ? n : i
            },
            oInstance: null,
            sInstance: null,
            iTabIndex: 0,
            nScrollHead: null,
            nScrollFoot: null,
            aLastSort: [],
            oPlugins: {}
        }, Vt.ext = qt = {
            buttons: {},
            classes: {},
            errMode: "alert",
            feature: [],
            search: [],
            selector: {cell: [], column: [], row: []},
            internal: {},
            legacy: {ajax: null},
            pager: {},
            renderer: {pageButton: {}, header: {}},
            order: {},
            type: {detect: [], search: {}, order: {}},
            _unique: 0,
            fnVersionCheck: Vt.fnVersionCheck,
            iApiIndex: 0,
            oJUIClasses: {},
            sVersion: Vt.version
        }, n.extend(qt, {
            afnFiltering: qt.search,
            aTypes: qt.type.detect,
            ofnSearch: qt.type.search,
            oSort: qt.type.order,
            afnSortData: qt.order,
            aoFeatures: qt.feature,
            oApi: qt.internal,
            oStdClasses: qt.classes,
            oPagination: qt.pager
        }), n.extend(Vt.ext.classes, {
            sTable: "dataTable",
            sNoFooter: "no-footer",
            sPageButton: "paginate_button",
            sPageButtonActive: "current",
            sPageButtonDisabled: "disabled",
            sStripeOdd: "odd",
            sStripeEven: "even",
            sRowEmpty: "dataTables_empty",
            sWrapper: "dataTables_wrapper",
            sFilter: "dataTables_filter",
            sInfo: "dataTables_info",
            sPaging: "dataTables_paginate paging_",
            sLength: "dataTables_length",
            sProcessing: "dataTables_processing",
            sSortAsc: "sorting_asc",
            sSortDesc: "sorting_desc",
            sSortable: "sorting",
            sSortableAsc: "sorting_asc_disabled",
            sSortableDesc: "sorting_desc_disabled",
            sSortableNone: "sorting_disabled",
            sSortColumn: "sorting_",
            sFilterInput: "",
            sLengthSelect: "",
            sScrollWrapper: "dataTables_scroll",
            sScrollHead: "dataTables_scrollHead",
            sScrollHeadInner: "dataTables_scrollHeadInner",
            sScrollBody: "dataTables_scrollBody",
            sScrollFoot: "dataTables_scrollFoot",
            sScrollFootInner: "dataTables_scrollFootInner",
            sHeaderTH: "",
            sFooterTH: "",
            sSortJUIAsc: "",
            sSortJUIDesc: "",
            sSortJUI: "",
            sSortJUIAscAllowed: "",
            sSortJUIDescAllowed: "",
            sSortJUIWrapper: "",
            sSortIcon: "",
            sJUIHeader: "",
            sJUIFooter: ""
        });
        var ki = "", ki = "", Fi = ki + "ui-state-default", Di = ki + "css_right ui-icon ui-icon-", Ai = ki + "fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix";
        n.extend(Vt.ext.oJUIClasses, Vt.ext.classes, {
            sPageButton: "fg-button ui-button " + Fi,
            sPageButtonActive: "ui-state-disabled",
            sPageButtonDisabled: "ui-state-disabled",
            sPaging: "dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",
            sSortAsc: Fi + " sorting_asc",
            sSortDesc: Fi + " sorting_desc",
            sSortable: Fi + " sorting",
            sSortableAsc: Fi + " sorting_asc_disabled",
            sSortableDesc: Fi + " sorting_desc_disabled",
            sSortableNone: Fi + " sorting_disabled",
            sSortJUIAsc: Di + "triangle-1-n",
            sSortJUIDesc: Di + "triangle-1-s",
            sSortJUI: Di + "carat-2-n-s",
            sSortJUIAscAllowed: Di + "carat-1-n",
            sSortJUIDescAllowed: Di + "carat-1-s",
            sSortJUIWrapper: "DataTables_sort_wrapper",
            sSortIcon: "DataTables_sort_icon",
            sScrollHead: "dataTables_scrollHead " + Fi,
            sScrollFoot: "dataTables_scrollFoot " + Fi,
            sHeaderTH: Fi,
            sFooterTH: Fi,
            sJUIHeader: Ai + " ui-corner-tl ui-corner-tr",
            sJUIFooter: Ai + " ui-corner-bl ui-corner-br"
        });
        var Ii = Vt.ext.pager;
        n.extend(Ii, {
            simple: function () {
                return ["previous", "next"]
            }, full: function () {
                return ["first", "previous", "next", "last"]
            }, simple_numbers: function (e, t) {
                return ["previous", Gt(e, t), "next"]
            }, full_numbers: function (e, t) {
                return ["first", "previous", Gt(e, t), "next", "last"]
            }, _numbers: Gt, numbers_length: 7
        }), n.extend(!0, Vt.ext.renderer, {
            pageButton: {
                _: function (e, i, s, r, a, o) {
                    var l, h, u, c = e.oClasses, p = e.oLanguage.oPaginate, d = 0, f = function (t, i) {
                        var r, u, m, g, y = function (t) {
                            ut(e, t.data.action, !0)
                        };
                        for (r = 0, u = i.length; u > r; r++)if (g = i[r], n.isArray(g)) m = n("<" + (g.DT_el || "div") + "/>").appendTo(t), f(m, g); else {
                            switch (h = l = "", g) {
                                case"ellipsis":
                                    t.append('<span class="ellipsis">&#x2026;</span>');
                                    break;
                                case"first":
                                    l = p.sFirst, h = g + (a > 0 ? "" : " " + c.sPageButtonDisabled);
                                    break;
                                case"previous":
                                    l = p.sPrevious, h = g + (a > 0 ? "" : " " + c.sPageButtonDisabled);
                                    break;
                                case"next":
                                    l = p.sNext, h = g + (o - 1 > a ? "" : " " + c.sPageButtonDisabled);
                                    break;
                                case"last":
                                    l = p.sLast, h = g + (o - 1 > a ? "" : " " + c.sPageButtonDisabled);
                                    break;
                                default:
                                    l = g + 1, h = a === g ? c.sPageButtonActive : ""
                            }
                            l && (m = n("<a>", {
                                "class": c.sPageButton + " " + h,
                                "aria-controls": e.sTableId,
                                "data-dt-idx": d,
                                tabindex: e.iTabIndex,
                                id: 0 === s && "string" == typeof g ? e.sTableId + "_" + g : null
                            }).html(l).appendTo(t), Rt(m, {action: g}, y), d++)
                        }
                    };
                    try {
                        u = n(t.activeElement).data("dt-idx")
                    } catch (m) {
                    }
                    f(n(i).empty(), r), u && n(i).find("[data-dt-idx=" + u + "]").focus()
                }
            }
        }), n.extend(Vt.ext.type.detect, [function (e, t) {
            var i = t.oLanguage.sDecimal;
            return oi(e, i) ? "num" + i : null
        }, function (e) {
            if (!(!e || e instanceof Date || ei.test(e) && ti.test(e)))return null;
            var t = Date.parse(e);
            return null !== t && !isNaN(t) || si(e) ? "date" : null
        }, function (e, t) {
            var i = t.oLanguage.sDecimal;
            return oi(e, i, !0) ? "num-fmt" + i : null
        }, function (e, t) {
            var i = t.oLanguage.sDecimal;
            return li(e, i) ? "html-num" + i : null
        }, function (e, t) {
            var i = t.oLanguage.sDecimal;
            return li(e, i, !0) ? "html-num-fmt" + i : null
        }, function (e) {
            return si(e) || "string" == typeof e && -1 !== e.indexOf("<") ? "html" : null
        }]), n.extend(Vt.ext.type.search, {
            html: function (e) {
                return si(e) ? e : "string" == typeof e ? e.replace(Jt, " ").replace(Qt, "") : ""
            }, string: function (e) {
                return si(e) ? e : "string" == typeof e ? e.replace(Jt, " ") : e
            }
        });
        var Ri = function (e, t, i, n) {
            return 0 === e || e && "-" !== e ? (t && (e = ai(e, t)), e.replace && (i && (e = e.replace(i, "")), n && (e = e.replace(n, ""))), 1 * e) : -1 / 0
        };
        return n.extend(qt.type.order, {
            "date-pre": function (e) {
                return Date.parse(e) || 0
            }, "html-pre": function (e) {
                return si(e) ? "" : e.replace ? e.replace(/<.*?>/g, "").toLowerCase() : e + ""
            }, "string-pre": function (e) {
                return si(e) ? "" : "string" == typeof e ? e.toLowerCase() : e.toString ? e.toString() : ""
            }, "string-asc": function (e, t) {
                return t > e ? -1 : e > t ? 1 : 0
            }, "string-desc": function (e, t) {
                return t > e ? 1 : e > t ? -1 : 0
            }
        }), $t(""), n.extend(!0, Vt.ext.renderer, {
            header: {
                _: function (e, t, i, s) {
                    n(e.nTable).on("order.dt.DT", function (n, r, a, o) {
                        e === r && (n = i.idx, t.removeClass(i.sSortingClass + " " + s.sSortAsc + " " + s.sSortDesc).addClass("asc" == o[n] ? s.sSortAsc : "desc" == o[n] ? s.sSortDesc : i.sSortingClass))
                    })
                }, jqueryui: function (e, t, i, s) {
                    n("<div/>").addClass(s.sSortJUIWrapper).append(t.contents()).append(n("<span/>").addClass(s.sSortIcon + " " + i.sSortingClassJUI)).appendTo(t), n(e.nTable).on("order.dt.DT", function (n, r, a, o) {
                        e === r && (n = i.idx, t.removeClass(s.sSortAsc + " " + s.sSortDesc).addClass("asc" == o[n] ? s.sSortAsc : "desc" == o[n] ? s.sSortDesc : i.sSortingClass), t.find("span." + s.sSortIcon).removeClass(s.sSortJUIAsc + " " + s.sSortJUIDesc + " " + s.sSortJUI + " " + s.sSortJUIAscAllowed + " " + s.sSortJUIDescAllowed).addClass("asc" == o[n] ? s.sSortJUIAsc : "desc" == o[n] ? s.sSortJUIDesc : i.sSortingClassJUI))
                    })
                }
            }
        }), Vt.render = {
            number: function (e, t, i, n) {
                return {
                    display: function (s) {
                        if ("number" != typeof s && "string" != typeof s)return s;
                        var r = 0 > s ? "-" : "", s = Math.abs(parseFloat(s)), a = parseInt(s, 10), s = i ? t + (s - a).toFixed(i).substring(2) : "";
                        return r + (n || "") + a.toString().replace(/\B(?=(\d{3})+(?!\d))/g, e) + s
                    }
                }
            }
        }, n.extend(Vt.ext.internal, {
            _fnExternApiFunc: Wt,
            _fnBuildAjax: j,
            _fnAjaxUpdate: H,
            _fnAjaxParameters: G,
            _fnAjaxUpdateDraw: $,
            _fnAjaxDataSrc: W,
            _fnAddColumn: c,
            _fnColumnOptions: p,
            _fnAdjustColumnSizing: d,
            _fnVisibleToColumnIndex: f,
            _fnColumnIndexToVisible: m,
            _fnVisbleColumns: g,
            _fnGetColumns: y,
            _fnColumnTypes: v,
            _fnApplyColumnDefs: b,
            _fnHungarianMap: s,
            _fnCamelToHungarian: r,
            _fnLanguageCompat: a,
            _fnBrowserDetect: h,
            _fnAddData: L,
            _fnAddTr: w,
            _fnNodeToDataIndex: function (e, t) {
                return t._DT_RowIndex !== i ? t._DT_RowIndex : null
            },
            _fnNodeToColumnIndex: function (e, t, i) {
                return n.inArray(i, e.aoData[t].anCells)
            },
            _fnGetCellData: O,
            _fnSetCellData: C,
            _fnSplitObjNotation: x,
            _fnGetObjectDataFn: S,
            _fnSetObjectDataFn: _,
            _fnGetDataMaster: T,
            _fnClearTable: E,
            _fnDeleteIndex: N,
            _fnInvalidate: P,
            _fnGetRowElements: M,
            _fnCreateTr: k,
            _fnBuildHead: D,
            _fnDrawHead: A,
            _fnDraw: I,
            _fnReDraw: R,
            _fnAddOptionsHtml: z,
            _fnDetectHeader: B,
            _fnGetUniqueThs: U,
            _fnFeatureHtmlFilter: V,
            _fnFilterComplete: q,
            _fnFilterCustom: X,
            _fnFilterColumn: Y,
            _fnFilter: Z,
            _fnFilterCreateSearch: K,
            _fnEscapeRegex: J,
            _fnFilterData: Q,
            _fnFeatureHtmlInfo: it,
            _fnUpdateInfo: nt,
            _fnInfoMacros: st,
            _fnInitialise: rt,
            _fnInitComplete: at,
            _fnLengthChange: ot,
            _fnFeatureHtmlLength: lt,
            _fnFeatureHtmlPaginate: ht,
            _fnPageChange: ut,
            _fnFeatureHtmlProcessing: ct,
            _fnProcessingDisplay: pt,
            _fnFeatureHtmlTable: dt,
            _fnScrollDraw: ft,
            _fnApplyToChildren: mt,
            _fnCalculateColumnWidths: gt,
            _fnThrottle: yt,
            _fnConvertToWidth: vt,
            _fnScrollingWidthAdjust: bt,
            _fnGetWidestNode: Lt,
            _fnGetMaxLenString: wt,
            _fnStringToCss: Ot,
            _fnScrollBarWidth: Ct,
            _fnSortFlatten: xt,
            _fnSort: St,
            _fnSortAria: _t,
            _fnSortListener: Tt,
            _fnSortAttachListener: Et,
            _fnSortingClasses: Nt,
            _fnSortData: Pt,
            _fnSaveState: Mt,
            _fnLoadState: kt,
            _fnSettingsFromNode: Ft,
            _fnLog: Dt,
            _fnMap: At,
            _fnBindAction: Rt,
            _fnCallbackReg: zt,
            _fnCallbackFire: Bt,
            _fnLengthOverflow: Ut,
            _fnRenderer: jt,
            _fnDataSource: Ht,
            _fnRowAttributes: F,
            _fnCalculateEnd: function () {
            }
        }), n.fn.dataTable = Vt, n.fn.dataTableSettings = Vt.settings, n.fn.dataTableExt = Vt.ext, n.fn.DataTable = function (e) {
            return n(this).dataTable(e).api()
        }, n.each(Vt, function (e, t) {
            n.fn.DataTable[e] = t
        }), n.fn.dataTable
    };
    "function" == typeof define && define.amd ? define("datatables", ["jquery"], n) : "object" == typeof exports ? module.exports = n(require("jquery")) : jQuery && !jQuery.fn.dataTable && n(jQuery)
}(window, document), function (e, t, i) {
    e = function (e) {
        var n = function (t, i) {
            (!this.CLASS || "ColVis" != this.CLASS) && alert("Warning: ColVis must be initialised with the keyword 'new'"), "undefined" == typeof i && (i = {});
            var s = e.fn.dataTable.camelToHungarian;
            return s && (s(n.defaults, n.defaults, !0), s(n.defaults, i)), this.s = {
                dt: null,
                oInit: i,
                hidden: !0,
                abOriginal: []
            }, this.dom = {
                wrapper: null,
                button: null,
                collection: null,
                background: null,
                catcher: null,
                buttons: [],
                groupButtons: [],
                restore: null
            }, n.aInstances.push(this), this.s.dt = e.fn.dataTable.Api ? new e.fn.dataTable.Api(t).settings()[0] : t, this._fnConstruct(i), this
        };
        return n.prototype = {
            button: function () {
                return this.dom.wrapper
            }, fnRebuild: function () {
                this.rebuild()
            }, rebuild: function () {
                for (var e = this.dom.buttons.length - 1; e >= 0; e--)this.dom.collection.removeChild(this.dom.buttons[e]);
                this.dom.buttons.splice(0, this.dom.buttons.length), this.dom.groupButtons.splice(0, this.dom.groupButtons.length), this.dom.restore && this.dom.restore.parentNode(this.dom.restore), this._fnAddGroups(), this._fnAddButtons(), this._fnDrawCallback()
            }, _fnConstruct: function (i) {
                this._fnApplyCustomisation(i);
                var n, s, r = this;
                for (this.dom.wrapper = t.createElement("div"), this.dom.wrapper.className = "ColVis", this.dom.button = e("<button />", {"class": this.s.dt.bJUI ? "ColVis_Button ColVis_MasterButton ui-button ui-state-default" : "ColVis_Button ColVis_MasterButton"}).append("<span>" + this.s.buttonText + "</span>").bind("mouseover" == this.s.activate ? "mouseover" : "click", function (e) {
                    e.preventDefault(), r._fnCollectionShow()
                }).appendTo(this.dom.wrapper)[0], this.dom.catcher = this._fnDomCatcher(), this.dom.collection = this._fnDomCollection(), this.dom.background = this._fnDomBackground(), this._fnAddGroups(), this._fnAddButtons(), n = 0, s = this.s.dt.aoColumns.length; s > n; n++)this.s.abOriginal.push(this.s.dt.aoColumns[n].bVisible);
                this.s.dt.aoDrawCallback.push({
                    fn: function () {
                        r._fnDrawCallback.call(r)
                    }, sName: "ColVis"
                }), e(this.s.dt.oInstance).bind("column-reorder.dt", function (e, t, i) {
                    for (n = 0, s = r.s.aiExclude.length; s > n; n++)r.s.aiExclude[n] = i.aiInvertMapping[r.s.aiExclude[n]];
                    e = r.s.abOriginal.splice(i.iFrom, 1)[0], r.s.abOriginal.splice(i.iTo, 0, e), r.fnRebuild()
                }), e(this.s.dt.oInstance).bind("destroy.dt", function () {
                    e(r.dom.wrapper).remove()
                }), this._fnDrawCallback()
            }, _fnApplyCustomisation: function (t) {
                e.extend(!0, this.s, n.defaults, t), !this.s.showAll && this.s.bShowAll && (this.s.showAll = this.s.sShowAll), !this.s.restore && this.s.bRestore && (this.s.restore = this.s.sRestore);
                var t = this.s.groups, i = this.s.aoGroups;
                if (t)for (var s = 0, r = t.length; r > s; s++)t[s].title && (i[s].sTitle = t[s].title), t[s].columns && (i[s].aiColumns = t[s].columns)
            }, _fnDrawCallback: function () {
                for (var t, n = this.s.dt.aoColumns, s = this.dom.buttons, r = this.s.aoGroups, a = 0, o = s.length; o > a; a++)t = s[a], t.__columnIdx !== i && e("input", t).prop("checked", n[t.__columnIdx].bVisible);
                for (s = 0, t = r.length; t > s; s++) {
                    e:{
                        for (var a = r[s].aiColumns, o = 0, l = a.length; l > o; o++)if (!1 === n[a[o]].bVisible) {
                            a = !1;
                            break e
                        }
                        a = !0
                    }
                    if (a) e("input", this.dom.groupButtons[s]).prop("checked", !0), e("input", this.dom.groupButtons[s]).prop("indeterminate", !1); else {
                        e:{
                            for (a = r[s].aiColumns, o = 0, l = a.length; l > o; o++)if (!0 === n[a[o]].bVisible) {
                                a = !1;
                                break e
                            }
                            a = !0
                        }
                        a ? (e("input", this.dom.groupButtons[s]).prop("checked", !1), e("input", this.dom.groupButtons[s]).prop("indeterminate", !1)) : e("input", this.dom.groupButtons[s]).prop("indeterminate", !0)
                    }
                }
            }, _fnAddGroups: function () {
                var e;
                if ("undefined" != typeof this.s.aoGroups)for (var t = 0, i = this.s.aoGroups.length; i > t; t++)e = this._fnDomGroupButton(t), this.dom.groupButtons.push(e), this.dom.buttons.push(e), this.dom.collection.appendChild(e)
            }, _fnAddButtons: function () {
                var t, i = this.s.dt.aoColumns;
                if (-1 === e.inArray("all", this.s.aiExclude))for (var n = 0, s = i.length; s > n; n++)-1 === e.inArray(n, this.s.aiExclude) && (t = this._fnDomColumnButton(n), t.__columnIdx = n, this.dom.buttons.push(t));
                "alpha" === this.s.order && this.dom.buttons.sort(function (e, t) {
                    var n = i[e.__columnIdx].sTitle, s = i[t.__columnIdx].sTitle;
                    return n === s ? 0 : s > n ? -1 : 1
                }), this.s.restore && (t = this._fnDomRestoreButton(), t.className += " ColVis_Restore", this.dom.buttons.push(t)), this.s.showAll && (t = this._fnDomShowXButton(this.s.showAll, !0), t.className += " ColVis_ShowAll", this.dom.buttons.push(t)), this.s.showNone && (t = this._fnDomShowXButton(this.s.showNone, !1), t.className += " ColVis_ShowNone", this.dom.buttons.push(t)), e(this.dom.collection).append(this.dom.buttons)
            }, _fnDomRestoreButton: function () {
                var t = this;
                return e('<li class="ColVis_Special ' + (this.s.dt.bJUI ? "ui-button ui-state-default" : "") + '">' + this.s.restore + "</li>").click(function () {
                    for (var e = 0, i = t.s.abOriginal.length; i > e; e++)t.s.dt.oInstance.fnSetColumnVis(e, t.s.abOriginal[e], !1);
                    t._fnAdjustOpenRows(), t.s.dt.oInstance.fnAdjustColumnSizing(!1), t.s.dt.oInstance.fnDraw(!1)
                })[0]
            }, _fnDomShowXButton: function (t, i) {
                var n = this;
                return e('<li class="ColVis_Special ' + (this.s.dt.bJUI ? "ui-button ui-state-default" : "") + '">' + t + "</li>").click(function () {
                    for (var e = 0, t = n.s.abOriginal.length; t > e; e++)-1 === n.s.aiExclude.indexOf(e) && n.s.dt.oInstance.fnSetColumnVis(e, i, !1);
                    n._fnAdjustOpenRows(), n.s.dt.oInstance.fnAdjustColumnSizing(!1), n.s.dt.oInstance.fnDraw(!1)
                })[0]
            }, _fnDomGroupButton: function (t) {
                var i = this, n = this.s.aoGroups[t];
                return e('<li class="ColVis_Special ' + (this.s.dt.bJUI ? "ui-button ui-state-default" : "") + '"><label><input type="checkbox" /><span>' + n.sTitle + "</span></label></li>").click(function (t) {
                    var s = !e("input", this).is(":checked");
                    for ("li" !== t.target.nodeName.toLowerCase() && (s = !s), t = 0; t < n.aiColumns.length; t++)i.s.dt.oInstance.fnSetColumnVis(n.aiColumns[t], s)
                })[0]
            }, _fnDomColumnButton: function (t) {
                var i = this, n = this.s.dt.aoColumns[t], s = this.s.dt, n = null === this.s.fnLabel ? n.sTitle : this.s.fnLabel(t, n.sTitle, n.nTh);
                return e("<li " + (s.bJUI ? 'class="ui-button ui-state-default"' : "") + '><label><input type="checkbox" /><span>' + n + "</span></label></li>").click(function (n) {
                    var r = !e("input", this).is(":checked");
                    "li" === n.target.nodeName.toLowerCase() || "input" != n.target.nodeName.toLowerCase() && null !== i.s.fnStateChange || (r = !r);
                    var a = e.fn.dataTableExt.iApiIndex;
                    e.fn.dataTableExt.iApiIndex = i._fnDataTablesApiIndex.call(i), s.oFeatures.bServerSide ? (i.s.dt.oInstance.fnSetColumnVis(t, r, !1), i.s.dt.oInstance.fnAdjustColumnSizing(!1), ("" !== s.oScroll.sX || "" !== s.oScroll.sY) && i.s.dt.oInstance.oApi._fnScrollDraw(i.s.dt), i._fnDrawCallback()) : i.s.dt.oInstance.fnSetColumnVis(t, r), e.fn.dataTableExt.iApiIndex = a, null !== i.s.fnStateChange && ("span" == n.target.nodeName.toLowerCase() && n.preventDefault(), i.s.fnStateChange.call(i, t, r))
                })[0]
            }, _fnDataTablesApiIndex: function () {
                for (var e = 0, t = this.s.dt.oInstance.length; t > e; e++)if (this.s.dt.oInstance[e] == this.s.dt.nTable)return e;
                return 0
            }, _fnDomCollection: function () {
                return e("<ul />", {"class": this.s.dt.bJUI ? "ColVis_collection ui-buttonset ui-buttonset-multi" : "ColVis_collection"}).css({
                    display: "none",
                    opacity: 0,
                    position: this.s.bCssPosition ? "" : "absolute"
                })[0]
            }, _fnDomCatcher: function () {
                var i = this, n = t.createElement("div");
                return n.className = "ColVis_catcher", e(n).click(function () {
                    i._fnCollectionHide.call(i, null, null)
                }), n
            }, _fnDomBackground: function () {
                var t = this, i = e("<div></div>").addClass("ColVis_collectionBackground").css("opacity", 0).click(function () {
                    t._fnCollectionHide.call(t, null, null)
                });
                return "mouseover" == this.s.activate && i.mouseover(function () {
                    t.s.overcollection = !1, t._fnCollectionHide.call(t, null, null)
                }), i[0]
            }, _fnCollectionShow: function () {
                var i, n = this;
                i = e(this.dom.button).offset();
                var s = this.dom.collection, r = this.dom.background, a = parseInt(i.left, 10), o = parseInt(i.top + e(this.dom.button).outerHeight(), 10);
                this.s.bCssPosition || (s.style.top = o + "px", s.style.left = a + "px"), e(s).css({
                    display: "block",
                    opacity: 0
                }), r.style.bottom = "0px", r.style.right = "0px", o = this.dom.catcher.style, o.height = e(this.dom.button).outerHeight() + "px", o.width = e(this.dom.button).outerWidth() + "px", o.top = i.top + "px", o.left = a + "px", t.body.appendChild(r), t.body.appendChild(s), t.body.appendChild(this.dom.catcher), e(s).animate({opacity: 1}, n.s.iOverlayFade), e(r).animate({opacity: .1}, n.s.iOverlayFade, "linear", function () {
                    e.browser && e.browser.msie && "6.0" == e.browser.version && n._fnDrawCallback()
                }), this.s.bCssPosition || (i = "left" == this.s.sAlign ? a : a - e(s).outerWidth() + e(this.dom.button).outerWidth(), s.style.left = i + "px", r = e(s).outerWidth(), e(s).outerHeight(), a = e(t).width(), i + r > a && (s.style.left = a - r + "px")), this.s.hidden = !1
            }, _fnCollectionHide: function () {
                var i = this;
                !this.s.hidden && null !== this.dom.collection && (this.s.hidden = !0, e(this.dom.collection).animate({opacity: 0}, i.s.iOverlayFade, function () {
                    this.style.display = "none"
                }), e(this.dom.background).animate({opacity: 0}, i.s.iOverlayFade, function () {
                    t.body.removeChild(i.dom.background), t.body.removeChild(i.dom.catcher)
                }))
            }, _fnAdjustOpenRows: function () {
                for (var e = this.s.dt.aoOpenRows, t = this.s.dt.oApi._fnVisbleColumns(this.s.dt), i = 0, n = e.length; n > i; i++)e[i].nTr.getElementsByTagName("td")[0].colSpan = t
            }
        }, n.fnRebuild = function (t) {
            var i = null;
            "undefined" != typeof t && (i = e.fn.dataTable.Api ? new e.fn.dataTable.Api(t).table().node() : t.fnSettings().nTable);
            for (var s = 0, r = n.aInstances.length; r > s; s++)("undefined" == typeof t || i == n.aInstances[s].s.dt.nTable) && n.aInstances[s].fnRebuild()
        }, n.defaults = {
            active: "click",
            buttonText: "Show / hide columns",
            aiExclude: [],
            bRestore: !1,
            sRestore: "Restore original",
            bShowAll: !1,
            sShowAll: "Show All",
            sAlign: "left",
            fnStateChange: null,
            iOverlayFade: 500,
            fnLabel: null,
            bCssPosition: !1,
            aoGroups: [],
            order: "column"
        }, n.aInstances = [], n.prototype.CLASS = "ColVis", n.VERSION = "1.1.2", n.prototype.VERSION = n.VERSION, "function" == typeof e.fn.dataTable && "function" == typeof e.fn.dataTableExt.fnVersionCheck && e.fn.dataTableExt.fnVersionCheck("1.7.0") ? e.fn.dataTableExt.aoFeatures.push({
            fnInit: function (e) {
                var t = e.oInit;
                return new n(e, t.colVis || t.oColVis || {}).button()
            }, cFeature: "C", sFeature: "ColVis"
        }) : alert("Warning: ColVis requires DataTables 1.7 or greater - www.datatables.net/download"), e.fn.dataTable.ColVis = n, e.fn.DataTable.ColVis = n
    }, "function" == typeof define && define.amd ? define(["jquery", "datatables"], e) : "object" == typeof exports ? e(require("jquery"), require("datatables")) : jQuery && !jQuery.fn.dataTable.ColVis && e(jQuery, jQuery.fn.dataTable)
}(window, document), function (e) {
    "use strict";
    function t(e) {
        return "[object Array]" === Object.prototype.toString.call(e)
    }

    function i(e) {
        return e instanceof Function
    }

    function n(e) {
        return !i(e) && e instanceof Object
    }

    function s(e, i) {
        var r;
        for (r in i)n(i[r]) || t(i[r]) ? (n(i[r]) && !n(e[r]) && (e[r] = {}), t(i[r]) && !t(e[r]) && (e[r] = []), s(e[r], i[r])) : void 0 !== i[r] && (e[r] = i[r])
    }

    function r(e, t) {
        var i = {};
        return s(i, e), s(i, t), i
    }

    function a(e) {
        var t, i, n, s, r, a, o, l, h, u, c;
        return u = Object.prototype.toString.call(e), "[object Date]" === u ? e : "[object String]" === u ? (n = e.match(W), n ? (c = parseInt(n[1], 10), a = parseInt(n[3], 10) - 1, t = parseInt(n[5], 10), i = parseInt(n[7], 10), r = n[9] ? parseInt(n[9], 10) : 0, h = n[11] ? parseInt(n[11], 10) : 0, s = n[12] ? 1e3 * parseFloat(V + n[12].slice(1)) : 0, l = Date.UTC(c, a, t, i, r, h, s), n[13] && n[14] && (o = 60 * n[15], n[17] && (o += parseInt(n[17], 10)), o *= "-" === n[14] ? -1 : 1, l -= 1e3 * 60 * o), new Date(l)) : void 0) : void 0
    }

    function o(e) {
        var t, i, n;
        for (t = 0; t < e.length; t++)for (n = e[t].data, i = 0; i < n.length; i++)if (n[i][1] < 0)return !0;
        return !1
    }

    function l(e, t, i, n, s, a, l) {
        return function (h, u, c) {
            var p = r({}, e);
            return p = r(p, c || {}), u.hideLegend && t(p), "min" in u ? i(p, u.min) : o(h) || i(p, 0), u.max && n(p, u.max), "stacked" in u && s(p, u.stacked), u.colors && (p.colors = u.colors), u.xtitle && a(p, u.xtitle), u.ytitle && l(p, u.ytitle), p = r(p, u.library || {})
        }
    }

    function h(e, t) {
        document.body.innerText ? e.innerText = t : e.textContent = t
    }

    function u(e, t) {
        h(e, "Error Loading Chart: " + t), e.style.color = "#ff0000"
    }

    function c(e, t, i) {
        p(t, i, function (t, i, n) {
            var s = "string" == typeof n ? n : n.message;
            u(e, s)
        })
    }

    function p(t, i, n) {
        var s = e.jQuery || e.Zepto || e.$;
        if (s) s.ajax({dataType: "json", url: t, success: i, error: n}); else {
            var r = new XMLHttpRequest;
            r.open("GET", t, !0), r.setRequestHeader("Content-Type", "application/json"), r.onload = function () {
                200 === r.status ? i(JSON.parse(r.responseText), r.statusText, r) : n(r, "error", r.statusText)
            }, r.send()
        }
    }

    function d(e, t) {
        try {
            t(e)
        } catch (i) {
            throw u(e.element, i.message), i
        }
    }

    function f(e, t) {
        "string" == typeof e.dataSource ? c(e.element, e.dataSource, function (i) {
            e.data = i, d(e, t)
        }) : (e.data = e.dataSource, d(e, t))
    }

    function m(e) {
        return "" + e
    }

    function g(e) {
        return parseFloat(e)
    }

    function y(e) {
        var t, i, n, s;
        if ("object" != typeof e)if ("number" == typeof e) e = new Date(1e3 * e); else {
            if (t = e.match(J))return i = parseInt(t[1], 10), n = parseInt(t[3], 10) - 1, s = parseInt(t[5], 10), new Date(i, n, s);
            var r = e.replace(/ /, "T").replace(" ", "").replace("UTC", "Z");
            e = a(r) || new Date(e)
        }
        return e
    }

    function v(e) {
        if (!t(e)) {
            var i, n = [];
            for (i in e)e.hasOwnProperty(i) && n.push([i, e[i]]);
            e = n
        }
        return e
    }

    function b(e, t) {
        return e[0].getTime() - t[0].getTime()
    }

    function L(e, t) {
        return e - t
    }

    function w() {
        !X && "Highcharts" in e && (X = new function () {
            var t = e.Highcharts;
            this.name = "highcharts";
            var i = {
                chart: {},
                xAxis: {title: {text: null}, labels: {style: {fontSize: "12px"}}},
                yAxis: {title: {text: null}, labels: {style: {fontSize: "12px"}}},
                title: {text: null},
                credits: {enabled: !1},
                legend: {borderWidth: 0},
                tooltip: {style: {fontSize: "12px"}},
                plotOptions: {areaspline: {}, series: {marker: {}}}
            }, n = function (e) {
                e.legend.enabled = !1
            }, s = function (e, t) {
                e.yAxis.min = t
            }, a = function (e, t) {
                e.yAxis.max = t
            }, o = function (e, t) {
                e.plotOptions.series.stacking = t ? "normal" : null
            }, h = function (e, t) {
                e.xAxis.title.text = t
            }, u = function (e, t) {
                e.yAxis.title.text = t
            }, c = l(i, n, s, a, o, h, u);
            this.renderLineChart = function (e, i) {
                i = i || "spline";
                var n = {};
                "areaspline" === i && (n = {
                    plotOptions: {
                        areaspline: {stacking: "normal"},
                        series: {marker: {enabled: !1}}
                    }
                });
                var s, r, a, o = c(e.data, e.options, n);
                o.xAxis.type = e.options.discrete ? "category" : "datetime", o.chart.type || (o.chart.type = i), o.chart.renderTo = e.element.id;
                var l = e.data;
                for (r = 0; r < l.length; r++) {
                    if (s = l[r].data, !e.options.discrete)for (a = 0; a < s.length; a++)s[a][0] = s[a][0].getTime();
                    l[r].marker = {symbol: "circle"}
                }
                o.series = l, new t.Chart(o)
            }, this.renderScatterChart = function (e) {
                var i = {}, n = c(e.data, e.options, i);
                n.chart.type = "scatter", n.chart.renderTo = e.element.id, n.series = e.data, new t.Chart(n)
            }, this.renderPieChart = function (e) {
                var n = {};
                e.options.colors && (n.colors = e.options.colors);
                var s = r(r(i, n), e.options.library || {});
                s.chart.renderTo = e.element.id, s.series = [{
                    type: "pie",
                    name: e.options.label || "Value",
                    data: e.data
                }], new t.Chart(s)
            }, this.renderColumnChart = function (e, i) {
                i = i || "column";
                var n, s, r, a, o = e.data, l = c(o, e.options), h = [];
                for (l.chart.type = i, l.chart.renderTo = e.element.id, n = 0; n < o.length; n++)for (r = o[n], s = 0; s < r.data.length; s++)a = r.data[s], h[a[0]] || (h[a[0]] = new Array(o.length)), h[a[0]][n] = a[1];
                var u = [];
                for (n in h)h.hasOwnProperty(n) && u.push(n);
                l.xAxis.categories = u;
                var p = [];
                for (n = 0; n < o.length; n++) {
                    for (a = [], s = 0; s < u.length; s++)a.push(h[u[s]][n] || 0);
                    p.push({name: o[n].name, data: a})
                }
                l.series = p, new t.Chart(l)
            };
            var p = this;
            this.renderBarChart = function (e) {
                p.renderColumnChart(e, "bar")
            }, this.renderAreaChart = function (e) {
                p.renderLineChart(e, "areaspline")
            }
        }, K.push(X)), !q && e.google && (e.google.setOnLoadCallback || e.google.charts) && (q = new function () {
            var t = e.google;
            this.name = "google";
            var i = {}, n = [], s = function () {
                for (var e, i, s = 0; s < n.length; s++)e = n[s], i = t.visualization && ("corechart" === e.pack && t.visualization.LineChart || "timeline" === e.pack && t.visualization.Timeline), i && (e.callback(), n.splice(s, 1), s--)
            }, a = function (r, a) {
                if (a || (a = r, r = "corechart"), n.push({pack: r, callback: a}), i[r]) s(); else {
                    i[r] = !0;
                    var o = {packages: [r], callback: s};
                    Z.language && (o.language = Z.language), e.google.setOnLoadCallback ? t.load("visualization", "1", o) : t.charts.load("current", o)
                }
            }, o = {
                chartArea: {},
                fontName: "'Lucida Grande', 'Lucida Sans Unicode', Verdana, Arial, Helvetica, sans-serif",
                pointSize: 6,
                legend: {textStyle: {fontSize: 12, color: "#444"}, alignment: "center", position: "right"},
                curveType: "function",
                hAxis: {
                    textStyle: {color: "#666", fontSize: 12},
                    titleTextStyle: {},
                    gridlines: {color: "transparent"},
                    baselineColor: "#ccc",
                    viewWindow: {}
                },
                vAxis: {
                    textStyle: {color: "#666", fontSize: 12},
                    titleTextStyle: {},
                    baselineColor: "#ccc",
                    viewWindow: {}
                },
                tooltip: {textStyle: {color: "#666", fontSize: 12}}
            }, h = function (e) {
                e.legend.position = "none"
            }, u = function (e, t) {
                e.vAxis.viewWindow.min = t
            }, c = function (e, t) {
                e.vAxis.viewWindow.max = t
            }, p = function (e, t) {
                e.hAxis.viewWindow.min = t
            }, d = function (e, t) {
                e.hAxis.viewWindow.max = t
            }, f = function (e, t) {
                e.isStacked = !!t
            }, m = function (e, t) {
                e.hAxis.title = t, e.hAxis.titleTextStyle.italic = !1
            }, y = function (e, t) {
                e.vAxis.title = t, e.vAxis.titleTextStyle.italic = !1
            }, v = l(o, h, u, c, f, m, y), L = function (e, i) {
                var n, s, r, a, o, l = [];
                for (n = 0; n < e.length; n++)for (r = e[n], s = 0; s < r.data.length; s++)a = r.data[s], o = "datetime" === i ? a[0].getTime() : a[0], l[o] || (l[o] = new Array(e.length)), l[o][n] = g(a[1]);
                var h, u = [], c = !0;
                for (n in l)l.hasOwnProperty(n) && ("datetime" === i ? (h = new Date(g(n)), c = c && S(h)) : h = "number" === i ? g(n) : n, u.push([h].concat(l[n])));
                "datetime" === i && u.sort(b);
                var p = new t.visualization.DataTable;
                for (i = "datetime" === i && c ? "date" : i, p.addColumn(i, ""), n = 0; n < e.length; n++)p.addColumn("number", e[n].name);
                return p.addRows(u), p
            }, w = function (t) {
                e.attachEvent ? e.attachEvent("onresize", t) : e.addEventListener && e.addEventListener("resize", t, !0), t()
            };
            this.renderLineChart = function (e) {
                a(function () {
                    var i = v(e.data, e.options), n = L(e.data, e.options.discrete ? "string" : "datetime");
                    e.chart = new t.visualization.LineChart(e.element), w(function () {
                        e.chart.draw(n, i)
                    })
                })
            }, this.renderPieChart = function (e) {
                a(function () {
                    var i = {chartArea: {top: "10%", height: "80%"}};
                    e.options.colors && (i.colors = e.options.colors);
                    var n = r(r(o, i), e.options.library || {}), s = new t.visualization.DataTable;
                    s.addColumn("string", ""), s.addColumn("number", "Value"), s.addRows(e.data), e.chart = new t.visualization.PieChart(e.element), w(function () {
                        e.chart.draw(s, n)
                    })
                })
            }, this.renderColumnChart = function (e) {
                a(function () {
                    var i = v(e.data, e.options), n = L(e.data, "string");
                    e.chart = new t.visualization.ColumnChart(e.element), w(function () {
                        e.chart.draw(n, i)
                    })
                })
            }, this.renderBarChart = function (e) {
                a(function () {
                    var i = {hAxis: {gridlines: {color: "#ccc"}}}, n = l(o, h, p, d, f, m, y)(e.data, e.options, i), s = L(e.data, "string");
                    e.chart = new t.visualization.BarChart(e.element), w(function () {
                        e.chart.draw(s, n)
                    })
                })
            }, this.renderAreaChart = function (e) {
                a(function () {
                    var i = {
                        isStacked: !0,
                        pointSize: 0,
                        areaOpacity: .5
                    }, n = v(e.data, e.options, i), s = L(e.data, e.options.discrete ? "string" : "datetime");
                    e.chart = new t.visualization.AreaChart(e.element), w(function () {
                        e.chart.draw(s, n)
                    })
                })
            }, this.renderGeoChart = function (e) {
                a(function () {
                    var i = {
                        legend: "none",
                        colorAxis: {colors: e.options.colors || ["#f6c7b6", "#ce502d"]}
                    }, n = r(r(o, i), e.options.library || {}), s = new t.visualization.DataTable;
                    s.addColumn("string", ""), s.addColumn("number", e.options.label || "Value"), s.addRows(e.data), e.chart = new t.visualization.GeoChart(e.element), w(function () {
                        e.chart.draw(s, n)
                    })
                })
            }, this.renderScatterChart = function (e) {
                a(function () {
                    var i = {}, n = v(e.data, e.options, i), s = L(e.data, "number");
                    e.chart = new t.visualization.ScatterChart(e.element), w(function () {
                        e.chart.draw(s, n)
                    })
                })
            }, this.renderTimeline = function (e) {
                a("timeline", function () {
                    var i = {legend: "none"};
                    e.options.colors && (i.colors = e.options.colors);
                    var n = r(r(o, i), e.options.library || {}), s = new t.visualization.DataTable;
                    s.addColumn({type: "string", id: "Name"}), s.addColumn({
                        type: "date",
                        id: "Start"
                    }), s.addColumn({
                        type: "date",
                        id: "End"
                    }), s.addRows(e.data), e.element.style.lineHeight = "normal", e.chart = new t.visualization.Timeline(e.element), w(function () {
                        e.chart.draw(s, n)
                    })
                })
            }
        }, K.push(q)), !Y && "Chart" in e && (Y = new function () {
            var t = e.Chart;
            this.name = "chartjs";
            var i = {maintainAspectRatio: !1, animation: !1}, n = {
                scales: {
                    yAxes: [{
                        ticks: {maxTicksLimit: 4},
                        scaleLabel: {fontSize: 16, fontColor: "#333"}
                    }],
                    xAxes: [{
                        gridLines: {drawOnChartArea: !1},
                        scaleLabel: {fontSize: 16, fontColor: "#333"},
                        time: {},
                        ticks: {}
                    }]
                }, legend: {}
            }, s = ["#3366CC", "#DC3912", "#FF9900", "#109618", "#990099", "#3B3EAC", "#0099C6", "#DD4477", "#66AA00", "#B82E2E", "#316395", "#994499", "#22AA99", "#AAAA11", "#6633CC", "#E67300", "#8B0707", "#329262", "#5574A6", "#3B3EAC"], a = function (e) {
                e.legend.display = !1
            }, o = function (e, t) {
                null !== t && (e.scales.yAxes[0].ticks.min = t)
            }, h = function (e, t) {
                e.scales.yAxes[0].ticks.max = t
            }, u = function (e, t) {
                null !== t && (e.scales.xAxes[0].ticks.min = t)
            }, c = function (e, t) {
                e.scales.xAxes[0].ticks.max = t
            }, p = function (e, t) {
                e.scales.xAxes[0].stacked = !!t, e.scales.yAxes[0].stacked = !!t
            }, d = function (e, t) {
                e.scales.xAxes[0].scaleLabel.display = !0, e.scales.xAxes[0].scaleLabel.labelString = t
            }, f = function (e, t) {
                e.scales.yAxes[0].scaleLabel.display = !0, e.scales.yAxes[0].scaleLabel.labelString = t
            }, y = function (e, i, n, s) {
                e.element.innerHTML = "<canvas></canvas>";
                var r = e.element.getElementsByTagName("CANVAS")[0];
                e.chart = new t(r, {type: i, data: n, options: s})
            }, v = function (e, t) {
                var i = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);
                return i ? "rgba(" + parseInt(i[1], 16) + ", " + parseInt(i[2], 16) + ", " + parseInt(i[3], 16) + ", " + t + ")" : e
            }, b = function (e, t, i) {
                var n = Math.ceil(e.element.offsetWidth / 4 / t.labels.length);
                n > 25 && (n = 25), i.scales.xAxes[0].ticks.callback = function (e) {
                    return e = m(e), e.length > n ? e.substring(0, n - 2) + "..." : e
                }
            }, w = l(r(i, n), a, o, h, p, d, f), O = function (e, t, i) {
                var n, a, o, l, h, u, c = [], p = [], d = e.options.colors || s, f = !0, m = !0, y = !0, b = !0, w = !0, O = !0, N = ("line" === i || "area" === i) && !e.options.discrete, P = e.data, M = [], k = [];
                for (a = 0; a < P.length; a++)for (l = P[a], o = 0; o < l.data.length; o++)h = l.data[o], u = N ? h[0].getTime() : h[0], k[u] || (k[u] = new Array(P.length)), k[u][a] = g(h[1]), -1 === M.indexOf(u) && M.push(u);
                N && M.sort(L);
                var F = [];
                for (o = 0; o < P.length; o++)F.push([]);
                var D, A;
                for (A = 0; A < M.length; A++)for (a = M[A], N ? (D = new Date(g(a)), f = f && S(D), n || (n = D.getDay()), m = m && _(D, n), y = y && T(D), b = b && E(D), w = w && x(D), O = O && C(D)) : D = a, p.push(D), o = 0; o < P.length; o++)F[o].push(k[a][o]);
                for (a = 0; a < P.length; a++) {
                    l = P[a];
                    var I = "line" !== i ? v(d[a], .5) : d[a], R = {
                        label: l.name,
                        data: F[a],
                        fill: "area" === i,
                        borderColor: d[a],
                        backgroundColor: I,
                        pointBackgroundColor: d[a],
                        borderWidth: 2
                    };
                    c.push(r(R, l.library || {}))
                }
                if (N && p.length > 0) {
                    var z = p[0].getTime(), B = p[0].getTime();
                    for (a = 1; a < p.length; a++)D = p[a].getTime(), z > D && (z = D), D > B && (B = D);
                    var U = (B - z) / 864e5;
                    if (!t.scales.xAxes[0].time.unit) {
                        var j;
                        if (b || U > 3650 ? (t.scales.xAxes[0].time.unit = "year", j = 365) : y || U > 300 ? (t.scales.xAxes[0].time.unit = "month", j = 30) : f || U > 10 ? (t.scales.xAxes[0].time.unit = "day", j = 1) : w ? (t.scales.xAxes[0].time.unit = "hour", j = 1 / 24) : O && (t.scales.xAxes[0].time.displayFormats = {minute: "h:mm a"}, t.scales.xAxes[0].time.unit = "minute", j = 1 / 24 / 60), j && U > 0) {
                            var H = Math.ceil(U / j / (e.element.offsetWidth / 100));
                            m && 1 === j && (H = 7 * Math.ceil(H / 7)), t.scales.xAxes[0].time.unitStepSize = H
                        }
                    }
                    t.scales.xAxes[0].time.tooltipFormat || (f ? t.scales.xAxes[0].time.tooltipFormat = "ll" : w ? t.scales.xAxes[0].time.tooltipFormat = "MMM D, h a" : O && (t.scales.xAxes[0].time.tooltipFormat = "h:mm a"))
                }
                var G = {labels: p, datasets: c};
                return G
            };
            this.renderLineChart = function (e, t) {
                var i = {};
                !e.options.max && P(e.data) && (e.options.max = 1);
                var n = w(e.data, r(i, e.options)), s = O(e, n, t || "line");
                n.scales.xAxes[0].type = e.options.discrete ? "category" : "time", y(e, "line", s, n)
            }, this.renderPieChart = function (e) {
                for (var t = r(i, e.options.library || {}), n = [], a = [], o = 0; o < e.data.length; o++) {
                    var l = e.data[o];
                    n.push(l[0]), a.push(l[1])
                }
                var h = {labels: n, datasets: [{data: a, backgroundColor: e.options.colors || s}]};
                y(e, "pie", h, t)
            }, this.renderColumnChart = function (e, t) {
                var s;
                s = "bar" === t ? l(r(i, n), a, u, c, p, d, f)(e.data, e.options) : w(e.data, e.options);
                var o = O(e, s, "column");
                b(e, o, s), y(e, "bar" === t ? "horizontalBar" : "bar", o, s)
            };
            var N = this;
            this.renderAreaChart = function (e) {
                N.renderLineChart(e, "area")
            }, this.renderBarChart = function (e) {
                N.renderColumnChart(e, "bar")
            }, this.renderScatterChart = function (e) {
                for (var t = w(e.data, e.options), i = e.options.colors || s, n = [], r = e.data, a = 0; a < r.length; a++) {
                    for (var o = r[a], l = [], h = 0; h < o.data.length; h++)l.push({
                        x: g(o.data[h][0]),
                        y: g(o.data[h][1])
                    });
                    n.push({
                        label: o.name,
                        showLine: !1,
                        data: l,
                        borderColor: i[a],
                        backgroundColor: i[a],
                        pointBackgroundColor: i[a]
                    })
                }
                var u = {datasets: n};
                t.scales.xAxes[0].type = "linear", t.scales.xAxes[0].position = "bottom", y(e, "line", u, t)
            }
        }, K.unshift(Y))
    }

    function O(e, t) {
        var n, s, r, a;
        for (r = "render" + e, a = t.options.adapter, w(), n = 0; n < K.length; n++)if (s = K[n], (!a || a === s.name) && i(s[r]))return s[r](t);
        throw new Error("No adapter found")
    }

    function C(e) {
        return 0 === e.getMilliseconds() && 0 === e.getSeconds()
    }

    function x(e) {
        return C(e) && 0 === e.getMinutes()
    }

    function S(e) {
        return x(e) && 0 === e.getHours()
    }

    function _(e, t) {
        return S(e) && e.getDay() === t
    }

    function T(e) {
        return S(e) && 1 === e.getDate()
    }

    function E(e) {
        return T(e) && 0 === e.getMonth()
    }

    function N(e) {
        return !isNaN(y(e)) && m(e).length >= 6
    }

    function P(e) {
        var t, i, n;
        for (t = 0; t < e.length; t++)for (n = e[t].data, i = 0; i < n.length; i++)if (0 != n[i][1])return !1;
        return !0
    }

    function M(e) {
        var t, i, n;
        for (t = 0; t < e.length; t++)for (n = v(e[t].data), i = 0; i < n.length; i++)if (!N(n[i][0]))return !0;
        return !1
    }

    function k(e, i, n) {
        var s;
        for (!t(e) || "object" != typeof e[0] || t(e[0]) ? (e = [{
            name: i.label || "Value",
            data: e
        }], i.hideLegend = !0) : i.hideLegend = !1, (null === i.discrete || void 0 === i.discrete) && (i.discrete = M(e)), i.discrete && (n = "string"), s = 0; s < e.length; s++)e[s].data = et(v(e[s].data), n);
        return e
    }

    function F(e) {
        var t, i = v(e);
        for (t = 0; t < i.length; t++)i[t] = [m(i[t][0]), g(i[t][1])];
        return i
    }

    function D(e) {
        var t;
        for (t = 0; t < e.length; t++)e[t][1] = y(e[t][1]), e[t][2] = y(e[t][2]);
        return e
    }

    function A(e) {
        e.data = k(e.data, e.options, "datetime"), O("LineChart", e)
    }

    function I(e) {
        e.data = k(e.data, e.options, "string"), O("ColumnChart", e)
    }

    function R(e) {
        e.data = F(e.data), O("PieChart", e)
    }

    function z(e) {
        e.data = k(e.data, e.options, "string"), O("BarChart", e)
    }

    function B(e) {
        e.data = k(e.data, e.options, "datetime"), O("AreaChart", e)
    }

    function U(e) {
        e.data = F(e.data), O("GeoChart", e)
    }

    function j(e) {
        e.data = k(e.data, e.options, "number"), O("ScatterChart", e)
    }

    function H(e) {
        e.data = D(e.data), O("Timeline", e)
    }

    function G(e, t, i, n, s) {
        var r;
        if ("string" == typeof t && (r = t, t = document.getElementById(t), !t))throw new Error("No element with id " + r);
        e.element = t, e.options = n || {}, e.dataSource = i, e.getElement = function () {
            return t
        }, e.getData = function () {
            return e.data
        }, e.getOptions = function () {
            return n || {}
        }, e.getChartObject = function () {
            return e.chart
        }, $.charts[t.id] = e, f(e, s)
    }

    var $, W, V, q, X, Y, Z = e.Chartkick || {}, K = [], J = /^(\d\d\d\d)(\-)?(\d\d)(\-)?(\d\d)$/i;
    W = /(\d\d\d\d)(\-)?(\d\d)(\-)?(\d\d)(T)?(\d\d)(:)?(\d\d)?(:)?(\d\d)?([\.,]\d+)?($|Z|([\+\-])(\d\d)(:)?(\d\d)?)/i, V = String(1.5).charAt(1);
    var Q = function (e, t) {
        return e = "number" === t ? g(e) : "datetime" === t ? y(e) : m(e)
    }, et = function (e, t) {
        var i, n, s = [];
        for (n = 0; n < e.length; n++)i = Q(e[n][0], t), s.push([i, g(e[n][1])]);
        return "datetime" === t && s.sort(b), s
    };
    $ = {
        LineChart: function (e, t, i) {
            G(this, e, t, i, A)
        }, PieChart: function (e, t, i) {
            G(this, e, t, i, R)
        }, ColumnChart: function (e, t, i) {
            G(this, e, t, i, I)
        }, BarChart: function (e, t, i) {
            G(this, e, t, i, z)
        }, AreaChart: function (e, t, i) {
            G(this, e, t, i, B)
        }, GeoChart: function (e, t, i) {
            G(this, e, t, i, U)
        }, ScatterChart: function (e, t, i) {
            G(this, e, t, i, j)
        }, Timeline: function (e, t, i) {
            G(this, e, t, i, H)
        }, charts: {}, configure: function (e) {
            for (var t in e)e.hasOwnProperty(t) && (Z[t] = e[t])
        }
    }, "object" == typeof module && "object" == typeof module.exports ? module.exports = $ : e.Chartkick = $
}(window);
/*

 OpenLayers.js -- OpenLayers Map Viewer Library

 Copyright (c) 2006-2012 by OpenLayers Contributors
 Published under the 2-clause BSD license.
 See http://openlayers.org/dev/license.txt for the full text of the license, and http://openlayers.org/dev/authors.txt for full list of contributors.

 Includes compressed code under the following licenses:

 (For uncompressed versions of the code used, please see the
 OpenLayers Github repository: <https://github.com/openlayers/openlayers>)

 */
/**
 * Contains XMLHttpRequest.js <http://code.google.com/p/xmlhttprequest/>
 * Copyright 2007 Sergey Ilinsky (http://www.ilinsky.com)
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 */
/**
 * OpenLayers.Util.pagePosition is based on Yahoo's getXY method, which is
 * Copyright (c) 2006, Yahoo! Inc.
 * All rights reserved.
 *
 * Redistribution and use of this software in source and binary forms, with or
 * without modification, are permitted provided that the following conditions
 * are met:
 *
 * * Redistributions of source code must retain the above copyright notice,
 *   this list of conditions and the following disclaimer.
 *
 * * Redistributions in binary form must reproduce the above copyright notice,
 *   this list of conditions and the following disclaimer in the documentation
 *   and/or other materials provided with the distribution.
 *
 * * Neither the name of Yahoo! Inc. nor the names of its contributors may be
 *   used to endorse or promote products derived from this software without
 *   specific prior written permission of Yahoo! Inc.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */
var OpenLayers = {
    VERSION_NUMBER: "Release 2.12", singleFile: !0, _getScriptLocation: function () {
        for (var e, t = /(^|(.*?\/))(OpenLayers[^\/]*?\.js)(\?|$)/, i = document.getElementsByTagName("script"), n = "", s = 0, r = i.length; r > s; s++)if ((e = i[s].getAttribute("src")) && (e = e.match(t))) {
            n = e[1];
            break
        }
        return function () {
            return n
        }
    }(), ImgPath: ""
};
OpenLayers.Class = function () {
    var e = arguments.length, t = arguments[0], i = arguments[e - 1], n = "function" == typeof i.initialize ? i.initialize : function () {
        t.prototype.initialize.apply(this, arguments)
    };
    return e > 1 ? (e = [n, t].concat(Array.prototype.slice.call(arguments).slice(1, e - 1), i), OpenLayers.inherit.apply(null, e)) : n.prototype = i, n
}, OpenLayers.inherit = function (e, t) {
    var i = function () {
    };
    i.prototype = t.prototype, e.prototype = new i;
    var n, s, i = 2;
    for (n = arguments.length; n > i; i++)s = arguments[i], "function" == typeof s && (s = s.prototype), OpenLayers.Util.extend(e.prototype, s)
}, OpenLayers.Util = OpenLayers.Util || {}, OpenLayers.Util.extend = function (e, t) {
    if (e = e || {}, t) {
        for (var i in t) {
            var n = t[i];
            void 0 !== n && (e[i] = n)
        }
        !("function" == typeof window.Event && t instanceof window.Event) && t.hasOwnProperty && t.hasOwnProperty("toString") && (e.toString = t.toString)
    }
    return e
}, OpenLayers.String = {
    startsWith: function (e, t) {
        return 0 == e.indexOf(t)
    },
    contains: function (e, t) {
        return -1 != e.indexOf(t)
    },
    trim: function (e) {
        return e.replace(/^\s\s*/, "").replace(/\s\s*$/, "")
    },
    camelize: function (e) {
        for (var e = e.split("-"), t = e[0], i = 1, n = e.length; n > i; i++)var s = e[i], t = t + (s.charAt(0).toUpperCase() + s.substring(1));
        return t
    },
    format: function (e, t, i) {
        return t || (t = window), e.replace(OpenLayers.String.tokenRegEx, function (e, n) {
            for (var s, r = n.split(/\.+/), a = 0; a < r.length; a++)0 == a && (s = t), s = s[r[a]];
            return "function" == typeof s && (s = i ? s.apply(null, i) : s()), "undefined" == typeof s ? "undefined" : s
        })
    },
    tokenRegEx: /\$\{([\w.]+?)\}/g,
    numberRegEx: /^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,
    isNumeric: function (e) {
        return OpenLayers.String.numberRegEx.test(e)
    },
    numericIf: function (e) {
        return OpenLayers.String.isNumeric(e) ? parseFloat(e) : e
    }
}, OpenLayers.Number = {
    decimalSeparator: ".", thousandsSeparator: ",", limitSigDigs: function (e, t) {
        var i = 0;
        return t > 0 && (i = parseFloat(e.toPrecision(t))), i
    }, format: function (e, t, i, n) {
        t = "undefined" != typeof t ? t : 0, i = "undefined" != typeof i ? i : OpenLayers.Number.thousandsSeparator, n = "undefined" != typeof n ? n : OpenLayers.Number.decimalSeparator, null != t && (e = parseFloat(e.toFixed(t)));
        var s = e.toString().split(".");
        if (1 == s.length && null == t && (t = 0), e = s[0], i)for (var r = /(-?[0-9]+)([0-9]{3})/; r.test(e);)e = e.replace(r, "$1" + i + "$2");
        return 0 == t ? t = e : (i = 1 < s.length ? s[1] : "0", null != t && (i += Array(t - i.length + 1).join("0")), t = e + n + i), t
    }
}, OpenLayers.Function = {
    bind: function (e, t) {
        var i = Array.prototype.slice.apply(arguments, [2]);
        return function () {
            var n = i.concat(Array.prototype.slice.apply(arguments, [0]));
            return e.apply(t, n)
        }
    }, bindAsEventListener: function (e, t) {
        return function (i) {
            return e.call(t, i || window.event)
        }
    }, False: function () {
        return !1
    }, True: function () {
        return !0
    }, Void: function () {
    }
}, OpenLayers.Array = {
    filter: function (e, t, i) {
        var n = [];
        if (Array.prototype.filter) n = e.filter(t, i); else {
            var s = e.length;
            if ("function" != typeof t)throw new TypeError;
            for (var r = 0; s > r; r++)if (r in e) {
                var a = e[r];
                t.call(i, a, r, e) && n.push(a)
            }
        }
        return n
    }
}, OpenLayers.Bounds = OpenLayers.Class({
    left: null,
    bottom: null,
    right: null,
    top: null,
    centerLonLat: null,
    initialize: function (e, t, i, n) {
        OpenLayers.Util.isArray(e) && (n = e[3], i = e[2], t = e[1], e = e[0]), null != e && (this.left = OpenLayers.Util.toFloat(e)), null != t && (this.bottom = OpenLayers.Util.toFloat(t)), null != i && (this.right = OpenLayers.Util.toFloat(i)), null != n && (this.top = OpenLayers.Util.toFloat(n))
    },
    clone: function () {
        return new OpenLayers.Bounds(this.left, this.bottom, this.right, this.top)
    },
    equals: function (e) {
        var t = !1;
        return null != e && (t = this.left == e.left && this.right == e.right && this.top == e.top && this.bottom == e.bottom), t
    },
    toString: function () {
        return [this.left, this.bottom, this.right, this.top].join()
    },
    toArray: function (e) {
        return !0 === e ? [this.bottom, this.left, this.top, this.right] : [this.left, this.bottom, this.right, this.top]
    },
    toBBOX: function (e, t) {
        null == e && (e = 6);
        var i = Math.pow(10, e), n = Math.round(this.left * i) / i, s = Math.round(this.bottom * i) / i, r = Math.round(this.right * i) / i, i = Math.round(this.top * i) / i;
        return !0 === t ? s + "," + n + "," + i + "," + r : n + "," + s + "," + r + "," + i
    },
    toGeometry: function () {
        return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left, this.bottom), new OpenLayers.Geometry.Point(this.right, this.bottom), new OpenLayers.Geometry.Point(this.right, this.top), new OpenLayers.Geometry.Point(this.left, this.top)])])
    },
    getWidth: function () {
        return this.right - this.left
    },
    getHeight: function () {
        return this.top - this.bottom
    },
    getSize: function () {
        return new OpenLayers.Size(this.getWidth(), this.getHeight())
    },
    getCenterPixel: function () {
        return new OpenLayers.Pixel((this.left + this.right) / 2, (this.bottom + this.top) / 2)
    },
    getCenterLonLat: function () {
        return this.centerLonLat || (this.centerLonLat = new OpenLayers.LonLat((this.left + this.right) / 2, (this.bottom + this.top) / 2)), this.centerLonLat
    },
    scale: function (e, t) {
        null == t && (t = this.getCenterLonLat());
        var i, n;
        return "OpenLayers.LonLat" == t.CLASS_NAME ? (i = t.lon, n = t.lat) : (i = t.x, n = t.y), new OpenLayers.Bounds((this.left - i) * e + i, (this.bottom - n) * e + n, (this.right - i) * e + i, (this.top - n) * e + n)
    },
    add: function (e, t) {
        if (null == e || null == t)throw new TypeError("Bounds.add cannot receive null values");
        return new OpenLayers.Bounds(this.left + e, this.bottom + t, this.right + e, this.top + t)
    },
    extend: function (e) {
        var t = null;
        if (e) {
            switch (e.CLASS_NAME) {
                case"OpenLayers.LonLat":
                    t = new OpenLayers.Bounds(e.lon, e.lat, e.lon, e.lat);
                    break;
                case"OpenLayers.Geometry.Point":
                    t = new OpenLayers.Bounds(e.x, e.y, e.x, e.y);
                    break;
                case"OpenLayers.Bounds":
                    t = e
            }
            t && (this.centerLonLat = null, (null == this.left || t.left < this.left) && (this.left = t.left), (null == this.bottom || t.bottom < this.bottom) && (this.bottom = t.bottom), (null == this.right || t.right > this.right) && (this.right = t.right), (null == this.top || t.top > this.top) && (this.top = t.top))
        }
    },
    containsLonLat: function (e, t) {
        "boolean" == typeof t && (t = {inclusive: t});
        var t = t || {}, i = this.contains(e.lon, e.lat, t.inclusive), n = t.worldBounds;
        return n && !i && (i = n.getWidth(), n = Math.round((e.lon - (n.left + n.right) / 2) / i), i = this.containsLonLat({
            lon: e.lon - n * i,
            lat: e.lat
        }, {inclusive: t.inclusive})), i
    },
    containsPixel: function (e, t) {
        return this.contains(e.x, e.y, t)
    },
    contains: function (e, t, i) {
        if (null == i && (i = !0), null == e || null == t)return !1;
        var e = OpenLayers.Util.toFloat(e), t = OpenLayers.Util.toFloat(t), n = !1;
        return n = i ? e >= this.left && e <= this.right && t >= this.bottom && t <= this.top : e > this.left && e < this.right && t > this.bottom && t < this.top
    },
    intersectsBounds: function (e, t) {
        if ("boolean" == typeof t && (t = {inclusive: t}), t = t || {}, t.worldBounds)var i = this.wrapDateLine(t.worldBounds), e = e.wrapDateLine(t.worldBounds); else i = this;
        null == t.inclusive && (t.inclusive = !0);
        var n = !1, s = i.left == e.right || i.right == e.left || i.top == e.bottom || i.bottom == e.top;
        if (t.inclusive || !s)var n = e.top >= i.bottom && e.top <= i.top || i.top > e.bottom && i.top < e.top, s = e.left >= i.left && e.left <= i.right || i.left >= e.left && i.left <= e.right, r = e.right >= i.left && e.right <= i.right || i.right >= e.left && i.right <= e.right, n = (e.bottom >= i.bottom && e.bottom <= i.top || i.bottom >= e.bottom && i.bottom <= e.top || n) && (s || r);
        if (t.worldBounds && !n) {
            var a = t.worldBounds, s = a.getWidth(), r = !a.containsBounds(i), a = !a.containsBounds(e);
            r && !a ? (e = e.add(-s, 0), n = i.intersectsBounds(e, {inclusive: t.inclusive})) : a && !r && (i = i.add(-s, 0), n = e.intersectsBounds(i, {inclusive: t.inclusive}))
        }
        return n
    },
    containsBounds: function (e, t, i) {
        null == t && (t = !1), null == i && (i = !0);
        var n = this.contains(e.left, e.bottom, i), s = this.contains(e.right, e.bottom, i), r = this.contains(e.left, e.top, i), e = this.contains(e.right, e.top, i);
        return t ? n || s || r || e : n && s && r && e
    },
    determineQuadrant: function (e) {
        var t = "", i = this.getCenterLonLat(), t = t + (e.lat < i.lat ? "b" : "t");
        return t += e.lon < i.lon ? "l" : "r"
    },
    transform: function (e, t) {
        this.centerLonLat = null;
        var i = OpenLayers.Projection.transform({
            x: this.left,
            y: this.bottom
        }, e, t), n = OpenLayers.Projection.transform({
            x: this.right,
            y: this.bottom
        }, e, t), s = OpenLayers.Projection.transform({
            x: this.left,
            y: this.top
        }, e, t), r = OpenLayers.Projection.transform({x: this.right, y: this.top}, e, t);
        return this.left = Math.min(i.x, s.x), this.bottom = Math.min(i.y, n.y), this.right = Math.max(n.x, r.x), this.top = Math.max(s.y, r.y), this
    },
    wrapDateLine: function (e, t) {
        var t = t || {}, i = t.leftTolerance || 0, n = t.rightTolerance || 0, s = this.clone();
        if (e) {
            for (var r = e.getWidth(); s.left < e.left && s.right - n <= e.left;)s = s.add(r, 0);
            for (; s.left + i >= e.right && s.right > e.right;)s = s.add(-r, 0);
            i = s.left + i, i < e.right && i > e.left && s.right - n > e.right && (s = s.add(-r, 0))
        }
        return s
    },
    CLASS_NAME: "OpenLayers.Bounds"
}), OpenLayers.Bounds.fromString = function (e, t) {
    var i = e.split(",");
    return OpenLayers.Bounds.fromArray(i, t)
}, OpenLayers.Bounds.fromArray = function (e, t) {
    return !0 === t ? new OpenLayers.Bounds(e[1], e[0], e[3], e[2]) : new OpenLayers.Bounds(e[0], e[1], e[2], e[3])
}, OpenLayers.Bounds.fromSize = function (e) {
    return new OpenLayers.Bounds(0, e.h, e.w, 0)
}, OpenLayers.Bounds.oppositeQuadrant = function (e) {
    var t;
    return t = "" + ("t" == e.charAt(0) ? "b" : "t"), t += "l" == e.charAt(1) ? "r" : "l"
}, OpenLayers.Element = {
    visible: function (e) {
        return "none" != OpenLayers.Util.getElement(e).style.display
    }, toggle: function () {
        for (var e = 0, t = arguments.length; t > e; e++) {
            var i = OpenLayers.Util.getElement(arguments[e]), n = OpenLayers.Element.visible(i) ? "none" : "";
            i.style.display = n
        }
    }, remove: function (e) {
        e = OpenLayers.Util.getElement(e), e.parentNode.removeChild(e)
    }, getHeight: function (e) {
        return e = OpenLayers.Util.getElement(e), e.offsetHeight
    }, hasClass: function (e, t) {
        var i = e.className;
        return !!i && RegExp("(^|\\s)" + t + "(\\s|$)").test(i)
    }, addClass: function (e, t) {
        return OpenLayers.Element.hasClass(e, t) || (e.className += (e.className ? " " : "") + t), e
    }, removeClass: function (e, t) {
        var i = e.className;
        return i && (e.className = OpenLayers.String.trim(i.replace(RegExp("(^|\\s+)" + t + "(\\s+|$)"), " "))), e
    }, toggleClass: function (e, t) {
        return OpenLayers.Element.hasClass(e, t) ? OpenLayers.Element.removeClass(e, t) : OpenLayers.Element.addClass(e, t), e
    }, getStyle: function (e, t) {
        var e = OpenLayers.Util.getElement(e), i = null;
        if (e && e.style) {
            i = e.style[OpenLayers.String.camelize(t)], i || (document.defaultView && document.defaultView.getComputedStyle ? i = (i = document.defaultView.getComputedStyle(e, null)) ? i.getPropertyValue(t) : null : e.currentStyle && (i = e.currentStyle[OpenLayers.String.camelize(t)]));
            var n = ["left", "top", "right", "bottom"];
            window.opera && -1 != OpenLayers.Util.indexOf(n, t) && "static" == OpenLayers.Element.getStyle(e, "position") && (i = "auto")
        }
        return "auto" == i ? null : i
    }
}, OpenLayers.LonLat = OpenLayers.Class({
    lon: 0, lat: 0, initialize: function (e, t) {
        OpenLayers.Util.isArray(e) && (t = e[1], e = e[0]), this.lon = OpenLayers.Util.toFloat(e), this.lat = OpenLayers.Util.toFloat(t)
    }, toString: function () {
        return "lon=" + this.lon + ",lat=" + this.lat
    }, toShortString: function () {
        return this.lon + ", " + this.lat
    }, clone: function () {
        return new OpenLayers.LonLat(this.lon, this.lat)
    }, add: function (e, t) {
        if (null == e || null == t)throw new TypeError("LonLat.add cannot receive null values");
        return new OpenLayers.LonLat(this.lon + OpenLayers.Util.toFloat(e), this.lat + OpenLayers.Util.toFloat(t))
    }, equals: function (e) {
        var t = !1;
        return null != e && (t = this.lon == e.lon && this.lat == e.lat || isNaN(this.lon) && isNaN(this.lat) && isNaN(e.lon) && isNaN(e.lat)), t
    }, transform: function (e, t) {
        var i = OpenLayers.Projection.transform({x: this.lon, y: this.lat}, e, t);
        return this.lon = i.x, this.lat = i.y, this
    }, wrapDateLine: function (e) {
        var t = this.clone();
        if (e) {
            for (; t.lon < e.left;)t.lon += e.getWidth();
            for (; t.lon > e.right;)t.lon -= e.getWidth()
        }
        return t
    }, CLASS_NAME: "OpenLayers.LonLat"
}), OpenLayers.LonLat.fromString = function (e) {
    return e = e.split(","), new OpenLayers.LonLat(e[0], e[1])
}, OpenLayers.LonLat.fromArray = function (e) {
    var t = OpenLayers.Util.isArray(e);
    return new OpenLayers.LonLat(t && e[0], t && e[1])
}, OpenLayers.Pixel = OpenLayers.Class({
    x: 0, y: 0, initialize: function (e, t) {
        this.x = parseFloat(e), this.y = parseFloat(t)
    }, toString: function () {
        return "x=" + this.x + ",y=" + this.y
    }, clone: function () {
        return new OpenLayers.Pixel(this.x, this.y)
    }, equals: function (e) {
        var t = !1;
        return null != e && (t = this.x == e.x && this.y == e.y || isNaN(this.x) && isNaN(this.y) && isNaN(e.x) && isNaN(e.y)), t
    }, distanceTo: function (e) {
        return Math.sqrt(Math.pow(this.x - e.x, 2) + Math.pow(this.y - e.y, 2))
    }, add: function (e, t) {
        if (null == e || null == t)throw new TypeError("Pixel.add cannot receive null values");
        return new OpenLayers.Pixel(this.x + e, this.y + t)
    }, offset: function (e) {
        var t = this.clone();
        return e && (t = this.add(e.x, e.y)), t
    }, CLASS_NAME: "OpenLayers.Pixel"
}), OpenLayers.Size = OpenLayers.Class({
    w: 0, h: 0, initialize: function (e, t) {
        this.w = parseFloat(e), this.h = parseFloat(t)
    }, toString: function () {
        return "w=" + this.w + ",h=" + this.h
    }, clone: function () {
        return new OpenLayers.Size(this.w, this.h)
    }, equals: function (e) {
        var t = !1;
        return null != e && (t = this.w == e.w && this.h == e.h || isNaN(this.w) && isNaN(this.h) && isNaN(e.w) && isNaN(e.h)), t
    }, CLASS_NAME: "OpenLayers.Size"
}), OpenLayers.Console = {
    log: function () {
    }, debug: function () {
    }, info: function () {
    }, warn: function () {
    }, error: function () {
    }, userError: function (e) {
        alert(e)
    }, assert: function () {
    }, dir: function () {
    }, dirxml: function () {
    }, trace: function () {
    }, group: function () {
    }, groupEnd: function () {
    }, time: function () {
    }, timeEnd: function () {
    }, profile: function () {
    }, profileEnd: function () {
    }, count: function () {
    }, CLASS_NAME: "OpenLayers.Console"
}, function () {
    for (var e = document.getElementsByTagName("script"), t = 0, i = e.length; i > t; ++t)if (-1 != e[t].src.indexOf("firebug.js") && console) {
        OpenLayers.Util.extend(OpenLayers.Console, console);
        break
    }
}(), OpenLayers.Lang = {
    code: null, defaultCode: "en", getCode: function () {
        return OpenLayers.Lang.code || OpenLayers.Lang.setCode(), OpenLayers.Lang.code
    }, setCode: function (e) {
        var t;
        if (e || (e = "msie" == OpenLayers.BROWSER_NAME ? navigator.userLanguage : navigator.language), e = e.split("-"), e[0] = e[0].toLowerCase(), "object" == typeof OpenLayers.Lang[e[0]] && (t = e[0]), e[1]) {
            var i = e[0] + "-" + e[1].toUpperCase();
            "object" == typeof OpenLayers.Lang[i] && (t = i)
        }
        t || (OpenLayers.Console.warn("Failed to find OpenLayers.Lang." + e.join("-") + " dictionary, falling back to default language"), t = OpenLayers.Lang.defaultCode), OpenLayers.Lang.code = t
    }, translate: function (e, t) {
        var i = OpenLayers.Lang[OpenLayers.Lang.getCode()];
        return (i = i && i[e]) || (i = e), t && (i = OpenLayers.String.format(i, t)), i
    }
}, OpenLayers.i18n = OpenLayers.Lang.translate, OpenLayers.Util = OpenLayers.Util || {}, OpenLayers.Util.getElement = function () {
    for (var e = [], t = 0, i = arguments.length; i > t; t++) {
        var n = arguments[t];
        if ("string" == typeof n && (n = document.getElementById(n)), 1 == arguments.length)return n;
        e.push(n)
    }
    return e
}, OpenLayers.Util.isElement = function (e) {
    return !(!e || 1 !== e.nodeType)
}, OpenLayers.Util.isArray = function (e) {
    return "[object Array]" === Object.prototype.toString.call(e)
}, "undefined" == typeof window.$ && (window.$ = OpenLayers.Util.getElement), OpenLayers.Util.removeItem = function (e, t) {
    for (var i = e.length - 1; i >= 0; i--)e[i] == t && e.splice(i, 1);
    return e
}, OpenLayers.Util.indexOf = function (e, t) {
    if ("function" == typeof e.indexOf)return e.indexOf(t);
    for (var i = 0, n = e.length; n > i; i++)if (e[i] == t)return i;
    return -1
}, OpenLayers.Util.modifyDOMElement = function (e, t, i, n, s, r, a, o) {
    t && (e.id = t), i && (e.style.left = i.x + "px", e.style.top = i.y + "px"), n && (e.style.width = n.w + "px", e.style.height = n.h + "px"), s && (e.style.position = s), r && (e.style.border = r), a && (e.style.overflow = a), parseFloat(o) >= 0 && parseFloat(o) < 1 ? (e.style.filter = "alpha(opacity=" + 100 * o + ")", e.style.opacity = o) : 1 == parseFloat(o) && (e.style.filter = "", e.style.opacity = "")
}, OpenLayers.Util.createDiv = function (e, t, i, n, s, r, a, o) {
    var l = document.createElement("div");
    return n && (l.style.backgroundImage = "url(" + n + ")"), e || (e = OpenLayers.Util.createUniqueID("OpenLayersDiv")), s || (s = "absolute"), OpenLayers.Util.modifyDOMElement(l, e, t, i, s, r, a, o), l
}, OpenLayers.Util.createImage = function (e, t, i, n, s, r, a, o) {
    var l = document.createElement("img");
    return e || (e = OpenLayers.Util.createUniqueID("OpenLayersDiv")), s || (s = "relative"), OpenLayers.Util.modifyDOMElement(l, e, t, i, s, r, null, a), o && (l.style.display = "none", t = function () {
        l.style.display = "", OpenLayers.Event.stopObservingElement(l)
    }, OpenLayers.Event.observe(l, "load", t), OpenLayers.Event.observe(l, "error", t)), l.style.alt = e, l.galleryImg = "no", n && (l.src = n), l
}, OpenLayers.IMAGE_RELOAD_ATTEMPTS = 0, OpenLayers.Util.alphaHackNeeded = null, OpenLayers.Util.alphaHack = function () {
    if (null == OpenLayers.Util.alphaHackNeeded) {
        var e = navigator.appVersion.split("MSIE"), e = parseFloat(e[1]), t = !1;
        try {
            t = !!document.body.filters
        } catch (i) {
        }
        OpenLayers.Util.alphaHackNeeded = t && e >= 5.5 && 7 > e
    }
    return OpenLayers.Util.alphaHackNeeded
}, OpenLayers.Util.modifyAlphaImageDiv = function (e, t, i, n, s, r, a, o, l) {
    OpenLayers.Util.modifyDOMElement(e, t, i, n, r, null, null, l), t = e.childNodes[0], s && (t.src = s), OpenLayers.Util.modifyDOMElement(t, e.id + "_innerImage", null, n, "relative", a), OpenLayers.Util.alphaHack() && ("none" != e.style.display && (e.style.display = "inline-block"), null == o && (o = "scale"), e.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='" + t.src + "', sizingMethod='" + o + "')", parseFloat(e.style.opacity) >= 0 && parseFloat(e.style.opacity) < 1 && (e.style.filter = e.style.filter + (" alpha(opacity=" + 100 * e.style.opacity + ")")), t.style.filter = "alpha(opacity=0)")
}, OpenLayers.Util.createAlphaImageDiv = function (e, t, i, n, s, r, a, o, l) {
    var h = OpenLayers.Util.createDiv(), l = OpenLayers.Util.createImage(null, null, null, null, null, null, null, l);
    return l.className = "olAlphaImg", h.appendChild(l), OpenLayers.Util.modifyAlphaImageDiv(h, e, t, i, n, s, r, a, o), h
}, OpenLayers.Util.upperCaseObject = function (e) {
    var t, i = {};
    for (t in e)i[t.toUpperCase()] = e[t];
    return i
}, OpenLayers.Util.applyDefaults = function (e, t) {
    var i, e = e || {}, n = "function" == typeof window.Event && t instanceof window.Event;
    for (i in t)(void 0 === e[i] || !n && t.hasOwnProperty && t.hasOwnProperty(i) && !e.hasOwnProperty(i)) && (e[i] = t[i]);
    return !n && t && t.hasOwnProperty && t.hasOwnProperty("toString") && !e.hasOwnProperty("toString") && (e.toString = t.toString), e
}, OpenLayers.Util.getParameterString = function (e) {
    var t, i = [];
    for (t in e) {
        var n = e[t];
        if (null != n && "function" != typeof n) {
            if ("object" == typeof n && n.constructor == Array) {
                for (var s, r = [], a = 0, o = n.length; o > a; a++)s = n[a], r.push(encodeURIComponent(null === s || void 0 === s ? "" : s));
                n = r.join(",")
            } else n = encodeURIComponent(n);
            i.push(encodeURIComponent(t) + "=" + n)
        }
    }
    return i.join("&")
}, OpenLayers.Util.urlAppend = function (e, t) {
    var i = e;
    if (t)var n = (e + " ").split(/[?&]/), i = i + (" " === n.pop() ? t : n.length ? "&" + t : "?" + t);
    return i
}, OpenLayers.Util.getImagesLocation = function () {
    return OpenLayers.ImgPath || OpenLayers._getScriptLocation() + "img/"
}, OpenLayers.Util.getImageLocation = function (e) {
    return OpenLayers.Util.getImagesLocation() + e
}, OpenLayers.Util.Try = function () {
    for (var e = null, t = 0, i = arguments.length; i > t; t++) {
        var n = arguments[t];
        try {
            e = n();
            break
        } catch (s) {
        }
    }
    return e
}, OpenLayers.Util.getXmlNodeValue = function (e) {
    var t = null;
    return OpenLayers.Util.Try(function () {
        t = e.text, t || (t = e.textContent), t || (t = e.firstChild.nodeValue)
    }, function () {
        t = e.textContent
    }), t
}, OpenLayers.Util.mouseLeft = function (e, t) {
    for (var i = e.relatedTarget ? e.relatedTarget : e.toElement; i != t && null != i;)i = i.parentNode;
    return i != t
}, OpenLayers.Util.DEFAULT_PRECISION = 14, OpenLayers.Util.toFloat = function (e, t) {
    return null == t && (t = OpenLayers.Util.DEFAULT_PRECISION), "number" != typeof e && (e = parseFloat(e)), 0 === t ? e : parseFloat(e.toPrecision(t))
}, OpenLayers.Util.rad = function (e) {
    return e * Math.PI / 180
}, OpenLayers.Util.deg = function (e) {
    return 180 * e / Math.PI
}, OpenLayers.Util.VincentyConstants = {
    a: 6378137,
    b: 6356752.3142,
    f: 1 / 298.257223563
}, OpenLayers.Util.distVincenty = function (e, t) {
    for (var i = OpenLayers.Util.VincentyConstants, n = i.a, s = i.b, i = i.f, r = OpenLayers.Util.rad(t.lon - e.lon), a = Math.atan((1 - i) * Math.tan(OpenLayers.Util.rad(e.lat))), o = Math.atan((1 - i) * Math.tan(OpenLayers.Util.rad(t.lat))), l = Math.sin(a), a = Math.cos(a), h = Math.sin(o), o = Math.cos(o), u = r, c = 2 * Math.PI, p = 20; Math.abs(u - c) > 1e-12 && --p > 0;) {
        var d = Math.sin(u), f = Math.cos(u), m = Math.sqrt(o * d * o * d + (a * h - l * o * f) * (a * h - l * o * f));
        if (0 == m)return 0;
        var f = l * h + a * o * f, g = Math.atan2(m, f), y = Math.asin(a * o * d / m), v = Math.cos(y) * Math.cos(y), d = f - 2 * l * h / v, b = i / 16 * v * (4 + i * (4 - 3 * v)), c = u, u = r + (1 - b) * i * Math.sin(y) * (g + b * m * (d + b * f * (-1 + 2 * d * d)))
    }
    return 0 == p ? 0 / 0 : (n = v * (n * n - s * s) / (s * s), i = n / 1024 * (256 + n * (-128 + n * (74 - 47 * n))), (s * (1 + n / 16384 * (4096 + n * (-768 + n * (320 - 175 * n)))) * (g - i * m * (d + i / 4 * (f * (-1 + 2 * d * d) - i / 6 * d * (-3 + 4 * m * m) * (-3 + 4 * d * d))))).toFixed(3) / 1e3)
}, OpenLayers.Util.destinationVincenty = function (e, t, i) {
    for (var n = OpenLayers.Util, s = n.VincentyConstants, r = s.a, a = s.b, o = s.f, s = e.lon, e = e.lat, l = n.rad(t), t = Math.sin(l), l = Math.cos(l), e = (1 - o) * Math.tan(n.rad(e)), h = 1 / Math.sqrt(1 + e * e), u = e * h, c = Math.atan2(e, l), e = h * t, p = 1 - e * e, r = p * (r * r - a * a) / (a * a), d = 1 + r / 16384 * (4096 + r * (-768 + r * (320 - 175 * r))), f = r / 1024 * (256 + r * (-128 + r * (74 - 47 * r))), r = i / (a * d), m = 2 * Math.PI; Math.abs(r - m) > 1e-12;)var g = Math.cos(2 * c + r), y = Math.sin(r), v = Math.cos(r), b = f * y * (g + f / 4 * (v * (-1 + 2 * g * g) - f / 6 * g * (-3 + 4 * y * y) * (-3 + 4 * g * g))), m = r, r = i / (a * d) + b;
    return i = u * y - h * v * l, a = Math.atan2(u * v + h * y * l, (1 - o) * Math.sqrt(e * e + i * i)), t = Math.atan2(y * t, h * v - u * y * l), l = o / 16 * p * (4 + o * (4 - 3 * p)), g = t - (1 - l) * o * e * (r + l * y * (g + l * v * (-1 + 2 * g * g))), Math.atan2(e, -i), new OpenLayers.LonLat(s + n.deg(g), n.deg(a))
}, OpenLayers.Util.getParameters = function (e) {
    var e = null === e || void 0 === e ? window.location.href : e, t = "";
    if (OpenLayers.String.contains(e, "?"))var t = e.indexOf("?") + 1, i = OpenLayers.String.contains(e, "#") ? e.indexOf("#") : e.length, t = e.substring(t, i);
    for (var e = {}, t = t.split(/[&;]/), i = 0, n = t.length; n > i; ++i) {
        var s = t[i].split("=");
        if (s[0]) {
            var r = s[0];
            try {
                r = decodeURIComponent(r)
            } catch (a) {
                r = unescape(r)
            }
            s = (s[1] || "").replace(/\+/g, " ");
            try {
                s = decodeURIComponent(s)
            } catch (o) {
                s = unescape(s)
            }
            s = s.split(","), 1 == s.length && (s = s[0]), e[r] = s
        }
    }
    return e
}, OpenLayers.Util.lastSeqID = 0, OpenLayers.Util.createUniqueID = function (e) {
    return null == e && (e = "id_"), OpenLayers.Util.lastSeqID = OpenLayers.Util.lastSeqID + 1, e + OpenLayers.Util.lastSeqID
}, OpenLayers.INCHES_PER_UNIT = {
    inches: 1,
    ft: 12,
    mi: 63360,
    m: 39.3701,
    km: 39370.1,
    dd: 4374754,
    yd: 36
}, OpenLayers.INCHES_PER_UNIT["in"] = OpenLayers.INCHES_PER_UNIT.inches, OpenLayers.INCHES_PER_UNIT.degrees = OpenLayers.INCHES_PER_UNIT.dd, OpenLayers.INCHES_PER_UNIT.nmi = 1852 * OpenLayers.INCHES_PER_UNIT.m, OpenLayers.METERS_PER_INCH = .0254000508001016, OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT, {
    Inch: OpenLayers.INCHES_PER_UNIT.inches,
    Meter: 1 / OpenLayers.METERS_PER_INCH,
    Foot: .3048006096012192 / OpenLayers.METERS_PER_INCH,
    IFoot: .3048 / OpenLayers.METERS_PER_INCH,
    ClarkeFoot: .3047972651151 / OpenLayers.METERS_PER_INCH,
    SearsFoot: .30479947153867626 / OpenLayers.METERS_PER_INCH,
    GoldCoastFoot: .3047997101815088 / OpenLayers.METERS_PER_INCH,
    IInch: .0254 / OpenLayers.METERS_PER_INCH,
    MicroInch: 254e-7 / OpenLayers.METERS_PER_INCH,
    Mil: 2.54e-8 / OpenLayers.METERS_PER_INCH,
    Centimeter: .01 / OpenLayers.METERS_PER_INCH,
    Kilometer: 1e3 / OpenLayers.METERS_PER_INCH,
    Yard: .9144018288036576 / OpenLayers.METERS_PER_INCH,
    SearsYard: .914398414616029 / OpenLayers.METERS_PER_INCH,
    IndianYard: .9143985307444408 / OpenLayers.METERS_PER_INCH,
    IndianYd37: .91439523 / OpenLayers.METERS_PER_INCH,
    IndianYd62: .9143988 / OpenLayers.METERS_PER_INCH,
    IndianYd75: .9143985 / OpenLayers.METERS_PER_INCH,
    IndianFoot: .30479951 / OpenLayers.METERS_PER_INCH,
    IndianFt37: .30479841 / OpenLayers.METERS_PER_INCH,
    IndianFt62: .3047996 / OpenLayers.METERS_PER_INCH,
    IndianFt75: .3047995 / OpenLayers.METERS_PER_INCH,
    Mile: 1609.3472186944373 / OpenLayers.METERS_PER_INCH,
    IYard: .9144 / OpenLayers.METERS_PER_INCH,
    IMile: 1609.344 / OpenLayers.METERS_PER_INCH,
    NautM: 1852 / OpenLayers.METERS_PER_INCH,
    "Lat-66": 110943.31648893273 / OpenLayers.METERS_PER_INCH,
    "Lat-83": 110946.25736872235 / OpenLayers.METERS_PER_INCH,
    Decimeter: .1 / OpenLayers.METERS_PER_INCH,
    Millimeter: .001 / OpenLayers.METERS_PER_INCH,
    Dekameter: 10 / OpenLayers.METERS_PER_INCH,
    Decameter: 10 / OpenLayers.METERS_PER_INCH,
    Hectometer: 100 / OpenLayers.METERS_PER_INCH,
    GermanMeter: 1.0000135965 / OpenLayers.METERS_PER_INCH,
    CaGrid: .999738 / OpenLayers.METERS_PER_INCH,
    ClarkeChain: 20.1166194976 / OpenLayers.METERS_PER_INCH,
    GunterChain: 20.11684023368047 / OpenLayers.METERS_PER_INCH,
    BenoitChain: 20.116782494375872 / OpenLayers.METERS_PER_INCH,
    SearsChain: 20.11676512155 / OpenLayers.METERS_PER_INCH,
    ClarkeLink: .201166194976 / OpenLayers.METERS_PER_INCH,
    GunterLink: .2011684023368047 / OpenLayers.METERS_PER_INCH,
    BenoitLink: .20116782494375873 / OpenLayers.METERS_PER_INCH,
    SearsLink: .2011676512155 / OpenLayers.METERS_PER_INCH,
    Rod: 5.02921005842012 / OpenLayers.METERS_PER_INCH,
    IntnlChain: 20.1168 / OpenLayers.METERS_PER_INCH,
    IntnlLink: .201168 / OpenLayers.METERS_PER_INCH,
    Perch: 5.02921005842012 / OpenLayers.METERS_PER_INCH,
    Pole: 5.02921005842012 / OpenLayers.METERS_PER_INCH,
    Furlong: 201.1684023368046 / OpenLayers.METERS_PER_INCH,
    Rood: 3.778266898 / OpenLayers.METERS_PER_INCH,
    CapeFoot: .3047972615 / OpenLayers.METERS_PER_INCH,
    Brealey: 375 / OpenLayers.METERS_PER_INCH,
    ModAmFt: .304812252984506 / OpenLayers.METERS_PER_INCH,
    Fathom: 1.8288 / OpenLayers.METERS_PER_INCH,
    "NautM-UK": 1853.184 / OpenLayers.METERS_PER_INCH,
    "50kilometers": 5e4 / OpenLayers.METERS_PER_INCH,
    "150kilometers": 15e4 / OpenLayers.METERS_PER_INCH
}), OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT, {
    mm: OpenLayers.INCHES_PER_UNIT.Meter / 1e3,
    cm: OpenLayers.INCHES_PER_UNIT.Meter / 100,
    dm: 100 * OpenLayers.INCHES_PER_UNIT.Meter,
    km: 1e3 * OpenLayers.INCHES_PER_UNIT.Meter,
    kmi: OpenLayers.INCHES_PER_UNIT.nmi,
    fath: OpenLayers.INCHES_PER_UNIT.Fathom,
    ch: OpenLayers.INCHES_PER_UNIT.IntnlChain,
    link: OpenLayers.INCHES_PER_UNIT.IntnlLink,
    "us-in": OpenLayers.INCHES_PER_UNIT.inches,
    "us-ft": OpenLayers.INCHES_PER_UNIT.Foot,
    "us-yd": OpenLayers.INCHES_PER_UNIT.Yard,
    "us-ch": OpenLayers.INCHES_PER_UNIT.GunterChain,
    "us-mi": OpenLayers.INCHES_PER_UNIT.Mile,
    "ind-yd": OpenLayers.INCHES_PER_UNIT.IndianYd37,
    "ind-ft": OpenLayers.INCHES_PER_UNIT.IndianFt37,
    "ind-ch": 20.11669506 / OpenLayers.METERS_PER_INCH
}), OpenLayers.DOTS_PER_INCH = 72, OpenLayers.Util.normalizeScale = function (e) {
    return e > 1 ? 1 / e : e
}, OpenLayers.Util.getResolutionFromScale = function (e, t) {
    var i;
    return e && (null == t && (t = "degrees"), i = 1 / (OpenLayers.Util.normalizeScale(e) * OpenLayers.INCHES_PER_UNIT[t] * OpenLayers.DOTS_PER_INCH)), i
}, OpenLayers.Util.getScaleFromResolution = function (e, t) {
    return null == t && (t = "degrees"), e * OpenLayers.INCHES_PER_UNIT[t] * OpenLayers.DOTS_PER_INCH
}, OpenLayers.Util.pagePosition = function (e) {
    var t = [0, 0], i = OpenLayers.Util.getViewportElement();
    if (!e || e == window || e == i)return t;
    var n = OpenLayers.IS_GECKO && document.getBoxObjectFor && "absolute" == OpenLayers.Element.getStyle(e, "position") && ("" == e.style.top || "" == e.style.left), s = null;
    if (e.getBoundingClientRect) e = e.getBoundingClientRect(), s = i.scrollTop, t[0] = e.left + i.scrollLeft, t[1] = e.top + s; else if (document.getBoxObjectFor && !n) e = document.getBoxObjectFor(e), i = document.getBoxObjectFor(i), t[0] = e.screenX - i.screenX, t[1] = e.screenY - i.screenY; else {
        if (t[0] = e.offsetLeft, t[1] = e.offsetTop, s = e.offsetParent, s != e)for (; s;)t[0] = t[0] + s.offsetLeft, t[1] = t[1] + s.offsetTop, s = s.offsetParent;
        for (i = OpenLayers.BROWSER_NAME, ("opera" == i || "safari" == i && "absolute" == OpenLayers.Element.getStyle(e, "position")) && (t[1] = t[1] - document.body.offsetTop), s = e.offsetParent; s && s != document.body;)t[0] = t[0] - s.scrollLeft, ("opera" != i || "TR" != s.tagName) && (t[1] = t[1] - s.scrollTop), s = s.offsetParent
    }
    return t
}, OpenLayers.Util.getViewportElement = function () {
    var e = arguments.callee.viewportElement;
    return void 0 == e && (e = "msie" == OpenLayers.BROWSER_NAME && "CSS1Compat" != document.compatMode ? document.body : document.documentElement, arguments.callee.viewportElement = e), e
}, OpenLayers.Util.isEquivalentUrl = function (e, t, i) {
    i = i || {}, OpenLayers.Util.applyDefaults(i, {ignoreCase: !0, ignorePort80: !0, ignoreHash: !0});
    var n, e = OpenLayers.Util.createUrlObject(e, i), t = OpenLayers.Util.createUrlObject(t, i);
    for (n in e)if ("args" !== n && e[n] != t[n])return !1;
    for (n in e.args) {
        if (e.args[n] != t.args[n])return !1;
        delete t.args[n]
    }
    for (n in t.args)return !1;
    return !0
}, OpenLayers.Util.createUrlObject = function (e, t) {
    if (t = t || {}, !/^\w+:\/\//.test(e)) {
        var i = window.location, n = i.port ? ":" + i.port : "", n = i.protocol + "//" + i.host.split(":").shift() + n;
        0 === e.indexOf("/") ? e = n + e : (i = i.pathname.split("/"), i.pop(), e = n + i.join("/") + "/" + e)
    }
    t.ignoreCase && (e = e.toLowerCase()), i = document.createElement("a"), i.href = e, n = {}, n.host = i.host.split(":").shift(), n.protocol = i.protocol, n.port = t.ignorePort80 ? "80" == i.port || "0" == i.port ? "" : i.port : "" == i.port || "0" == i.port ? "80" : i.port, n.hash = t.ignoreHash || "#" === i.hash ? "" : i.hash;
    var s = i.search;
    return s || (s = e.indexOf("?"), s = -1 != s ? e.substr(s) : ""), n.args = OpenLayers.Util.getParameters(s), n.pathname = "/" == i.pathname.charAt(0) ? i.pathname : "/" + i.pathname, n
}, OpenLayers.Util.removeTail = function (e) {
    var t = null, t = e.indexOf("?"), i = e.indexOf("#");
    return t = -1 == t ? -1 != i ? e.substr(0, i) : e : -1 != i ? e.substr(0, Math.min(t, i)) : e.substr(0, t)
}, OpenLayers.IS_GECKO = function () {
    var e = navigator.userAgent.toLowerCase();
    return -1 == e.indexOf("webkit") && -1 != e.indexOf("gecko")
}(), OpenLayers.CANVAS_SUPPORTED = function () {
    var e = document.createElement("canvas");
    return !(!e.getContext || !e.getContext("2d"))
}(), OpenLayers.BROWSER_NAME = function () {
    var e = "", t = navigator.userAgent.toLowerCase();
    return -1 != t.indexOf("opera") ? e = "opera" : -1 != t.indexOf("msie") ? e = "msie" : -1 != t.indexOf("safari") ? e = "safari" : -1 != t.indexOf("mozilla") && (e = -1 != t.indexOf("firefox") ? "firefox" : "mozilla"), e
}(), OpenLayers.Util.getBrowserName = function () {
    return OpenLayers.BROWSER_NAME
}, OpenLayers.Util.getRenderedDimensions = function (e, t, i) {
    var n, s, r = document.createElement("div");
    r.style.visibility = "hidden";
    for (var a = i && i.containerElement ? i.containerElement : document.body, o = !1, l = null, h = a; h && "body" != h.tagName.toLowerCase();) {
        var u = OpenLayers.Element.getStyle(h, "position");
        if ("absolute" == u) {
            o = !0;
            break
        }
        if (u && "static" != u)break;
        h = h.parentNode
    }
    if (!o || 0 !== a.clientHeight && 0 !== a.clientWidth || (l = document.createElement("div"), l.style.visibility = "hidden", l.style.position = "absolute", l.style.overflow = "visible", l.style.width = document.body.clientWidth + "px", l.style.height = document.body.clientHeight + "px", l.appendChild(r)), r.style.position = "absolute", t && (t.w ? (n = t.w, r.style.width = n + "px") : t.h && (s = t.h, r.style.height = s + "px")), i && i.displayClass && (r.className = i.displayClass), t = document.createElement("div"), t.innerHTML = e, t.style.overflow = "visible", t.childNodes)for (e = 0, i = t.childNodes.length; i > e; e++)t.childNodes[e].style && (t.childNodes[e].style.overflow = "visible");
    return r.appendChild(t), l ? a.appendChild(l) : a.appendChild(r), n || (n = parseInt(t.scrollWidth), r.style.width = n + "px"), s || (s = parseInt(t.scrollHeight)), r.removeChild(t), l ? (l.removeChild(r), a.removeChild(l)) : a.removeChild(r), new OpenLayers.Size(n, s)
}, OpenLayers.Util.getScrollbarWidth = function () {
    var e = OpenLayers.Util._scrollbarWidth;
    if (null == e) {
        var t = null, i = null, t = e = 0, t = document.createElement("div");
        t.style.position = "absolute", t.style.top = "-1000px", t.style.left = "-1000px", t.style.width = "100px", t.style.height = "50px", t.style.overflow = "hidden", i = document.createElement("div"), i.style.width = "100%", i.style.height = "200px", t.appendChild(i), document.body.appendChild(t), e = i.offsetWidth, t.style.overflow = "scroll", t = i.offsetWidth, document.body.removeChild(document.body.lastChild), OpenLayers.Util._scrollbarWidth = e - t, e = OpenLayers.Util._scrollbarWidth
    }
    return e
}, OpenLayers.Util.getFormattedLonLat = function (e, t, i) {
    i || (i = "dms");
    var e = (e + 540) % 360 - 180, n = Math.abs(e), s = Math.floor(n), r = n = (n - s) / (1 / 60), n = Math.floor(n), r = Math.round(10 * ((r - n) / (1 / 60))), r = r / 10;
    return r >= 60 && (r -= 60, n += 1, n >= 60 && (n -= 60, s += 1)), 10 > s && (s = "0" + s), s += "°", i.indexOf("dm") >= 0 && (10 > n && (n = "0" + n), s += n + "'", i.indexOf("dms") >= 0 && (10 > r && (r = "0" + r), s += r + '"')), s = "lon" == t ? s + (0 > e ? OpenLayers.i18n("W") : OpenLayers.i18n("E")) : s + (0 > e ? OpenLayers.i18n("S") : OpenLayers.i18n("N"))
}, OpenLayers.Format = OpenLayers.Class({
    options: null,
    externalProjection: null,
    internalProjection: null,
    data: null,
    keepData: !1,
    initialize: function (e) {
        OpenLayers.Util.extend(this, e), this.options = e
    },
    destroy: function () {
    },
    read: function () {
        throw Error("Read not implemented.")
    },
    write: function () {
        throw Error("Write not implemented.")
    },
    CLASS_NAME: "OpenLayers.Format"
}), OpenLayers.Format.CSWGetRecords = function (e) {
    var e = OpenLayers.Util.applyDefaults(e, OpenLayers.Format.CSWGetRecords.DEFAULTS), t = OpenLayers.Format.CSWGetRecords["v" + e.version.replace(/\./g, "_")];
    if (!t)throw"Unsupported CSWGetRecords version: " + e.version;
    return new t(e)
}, OpenLayers.Format.CSWGetRecords.DEFAULTS = {version: "2.0.2"}, OpenLayers.Control = OpenLayers.Class({
    id: null,
    map: null,
    div: null,
    type: null,
    allowSelection: !1,
    displayClass: "",
    title: "",
    autoActivate: !1,
    active: null,
    handler: null,
    eventListeners: null,
    events: null,
    initialize: function (e) {
        this.displayClass = this.CLASS_NAME.replace("OpenLayers.", "ol").replace(/\./g, ""), OpenLayers.Util.extend(this, e), this.events = new OpenLayers.Events(this), this.eventListeners instanceof Object && this.events.on(this.eventListeners), null == this.id && (this.id = OpenLayers.Util.createUniqueID(this.CLASS_NAME + "_"))
    },
    destroy: function () {
        if (this.events && (this.eventListeners && this.events.un(this.eventListeners), this.events.destroy(), this.events = null), this.eventListeners = null, this.handler && (this.handler.destroy(), this.handler = null), this.handlers) {
            for (var e in this.handlers)this.handlers.hasOwnProperty(e) && "function" == typeof this.handlers[e].destroy && this.handlers[e].destroy();
            this.handlers = null
        }
        this.map && (this.map.removeControl(this), this.map = null), this.div = null
    },
    setMap: function (e) {
        this.map = e, this.handler && this.handler.setMap(e)
    },
    draw: function (e) {
        return null == this.div && (this.div = OpenLayers.Util.createDiv(this.id), this.div.className = this.displayClass, this.allowSelection || (this.div.className += " olControlNoSelect", this.div.setAttribute("unselectable", "on", 0), this.div.onselectstart = OpenLayers.Function.False), "" != this.title) && (this.div.title = this.title), null != e && (this.position = e.clone()), this.moveTo(this.position), this.div
    },
    moveTo: function (e) {
        null != e && null != this.div && (this.div.style.left = e.x + "px", this.div.style.top = e.y + "px")
    },
    activate: function () {
        return this.active ? !1 : (this.handler && this.handler.activate(), this.active = !0, this.map && OpenLayers.Element.addClass(this.map.viewPortDiv, this.displayClass.replace(/ /g, "") + "Active"), this.events.triggerEvent("activate"), !0)
    },
    deactivate: function () {
        return this.active ? (this.handler && this.handler.deactivate(), this.active = !1, this.map && OpenLayers.Element.removeClass(this.map.viewPortDiv, this.displayClass.replace(/ /g, "") + "Active"), this.events.triggerEvent("deactivate"), !0) : !1
    },
    CLASS_NAME: "OpenLayers.Control"
}), OpenLayers.Control.TYPE_BUTTON = 1, OpenLayers.Control.TYPE_TOGGLE = 2, OpenLayers.Control.TYPE_TOOL = 3, OpenLayers.Event = {
    observers: !1,
    KEY_SPACE: 32,
    KEY_BACKSPACE: 8,
    KEY_TAB: 9,
    KEY_RETURN: 13,
    KEY_ESC: 27,
    KEY_LEFT: 37,
    KEY_UP: 38,
    KEY_RIGHT: 39,
    KEY_DOWN: 40,
    KEY_DELETE: 46,
    element: function (e) {
        return e.target || e.srcElement
    },
    isSingleTouch: function (e) {
        return e.touches && 1 == e.touches.length
    },
    isMultiTouch: function (e) {
        return e.touches && 1 < e.touches.length
    },
    isLeftClick: function (e) {
        return e.which && 1 == e.which || e.button && 1 == e.button
    },
    isRightClick: function (e) {
        return e.which && 3 == e.which || e.button && 2 == e.button
    },
    stop: function (e, t) {
        t || (e.preventDefault ? e.preventDefault() : e.returnValue = !1), e.stopPropagation ? e.stopPropagation() : e.cancelBubble = !0
    },
    findElement: function (e, t) {
        for (var i = OpenLayers.Event.element(e); i.parentNode && (!i.tagName || i.tagName.toUpperCase() != t.toUpperCase());)i = i.parentNode;
        return i
    },
    observe: function (e, t, i, n) {
        if (e = OpenLayers.Util.getElement(e), n = n || !1, "keypress" == t && (navigator.appVersion.match(/Konqueror|Safari|KHTML/) || e.attachEvent) && (t = "keydown"), this.observers || (this.observers = {}), !e._eventCacheID) {
            var s = "eventCacheID_";
            e.id && (s = e.id + "_" + s), e._eventCacheID = OpenLayers.Util.createUniqueID(s)
        }
        s = e._eventCacheID, this.observers[s] || (this.observers[s] = []), this.observers[s].push({
            element: e,
            name: t,
            observer: i,
            useCapture: n
        }), e.addEventListener ? e.addEventListener(t, i, n) : e.attachEvent && e.attachEvent("on" + t, i)
    },
    stopObservingElement: function (e) {
        e = OpenLayers.Util.getElement(e)._eventCacheID, this._removeElementObservers(OpenLayers.Event.observers[e])
    },
    _removeElementObservers: function (e) {
        if (e)for (var t = e.length - 1; t >= 0; t--) {
            var i = e[t];
            OpenLayers.Event.stopObserving.apply(this, [i.element, i.name, i.observer, i.useCapture])
        }
    },
    stopObserving: function (e, t, i, n) {
        var n = n || !1, e = OpenLayers.Util.getElement(e), s = e._eventCacheID;
        "keypress" == t && (navigator.appVersion.match(/Konqueror|Safari|KHTML/) || e.detachEvent) && (t = "keydown");
        var r = !1, a = OpenLayers.Event.observers[s];
        if (a)for (var o = 0; !r && o < a.length;) {
            var l = a[o];
            if (l.name == t && l.observer == i && l.useCapture == n) {
                a.splice(o, 1), 0 == a.length && delete OpenLayers.Event.observers[s], r = !0;
                break
            }
            o++
        }
        return r && (e.removeEventListener ? e.removeEventListener(t, i, n) : e && e.detachEvent && e.detachEvent("on" + t, i)), r
    },
    unloadCache: function () {
        if (OpenLayers.Event && OpenLayers.Event.observers) {
            for (var e in OpenLayers.Event.observers)OpenLayers.Event._removeElementObservers.apply(this, [OpenLayers.Event.observers[e]]);
            OpenLayers.Event.observers = !1
        }
    },
    CLASS_NAME: "OpenLayers.Event"
}, OpenLayers.Event.observe(window, "unload", OpenLayers.Event.unloadCache, !1), OpenLayers.Events = OpenLayers.Class({
    BROWSER_EVENTS: "mouseover mouseout mousedown mouseup mousemove click dblclick rightclick dblrightclick resize focus blur touchstart touchmove touchend keydown".split(" "),
    listeners: null,
    object: null,
    element: null,
    eventHandler: null,
    fallThrough: null,
    includeXY: !1,
    extensions: null,
    extensionCount: null,
    clearMouseListener: null,
    initialize: function (e, t, i, n, s) {
        OpenLayers.Util.extend(this, s), this.object = e, this.fallThrough = n, this.listeners = {}, this.extensions = {}, this.extensionCount = {}, null != t && this.attachToElement(t)
    },
    destroy: function () {
        for (var e in this.extensions)"boolean" != typeof this.extensions[e] && this.extensions[e].destroy();
        this.extensions = null, this.element && (OpenLayers.Event.stopObservingElement(this.element), this.element.hasScrollEvent && OpenLayers.Event.stopObserving(window, "scroll", this.clearMouseListener)), this.eventHandler = this.fallThrough = this.object = this.listeners = this.element = null
    },
    addEventType: function () {
    },
    attachToElement: function (e) {
        this.element ? OpenLayers.Event.stopObservingElement(this.element) : (this.eventHandler = OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent, this), this.clearMouseListener = OpenLayers.Function.bind(this.clearMouseCache, this)), this.element = e;
        for (var t = 0, i = this.BROWSER_EVENTS.length; i > t; t++)OpenLayers.Event.observe(e, this.BROWSER_EVENTS[t], this.eventHandler);
        OpenLayers.Event.observe(e, "dragstart", OpenLayers.Event.stop)
    },
    on: function (e) {
        for (var t in e)"scope" != t && e.hasOwnProperty(t) && this.register(t, e.scope, e[t])
    },
    register: function (e, t, i, n) {
        if (e in OpenLayers.Events && !this.extensions[e] && (this.extensions[e] = new OpenLayers.Events[e](this)), null != i) {
            null == t && (t = this.object);
            var s = this.listeners[e];
            s || (s = [], this.listeners[e] = s, this.extensionCount[e] = 0), t = {
                obj: t,
                func: i
            }, n ? (s.splice(this.extensionCount[e], 0, t), "object" == typeof n && n.extension && this.extensionCount[e]++) : s.push(t)
        }
    },
    registerPriority: function (e, t, i) {
        this.register(e, t, i, !0)
    },
    un: function (e) {
        for (var t in e)"scope" != t && e.hasOwnProperty(t) && this.unregister(t, e.scope, e[t])
    },
    unregister: function (e, t, i) {
        if (null == t && (t = this.object), e = this.listeners[e], null != e)for (var n = 0, s = e.length; s > n; n++)if (e[n].obj == t && e[n].func == i) {
            e.splice(n, 1);
            break
        }
    },
    remove: function (e) {
        null != this.listeners[e] && (this.listeners[e] = [])
    },
    triggerEvent: function (e, t) {
        var i = this.listeners[e];
        if (i && 0 != i.length) {
            null == t && (t = {}), t.object = this.object, t.element = this.element, t.type || (t.type = e);
            for (var n, i = i.slice(), s = 0, r = i.length; r > s && (n = i[s], n = n.func.apply(n.obj, [t]), !(void 0 != n && 0 == n)); s++);
            return this.fallThrough || OpenLayers.Event.stop(t, !0), n
        }
    },
    handleBrowserEvent: function (e) {
        var t = e.type, i = this.listeners[t];
        if (i && 0 != i.length) {
            if ((i = e.touches) && i[0]) {
                for (var n, s = 0, r = 0, a = i.length, o = 0; a > o; ++o)n = i[o], s += n.clientX, r += n.clientY;
                e.clientX = s / a, e.clientY = r / a
            }
            this.includeXY && (e.xy = this.getMousePosition(e)), this.triggerEvent(t, e)
        }
    },
    clearMouseCache: function () {
        this.element.scrolls = null, this.element.lefttop = null;
        var e = document.body;
        e && (0 == e.scrollTop && 0 == e.scrollLeft || !navigator.userAgent.match(/iPhone/i)) && (this.element.offsets = null)
    },
    getMousePosition: function (e) {
        if (this.includeXY ? this.element.hasScrollEvent || (OpenLayers.Event.observe(window, "scroll", this.clearMouseListener), this.element.hasScrollEvent = !0) : this.clearMouseCache(), !this.element.scrolls) {
            var t = OpenLayers.Util.getViewportElement();
            this.element.scrolls = [t.scrollLeft, t.scrollTop]
        }
        return this.element.lefttop || (this.element.lefttop = [document.documentElement.clientLeft || 0, document.documentElement.clientTop || 0]), this.element.offsets || (this.element.offsets = OpenLayers.Util.pagePosition(this.element)), new OpenLayers.Pixel(e.clientX + this.element.scrolls[0] - this.element.offsets[0] - this.element.lefttop[0], e.clientY + this.element.scrolls[1] - this.element.offsets[1] - this.element.lefttop[1])
    },
    CLASS_NAME: "OpenLayers.Events"
}), OpenLayers.Events.buttonclick = OpenLayers.Class({
    target: null,
    events: "mousedown mouseup click dblclick touchstart touchmove touchend keydown".split(" "),
    startRegEx: /^mousedown|touchstart$/,
    cancelRegEx: /^touchmove$/,
    completeRegEx: /^mouseup|touchend$/,
    initialize: function (e) {
        for (this.target = e, e = this.events.length - 1; e >= 0; --e)this.target.register(this.events[e], this, this.buttonClick, {extension: !0})
    },
    destroy: function () {
        for (var e = this.events.length - 1; e >= 0; --e)this.target.unregister(this.events[e], this, this.buttonClick);
        delete this.target
    },
    getPressedButton: function (e) {
        var t, i = 3;
        do {
            if (OpenLayers.Element.hasClass(e, "olButton")) {
                t = e;
                break
            }
            e = e.parentNode
        } while (0 < --i && e);
        return t
    },
    buttonClick: function (e) {
        var t = !0, i = OpenLayers.Event.element(e);
        if (i && (OpenLayers.Event.isLeftClick(e) || !~e.type.indexOf("mouse")))if (i = this.getPressedButton(i)) {
            if ("keydown" === e.type)switch (e.keyCode) {
                case OpenLayers.Event.KEY_RETURN:
                case OpenLayers.Event.KEY_SPACE:
                    this.target.triggerEvent("buttonclick", {buttonElement: i}), OpenLayers.Event.stop(e), t = !1
            } else this.startEvt && (this.completeRegEx.test(e.type) && (t = OpenLayers.Util.pagePosition(i), this.target.triggerEvent("buttonclick", {
                buttonElement: i,
                buttonXY: {x: this.startEvt.clientX - t[0], y: this.startEvt.clientY - t[1]}
            })), this.cancelRegEx.test(e.type) && delete this.startEvt, OpenLayers.Event.stop(e), t = !1);
            this.startRegEx.test(e.type) && (this.startEvt = e, OpenLayers.Event.stop(e), t = !1)
        } else delete this.startEvt;
        return t
    }
}), OpenLayers.Control.OverviewMap = OpenLayers.Class(OpenLayers.Control, {
    element: null,
    ovmap: null,
    size: {w: 180, h: 90},
    layers: null,
    minRectSize: 15,
    minRectDisplayClass: "RectReplacement",
    minRatio: 8,
    maxRatio: 32,
    mapOptions: null,
    autoPan: !1,
    handlers: null,
    resolutionFactor: 1,
    maximized: !1,
    initialize: function (e) {
        this.layers = [], this.handlers = {}, OpenLayers.Control.prototype.initialize.apply(this, [e])
    },
    destroy: function () {
        this.mapDiv && (this.handlers.click && this.handlers.click.destroy(), this.handlers.drag && this.handlers.drag.destroy(), this.ovmap && this.ovmap.viewPortDiv.removeChild(this.extentRectangle), this.extentRectangle = null, this.rectEvents && (this.rectEvents.destroy(), this.rectEvents = null), this.ovmap && (this.ovmap.destroy(), this.ovmap = null), this.element.removeChild(this.mapDiv), this.mapDiv = null, this.div.removeChild(this.element), this.element = null, this.maximizeDiv && (this.div.removeChild(this.maximizeDiv), this.maximizeDiv = null), this.minimizeDiv && (this.div.removeChild(this.minimizeDiv), this.minimizeDiv = null), this.map.events.un({
            buttonclick: this.onButtonClick,
            moveend: this.update,
            changebaselayer: this.baseLayerDraw,
            scope: this
        }), OpenLayers.Control.prototype.destroy.apply(this, arguments))
    },
    draw: function () {
        if (OpenLayers.Control.prototype.draw.apply(this, arguments), 0 === this.layers.length) {
            if (!this.map.baseLayer)return this.map.events.register("changebaselayer", this, this.baseLayerDraw), this.div;
            this.layers = [this.map.baseLayer.clone()]
        }
        if (this.element = document.createElement("div"), this.element.className = this.displayClass + "Element", this.element.style.display = "none", this.mapDiv = document.createElement("div"), this.mapDiv.style.width = this.size.w + "px", this.mapDiv.style.height = this.size.h + "px", this.mapDiv.style.position = "relative", this.mapDiv.style.overflow = "hidden", this.mapDiv.id = OpenLayers.Util.createUniqueID("overviewMap"), this.extentRectangle = document.createElement("div"), this.extentRectangle.style.position = "absolute", this.extentRectangle.style.zIndex = 1e3, this.extentRectangle.className = this.displayClass + "ExtentRectangle", this.element.appendChild(this.mapDiv), this.div.appendChild(this.element), this.outsideViewport) this.element.style.display = ""; else {
            this.div.className += " " + this.displayClass + "Container";
            var e = OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");
            this.maximizeDiv = OpenLayers.Util.createAlphaImageDiv(this.displayClass + "MaximizeButton", null, null, e, "absolute"), this.maximizeDiv.style.display = "none", this.maximizeDiv.className = this.displayClass + "MaximizeButton olButton", this.div.appendChild(this.maximizeDiv), e = OpenLayers.Util.getImageLocation("layer-switcher-minimize.png"), this.minimizeDiv = OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_minimizeDiv", null, null, e, "absolute"), this.minimizeDiv.style.display = "none", this.minimizeDiv.className = this.displayClass + "MinimizeButton olButton", this.div.appendChild(this.minimizeDiv), this.minimizeControl()
        }
        return this.map.getExtent() && this.update(), this.map.events.on({
            buttonclick: this.onButtonClick,
            moveend: this.update,
            scope: this
        }), this.maximized && this.maximizeControl(), this.div
    },
    baseLayerDraw: function () {
        this.draw(), this.map.events.unregister("changebaselayer", this, this.baseLayerDraw)
    },
    rectDrag: function (e) {
        var t = this.handlers.drag.last.x - e.x, i = this.handlers.drag.last.y - e.y;
        if (0 != t || 0 != i) {
            var n = this.rectPxBounds.top, s = this.rectPxBounds.left, e = Math.abs(this.rectPxBounds.getHeight()), r = this.rectPxBounds.getWidth(), i = Math.max(0, n - i), i = Math.min(i, this.ovmap.size.h - this.hComp - e), t = Math.max(0, s - t), t = Math.min(t, this.ovmap.size.w - this.wComp - r);
            this.setRectPxBounds(new OpenLayers.Bounds(t, i + e, t + r, i))
        }
    },
    mapDivClick: function (e) {
        var t = this.rectPxBounds.getCenterPixel(), i = e.xy.x - t.x, n = e.xy.y - t.y, s = this.rectPxBounds.top, r = this.rectPxBounds.left, e = Math.abs(this.rectPxBounds.getHeight()), t = this.rectPxBounds.getWidth(), n = Math.max(0, s + n), n = Math.min(n, this.ovmap.size.h - e), i = Math.max(0, r + i), i = Math.min(i, this.ovmap.size.w - t);
        this.setRectPxBounds(new OpenLayers.Bounds(i, n + e, i + t, n)), this.updateMapToRect()
    },
    onButtonClick: function (e) {
        e.buttonElement === this.minimizeDiv ? this.minimizeControl() : e.buttonElement === this.maximizeDiv && this.maximizeControl()
    },
    maximizeControl: function (e) {
        this.element.style.display = "", this.showToggle(!1), null != e && OpenLayers.Event.stop(e)
    },
    minimizeControl: function (e) {
        this.element.style.display = "none", this.showToggle(!0), null != e && OpenLayers.Event.stop(e)
    },
    showToggle: function (e) {
        this.maximizeDiv.style.display = e ? "" : "none", this.minimizeDiv.style.display = e ? "none" : ""
    },
    update: function () {
        null == this.ovmap && this.createMap(), (this.autoPan || !this.isSuitableOverview()) && this.updateOverview(), this.updateRectToMap()
    },
    isSuitableOverview: function () {
        var e = this.map.getExtent(), t = this.map.maxExtent, e = new OpenLayers.Bounds(Math.max(e.left, t.left), Math.max(e.bottom, t.bottom), Math.min(e.right, t.right), Math.min(e.top, t.top));
        return this.ovmap.getProjection() != this.map.getProjection() && (e = e.transform(this.map.getProjectionObject(), this.ovmap.getProjectionObject())), t = this.ovmap.getResolution() / this.map.getResolution(), t > this.minRatio && t <= this.maxRatio && this.ovmap.getExtent().containsBounds(e)
    },
    updateOverview: function () {
        var e = this.map.getResolution(), t = this.ovmap.getResolution(), i = t / e;
        i > this.maxRatio ? t = this.minRatio * e : i <= this.minRatio && (t = this.maxRatio * e), this.ovmap.getProjection() != this.map.getProjection() ? (e = this.map.center.clone(), e.transform(this.map.getProjectionObject(), this.ovmap.getProjectionObject())) : e = this.map.center, this.ovmap.setCenter(e, this.ovmap.getZoomForResolution(t * this.resolutionFactor)), this.updateRectToMap()
    },
    createMap: function () {
        var e = OpenLayers.Util.extend({controls: [], maxResolution: "auto", fallThrough: !1}, this.mapOptions);
        if (this.ovmap = new OpenLayers.Map(this.mapDiv, e), this.ovmap.viewPortDiv.appendChild(this.extentRectangle), OpenLayers.Event.stopObserving(window, "unload", this.ovmap.unloadDestroy), this.ovmap.addLayers(this.layers), this.ovmap.zoomToMaxExtent(), this.wComp = (this.wComp = parseInt(OpenLayers.Element.getStyle(this.extentRectangle, "border-left-width")) + parseInt(OpenLayers.Element.getStyle(this.extentRectangle, "border-right-width"))) ? this.wComp : 2, this.hComp = (this.hComp = parseInt(OpenLayers.Element.getStyle(this.extentRectangle, "border-top-width")) + parseInt(OpenLayers.Element.getStyle(this.extentRectangle, "border-bottom-width"))) ? this.hComp : 2, this.handlers.drag = new OpenLayers.Handler.Drag(this, {
                move: this.rectDrag,
                done: this.updateMapToRect
            }, {map: this.ovmap}), this.handlers.click = new OpenLayers.Handler.Click(this, {click: this.mapDivClick}, {
                single: !0,
                "double": !1,
                stopSingle: !0,
                stopDouble: !0,
                pixelTolerance: 1,
                map: this.ovmap
            }), this.handlers.click.activate(), this.rectEvents = new OpenLayers.Events(this, this.extentRectangle, null, !0), this.rectEvents.register("mouseover", this, function () {
                !this.handlers.drag.active && !this.map.dragging && this.handlers.drag.activate()
            }), this.rectEvents.register("mouseout", this, function () {
                this.handlers.drag.dragging || this.handlers.drag.deactivate()
            }), this.ovmap.getProjection() != this.map.getProjection()) {
            var e = this.map.getProjectionObject().getUnits() || this.map.units || this.map.baseLayer.units, t = this.ovmap.getProjectionObject().getUnits() || this.ovmap.units || this.ovmap.baseLayer.units;
            this.resolutionFactor = e && t ? OpenLayers.INCHES_PER_UNIT[e] / OpenLayers.INCHES_PER_UNIT[t] : 1
        }
    },
    updateRectToMap: function () {
        var e = this.getRectBoundsFromMapBounds(this.ovmap.getProjection() != this.map.getProjection() ? this.map.getExtent().transform(this.map.getProjectionObject(), this.ovmap.getProjectionObject()) : this.map.getExtent());
        e && this.setRectPxBounds(e)
    },
    updateMapToRect: function () {
        var e = this.getMapBoundsFromRectBounds(this.rectPxBounds);
        this.ovmap.getProjection() != this.map.getProjection() && (e = e.transform(this.ovmap.getProjectionObject(), this.map.getProjectionObject())), this.map.panTo(e.getCenterLonLat())
    },
    setRectPxBounds: function (e) {
        var t = Math.max(e.top, 0), i = Math.max(e.left, 0), n = Math.min(e.top + Math.abs(e.getHeight()), this.ovmap.size.h - this.hComp), e = Math.min(e.left + e.getWidth(), this.ovmap.size.w - this.wComp), s = Math.max(e - i, 0), r = Math.max(n - t, 0);
        s < this.minRectSize || r < this.minRectSize ? (this.extentRectangle.className = this.displayClass + this.minRectDisplayClass, s = i + s / 2 - this.minRectSize / 2, this.extentRectangle.style.top = Math.round(t + r / 2 - this.minRectSize / 2) + "px", this.extentRectangle.style.left = Math.round(s) + "px", this.extentRectangle.style.height = this.minRectSize + "px", this.extentRectangle.style.width = this.minRectSize + "px") : (this.extentRectangle.className = this.displayClass + "ExtentRectangle", this.extentRectangle.style.top = Math.round(t) + "px", this.extentRectangle.style.left = Math.round(i) + "px", this.extentRectangle.style.height = Math.round(r) + "px", this.extentRectangle.style.width = Math.round(s) + "px"), this.rectPxBounds = new OpenLayers.Bounds(Math.round(i), Math.round(n), Math.round(e), Math.round(t))
    },
    getRectBoundsFromMapBounds: function (e) {
        var t = this.getOverviewPxFromLonLat({
            lon: e.left,
            lat: e.bottom
        }), e = this.getOverviewPxFromLonLat({lon: e.right, lat: e.top}), i = null;
        return t && e && (i = new OpenLayers.Bounds(t.x, t.y, e.x, e.y)), i
    },
    getMapBoundsFromRectBounds: function (e) {
        var t = this.getLonLatFromOverviewPx({x: e.left, y: e.bottom}), e = this.getLonLatFromOverviewPx({
            x: e.right,
            y: e.top
        });
        return new OpenLayers.Bounds(t.lon, t.lat, e.lon, e.lat)
    },
    getLonLatFromOverviewPx: function (e) {
        var t = this.ovmap.size, i = this.ovmap.getResolution(), n = this.ovmap.getExtent().getCenterLonLat();
        return {lon: n.lon + (e.x - t.w / 2) * i, lat: n.lat - (e.y - t.h / 2) * i}
    },
    getOverviewPxFromLonLat: function (e) {
        var t = this.ovmap.getResolution(), i = this.ovmap.getExtent();
        return i ? {x: Math.round(1 / t * (e.lon - i.left)), y: Math.round(1 / t * (i.top - e.lat))} : void 0
    },
    CLASS_NAME: "OpenLayers.Control.OverviewMap"
}), OpenLayers.Animation = function (e) {
    var t = !!(e.requestAnimationFrame || e.webkitRequestAnimationFrame || e.mozRequestAnimationFrame || e.oRequestAnimationFrame || e.msRequestAnimationFrame), i = function () {
        var t = e.requestAnimationFrame || e.webkitRequestAnimationFrame || e.mozRequestAnimationFrame || e.oRequestAnimationFrame || e.msRequestAnimationFrame || function (t) {
                e.setTimeout(t, 16)
            };
        return function (i, n) {
            t.apply(e, [i, n])
        }
    }(), n = 0, s = {};
    return {
        isNative: t, requestFrame: i, start: function (e, t, r) {
            var t = t > 0 ? t : Number.POSITIVE_INFINITY, a = ++n, o = +new Date;
            return s[a] = function () {
                s[a] && +new Date - o <= t ? (e(), s[a] && i(s[a], r)) : delete s[a]
            }, i(s[a], r), a
        }, stop: function (e) {
            delete s[e]
        }
    }
}(window), OpenLayers.Tween = OpenLayers.Class({
    easing: null,
    begin: null,
    finish: null,
    duration: null,
    callbacks: null,
    time: null,
    animationId: null,
    playing: !1,
    initialize: function (e) {
        this.easing = e ? e : OpenLayers.Easing.Expo.easeOut
    },
    start: function (e, t, i, n) {
        this.playing = !0, this.begin = e, this.finish = t, this.duration = i, this.callbacks = n.callbacks, this.time = 0, OpenLayers.Animation.stop(this.animationId), this.animationId = null, this.callbacks && this.callbacks.start && this.callbacks.start.call(this, this.begin), this.animationId = OpenLayers.Animation.start(OpenLayers.Function.bind(this.play, this))
    },
    stop: function () {
        this.playing && (this.callbacks && this.callbacks.done && this.callbacks.done.call(this, this.finish), OpenLayers.Animation.stop(this.animationId), this.animationId = null, this.playing = !1)
    },
    play: function () {
        var e, t = {};
        for (e in this.begin) {
            var i = this.begin[e], n = this.finish[e];
            if (null == i || null == n || isNaN(i) || isNaN(n))throw new TypeError("invalid value for Tween");
            t[e] = this.easing.apply(this, [this.time, i, n - i, this.duration])
        }
        this.time++, this.callbacks && this.callbacks.eachStep && this.callbacks.eachStep.call(this, t), this.time > this.duration && this.stop()
    },
    CLASS_NAME: "OpenLayers.Tween"
}), OpenLayers.Easing = {CLASS_NAME: "OpenLayers.Easing"}, OpenLayers.Easing.Linear = {
    easeIn: function (e, t, i, n) {
        return i * e / n + t
    }, easeOut: function (e, t, i, n) {
        return i * e / n + t
    }, easeInOut: function (e, t, i, n) {
        return i * e / n + t
    }, CLASS_NAME: "OpenLayers.Easing.Linear"
}, OpenLayers.Easing.Expo = {
    easeIn: function (e, t, i, n) {
        return 0 == e ? t : i * Math.pow(2, 10 * (e / n - 1)) + t
    }, easeOut: function (e, t, i, n) {
        return e == n ? t + i : i * (-Math.pow(2, -10 * e / n) + 1) + t
    }, easeInOut: function (e, t, i, n) {
        return 0 == e ? t : e == n ? t + i : 1 > (e /= n / 2) ? i / 2 * Math.pow(2, 10 * (e - 1)) + t : i / 2 * (-Math.pow(2, -10 * --e) + 2) + t
    }, CLASS_NAME: "OpenLayers.Easing.Expo"
}, OpenLayers.Easing.Quad = {
    easeIn: function (e, t, i, n) {
        return i * (e /= n) * e + t
    }, easeOut: function (e, t, i, n) {
        return -i * (e /= n) * (e - 2) + t
    }, easeInOut: function (e, t, i, n) {
        return 1 > (e /= n / 2) ? i / 2 * e * e + t : -i / 2 * (--e * (e - 2) - 1) + t
    }, CLASS_NAME: "OpenLayers.Easing.Quad"
}, OpenLayers.Projection = OpenLayers.Class({
    proj: null,
    projCode: null,
    titleRegEx: /\+title=[^\+]*/,
    initialize: function (e, t) {
        OpenLayers.Util.extend(this, t), this.projCode = e, window.Proj4js && (this.proj = new Proj4js.Proj(e))
    },
    getCode: function () {
        return this.proj ? this.proj.srsCode : this.projCode
    },
    getUnits: function () {
        return this.proj ? this.proj.units : null
    },
    toString: function () {
        return this.getCode()
    },
    equals: function (e) {
        var t = !1;
        return e && (e instanceof OpenLayers.Projection || (e = new OpenLayers.Projection(e)), window.Proj4js && this.proj.defData && e.proj.defData ? t = this.proj.defData.replace(this.titleRegEx, "") == e.proj.defData.replace(this.titleRegEx, "") : e.getCode && (t = this.getCode(), e = e.getCode(), t = t == e || !!OpenLayers.Projection.transforms[t] && OpenLayers.Projection.transforms[t][e] === OpenLayers.Projection.nullTransform)), t
    },
    destroy: function () {
        delete this.proj, delete this.projCode
    },
    CLASS_NAME: "OpenLayers.Projection"
}), OpenLayers.Projection.transforms = {}, OpenLayers.Projection.defaults = {
    "EPSG:4326": {
        units: "degrees",
        maxExtent: [-180, -90, 180, 90],
        yx: !0
    },
    "CRS:84": {units: "degrees", maxExtent: [-180, -90, 180, 90]},
    "EPSG:900913": {units: "m", maxExtent: [-20037508.34, -20037508.34, 20037508.34, 20037508.34]}
},OpenLayers.Projection.addTransform = function (e, t, i) {
    if (i === OpenLayers.Projection.nullTransform) {
        var n = OpenLayers.Projection.defaults[e];
        n && !OpenLayers.Projection.defaults[t] && (OpenLayers.Projection.defaults[t] = n)
    }
    OpenLayers.Projection.transforms[e] || (OpenLayers.Projection.transforms[e] = {}), OpenLayers.Projection.transforms[e][t] = i
},OpenLayers.Projection.transform = function (e, t, i) {
    if (t && i)if (t instanceof OpenLayers.Projection || (t = new OpenLayers.Projection(t)), i instanceof OpenLayers.Projection || (i = new OpenLayers.Projection(i)), t.proj && i.proj) e = Proj4js.transform(t.proj, i.proj, e); else {
        var t = t.getCode(), i = i.getCode(), n = OpenLayers.Projection.transforms;
        n[t] && n[t][i] && n[t][i](e)
    }
    return e
},OpenLayers.Projection.nullTransform = function (e) {
    return e
},function () {
    function e(e) {
        return e.x = 180 * e.x / s, e.y = 180 / Math.PI * (2 * Math.atan(Math.exp(e.y / s * Math.PI)) - Math.PI / 2), e
    }

    function t(e) {
        return e.x = e.x * s / 180, e.y = Math.log(Math.tan((90 + e.y) * Math.PI / 360)) / Math.PI * s, e
    }

    function i(i, n) {
        var s, r, a, o, l, h = OpenLayers.Projection.addTransform, u = OpenLayers.Projection.nullTransform;
        for (s = 0, r = n.length; r > s; ++s)for (a = n[s], h(i, a, t), h(a, i, e), l = s + 1; r > l; ++l)o = n[l], h(a, o, u), h(o, a, u)
    }

    var n, s = 20037508.34, r = ["EPSG:900913", "EPSG:3857", "EPSG:102113", "EPSG:102100"], a = ["CRS:84", "urn:ogc:def:crs:EPSG:6.6:4326", "EPSG:4326"];
    for (n = r.length - 1; n >= 0; --n)i(r[n], a);
    for (n = a.length - 1; n >= 0; --n)i(a[n], r)
}(),OpenLayers.Map = OpenLayers.Class({
    Z_INDEX_BASE: {BaseLayer: 100, Overlay: 325, Feature: 725, Popup: 750, Control: 1e3},
    id: null,
    fractionalZoom: !1,
    events: null,
    allOverlays: !1,
    div: null,
    dragging: !1,
    size: null,
    viewPortDiv: null,
    layerContainerOrigin: null,
    layerContainerDiv: null,
    layers: null,
    controls: null,
    popups: null,
    baseLayer: null,
    center: null,
    resolution: null,
    zoom: 0,
    panRatio: 1.5,
    options: null,
    tileSize: null,
    projection: "EPSG:4326",
    units: null,
    resolutions: null,
    maxResolution: null,
    minResolution: null,
    maxScale: null,
    minScale: null,
    maxExtent: null,
    minExtent: null,
    restrictedExtent: null,
    numZoomLevels: 16,
    theme: null,
    displayProjection: null,
    fallThrough: !0,
    panTween: null,
    eventListeners: null,
    panMethod: OpenLayers.Easing.Expo.easeOut,
    panDuration: 50,
    paddingForPopups: null,
    minPx: null,
    maxPx: null,
    initialize: function (e, t) {
        1 === arguments.length && "object" == typeof e && (e = (t = e) && t.div), this.tileSize = new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH, OpenLayers.Map.TILE_HEIGHT), this.paddingForPopups = new OpenLayers.Bounds(15, 15, 15, 15), this.theme = OpenLayers._getScriptLocation() + "theme/default/style.css", this.options = OpenLayers.Util.extend({}, t), OpenLayers.Util.extend(this, t), OpenLayers.Util.applyDefaults(this, OpenLayers.Projection.defaults[this.projection instanceof OpenLayers.Projection ? this.projection.projCode : this.projection]), this.maxExtent && !(this.maxExtent instanceof OpenLayers.Bounds) && (this.maxExtent = new OpenLayers.Bounds(this.maxExtent)), this.minExtent && !(this.minExtent instanceof OpenLayers.Bounds) && (this.minExtent = new OpenLayers.Bounds(this.minExtent)), this.restrictedExtent && !(this.restrictedExtent instanceof OpenLayers.Bounds) && (this.restrictedExtent = new OpenLayers.Bounds(this.restrictedExtent)), this.center && !(this.center instanceof OpenLayers.LonLat) && (this.center = new OpenLayers.LonLat(this.center)), this.layers = [], this.id = OpenLayers.Util.createUniqueID("OpenLayers.Map_"), this.div = OpenLayers.Util.getElement(e), this.div || (this.div = document.createElement("div"), this.div.style.height = "1px", this.div.style.width = "1px"), OpenLayers.Element.addClass(this.div, "olMap");
        var i = this.id + "_OpenLayers_ViewPort";
        if (this.viewPortDiv = OpenLayers.Util.createDiv(i, null, null, null, "relative", null, "hidden"), this.viewPortDiv.style.width = "100%", this.viewPortDiv.style.height = "100%", this.viewPortDiv.className = "olMapViewport", this.div.appendChild(this.viewPortDiv), this.events = new OpenLayers.Events(this, this.viewPortDiv, null, this.fallThrough, {includeXY: !0}), i = this.id + "_OpenLayers_Container", this.layerContainerDiv = OpenLayers.Util.createDiv(i), this.layerContainerDiv.style.width = "100px", this.layerContainerDiv.style.height = "100px", this.layerContainerDiv.style.zIndex = this.Z_INDEX_BASE.Popup - 1, this.viewPortDiv.appendChild(this.layerContainerDiv), this.updateSize(), this.eventListeners instanceof Object && this.events.on(this.eventListeners), 9 > parseFloat(navigator.appVersion.split("MSIE")[1]) ? this.events.register("resize", this, this.updateSize) : (this.updateSizeDestroy = OpenLayers.Function.bind(this.updateSize, this), OpenLayers.Event.observe(window, "resize", this.updateSizeDestroy)), this.theme) {
            for (var i = !0, n = document.getElementsByTagName("link"), s = 0, r = n.length; r > s; ++s)if (OpenLayers.Util.isEquivalentUrl(n.item(s).href, this.theme)) {
                i = !1;
                break
            }
            i && (i = document.createElement("link"), i.setAttribute("rel", "stylesheet"), i.setAttribute("type", "text/css"), i.setAttribute("href", this.theme), document.getElementsByTagName("head")[0].appendChild(i))
        }
        for (null == this.controls && (this.controls = [], null != OpenLayers.Control && (OpenLayers.Control.Navigation ? this.controls.push(new OpenLayers.Control.Navigation) : OpenLayers.Control.TouchNavigation && this.controls.push(new OpenLayers.Control.TouchNavigation), OpenLayers.Control.Zoom ? this.controls.push(new OpenLayers.Control.Zoom) : OpenLayers.Control.PanZoom && this.controls.push(new OpenLayers.Control.PanZoom), OpenLayers.Control.ArgParser && this.controls.push(new OpenLayers.Control.ArgParser), OpenLayers.Control.Attribution && this.controls.push(new OpenLayers.Control.Attribution))), s = 0, r = this.controls.length; r > s; s++)this.addControlToMap(this.controls[s]);
        this.popups = [], this.unloadDestroy = OpenLayers.Function.bind(this.destroy, this), OpenLayers.Event.observe(window, "unload", this.unloadDestroy), t && t.layers && (delete this.center, this.addLayers(t.layers), t.center && !this.getCenter() && this.setCenter(t.center, t.zoom))
    },
    getViewport: function () {
        return this.viewPortDiv
    },
    render: function (e) {
        this.div = OpenLayers.Util.getElement(e), OpenLayers.Element.addClass(this.div, "olMap"), this.viewPortDiv.parentNode.removeChild(this.viewPortDiv), this.div.appendChild(this.viewPortDiv), this.updateSize()
    },
    unloadDestroy: null,
    updateSizeDestroy: null,
    destroy: function () {
        if (!this.unloadDestroy)return !1;
        if (this.panTween && (this.panTween.stop(), this.panTween = null), OpenLayers.Event.stopObserving(window, "unload", this.unloadDestroy), this.unloadDestroy = null, this.updateSizeDestroy ? OpenLayers.Event.stopObserving(window, "resize", this.updateSizeDestroy) : this.events.unregister("resize", this, this.updateSize), this.paddingForPopups = null, null != this.controls) {
            for (var e = this.controls.length - 1; e >= 0; --e)this.controls[e].destroy();
            this.controls = null
        }
        if (null != this.layers) {
            for (e = this.layers.length - 1; e >= 0; --e)this.layers[e].destroy(!1);
            this.layers = null
        }
        this.viewPortDiv && this.div.removeChild(this.viewPortDiv), this.viewPortDiv = null, this.eventListeners && (this.events.un(this.eventListeners), this.eventListeners = null), this.events.destroy(), this.options = this.events = null
    },
    setOptions: function (e) {
        var t = this.minPx && e.restrictedExtent != this.restrictedExtent;
        OpenLayers.Util.extend(this, e), t && this.moveTo(this.getCachedCenter(), this.zoom, {forceZoomChange: !0})
    },
    getTileSize: function () {
        return this.tileSize
    },
    getBy: function (e, t, i) {
        var n = "function" == typeof i.test;
        return OpenLayers.Array.filter(this[e], function (e) {
            return e[t] == i || n && i.test(e[t])
        })
    },
    getLayersBy: function (e, t) {
        return this.getBy("layers", e, t)
    },
    getLayersByName: function (e) {
        return this.getLayersBy("name", e)
    },
    getLayersByClass: function (e) {
        return this.getLayersBy("CLASS_NAME", e)
    },
    getControlsBy: function (e, t) {
        return this.getBy("controls", e, t)
    },
    getControlsByClass: function (e) {
        return this.getControlsBy("CLASS_NAME", e)
    },
    getLayer: function (e) {
        for (var t = null, i = 0, n = this.layers.length; n > i; i++) {
            var s = this.layers[i];
            if (s.id == e) {
                t = s;
                break
            }
        }
        return t
    },
    setLayerZIndex: function (e, t) {
        e.setZIndex(this.Z_INDEX_BASE[e.isBaseLayer ? "BaseLayer" : "Overlay"] + t)
    },
    resetLayersZIndex: function () {
        for (var e = 0, t = this.layers.length; t > e; e++)this.setLayerZIndex(this.layers[e], e)
    },
    addLayer: function (e) {
        for (var t = 0, i = this.layers.length; i > t; t++)if (this.layers[t] == e)return !1;
        return !1 === this.events.triggerEvent("preaddlayer", {layer: e}) ? !1 : (this.allOverlays && (e.isBaseLayer = !1), e.div.className = "olLayerDiv", e.div.style.overflow = "", this.setLayerZIndex(e, this.layers.length), e.isFixed ? this.viewPortDiv.appendChild(e.div) : this.layerContainerDiv.appendChild(e.div), this.layers.push(e), e.setMap(this), e.isBaseLayer || this.allOverlays && !this.baseLayer ? null == this.baseLayer ? this.setBaseLayer(e) : e.setVisibility(!1) : e.redraw(), this.events.triggerEvent("addlayer", {layer: e}), e.events.triggerEvent("added", {
            map: this,
            layer: e
        }), e.afterAdd(), !0)
    },
    addLayers: function (e) {
        for (var t = 0, i = e.length; i > t; t++)this.addLayer(e[t])
    },
    removeLayer: function (e, t) {
        if (!1 !== this.events.triggerEvent("preremovelayer", {layer: e})) {
            if (null == t && (t = !0), e.isFixed ? this.viewPortDiv.removeChild(e.div) : this.layerContainerDiv.removeChild(e.div), OpenLayers.Util.removeItem(this.layers, e), e.removeMap(this), e.map = null, this.baseLayer == e && (this.baseLayer = null, t))for (var i = 0, n = this.layers.length; n > i; i++) {
                var s = this.layers[i];
                if (s.isBaseLayer || this.allOverlays) {
                    this.setBaseLayer(s);
                    break
                }
            }
            this.resetLayersZIndex(), this.events.triggerEvent("removelayer", {layer: e}), e.events.triggerEvent("removed", {
                map: this,
                layer: e
            })
        }
    },
    getNumLayers: function () {
        return this.layers.length
    },
    getLayerIndex: function (e) {
        return OpenLayers.Util.indexOf(this.layers, e)
    },
    setLayerIndex: function (e, t) {
        var i = this.getLayerIndex(e);
        if (0 > t ? t = 0 : t > this.layers.length && (t = this.layers.length), i != t) {
            this.layers.splice(i, 1), this.layers.splice(t, 0, e);
            for (var i = 0, n = this.layers.length; n > i; i++)this.setLayerZIndex(this.layers[i], i);
            this.events.triggerEvent("changelayer", {
                layer: e,
                property: "order"
            }), this.allOverlays && (0 === t ? this.setBaseLayer(e) : this.baseLayer !== this.layers[0] && this.setBaseLayer(this.layers[0]))
        }
    },
    raiseLayer: function (e, t) {
        var i = this.getLayerIndex(e) + t;
        this.setLayerIndex(e, i)
    },
    setBaseLayer: function (e) {
        if (e != this.baseLayer && -1 != OpenLayers.Util.indexOf(this.layers, e)) {
            var t = this.getCachedCenter(), i = OpenLayers.Util.getResolutionFromScale(this.getScale(), e.units);
            null != this.baseLayer && !this.allOverlays && this.baseLayer.setVisibility(!1), this.baseLayer = e, (!this.allOverlays || this.baseLayer.visibility) && (this.baseLayer.setVisibility(!0), !1 === this.baseLayer.inRange && this.baseLayer.redraw()), null != t && (e = this.getZoomForResolution(i || this.resolution, !0), this.setCenter(t, e, !1, !0)), this.events.triggerEvent("changebaselayer", {layer: this.baseLayer})
        }
    },
    addControl: function (e, t) {
        this.controls.push(e), this.addControlToMap(e, t)
    },
    addControls: function (e, t) {
        for (var i = 1 === arguments.length ? [] : t, n = 0, s = e.length; s > n; n++)this.addControl(e[n], i[n] ? i[n] : null)
    },
    addControlToMap: function (e, t) {
        e.outsideViewport = null != e.div, this.displayProjection && !e.displayProjection && (e.displayProjection = this.displayProjection), e.setMap(this);
        var i = e.draw(t);
        i && !e.outsideViewport && (i.style.zIndex = this.Z_INDEX_BASE.Control + this.controls.length, this.viewPortDiv.appendChild(i)), e.autoActivate && e.activate()
    },
    getControl: function (e) {
        for (var t = null, i = 0, n = this.controls.length; n > i; i++) {
            var s = this.controls[i];
            if (s.id == e) {
                t = s;
                break
            }
        }
        return t
    },
    removeControl: function (e) {
        e && e == this.getControl(e.id) && (e.div && e.div.parentNode == this.viewPortDiv && this.viewPortDiv.removeChild(e.div), OpenLayers.Util.removeItem(this.controls, e))
    },
    addPopup: function (e, t) {
        if (t)for (var i = this.popups.length - 1; i >= 0; --i)this.removePopup(this.popups[i]);
        e.map = this, this.popups.push(e), (i = e.draw()) && (i.style.zIndex = this.Z_INDEX_BASE.Popup + this.popups.length, this.layerContainerDiv.appendChild(i))
    },
    removePopup: function (e) {
        if (OpenLayers.Util.removeItem(this.popups, e), e.div)try {
            this.layerContainerDiv.removeChild(e.div)
        } catch (t) {
        }
        e.map = null
    },
    getSize: function () {
        var e = null;
        return null != this.size && (e = this.size.clone()), e
    },
    updateSize: function () {
        var e = this.getCurrentSize();
        if (e && !isNaN(e.h) && !isNaN(e.w)) {
            this.events.clearMouseCache();
            var t = this.getSize();
            if (null == t && (this.size = t = e), !e.equals(t)) {
                for (this.size = e, e = 0, t = this.layers.length; t > e; e++)this.layers[e].onMapResize();
                e = this.getCachedCenter(), null != this.baseLayer && null != e && (t = this.getZoom(), this.zoom = null, this.setCenter(e, t))
            }
        }
    },
    getCurrentSize: function () {
        var e = new OpenLayers.Size(this.div.clientWidth, this.div.clientHeight);
        return (0 == e.w && 0 == e.h || isNaN(e.w) && isNaN(e.h)) && (e.w = this.div.offsetWidth, e.h = this.div.offsetHeight), (0 == e.w && 0 == e.h || isNaN(e.w) && isNaN(e.h)) && (e.w = parseInt(this.div.style.width), e.h = parseInt(this.div.style.height)), e
    },
    calculateBounds: function (e, t) {
        var i = null;
        if (null == e && (e = this.getCachedCenter()), null == t && (t = this.getResolution()), null != e && null != t)var i = this.size.w * t / 2, n = this.size.h * t / 2, i = new OpenLayers.Bounds(e.lon - i, e.lat - n, e.lon + i, e.lat + n);
        return i
    },
    getCenter: function () {
        var e = null, t = this.getCachedCenter();
        return t && (e = t.clone()), e
    },
    getCachedCenter: function () {
        return !this.center && this.size && (this.center = this.getLonLatFromViewPortPx({
            x: this.size.w / 2,
            y: this.size.h / 2
        })), this.center
    },
    getZoom: function () {
        return this.zoom
    },
    pan: function (e, t, i) {
        if (i = OpenLayers.Util.applyDefaults(i, {
                animate: !0,
                dragging: !1
            }), i.dragging) (0 != e || 0 != t) && this.moveByPx(e, t); else {
            var n = this.getViewPortPxFromLonLat(this.getCachedCenter()), e = n.add(e, t);
            (this.dragging || !e.equals(n)) && (n = this.getLonLatFromViewPortPx(e), i.animate ? this.panTo(n) : (this.moveTo(n), this.dragging && (this.dragging = !1, this.events.triggerEvent("moveend"))))
        }
    },
    panTo: function (e) {
        if (this.panMethod && this.getExtent().scale(this.panRatio).containsLonLat(e)) {
            this.panTween || (this.panTween = new OpenLayers.Tween(this.panMethod));
            var t = this.getCachedCenter();
            if (!e.equals(t)) {
                var t = this.getPixelFromLonLat(t), i = this.getPixelFromLonLat(e), n = 0, s = 0;
                this.panTween.start({x: 0, y: 0}, {
                    x: i.x - t.x,
                    y: i.y - t.y
                }, this.panDuration, {
                    callbacks: {
                        eachStep: OpenLayers.Function.bind(function (e) {
                            this.moveByPx(e.x - n, e.y - s), n = Math.round(e.x), s = Math.round(e.y)
                        }, this), done: OpenLayers.Function.bind(function () {
                            this.moveTo(e), this.dragging = !1, this.events.triggerEvent("moveend")
                        }, this)
                    }
                })
            }
        } else this.setCenter(e)
    },
    setCenter: function (e, t, i, n) {
        this.panTween && this.panTween.stop(), this.moveTo(e, t, {dragging: i, forceZoomChange: n})
    },
    moveByPx: function (e, t) {
        var i = this.size.w / 2, n = this.size.h / 2, s = i + e, r = n + t, a = this.baseLayer.wrapDateLine, o = 0, l = 0;
        if (this.restrictedExtent && (o = i, l = n, a = !1), e = a || s <= this.maxPx.x - o && s >= this.minPx.x + o ? Math.round(e) : 0, t = r <= this.maxPx.y - l && r >= this.minPx.y + l ? Math.round(t) : 0, e || t) {
            for (this.dragging || (this.dragging = !0, this.events.triggerEvent("movestart")), this.center = null, e && (this.layerContainerDiv.style.left = parseInt(this.layerContainerDiv.style.left) - e + "px", this.minPx.x -= e, this.maxPx.x -= e), t && (this.layerContainerDiv.style.top = parseInt(this.layerContainerDiv.style.top) - t + "px", this.minPx.y -= t, this.maxPx.y -= t), n = 0, s = this.layers.length; s > n; ++n)i = this.layers[n], i.visibility && (i === this.baseLayer || i.inRange) && (i.moveByPx(e, t), i.events.triggerEvent("move"));
            this.events.triggerEvent("move")
        }
    },
    adjustZoom: function (e) {
        var t = this.baseLayer.resolutions, i = this.getMaxExtent().getWidth() / this.size.w;
        if (this.getResolutionForZoom(e) > i)for (var n = 0 | e, s = t.length; s > n; ++n)if (t[n] <= i) {
            e = n;
            break
        }
        return e
    },
    moveTo: function (e, t, i) {
        if (null != e && !(e instanceof OpenLayers.LonLat) && (e = new OpenLayers.LonLat(e)), i || (i = {}), null != t && (t = parseFloat(t), this.fractionalZoom || (t = Math.round(t))), this.baseLayer.wrapDateLine) {
            var n = t, t = this.adjustZoom(t);
            t !== n && (e = this.getCenter())
        }
        var n = i.dragging || this.dragging, s = i.forceZoomChange;
        if (!this.getCachedCenter() && !this.isValidLonLat(e) && (e = this.maxExtent.getCenterLonLat(), this.center = e.clone()), null != this.restrictedExtent) {
            null == e && (e = this.center), null == t && (t = this.getZoom());
            var r = this.getResolutionForZoom(t), r = this.calculateBounds(e, r);
            if (!this.restrictedExtent.containsBounds(r)) {
                var a = this.restrictedExtent.getCenterLonLat();
                r.getWidth() > this.restrictedExtent.getWidth() ? e = new OpenLayers.LonLat(a.lon, e.lat) : r.left < this.restrictedExtent.left ? e = e.add(this.restrictedExtent.left - r.left, 0) : r.right > this.restrictedExtent.right && (e = e.add(this.restrictedExtent.right - r.right, 0)), r.getHeight() > this.restrictedExtent.getHeight() ? e = new OpenLayers.LonLat(e.lon, a.lat) : r.bottom < this.restrictedExtent.bottom ? e = e.add(0, this.restrictedExtent.bottom - r.bottom) : r.top > this.restrictedExtent.top && (e = e.add(0, this.restrictedExtent.top - r.top))
            }
        }
        if (s = s || this.isValidZoomLevel(t) && t != this.getZoom(), r = this.isValidLonLat(e) && !e.equals(this.center), s || r || n) {
            if (n || this.events.triggerEvent("movestart"), r && (!s && this.center && this.centerLayerContainer(e), this.center = e.clone()), e = s ? this.getResolutionForZoom(t) : this.getResolution(), s || null == this.layerContainerOrigin) {
                this.layerContainerOrigin = this.getCachedCenter(), this.layerContainerDiv.style.left = "0px", this.layerContainerDiv.style.top = "0px";
                var r = this.getMaxExtent({restricted: !0}), o = r.getCenterLonLat(), a = this.center.lon - o.lon, o = o.lat - this.center.lat, l = Math.round(r.getWidth() / e), h = Math.round(r.getHeight() / e);
                this.minPx = {
                    x: (this.size.w - l) / 2 - a / e,
                    y: (this.size.h - h) / 2 - o / e
                }, this.maxPx = {
                    x: this.minPx.x + Math.round(r.getWidth() / e),
                    y: this.minPx.y + Math.round(r.getHeight() / e)
                }
            }
            for (s && (this.zoom = t, this.resolution = e), e = this.getExtent(), this.baseLayer.visibility && (this.baseLayer.moveTo(e, s, i.dragging), i.dragging || this.baseLayer.events.triggerEvent("moveend", {zoomChanged: s})), e = this.baseLayer.getExtent(), t = this.layers.length - 1; t >= 0; --t)r = this.layers[t], r !== this.baseLayer && !r.isBaseLayer && (a = r.calculateInRange(), r.inRange != a && ((r.inRange = a) || r.display(!1), this.events.triggerEvent("changelayer", {
                layer: r,
                property: "visibility"
            })), a && r.visibility) && (r.moveTo(e, s, i.dragging), i.dragging || r.events.triggerEvent("moveend", {zoomChanged: s}));
            if (this.events.triggerEvent("move"), n || this.events.triggerEvent("moveend"), s) {
                for (t = 0, i = this.popups.length; i > t; t++)this.popups[t].updatePosition();
                this.events.triggerEvent("zoomend")
            }
        }
    },
    centerLayerContainer: function (e) {
        var t = this.getViewPortPxFromLonLat(this.layerContainerOrigin), i = this.getViewPortPxFromLonLat(e);
        if (null != t && null != i) {
            var n = parseInt(this.layerContainerDiv.style.left), e = parseInt(this.layerContainerDiv.style.top), s = Math.round(t.x - i.x), t = Math.round(t.y - i.y);
            this.layerContainerDiv.style.left = s + "px", this.layerContainerDiv.style.top = t + "px", n -= s, e -= t, this.minPx.x -= n, this.maxPx.x -= n, this.minPx.y -= e, this.maxPx.y -= e
        }
    },
    isValidZoomLevel: function (e) {
        return null != e && e >= 0 && e < this.getNumZoomLevels()
    },
    isValidLonLat: function (e) {
        var t = !1;
        return null != e && (t = this.getMaxExtent(), t = t.containsLonLat(e, {worldBounds: this.baseLayer.wrapDateLine && t})), t
    },
    getProjection: function () {
        var e = this.getProjectionObject();
        return e ? e.getCode() : null
    },
    getProjectionObject: function () {
        var e = null;
        return null != this.baseLayer && (e = this.baseLayer.projection), e
    },
    getMaxResolution: function () {
        var e = null;
        return null != this.baseLayer && (e = this.baseLayer.maxResolution), e
    },
    getMaxExtent: function (e) {
        var t = null;
        return e && e.restricted && this.restrictedExtent ? t = this.restrictedExtent : null != this.baseLayer && (t = this.baseLayer.maxExtent), t
    },
    getNumZoomLevels: function () {
        var e = null;
        return null != this.baseLayer && (e = this.baseLayer.numZoomLevels), e
    },
    getExtent: function () {
        var e = null;
        return null != this.baseLayer && (e = this.baseLayer.getExtent()), e
    },
    getResolution: function () {
        var e = null;
        return null != this.baseLayer ? e = this.baseLayer.getResolution() : !0 === this.allOverlays && 0 < this.layers.length && (e = this.layers[0].getResolution()), e
    },
    getUnits: function () {
        var e = null;
        return null != this.baseLayer && (e = this.baseLayer.units), e
    },
    getScale: function () {
        var e = null;
        return null != this.baseLayer && (e = this.getResolution(), e = OpenLayers.Util.getScaleFromResolution(e, this.baseLayer.units)), e
    },
    getZoomForExtent: function (e, t) {
        var i = null;
        return null != this.baseLayer && (i = this.baseLayer.getZoomForExtent(e, t)), i
    },
    getResolutionForZoom: function (e) {
        var t = null;
        return this.baseLayer && (t = this.baseLayer.getResolutionForZoom(e)), t
    },
    getZoomForResolution: function (e, t) {
        var i = null;
        return null != this.baseLayer && (i = this.baseLayer.getZoomForResolution(e, t)), i
    },
    zoomTo: function (e) {
        this.isValidZoomLevel(e) && this.setCenter(null, e)
    },
    zoomIn: function () {
        this.zoomTo(this.getZoom() + 1)
    },
    zoomOut: function () {
        this.zoomTo(this.getZoom() - 1)
    },
    zoomToExtent: function (e, t) {
        e instanceof OpenLayers.Bounds || (e = new OpenLayers.Bounds(e));
        var i = e.getCenterLonLat();
        if (this.baseLayer.wrapDateLine) {
            for (i = this.getMaxExtent(), e = e.clone(); e.right < e.left;)e.right += i.getWidth();
            i = e.getCenterLonLat().wrapDateLine(i)
        }
        this.setCenter(i, this.getZoomForExtent(e, t))
    },
    zoomToMaxExtent: function (e) {
        this.zoomToExtent(this.getMaxExtent({restricted: e ? e.restricted : !0}))
    },
    zoomToScale: function (e, t) {
        var i = OpenLayers.Util.getResolutionFromScale(e, this.baseLayer.units), n = this.size.w * i / 2, i = this.size.h * i / 2, s = this.getCachedCenter();
        this.zoomToExtent(new OpenLayers.Bounds(s.lon - n, s.lat - i, s.lon + n, s.lat + i), t)
    },
    getLonLatFromViewPortPx: function (e) {
        var t = null;
        return null != this.baseLayer && (t = this.baseLayer.getLonLatFromViewPortPx(e)), t
    },
    getViewPortPxFromLonLat: function (e) {
        var t = null;
        return null != this.baseLayer && (t = this.baseLayer.getViewPortPxFromLonLat(e)), t
    },
    getLonLatFromPixel: function (e) {
        return this.getLonLatFromViewPortPx(e)
    },
    getPixelFromLonLat: function (e) {
        return e = this.getViewPortPxFromLonLat(e), e.x = Math.round(e.x), e.y = Math.round(e.y), e
    },
    getGeodesicPixelSize: function (e) {
        var t = e ? this.getLonLatFromPixel(e) : this.getCachedCenter() || new OpenLayers.LonLat(0, 0), i = this.getResolution(), e = t.add(-i / 2, 0), n = t.add(i / 2, 0), s = t.add(0, -i / 2), t = t.add(0, i / 2), i = new OpenLayers.Projection("EPSG:4326"), r = this.getProjectionObject() || i;
        return r.equals(i) || (e.transform(r, i), n.transform(r, i), s.transform(r, i), t.transform(r, i)), new OpenLayers.Size(OpenLayers.Util.distVincenty(e, n), OpenLayers.Util.distVincenty(s, t))
    },
    getViewPortPxFromLayerPx: function (e) {
        var t = null;
        if (null != e)var t = parseInt(this.layerContainerDiv.style.left), i = parseInt(this.layerContainerDiv.style.top), t = e.add(t, i);
        return t
    },
    getLayerPxFromViewPortPx: function (e) {
        var t = null;
        if (null != e) {
            var t = -parseInt(this.layerContainerDiv.style.left), i = -parseInt(this.layerContainerDiv.style.top), t = e.add(t, i);
            (isNaN(t.x) || isNaN(t.y)) && (t = null)
        }
        return t
    },
    getLonLatFromLayerPx: function (e) {
        return e = this.getViewPortPxFromLayerPx(e), this.getLonLatFromViewPortPx(e)
    },
    getLayerPxFromLonLat: function (e) {
        return this.getLayerPxFromViewPortPx(this.getPixelFromLonLat(e))
    },
    CLASS_NAME: "OpenLayers.Map"
}),OpenLayers.Map.TILE_WIDTH = 256,OpenLayers.Map.TILE_HEIGHT = 256,OpenLayers.Layer = OpenLayers.Class({
    id: null,
    name: null,
    div: null,
    opacity: 1,
    alwaysInRange: null,
    RESOLUTION_PROPERTIES: "scales resolutions maxScale minScale maxResolution minResolution numZoomLevels maxZoomLevel".split(" "),
    events: null,
    map: null,
    isBaseLayer: !1,
    alpha: !1,
    displayInLayerSwitcher: !0,
    visibility: !0,
    attribution: null,
    inRange: !1,
    imageSize: null,
    options: null,
    eventListeners: null,
    gutter: 0,
    projection: null,
    units: null,
    scales: null,
    resolutions: null,
    maxExtent: null,
    minExtent: null,
    maxResolution: null,
    minResolution: null,
    numZoomLevels: null,
    minScale: null,
    maxScale: null,
    displayOutsideMaxExtent: !1,
    wrapDateLine: !1,
    metadata: null,
    initialize: function (e, t) {
        this.metadata = {}, this.addOptions(t), this.name = e, null == this.id && (this.id = OpenLayers.Util.createUniqueID(this.CLASS_NAME + "_"), this.div = OpenLayers.Util.createDiv(this.id), this.div.style.width = "100%", this.div.style.height = "100%", this.div.dir = "ltr", this.events = new OpenLayers.Events(this, this.div), this.eventListeners instanceof Object) && this.events.on(this.eventListeners)
    },
    destroy: function (e) {
        null == e && (e = !0), null != this.map && this.map.removeLayer(this, e), this.options = this.div = this.name = this.map = this.projection = null, this.events && (this.eventListeners && this.events.un(this.eventListeners), this.events.destroy()), this.events = this.eventListeners = null
    },
    clone: function (e) {
        return null == e && (e = new OpenLayers.Layer(this.name, this.getOptions())), OpenLayers.Util.applyDefaults(e, this), e.map = null, e
    },
    getOptions: function () {
        var e, t = {};
        for (e in this.options)t[e] = this[e];
        return t
    },
    setName: function (e) {
        e != this.name && (this.name = e, null != this.map && this.map.events.triggerEvent("changelayer", {
            layer: this,
            property: "name"
        }))
    },
    addOptions: function (e, t) {
        if (null == this.options && (this.options = {}), !e || ("string" == typeof e.projection && (e.projection = new OpenLayers.Projection(e.projection)), e.projection && OpenLayers.Util.applyDefaults(e, OpenLayers.Projection.defaults[e.projection.getCode()]), e.maxExtent && !(e.maxExtent instanceof OpenLayers.Bounds) && (e.maxExtent = new OpenLayers.Bounds(e.maxExtent)), !e.minExtent || e.minExtent instanceof OpenLayers.Bounds) || (e.minExtent = new OpenLayers.Bounds(e.minExtent)), OpenLayers.Util.extend(this.options, e), OpenLayers.Util.extend(this, e), this.projection && this.projection.getUnits() && (this.units = this.projection.getUnits()), this.map) {
            var i, n = this.map.getResolution(), s = this.RESOLUTION_PROPERTIES.concat(["projection", "units", "minExtent", "maxExtent"]);
            for (i in e)if (e.hasOwnProperty(i) && 0 <= OpenLayers.Util.indexOf(s, i)) {
                this.initResolutions(), t && this.map.baseLayer === this && (this.map.setCenter(this.map.getCenter(), this.map.getZoomForResolution(n), !1, !0), this.map.events.triggerEvent("changebaselayer", {layer: this}));
                break
            }
        }
    },
    onMapResize: function () {
    },
    redraw: function () {
        var e = !1;
        if (this.map) {
            this.inRange = this.calculateInRange();
            var t = this.getExtent();
            t && this.inRange && this.visibility && (this.moveTo(t, !0, !1), this.events.triggerEvent("moveend", {zoomChanged: !0}), e = !0)
        }
        return e
    },
    moveTo: function () {
        var e = this.visibility;
        this.isBaseLayer || (e = e && this.inRange), this.display(e)
    },
    moveByPx: function () {
    },
    setMap: function (e) {
        null == this.map && (this.map = e, this.maxExtent = this.maxExtent || this.map.maxExtent, this.minExtent = this.minExtent || this.map.minExtent, this.projection = this.projection || this.map.projection, "string" == typeof this.projection && (this.projection = new OpenLayers.Projection(this.projection)), this.units = this.projection.getUnits() || this.units || this.map.units, this.initResolutions(), this.isBaseLayer || (this.inRange = this.calculateInRange(), this.div.style.display = this.visibility && this.inRange ? "" : "none"), this.setTileSize())
    },
    afterAdd: function () {
    },
    removeMap: function () {
    },
    getImageSize: function () {
        return this.imageSize || this.tileSize
    },
    setTileSize: function (e) {
        this.tileSize = e = e ? e : this.tileSize ? this.tileSize : this.map.getTileSize(), this.gutter && (this.imageSize = new OpenLayers.Size(e.w + 2 * this.gutter, e.h + 2 * this.gutter))
    },
    getVisibility: function () {
        return this.visibility
    },
    setVisibility: function (e) {
        e != this.visibility && (this.visibility = e, this.display(e), this.redraw(), null != this.map && this.map.events.triggerEvent("changelayer", {
            layer: this,
            property: "visibility"
        }), this.events.triggerEvent("visibilitychanged"))
    },
    display: function (e) {
        e != ("none" != this.div.style.display) && (this.div.style.display = e && this.calculateInRange() ? "block" : "none")
    },
    calculateInRange: function () {
        var e = !1;
        return this.alwaysInRange ? e = !0 : this.map && (e = this.map.getResolution(), e = e >= this.minResolution && e <= this.maxResolution), e
    },
    setIsBaseLayer: function (e) {
        e != this.isBaseLayer && (this.isBaseLayer = e, null != this.map && this.map.events.triggerEvent("changebaselayer", {layer: this}))
    },
    initResolutions: function () {
        var e, t, i, n = {}, s = !0;
        for (e = 0, t = this.RESOLUTION_PROPERTIES.length; t > e; e++)i = this.RESOLUTION_PROPERTIES[e], n[i] = this.options[i], s && this.options[i] && (s = !1);
        if (null == this.alwaysInRange && (this.alwaysInRange = s), null == n.resolutions && (n.resolutions = this.resolutionsFromScales(n.scales)), null == n.resolutions && (n.resolutions = this.calculateResolutions(n)), null == n.resolutions) {
            for (e = 0, t = this.RESOLUTION_PROPERTIES.length; t > e; e++)i = this.RESOLUTION_PROPERTIES[e], n[i] = null != this.options[i] ? this.options[i] : this.map[i];
            null == n.resolutions && (n.resolutions = this.resolutionsFromScales(n.scales)), null == n.resolutions && (n.resolutions = this.calculateResolutions(n))
        }
        var r;
        this.options.maxResolution && "auto" !== this.options.maxResolution && (r = this.options.maxResolution), this.options.minScale && (r = OpenLayers.Util.getResolutionFromScale(this.options.minScale, this.units));
        var a;
        if (this.options.minResolution && "auto" !== this.options.minResolution && (a = this.options.minResolution), this.options.maxScale && (a = OpenLayers.Util.getResolutionFromScale(this.options.maxScale, this.units)), n.resolutions && (n.resolutions.sort(function (e, t) {
                return t - e
            }), r || (r = n.resolutions[0]), a || (a = n.resolutions[n.resolutions.length - 1])), this.resolutions = n.resolutions) {
            for (t = this.resolutions.length, this.scales = Array(t), e = 0; t > e; e++)this.scales[e] = OpenLayers.Util.getScaleFromResolution(this.resolutions[e], this.units);
            this.numZoomLevels = t
        }
        (this.minResolution = a) && (this.maxScale = OpenLayers.Util.getScaleFromResolution(a, this.units)), (this.maxResolution = r) && (this.minScale = OpenLayers.Util.getScaleFromResolution(r, this.units))
    },
    resolutionsFromScales: function (e) {
        if (null != e) {
            var t, i, n;
            for (n = e.length, t = Array(n), i = 0; n > i; i++)t[i] = OpenLayers.Util.getResolutionFromScale(e[i], this.units);
            return t
        }
    },
    calculateResolutions: function (e) {
        var t, i, n = e.maxResolution;
        if (null != e.minScale ? n = OpenLayers.Util.getResolutionFromScale(e.minScale, this.units) : "auto" == n && null != this.maxExtent && (t = this.map.getSize(), i = this.maxExtent.getWidth() / t.w, t = this.maxExtent.getHeight() / t.h, n = Math.max(i, t)), i = e.minResolution, null != e.maxScale ? i = OpenLayers.Util.getResolutionFromScale(e.maxScale, this.units) : "auto" == e.minResolution && null != this.minExtent && (t = this.map.getSize(), i = this.minExtent.getWidth() / t.w, t = this.minExtent.getHeight() / t.h, i = Math.max(i, t)), "number" != typeof n && "number" != typeof i && null != this.maxExtent && (n = this.map.getTileSize(), n = Math.max(this.maxExtent.getWidth() / n.w, this.maxExtent.getHeight() / n.h)), t = e.maxZoomLevel, e = e.numZoomLevels, "number" == typeof i && "number" == typeof n && void 0 === e ? e = Math.floor(Math.log(n / i) / Math.log(2)) + 1 : void 0 === e && null != t && (e = t + 1), !("number" != typeof e || 0 >= e || "number" != typeof n && "number" != typeof i)) {
            t = Array(e);
            var s = 2;
            "number" == typeof i && "number" == typeof n && (s = Math.pow(n / i, 1 / (e - 1)));
            var r;
            if ("number" == typeof n)for (r = 0; e > r; r++)t[r] = n / Math.pow(s, r); else for (r = 0; e > r; r++)t[e - 1 - r] = i * Math.pow(s, r);
            return t
        }
    },
    getResolution: function () {
        return this.getResolutionForZoom(this.map.getZoom())
    },
    getExtent: function () {
        return this.map.calculateBounds()
    },
    getZoomForExtent: function (e, t) {
        var i = this.map.getSize();
        return this.getZoomForResolution(Math.max(e.getWidth() / i.w, e.getHeight() / i.h), t)
    },
    getDataExtent: function () {
    },
    getResolutionForZoom: function (e) {
        if (e = Math.max(0, Math.min(e, this.resolutions.length - 1)), this.map.fractionalZoom)var t = Math.floor(e), i = Math.ceil(e), e = this.resolutions[t] - (e - t) * (this.resolutions[t] - this.resolutions[i]); else e = this.resolutions[Math.round(e)];
        return e
    },
    getZoomForResolution: function (e, t) {
        var i, n;
        if (this.map.fractionalZoom) {
            var s, r = 0, a = this.resolutions[r], o = this.resolutions[this.resolutions.length - 1];
            for (i = 0, n = this.resolutions.length; n > i; ++i)if (s = this.resolutions[i], s >= e && (a = s, r = i), e >= s) {
                o = s;
                break
            }
            i = a - o, i = i > 0 ? r + (a - e) / i : r
        } else {
            for (a = Number.POSITIVE_INFINITY, i = 0, n = this.resolutions.length; n > i; i++)if (t) {
                if (r = Math.abs(this.resolutions[i] - e), r > a)break;
                a = r
            } else if (this.resolutions[i] < e)break;
            i = Math.max(0, i - 1)
        }
        return i
    },
    getLonLatFromViewPortPx: function (e) {
        var t = null, i = this.map;
        if (null != e && i.minPx) {
            var t = i.getResolution(), n = i.getMaxExtent({restricted: !0}), t = new OpenLayers.LonLat((e.x - i.minPx.x) * t + n.left, (i.minPx.y - e.y) * t + n.top);
            this.wrapDateLine && (t = t.wrapDateLine(this.maxExtent))
        }
        return t
    },
    getViewPortPxFromLonLat: function (e, t) {
        var i = null;
        return null != e && (t = t || this.map.getResolution(), i = this.map.calculateBounds(null, t), i = new OpenLayers.Pixel(1 / t * (e.lon - i.left), 1 / t * (i.top - e.lat))), i
    },
    setOpacity: function (e) {
        if (e != this.opacity) {
            this.opacity = e;
            for (var t = this.div.childNodes, i = 0, n = t.length; n > i; ++i) {
                var s = t[i].firstChild || t[i], r = t[i].lastChild;
                r && "iframe" === r.nodeName.toLowerCase() && (s = r.parentNode), OpenLayers.Util.modifyDOMElement(s, null, null, null, null, null, null, e)
            }
            null != this.map && this.map.events.triggerEvent("changelayer", {layer: this, property: "opacity"})
        }
    },
    getZIndex: function () {
        return this.div.style.zIndex
    },
    setZIndex: function (e) {
        this.div.style.zIndex = e
    },
    adjustBounds: function (e) {
        if (this.gutter)var t = this.gutter * this.map.getResolution(), e = new OpenLayers.Bounds(e.left - t, e.bottom - t, e.right + t, e.top + t);
        return this.wrapDateLine && (t = {
            rightTolerance: this.getResolution(),
            leftTolerance: this.getResolution()
        }, e = e.wrapDateLine(this.maxExtent, t)), e
    },
    CLASS_NAME: "OpenLayers.Layer"
}),OpenLayers.Layer.SphericalMercator = {
    getExtent: function () {
        var e = null;
        return e = this.sphericalMercator ? this.map.calculateBounds() : OpenLayers.Layer.FixedZoomLevels.prototype.getExtent.apply(this)
    }, getLonLatFromViewPortPx: function () {
        return OpenLayers.Layer.prototype.getLonLatFromViewPortPx.apply(this, arguments)
    }, getViewPortPxFromLonLat: function () {
        return OpenLayers.Layer.prototype.getViewPortPxFromLonLat.apply(this, arguments)
    }, initMercatorParameters: function () {
        this.RESOLUTIONS = [];
        for (var e = 0; e <= this.MAX_ZOOM_LEVEL; ++e)this.RESOLUTIONS[e] = 156543.03390625 / Math.pow(2, e);
        this.units = "m", this.projection = this.projection || "EPSG:900913"
    }, forwardMercator: function () {
        var e = new OpenLayers.Projection("EPSG:4326"), t = new OpenLayers.Projection("EPSG:900913");
        return function (i, n) {
            var s = OpenLayers.Projection.transform({x: i, y: n}, e, t);
            return new OpenLayers.LonLat(s.x, s.y)
        }
    }(), inverseMercator: function () {
        var e = new OpenLayers.Projection("EPSG:4326"), t = new OpenLayers.Projection("EPSG:900913");
        return function (i, n) {
            var s = OpenLayers.Projection.transform({x: i, y: n}, t, e);
            return new OpenLayers.LonLat(s.x, s.y)
        }
    }()
},OpenLayers.Layer.EventPane = OpenLayers.Class(OpenLayers.Layer, {
    smoothDragPan: !0,
    isBaseLayer: !0,
    isFixed: !0,
    pane: null,
    mapObject: null,
    initialize: function () {
        OpenLayers.Layer.prototype.initialize.apply(this, arguments), null == this.pane && (this.pane = OpenLayers.Util.createDiv(this.div.id + "_EventPane"))
    },
    destroy: function () {
        this.pane = this.mapObject = null, OpenLayers.Layer.prototype.destroy.apply(this, arguments)
    },
    setMap: function () {
        OpenLayers.Layer.prototype.setMap.apply(this, arguments), this.pane.style.zIndex = parseInt(this.div.style.zIndex) + 1, this.pane.style.display = this.div.style.display, this.pane.style.width = "100%", this.pane.style.height = "100%", "msie" == OpenLayers.BROWSER_NAME && (this.pane.style.background = "url(" + OpenLayers.Util.getImageLocation("blank.gif") + ")"), this.isFixed ? this.map.viewPortDiv.appendChild(this.pane) : this.map.layerContainerDiv.appendChild(this.pane), this.loadMapObject(), null == this.mapObject && this.loadWarningMessage()
    },
    removeMap: function () {
        this.pane && this.pane.parentNode && this.pane.parentNode.removeChild(this.pane), OpenLayers.Layer.prototype.removeMap.apply(this, arguments)
    },
    loadWarningMessage: function () {
        this.div.style.backgroundColor = "darkblue";
        var e = this.map.getSize(), t = Math.min(e.w, 300), i = Math.min(e.h, 200), t = new OpenLayers.Size(t, i), e = new OpenLayers.Pixel(e.w / 2, e.h / 2).add(-t.w / 2, -t.h / 2), e = OpenLayers.Util.createDiv(this.name + "_warning", e, t, null, null, null, "auto");
        e.style.padding = "7px", e.style.backgroundColor = "yellow", e.innerHTML = this.getWarningHTML(), this.div.appendChild(e)
    },
    getWarningHTML: function () {
        return ""
    },
    display: function () {
        OpenLayers.Layer.prototype.display.apply(this, arguments), this.pane.style.display = this.div.style.display
    },
    setZIndex: function () {
        OpenLayers.Layer.prototype.setZIndex.apply(this, arguments), this.pane.style.zIndex = parseInt(this.div.style.zIndex) + 1
    },
    moveByPx: function (e, t) {
        OpenLayers.Layer.prototype.moveByPx.apply(this, arguments), this.dragPanMapObject ? this.dragPanMapObject(e, -t) : this.moveTo(this.map.getCachedCenter())
    },
    moveTo: function (e, t, i) {
        if (OpenLayers.Layer.prototype.moveTo.apply(this, arguments), null != this.mapObject) {
            var n = this.map.getCenter(), s = this.map.getZoom();
            if (null != n) {
                var r = this.getOLLonLatFromMapObjectLonLat(this.getMapObjectCenter()), a = this.getOLZoomFromMapObjectZoom(this.getMapObjectZoom());
                n.equals(r) && s == a || (!t && r && this.dragPanMapObject && this.smoothDragPan ? (s = this.map.getViewPortPxFromLonLat(r), n = this.map.getViewPortPxFromLonLat(n), this.dragPanMapObject(n.x - s.x, s.y - n.y)) : (n = this.getMapObjectLonLatFromOLLonLat(n), s = this.getMapObjectZoomFromOLZoom(s), this.setMapObjectCenter(n, s, i)))
            }
        }
    },
    getLonLatFromViewPortPx: function (e) {
        var t = null;
        return null != this.mapObject && null != this.getMapObjectCenter() && (t = this.getOLLonLatFromMapObjectLonLat(this.getMapObjectLonLatFromMapObjectPixel(this.getMapObjectPixelFromOLPixel(e)))), t
    },
    getViewPortPxFromLonLat: function (e) {
        var t = null;
        return null != this.mapObject && null != this.getMapObjectCenter() && (t = this.getOLPixelFromMapObjectPixel(this.getMapObjectPixelFromMapObjectLonLat(this.getMapObjectLonLatFromOLLonLat(e)))), t
    },
    getOLLonLatFromMapObjectLonLat: function (e) {
        var t = null;
        return null != e && (t = this.getLongitudeFromMapObjectLonLat(e), e = this.getLatitudeFromMapObjectLonLat(e), t = new OpenLayers.LonLat(t, e)), t
    },
    getMapObjectLonLatFromOLLonLat: function (e) {
        var t = null;
        return null != e && (t = this.getMapObjectLonLatFromLonLat(e.lon, e.lat)), t
    },
    getOLPixelFromMapObjectPixel: function (e) {
        var t = null;
        return null != e && (t = this.getXFromMapObjectPixel(e), e = this.getYFromMapObjectPixel(e), t = new OpenLayers.Pixel(t, e)), t
    },
    getMapObjectPixelFromOLPixel: function (e) {
        var t = null;
        return null != e && (t = this.getMapObjectPixelFromXY(e.x, e.y)), t
    },
    CLASS_NAME: "OpenLayers.Layer.EventPane"
}),OpenLayers.Layer.FixedZoomLevels = OpenLayers.Class({
    initialize: function () {
    }, initResolutions: function () {
        for (var e = ["minZoomLevel", "maxZoomLevel", "numZoomLevels"], t = 0, i = e.length; i > t; t++) {
            var n = e[t];
            this[n] = null != this.options[n] ? this.options[n] : this.map[n]
        }
        if ((null == this.minZoomLevel || this.minZoomLevel < this.MIN_ZOOM_LEVEL) && (this.minZoomLevel = this.MIN_ZOOM_LEVEL), e = this.MAX_ZOOM_LEVEL - this.minZoomLevel + 1, t = null == this.options.numZoomLevels && null != this.options.maxZoomLevel || null == this.numZoomLevels && null != this.maxZoomLevel ? this.maxZoomLevel - this.minZoomLevel + 1 : this.numZoomLevels, this.numZoomLevels = null != t ? Math.min(t, e) : e, this.maxZoomLevel = this.minZoomLevel + this.numZoomLevels - 1, null != this.RESOLUTIONS) {
            for (e = 0, this.resolutions = [], t = this.minZoomLevel; t <= this.maxZoomLevel; t++)this.resolutions[e++] = this.RESOLUTIONS[t];
            this.maxResolution = this.resolutions[0], this.minResolution = this.resolutions[this.resolutions.length - 1]
        }
    }, getResolution: function () {
        if (null != this.resolutions)return OpenLayers.Layer.prototype.getResolution.apply(this, arguments);
        var e = null, t = this.map.getSize(), i = this.getExtent();
        return null != t && null != i && (e = Math.max(i.getWidth() / t.w, i.getHeight() / t.h)), e
    }, getExtent: function () {
        var e = this.map.getSize(), t = this.getLonLatFromViewPortPx({
            x: 0,
            y: 0
        }), e = this.getLonLatFromViewPortPx({x: e.w, y: e.h});
        return null != t && null != e ? new OpenLayers.Bounds(t.lon, e.lat, e.lon, t.lat) : null
    }, getZoomForResolution: function () {
        return null != this.resolutions ? OpenLayers.Layer.prototype.getZoomForResolution.apply(this, arguments) : this.getZoomForExtent(OpenLayers.Layer.prototype.getExtent.apply(this, []))
    }, getOLZoomFromMapObjectZoom: function (e) {
        var t = null;
        return null != e && (t = e - this.minZoomLevel, this.map.baseLayer !== this && (t = this.map.baseLayer.getZoomForResolution(this.getResolutionForZoom(t)))), t
    }, getMapObjectZoomFromOLZoom: function (e) {
        var t = null;
        return null != e && (t = e + this.minZoomLevel, this.map.baseLayer !== this && (t = this.getZoomForResolution(this.map.baseLayer.getResolutionForZoom(t)))), t
    }, CLASS_NAME: "OpenLayers.Layer.FixedZoomLevels"
}),OpenLayers.Layer.Google = OpenLayers.Class(OpenLayers.Layer.EventPane, OpenLayers.Layer.FixedZoomLevels, {
    MIN_ZOOM_LEVEL: 0,
    MAX_ZOOM_LEVEL: 21,
    RESOLUTIONS: [1.40625, .703125, .3515625, .17578125, .087890625, .0439453125, .02197265625, .010986328125, .0054931640625, .00274658203125, .001373291015625, .0006866455078125, .00034332275390625, .000171661376953125, 858306884765625e-19, 4291534423828125e-20, 2145767211914062e-20, 1072883605957031e-20, 536441802978515e-20, 268220901489257e-20, 1341104507446289e-21, 6.705522537231445e-7],
    type: null,
    wrapDateLine: !0,
    sphericalMercator: !1,
    version: null,
    initialize: function (e, t) {
        t = t || {}, t.version || (t.version = "function" == typeof GMap2 ? "2" : "3");
        var i = OpenLayers.Layer.Google["v" + t.version.replace(/\./g, "_")];
        if (!i)throw"Unsupported Google Maps API version: " + t.version;
        OpenLayers.Util.applyDefaults(t, i), OpenLayers.Util.applyDefaults(t, i.DEFAULTS), t.maxExtent && (t.maxExtent = t.maxExtent.clone()), OpenLayers.Layer.EventPane.prototype.initialize.apply(this, [e, t]), OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this, [e, t]), this.sphericalMercator && (OpenLayers.Util.extend(this, OpenLayers.Layer.SphericalMercator), this.initMercatorParameters())
    },
    clone: function () {
        return new OpenLayers.Layer.Google(this.name, this.getOptions())
    },
    setVisibility: function () {
        var e = null == this.opacity ? 1 : this.opacity;
        OpenLayers.Layer.EventPane.prototype.setVisibility.apply(this, arguments), this.setOpacity(e)
    },
    display: function (e) {
        this._dragging || this.setGMapVisibility(e), OpenLayers.Layer.EventPane.prototype.display.apply(this, arguments)
    },
    moveTo: function (e, t, i) {
        this._dragging = i, OpenLayers.Layer.EventPane.prototype.moveTo.apply(this, arguments), delete this._dragging
    },
    setOpacity: function (e) {
        if (e !== this.opacity && (null != this.map && this.map.events.triggerEvent("changelayer", {
                layer: this,
                property: "opacity"
            }), this.opacity = e), this.getVisibility()) {
            var t = this.getMapContainer();
            OpenLayers.Util.modifyDOMElement(t, null, null, null, null, null, null, e)
        }
    },
    destroy: function () {
        if (this.map) {
            this.setGMapVisibility(!1);
            var e = OpenLayers.Layer.Google.cache[this.map.id];
            e && 1 >= e.count && this.removeGMapElements()
        }
        OpenLayers.Layer.EventPane.prototype.destroy.apply(this, arguments)
    },
    removeGMapElements: function () {
        var e = OpenLayers.Layer.Google.cache[this.map.id];
        if (e) {
            var t = this.mapObject && this.getMapContainer();
            t && t.parentNode && t.parentNode.removeChild(t), (t = e.termsOfUse) && t.parentNode && t.parentNode.removeChild(t), (e = e.poweredBy) && e.parentNode && e.parentNode.removeChild(e)
        }
    },
    removeMap: function (e) {
        this.visibility && this.mapObject && this.setGMapVisibility(!1);
        var t = OpenLayers.Layer.Google.cache[e.id];
        t && (1 >= t.count ? (this.removeGMapElements(), delete OpenLayers.Layer.Google.cache[e.id]) : --t.count), delete this.termsOfUse, delete this.poweredBy, delete this.mapObject, delete this.dragObject, OpenLayers.Layer.EventPane.prototype.removeMap.apply(this, arguments)
    },
    getOLBoundsFromMapObjectBounds: function (e) {
        var t = null;
        return null != e && (t = e.getSouthWest(), e = e.getNorthEast(), this.sphericalMercator ? (t = this.forwardMercator(t.lng(), t.lat()), e = this.forwardMercator(e.lng(), e.lat())) : (t = new OpenLayers.LonLat(t.lng(), t.lat()), e = new OpenLayers.LonLat(e.lng(), e.lat())), t = new OpenLayers.Bounds(t.lon, t.lat, e.lon, e.lat)), t
    },
    getWarningHTML: function () {
        return OpenLayers.i18n("googleWarning")
    },
    getMapObjectCenter: function () {
        return this.mapObject.getCenter()
    },
    getMapObjectZoom: function () {
        return this.mapObject.getZoom()
    },
    getLongitudeFromMapObjectLonLat: function (e) {
        return this.sphericalMercator ? this.forwardMercator(e.lng(), e.lat()).lon : e.lng()
    },
    getLatitudeFromMapObjectLonLat: function (e) {
        return this.sphericalMercator ? this.forwardMercator(e.lng(), e.lat()).lat : e.lat()
    },
    getXFromMapObjectPixel: function (e) {
        return e.x
    },
    getYFromMapObjectPixel: function (e) {
        return e.y
    },
    CLASS_NAME: "OpenLayers.Layer.Google"
}),OpenLayers.Layer.Google.cache = {},OpenLayers.Layer.Google.v2 = {
    termsOfUse: null, poweredBy: null, dragObject: null, loadMapObject: function () {
        this.type || (this.type = G_NORMAL_MAP);
        var e, t, i, n = OpenLayers.Layer.Google.cache[this.map.id];
        if (n) e = n.mapObject, t = n.termsOfUse, i = n.poweredBy, ++n.count; else {
            var n = this.map.viewPortDiv, s = document.createElement("div");
            s.id = this.map.id + "_GMap2Container", s.style.position = "absolute", s.style.width = "100%", s.style.height = "100%", n.appendChild(s);
            try {
                e = new GMap2(s), t = s.lastChild, n.appendChild(t), t.style.zIndex = "1100", t.style.right = "", t.style.bottom = "", t.className = "olLayerGoogleCopyright", i = s.lastChild, n.appendChild(i), i.style.zIndex = "1100", i.style.right = "", i.style.bottom = "", i.className = "olLayerGooglePoweredBy gmnoprint"
            } catch (r) {
                throw r
            }
            OpenLayers.Layer.Google.cache[this.map.id] = {mapObject: e, termsOfUse: t, poweredBy: i, count: 1}
        }
        this.mapObject = e, this.termsOfUse = t, this.poweredBy = i, -1 === OpenLayers.Util.indexOf(this.mapObject.getMapTypes(), this.type) && this.mapObject.addMapType(this.type), "function" == typeof e.getDragObject ? this.dragObject = e.getDragObject() : this.dragPanMapObject = null, !1 === this.isBaseLayer && this.setGMapVisibility("none" !== this.div.style.display)
    }, onMapResize: function () {
        if (this.visibility && this.mapObject.isLoaded()) this.mapObject.checkResize(); else {
            if (!this._resized)var e = this, t = GEvent.addListener(this.mapObject, "load", function () {
                GEvent.removeListener(t), delete e._resized, e.mapObject.checkResize(), e.moveTo(e.map.getCenter(), e.map.getZoom())
            });
            this._resized = !0
        }
    }, setGMapVisibility: function (e) {
        var t = OpenLayers.Layer.Google.cache[this.map.id];
        if (t) {
            var i = this.mapObject.getContainer();
            !0 === e ? (this.mapObject.setMapType(this.type), i.style.display = "", this.termsOfUse.style.left = "", this.termsOfUse.style.display = "", this.poweredBy.style.display = "", t.displayed = this.id) : (t.displayed === this.id && delete t.displayed, t.displayed || (i.style.display = "none", this.termsOfUse.style.display = "none", this.termsOfUse.style.left = "-9999px", this.poweredBy.style.display = "none"))
        }
    }, getMapContainer: function () {
        return this.mapObject.getContainer()
    }, getMapObjectBoundsFromOLBounds: function (e) {
        var t = null;
        return null != e && (t = this.sphericalMercator ? this.inverseMercator(e.bottom, e.left) : new OpenLayers.LonLat(e.bottom, e.left), e = this.sphericalMercator ? this.inverseMercator(e.top, e.right) : new OpenLayers.LonLat(e.top, e.right), t = new GLatLngBounds(new GLatLng(t.lat, t.lon), new GLatLng(e.lat, e.lon))), t
    }, setMapObjectCenter: function (e, t) {
        this.mapObject.setCenter(e, t)
    }, dragPanMapObject: function (e, t) {
        this.dragObject.moveBy(new GSize(-e, t))
    }, getMapObjectLonLatFromMapObjectPixel: function (e) {
        return this.mapObject.fromContainerPixelToLatLng(e)
    }, getMapObjectPixelFromMapObjectLonLat: function (e) {
        return this.mapObject.fromLatLngToContainerPixel(e)
    }, getMapObjectZoomFromMapObjectBounds: function (e) {
        return this.mapObject.getBoundsZoomLevel(e)
    }, getMapObjectLonLatFromLonLat: function (e, t) {
        var i;
        return this.sphericalMercator ? (i = this.inverseMercator(e, t), i = new GLatLng(i.lat, i.lon)) : i = new GLatLng(t, e), i
    }, getMapObjectPixelFromXY: function (e, t) {
        return new GPoint(e, t)
    }
},OpenLayers.Format.XML = OpenLayers.Class(OpenLayers.Format, {
    namespaces: null,
    namespaceAlias: null,
    defaultPrefix: null,
    readers: {},
    writers: {},
    xmldom: null,
    initialize: function (e) {
        window.ActiveXObject && (this.xmldom = new ActiveXObject("Microsoft.XMLDOM")), OpenLayers.Format.prototype.initialize.apply(this, [e]), this.namespaces = OpenLayers.Util.extend({}, this.namespaces), this.namespaceAlias = {};
        for (var t in this.namespaces)this.namespaceAlias[this.namespaces[t]] = t
    },
    destroy: function () {
        this.xmldom = null, OpenLayers.Format.prototype.destroy.apply(this, arguments)
    },
    setNamespace: function (e, t) {
        this.namespaces[e] = t, this.namespaceAlias[t] = e
    },
    read: function (e) {
        var t = e.indexOf("<");
        return t > 0 && (e = e.substring(t)), t = OpenLayers.Util.Try(OpenLayers.Function.bind(function () {
            var t;
            return t = window.ActiveXObject && !this.xmldom ? new ActiveXObject("Microsoft.XMLDOM") : this.xmldom, t.loadXML(e), t
        }, this), function () {
            return (new DOMParser).parseFromString(e, "text/xml")
        }, function () {
            var t = new XMLHttpRequest;
            return t.open("GET", "data:text/xml;charset=utf-8," + encodeURIComponent(e), !1), t.overrideMimeType && t.overrideMimeType("text/xml"), t.send(null), t.responseXML
        }), this.keepData && (this.data = t), t
    },
    write: function (e) {
        if (this.xmldom) e = e.xml; else {
            var t = new XMLSerializer;
            if (1 == e.nodeType) {
                var i = document.implementation.createDocument("", "", null);
                i.importNode && (e = i.importNode(e, !0)), i.appendChild(e), e = t.serializeToString(i)
            } else e = t.serializeToString(e)
        }
        return e
    },
    createElementNS: function (e, t) {
        return this.xmldom ? "string" == typeof e ? this.xmldom.createNode(1, t, e) : this.xmldom.createNode(1, t, "") : document.createElementNS(e, t)
    },
    createTextNode: function (e) {
        return "string" != typeof e && (e = "" + e), this.xmldom ? this.xmldom.createTextNode(e) : document.createTextNode(e)
    },
    getElementsByTagNameNS: function (e, t, i) {
        var n = [];
        if (e.getElementsByTagNameNS) n = e.getElementsByTagNameNS(t, i); else for (var s, r, e = e.getElementsByTagName("*"), a = 0, o = e.length; o > a; ++a)s = e[a], r = s.prefix ? s.prefix + ":" + i : i, ("*" == i || r == s.nodeName) && ("*" == t || t == s.namespaceURI) && n.push(s);
        return n
    },
    getAttributeNodeNS: function (e, t, i) {
        var n = null;
        if (e.getAttributeNodeNS) n = e.getAttributeNodeNS(t, i); else for (var s, r, e = e.attributes, a = 0, o = e.length; o > a; ++a)if (s = e[a], s.namespaceURI == t && (r = s.prefix ? s.prefix + ":" + i : i, r == s.nodeName)) {
            n = s;
            break
        }
        return n
    },
    getAttributeNS: function (e, t, i) {
        var n = "";
        return e.getAttributeNS ? n = e.getAttributeNS(t, i) || "" : (e = this.getAttributeNodeNS(e, t, i)) && (n = e.nodeValue), n
    },
    getChildValue: function (e, t) {
        var i = t || "";
        if (e)for (var n = e.firstChild; n; n = n.nextSibling)switch (n.nodeType) {
            case 3:
            case 4:
                i += n.nodeValue
        }
        return i
    },
    isSimpleContent: function (e) {
        for (var t = !0, e = e.firstChild; e; e = e.nextSibling)if (1 === e.nodeType) {
            t = !1;
            break
        }
        return t
    },
    contentType: function (e) {
        for (var t = !1, i = !1, n = OpenLayers.Format.XML.CONTENT_TYPE.EMPTY, e = e.firstChild; e; e = e.nextSibling) {
            switch (e.nodeType) {
                case 1:
                    i = !0;
                    break;
                case 8:
                    break;
                default:
                    t = !0
            }
            if (i && t)break
        }
        if (i && t) n = OpenLayers.Format.XML.CONTENT_TYPE.MIXED; else {
            if (i)return OpenLayers.Format.XML.CONTENT_TYPE.COMPLEX;
            if (t)return OpenLayers.Format.XML.CONTENT_TYPE.SIMPLE
        }
        return n
    },
    hasAttributeNS: function (e, t, i) {
        var n = !1;
        return n = e.hasAttributeNS ? e.hasAttributeNS(t, i) : !!this.getAttributeNodeNS(e, t, i)
    },
    setAttributeNS: function (e, t, i, n) {
        if (e.setAttributeNS) e.setAttributeNS(t, i, n); else {
            if (!this.xmldom)throw"setAttributeNS not implemented";
            t ? (t = e.ownerDocument.createNode(2, i, t), t.nodeValue = n, e.setAttributeNode(t)) : e.setAttribute(i, n)
        }
    },
    createElementNSPlus: function (e, t) {
        var t = t || {}, i = t.uri || this.namespaces[t.prefix];
        i || (i = e.indexOf(":"), i = this.namespaces[e.substring(0, i)]), i || (i = this.namespaces[this.defaultPrefix]), i = this.createElementNS(i, e), t.attributes && this.setAttributes(i, t.attributes);
        var n = t.value;
        return null != n && i.appendChild(this.createTextNode(n)), i
    },
    setAttributes: function (e, t) {
        var i, n, s;
        for (s in t)null != t[s] && t[s].toString && (i = t[s].toString(), n = this.namespaces[s.substring(0, s.indexOf(":"))] || null, this.setAttributeNS(e, n, s, i))
    },
    readNode: function (e, t) {
        t || (t = {});
        var i = this.readers[e.namespaceURI ? this.namespaceAlias[e.namespaceURI] : this.defaultPrefix];
        if (i) {
            var n = e.localName || e.nodeName.split(":").pop();
            (i = i[n] || i["*"]) && i.apply(this, [e, t])
        }
        return t
    },
    readChildNodes: function (e, t) {
        t || (t = {});
        for (var i, n = e.childNodes, s = 0, r = n.length; r > s; ++s)i = n[s], 1 == i.nodeType && this.readNode(i, t);
        return t
    },
    writeNode: function (e, t, i) {
        var n, s = e.indexOf(":");
        return s > 0 ? (n = e.substring(0, s), e = e.substring(s + 1)) : n = i ? this.namespaceAlias[i.namespaceURI] : this.defaultPrefix, t = this.writers[n][e].apply(this, [t]), i && i.appendChild(t), t
    },
    getChildEl: function (e, t, i) {
        return e && this.getThisOrNextEl(e.firstChild, t, i)
    },
    getNextEl: function (e, t, i) {
        return e && this.getThisOrNextEl(e.nextSibling, t, i)
    },
    getThisOrNextEl: function (e, t, i) {
        e:for (; e; e = e.nextSibling)switch (e.nodeType) {
            case 1:
                if (!(t && t !== (e.localName || e.nodeName.split(":").pop()) || i && i !== e.namespaceURI))break e;
                e = null;
                break e;
            case 3:
                if (/^\s*$/.test(e.nodeValue))break;
            case 4:
            case 6:
            case 12:
            case 10:
            case 11:
                e = null;
                break e
        }
        return e || null
    },
    lookupNamespaceURI: function (e, t) {
        var i = null;
        if (e)if (e.lookupNamespaceURI) i = e.lookupNamespaceURI(t); else e:switch (e.nodeType) {
            case 1:
                if (null !== e.namespaceURI && e.prefix === t) {
                    i = e.namespaceURI;
                    break e
                }
                if (i = e.attributes.length)for (var n, s = 0; i > s; ++s) {
                    if (n = e.attributes[s], "xmlns" === n.prefix && n.name === "xmlns:" + t) {
                        i = n.value || null;
                        break e
                    }
                    if ("xmlns" === n.name && null === t) {
                        i = n.value || null;
                        break e
                    }
                }
                i = this.lookupNamespaceURI(e.parentNode, t);
                break e;
            case 2:
                i = this.lookupNamespaceURI(e.ownerElement, t);
                break e;
            case 9:
                i = this.lookupNamespaceURI(e.documentElement, t);
                break e;
            case 6:
            case 12:
            case 10:
            case 11:
                break e;
            default:
                i = this.lookupNamespaceURI(e.parentNode, t)
        }
        return i
    },
    getXMLDoc: function () {
        return !OpenLayers.Format.XML.document && !this.xmldom && (document.implementation && document.implementation.createDocument ? OpenLayers.Format.XML.document = document.implementation.createDocument("", "", null) : !this.xmldom && window.ActiveXObject && (this.xmldom = new ActiveXObject("Microsoft.XMLDOM"))), OpenLayers.Format.XML.document || this.xmldom
    },
    CLASS_NAME: "OpenLayers.Format.XML"
}),OpenLayers.Format.XML.CONTENT_TYPE = {
    EMPTY: 0,
    SIMPLE: 1,
    COMPLEX: 2,
    MIXED: 3
},OpenLayers.Format.XML.lookupNamespaceURI = OpenLayers.Function.bind(OpenLayers.Format.XML.prototype.lookupNamespaceURI, OpenLayers.Format.XML.prototype),OpenLayers.Format.XML.document = null,OpenLayers.Format.WFST = function (e) {
    var e = OpenLayers.Util.applyDefaults(e, OpenLayers.Format.WFST.DEFAULTS), t = OpenLayers.Format.WFST["v" + e.version.replace(/\./g, "_")];
    if (!t)throw"Unsupported WFST version: " + e.version;
    return new t(e)
},OpenLayers.Format.WFST.DEFAULTS = {version: "1.0.0"},OpenLayers.Format.WFST.v1 = OpenLayers.Class(OpenLayers.Format.XML, {
    namespaces: {
        xlink: "http://www.w3.org/1999/xlink",
        xsi: "http://www.w3.org/2001/XMLSchema-instance",
        wfs: "http://www.opengis.net/wfs",
        gml: "http://www.opengis.net/gml",
        ogc: "http://www.opengis.net/ogc",
        ows: "http://www.opengis.net/ows"
    },
    defaultPrefix: "wfs",
    version: null,
    schemaLocations: null,
    srsName: null,
    extractAttributes: !0,
    xy: !0,
    stateName: null,
    initialize: function (e) {
        this.stateName = {}, this.stateName[OpenLayers.State.INSERT] = "wfs:Insert", this.stateName[OpenLayers.State.UPDATE] = "wfs:Update", this.stateName[OpenLayers.State.DELETE] = "wfs:Delete", OpenLayers.Format.XML.prototype.initialize.apply(this, [e])
    },
    getSrsName: function (e, t) {
        var i = t && t.srsName;
        return i || (i = e && e.layer ? e.layer.projection.getCode() : this.srsName), i
    },
    read: function (e, t) {
        t = t || {}, OpenLayers.Util.applyDefaults(t, {output: "features"}), "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e])), e && 9 == e.nodeType && (e = e.documentElement);
        var i = {};
        return e && this.readNode(e, i, !0), i.features && "features" === t.output && (i = i.features), i
    },
    readers: {
        wfs: {
            FeatureCollection: function (e, t) {
                t.features = [], this.readChildNodes(e, t)
            }
        }
    },
    write: function (e, t) {
        var i = this.writeNode("wfs:Transaction", {features: e, options: t}), n = this.schemaLocationAttr();
        return n && this.setAttributeNS(i, this.namespaces.xsi, "xsi:schemaLocation", n), OpenLayers.Format.XML.prototype.write.apply(this, [i])
    },
    writers: {
        wfs: {
            GetFeature: function (e) {
                var t = this.createElementNSPlus("wfs:GetFeature", {
                    attributes: {
                        service: "WFS",
                        version: this.version,
                        handle: e && e.handle,
                        outputFormat: e && e.outputFormat,
                        maxFeatures: e && e.maxFeatures,
                        "xsi:schemaLocation": this.schemaLocationAttr(e)
                    }
                });
                if ("string" == typeof this.featureType) this.writeNode("Query", e, t); else for (var i = 0, n = this.featureType.length; n > i; i++)e.featureType = this.featureType[i], this.writeNode("Query", e, t);
                return t
            }, Transaction: function (e) {
                var t, e = e || {}, i = e.options || {}, n = this.createElementNSPlus("wfs:Transaction", {
                    attributes: {
                        service: "WFS",
                        version: this.version,
                        handle: i.handle
                    }
                }), s = e.features;
                if (s) {
                    !0 === i.multi && OpenLayers.Util.extend(this.geometryTypes, {
                        "OpenLayers.Geometry.Point": "MultiPoint",
                        "OpenLayers.Geometry.LineString": !0 === this.multiCurve ? "MultiCurve" : "MultiLineString",
                        "OpenLayers.Geometry.Polygon": !0 === this.multiSurface ? "MultiSurface" : "MultiPolygon"
                    });
                    var r, a, e = 0;
                    for (t = s.length; t > e; ++e)a = s[e], (r = this.stateName[a.state]) && this.writeNode(r, {
                        feature: a,
                        options: i
                    }, n);
                    !0 === i.multi && this.setGeometryTypes()
                }
                if (i.nativeElements)for (e = 0, t = i.nativeElements.length; t > e; ++e)this.writeNode("wfs:Native", i.nativeElements[e], n);
                return n
            }, Native: function (e) {
                return this.createElementNSPlus("wfs:Native", {
                    attributes: {vendorId: e.vendorId, safeToIgnore: e.safeToIgnore},
                    value: e.value
                })
            }, Insert: function (e) {
                var t = e.feature, e = e.options, e = this.createElementNSPlus("wfs:Insert", {attributes: {handle: e && e.handle}});
                return this.srsName = this.getSrsName(t), this.writeNode("feature:_typeName", t, e), e
            }, Update: function (e) {
                var t = e.feature, e = e.options, e = this.createElementNSPlus("wfs:Update", {
                    attributes: {
                        handle: e && e.handle,
                        typeName: (this.featureNS ? this.featurePrefix + ":" : "") + this.featureType
                    }
                });
                this.featureNS && e.setAttribute("xmlns:" + this.featurePrefix, this.featureNS);
                var i = t.modified;
                null === this.geometryName || i && void 0 === i.geometry || (this.srsName = this.getSrsName(t), this.writeNode("Property", {
                    name: this.geometryName,
                    value: t.geometry
                }, e));
                for (var n in t.attributes)void 0 !== t.attributes[n] && (!i || !i.attributes || i.attributes && void 0 !== i.attributes[n]) && this.writeNode("Property", {
                    name: n,
                    value: t.attributes[n]
                }, e);
                return this.writeNode("ogc:Filter", new OpenLayers.Filter.FeatureId({fids: [t.fid]}), e), e
            }, Property: function (e) {
                var t = this.createElementNSPlus("wfs:Property");
                return this.writeNode("Name", e.name, t), null !== e.value && this.writeNode("Value", e.value, t), t
            }, Name: function (e) {
                return this.createElementNSPlus("wfs:Name", {value: e})
            }, Value: function (e) {
                var t;
                return e instanceof OpenLayers.Geometry ? (t = this.createElementNSPlus("wfs:Value"), e = this.writeNode("feature:_geometry", e).firstChild, t.appendChild(e)) : t = this.createElementNSPlus("wfs:Value", {value: e}), t
            }, Delete: function (e) {
                var t = e.feature, e = e.options, e = this.createElementNSPlus("wfs:Delete", {
                    attributes: {
                        handle: e && e.handle,
                        typeName: (this.featureNS ? this.featurePrefix + ":" : "") + this.featureType
                    }
                });
                return this.featureNS && e.setAttribute("xmlns:" + this.featurePrefix, this.featureNS), this.writeNode("ogc:Filter", new OpenLayers.Filter.FeatureId({fids: [t.fid]}), e), e
            }
        }
    },
    schemaLocationAttr: function (e) {
        var e = OpenLayers.Util.extend({
            featurePrefix: this.featurePrefix,
            schema: this.schema
        }, e), t = OpenLayers.Util.extend({}, this.schemaLocations);
        e.schema && (t[e.featurePrefix] = e.schema);
        var i, n, e = [];
        for (n in t)(i = this.namespaces[n]) && e.push(i + " " + t[n]);
        return e.join(" ") || void 0
    },
    setFilterProperty: function (e) {
        if (e.filters)for (var t = 0, i = e.filters.length; i > t; ++t)OpenLayers.Format.WFST.v1.prototype.setFilterProperty.call(this, e.filters[t]); else e instanceof OpenLayers.Filter.Spatial && !e.property && (e.property = this.geometryName)
    },
    CLASS_NAME: "OpenLayers.Format.WFST.v1"
}),OpenLayers.Format.OGCExceptionReport = OpenLayers.Class(OpenLayers.Format.XML, {
    namespaces: {ogc: "http://www.opengis.net/ogc"},
    regExes: {trimSpace: /^\s*|\s*$/g, removeSpace: /\s*/g, splitSpace: /\s+/, trimComma: /\s*,\s*/g},
    defaultPrefix: "ogc",
    read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e]));
        var t = {exceptionReport: null};
        return e.documentElement && (this.readChildNodes(e, t), null === t.exceptionReport && (t = (new OpenLayers.Format.OWSCommon).read(e))), t
    },
    readers: {
        ogc: {
            ServiceExceptionReport: function (e, t) {
                t.exceptionReport = {exceptions: []}, this.readChildNodes(e, t.exceptionReport)
            }, ServiceException: function (e, t) {
                var i = {code: e.getAttribute("code"), locator: e.getAttribute("locator"), text: this.getChildValue(e)};
                t.exceptions.push(i)
            }
        }
    },
    CLASS_NAME: "OpenLayers.Format.OGCExceptionReport"
}),OpenLayers.Format.XML.VersionedOGC = OpenLayers.Class(OpenLayers.Format.XML, {
    defaultVersion: null,
    version: null,
    profile: null,
    errorProperty: null,
    name: null,
    stringifyOutput: !1,
    parser: null,
    initialize: function (e) {
        OpenLayers.Format.XML.prototype.initialize.apply(this, [e]), e = this.CLASS_NAME, this.name = e.substring(e.lastIndexOf(".") + 1)
    },
    getVersion: function (e, t) {
        var i;
        return e ? (i = this.version, i || (i = e.getAttribute("version"), i || (i = this.defaultVersion))) : i = t && t.version || this.version || this.defaultVersion, i
    },
    getParser: function (e) {
        var e = e || this.defaultVersion, t = this.profile ? "_" + this.profile : "";
        if (!this.parser || this.parser.VERSION != e) {
            var i = OpenLayers.Format[this.name]["v" + e.replace(/\./g, "_") + t];
            if (!i)throw"Can't find a " + this.name + " parser for version " + e + t;
            this.parser = new i(this.options)
        }
        return this.parser
    },
    write: function (e, t) {
        this.parser = this.getParser(this.getVersion(null, t));
        var i = this.parser.write(e, t);
        return !1 === this.stringifyOutput ? i : OpenLayers.Format.XML.prototype.write.apply(this, [i])
    },
    read: function (e, t) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e]));
        var i = this.getVersion(e.documentElement);
        this.parser = this.getParser(i);
        var n = this.parser.read(e, t);
        if (null !== this.errorProperty && void 0 === n[this.errorProperty]) {
            var s = new OpenLayers.Format.OGCExceptionReport;
            n.error = s.read(e)
        }
        return n.version = i, n
    },
    CLASS_NAME: "OpenLayers.Format.XML.VersionedOGC"
}),OpenLayers.Feature = OpenLayers.Class({
    layer: null,
    id: null,
    lonlat: null,
    data: null,
    marker: null,
    popupClass: null,
    popup: null,
    initialize: function (e, t, i) {
        this.layer = e, this.lonlat = t, this.data = null != i ? i : {}, this.id = OpenLayers.Util.createUniqueID(this.CLASS_NAME + "_")
    },
    destroy: function () {
        null != this.layer && null != this.layer.map && null != this.popup && this.layer.map.removePopup(this.popup), null != this.layer && null != this.marker && this.layer.removeMarker(this.marker), this.data = this.lonlat = this.id = this.layer = null, null != this.marker && (this.destroyMarker(this.marker), this.marker = null), null != this.popup && (this.destroyPopup(this.popup), this.popup = null)
    },
    onScreen: function () {
        var e = !1;
        return null != this.layer && null != this.layer.map && (e = this.layer.map.getExtent().containsLonLat(this.lonlat)), e
    },
    createMarker: function () {
        return null != this.lonlat && (this.marker = new OpenLayers.Marker(this.lonlat, this.data.icon)), this.marker
    },
    destroyMarker: function () {
        this.marker.destroy()
    },
    createPopup: function (e) {
        return null != this.lonlat && (this.popup || (this.popup = new (this.popupClass ? this.popupClass : OpenLayers.Popup.Anchored)(this.id + "_popup", this.lonlat, this.data.popupSize, this.data.popupContentHTML, this.marker ? this.marker.icon : null, e)), null != this.data.overflow && (this.popup.contentDiv.style.overflow = this.data.overflow), this.popup.feature = this), this.popup
    },
    destroyPopup: function () {
        this.popup && (this.popup.feature = null, this.popup.destroy(), this.popup = null)
    },
    CLASS_NAME: "OpenLayers.Feature"
}),OpenLayers.State = {
    UNKNOWN: "Unknown",
    INSERT: "Insert",
    UPDATE: "Update",
    DELETE: "Delete"
},OpenLayers.Feature.Vector = OpenLayers.Class(OpenLayers.Feature, {
    fid: null,
    geometry: null,
    attributes: null,
    bounds: null,
    state: null,
    style: null,
    url: null,
    renderIntent: "default",
    modified: null,
    initialize: function (e, t, i) {
        OpenLayers.Feature.prototype.initialize.apply(this, [null, null, t]), this.lonlat = null, this.geometry = e ? e : null, this.state = null, this.attributes = {}, t && (this.attributes = OpenLayers.Util.extend(this.attributes, t)), this.style = i ? i : null
    },
    destroy: function () {
        this.layer && (this.layer.removeFeatures(this), this.layer = null), this.modified = this.geometry = null, OpenLayers.Feature.prototype.destroy.apply(this, arguments)
    },
    clone: function () {
        return new OpenLayers.Feature.Vector(this.geometry ? this.geometry.clone() : null, this.attributes, this.style)
    },
    onScreen: function (e) {
        var t = !1;
        return this.layer && this.layer.map && (t = this.layer.map.getExtent(), e ? (e = this.geometry.getBounds(), t = t.intersectsBounds(e)) : t = t.toGeometry().intersects(this.geometry)), t
    },
    getVisibility: function () {
        return !(this.style && "none" == this.style.display || !this.layer || this.layer && this.layer.styleMap && "none" == this.layer.styleMap.createSymbolizer(this, this.renderIntent).display || this.layer && !this.layer.getVisibility())
    },
    createMarker: function () {
        return null
    },
    destroyMarker: function () {
    },
    createPopup: function () {
        return null
    },
    atPoint: function (e, t, i) {
        var n = !1;
        return this.geometry && (n = this.geometry.atPoint(e, t, i)), n
    },
    destroyPopup: function () {
    },
    move: function (e) {
        if (this.layer && this.geometry.move) {
            var e = "OpenLayers.LonLat" == e.CLASS_NAME ? this.layer.getViewPortPxFromLonLat(e) : e, t = this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat()), i = this.layer.map.getResolution();
            return this.geometry.move(i * (e.x - t.x), i * (t.y - e.y)), this.layer.drawFeature(this), t
        }
    },
    toState: function (e) {
        if (e == OpenLayers.State.UPDATE)switch (this.state) {
            case OpenLayers.State.UNKNOWN:
            case OpenLayers.State.DELETE:
                this.state = e
        } else if (e == OpenLayers.State.INSERT)switch (this.state) {
            case OpenLayers.State.UNKNOWN:
                break;
            default:
                this.state = e
        } else if (e == OpenLayers.State.DELETE)switch (this.state) {
            case OpenLayers.State.UNKNOWN:
            case OpenLayers.State.UPDATE:
                this.state = e
        } else e == OpenLayers.State.UNKNOWN && (this.state = e)
    },
    CLASS_NAME: "OpenLayers.Feature.Vector"
}),OpenLayers.Feature.Vector.style = {
    "default": {
        fillColor: "#ee9900",
        fillOpacity: .4,
        hoverFillColor: "white",
        hoverFillOpacity: .8,
        strokeColor: "#ee9900",
        strokeOpacity: 1,
        strokeWidth: 1,
        strokeLinecap: "round",
        strokeDashstyle: "solid",
        hoverStrokeColor: "red",
        hoverStrokeOpacity: 1,
        hoverStrokeWidth: .2,
        pointRadius: 6,
        hoverPointRadius: 1,
        hoverPointUnit: "%",
        pointerEvents: "visiblePainted",
        cursor: "inherit",
        fontColor: "#000000",
        labelAlign: "cm",
        labelOutlineColor: "white",
        labelOutlineWidth: 3
    },
    select: {
        fillColor: "blue",
        fillOpacity: .4,
        hoverFillColor: "white",
        hoverFillOpacity: .8,
        strokeColor: "blue",
        strokeOpacity: 1,
        strokeWidth: 2,
        strokeLinecap: "round",
        strokeDashstyle: "solid",
        hoverStrokeColor: "red",
        hoverStrokeOpacity: 1,
        hoverStrokeWidth: .2,
        pointRadius: 6,
        hoverPointRadius: 1,
        hoverPointUnit: "%",
        pointerEvents: "visiblePainted",
        cursor: "pointer",
        fontColor: "#000000",
        labelAlign: "cm",
        labelOutlineColor: "white",
        labelOutlineWidth: 3
    },
    temporary: {
        fillColor: "#66cccc",
        fillOpacity: .2,
        hoverFillColor: "white",
        hoverFillOpacity: .8,
        strokeColor: "#66cccc",
        strokeOpacity: 1,
        strokeLinecap: "round",
        strokeWidth: 2,
        strokeDashstyle: "solid",
        hoverStrokeColor: "red",
        hoverStrokeOpacity: 1,
        hoverStrokeWidth: .2,
        pointRadius: 6,
        hoverPointRadius: 1,
        hoverPointUnit: "%",
        pointerEvents: "visiblePainted",
        cursor: "inherit",
        fontColor: "#000000",
        labelAlign: "cm",
        labelOutlineColor: "white",
        labelOutlineWidth: 3
    },
    "delete": {display: "none"}
},OpenLayers.Style = OpenLayers.Class({
    id: null,
    name: null,
    title: null,
    description: null,
    layerName: null,
    isDefault: !1,
    rules: null,
    context: null,
    defaultStyle: null,
    defaultsPerSymbolizer: !1,
    propertyStyles: null,
    initialize: function (e, t) {
        OpenLayers.Util.extend(this, t), this.rules = [], t && t.rules && this.addRules(t.rules), this.setDefaultStyle(e || OpenLayers.Feature.Vector.style["default"]), this.id = OpenLayers.Util.createUniqueID(this.CLASS_NAME + "_")
    },
    destroy: function () {
        for (var e = 0, t = this.rules.length; t > e; e++)this.rules[e].destroy(), this.rules[e] = null;
        this.defaultStyle = this.rules = null
    },
    createSymbolizer: function (e) {
        for (var t, i = this.defaultsPerSymbolizer ? {} : this.createLiterals(OpenLayers.Util.extend({}, this.defaultStyle), e), n = this.rules, s = [], r = !1, a = 0, o = n.length; o > a; a++)t = n[a], t.evaluate(e) && (t instanceof OpenLayers.Rule && t.elseFilter ? s.push(t) : (r = !0, this.applySymbolizer(t, i, e)));
        if (0 == r && 0 < s.length)for (r = !0, a = 0, o = s.length; o > a; a++)this.applySymbolizer(s[a], i, e);
        return 0 < n.length && 0 == r && (i.display = "none"), null != i.label && "string" != typeof i.label && (i.label = "" + i.label), i
    },
    applySymbolizer: function (e, t, i) {
        var n = i.geometry ? this.getSymbolizerPrefix(i.geometry) : OpenLayers.Style.SYMBOLIZER_PREFIXES[0], e = e.symbolizer[n] || e.symbolizer;
        return !0 === this.defaultsPerSymbolizer && (n = this.defaultStyle, OpenLayers.Util.applyDefaults(e, {pointRadius: n.pointRadius}), (!0 === e.stroke || !0 === e.graphic) && OpenLayers.Util.applyDefaults(e, {
            strokeWidth: n.strokeWidth,
            strokeColor: n.strokeColor,
            strokeOpacity: n.strokeOpacity,
            strokeDashstyle: n.strokeDashstyle,
            strokeLinecap: n.strokeLinecap
        }), (!0 === e.fill || !0 === e.graphic) && OpenLayers.Util.applyDefaults(e, {
            fillColor: n.fillColor,
            fillOpacity: n.fillOpacity
        }), !0 === e.graphic && OpenLayers.Util.applyDefaults(e, {
            pointRadius: this.defaultStyle.pointRadius,
            externalGraphic: this.defaultStyle.externalGraphic,
            graphicName: this.defaultStyle.graphicName,
            graphicOpacity: this.defaultStyle.graphicOpacity,
            graphicWidth: this.defaultStyle.graphicWidth,
            graphicHeight: this.defaultStyle.graphicHeight,
            graphicXOffset: this.defaultStyle.graphicXOffset,
            graphicYOffset: this.defaultStyle.graphicYOffset
        })), this.createLiterals(OpenLayers.Util.extend(t, e), i)
    },
    createLiterals: function (e, t) {
        var i = OpenLayers.Util.extend({}, t.attributes || t.data);
        OpenLayers.Util.extend(i, this.context);
        for (var n in this.propertyStyles)e[n] = OpenLayers.Style.createLiteral(e[n], i, t, n);
        return e
    },
    findPropertyStyles: function () {
        var e = {};
        this.addPropertyStyles(e, this.defaultStyle);
        for (var t, i, n = this.rules, s = 0, r = n.length; r > s; s++) {
            t = n[s].symbolizer;
            for (var a in t) {
                if (i = t[a], "object" != typeof i) {
                    this.addPropertyStyles(e, t);
                    break
                }
                this.addPropertyStyles(e, i)
            }
        }
        return e
    },
    addPropertyStyles: function (e, t) {
        var i, n;
        for (n in t)i = t[n], "string" == typeof i && i.match(/\$\{\w+\}/) && (e[n] = !0);
        return e
    },
    addRules: function (e) {
        Array.prototype.push.apply(this.rules, e), this.propertyStyles = this.findPropertyStyles()
    },
    setDefaultStyle: function (e) {
        this.defaultStyle = e, this.propertyStyles = this.findPropertyStyles()
    },
    getSymbolizerPrefix: function (e) {
        for (var t = OpenLayers.Style.SYMBOLIZER_PREFIXES, i = 0, n = t.length; n > i; i++)if (-1 != e.CLASS_NAME.indexOf(t[i]))return t[i]
    },
    clone: function () {
        var e = OpenLayers.Util.extend({}, this);
        if (this.rules) {
            e.rules = [];
            for (var t = 0, i = this.rules.length; i > t; ++t)e.rules.push(this.rules[t].clone())
        }
        return e.context = this.context && OpenLayers.Util.extend({}, this.context), t = OpenLayers.Util.extend({}, this.defaultStyle), new OpenLayers.Style(t, e)
    },
    CLASS_NAME: "OpenLayers.Style"
}),OpenLayers.Style.createLiteral = function (e, t, i, n) {
    return "string" == typeof e && -1 != e.indexOf("${") && (e = OpenLayers.String.format(e, t, [i, n]), e = isNaN(e) || !e ? e : parseFloat(e)), e
},OpenLayers.Style.SYMBOLIZER_PREFIXES = ["Point", "Line", "Polygon", "Text", "Raster"],OpenLayers.Filter = OpenLayers.Class({
    initialize: function (e) {
        OpenLayers.Util.extend(this, e)
    }, destroy: function () {
    }, evaluate: function () {
        return !0
    }, clone: function () {
        return null
    }, toString: function () {
        return OpenLayers.Format && OpenLayers.Format.CQL ? OpenLayers.Format.CQL.prototype.write(this) : Object.prototype.toString.call(this)
    }, CLASS_NAME: "OpenLayers.Filter"
}),OpenLayers.Filter.FeatureId = OpenLayers.Class(OpenLayers.Filter, {
    fids: null,
    type: "FID",
    initialize: function (e) {
        this.fids = [], OpenLayers.Filter.prototype.initialize.apply(this, [e])
    },
    evaluate: function (e) {
        for (var t = 0, i = this.fids.length; i > t; t++)if ((e.fid || e.id) == this.fids[t])return !0;
        return !1
    },
    clone: function () {
        var e = new OpenLayers.Filter.FeatureId;
        return OpenLayers.Util.extend(e, this), e.fids = this.fids.slice(), e
    },
    CLASS_NAME: "OpenLayers.Filter.FeatureId"
}),OpenLayers.Filter.Logical = OpenLayers.Class(OpenLayers.Filter, {
    filters: null,
    type: null,
    initialize: function (e) {
        this.filters = [], OpenLayers.Filter.prototype.initialize.apply(this, [e])
    },
    destroy: function () {
        this.filters = null, OpenLayers.Filter.prototype.destroy.apply(this)
    },
    evaluate: function (e) {
        var t, i;
        switch (this.type) {
            case OpenLayers.Filter.Logical.AND:
                for (t = 0, i = this.filters.length; i > t; t++)if (0 == this.filters[t].evaluate(e))return !1;
                return !0;
            case OpenLayers.Filter.Logical.OR:
                for (t = 0, i = this.filters.length; i > t; t++)if (1 == this.filters[t].evaluate(e))return !0;
                return !1;
            case OpenLayers.Filter.Logical.NOT:
                return !this.filters[0].evaluate(e)
        }
    },
    clone: function () {
        for (var e = [], t = 0, i = this.filters.length; i > t; ++t)e.push(this.filters[t].clone());
        return new OpenLayers.Filter.Logical({type: this.type, filters: e})
    },
    CLASS_NAME: "OpenLayers.Filter.Logical"
}),OpenLayers.Filter.Logical.AND = "&&",OpenLayers.Filter.Logical.OR = "||",OpenLayers.Filter.Logical.NOT = "!",OpenLayers.Filter.Comparison = OpenLayers.Class(OpenLayers.Filter, {
    type: null,
    property: null,
    value: null,
    matchCase: !0,
    lowerBoundary: null,
    upperBoundary: null,
    initialize: function (e) {
        OpenLayers.Filter.prototype.initialize.apply(this, [e]), this.type === OpenLayers.Filter.Comparison.LIKE && void 0 === e.matchCase && (this.matchCase = null)
    },
    evaluate: function (e) {
        e instanceof OpenLayers.Feature.Vector && (e = e.attributes);
        var t = !1, e = e[this.property];
        switch (this.type) {
            case OpenLayers.Filter.Comparison.EQUAL_TO:
                t = this.value, t = this.matchCase || "string" != typeof e || "string" != typeof t ? e == t : e.toUpperCase() == t.toUpperCase();
                break;
            case OpenLayers.Filter.Comparison.NOT_EQUAL_TO:
                t = this.value, t = this.matchCase || "string" != typeof e || "string" != typeof t ? e != t : e.toUpperCase() != t.toUpperCase();
                break;
            case OpenLayers.Filter.Comparison.LESS_THAN:
                t = e < this.value;
                break;
            case OpenLayers.Filter.Comparison.GREATER_THAN:
                t = e > this.value;
                break;
            case OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO:
                t = e <= this.value;
                break;
            case OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO:
                t = e >= this.value;
                break;
            case OpenLayers.Filter.Comparison.BETWEEN:
                t = e >= this.lowerBoundary && e <= this.upperBoundary;
                break;
            case OpenLayers.Filter.Comparison.LIKE:
                t = RegExp(this.value, "gi").test(e)
        }
        return t
    },
    value2regex: function (e, t, i) {
        if ("." == e)throw Error("'.' is an unsupported wildCard character for OpenLayers.Filter.Comparison");
        return e = e ? e : "*", t = t ? t : ".", this.value = this.value.replace(RegExp("\\" + (i ? i : "!") + "(.|$)", "g"), "\\$1"), this.value = this.value.replace(RegExp("\\" + t, "g"), "."), this.value = this.value.replace(RegExp("\\" + e, "g"), ".*"), this.value = this.value.replace(RegExp("\\\\.\\*", "g"), "\\" + e), this.value = this.value.replace(RegExp("\\\\\\.", "g"), "\\" + t)
    },
    regex2value: function () {
        var e = this.value, e = e.replace(/!/g, "!!"), e = e.replace(/(\\)?\\\./g, function (e, t) {
            return t ? e : "!."
        }), e = e.replace(/(\\)?\\\*/g, function (e, t) {
            return t ? e : "!*"
        }), e = e.replace(/\\\\/g, "\\");
        return e = e.replace(/\.\*/g, "*")
    },
    clone: function () {
        return OpenLayers.Util.extend(new OpenLayers.Filter.Comparison, this)
    },
    CLASS_NAME: "OpenLayers.Filter.Comparison"
}),OpenLayers.Filter.Comparison.EQUAL_TO = "==",OpenLayers.Filter.Comparison.NOT_EQUAL_TO = "!=",OpenLayers.Filter.Comparison.LESS_THAN = "<",OpenLayers.Filter.Comparison.GREATER_THAN = ">",OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO = "<=",OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO = ">=",OpenLayers.Filter.Comparison.BETWEEN = "..",OpenLayers.Filter.Comparison.LIKE = "~",OpenLayers.Format.Filter = OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC, {
    defaultVersion: "1.0.0",
    CLASS_NAME: "OpenLayers.Format.Filter"
}),OpenLayers.Filter.Function = OpenLayers.Class(OpenLayers.Filter, {
    name: null,
    params: null,
    CLASS_NAME: "OpenLayers.Filter.Function"
}),OpenLayers.Format.Filter.v1 = OpenLayers.Class(OpenLayers.Format.XML, {
    namespaces: {
        ogc: "http://www.opengis.net/ogc",
        gml: "http://www.opengis.net/gml",
        xlink: "http://www.w3.org/1999/xlink",
        xsi: "http://www.w3.org/2001/XMLSchema-instance"
    },
    defaultPrefix: "ogc",
    schemaLocation: null,
    initialize: function (e) {
        OpenLayers.Format.XML.prototype.initialize.apply(this, [e])
    },
    read: function (e) {
        var t = {};
        return this.readers.ogc.Filter.apply(this, [e, t]), t.filter
    },
    readers: {
        ogc: {
            _expression: function (e) {
                for (var t = "", i = e.firstChild; i; i = i.nextSibling)switch (i.nodeType) {
                    case 1:
                        e = this.readNode(i), e.property ? t += "${" + e.property + "}" : void 0 !== e.value && (t += e.value);
                        break;
                    case 3:
                    case 4:
                        t += i.nodeValue
                }
                return t
            }, Filter: function (e, t) {
                var i = {fids: [], filters: []};
                this.readChildNodes(e, i), 0 < i.fids.length ? t.filter = new OpenLayers.Filter.FeatureId({fids: i.fids}) : 0 < i.filters.length && (t.filter = i.filters[0])
            }, FeatureId: function (e, t) {
                var i = e.getAttribute("fid");
                i && t.fids.push(i)
            }, And: function (e, t) {
                var i = new OpenLayers.Filter.Logical({type: OpenLayers.Filter.Logical.AND});
                this.readChildNodes(e, i), t.filters.push(i)
            }, Or: function (e, t) {
                var i = new OpenLayers.Filter.Logical({type: OpenLayers.Filter.Logical.OR});
                this.readChildNodes(e, i), t.filters.push(i)
            }, Not: function (e, t) {
                var i = new OpenLayers.Filter.Logical({type: OpenLayers.Filter.Logical.NOT});
                this.readChildNodes(e, i), t.filters.push(i)
            }, PropertyIsLessThan: function (e, t) {
                var i = new OpenLayers.Filter.Comparison({type: OpenLayers.Filter.Comparison.LESS_THAN});
                this.readChildNodes(e, i), t.filters.push(i)
            }, PropertyIsGreaterThan: function (e, t) {
                var i = new OpenLayers.Filter.Comparison({type: OpenLayers.Filter.Comparison.GREATER_THAN});
                this.readChildNodes(e, i), t.filters.push(i)
            }, PropertyIsLessThanOrEqualTo: function (e, t) {
                var i = new OpenLayers.Filter.Comparison({type: OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO});
                this.readChildNodes(e, i), t.filters.push(i)
            }, PropertyIsGreaterThanOrEqualTo: function (e, t) {
                var i = new OpenLayers.Filter.Comparison({type: OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO});
                this.readChildNodes(e, i), t.filters.push(i)
            }, PropertyIsBetween: function (e, t) {
                var i = new OpenLayers.Filter.Comparison({type: OpenLayers.Filter.Comparison.BETWEEN});
                this.readChildNodes(e, i), t.filters.push(i)
            }, Literal: function (e, t) {
                t.value = OpenLayers.String.numericIf(this.getChildValue(e))
            }, PropertyName: function (e, t) {
                t.property = this.getChildValue(e)
            }, LowerBoundary: function (e, t) {
                t.lowerBoundary = OpenLayers.String.numericIf(this.readers.ogc._expression.call(this, e))
            }, UpperBoundary: function (e, t) {
                t.upperBoundary = OpenLayers.String.numericIf(this.readers.ogc._expression.call(this, e))
            }, Intersects: function (e, t) {
                this.readSpatial(e, t, OpenLayers.Filter.Spatial.INTERSECTS)
            }, Within: function (e, t) {
                this.readSpatial(e, t, OpenLayers.Filter.Spatial.WITHIN)
            }, Contains: function (e, t) {
                this.readSpatial(e, t, OpenLayers.Filter.Spatial.CONTAINS)
            }, DWithin: function (e, t) {
                this.readSpatial(e, t, OpenLayers.Filter.Spatial.DWITHIN)
            }, Distance: function (e, t) {
                t.distance = parseInt(this.getChildValue(e)), t.distanceUnits = e.getAttribute("units")
            }, Function: function () {
            }
        }
    },
    readSpatial: function (e, t, i) {
        i = new OpenLayers.Filter.Spatial({type: i}), this.readChildNodes(e, i), i.value = i.components[0], delete i.components, t.filters.push(i)
    },
    writeOgcExpression: function (e, t) {
        if (e instanceof OpenLayers.Filter.Function) {
            var i = this.writeNode("Function", e, t);
            t.appendChild(i)
        } else this.writeNode("Literal", e, t);
        return t
    },
    write: function (e) {
        return this.writers.ogc.Filter.apply(this, [e])
    },
    writeFeatureIdNodes: function (e, t) {
        for (var i = 0, n = e.fids.length; n > i; ++i)this.writeNode("FeatureId", e.fids[i], t)
    },
    writers: {
        ogc: {
            Filter: function (e) {
                var t = this.createElementNSPlus("ogc:Filter");
                return "FID" === e.type ? OpenLayers.Format.Filter.v1.prototype.writeFeatureIdNodes.call(this, e, t) : this.writeNode(this.getFilterType(e), e, t), t
            }, FeatureId: function (e) {
                return this.createElementNSPlus("ogc:FeatureId", {attributes: {fid: e}})
            }, And: function (e) {
                for (var t, i = this.createElementNSPlus("ogc:And"), n = 0, s = e.filters.length; s > n; ++n)t = e.filters[n], "FID" === t.type ? OpenLayers.Format.Filter.v1.prototype.writeFeatureIdNodes.call(this, t, i) : this.writeNode(this.getFilterType(t), t, i);
                return i
            }, Or: function (e) {
                for (var t, i = this.createElementNSPlus("ogc:Or"), n = 0, s = e.filters.length; s > n; ++n)t = e.filters[n], "FID" === t.type ? OpenLayers.Format.Filter.v1.prototype.writeFeatureIdNodes.call(this, t, i) : this.writeNode(this.getFilterType(t), t, i);
                return i
            }, Not: function (e) {
                var t = this.createElementNSPlus("ogc:Not"), e = e.filters[0];
                return "FID" === e.type ? OpenLayers.Format.Filter.v1.prototype.writeFeatureIdNodes.call(this, e, t) : this.writeNode(this.getFilterType(e), e, t), t
            }, PropertyIsLessThan: function (e) {
                var t = this.createElementNSPlus("ogc:PropertyIsLessThan");
                return this.writeNode("PropertyName", e, t), this.writeOgcExpression(e.value, t), t
            }, PropertyIsGreaterThan: function (e) {
                var t = this.createElementNSPlus("ogc:PropertyIsGreaterThan");
                return this.writeNode("PropertyName", e, t), this.writeOgcExpression(e.value, t), t
            }, PropertyIsLessThanOrEqualTo: function (e) {
                var t = this.createElementNSPlus("ogc:PropertyIsLessThanOrEqualTo");
                return this.writeNode("PropertyName", e, t), this.writeOgcExpression(e.value, t), t
            }, PropertyIsGreaterThanOrEqualTo: function (e) {
                var t = this.createElementNSPlus("ogc:PropertyIsGreaterThanOrEqualTo");
                return this.writeNode("PropertyName", e, t), this.writeOgcExpression(e.value, t), t
            }, PropertyIsBetween: function (e) {
                var t = this.createElementNSPlus("ogc:PropertyIsBetween");
                return this.writeNode("PropertyName", e, t), this.writeNode("LowerBoundary", e, t), this.writeNode("UpperBoundary", e, t), t
            }, PropertyName: function (e) {
                return this.createElementNSPlus("ogc:PropertyName", {value: e.property})
            }, Literal: function (e) {
                return this.createElementNSPlus("ogc:Literal", {value: e})
            }, LowerBoundary: function (e) {
                var t = this.createElementNSPlus("ogc:LowerBoundary");
                return this.writeOgcExpression(e.lowerBoundary, t), t
            }, UpperBoundary: function (e) {
                var t = this.createElementNSPlus("ogc:UpperBoundary");
                return this.writeNode("Literal", e.upperBoundary, t), t
            }, INTERSECTS: function (e) {
                return this.writeSpatial(e, "Intersects")
            }, WITHIN: function (e) {
                return this.writeSpatial(e, "Within")
            }, CONTAINS: function (e) {
                return this.writeSpatial(e, "Contains")
            }, DWITHIN: function (e) {
                var t = this.writeSpatial(e, "DWithin");
                return this.writeNode("Distance", e, t), t
            }, Distance: function (e) {
                return this.createElementNSPlus("ogc:Distance", {
                    attributes: {units: e.distanceUnits},
                    value: e.distance
                })
            }, Function: function (e) {
                for (var t = this.createElementNSPlus("ogc:Function", {attributes: {name: e.name}}), e = e.params, i = 0, n = e.length; n > i; i++)this.writeOgcExpression(e[i], t);
                return t
            }
        }
    },
    getFilterType: function (e) {
        var t = this.filterMap[e.type];
        if (!t)throw"Filter writing not supported for rule type: " + e.type;
        return t
    },
    filterMap: {
        "&&": "And",
        "||": "Or",
        "!": "Not",
        "==": "PropertyIsEqualTo",
        "!=": "PropertyIsNotEqualTo",
        "<": "PropertyIsLessThan",
        ">": "PropertyIsGreaterThan",
        "<=": "PropertyIsLessThanOrEqualTo",
        ">=": "PropertyIsGreaterThanOrEqualTo",
        "..": "PropertyIsBetween",
        "~": "PropertyIsLike",
        BBOX: "BBOX",
        DWITHIN: "DWITHIN",
        WITHIN: "WITHIN",
        CONTAINS: "CONTAINS",
        INTERSECTS: "INTERSECTS",
        FID: "FeatureId"
    },
    CLASS_NAME: "OpenLayers.Format.Filter.v1"
}),OpenLayers.Geometry = OpenLayers.Class({
    id: null, parent: null, bounds: null, initialize: function () {
        this.id = OpenLayers.Util.createUniqueID(this.CLASS_NAME + "_")
    }, destroy: function () {
        this.bounds = this.id = null
    }, clone: function () {
        return new OpenLayers.Geometry
    }, setBounds: function (e) {
        e && (this.bounds = e.clone())
    }, clearBounds: function () {
        this.bounds = null, this.parent && this.parent.clearBounds()
    }, extendBounds: function (e) {
        this.getBounds() ? this.bounds.extend(e) : this.setBounds(e)
    }, getBounds: function () {
        return null == this.bounds && this.calculateBounds(), this.bounds
    }, calculateBounds: function () {
    }, distanceTo: function () {
    }, getVertices: function () {
    }, atPoint: function (e, t, i) {
        var n = !1;
        return null != this.getBounds() && null != e && (t = null != t ? t : 0, i = null != i ? i : 0, n = new OpenLayers.Bounds(this.bounds.left - t, this.bounds.bottom - i, this.bounds.right + t, this.bounds.top + i).containsLonLat(e)), n
    }, getLength: function () {
        return 0
    }, getArea: function () {
        return 0
    }, getCentroid: function () {
        return null
    }, toString: function () {
        return OpenLayers.Format && OpenLayers.Format.WKT ? OpenLayers.Format.WKT.prototype.write(new OpenLayers.Feature.Vector(this)) : Object.prototype.toString.call(this)
    }, CLASS_NAME: "OpenLayers.Geometry"
}),OpenLayers.Geometry.fromWKT = function (e) {
    var t;
    if (OpenLayers.Format && OpenLayers.Format.WKT) {
        var i = OpenLayers.Geometry.fromWKT.format;
        if (i || (i = new OpenLayers.Format.WKT, OpenLayers.Geometry.fromWKT.format = i), e = i.read(e), e instanceof OpenLayers.Feature.Vector) t = e.geometry; else if (OpenLayers.Util.isArray(e)) {
            t = e.length;
            for (var i = Array(t), n = 0; t > n; ++n)i[n] = e[n].geometry;
            t = new OpenLayers.Geometry.Collection(i)
        }
    }
    return t
},OpenLayers.Geometry.segmentsIntersect = function (e, t, i) {
    var n = i && i.point, i = i && i.tolerance, s = !1, r = e.x1 - t.x1, a = e.y1 - t.y1, o = e.x2 - e.x1, l = e.y2 - e.y1, h = t.y2 - t.y1, u = t.x2 - t.x1, c = h * o - u * l, h = u * a - h * r, a = o * a - l * r;
    if (0 == c ? 0 == h && 0 == a && (s = !0) : (r = h / c, c = a / c, r >= 0 && 1 >= r && c >= 0 && 1 >= c && (n ? (o = e.x1 + r * o, c = e.y1 + r * l, s = new OpenLayers.Geometry.Point(o, c)) : s = !0)), i)if (s) {
        if (n) {
            e = [e, t], t = 0;
            e:for (; 2 > t; ++t)for (r = e[t], l = 1; 3 > l; ++l)if (o = r["x" + l], c = r["y" + l], n = Math.sqrt(Math.pow(o - s.x, 2) + Math.pow(c - s.y, 2)), i > n) {
                s.x = o, s.y = c;
                break e
            }
        }
    } else {
        e = [e, t], t = 0;
        e:for (; 2 > t; ++t)for (o = e[t], c = e[(t + 1) % 2], l = 1; 3 > l; ++l)if (r = {
                x: o["x" + l],
                y: o["y" + l]
            }, a = OpenLayers.Geometry.distanceToSegment(r, c), a.distance < i) {
            s = n ? new OpenLayers.Geometry.Point(r.x, r.y) : !0;
            break e
        }
    }
    return s
},OpenLayers.Geometry.distanceToSegment = function (e, t) {
    var i = e.x, n = e.y, s = t.x1, r = t.y1, a = t.x2, o = t.y2, l = a - s, h = o - r, u = (l * (i - s) + h * (n - r)) / (Math.pow(l, 2) + Math.pow(h, 2));
    return 0 >= u || (u >= 1 ? (s = a, r = o) : (s += u * l, r += u * h)), {
        distance: Math.sqrt(Math.pow(s - i, 2) + Math.pow(r - n, 2)),
        x: s,
        y: r
    }
},OpenLayers.Geometry.Point = OpenLayers.Class(OpenLayers.Geometry, {
    x: null, y: null, initialize: function (e, t) {
        OpenLayers.Geometry.prototype.initialize.apply(this, arguments), this.x = parseFloat(e), this.y = parseFloat(t)
    }, clone: function (e) {
        return null == e && (e = new OpenLayers.Geometry.Point(this.x, this.y)), OpenLayers.Util.applyDefaults(e, this), e
    }, calculateBounds: function () {
        this.bounds = new OpenLayers.Bounds(this.x, this.y, this.x, this.y)
    }, distanceTo: function (e, t) {
        var i, n, s, r, a, o = !(t && !1 === t.edge) && t && t.details;
        return e instanceof OpenLayers.Geometry.Point ? (n = this.x, s = this.y, r = e.x, a = e.y, i = Math.sqrt(Math.pow(n - r, 2) + Math.pow(s - a, 2)), i = o ? {
            x0: n,
            y0: s,
            x1: r,
            y1: a,
            distance: i
        } : i) : (i = e.distanceTo(this, t), o && (i = {
            x0: i.x1,
            y0: i.y1,
            x1: i.x0,
            y1: i.y0,
            distance: i.distance
        })), i
    }, equals: function (e) {
        var t = !1;
        return null != e && (t = this.x == e.x && this.y == e.y || isNaN(this.x) && isNaN(this.y) && isNaN(e.x) && isNaN(e.y)), t
    }, toShortString: function () {
        return this.x + ", " + this.y
    }, move: function (e, t) {
        this.x += e, this.y += t, this.clearBounds()
    }, rotate: function (e, t) {
        var e = e * (Math.PI / 180), i = this.distanceTo(t), n = e + Math.atan2(this.y - t.y, this.x - t.x);
        this.x = t.x + i * Math.cos(n), this.y = t.y + i * Math.sin(n), this.clearBounds()
    }, getCentroid: function () {
        return new OpenLayers.Geometry.Point(this.x, this.y)
    }, resize: function (e, t, i) {
        return this.x = t.x + e * (void 0 == i ? 1 : i) * (this.x - t.x), this.y = t.y + e * (this.y - t.y), this.clearBounds(), this
    }, intersects: function (e) {
        var t = !1;
        return t = "OpenLayers.Geometry.Point" == e.CLASS_NAME ? this.equals(e) : e.intersects(this)
    }, transform: function (e, t) {
        return e && t && (OpenLayers.Projection.transform(this, e, t), this.bounds = null), this
    }, getVertices: function () {
        return [this]
    }, CLASS_NAME: "OpenLayers.Geometry.Point"
}),OpenLayers.Geometry.Collection = OpenLayers.Class(OpenLayers.Geometry, {
    components: null,
    componentTypes: null,
    initialize: function (e) {
        OpenLayers.Geometry.prototype.initialize.apply(this, arguments), this.components = [], null != e && this.addComponents(e)
    },
    destroy: function () {
        this.components.length = 0, this.components = null, OpenLayers.Geometry.prototype.destroy.apply(this, arguments)
    },
    clone: function () {
        for (var a = eval("new " + this.CLASS_NAME + "()"), b = 0, c = this.components.length; c > b; b++)a.addComponent(this.components[b].clone());
        return OpenLayers.Util.applyDefaults(a, this), a
    },
    getComponentsString: function () {
        for (var e = [], t = 0, i = this.components.length; i > t; t++)e.push(this.components[t].toShortString());
        return e.join(",")
    },
    calculateBounds: function () {
        this.bounds = null;
        var e = new OpenLayers.Bounds, t = this.components;
        if (t)for (var i = 0, n = t.length; n > i; i++)e.extend(t[i].getBounds());
        null != e.left && null != e.bottom && null != e.right && null != e.top && this.setBounds(e)
    },
    addComponents: function (e) {
        OpenLayers.Util.isArray(e) || (e = [e]);
        for (var t = 0, i = e.length; i > t; t++)this.addComponent(e[t])
    },
    addComponent: function (e, t) {
        var i = !1;
        if (e && (null == this.componentTypes || -1 < OpenLayers.Util.indexOf(this.componentTypes, e.CLASS_NAME))) {
            if (null != t && t < this.components.length) {
                var i = this.components.slice(0, t), n = this.components.slice(t, this.components.length);
                i.push(e), this.components = i.concat(n)
            } else this.components.push(e);
            e.parent = this, this.clearBounds(), i = !0
        }
        return i
    },
    removeComponents: function (e) {
        var t = !1;
        OpenLayers.Util.isArray(e) || (e = [e]);
        for (var i = e.length - 1; i >= 0; --i)t = this.removeComponent(e[i]) || t;
        return t
    },
    removeComponent: function (e) {
        return OpenLayers.Util.removeItem(this.components, e), this.clearBounds(), !0
    },
    getLength: function () {
        for (var e = 0, t = 0, i = this.components.length; i > t; t++)e += this.components[t].getLength();
        return e
    },
    getArea: function () {
        for (var e = 0, t = 0, i = this.components.length; i > t; t++)e += this.components[t].getArea();
        return e
    },
    getGeodesicArea: function (e) {
        for (var t = 0, i = 0, n = this.components.length; n > i; i++)t += this.components[i].getGeodesicArea(e);
        return t
    },
    getCentroid: function (e) {
        if (!e)return this.components.length && this.components[0].getCentroid();
        if (e = this.components.length, !e)return !1;
        for (var t, i = [], n = [], s = 0, r = Number.MAX_VALUE, a = 0; e > a; ++a) {
            t = this.components[a];
            var o = t.getArea();
            t = t.getCentroid(!0), !isNaN(o) && !isNaN(t.x) && !isNaN(t.y) && (i.push(o), s += o, r = r > o && o > 0 ? o : r, n.push(t))
        }
        if (e = i.length, 0 === s) {
            for (a = 0; e > a; ++a)i[a] = 1;
            s = i.length
        } else {
            for (a = 0; e > a; ++a)i[a] /= r;
            s /= r
        }
        for (var l = r = 0, a = 0; e > a; ++a)t = n[a], o = i[a], r += t.x * o, l += t.y * o;
        return new OpenLayers.Geometry.Point(r / s, l / s)
    },
    getGeodesicLength: function (e) {
        for (var t = 0, i = 0, n = this.components.length; n > i; i++)t += this.components[i].getGeodesicLength(e);
        return t
    },
    move: function (e, t) {
        for (var i = 0, n = this.components.length; n > i; i++)this.components[i].move(e, t)
    },
    rotate: function (e, t) {
        for (var i = 0, n = this.components.length; n > i; ++i)this.components[i].rotate(e, t)
    },
    resize: function (e, t, i) {
        for (var n = 0; n < this.components.length; ++n)this.components[n].resize(e, t, i);
        return this
    },
    distanceTo: function (e, t) {
        for (var i, n, s, r = !(t && !1 === t.edge) && t && t.details, a = Number.POSITIVE_INFINITY, o = 0, l = this.components.length; l > o && (i = this.components[o].distanceTo(e, t), s = r ? i.distance : i, !(a > s && (a = s, n = i, 0 == a))); ++o);
        return n
    },
    equals: function (e) {
        var t = !0;
        if (e && e.CLASS_NAME && this.CLASS_NAME == e.CLASS_NAME)if (OpenLayers.Util.isArray(e.components) && e.components.length == this.components.length) {
            for (var i = 0, n = this.components.length; n > i; ++i)if (!this.components[i].equals(e.components[i])) {
                t = !1;
                break
            }
        } else t = !1; else t = !1;
        return t
    },
    transform: function (e, t) {
        if (e && t) {
            for (var i = 0, n = this.components.length; n > i; i++)this.components[i].transform(e, t);
            this.bounds = null
        }
        return this
    },
    intersects: function (e) {
        for (var t = !1, i = 0, n = this.components.length; n > i && !(t = e.intersects(this.components[i])); ++i);
        return t
    },
    getVertices: function (e) {
        for (var t = [], i = 0, n = this.components.length; n > i; ++i)Array.prototype.push.apply(t, this.components[i].getVertices(e));
        return t
    },
    CLASS_NAME: "OpenLayers.Geometry.Collection"
}),OpenLayers.Geometry.MultiPoint = OpenLayers.Class(OpenLayers.Geometry.Collection, {
    componentTypes: ["OpenLayers.Geometry.Point"],
    addPoint: function (e, t) {
        this.addComponent(e, t)
    },
    removePoint: function (e) {
        this.removeComponent(e)
    },
    CLASS_NAME: "OpenLayers.Geometry.MultiPoint"
}),OpenLayers.Geometry.Curve = OpenLayers.Class(OpenLayers.Geometry.MultiPoint, {
    componentTypes: ["OpenLayers.Geometry.Point"],
    getLength: function () {
        var e = 0;
        if (this.components && 1 < this.components.length)for (var t = 1, i = this.components.length; i > t; t++)e += this.components[t - 1].distanceTo(this.components[t]);
        return e
    },
    getGeodesicLength: function (e) {
        var t = this;
        if (e) {
            var i = new OpenLayers.Projection("EPSG:4326");
            i.equals(e) || (t = this.clone().transform(e, i))
        }
        if (e = 0, t.components && 1 < t.components.length)for (var n, s = 1, r = t.components.length; r > s; s++)i = t.components[s - 1], n = t.components[s], e += OpenLayers.Util.distVincenty({
            lon: i.x,
            lat: i.y
        }, {lon: n.x, lat: n.y});
        return 1e3 * e
    },
    CLASS_NAME: "OpenLayers.Geometry.Curve"
}),OpenLayers.Geometry.LineString = OpenLayers.Class(OpenLayers.Geometry.Curve, {
    removeComponent: function () {
        var e = this.components && 2 < this.components.length;
        return e && OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this, arguments), e
    }, intersects: function (e) {
        var t = !1, i = e.CLASS_NAME;
        if ("OpenLayers.Geometry.LineString" == i || "OpenLayers.Geometry.LinearRing" == i || "OpenLayers.Geometry.Point" == i) {
            var n, s, r, a, o, l, h, u = this.getSortedSegments(), e = "OpenLayers.Geometry.Point" == i ? [{
                x1: e.x,
                y1: e.y,
                x2: e.x,
                y2: e.y
            }] : e.getSortedSegments(), c = 0, p = u.length;
            e:for (; p > c; ++c) {
                i = u[c], n = i.x1, s = i.x2, r = i.y1, a = i.y2;
                for (var d = 0, f = e.length; f > d && (o = e[d], !(o.x1 > s)); ++d)if (!(o.x2 < n || (l = o.y1, h = o.y2, Math.min(l, h) > Math.max(r, a) || Math.max(l, h) < Math.min(r, a) || !OpenLayers.Geometry.segmentsIntersect(i, o)))) {
                    t = !0;
                    break e
                }
            }
        } else t = e.intersects(this);
        return t
    }, getSortedSegments: function () {
        for (var e, t, i = this.components.length - 1, n = Array(i), s = 0; i > s; ++s)e = this.components[s], t = this.components[s + 1], n[s] = e.x < t.x ? {
            x1: e.x,
            y1: e.y,
            x2: t.x,
            y2: t.y
        } : {x1: t.x, y1: t.y, x2: e.x, y2: e.y};
        return n.sort(function (e, t) {
            return e.x1 - t.x1
        })
    }, splitWithSegment: function (e, t) {
        for (var i, n, s, r = !(t && !1 === t.edge), a = t && t.tolerance, o = [], l = this.getVertices(), h = [], u = [], c = !1, p = {
            point: !0,
            tolerance: a
        }, d = null, f = 0, m = l.length - 2; m >= f; ++f)a = l[f], h.push(a.clone()), i = l[f + 1], n = {
            x1: a.x,
            y1: a.y,
            x2: i.x,
            y2: i.y
        }, n = OpenLayers.Geometry.segmentsIntersect(e, n, p), n instanceof OpenLayers.Geometry.Point && ((s = n.x === e.x1 && n.y === e.y1 || n.x === e.x2 && n.y === e.y2 || n.equals(a) || n.equals(i) ? !0 : !1) || r) && (n.equals(u[u.length - 1]) || u.push(n.clone()), !(0 === f && n.equals(a)) && !n.equals(i) && (c = !0, n.equals(a) || h.push(n), o.push(new OpenLayers.Geometry.LineString(h)), h = [n.clone()]));
        if (c && (h.push(i.clone()), o.push(new OpenLayers.Geometry.LineString(h))), 0 < u.length)var g = e.x1 < e.x2 ? 1 : -1, y = e.y1 < e.y2 ? 1 : -1, d = {
            lines: o,
            points: u.sort(function (e, t) {
                return g * e.x - g * t.x || y * e.y - y * t.y
            })
        };
        return d
    }, split: function (e, t) {
        var i, n, s, r, a = null, o = t && t.mutual;
        if (e instanceof OpenLayers.Geometry.LineString) {
            var l, h, u, c, p, d = this.getVertices(), f = [];
            s = [];
            for (var m = 0, g = d.length - 2; g >= m; ++m) {
                l = d[m], h = d[m + 1], u = {x1: l.x, y1: l.y, x2: h.x, y2: h.y}, r = r || [e], o && f.push(l.clone());
                for (var y = 0; y < r.length; ++y)if ((c = r[y].splitWithSegment(u, t)) && (p = c.lines, 0 < p.length && (p.unshift(y, 1), Array.prototype.splice.apply(r, p), y += p.length - 2), o))for (var v = 0, b = c.points.length; b > v; ++v)p = c.points[v], p.equals(l) || (f.push(p), s.push(new OpenLayers.Geometry.LineString(f)), f = p.equals(h) ? [] : [p.clone()])
            }
            o && 0 < s.length && 0 < f.length && (f.push(h.clone()), s.push(new OpenLayers.Geometry.LineString(f)))
        } else a = e.splitWith(this, t);
        return r && 1 < r.length ? n = !0 : r = [], s && 1 < s.length ? i = !0 : s = [], (n || i) && (a = o ? [s, r] : r), a
    }, splitWith: function (e, t) {
        return e.split(this, t)
    }, getVertices: function (e) {
        return !0 === e ? [this.components[0], this.components[this.components.length - 1]] : !1 === e ? this.components.slice(1, this.components.length - 1) : this.components.slice()
    }, distanceTo: function (e, t) {
        var i, n = !(t && !1 === t.edge) && t && t.details, s = {}, r = Number.POSITIVE_INFINITY;
        if (e instanceof OpenLayers.Geometry.Point) {
            for (var a, o = this.getSortedSegments(), l = e.x, h = e.y, u = 0, c = o.length; c > u; ++u)if (a = o[u], i = OpenLayers.Geometry.distanceToSegment(e, a), i.distance < r) {
                if (r = i.distance, s = i, 0 === r)break
            } else if (a.x2 > l && (h > a.y1 && h < a.y2 || h < a.y1 && h > a.y2))break;
            s = n ? {distance: s.distance, x0: s.x, y0: s.y, x1: l, y1: h} : s.distance
        } else if (e instanceof OpenLayers.Geometry.LineString) {
            var p, d, o = this.getSortedSegments(), l = e.getSortedSegments(), f = l.length, m = {point: !0}, u = 0, c = o.length;
            e:for (; c > u; ++u) {
                h = o[u], a = h.x1, d = h.y1;
                for (var g = 0; f > g; ++g) {
                    if (i = l[g], p = OpenLayers.Geometry.segmentsIntersect(h, i, m)) {
                        r = 0, s = {distance: 0, x0: p.x, y0: p.y, x1: p.x, y1: p.y};
                        break e
                    }
                    i = OpenLayers.Geometry.distanceToSegment({
                        x: a,
                        y: d
                    }, i), i.distance < r && (r = i.distance, s = {distance: r, x0: a, y0: d, x1: i.x, y1: i.y})
                }
            }
            n || (s = s.distance), 0 !== r && h && (i = e.distanceTo(new OpenLayers.Geometry.Point(h.x2, h.y2), t), u = n ? i.distance : i, r > u && (s = n ? {
                distance: r,
                x0: i.x1,
                y0: i.y1,
                x1: i.x0,
                y1: i.y0
            } : u))
        } else s = e.distanceTo(this, t), n && (s = {distance: s.distance, x0: s.x1, y0: s.y1, x1: s.x0, y1: s.y0});
        return s
    }, simplify: function (e) {
        if (this && null !== this) {
            var t = this.getVertices();
            if (3 > t.length)return this;
            var i = function (e, t, n, r) {
                for (var a, o = 0, l = 0, h = t; n > h; h++) {
                    a = e[t];
                    var u = e[n], c = e[h], c = Math.abs(.5 * (a.x * u.y + u.x * c.y + c.x * a.y - u.x * a.y - c.x * u.y - a.x * c.y));
                    a = Math.sqrt(Math.pow(a.x - u.x, 2) + Math.pow(a.y - u.y, 2)), a = 2 * (c / a), a > o && (o = a, l = h)
                }
                o > r && l != t && (s.push(l), i(e, t, l, r), i(e, l, n, r))
            }, n = t.length - 1, s = [];
            for (s.push(0), s.push(n); t[0].equals(t[n]);)n--, s.push(n);
            for (i(t, 0, n, e), e = [], s.sort(function (e, t) {
                return e - t
            }), n = 0; n < s.length; n++)e.push(t[s[n]]);
            return new OpenLayers.Geometry.LineString(e)
        }
        return this
    }, CLASS_NAME: "OpenLayers.Geometry.LineString"
}),OpenLayers.Geometry.MultiLineString = OpenLayers.Class(OpenLayers.Geometry.Collection, {
    componentTypes: ["OpenLayers.Geometry.LineString"],
    split: function (e, t) {
        for (var i, n, s, r, a = null, o = t && t.mutual, l = [], h = [e], u = 0, c = this.components.length; c > u; ++u) {
            n = this.components[u], s = !1;
            for (var p = 0; p < h.length; ++p)if (i = n.split(h[p], t)) {
                if (o) {
                    s = i[0];
                    for (var d = 0, f = s.length; f > d; ++d)0 === d && l.length ? l[l.length - 1].addComponent(s[d]) : l.push(new OpenLayers.Geometry.MultiLineString([s[d]]));
                    s = !0, i = i[1]
                }
                if (i.length) {
                    i.unshift(p, 1), Array.prototype.splice.apply(h, i);
                    break
                }
            }
            s || (l.length ? l[l.length - 1].addComponent(n.clone()) : l = [new OpenLayers.Geometry.MultiLineString(n.clone())])
        }
        return l && 1 < l.length ? s = !0 : l = [], h && 1 < h.length ? r = !0 : h = [], (s || r) && (a = o ? [l, h] : h), a
    },
    splitWith: function (e, t) {
        var i, n, s, r, a, o, l = null, h = t && t.mutual;
        if (e instanceof OpenLayers.Geometry.LineString) {
            o = [], a = [e];
            for (var u = 0, c = this.components.length; c > u; ++u) {
                s = !1, n = this.components[u];
                for (var p = 0; p < a.length; ++p)if (i = a[p].split(n, t)) {
                    h && (s = i[0], s.length && (s.unshift(p, 1), Array.prototype.splice.apply(a, s), p += s.length - 2), i = i[1], 0 === i.length && (i = [n.clone()])), s = 0;
                    for (var d = i.length; d > s; ++s)0 === s && o.length ? o[o.length - 1].addComponent(i[s]) : o.push(new OpenLayers.Geometry.MultiLineString([i[s]]));
                    s = !0
                }
                s || (o.length ? o[o.length - 1].addComponent(n.clone()) : o = [new OpenLayers.Geometry.MultiLineString([n.clone()])])
            }
        } else l = e.split(this);
        return a && 1 < a.length ? r = !0 : a = [], o && 1 < o.length ? s = !0 : o = [], (r || s) && (l = h ? [a, o] : o), l
    },
    CLASS_NAME: "OpenLayers.Geometry.MultiLineString"
}),OpenLayers.Geometry.LinearRing = OpenLayers.Class(OpenLayers.Geometry.LineString, {
    componentTypes: ["OpenLayers.Geometry.Point"],
    addComponent: function (e, t) {
        var i = !1, n = this.components.pop();
        return null == t && e.equals(n) || (i = OpenLayers.Geometry.Collection.prototype.addComponent.apply(this, arguments)), OpenLayers.Geometry.Collection.prototype.addComponent.apply(this, [this.components[0]]), i
    },
    removeComponent: function () {
        var e = this.components && 3 < this.components.length;
        return e && (this.components.pop(), OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this, arguments), OpenLayers.Geometry.Collection.prototype.addComponent.apply(this, [this.components[0]])), e
    },
    move: function (e, t) {
        for (var i = 0, n = this.components.length; n - 1 > i; i++)this.components[i].move(e, t)
    },
    rotate: function (e, t) {
        for (var i = 0, n = this.components.length; n - 1 > i; ++i)this.components[i].rotate(e, t)
    },
    resize: function (e, t, i) {
        for (var n = 0, s = this.components.length; s - 1 > n; ++n)this.components[n].resize(e, t, i);
        return this
    },
    transform: function (e, t) {
        if (e && t) {
            for (var i = 0, n = this.components.length; n - 1 > i; i++)this.components[i].transform(e, t);
            this.bounds = null
        }
        return this
    },
    getCentroid: function () {
        if (this.components && 2 < this.components.length) {
            for (var e = 0, t = 0, i = 0; i < this.components.length - 1; i++)var n = this.components[i], s = this.components[i + 1], e = e + (n.x + s.x) * (n.x * s.y - s.x * n.y), t = t + (n.y + s.y) * (n.x * s.y - s.x * n.y);
            return i = -1 * this.getArea(), new OpenLayers.Geometry.Point(e / (6 * i), t / (6 * i))
        }
        return null
    },
    getArea: function () {
        var e = 0;
        if (this.components && 2 < this.components.length) {
            for (var t = e = 0, i = this.components.length; i - 1 > t; t++)var n = this.components[t], s = this.components[t + 1], e = e + (n.x + s.x) * (s.y - n.y);
            e = -e / 2
        }
        return e
    },
    getGeodesicArea: function (e) {
        var t = this;
        if (e) {
            var i = new OpenLayers.Projection("EPSG:4326");
            i.equals(e) || (t = this.clone().transform(e, i))
        }
        if (e = 0, i = t.components && t.components.length, i > 2) {
            for (var n, s, r = 0; i - 1 > r; r++)n = t.components[r], s = t.components[r + 1], e += OpenLayers.Util.rad(s.x - n.x) * (2 + Math.sin(OpenLayers.Util.rad(n.y)) + Math.sin(OpenLayers.Util.rad(s.y)));
            e = 40680631590769 * e / 2
        }
        return e
    },
    containsPoint: function (e) {
        for (var t, i, n, s, r, a = OpenLayers.Number.limitSigDigs, o = a(e.x, 14), e = a(e.y, 14), l = this.components.length - 1, h = 0, u = 0; l > u; ++u)if (t = this.components[u], n = a(t.x, 14), t = a(t.y, 14), i = this.components[u + 1], s = a(i.x, 14), i = a(i.y, 14), t == i) {
            if (e == t && (s >= n && o >= n && s >= o || n >= s && n >= o && o >= s)) {
                h = -1;
                break
            }
        } else {
            if (r = a((e - i) * ((s - n) / (i - t)) + s, 14), r == o && (i > t && e >= t && i >= e || t > i && t >= e && e >= i)) {
                h = -1;
                break
            }
            o >= r || n != s && (r < Math.min(n, s) || r > Math.max(n, s)) || (i > t && e >= t && i > e || t > i && t > e && e >= i) && ++h
        }
        return -1 == h ? 1 : !!(1 & h)
    },
    intersects: function (e) {
        var t = !1;
        if ("OpenLayers.Geometry.Point" == e.CLASS_NAME) t = this.containsPoint(e); else if ("OpenLayers.Geometry.LineString" == e.CLASS_NAME) t = e.intersects(this); else if ("OpenLayers.Geometry.LinearRing" == e.CLASS_NAME) t = OpenLayers.Geometry.LineString.prototype.intersects.apply(this, [e]); else for (var i = 0, n = e.components.length; n > i && !(t = e.components[i].intersects(this)); ++i);
        return t
    },
    getVertices: function (e) {
        return !0 === e ? [] : this.components.slice(0, this.components.length - 1)
    },
    CLASS_NAME: "OpenLayers.Geometry.LinearRing"
}),OpenLayers.Geometry.Polygon = OpenLayers.Class(OpenLayers.Geometry.Collection, {
    componentTypes: ["OpenLayers.Geometry.LinearRing"],
    getArea: function () {
        var e = 0;
        if (this.components && 0 < this.components.length)for (var e = e + Math.abs(this.components[0].getArea()), t = 1, i = this.components.length; i > t; t++)e -= Math.abs(this.components[t].getArea());
        return e
    },
    getGeodesicArea: function (e) {
        var t = 0;
        if (this.components && 0 < this.components.length)for (var t = t + Math.abs(this.components[0].getGeodesicArea(e)), i = 1, n = this.components.length; n > i; i++)t -= Math.abs(this.components[i].getGeodesicArea(e));
        return t
    },
    containsPoint: function (e) {
        var t = this.components.length, i = !1;
        if (t > 0 && (i = this.components[0].containsPoint(e), 1 !== i && i && t > 1))for (var n, s = 1; t > s; ++s)if (n = this.components[s].containsPoint(e)) {
            i = 1 === n ? 1 : !1;
            break
        }
        return i
    },
    intersects: function (e) {
        var t, i, n = !1;
        if ("OpenLayers.Geometry.Point" == e.CLASS_NAME) n = this.containsPoint(e); else if ("OpenLayers.Geometry.LineString" == e.CLASS_NAME || "OpenLayers.Geometry.LinearRing" == e.CLASS_NAME) {
            for (t = 0, i = this.components.length; i > t && !(n = e.intersects(this.components[t])); ++t);
            if (!n)for (t = 0, i = e.components.length; i > t && !(n = this.containsPoint(e.components[t])); ++t);
        } else for (t = 0, i = e.components.length; i > t && !(n = this.intersects(e.components[t])); ++t);
        if (!n && "OpenLayers.Geometry.Polygon" == e.CLASS_NAME) {
            var s = this.components[0];
            for (t = 0, i = s.components.length; i > t && !(n = e.containsPoint(s.components[t])); ++t);
        }
        return n
    },
    distanceTo: function (e, t) {
        return t && !1 === t.edge && this.intersects(e) ? 0 : OpenLayers.Geometry.Collection.prototype.distanceTo.apply(this, [e, t])
    },
    CLASS_NAME: "OpenLayers.Geometry.Polygon"
}),OpenLayers.Geometry.Polygon.createRegularPolygon = function (e, t, i, n) {
    var s = Math.PI * (1 / i - .5);
    n && (s += n / 180 * Math.PI);
    for (var r, a = [], o = 0; i > o; ++o)r = s + 2 * o * Math.PI / i, n = e.x + t * Math.cos(r), r = e.y + t * Math.sin(r), a.push(new OpenLayers.Geometry.Point(n, r));
    return e = new OpenLayers.Geometry.LinearRing(a), new OpenLayers.Geometry.Polygon([e])
},OpenLayers.Geometry.MultiPolygon = OpenLayers.Class(OpenLayers.Geometry.Collection, {
    componentTypes: ["OpenLayers.Geometry.Polygon"],
    CLASS_NAME: "OpenLayers.Geometry.MultiPolygon"
}),OpenLayers.Format.GML = OpenLayers.Class(OpenLayers.Format.XML, {
    featureNS: "http://mapserver.gis.umn.edu/mapserver",
    featurePrefix: "feature",
    featureName: "featureMember",
    layerName: "features",
    geometryName: "geometry",
    collectionName: "FeatureCollection",
    gmlns: "http://www.opengis.net/gml",
    extractAttributes: !0,
    xy: !0,
    initialize: function (e) {
        this.regExes = {
            trimSpace: /^\s*|\s*$/g,
            removeSpace: /\s*/g,
            splitSpace: /\s+/,
            trimComma: /\s*,\s*/g
        }, OpenLayers.Format.XML.prototype.initialize.apply(this, [e])
    },
    read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e]));
        for (var e = this.getElementsByTagNameNS(e.documentElement, this.gmlns, this.featureName), t = [], i = 0; i < e.length; i++) {
            var n = this.parseFeature(e[i]);
            n && t.push(n)
        }
        return t
    },
    parseFeature: function (e) {
        for (var t, i, n, s = "MultiPolygon Polygon MultiLineString LineString MultiPoint Point Envelope".split(" "), r = 0; r < s.length; ++r)if (t = s[r], i = this.getElementsByTagNameNS(e, this.gmlns, t), 0 < i.length) {
            if (!(n = this.parseGeometry[t.toLowerCase()]))throw new TypeError("Unsupported geometry type: " + t);
            n = n.apply(this, [i[0]]), this.internalProjection && this.externalProjection && n.transform(this.externalProjection, this.internalProjection);
            break
        }
        var a;
        for (t = this.getElementsByTagNameNS(e, this.gmlns, "Box"), r = 0; r < t.length; ++r)s = t[r], i = this.parseGeometry.box.apply(this, [s]), s = s.parentNode, "boundedBy" === (s.localName || s.nodeName.split(":").pop()) ? a = i : n = i.toGeometry();
        var o;
        this.extractAttributes && (o = this.parseAttributes(e)), o = new OpenLayers.Feature.Vector(n, o), o.bounds = a, o.gml = {
            featureType: e.firstChild.nodeName.split(":")[1],
            featureNS: e.firstChild.namespaceURI,
            featureNSPrefix: e.firstChild.prefix
        };
        for (var l, e = e.firstChild; e && (1 != e.nodeType || !(l = e.getAttribute("fid") || e.getAttribute("id")));)e = e.nextSibling;
        return o.fid = l, o
    },
    parseGeometry: {
        point: function (e) {
            var t, i;
            return i = [], t = this.getElementsByTagNameNS(e, this.gmlns, "pos"), 0 < t.length && (i = t[0].firstChild.nodeValue, i = i.replace(this.regExes.trimSpace, ""), i = i.split(this.regExes.splitSpace)), 0 == i.length && (t = this.getElementsByTagNameNS(e, this.gmlns, "coordinates"), 0 < t.length && (i = t[0].firstChild.nodeValue, i = i.replace(this.regExes.removeSpace, ""), i = i.split(","))), 0 == i.length && (t = this.getElementsByTagNameNS(e, this.gmlns, "coord"), 0 < t.length && (e = this.getElementsByTagNameNS(t[0], this.gmlns, "X"), t = this.getElementsByTagNameNS(t[0], this.gmlns, "Y"), 0 < e.length && 0 < t.length && (i = [e[0].firstChild.nodeValue, t[0].firstChild.nodeValue]))), 2 == i.length && (i[2] = null), this.xy ? new OpenLayers.Geometry.Point(i[0], i[1], i[2]) : new OpenLayers.Geometry.Point(i[1], i[0], i[2])
        }, multipoint: function (e) {
            var e = this.getElementsByTagNameNS(e, this.gmlns, "Point"), t = [];
            if (0 < e.length)for (var i, n = 0; n < e.length; ++n)(i = this.parseGeometry.point.apply(this, [e[n]])) && t.push(i);
            return new OpenLayers.Geometry.MultiPoint(t)
        }, linestring: function (e, t) {
            var i, n;
            n = [];
            var s = [];
            if (i = this.getElementsByTagNameNS(e, this.gmlns, "posList"), 0 < i.length) {
                n = this.getChildValue(i[0]), n = n.replace(this.regExes.trimSpace, ""), n = n.split(this.regExes.splitSpace);
                var r, a, o, l = parseInt(i[0].getAttribute("dimension"));
                for (i = 0; i < n.length / l; ++i)r = i * l, a = n[r], o = n[r + 1], r = 2 == l ? null : n[r + 2], this.xy ? s.push(new OpenLayers.Geometry.Point(a, o, r)) : s.push(new OpenLayers.Geometry.Point(o, a, r))
            }
            if (0 == n.length && (i = this.getElementsByTagNameNS(e, this.gmlns, "coordinates"), 0 < i.length))for (n = this.getChildValue(i[0]), n = n.replace(this.regExes.trimSpace, ""), n = n.replace(this.regExes.trimComma, ","), l = n.split(this.regExes.splitSpace), i = 0; i < l.length; ++i)n = l[i].split(","), 2 == n.length && (n[2] = null), this.xy ? s.push(new OpenLayers.Geometry.Point(n[0], n[1], n[2])) : s.push(new OpenLayers.Geometry.Point(n[1], n[0], n[2]));
            return n = null, 0 != s.length && (n = t ? new OpenLayers.Geometry.LinearRing(s) : new OpenLayers.Geometry.LineString(s)), n
        }, multilinestring: function (e) {
            var e = this.getElementsByTagNameNS(e, this.gmlns, "LineString"), t = [];
            if (0 < e.length)for (var i, n = 0; n < e.length; ++n)(i = this.parseGeometry.linestring.apply(this, [e[n]])) && t.push(i);
            return new OpenLayers.Geometry.MultiLineString(t)
        }, polygon: function (e) {
            var e = this.getElementsByTagNameNS(e, this.gmlns, "LinearRing"), t = [];
            if (0 < e.length)for (var i, n = 0; n < e.length; ++n)(i = this.parseGeometry.linestring.apply(this, [e[n], !0])) && t.push(i);
            return new OpenLayers.Geometry.Polygon(t)
        }, multipolygon: function (e) {
            var e = this.getElementsByTagNameNS(e, this.gmlns, "Polygon"), t = [];
            if (0 < e.length)for (var i, n = 0; n < e.length; ++n)(i = this.parseGeometry.polygon.apply(this, [e[n]])) && t.push(i);
            return new OpenLayers.Geometry.MultiPolygon(t)
        }, envelope: function (e) {
            var t, i, n = [], s = this.getElementsByTagNameNS(e, this.gmlns, "lowerCorner");
            if (0 < s.length) {
                t = [], 0 < s.length && (t = s[0].firstChild.nodeValue, t = t.replace(this.regExes.trimSpace, ""), t = t.split(this.regExes.splitSpace)), 2 == t.length && (t[2] = null);
                var r = this.xy ? new OpenLayers.Geometry.Point(t[0], t[1], t[2]) : new OpenLayers.Geometry.Point(t[1], t[0], t[2])
            }
            if (e = this.getElementsByTagNameNS(e, this.gmlns, "upperCorner"), 0 < e.length) {
                t = [], 0 < e.length && (t = e[0].firstChild.nodeValue, t = t.replace(this.regExes.trimSpace, ""), t = t.split(this.regExes.splitSpace)), 2 == t.length && (t[2] = null);
                var a = this.xy ? new OpenLayers.Geometry.Point(t[0], t[1], t[2]) : new OpenLayers.Geometry.Point(t[1], t[0], t[2])
            }
            return r && a && (n.push(new OpenLayers.Geometry.Point(r.x, r.y)), n.push(new OpenLayers.Geometry.Point(a.x, r.y)), n.push(new OpenLayers.Geometry.Point(a.x, a.y)), n.push(new OpenLayers.Geometry.Point(r.x, a.y)), n.push(new OpenLayers.Geometry.Point(r.x, r.y)), n = new OpenLayers.Geometry.LinearRing(n), i = new OpenLayers.Geometry.Polygon([n])), i
        }, box: function (e) {
            var t = this.getElementsByTagNameNS(e, this.gmlns, "coordinates"), i = e = null;
            return 0 < t.length && (t = t[0].firstChild.nodeValue, t = t.split(" "), 2 == t.length && (e = t[0].split(","), i = t[1].split(","))), null !== e && null !== i ? new OpenLayers.Bounds(parseFloat(e[0]), parseFloat(e[1]), parseFloat(i[0]), parseFloat(i[1])) : void 0
        }
    },
    parseAttributes: function (e) {
        for (var t, i, n, s = {}, e = e.firstChild; e;) {
            if (1 == e.nodeType) {
                for (e = e.childNodes, t = 0; t < e.length; ++t)i = e[t], 1 == i.nodeType && (n = i.childNodes, 1 == n.length ? (n = n[0], (3 == n.nodeType || 4 == n.nodeType) && (i = i.prefix ? i.nodeName.split(":")[1] : i.nodeName, n = n.nodeValue.replace(this.regExes.trimSpace, ""), s[i] = n)) : s[i.nodeName.split(":").pop()] = null);
                break
            }
            e = e.nextSibling
        }
        return s
    },
    write: function (e) {
        OpenLayers.Util.isArray(e) || (e = [e]);
        for (var t = this.createElementNS("http://www.opengis.net/wfs", "wfs:" + this.collectionName), i = 0; i < e.length; i++)t.appendChild(this.createFeatureXML(e[i]));
        return OpenLayers.Format.XML.prototype.write.apply(this, [t])
    },
    createFeatureXML: function (e) {
        var t = this.buildGeometryNode(e.geometry), i = this.createElementNS(this.featureNS, this.featurePrefix + ":" + this.geometryName);
        i.appendChild(t);
        var t = this.createElementNS(this.gmlns, "gml:" + this.featureName), n = this.createElementNS(this.featureNS, this.featurePrefix + ":" + this.layerName);
        n.setAttribute("fid", e.fid || e.id), n.appendChild(i);
        for (var s in e.attributes) {
            var i = this.createTextNode(e.attributes[s]), r = this.createElementNS(this.featureNS, this.featurePrefix + ":" + s.substring(s.lastIndexOf(":") + 1));
            r.appendChild(i), n.appendChild(r)
        }
        return t.appendChild(n), t
    },
    buildGeometryNode: function (e) {
        this.externalProjection && this.internalProjection && (e = e.clone(), e.transform(this.internalProjection, this.externalProjection));
        var t = e.CLASS_NAME;
        return this.buildGeometry[t.substring(t.lastIndexOf(".") + 1).toLowerCase()].apply(this, [e])
    },
    buildGeometry: {
        point: function (e) {
            var t = this.createElementNS(this.gmlns, "gml:Point");
            return t.appendChild(this.buildCoordinatesNode(e)), t
        }, multipoint: function (e) {
            for (var t, i, n = this.createElementNS(this.gmlns, "gml:MultiPoint"), e = e.components, s = 0; s < e.length; s++)t = this.createElementNS(this.gmlns, "gml:pointMember"), i = this.buildGeometry.point.apply(this, [e[s]]), t.appendChild(i), n.appendChild(t);
            return n
        }, linestring: function (e) {
            var t = this.createElementNS(this.gmlns, "gml:LineString");
            return t.appendChild(this.buildCoordinatesNode(e)), t
        }, multilinestring: function (e) {
            for (var t, i, n = this.createElementNS(this.gmlns, "gml:MultiLineString"), e = e.components, s = 0; s < e.length; ++s)t = this.createElementNS(this.gmlns, "gml:lineStringMember"), i = this.buildGeometry.linestring.apply(this, [e[s]]), t.appendChild(i), n.appendChild(t);
            return n
        }, linearring: function (e) {
            var t = this.createElementNS(this.gmlns, "gml:LinearRing");
            return t.appendChild(this.buildCoordinatesNode(e)), t
        }, polygon: function (e) {
            for (var t, i, n = this.createElementNS(this.gmlns, "gml:Polygon"), e = e.components, s = 0; s < e.length; ++s)t = 0 == s ? "outerBoundaryIs" : "innerBoundaryIs", t = this.createElementNS(this.gmlns, "gml:" + t), i = this.buildGeometry.linearring.apply(this, [e[s]]), t.appendChild(i), n.appendChild(t);
            return n
        }, multipolygon: function (e) {
            for (var t, i, n = this.createElementNS(this.gmlns, "gml:MultiPolygon"), e = e.components, s = 0; s < e.length; ++s)t = this.createElementNS(this.gmlns, "gml:polygonMember"), i = this.buildGeometry.polygon.apply(this, [e[s]]), t.appendChild(i), n.appendChild(t);
            return n
        }, bounds: function (e) {
            var t = this.createElementNS(this.gmlns, "gml:Box");
            return t.appendChild(this.buildCoordinatesNode(e)), t
        }
    },
    buildCoordinatesNode: function (e) {
        var t = this.createElementNS(this.gmlns, "gml:coordinates");
        t.setAttribute("decimal", "."), t.setAttribute("cs", ","), t.setAttribute("ts", " ");
        var i = [];
        if (e instanceof OpenLayers.Bounds) i.push(e.left + "," + e.bottom), i.push(e.right + "," + e.top); else for (var e = e.components ? e.components : [e], n = 0; n < e.length; n++)i.push(e[n].x + "," + e[n].y);
        return i = this.createTextNode(i.join(" ")), t.appendChild(i), t
    },
    CLASS_NAME: "OpenLayers.Format.GML"
}),OpenLayers.Format.GML || (OpenLayers.Format.GML = {}),OpenLayers.Format.GML.Base = OpenLayers.Class(OpenLayers.Format.XML, {
    namespaces: {
        gml: "http://www.opengis.net/gml",
        xlink: "http://www.w3.org/1999/xlink",
        xsi: "http://www.w3.org/2001/XMLSchema-instance",
        wfs: "http://www.opengis.net/wfs"
    },
    defaultPrefix: "gml",
    schemaLocation: null,
    featureType: null,
    featureNS: null,
    geometryName: "geometry",
    extractAttributes: !0,
    srsName: null,
    xy: !0,
    geometryTypes: null,
    singleFeatureType: null,
    regExes: {
        trimSpace: /^\s*|\s*$/g,
        removeSpace: /\s*/g,
        splitSpace: /\s+/,
        trimComma: /\s*,\s*/g,
        featureMember: /^(.*:)?featureMembers?$/
    },
    initialize: function (e) {
        OpenLayers.Format.XML.prototype.initialize.apply(this, [e]), this.setGeometryTypes(), e && e.featureNS && this.setNamespace("feature", e.featureNS), this.singleFeatureType = !e || "string" == typeof e.featureType
    },
    read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e])), e && 9 == e.nodeType && (e = e.documentElement);
        var t = [];
        if (this.readNode(e, {features: t}, !0), 0 == t.length) {
            var i = this.getElementsByTagNameNS(e, this.namespaces.gml, "featureMember");
            if (i.length)for (var e = 0, n = i.length; n > e; ++e)this.readNode(i[e], {features: t}, !0); else i = this.getElementsByTagNameNS(e, this.namespaces.gml, "featureMembers"), i.length && this.readNode(i[0], {features: t}, !0)
        }
        return t
    },
    readNode: function (e, t, i) {
        return i === !0 && this.autoConfig === !0 && (this.featureType = null, delete this.namespaceAlias[this.featureNS], delete this.namespaces.feature, this.featureNS = null), this.featureNS || e.prefix in this.namespaces || e.parentNode.namespaceURI != this.namespaces.gml || !this.regExes.featureMember.test(e.parentNode.nodeName) || (this.featureType = e.nodeName.split(":").pop(), this.setNamespace("feature", e.namespaceURI), this.featureNS = e.namespaceURI, this.autoConfig = !0), OpenLayers.Format.XML.prototype.readNode.apply(this, [e, t])
    },
    readers: {
        gml: {
            featureMember: function (e, t) {
                this.readChildNodes(e, t)
            }, featureMembers: function (e, t) {
                this.readChildNodes(e, t)
            }, name: function (e, t) {
                t.name = this.getChildValue(e)
            }, boundedBy: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), i.components && i.components.length > 0 && (t.bounds = i.components[0])
            }, Point: function (e, t) {
                var i = {points: []};
                this.readChildNodes(e, i), t.components || (t.components = []), t.components.push(i.points[0])
            }, coordinates: function (e, t) {
                for (var i, n = this.getChildValue(e).replace(this.regExes.trimSpace, ""), n = n.replace(this.regExes.trimComma, ","), n = n.split(this.regExes.splitSpace), s = n.length, r = Array(s), a = 0; s > a; ++a)i = n[a].split(","), r[a] = this.xy ? new OpenLayers.Geometry.Point(i[0], i[1], i[2]) : new OpenLayers.Geometry.Point(i[1], i[0], i[2]);
                t.points = r
            }, coord: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), t.points || (t.points = []), t.points.push(new OpenLayers.Geometry.Point(i.x, i.y, i.z))
            }, X: function (e, t) {
                t.x = this.getChildValue(e)
            }, Y: function (e, t) {
                t.y = this.getChildValue(e)
            }, Z: function (e, t) {
                t.z = this.getChildValue(e)
            }, MultiPoint: function (e, t) {
                var i = {components: []};
                this.readChildNodes(e, i), t.components = [new OpenLayers.Geometry.MultiPoint(i.components)]
            }, pointMember: function (e, t) {
                this.readChildNodes(e, t)
            }, LineString: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), t.components || (t.components = []), t.components.push(new OpenLayers.Geometry.LineString(i.points))
            }, MultiLineString: function (e, t) {
                var i = {components: []};
                this.readChildNodes(e, i), t.components = [new OpenLayers.Geometry.MultiLineString(i.components)]
            }, lineStringMember: function (e, t) {
                this.readChildNodes(e, t)
            }, Polygon: function (e, t) {
                var i = {outer: null, inner: []};
                this.readChildNodes(e, i), i.inner.unshift(i.outer), t.components || (t.components = []), t.components.push(new OpenLayers.Geometry.Polygon(i.inner))
            }, LinearRing: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), t.components = [new OpenLayers.Geometry.LinearRing(i.points)]
            }, MultiPolygon: function (e, t) {
                var i = {components: []};
                this.readChildNodes(e, i), t.components = [new OpenLayers.Geometry.MultiPolygon(i.components)]
            }, polygonMember: function (e, t) {
                this.readChildNodes(e, t)
            }, GeometryCollection: function (e, t) {
                var i = {components: []};
                this.readChildNodes(e, i), t.components = [new OpenLayers.Geometry.Collection(i.components)]
            }, geometryMember: function (e, t) {
                this.readChildNodes(e, t)
            }
        }, feature: {
            "*": function (e, t) {
                var i, n = e.localName || e.nodeName.split(":").pop();
                t.features ? this.singleFeatureType || -1 === OpenLayers.Util.indexOf(this.featureType, n) ? n === this.featureType && (i = "_typeName") : i = "_typeName" : 0 == e.childNodes.length || 1 == e.childNodes.length && 3 == e.firstChild.nodeType ? this.extractAttributes && (i = "_attribute") : i = "_geometry", i && this.readers.feature[i].apply(this, [e, t])
            }, _typeName: function (e, t) {
                var i = {components: [], attributes: {}};
                this.readChildNodes(e, i), i.name && (i.attributes.name = i.name);
                var n = new OpenLayers.Feature.Vector(i.components[0], i.attributes);
                this.singleFeatureType || (n.type = e.nodeName.split(":").pop(), n.namespace = e.namespaceURI);
                var s = e.getAttribute("fid") || this.getAttributeNS(e, this.namespaces.gml, "id");
                s && (n.fid = s), this.internalProjection && this.externalProjection && n.geometry && n.geometry.transform(this.externalProjection, this.internalProjection), i.bounds && (n.bounds = i.bounds), t.features.push(n)
            }, _geometry: function (e, t) {
                this.geometryName || (this.geometryName = e.nodeName.split(":").pop()), this.readChildNodes(e, t)
            }, _attribute: function (e, t) {
                var i = e.localName || e.nodeName.split(":").pop(), n = this.getChildValue(e);
                t.attributes[i] = n
            }
        }, wfs: {
            FeatureCollection: function (e, t) {
                this.readChildNodes(e, t)
            }
        }
    },
    write: function (e) {
        return e = this.writeNode("gml:" + (OpenLayers.Util.isArray(e) ? "featureMembers" : "featureMember"), e), this.setAttributeNS(e, this.namespaces.xsi, "xsi:schemaLocation", this.schemaLocation), OpenLayers.Format.XML.prototype.write.apply(this, [e])
    },
    writers: {
        gml: {
            featureMember: function (e) {
                var t = this.createElementNSPlus("gml:featureMember");
                return this.writeNode("feature:_typeName", e, t), t
            }, MultiPoint: function (e) {
                for (var t = this.createElementNSPlus("gml:MultiPoint"), e = e.components || [e], i = 0, n = e.length; n > i; ++i)this.writeNode("pointMember", e[i], t);
                return t
            }, pointMember: function (e) {
                var t = this.createElementNSPlus("gml:pointMember");
                return this.writeNode("Point", e, t), t
            }, MultiLineString: function (e) {
                for (var t = this.createElementNSPlus("gml:MultiLineString"), e = e.components || [e], i = 0, n = e.length; n > i; ++i)this.writeNode("lineStringMember", e[i], t);
                return t
            }, lineStringMember: function (e) {
                var t = this.createElementNSPlus("gml:lineStringMember");
                return this.writeNode("LineString", e, t), t
            }, MultiPolygon: function (e) {
                for (var t = this.createElementNSPlus("gml:MultiPolygon"), e = e.components || [e], i = 0, n = e.length; n > i; ++i)this.writeNode("polygonMember", e[i], t);
                return t
            }, polygonMember: function (e) {
                var t = this.createElementNSPlus("gml:polygonMember");
                return this.writeNode("Polygon", e, t), t
            }, GeometryCollection: function (e) {
                for (var t = this.createElementNSPlus("gml:GeometryCollection"), i = 0, n = e.components.length; n > i; ++i)this.writeNode("geometryMember", e.components[i], t);
                return t
            }, geometryMember: function (e) {
                var t = this.createElementNSPlus("gml:geometryMember"), e = this.writeNode("feature:_geometry", e);
                return t.appendChild(e.firstChild), t
            }
        }, feature: {
            _typeName: function (e) {
                var t = this.createElementNSPlus("feature:" + this.featureType, {attributes: {fid: e.fid}});
                e.geometry && this.writeNode("feature:_geometry", e.geometry, t);
                for (var i in e.attributes) {
                    var n = e.attributes[i];
                    null != n && this.writeNode("feature:_attribute", {name: i, value: n}, t)
                }
                return t
            }, _geometry: function (e) {
                this.externalProjection && this.internalProjection && (e = e.clone().transform(this.internalProjection, this.externalProjection));
                var t = this.createElementNSPlus("feature:" + this.geometryName), e = this.writeNode("gml:" + this.geometryTypes[e.CLASS_NAME], e, t);
                return this.srsName && e.setAttribute("srsName", this.srsName), t
            }, _attribute: function (e) {
                return this.createElementNSPlus("feature:" + e.name, {value: e.value})
            }
        }, wfs: {
            FeatureCollection: function (e) {
                for (var t = this.createElementNSPlus("wfs:FeatureCollection"), i = 0, n = e.length; n > i; ++i)this.writeNode("gml:featureMember", e[i], t);
                return t
            }
        }
    },
    setGeometryTypes: function () {
        this.geometryTypes = {
            "OpenLayers.Geometry.Point": "Point",
            "OpenLayers.Geometry.MultiPoint": "MultiPoint",
            "OpenLayers.Geometry.LineString": "LineString",
            "OpenLayers.Geometry.MultiLineString": "MultiLineString",
            "OpenLayers.Geometry.Polygon": "Polygon",
            "OpenLayers.Geometry.MultiPolygon": "MultiPolygon",
            "OpenLayers.Geometry.Collection": "GeometryCollection"
        }
    },
    CLASS_NAME: "OpenLayers.Format.GML.Base"
}),OpenLayers.Format.GML.v3 = OpenLayers.Class(OpenLayers.Format.GML.Base, {
    schemaLocation: "http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",
    curve: !1,
    multiCurve: !0,
    surface: !1,
    multiSurface: !0,
    initialize: function (e) {
        OpenLayers.Format.GML.Base.prototype.initialize.apply(this, [e])
    },
    readers: {
        gml: OpenLayers.Util.applyDefaults({
            featureMembers: function (e, t) {
                this.readChildNodes(e, t)
            }, Curve: function (e, t) {
                var i = {points: []};
                this.readChildNodes(e, i), t.components || (t.components = []), t.components.push(new OpenLayers.Geometry.LineString(i.points))
            }, segments: function (e, t) {
                this.readChildNodes(e, t)
            }, LineStringSegment: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), i.points && Array.prototype.push.apply(t.points, i.points)
            }, pos: function (e, t) {
                var i = this.getChildValue(e).replace(this.regExes.trimSpace, "").split(this.regExes.splitSpace), i = this.xy ? new OpenLayers.Geometry.Point(i[0], i[1], i[2]) : new OpenLayers.Geometry.Point(i[1], i[0], i[2]);
                t.points = [i]
            }, posList: function (e, t) {
                for (var i, n, s, r = this.getChildValue(e).replace(this.regExes.trimSpace, "").split(this.regExes.splitSpace), a = parseInt(e.getAttribute("dimension")) || 2, o = Array(r.length / a), l = 0, h = r.length; h > l; l += a)i = r[l], n = r[l + 1], s = 2 == a ? void 0 : r[l + 2], o[l / a] = this.xy ? new OpenLayers.Geometry.Point(i, n, s) : new OpenLayers.Geometry.Point(n, i, s);
                t.points = o
            }, Surface: function (e, t) {
                this.readChildNodes(e, t)
            }, patches: function (e, t) {
                this.readChildNodes(e, t)
            }, PolygonPatch: function (e, t) {
                this.readers.gml.Polygon.apply(this, [e, t])
            }, exterior: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), t.outer = i.components[0]
            }, interior: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), t.inner.push(i.components[0])
            }, MultiCurve: function (e, t) {
                var i = {components: []};
                this.readChildNodes(e, i), 0 < i.components.length && (t.components = [new OpenLayers.Geometry.MultiLineString(i.components)])
            }, curveMember: function (e, t) {
                this.readChildNodes(e, t)
            }, MultiSurface: function (e, t) {
                var i = {components: []};
                this.readChildNodes(e, i), 0 < i.components.length && (t.components = [new OpenLayers.Geometry.MultiPolygon(i.components)])
            }, surfaceMember: function (e, t) {
                this.readChildNodes(e, t)
            }, surfaceMembers: function (e, t) {
                this.readChildNodes(e, t)
            }, pointMembers: function (e, t) {
                this.readChildNodes(e, t)
            }, lineStringMembers: function (e, t) {
                this.readChildNodes(e, t)
            }, polygonMembers: function (e, t) {
                this.readChildNodes(e, t)
            }, geometryMembers: function (e, t) {
                this.readChildNodes(e, t)
            }, Envelope: function (e, t) {
                var i = {points: Array(2)};
                this.readChildNodes(e, i), t.components || (t.components = []);
                var n = i.points[0], i = i.points[1];
                t.components.push(new OpenLayers.Bounds(n.x, n.y, i.x, i.y))
            }, lowerCorner: function (e, t) {
                var i = {};
                this.readers.gml.pos.apply(this, [e, i]), t.points[0] = i.points[0]
            }, upperCorner: function (e, t) {
                var i = {};
                this.readers.gml.pos.apply(this, [e, i]), t.points[1] = i.points[0]
            }
        }, OpenLayers.Format.GML.Base.prototype.readers.gml),
        feature: OpenLayers.Format.GML.Base.prototype.readers.feature,
        wfs: OpenLayers.Format.GML.Base.prototype.readers.wfs
    },
    write: function (e) {
        return e = this.writeNode("gml:" + (OpenLayers.Util.isArray(e) ? "featureMembers" : "featureMember"), e), this.setAttributeNS(e, this.namespaces.xsi, "xsi:schemaLocation", this.schemaLocation), OpenLayers.Format.XML.prototype.write.apply(this, [e])
    },
    writers: {
        gml: OpenLayers.Util.applyDefaults({
            featureMembers: function (e) {
                for (var t = this.createElementNSPlus("gml:featureMembers"), i = 0, n = e.length; n > i; ++i)this.writeNode("feature:_typeName", e[i], t);
                return t
            }, Point: function (e) {
                var t = this.createElementNSPlus("gml:Point");
                return this.writeNode("pos", e, t), t
            }, pos: function (e) {
                return this.createElementNSPlus("gml:pos", {value: this.xy ? e.x + " " + e.y : e.y + " " + e.x})
            }, LineString: function (e) {
                var t = this.createElementNSPlus("gml:LineString");
                return this.writeNode("posList", e.components, t), t
            }, Curve: function (e) {
                var t = this.createElementNSPlus("gml:Curve");
                return this.writeNode("segments", e, t), t
            }, segments: function (e) {
                var t = this.createElementNSPlus("gml:segments");
                return this.writeNode("LineStringSegment", e, t), t
            }, LineStringSegment: function (e) {
                var t = this.createElementNSPlus("gml:LineStringSegment");
                return this.writeNode("posList", e.components, t), t
            }, posList: function (e) {
                for (var t, i = e.length, n = Array(i), s = 0; i > s; ++s)t = e[s], n[s] = this.xy ? t.x + " " + t.y : t.y + " " + t.x;
                return this.createElementNSPlus("gml:posList", {value: n.join(" ")})
            }, Surface: function (e) {
                var t = this.createElementNSPlus("gml:Surface");
                return this.writeNode("patches", e, t), t
            }, patches: function (e) {
                var t = this.createElementNSPlus("gml:patches");
                return this.writeNode("PolygonPatch", e, t), t
            }, PolygonPatch: function (e) {
                var t = this.createElementNSPlus("gml:PolygonPatch", {attributes: {interpolation: "planar"}});
                this.writeNode("exterior", e.components[0], t);
                for (var i = 1, n = e.components.length; n > i; ++i)this.writeNode("interior", e.components[i], t);
                return t
            }, Polygon: function (e) {
                var t = this.createElementNSPlus("gml:Polygon");
                this.writeNode("exterior", e.components[0], t);
                for (var i = 1, n = e.components.length; n > i; ++i)this.writeNode("interior", e.components[i], t);
                return t
            }, exterior: function (e) {
                var t = this.createElementNSPlus("gml:exterior");
                return this.writeNode("LinearRing", e, t), t
            }, interior: function (e) {
                var t = this.createElementNSPlus("gml:interior");
                return this.writeNode("LinearRing", e, t), t
            }, LinearRing: function (e) {
                var t = this.createElementNSPlus("gml:LinearRing");
                return this.writeNode("posList", e.components, t), t
            }, MultiCurve: function (e) {
                for (var t = this.createElementNSPlus("gml:MultiCurve"), e = e.components || [e], i = 0, n = e.length; n > i; ++i)this.writeNode("curveMember", e[i], t);
                return t
            }, curveMember: function (e) {
                var t = this.createElementNSPlus("gml:curveMember");
                return this.curve ? this.writeNode("Curve", e, t) : this.writeNode("LineString", e, t), t
            }, MultiSurface: function (e) {
                for (var t = this.createElementNSPlus("gml:MultiSurface"), e = e.components || [e], i = 0, n = e.length; n > i; ++i)this.writeNode("surfaceMember", e[i], t);
                return t
            }, surfaceMember: function (e) {
                var t = this.createElementNSPlus("gml:surfaceMember");
                return this.surface ? this.writeNode("Surface", e, t) : this.writeNode("Polygon", e, t), t
            }, Envelope: function (e) {
                var t = this.createElementNSPlus("gml:Envelope");
                return this.writeNode("lowerCorner", e, t), this.writeNode("upperCorner", e, t), this.srsName && t.setAttribute("srsName", this.srsName), t
            }, lowerCorner: function (e) {
                return this.createElementNSPlus("gml:lowerCorner", {value: this.xy ? e.left + " " + e.bottom : e.bottom + " " + e.left})
            }, upperCorner: function (e) {
                return this.createElementNSPlus("gml:upperCorner", {value: this.xy ? e.right + " " + e.top : e.top + " " + e.right})
            }
        }, OpenLayers.Format.GML.Base.prototype.writers.gml),
        feature: OpenLayers.Format.GML.Base.prototype.writers.feature,
        wfs: OpenLayers.Format.GML.Base.prototype.writers.wfs
    },
    setGeometryTypes: function () {
        this.geometryTypes = {
            "OpenLayers.Geometry.Point": "Point",
            "OpenLayers.Geometry.MultiPoint": "MultiPoint",
            "OpenLayers.Geometry.LineString": !0 === this.curve ? "Curve" : "LineString",
            "OpenLayers.Geometry.MultiLineString": !1 === this.multiCurve ? "MultiLineString" : "MultiCurve",
            "OpenLayers.Geometry.Polygon": !0 === this.surface ? "Surface" : "Polygon",
            "OpenLayers.Geometry.MultiPolygon": !1 === this.multiSurface ? "MultiPolygon" : "MultiSurface",
            "OpenLayers.Geometry.Collection": "GeometryCollection"
        }
    },
    CLASS_NAME: "OpenLayers.Format.GML.v3"
}),OpenLayers.Format.Filter.v1_1_0 = OpenLayers.Class(OpenLayers.Format.GML.v3, OpenLayers.Format.Filter.v1, {
    VERSION: "1.1.0",
    schemaLocation: "http://www.opengis.net/ogc/filter/1.1.0/filter.xsd",
    initialize: function (e) {
        OpenLayers.Format.GML.v3.prototype.initialize.apply(this, [e])
    },
    readers: {
        ogc: OpenLayers.Util.applyDefaults({
            PropertyIsEqualTo: function (e, t) {
                var i = e.getAttribute("matchCase"), i = new OpenLayers.Filter.Comparison({
                    type: OpenLayers.Filter.Comparison.EQUAL_TO,
                    matchCase: !("false" === i || "0" === i)
                });
                this.readChildNodes(e, i), t.filters.push(i)
            }, PropertyIsNotEqualTo: function (e, t) {
                var i = e.getAttribute("matchCase"), i = new OpenLayers.Filter.Comparison({
                    type: OpenLayers.Filter.Comparison.NOT_EQUAL_TO,
                    matchCase: !("false" === i || "0" === i)
                });
                this.readChildNodes(e, i), t.filters.push(i)
            }, PropertyIsLike: function (e, t) {
                var i = new OpenLayers.Filter.Comparison({type: OpenLayers.Filter.Comparison.LIKE});
                this.readChildNodes(e, i);
                var n = e.getAttribute("wildCard"), s = e.getAttribute("singleChar"), r = e.getAttribute("escapeChar");
                i.value2regex(n, s, r), t.filters.push(i)
            }
        }, OpenLayers.Format.Filter.v1.prototype.readers.ogc),
        gml: OpenLayers.Format.GML.v3.prototype.readers.gml,
        feature: OpenLayers.Format.GML.v3.prototype.readers.feature
    },
    writers: {
        ogc: OpenLayers.Util.applyDefaults({
            PropertyIsEqualTo: function (e) {
                var t = this.createElementNSPlus("ogc:PropertyIsEqualTo", {attributes: {matchCase: e.matchCase}});
                return this.writeNode("PropertyName", e, t), this.writeOgcExpression(e.value, t), t
            }, PropertyIsNotEqualTo: function (e) {
                var t = this.createElementNSPlus("ogc:PropertyIsNotEqualTo", {attributes: {matchCase: e.matchCase}});
                return this.writeNode("PropertyName", e, t), this.writeOgcExpression(e.value, t), t
            }, PropertyIsLike: function (e) {
                var t = this.createElementNSPlus("ogc:PropertyIsLike", {
                    attributes: {
                        matchCase: e.matchCase,
                        wildCard: "*",
                        singleChar: ".",
                        escapeChar: "!"
                    }
                });
                return this.writeNode("PropertyName", e, t), this.writeNode("Literal", e.regex2value(), t), t
            }, BBOX: function (e) {
                var t = this.createElementNSPlus("ogc:BBOX");
                e.property && this.writeNode("PropertyName", e, t);
                var i = this.writeNode("gml:Envelope", e.value);
                return e.projection && i.setAttribute("srsName", e.projection), t.appendChild(i), t
            }, SortBy: function (e) {
                for (var t = this.createElementNSPlus("ogc:SortBy"), i = 0, n = e.length; n > i; i++)this.writeNode("ogc:SortProperty", e[i], t);
                return t
            }, SortProperty: function (e) {
                var t = this.createElementNSPlus("ogc:SortProperty");
                return this.writeNode("ogc:PropertyName", e, t), this.writeNode("ogc:SortOrder", "DESC" == e.order ? "DESC" : "ASC", t), t
            }, SortOrder: function (e) {
                return this.createElementNSPlus("ogc:SortOrder", {value: e})
            }
        }, OpenLayers.Format.Filter.v1.prototype.writers.ogc),
        gml: OpenLayers.Format.GML.v3.prototype.writers.gml,
        feature: OpenLayers.Format.GML.v3.prototype.writers.feature
    },
    writeSpatial: function (e, t) {
        var i = this.createElementNSPlus("ogc:" + t);
        if (this.writeNode("PropertyName", e, i), e.value instanceof OpenLayers.Filter.Function) this.writeNode("Function", e.value, i); else {
            var n;
            n = e.value instanceof OpenLayers.Geometry ? this.writeNode("feature:_geometry", e.value).firstChild : this.writeNode("gml:Envelope", e.value), e.projection && n.setAttribute("srsName", e.projection), i.appendChild(n)
        }
        return i
    },
    CLASS_NAME: "OpenLayers.Format.Filter.v1_1_0"
}),OpenLayers.Format.OWSCommon = OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC, {
    defaultVersion: "1.0.0",
    getVersion: function (e) {
        var t = this.version;
        return t || ((e = e.getAttribute("xmlns:ows")) && "1.1" === e.substring(e.lastIndexOf("/") + 1) && (t = "1.1.0"), t || (t = this.defaultVersion)), t
    },
    CLASS_NAME: "OpenLayers.Format.OWSCommon"
}),OpenLayers.Format.OWSCommon.v1 = OpenLayers.Class(OpenLayers.Format.XML, {
    regExes: {
        trimSpace: /^\s*|\s*$/g,
        removeSpace: /\s*/g,
        splitSpace: /\s+/,
        trimComma: /\s*,\s*/g
    }, read: function (e, t) {
        OpenLayers.Util.applyDefaults(t, this.options);
        var i = {};
        return this.readChildNodes(e, i), i
    }, readers: {
        ows: {
            Exception: function (e, t) {
                var i = {code: e.getAttribute("exceptionCode"), locator: e.getAttribute("locator"), texts: []};
                t.exceptions.push(i), this.readChildNodes(e, i)
            }, ExceptionText: function (e, t) {
                var i = this.getChildValue(e);
                t.texts.push(i)
            }, ServiceIdentification: function (e, t) {
                t.serviceIdentification = {}, this.readChildNodes(e, t.serviceIdentification)
            }, Title: function (e, t) {
                t.title = this.getChildValue(e)
            }, Abstract: function (e, t) {
                t["abstract"] = this.getChildValue(e)
            }, Keywords: function (e, t) {
                t.keywords = {}, this.readChildNodes(e, t.keywords)
            }, Keyword: function (e, t) {
                t[this.getChildValue(e)] = !0
            }, ServiceType: function (e, t) {
                t.serviceType = {codeSpace: e.getAttribute("codeSpace"), value: this.getChildValue(e)}
            }, ServiceTypeVersion: function (e, t) {
                t.serviceTypeVersion = this.getChildValue(e)
            }, Fees: function (e, t) {
                t.fees = this.getChildValue(e)
            }, AccessConstraints: function (e, t) {
                t.accessConstraints = this.getChildValue(e)
            }, ServiceProvider: function (e, t) {
                t.serviceProvider = {}, this.readChildNodes(e, t.serviceProvider)
            }, ProviderName: function (e, t) {
                t.providerName = this.getChildValue(e)
            }, ProviderSite: function (e, t) {
                t.providerSite = this.getAttributeNS(e, this.namespaces.xlink, "href")
            }, ServiceContact: function (e, t) {
                t.serviceContact = {}, this.readChildNodes(e, t.serviceContact)
            }, IndividualName: function (e, t) {
                t.individualName = this.getChildValue(e)
            }, PositionName: function (e, t) {
                t.positionName = this.getChildValue(e)
            }, ContactInfo: function (e, t) {
                t.contactInfo = {}, this.readChildNodes(e, t.contactInfo)
            }, Phone: function (e, t) {
                t.phone = {}, this.readChildNodes(e, t.phone)
            }, Voice: function (e, t) {
                t.voice = this.getChildValue(e)
            }, Address: function (e, t) {
                t.address = {}, this.readChildNodes(e, t.address)
            }, DeliveryPoint: function (e, t) {
                t.deliveryPoint = this.getChildValue(e)
            }, City: function (e, t) {
                t.city = this.getChildValue(e)
            }, AdministrativeArea: function (e, t) {
                t.administrativeArea = this.getChildValue(e)
            }, PostalCode: function (e, t) {
                t.postalCode = this.getChildValue(e)
            }, Country: function (e, t) {
                t.country = this.getChildValue(e)
            }, ElectronicMailAddress: function (e, t) {
                t.electronicMailAddress = this.getChildValue(e)
            }, Role: function (e, t) {
                t.role = this.getChildValue(e)
            }, OperationsMetadata: function (e, t) {
                t.operationsMetadata = {}, this.readChildNodes(e, t.operationsMetadata)
            }, Operation: function (e, t) {
                var i = e.getAttribute("name");
                t[i] = {}, this.readChildNodes(e, t[i])
            }, DCP: function (e, t) {
                t.dcp = {}, this.readChildNodes(e, t.dcp)
            }, HTTP: function (e, t) {
                t.http = {}, this.readChildNodes(e, t.http)
            }, Get: function (e, t) {
                t.get || (t.get = []);
                var i = {url: this.getAttributeNS(e, this.namespaces.xlink, "href")};
                this.readChildNodes(e, i), t.get.push(i)
            }, Post: function (e, t) {
                t.post || (t.post = []);
                var i = {url: this.getAttributeNS(e, this.namespaces.xlink, "href")};
                this.readChildNodes(e, i), t.post.push(i)
            }, Parameter: function (e, t) {
                t.parameters || (t.parameters = {});
                var i = e.getAttribute("name");
                t.parameters[i] = {}, this.readChildNodes(e, t.parameters[i])
            }, Constraint: function (e, t) {
                t.constraints || (t.constraints = {});
                var i = e.getAttribute("name");
                t.constraints[i] = {}, this.readChildNodes(e, t.constraints[i])
            }, Value: function (e, t) {
                t[this.getChildValue(e)] = !0
            }, OutputFormat: function (e, t) {
                t.formats.push({value: this.getChildValue(e)}), this.readChildNodes(e, t)
            }, WGS84BoundingBox: function (e, t) {
                var i = {};
                i.crs = e.getAttribute("crs"), t.BoundingBox ? t.BoundingBox.push(i) : (t.projection = i.crs, i = t), this.readChildNodes(e, i)
            }, BoundingBox: function (e, t) {
                this.readers.ows.WGS84BoundingBox.apply(this, [e, t])
            }, LowerCorner: function (e, t) {
                var i = this.getChildValue(e).replace(this.regExes.trimSpace, ""), i = i.replace(this.regExes.trimComma, ","), i = i.split(this.regExes.splitSpace);
                t.left = i[0], t.bottom = i[1]
            }, UpperCorner: function (e, t) {
                var i = this.getChildValue(e).replace(this.regExes.trimSpace, ""), i = i.replace(this.regExes.trimComma, ","), i = i.split(this.regExes.splitSpace);
                t.right = i[0], t.top = i[1], t.bounds = new OpenLayers.Bounds(t.left, t.bottom, t.right, t.top), delete t.left, delete t.bottom, delete t.right, delete t.top
            }, Language: function (e, t) {
                t.language = this.getChildValue(e)
            }
        }
    }, writers: {
        ows: {
            BoundingBox: function (e) {
                var t = this.createElementNSPlus("ows:BoundingBox", {attributes: {crs: e.projection}});
                return this.writeNode("ows:LowerCorner", e, t), this.writeNode("ows:UpperCorner", e, t), t
            }, LowerCorner: function (e) {
                return this.createElementNSPlus("ows:LowerCorner", {value: e.bounds.left + " " + e.bounds.bottom})
            }, UpperCorner: function (e) {
                return this.createElementNSPlus("ows:UpperCorner", {value: e.bounds.right + " " + e.bounds.top})
            }, Identifier: function (e) {
                return this.createElementNSPlus("ows:Identifier", {value: e})
            }, Title: function (e) {
                return this.createElementNSPlus("ows:Title", {value: e})
            }, Abstract: function (e) {
                return this.createElementNSPlus("ows:Abstract", {value: e})
            }, OutputFormat: function (e) {
                return this.createElementNSPlus("ows:OutputFormat", {value: e})
            }
        }
    }, CLASS_NAME: "OpenLayers.Format.OWSCommon.v1"
}),OpenLayers.Format.OWSCommon.v1_0_0 = OpenLayers.Class(OpenLayers.Format.OWSCommon.v1, {
    namespaces: {
        ows: "http://www.opengis.net/ows",
        xlink: "http://www.w3.org/1999/xlink"
    },
    readers: {
        ows: OpenLayers.Util.applyDefaults({
            ExceptionReport: function (e, t) {
                t.success = !1, t.exceptionReport = {
                    version: e.getAttribute("version"),
                    language: e.getAttribute("language"),
                    exceptions: []
                }, this.readChildNodes(e, t.exceptionReport)
            }
        }, OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)
    },
    writers: {ows: OpenLayers.Format.OWSCommon.v1.prototype.writers.ows},
    CLASS_NAME: "OpenLayers.Format.OWSCommon.v1_0_0"
}),OpenLayers.Format.WFST.v1_1_0 = OpenLayers.Class(OpenLayers.Format.Filter.v1_1_0, OpenLayers.Format.WFST.v1, {
    version: "1.1.0",
    schemaLocations: {wfs: "http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"},
    initialize: function (e) {
        OpenLayers.Format.Filter.v1_1_0.prototype.initialize.apply(this, [e]), OpenLayers.Format.WFST.v1.prototype.initialize.apply(this, [e])
    },
    readNode: function (e, t) {
        return OpenLayers.Format.GML.v3.prototype.readNode.apply(this, [e, t])
    },
    readers: {
        wfs: OpenLayers.Util.applyDefaults({
            FeatureCollection: function (e, t) {
                t.numberOfFeatures = parseInt(e.getAttribute("numberOfFeatures")), OpenLayers.Format.WFST.v1.prototype.readers.wfs.FeatureCollection.apply(this, arguments)
            }, TransactionResponse: function (e, t) {
                t.insertIds = [], t.success = !1, this.readChildNodes(e, t)
            }, TransactionSummary: function (e, t) {
                t.success = !0
            }, InsertResults: function (e, t) {
                this.readChildNodes(e, t)
            }, Feature: function (e, t) {
                var i = {fids: []};
                this.readChildNodes(e, i), t.insertIds.push(i.fids[0])
            }
        }, OpenLayers.Format.WFST.v1.prototype.readers.wfs),
        gml: OpenLayers.Format.GML.v3.prototype.readers.gml,
        feature: OpenLayers.Format.GML.v3.prototype.readers.feature,
        ogc: OpenLayers.Format.Filter.v1_1_0.prototype.readers.ogc,
        ows: OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows
    },
    writers: {
        wfs: OpenLayers.Util.applyDefaults({
            GetFeature: function (e) {
                var t = OpenLayers.Format.WFST.v1.prototype.writers.wfs.GetFeature.apply(this, arguments);
                return e && this.setAttributes(t, {
                    resultType: e.resultType,
                    startIndex: e.startIndex,
                    count: e.count
                }), t
            }, Query: function (e) {
                var e = OpenLayers.Util.extend({
                    featureNS: this.featureNS,
                    featurePrefix: this.featurePrefix,
                    featureType: this.featureType,
                    srsName: this.srsName
                }, e), t = e.featurePrefix, i = this.createElementNSPlus("wfs:Query", {
                    attributes: {
                        typeName: (t ? t + ":" : "") + e.featureType,
                        srsName: e.srsName
                    }
                });
                if (e.featureNS && i.setAttribute("xmlns:" + t, e.featureNS), e.propertyNames)for (var t = 0, n = e.propertyNames.length; n > t; t++)this.writeNode("wfs:PropertyName", {property: e.propertyNames[t]}, i);
                return e.filter && (OpenLayers.Format.WFST.v1_1_0.prototype.setFilterProperty.call(this, e.filter), this.writeNode("ogc:Filter", e.filter, i)), i
            }, PropertyName: function (e) {
                return this.createElementNSPlus("wfs:PropertyName", {value: e.property})
            }
        }, OpenLayers.Format.WFST.v1.prototype.writers.wfs),
        gml: OpenLayers.Format.GML.v3.prototype.writers.gml,
        feature: OpenLayers.Format.GML.v3.prototype.writers.feature,
        ogc: OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc
    },
    CLASS_NAME: "OpenLayers.Format.WFST.v1_1_0"
}),OpenLayers.Protocol = OpenLayers.Class({
    format: null,
    options: null,
    autoDestroy: !0,
    defaultFilter: null,
    initialize: function (e) {
        e = e || {}, OpenLayers.Util.extend(this, e), this.options = e
    },
    mergeWithDefaultFilter: function (e) {
        return e && this.defaultFilter ? new OpenLayers.Filter.Logical({
            type: OpenLayers.Filter.Logical.AND,
            filters: [this.defaultFilter, e]
        }) : e || this.defaultFilter || void 0
    },
    destroy: function () {
        this.format = this.options = null
    },
    read: function (e) {
        e = e || {}, e.filter = this.mergeWithDefaultFilter(e.filter)
    },
    create: function () {
    },
    update: function () {
    },
    "delete": function () {
    },
    commit: function () {
    },
    abort: function () {
    },
    createCallback: function (e, t, i) {
        return OpenLayers.Function.bind(function () {
            e.apply(this, [t, i])
        }, this)
    },
    CLASS_NAME: "OpenLayers.Protocol"
}),OpenLayers.Protocol.Response = OpenLayers.Class({
    code: null,
    requestType: null,
    last: !0,
    features: null,
    data: null,
    reqFeatures: null,
    priv: null,
    error: null,
    initialize: function (e) {
        OpenLayers.Util.extend(this, e)
    },
    success: function () {
        return 0 < this.code
    },
    CLASS_NAME: "OpenLayers.Protocol.Response"
}),OpenLayers.Protocol.Response.SUCCESS = 1,OpenLayers.Protocol.Response.FAILURE = 0,OpenLayers.Format.JSON = OpenLayers.Class(OpenLayers.Format, {
    indent: "    ",
    space: " ",
    newline: "\n",
    level: 0,
    pretty: !1,
    nativeJSON: function () {
        return !(!window.JSON || "function" != typeof JSON.parse || "function" != typeof JSON.stringify)
    }(),
    read: function (a, b) {
        var c;
        if (this.nativeJSON) c = JSON.parse(a, b); else try {
            if (/^[\],:{}\s]*$/.test(a.replace(/\\["\\\/bfnrtu]/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, "")) && (c = eval("(" + a + ")"), "function" == typeof b)) {
                var d = function (e, t) {
                    if (t && "object" == typeof t)for (var i in t)t.hasOwnProperty(i) && (t[i] = d(i, t[i]));
                    return b(e, t)
                };
                c = d("", c)
            }
        } catch (e) {
        }
        return this.keepData && (this.data = c), c
    },
    write: function (e, t) {
        this.pretty = !!t;
        var i = null, n = typeof e;
        if (this.serialize[n])try {
            i = !this.pretty && this.nativeJSON ? JSON.stringify(e) : this.serialize[n].apply(this, [e])
        } catch (s) {
            OpenLayers.Console.error("Trouble serializing: " + s)
        }
        return i
    },
    writeIndent: function () {
        var e = [];
        if (this.pretty)for (var t = 0; t < this.level; ++t)e.push(this.indent);
        return e.join("")
    },
    writeNewline: function () {
        return this.pretty ? this.newline : ""
    },
    writeSpace: function () {
        return this.pretty ? this.space : ""
    },
    serialize: {
        object: function (e) {
            if (null == e)return "null";
            if (e.constructor == Date)return this.serialize.date.apply(this, [e]);
            if (e.constructor == Array)return this.serialize.array.apply(this, [e]);
            var t = ["{"];
            this.level += 1;
            var i, n, s, r = !1;
            for (i in e)e.hasOwnProperty(i) && (n = OpenLayers.Format.JSON.prototype.write.apply(this, [i, this.pretty]), s = OpenLayers.Format.JSON.prototype.write.apply(this, [e[i], this.pretty]), null != n && null != s && (r && t.push(","), t.push(this.writeNewline(), this.writeIndent(), n, ":", this.writeSpace(), s), r = !0));
            return this.level -= 1, t.push(this.writeNewline(), this.writeIndent(), "}"), t.join("")
        }, array: function (e) {
            var t, i = ["["];
            this.level += 1;
            for (var n = 0, s = e.length; s > n; ++n)t = OpenLayers.Format.JSON.prototype.write.apply(this, [e[n], this.pretty]), null != t && (n > 0 && i.push(","), i.push(this.writeNewline(), this.writeIndent(), t));
            return this.level -= 1, i.push(this.writeNewline(), this.writeIndent(), "]"), i.join("")
        }, string: function (e) {
            var t = {"\b": "\\b", "	": "\\t", "\n": "\\n", "\f": "\\f", "\r": "\\r", '"': '\\"', "\\": "\\\\"};
            return /["\\\x00-\x1f]/.test(e) ? '"' + e.replace(/([\x00-\x1f\\"])/g, function (e, i) {
                var n = t[i];
                return n ? n : (n = i.charCodeAt(), "\\u00" + Math.floor(n / 16).toString(16) + (n % 16).toString(16))
            }) + '"' : '"' + e + '"'
        }, number: function (e) {
            return isFinite(e) ? "" + e : "null"
        }, "boolean": function (e) {
            return "" + e
        }, date: function (e) {
            function t(e) {
                return 10 > e ? "0" + e : e
            }

            return '"' + e.getFullYear() + "-" + t(e.getMonth() + 1) + "-" + t(e.getDate()) + "T" + t(e.getHours()) + ":" + t(e.getMinutes()) + ":" + t(e.getSeconds()) + '"'
        }
    },
    CLASS_NAME: "OpenLayers.Format.JSON"
}),OpenLayers.Format.GeoJSON = OpenLayers.Class(OpenLayers.Format.JSON, {
    ignoreExtraDims: !1, read: function (e, t, i) {
        var t = t ? t : "FeatureCollection", n = null, s = null;
        if (s = "string" == typeof e ? OpenLayers.Format.JSON.prototype.read.apply(this, [e, i]) : e) {
            if ("string" != typeof s.type) OpenLayers.Console.error("Bad GeoJSON - no type: " + e); else if (this.isValidType(s, t))switch (t) {
                case"Geometry":
                    try {
                        n = this.parseGeometry(s)
                    } catch (r) {
                        OpenLayers.Console.error(r)
                    }
                    break;
                case"Feature":
                    try {
                        n = this.parseFeature(s), n.type = "Feature"
                    } catch (a) {
                        OpenLayers.Console.error(a)
                    }
                    break;
                case"FeatureCollection":
                    switch (n = [], s.type) {
                        case"Feature":
                            try {
                                n.push(this.parseFeature(s))
                            } catch (o) {
                                n = null, OpenLayers.Console.error(o)
                            }
                            break;
                        case"FeatureCollection":
                            for (e = 0, t = s.features.length; t > e; ++e)try {
                                n.push(this.parseFeature(s.features[e]))
                            } catch (l) {
                                n = null, OpenLayers.Console.error(l)
                            }
                            break;
                        default:
                            try {
                                var h = this.parseGeometry(s);
                                n.push(new OpenLayers.Feature.Vector(h))
                            } catch (u) {
                                n = null, OpenLayers.Console.error(u)
                            }
                    }
            }
        } else OpenLayers.Console.error("Bad JSON: " + e);
        return n
    }, isValidType: function (e, t) {
        var i = !1;
        switch (t) {
            case"Geometry":
                -1 == OpenLayers.Util.indexOf("Point MultiPoint LineString MultiLineString Polygon MultiPolygon Box GeometryCollection".split(" "), e.type) ? OpenLayers.Console.error("Unsupported geometry type: " + e.type) : i = !0;
                break;
            case"FeatureCollection":
                i = !0;
                break;
            default:
                e.type == t ? i = !0 : OpenLayers.Console.error("Cannot convert types from " + e.type + " to " + t)
        }
        return i
    }, parseFeature: function (e) {
        var t, i, n;
        i = e.properties ? e.properties : {}, n = e.geometry && e.geometry.bbox || e.bbox;
        try {
            t = this.parseGeometry(e.geometry)
        } catch (s) {
            throw s
        }
        return t = new OpenLayers.Feature.Vector(t, i), n && (t.bounds = OpenLayers.Bounds.fromArray(n)), e.id && (t.fid = e.id), t
    }, parseGeometry: function (e) {
        if (null == e)return null;
        var t, i = !1;
        if ("GeometryCollection" == e.type) {
            if (!OpenLayers.Util.isArray(e.geometries))throw"GeometryCollection must have geometries array: " + e;
            t = e.geometries.length;
            for (var i = Array(t), n = 0; t > n; ++n)i[n] = this.parseGeometry.apply(this, [e.geometries[n]]);
            t = new OpenLayers.Geometry.Collection(i), i = !0
        } else {
            if (!OpenLayers.Util.isArray(e.coordinates))throw"Geometry must have coordinates array: " + e;
            if (!this.parseCoords[e.type.toLowerCase()])throw"Unsupported geometry type: " + e.type;
            try {
                t = this.parseCoords[e.type.toLowerCase()].apply(this, [e.coordinates])
            } catch (s) {
                throw s
            }
        }
        return this.internalProjection && this.externalProjection && !i && t.transform(this.externalProjection, this.internalProjection), t
    }, parseCoords: {
        point: function (e) {
            if (0 == this.ignoreExtraDims && 2 != e.length)throw"Only 2D points are supported: " + e;
            return new OpenLayers.Geometry.Point(e[0], e[1])
        }, multipoint: function (e) {
            for (var t = [], i = null, n = 0, s = e.length; s > n; ++n) {
                try {
                    i = this.parseCoords.point.apply(this, [e[n]])
                } catch (r) {
                    throw r
                }
                t.push(i)
            }
            return new OpenLayers.Geometry.MultiPoint(t)
        }, linestring: function (e) {
            for (var t = [], i = null, n = 0, s = e.length; s > n; ++n) {
                try {
                    i = this.parseCoords.point.apply(this, [e[n]])
                } catch (r) {
                    throw r
                }
                t.push(i)
            }
            return new OpenLayers.Geometry.LineString(t)
        }, multilinestring: function (e) {
            for (var t = [], i = null, n = 0, s = e.length; s > n; ++n) {
                try {
                    i = this.parseCoords.linestring.apply(this, [e[n]])
                } catch (r) {
                    throw r
                }
                t.push(i)
            }
            return new OpenLayers.Geometry.MultiLineString(t)
        }, polygon: function (e) {
            for (var t, i, n = [], s = 0, r = e.length; r > s; ++s) {
                try {
                    i = this.parseCoords.linestring.apply(this, [e[s]])
                } catch (a) {
                    throw a
                }
                t = new OpenLayers.Geometry.LinearRing(i.components), n.push(t)
            }
            return new OpenLayers.Geometry.Polygon(n)
        }, multipolygon: function (e) {
            for (var t = [], i = null, n = 0, s = e.length; s > n; ++n) {
                try {
                    i = this.parseCoords.polygon.apply(this, [e[n]])
                } catch (r) {
                    throw r
                }
                t.push(i)
            }
            return new OpenLayers.Geometry.MultiPolygon(t)
        }, box: function (e) {
            if (2 != e.length)throw"GeoJSON box coordinates must have 2 elements";
            return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(e[0][0], e[0][1]), new OpenLayers.Geometry.Point(e[1][0], e[0][1]), new OpenLayers.Geometry.Point(e[1][0], e[1][1]), new OpenLayers.Geometry.Point(e[0][0], e[1][1]), new OpenLayers.Geometry.Point(e[0][0], e[0][1])])])
        }
    }, write: function (e, t) {
        var i = {type: null};
        if (OpenLayers.Util.isArray(e)) {
            i.type = "FeatureCollection";
            var n = e.length;
            i.features = Array(n);
            for (var s = 0; n > s; ++s) {
                var r = e[s];
                if (!r instanceof OpenLayers.Feature.Vector)throw"FeatureCollection only supports collections of features: " + r;
                i.features[s] = this.extract.feature.apply(this, [r])
            }
        } else 0 == e.CLASS_NAME.indexOf("OpenLayers.Geometry") ? i = this.extract.geometry.apply(this, [e]) : e instanceof OpenLayers.Feature.Vector && (i = this.extract.feature.apply(this, [e]), e.layer && e.layer.projection && (i.crs = this.createCRSObject(e)));
        return OpenLayers.Format.JSON.prototype.write.apply(this, [i, t])
    }, createCRSObject: function (e) {
        var e = e.layer.projection.toString(), t = {};
        return e.match(/epsg:/i) && (e = parseInt(e.substring(e.indexOf(":") + 1)), t = 4326 == e ? {
            type: "name",
            properties: {name: "urn:ogc:def:crs:OGC:1.3:CRS84"}
        } : {type: "name", properties: {name: "EPSG:" + e}}), t
    }, extract: {
        feature: function (e) {
            var t = this.extract.geometry.apply(this, [e.geometry]), t = {
                type: "Feature",
                properties: e.attributes,
                geometry: t
            };
            return null != e.fid && (t.id = e.fid), t
        }, geometry: function (e) {
            if (null == e)return null;
            this.internalProjection && this.externalProjection && (e = e.clone(), e.transform(this.internalProjection, this.externalProjection));
            var t = e.CLASS_NAME.split(".")[2], e = this.extract[t.toLowerCase()].apply(this, [e]);
            return "Collection" == t ? {type: "GeometryCollection", geometries: e} : {type: t, coordinates: e}
        }, point: function (e) {
            return [e.x, e.y]
        }, multipoint: function (e) {
            for (var t = [], i = 0, n = e.components.length; n > i; ++i)t.push(this.extract.point.apply(this, [e.components[i]]));
            return t
        }, linestring: function (e) {
            for (var t = [], i = 0, n = e.components.length; n > i; ++i)t.push(this.extract.point.apply(this, [e.components[i]]));
            return t
        }, multilinestring: function (e) {
            for (var t = [], i = 0, n = e.components.length; n > i; ++i)t.push(this.extract.linestring.apply(this, [e.components[i]]));
            return t
        }, polygon: function (e) {
            for (var t = [], i = 0, n = e.components.length; n > i; ++i)t.push(this.extract.linestring.apply(this, [e.components[i]]));
            return t
        }, multipolygon: function (e) {
            for (var t = [], i = 0, n = e.components.length; n > i; ++i)t.push(this.extract.polygon.apply(this, [e.components[i]]));
            return t
        }, collection: function (e) {
            for (var t = e.components.length, i = Array(t), n = 0; t > n; ++n)i[n] = this.extract.geometry.apply(this, [e.components[n]]);
            return i
        }
    }, CLASS_NAME: "OpenLayers.Format.GeoJSON"
}),OpenLayers.Protocol.Script = OpenLayers.Class(OpenLayers.Protocol, {
    url: null,
    params: null,
    callback: null,
    callbackTemplate: "OpenLayers.Protocol.Script.registry.${id}",
    callbackKey: "callback",
    callbackPrefix: "",
    scope: null,
    format: null,
    pendingRequests: null,
    srsInBBOX: !1,
    initialize: function (e) {
        if (e = e || {}, this.params = {}, this.pendingRequests = {}, OpenLayers.Protocol.prototype.initialize.apply(this, arguments), this.format || (this.format = new OpenLayers.Format.GeoJSON), !this.filterToParams && OpenLayers.Format.QueryStringFilter) {
            var t = new OpenLayers.Format.QueryStringFilter({srsInBBOX: this.srsInBBOX});
            this.filterToParams = function (e, i) {
                return t.write(e, i)
            }
        }
    },
    read: function (e) {
        OpenLayers.Protocol.prototype.read.apply(this, arguments), e = OpenLayers.Util.applyDefaults(e, this.options), e.params = OpenLayers.Util.applyDefaults(e.params, this.options.params), e.filter && this.filterToParams && (e.params = this.filterToParams(e.filter, e.params));
        var t = new OpenLayers.Protocol.Response({requestType: "read"}), i = this.createRequest(e.url, e.params, OpenLayers.Function.bind(function (i) {
            t.data = i, this.handleRead(t, e)
        }, this));
        return t.priv = i, t
    },
    createRequest: function (e, t, i) {
        var i = OpenLayers.Protocol.Script.register(i), n = OpenLayers.String.format(this.callbackTemplate, {id: i}), t = OpenLayers.Util.extend({}, t);
        return t[this.callbackKey] = this.callbackPrefix + n, e = OpenLayers.Util.urlAppend(e, OpenLayers.Util.getParameterString(t)), t = document.createElement("script"), t.type = "text/javascript", t.src = e, t.id = "OpenLayers_Protocol_Script_" + i, this.pendingRequests[t.id] = t, document.getElementsByTagName("head")[0].appendChild(t), t
    },
    destroyRequest: function (e) {
        OpenLayers.Protocol.Script.unregister(e.id.split("_").pop()), delete this.pendingRequests[e.id], e.parentNode && e.parentNode.removeChild(e)
    },
    handleRead: function (e, t) {
        this.handleResponse(e, t)
    },
    handleResponse: function (e, t) {
        t.callback && (e.data ? (e.features = this.parseFeatures(e.data), e.code = OpenLayers.Protocol.Response.SUCCESS) : e.code = OpenLayers.Protocol.Response.FAILURE, this.destroyRequest(e.priv), t.callback.call(t.scope, e))
    },
    parseFeatures: function (e) {
        return this.format.read(e)
    },
    abort: function (e) {
        if (e) this.destroyRequest(e.priv); else for (var t in this.pendingRequests)this.destroyRequest(this.pendingRequests[t])
    },
    destroy: function () {
        this.abort(), delete this.params, delete this.format, OpenLayers.Protocol.prototype.destroy.apply(this)
    },
    CLASS_NAME: "OpenLayers.Protocol.Script"
}),function () {
    var e = OpenLayers.Protocol.Script, t = 0;
    e.registry = {}, e.register = function (i) {
        var n = "c" + ++t;
        return e.registry[n] = function () {
            i.apply(this, arguments)
        }, n
    }, e.unregister = function (t) {
        delete e.registry[t]
    }
}(),OpenLayers.Control.Panel = OpenLayers.Class(OpenLayers.Control, {
    controls: null,
    autoActivate: !0,
    defaultControl: null,
    saveState: !1,
    allowDepress: !1,
    activeState: null,
    initialize: function (e) {
        OpenLayers.Control.prototype.initialize.apply(this, [e]), this.controls = [], this.activeState = {}
    },
    destroy: function () {
        this.map && this.map.events.unregister("buttonclick", this, this.onButtonClick), OpenLayers.Control.prototype.destroy.apply(this, arguments);
        for (var e, t = this.controls.length - 1; t >= 0; t--)e = this.controls[t], e.events && e.events.un({
            activate: this.iconOn,
            deactivate: this.iconOff
        }), e.panel_div = null;
        this.activeState = null
    },
    activate: function () {
        if (OpenLayers.Control.prototype.activate.apply(this, arguments)) {
            for (var e, t = 0, i = this.controls.length; i > t; t++)e = this.controls[t], (e === this.defaultControl || this.saveState && this.activeState[e.id]) && e.activate();
            return !0 === this.saveState && (this.defaultControl = null), this.redraw(), !0
        }
        return !1
    },
    deactivate: function () {
        if (OpenLayers.Control.prototype.deactivate.apply(this, arguments)) {
            for (var e, t = 0, i = this.controls.length; i > t; t++)e = this.controls[t], this.activeState[e.id] = e.deactivate();
            return this.redraw(), !0
        }
        return !1
    },
    draw: function () {
        return OpenLayers.Control.prototype.draw.apply(this, arguments), this.outsideViewport ? (this.events.attachToElement(this.div), this.events.register("buttonclick", this, this.onButtonClick)) : this.map.events.register("buttonclick", this, this.onButtonClick), this.addControlsToMap(this.controls), this.div
    },
    redraw: function () {
        for (var e = this.div.childNodes.length - 1; e >= 0; e--)this.div.removeChild(this.div.childNodes[e]);
        if (this.div.innerHTML = "", this.active)for (var e = 0, t = this.controls.length; t > e; e++)this.div.appendChild(this.controls[e].panel_div)
    },
    activateControl: function (e) {
        if (!this.active)return !1;
        if (e.type == OpenLayers.Control.TYPE_BUTTON) e.trigger(); else if (e.type == OpenLayers.Control.TYPE_TOGGLE) e.active ? e.deactivate() : e.activate(); else if (this.allowDepress && e.active) e.deactivate(); else {
            for (var t, i = 0, n = this.controls.length; n > i; i++)t = this.controls[i], t != e && (t.type === OpenLayers.Control.TYPE_TOOL || null == t.type) && t.deactivate();
            e.activate()
        }
    },
    addControls: function (e) {
        OpenLayers.Util.isArray(e) || (e = [e]), this.controls = this.controls.concat(e);
        for (var t = 0, i = e.length; i > t; t++) {
            var n = e[t], s = this.createControlMarkup(n);
            OpenLayers.Element.addClass(s, n.displayClass + "ItemInactive"), OpenLayers.Element.addClass(s, "olButton"), "" != n.title && !s.title && (s.title = n.title), n.panel_div = s
        }
        this.map && (this.addControlsToMap(e), this.redraw())
    },
    createControlMarkup: function () {
        return document.createElement("div")
    },
    addControlsToMap: function (e) {
        for (var t, i = 0, n = e.length; n > i; i++)t = e[i], !0 === t.autoActivate ? (t.autoActivate = !1, this.map.addControl(t), t.autoActivate = !0) : (this.map.addControl(t), t.deactivate()), t.events.on({
            activate: this.iconOn,
            deactivate: this.iconOff
        })
    },
    iconOn: function () {
        var e = this.panel_div;
        e.className = e.className.replace(RegExp("\\b(" + this.displayClass + "Item)Inactive\\b"), "$1Active")
    },
    iconOff: function () {
        var e = this.panel_div;
        e.className = e.className.replace(RegExp("\\b(" + this.displayClass + "Item)Active\\b"), "$1Inactive")
    },
    onButtonClick: function (e) {
        for (var t = this.controls, e = e.buttonElement, i = t.length - 1; i >= 0; --i)if (t[i].panel_div === e) {
            this.activateControl(t[i]);
            break
        }
    },
    getControlsBy: function (e, t) {
        var i = "function" == typeof t.test;
        return OpenLayers.Array.filter(this.controls, function (n) {
            return n[e] == t || i && t.test(n[e])
        })
    },
    getControlsByName: function (e) {
        return this.getControlsBy("name", e)
    },
    getControlsByClass: function (e) {
        return this.getControlsBy("CLASS_NAME", e)
    },
    CLASS_NAME: "OpenLayers.Control.Panel"
}),OpenLayers.Control.ZoomIn = OpenLayers.Class(OpenLayers.Control, {
    type: OpenLayers.Control.TYPE_BUTTON,
    trigger: function () {
        this.map.zoomIn()
    },
    CLASS_NAME: "OpenLayers.Control.ZoomIn"
}),OpenLayers.Control.ZoomOut = OpenLayers.Class(OpenLayers.Control, {
    type: OpenLayers.Control.TYPE_BUTTON,
    trigger: function () {
        this.map.zoomOut()
    },
    CLASS_NAME: "OpenLayers.Control.ZoomOut"
}),OpenLayers.Control.ZoomToMaxExtent = OpenLayers.Class(OpenLayers.Control, {
    type: OpenLayers.Control.TYPE_BUTTON,
    trigger: function () {
        this.map && this.map.zoomToMaxExtent()
    },
    CLASS_NAME: "OpenLayers.Control.ZoomToMaxExtent"
}),OpenLayers.Control.ZoomPanel = OpenLayers.Class(OpenLayers.Control.Panel, {
    initialize: function (e) {
        OpenLayers.Control.Panel.prototype.initialize.apply(this, [e]), this.addControls([new OpenLayers.Control.ZoomIn, new OpenLayers.Control.ZoomToMaxExtent, new OpenLayers.Control.ZoomOut])
    }, CLASS_NAME: "OpenLayers.Control.ZoomPanel"
}),OpenLayers.Layer.HTTPRequest = OpenLayers.Class(OpenLayers.Layer, {
    URL_HASH_FACTOR: (Math.sqrt(5) - 1) / 2,
    url: null,
    params: null,
    reproject: !1,
    initialize: function (e, t, i, n) {
        OpenLayers.Layer.prototype.initialize.apply(this, [e, n]), this.url = t, this.params || (this.params = OpenLayers.Util.extend({}, i))
    },
    destroy: function () {
        this.params = this.url = null, OpenLayers.Layer.prototype.destroy.apply(this, arguments)
    },
    clone: function (e) {
        return null == e && (e = new OpenLayers.Layer.HTTPRequest(this.name, this.url, this.params, this.getOptions())), e = OpenLayers.Layer.prototype.clone.apply(this, [e])
    },
    setUrl: function (e) {
        this.url = e
    },
    mergeNewParams: function (e) {
        return this.params = OpenLayers.Util.extend(this.params, e), e = this.redraw(), null != this.map && this.map.events.triggerEvent("changelayer", {
            layer: this,
            property: "params"
        }), e
    },
    redraw: function (e) {
        return e ? this.mergeNewParams({_olSalt: Math.random()}) : OpenLayers.Layer.prototype.redraw.apply(this, [])
    },
    selectUrl: function (e, t) {
        for (var i = 1, n = 0, s = e.length; s > n; n++)i *= e.charCodeAt(n) * this.URL_HASH_FACTOR, i -= Math.floor(i);
        return t[Math.floor(i * t.length)]
    },
    getFullRequestString: function (e, t) {
        var i = t || this.url, n = OpenLayers.Util.extend({}, this.params), n = OpenLayers.Util.extend(n, e), s = OpenLayers.Util.getParameterString(n);
        OpenLayers.Util.isArray(i) && (i = this.selectUrl(s, i));
        var r, s = OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(i));
        for (r in n)r.toUpperCase() in s && delete n[r];
        return s = OpenLayers.Util.getParameterString(n), OpenLayers.Util.urlAppend(i, s)
    },
    CLASS_NAME: "OpenLayers.Layer.HTTPRequest"
}),OpenLayers.Tile = OpenLayers.Class({
    events: null,
    eventListeners: null,
    id: null,
    layer: null,
    url: null,
    bounds: null,
    size: null,
    position: null,
    isLoading: !1,
    initialize: function (e, t, i, n, s, r) {
        this.layer = e, this.position = t.clone(), this.setBounds(i), this.url = n, s && (this.size = s.clone()), this.id = OpenLayers.Util.createUniqueID("Tile_"), OpenLayers.Util.extend(this, r), this.events = new OpenLayers.Events(this), this.eventListeners instanceof Object && this.events.on(this.eventListeners)
    },
    unload: function () {
        this.isLoading && (this.isLoading = !1, this.events.triggerEvent("unload"))
    },
    destroy: function () {
        this.position = this.size = this.bounds = this.layer = null, this.eventListeners && this.events.un(this.eventListeners), this.events.destroy(), this.events = this.eventListeners = null
    },
    draw: function (e) {
        e || this.clear();
        var t = this.shouldDraw();
        return t && !e && (t = !1 !== this.events.triggerEvent("beforedraw")), t
    },
    shouldDraw: function () {
        var e = !1, t = this.layer.maxExtent;
        if (t) {
            var i = this.layer.map, i = i.baseLayer.wrapDateLine && i.getMaxExtent();
            this.bounds.intersectsBounds(t, {inclusive: !1, worldBounds: i}) && (e = !0)
        }
        return e || this.layer.displayOutsideMaxExtent
    },
    setBounds: function (e) {
        if (e = e.clone(), this.layer.map.baseLayer.wrapDateLine)var t = this.layer.map.getMaxExtent(), i = this.layer.map.getResolution(), e = e.wrapDateLine(t, {
            leftTolerance: i,
            rightTolerance: i
        });
        this.bounds = e
    },
    moveTo: function (e, t, i) {
        null == i && (i = !0), this.setBounds(e), this.position = t.clone(), i && this.draw()
    },
    clear: function () {
    },
    CLASS_NAME: "OpenLayers.Tile"
}),OpenLayers.Tile.Image = OpenLayers.Class(OpenLayers.Tile, {
    url: null,
    imgDiv: null,
    frame: null,
    imageReloadAttempts: null,
    layerAlphaHack: null,
    asyncRequestId: null,
    blankImageUrl: "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7",
    maxGetUrlLength: null,
    canvasContext: null,
    crossOriginKeyword: null,
    initialize: function (e, t, i, n) {
        OpenLayers.Tile.prototype.initialize.apply(this, arguments), this.url = n, this.layerAlphaHack = this.layer.alpha && OpenLayers.Util.alphaHack(), (null != this.maxGetUrlLength || this.layer.gutter || this.layerAlphaHack) && (this.frame = document.createElement("div"), this.frame.style.position = "absolute", this.frame.style.overflow = "hidden"), null != this.maxGetUrlLength && OpenLayers.Util.extend(this, OpenLayers.Tile.Image.IFrame)
    },
    destroy: function () {
        this.imgDiv && (this.clear(), this.frame = this.imgDiv = null), this.asyncRequestId = null, OpenLayers.Tile.prototype.destroy.apply(this, arguments)
    },
    draw: function () {
        var e = OpenLayers.Tile.prototype.draw.apply(this, arguments);
        return e ? (this.layer != this.layer.map.baseLayer && this.layer.reproject && (this.bounds = this.getBoundsFromBaseLayer(this.position)), this.isLoading ? this._loadEvent = "reload" : (this.isLoading = !0, this._loadEvent = "loadstart"), this.positionTile(), this.renderTile()) : this.unload(), e
    },
    renderTile: function () {
        if (this.layer.div.appendChild(this.getTile()), this.layer.async) {
            var e = this.asyncRequestId = (this.asyncRequestId || 0) + 1;
            this.layer.getURLasync(this.bounds, function (t) {
                e == this.asyncRequestId && (this.url = t, this.initImage())
            }, this)
        } else this.url = this.layer.getURL(this.bounds), this.initImage()
    },
    positionTile: function () {
        var e = this.getTile().style, t = this.frame ? this.size : this.layer.getImageSize(this.bounds);
        e.left = this.position.x + "%", e.top = this.position.y + "%", e.width = t.w + "%", e.height = t.h + "%"
    },
    clear: function () {
        OpenLayers.Tile.prototype.clear.apply(this, arguments);
        var e = this.imgDiv;
        if (e) {
            OpenLayers.Event.stopObservingElement(e);
            var t = this.getTile();
            t.parentNode === this.layer.div && this.layer.div.removeChild(t), this.setImgSrc(), !0 === this.layerAlphaHack && (e.style.filter = ""), OpenLayers.Element.removeClass(e, "olImageLoadError")
        }
        this.canvasContext = null
    },
    getImage: function () {
        if (!this.imgDiv) {
            this.imgDiv = document.createElement("img"), this.imgDiv.className = "olTileImage", this.imgDiv.galleryImg = "no";
            var e = this.imgDiv.style;
            if (this.frame) {
                var t = 0, i = 0;
                this.layer.gutter && (t = 100 * (this.layer.gutter / this.layer.tileSize.w), i = 100 * (this.layer.gutter / this.layer.tileSize.h)), e.left = -t + "%", e.top = -i + "%", e.width = 2 * t + 100 + "%", e.height = 2 * i + 100 + "%"
            }
            e.visibility = "hidden", e.opacity = 0, 1 > this.layer.opacity && (e.filter = "alpha(opacity=" + 100 * this.layer.opacity + ")"), e.position = "absolute", this.layerAlphaHack && (e.paddingTop = e.height, e.height = "0", e.width = "100%"), this.frame && this.frame.appendChild(this.imgDiv)
        }
        return this.imgDiv
    },
    initImage: function () {
        this.events.triggerEvent(this._loadEvent);
        var e = this.getImage();
        if (this.url && e.getAttribute("src") == this.url) this.onImageLoad(); else {
            var t = OpenLayers.Function.bind(function () {
                OpenLayers.Event.stopObservingElement(e), OpenLayers.Event.observe(e, "load", OpenLayers.Function.bind(this.onImageLoad, this)), OpenLayers.Event.observe(e, "error", OpenLayers.Function.bind(this.onImageError, this)), this.imageReloadAttempts = 0, this.setImgSrc(this.url)
            }, this);
            e.getAttribute("src") == this.blankImageUrl ? t() : (OpenLayers.Event.observe(e, "load", t), OpenLayers.Event.observe(e, "error", t), this.crossOriginKeyword && e.removeAttribute("crossorigin"), e.src = this.blankImageUrl)
        }
    },
    setImgSrc: function (e) {
        var t = this.imgDiv;
        t.style.visibility = "hidden", t.style.opacity = 0, e && (this.crossOriginKeyword && ("data:" !== e.substr(0, 5) ? t.setAttribute("crossorigin", this.crossOriginKeyword) : t.removeAttribute("crossorigin")), t.src = e)
    },
    getTile: function () {
        return this.frame ? this.frame : this.getImage()
    },
    createBackBuffer: function () {
        if (this.imgDiv && !this.isLoading) {
            var e;
            return this.frame ? (e = this.frame.cloneNode(!1), e.appendChild(this.imgDiv)) : e = this.imgDiv, this.imgDiv = null, e
        }
    },
    onImageLoad: function () {
        var e = this.imgDiv;
        if (OpenLayers.Event.stopObservingElement(e), e.style.visibility = "inherit", e.style.opacity = this.layer.opacity, this.isLoading = !1, this.canvasContext = null, this.events.triggerEvent("loadend"), 7 > parseFloat(navigator.appVersion.split("MSIE")[1]) && this.layer && this.layer.div) {
            var t = document.createElement("span");
            t.style.display = "none";
            var i = this.layer.div;
            i.appendChild(t), window.setTimeout(function () {
                t.parentNode === i && t.parentNode.removeChild(t)
            }, 0)
        }
        !0 === this.layerAlphaHack && (e.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='" + e.src + "', sizingMethod='scale')")
    },
    onImageError: function () {
        var e = this.imgDiv;
        null != e.src && (this.imageReloadAttempts++, this.imageReloadAttempts <= OpenLayers.IMAGE_RELOAD_ATTEMPTS ? this.setImgSrc(this.layer.getURL(this.bounds)) : (OpenLayers.Element.addClass(e, "olImageLoadError"), this.events.triggerEvent("loaderror"), this.onImageLoad()))
    },
    getCanvasContext: function () {
        if (OpenLayers.CANVAS_SUPPORTED && this.imgDiv && !this.isLoading) {
            if (!this.canvasContext) {
                var e = document.createElement("canvas");
                e.width = this.size.w, e.height = this.size.h, this.canvasContext = e.getContext("2d"), this.canvasContext.drawImage(this.imgDiv, 0, 0)
            }
            return this.canvasContext
        }
    },
    CLASS_NAME: "OpenLayers.Tile.Image"
}),OpenLayers.Layer.Grid = OpenLayers.Class(OpenLayers.Layer.HTTPRequest, {
    tileSize: null,
    tileOriginCorner: "bl",
    tileOrigin: null,
    tileOptions: null,
    tileClass: OpenLayers.Tile.Image,
    grid: null,
    singleTile: !1,
    ratio: 1.5,
    buffer: 0,
    transitionEffect: null,
    numLoadingTiles: 0,
    tileLoadingDelay: 85,
    serverResolutions: null,
    moveTimerId: null,
    deferMoveGriddedTiles: null,
    tileQueueId: null,
    tileQueue: null,
    loading: !1,
    backBuffer: null,
    gridResolution: null,
    backBufferResolution: null,
    backBufferLonLat: null,
    backBufferTimerId: null,
    removeBackBufferDelay: null,
    className: null,
    initialize: function () {
        OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this, arguments), this.grid = [], this.tileQueue = [], null === this.removeBackBufferDelay && (this.removeBackBufferDelay = this.singleTile ? 0 : 2500), null === this.className && (this.className = this.singleTile ? "olLayerGridSingleTile" : "olLayerGrid"), OpenLayers.Animation.isNative || (this.deferMoveGriddedTiles = OpenLayers.Function.bind(function () {
            this.moveGriddedTiles(!0), this.moveTimerId = null
        }, this))
    },
    setMap: function (e) {
        OpenLayers.Layer.HTTPRequest.prototype.setMap.call(this, e), OpenLayers.Element.addClass(this.div, this.className)
    },
    removeMap: function () {
        null !== this.moveTimerId && (window.clearTimeout(this.moveTimerId), this.moveTimerId = null), this.clearTileQueue(), null !== this.backBufferTimerId && (window.clearTimeout(this.backBufferTimerId), this.backBufferTimerId = null)
    },
    destroy: function () {
        this.removeBackBuffer(), this.clearGrid(), this.tileSize = this.grid = null, OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this, arguments)
    },
    clearGrid: function () {
        if (this.clearTileQueue(), this.grid) {
            for (var e = 0, t = this.grid.length; t > e; e++)for (var i = this.grid[e], n = 0, s = i.length; s > n; n++)this.destroyTile(i[n]);
            this.grid = [], this.gridResolution = null
        }
    },
    clone: function (e) {
        return null == e && (e = new OpenLayers.Layer.Grid(this.name, this.url, this.params, this.getOptions())), e = OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this, [e]), null != this.tileSize && (e.tileSize = this.tileSize.clone()), e.grid = [], e.gridResolution = null, e.backBuffer = null, e.backBufferTimerId = null, e.tileQueue = [], e.tileQueueId = null, e.loading = !1, e.moveTimerId = null, e
    },
    moveTo: function (e, t, i) {
        if (OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this, arguments), e = e || this.map.getExtent(), null != e) {
            var n = !this.grid.length || t, s = this.getTilesBounds(), r = this.map.getResolution(), a = this.getServerResolution(r);
            this.singleTile ? (n || !i && !s.containsBounds(e)) && (t && "resize" !== this.transitionEffect && this.removeBackBuffer(), (!t || "resize" === this.transitionEffect) && this.applyBackBuffer(a), this.initSingleTile(e)) : (n = n || !s.intersectsBounds(e, {worldBounds: this.map.baseLayer.wrapDateLine && this.map.getMaxExtent()}), r !== a ? (e = this.map.calculateBounds(null, a), n && this.transformDiv(a / r)) : (this.div.style.width = "100%", this.div.style.height = "100%", this.div.style.left = "0%", this.div.style.top = "0%"), n ? (t && "resize" === this.transitionEffect && this.applyBackBuffer(a), this.initGriddedTiles(e)) : this.moveGriddedTiles())
        }
    },
    getTileData: function (e) {
        var t = null, i = e.lon, n = e.lat, s = this.grid.length;
        if (this.map && s) {
            var r = this.map.getResolution(), e = this.tileSize.w, a = this.tileSize.h, o = this.grid[0][0].bounds, l = o.left, o = o.top;
            if (l > i && this.map.baseLayer.wrapDateLine)var h = this.map.getMaxExtent().getWidth(), u = Math.ceil((l - i) / h), i = i + h * u;
            i = (i - l) / (r * e), n = (o - n) / (r * a), r = Math.floor(i), l = Math.floor(n), l >= 0 && s > l && (s = this.grid[l][r]) && (t = {
                tile: s,
                i: Math.floor((i - r) * e),
                j: Math.floor((n - l) * a)
            })
        }
        return t
    },
    queueTileDraw: function (e) {
        return e = e.object, ~OpenLayers.Util.indexOf(this.tileQueue, e) || this.tileQueue.push(e), this.tileQueueId || (this.tileQueueId = OpenLayers.Animation.start(OpenLayers.Function.bind(this.drawTileFromQueue, this), null, this.div)), !1
    },
    drawTileFromQueue: function () {
        0 === this.tileQueue.length ? this.clearTileQueue() : this.tileQueue.shift().draw(!0)
    },
    clearTileQueue: function () {
        OpenLayers.Animation.stop(this.tileQueueId), this.tileQueueId = null, this.tileQueue = []
    },
    destroyTile: function (e) {
        this.removeTileMonitoringHooks(e), e.destroy()
    },
    getServerResolution: function (e) {
        if (e = e || this.map.getResolution(), this.serverResolutions && -1 === OpenLayers.Util.indexOf(this.serverResolutions, e)) {
            var t, i;
            for (t = this.serverResolutions.length - 1; t >= 0; t--)if (i = this.serverResolutions[t], i > e) {
                e = i;
                break
            }
            if (-1 === t)throw"no appropriate resolution in serverResolutions"
        }
        return e
    },
    getServerZoom: function () {
        var e = this.getServerResolution();
        return this.serverResolutions ? OpenLayers.Util.indexOf(this.serverResolutions, e) : this.map.getZoomForResolution(e) + (this.zoomOffset || 0)
    },
    transformDiv: function (e) {
        this.div.style.width = 100 * e + "%", this.div.style.height = 100 * e + "%";
        var t = this.map.getSize(), i = parseInt(this.map.layerContainerDiv.style.left, 10), n = (parseInt(this.map.layerContainerDiv.style.top, 10) - t.h / 2) * (e - 1);
        this.div.style.left = (i - t.w / 2) * (e - 1) + "%", this.div.style.top = n + "%"
    },
    getResolutionScale: function () {
        return parseInt(this.div.style.width, 10) / 100
    },
    applyBackBuffer: function (e) {
        null !== this.backBufferTimerId && this.removeBackBuffer();
        var t = this.backBuffer;
        if (!t) {
            if (t = this.createBackBuffer(), !t)return;
            this.div.insertBefore(t, this.div.firstChild), this.backBuffer = t;
            var i = this.grid[0][0].bounds;
            this.backBufferLonLat = {lon: i.left, lat: i.top}, this.backBufferResolution = this.gridResolution
        }
        var i = t.style, n = this.backBufferResolution / e;
        i.width = 100 * n + "%", i.height = 100 * n + "%", e = this.getViewPortPxFromLonLat(this.backBufferLonLat, e), i = parseInt(this.map.layerContainerDiv.style.left, 10), n = parseInt(this.map.layerContainerDiv.style.top, 10), t.style.left = Math.round(e.x - i) + "%", t.style.top = Math.round(e.y - n) + "%"
    },
    createBackBuffer: function () {
        var e;
        if (0 < this.grid.length) {
            e = document.createElement("div"), e.id = this.div.id + "_bb", e.className = "olBackBuffer", e.style.position = "absolute", e.style.width = "100%", e.style.height = "100%";
            for (var t = 0, i = this.grid.length; i > t; t++)for (var n = 0, s = this.grid[t].length; s > n; n++) {
                var r = this.grid[t][n].createBackBuffer();
                r && (r.style.top = t * this.tileSize.h + "%", r.style.left = n * this.tileSize.w + "%", e.appendChild(r))
            }
        }
        return e
    },
    removeBackBuffer: function () {
        this.backBuffer && (this.div.removeChild(this.backBuffer), this.backBufferResolution = this.backBuffer = null, null !== this.backBufferTimerId && (window.clearTimeout(this.backBufferTimerId), this.backBufferTimerId = null))
    },
    moveByPx: function () {
        this.singleTile || this.moveGriddedTiles()
    },
    setTileSize: function (e) {
        this.singleTile && (e = this.map.getSize(), e.h = parseInt(e.h * this.ratio), e.w = parseInt(e.w * this.ratio)), OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this, [e])
    },
    getTilesBounds: function () {
        var e = null, t = this.grid.length;
        if (t)var e = this.grid[t - 1][0].bounds, t = this.grid[0].length * e.getWidth(), i = this.grid.length * e.getHeight(), e = new OpenLayers.Bounds(e.left, e.bottom, e.left + t, e.bottom + i);
        return e
    },
    initSingleTile: function (e) {
        this.clearTileQueue();
        var t = e.getCenterLonLat(), i = e.getWidth() * this.ratio, e = e.getHeight() * this.ratio, t = new OpenLayers.Bounds(t.lon - i / 2, t.lat - e / 2, t.lon + i / 2, t.lat + e / 2), i = this.map.getLayerPxFromLonLat({
            lon: t.left,
            lat: t.top
        });
        this.grid.length || (this.grid[0] = []), (e = this.grid[0][0]) ? e.moveTo(t, i) : (e = this.addTile(t, i), this.addTileMonitoringHooks(e), e.draw(), this.grid[0][0] = e), this.removeExcessTiles(1, 1), this.gridResolution = this.getServerResolution()
    },
    calculateGridLayout: function (e, t, i) {
        var n = i * this.tileSize.w, i = i * this.tileSize.h, s = e.left - t.lon, r = Math.floor(s / n) - this.buffer, s = -(s / n - r) * this.tileSize.w, r = t.lon + r * n, e = e.top - (t.lat + i), a = Math.ceil(e / i) + this.buffer;
        return {
            tilelon: n,
            tilelat: i,
            tileoffsetlon: r,
            tileoffsetlat: t.lat + a * i,
            tileoffsetx: s,
            tileoffsety: -(a - e / i) * this.tileSize.h
        }
    },
    getTileOrigin: function () {
        var e = this.tileOrigin;
        if (!e)var e = this.getMaxExtent(), t = {
            tl: ["left", "top"],
            tr: ["right", "top"],
            bl: ["left", "bottom"],
            br: ["right", "bottom"]
        }[this.tileOriginCorner], e = new OpenLayers.LonLat(e[t[0]], e[t[1]]);
        return e
    },
    initGriddedTiles: function (e) {
        this.clearTileQueue();
        var t = this.map.getSize(), i = Math.ceil(t.h / this.tileSize.h) + Math.max(1, 2 * this.buffer), t = Math.ceil(t.w / this.tileSize.w) + Math.max(1, 2 * this.buffer), n = this.getTileOrigin(), s = this.getServerResolution(), n = this.calculateGridLayout(e, n, s), s = Math.round(n.tileoffsetx), r = Math.round(n.tileoffsety), a = n.tileoffsetlon, o = n.tileoffsetlat, l = n.tilelon, h = n.tilelat, u = s, c = a, p = 0, d = parseInt(this.map.layerContainerDiv.style.left), f = parseInt(this.map.layerContainerDiv.style.top), n = [], m = this.map.getCenter();
        do {
            var g = this.grid[p++];
            g || (g = [], this.grid.push(g));
            var a = c, s = u, y = 0;
            do {
                var v = new OpenLayers.Bounds(a, o, a + l, o + h), b = s, b = b - d, L = r, L = L - f, L = new OpenLayers.Pixel(b, L);
                (b = g[y++]) ? b.moveTo(v, L, !1) : (b = this.addTile(v, L), this.addTileMonitoringHooks(b), g.push(b)), v = v.getCenterLonLat(), n.push({
                    tile: b,
                    distance: Math.pow(v.lon - m.lon, 2) + Math.pow(v.lat - m.lat, 2)
                }), a += l, s += this.tileSize.w
            } while (a <= e.right + l * this.buffer || t > y);
            o -= h, r += this.tileSize.h
        } while (o >= e.bottom - h * this.buffer || i > p);
        for (this.removeExcessTiles(p, y), this.gridResolution = this.getServerResolution(), n.sort(function (e, t) {
            return e.distance - t.distance
        }), e = 0, i = n.length; i > e; ++e)n[e].tile.draw()
    },
    getMaxExtent: function () {
        return this.maxExtent
    },
    addTile: function (e, t) {
        var i = new this.tileClass(this, t, e, null, this.tileSize, this.tileOptions);
        return i.events.register("beforedraw", this, this.queueTileDraw), i
    },
    addTileMonitoringHooks: function (e) {
        e.onLoadStart = function () {
            !1 === this.loading && (this.loading = !0, this.events.triggerEvent("loadstart")), this.events.triggerEvent("tileloadstart", {tile: e}), this.numLoadingTiles++
        }, e.onLoadEnd = function () {
            this.numLoadingTiles--, this.events.triggerEvent("tileloaded", {tile: e}), 0 === this.tileQueue.length && 0 === this.numLoadingTiles && (this.loading = !1, this.events.triggerEvent("loadend"), this.backBuffer && (this.backBufferTimerId = window.setTimeout(OpenLayers.Function.bind(this.removeBackBuffer, this), this.removeBackBufferDelay)))
        }, e.onLoadError = function () {
            this.events.triggerEvent("tileerror", {tile: e})
        }, e.events.on({
            loadstart: e.onLoadStart,
            loadend: e.onLoadEnd,
            unload: e.onLoadEnd,
            loaderror: e.onLoadError,
            scope: this
        })
    },
    removeTileMonitoringHooks: function (e) {
        e.unload(), e.events.un({
            loadstart: e.onLoadStart,
            loadend: e.onLoadEnd,
            unload: e.onLoadEnd,
            loaderror: e.onLoadError,
            scope: this
        })
    },
    moveGriddedTiles: function (e) {
        if (e || OpenLayers.Animation.isNative)for (var e = this.buffer || 1, t = this.getResolutionScale(); ;) {
            var i = this.grid[0][0].position.x * t + parseInt(this.div.style.left, 10) + parseInt(this.map.layerContainerDiv.style.left), n = this.grid[0][0].position.y * t + parseInt(this.div.style.top, 10) + parseInt(this.map.layerContainerDiv.style.top), s = this.tileSize.w * t, r = this.tileSize.h * t;
            if (i > -s * (e - 1)) this.shiftColumn(!0); else if (-s * e > i) this.shiftColumn(!1); else if (n > -r * (e - 1)) this.shiftRow(!0); else {
                if (!(-r * e > n))break;
                this.shiftRow(!1)
            }
        } else null != this.moveTimerId && window.clearTimeout(this.moveTimerId), this.moveTimerId = window.setTimeout(this.deferMoveGriddedTiles, this.tileLoadingDelay)
    },
    shiftRow: function (e) {
        for (var t = this.grid, i = t[e ? 0 : this.grid.length - 1], n = this.getServerResolution(), s = e ? -this.tileSize.h : this.tileSize.h, n = n * -s, r = e ? t.pop() : t.shift(), a = 0, o = i.length; o > a; a++) {
            var l = i[a], h = l.bounds.clone(), l = l.position.clone();
            h.bottom += n, h.top += n, l.y += s, r[a].moveTo(h, l)
        }
        e ? t.unshift(r) : t.push(r)
    },
    shiftColumn: function (e) {
        for (var t = e ? -this.tileSize.w : this.tileSize.w, i = this.getServerResolution() * t, n = 0, s = this.grid.length; s > n; n++) {
            var r = this.grid[n], a = r[e ? 0 : r.length - 1], o = a.bounds.clone(), a = a.position.clone();
            o.left += i, o.right += i, a.x += t;
            var l = e ? this.grid[n].pop() : this.grid[n].shift();
            l.moveTo(o, a), e ? r.unshift(l) : r.push(l)
        }
    },
    removeExcessTiles: function (e, t) {
        for (var i, n; this.grid.length > e;) {
            var s = this.grid.pop();
            for (i = 0, n = s.length; n > i; i++) {
                var r = s[i];
                this.destroyTile(r)
            }
        }
        for (i = 0, n = this.grid.length; n > i; i++)for (; this.grid[i].length > t;)s = this.grid[i], r = s.pop(), this.destroyTile(r)
    },
    onMapResize: function () {
        this.singleTile && (this.clearGrid(), this.setTileSize())
    },
    getTileBounds: function (e) {
        var t = this.maxExtent, i = this.getResolution(), n = i * this.tileSize.w, i = i * this.tileSize.h, s = this.getLonLatFromViewPortPx(e), e = t.left + n * Math.floor((s.lon - t.left) / n), t = t.bottom + i * Math.floor((s.lat - t.bottom) / i);
        return new OpenLayers.Bounds(e, t, e + n, t + i)
    },
    CLASS_NAME: "OpenLayers.Layer.Grid"
}),OpenLayers.Format.ArcXML = OpenLayers.Class(OpenLayers.Format.XML, {
    fontStyleKeys: "antialiasing blockout font fontcolor fontsize fontstyle glowing interval outline printmode shadow transparency".split(" "),
    request: null,
    response: null,
    initialize: function (e) {
        if (this.request = new OpenLayers.Format.ArcXML.Request, this.response = new OpenLayers.Format.ArcXML.Response, e)if ("feature" == e.requesttype) {
            this.request.get_image = null;
            var t = this.request.get_feature.query;
            this.addCoordSys(t.featurecoordsys, e.featureCoordSys), this.addCoordSys(t.filtercoordsys, e.filterCoordSys), e.polygon ? (t.isspatial = !0, t.spatialfilter.polygon = e.polygon) : e.envelope && (t.isspatial = !0, t.spatialfilter.envelope = {
                minx: 0,
                miny: 0,
                maxx: 0,
                maxy: 0
            }, this.parseEnvelope(t.spatialfilter.envelope, e.envelope))
        } else"image" == e.requesttype ? (this.request.get_feature = null, t = this.request.get_image.properties, this.parseEnvelope(t.envelope, e.envelope), this.addLayers(t.layerlist, e.layers), this.addImageSize(t.imagesize, e.tileSize), this.addCoordSys(t.featurecoordsys, e.featureCoordSys), this.addCoordSys(t.filtercoordsys, e.filterCoordSys)) : this.request = null;
        OpenLayers.Format.XML.prototype.initialize.apply(this, [e])
    },
    parseEnvelope: function (e, t) {
        t && 4 == t.length && (e.minx = t[0], e.miny = t[1], e.maxx = t[2], e.maxy = t[3])
    },
    addLayers: function (e, t) {
        for (var i = 0, n = t.length; n > i; i++)e.push(t[i])
    },
    addImageSize: function (e, t) {
        null !== t && (e.width = t.w, e.height = t.h, e.printwidth = t.w, e.printheight = t.h)
    },
    addCoordSys: function (e, t) {
        "string" == typeof t ? (e.id = parseInt(t), e.string = t) : "object" == typeof t && null !== t.proj && (e.id = t.proj.srsProjNumber, e.string = t.proj.srsCode)
    },
    iserror: function (e) {
        var t = null;
        return e ? (e = OpenLayers.Format.XML.prototype.read.apply(this, [e]), e = e.documentElement.getElementsByTagName("ERROR"), t = null !== e && 0 < e.length) : t = "" !== this.response.error, t
    },
    read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e]));
        var t = null;
        if (e && e.documentElement && (t = "ARCXML" == e.documentElement.nodeName ? e.documentElement : e.documentElement.getElementsByTagName("ARCXML")[0]), !t || "parsererror" === t.firstChild.nodeName) {
            var i, n;
            try {
                i = e.firstChild.nodeValue, n = e.firstChild.childNodes[1].firstChild.nodeValue
            } catch (s) {
            }
            throw{message: "Error parsing the ArcXML request", error: i, source: n}
        }
        return this.parseResponse(t)
    },
    write: function (e) {
        e || (e = this.request);
        var t = this.createElementNS("", "ARCXML");
        t.setAttribute("version", "1.1");
        var i = this.createElementNS("", "REQUEST");
        if (null != e.get_image) {
            var n = this.createElementNS("", "GET_IMAGE");
            i.appendChild(n);
            var s = this.createElementNS("", "PROPERTIES");
            if (n.appendChild(s), e = e.get_image.properties, null != e.featurecoordsys && (n = this.createElementNS("", "FEATURECOORDSYS"), s.appendChild(n), 0 === e.featurecoordsys.id ? n.setAttribute("string", e.featurecoordsys.string) : n.setAttribute("id", e.featurecoordsys.id)), null != e.filtercoordsys && (n = this.createElementNS("", "FILTERCOORDSYS"), s.appendChild(n), 0 === e.filtercoordsys.id ? n.setAttribute("string", e.filtercoordsys.string) : n.setAttribute("id", e.filtercoordsys.id)), null != e.envelope && (n = this.createElementNS("", "ENVELOPE"), s.appendChild(n), n.setAttribute("minx", e.envelope.minx), n.setAttribute("miny", e.envelope.miny), n.setAttribute("maxx", e.envelope.maxx), n.setAttribute("maxy", e.envelope.maxy)), n = this.createElementNS("", "IMAGESIZE"), s.appendChild(n), n.setAttribute("height", e.imagesize.height), n.setAttribute("width", e.imagesize.width), (e.imagesize.height != e.imagesize.printheight || e.imagesize.width != e.imagesize.printwidth) && (n.setAttribute("printheight", e.imagesize.printheight), n.setArrtibute("printwidth", e.imagesize.printwidth)), null != e.background && (n = this.createElementNS("", "BACKGROUND"), s.appendChild(n), n.setAttribute("color", e.background.color.r + "," + e.background.color.g + "," + e.background.color.b), null !== e.background.transcolor && n.setAttribute("transcolor", e.background.transcolor.r + "," + e.background.transcolor.g + "," + e.background.transcolor.b)), null != e.layerlist && 0 < e.layerlist.length)for (n = this.createElementNS("", "LAYERLIST"), s.appendChild(n), s = 0; s < e.layerlist.length; s++) {
                var r = this.createElementNS("", "LAYERDEF");
                if (n.appendChild(r), r.setAttribute("id", e.layerlist[s].id), r.setAttribute("visible", e.layerlist[s].visible), "object" == typeof e.layerlist[s].query) {
                    var a = e.layerlist[s].query;
                    if (0 > a.where.length)continue;
                    var o = null, o = "boolean" == typeof a.spatialfilter && a.spatialfilter ? this.createElementNS("", "SPATIALQUERY") : this.createElementNS("", "QUERY");
                    o.setAttribute("where", a.where), "number" == typeof a.accuracy && 0 < a.accuracy && o.setAttribute("accuracy", a.accuracy), "number" == typeof a.featurelimit && 2e3 > a.featurelimit && o.setAttribute("featurelimit", a.featurelimit), "string" == typeof a.subfields && "#ALL#" != a.subfields && o.setAttribute("subfields", a.subfields), "string" == typeof a.joinexpression && 0 < a.joinexpression.length && o.setAttribute("joinexpression", a.joinexpression), "string" == typeof a.jointables && 0 < a.jointables.length && o.setAttribute("jointables", a.jointables), r.appendChild(o)
                }
                "object" == typeof e.layerlist[s].renderer && this.addRenderer(r, e.layerlist[s].renderer)
            }
        } else null != e.get_feature && (n = this.createElementNS("", "GET_FEATURES"), n.setAttribute("outputmode", "newxml"), n.setAttribute("checkesc", "true"), e.get_feature.geometry ? n.setAttribute("geometry", e.get_feature.geometry) : n.setAttribute("geometry", "false"), e.get_feature.compact && n.setAttribute("compact", e.get_feature.compact), "number" == e.get_feature.featurelimit && n.setAttribute("featurelimit", e.get_feature.featurelimit), n.setAttribute("globalenvelope", "true"), i.appendChild(n), null != e.get_feature.layer && 0 < e.get_feature.layer.length && (s = this.createElementNS("", "LAYER"), s.setAttribute("id", e.get_feature.layer), n.appendChild(s)), e = e.get_feature.query, null != e) && (s = null, s = e.isspatial ? this.createElementNS("", "SPATIALQUERY") : this.createElementNS("", "QUERY"), n.appendChild(s), "number" == typeof e.accuracy && s.setAttribute("accuracy", e.accuracy), null != e.featurecoordsys && (n = this.createElementNS("", "FEATURECOORDSYS"), 0 == e.featurecoordsys.id ? n.setAttribute("string", e.featurecoordsys.string) : n.setAttribute("id", e.featurecoordsys.id), s.appendChild(n)), null != e.filtercoordsys && (n = this.createElementNS("", "FILTERCOORDSYS"), 0 === e.filtercoordsys.id ? n.setAttribute("string", e.filtercoordsys.string) : n.setAttribute("id", e.filtercoordsys.id), s.appendChild(n)), 0 < e.buffer && (n = this.createElementNS("", "BUFFER"), n.setAttribute("distance", e.buffer), s.appendChild(n)), e.isspatial && (n = this.createElementNS("", "SPATIALFILTER"), n.setAttribute("relation", e.spatialfilter.relation), s.appendChild(n), e.spatialfilter.envelope ? (r = this.createElementNS("", "ENVELOPE"), r.setAttribute("minx", e.spatialfilter.envelope.minx), r.setAttribute("miny", e.spatialfilter.envelope.miny), r.setAttribute("maxx", e.spatialfilter.envelope.maxx), r.setAttribute("maxy", e.spatialfilter.envelope.maxy), n.appendChild(r)) : "object" == typeof e.spatialfilter.polygon && n.appendChild(this.writePolygonGeometry(e.spatialfilter.polygon))), null != e.where && 0 < e.where.length && s.setAttribute("where", e.where));
        return t.appendChild(i), OpenLayers.Format.XML.prototype.write.apply(this, [t])
    },
    addGroupRenderer: function (e, t) {
        var i = this.createElementNS("", "GROUPRENDERER");
        e.appendChild(i);
        for (var n = 0; n < t.length; n++)this.addRenderer(i, t[n])
    },
    addRenderer: function (e, t) {
        if (OpenLayers.Util.isArray(t)) this.addGroupRenderer(e, t); else {
            var i = this.createElementNS("", t.type.toUpperCase() + "RENDERER");
            e.appendChild(i), "VALUEMAPRENDERER" == i.tagName ? this.addValueMapRenderer(i, t) : "VALUEMAPLABELRENDERER" == i.tagName ? this.addValueMapLabelRenderer(i, t) : "SIMPLELABELRENDERER" == i.tagName ? this.addSimpleLabelRenderer(i, t) : "SCALEDEPENDENTRENDERER" == i.tagName && this.addScaleDependentRenderer(i, t)
        }
    },
    addScaleDependentRenderer: function (e, t) {
        ("string" == typeof t.lower || "number" == typeof t.lower) && e.setAttribute("lower", t.lower), ("string" == typeof t.upper || "number" == typeof t.upper) && e.setAttribute("upper", t.upper), this.addRenderer(e, t.renderer)
    },
    addValueMapLabelRenderer: function (e, t) {
        if (e.setAttribute("lookupfield", t.lookupfield), e.setAttribute("labelfield", t.labelfield), "object" == typeof t.exacts)for (var i = 0, n = t.exacts.length; n > i; i++) {
            var s = t.exacts[i], r = this.createElementNS("", "EXACT");
            if ("string" == typeof s.value && r.setAttribute("value", s.value), "string" == typeof s.label && r.setAttribute("label", s.label), "string" == typeof s.method && r.setAttribute("method", s.method), e.appendChild(r), "object" == typeof s.symbol) {
                var a = null;
                if ("text" == s.symbol.type && (a = this.createElementNS("", "TEXTSYMBOL")), null != a) {
                    for (var o = this.fontStyleKeys, l = 0, h = o.length; h > l; l++) {
                        var u = o[l];
                        s.symbol[u] && a.setAttribute(u, s.symbol[u])
                    }
                    r.appendChild(a)
                }
            }
        }
    },
    addValueMapRenderer: function (e, t) {
        if (e.setAttribute("lookupfield", t.lookupfield), "object" == typeof t.ranges)for (var i = 0, n = t.ranges.length; n > i; i++) {
            var s = t.ranges[i], r = this.createElementNS("", "RANGE");
            if (r.setAttribute("lower", s.lower), r.setAttribute("upper", s.upper), e.appendChild(r), "object" == typeof s.symbol) {
                var a = null;
                "simplepolygon" == s.symbol.type && (a = this.createElementNS("", "SIMPLEPOLYGONSYMBOL")), null != a && ("string" == typeof s.symbol.boundarycolor && a.setAttribute("boundarycolor", s.symbol.boundarycolor), "string" == typeof s.symbol.fillcolor && a.setAttribute("fillcolor", s.symbol.fillcolor), "number" == typeof s.symbol.filltransparency && a.setAttribute("filltransparency", s.symbol.filltransparency), r.appendChild(a))
            }
        } else if ("object" == typeof t.exacts)for (i = 0, n = t.exacts.length; n > i; i++)s = t.exacts[i], r = this.createElementNS("", "EXACT"), "string" == typeof s.value && r.setAttribute("value", s.value), "string" == typeof s.label && r.setAttribute("label", s.label), "string" == typeof s.method && r.setAttribute("method", s.method), e.appendChild(r), "object" == typeof s.symbol && (a = null, "simplemarker" == s.symbol.type && (a = this.createElementNS("", "SIMPLEMARKERSYMBOL")), null != a && ("string" == typeof s.symbol.antialiasing && a.setAttribute("antialiasing", s.symbol.antialiasing), "string" == typeof s.symbol.color && a.setAttribute("color", s.symbol.color), "string" == typeof s.symbol.outline && a.setAttribute("outline", s.symbol.outline), "string" == typeof s.symbol.overlap && a.setAttribute("overlap", s.symbol.overlap), "string" == typeof s.symbol.shadow && a.setAttribute("shadow", s.symbol.shadow), "number" == typeof s.symbol.transparency && a.setAttribute("transparency", s.symbol.transparency), "string" == typeof s.symbol.usecentroid && a.setAttribute("usecentroid", s.symbol.usecentroid), "number" == typeof s.symbol.width && a.setAttribute("width", s.symbol.width), r.appendChild(a)))
    },
    addSimpleLabelRenderer: function (e, t) {
        e.setAttribute("field", t.field);
        for (var i = "featureweight howmanylabels labelbufferratio labelpriorities labelweight linelabelposition rotationalangles".split(" "), n = 0, s = i.length; s > n; n++) {
            var r = i[n];
            t[r] && e.setAttribute(r, t[r])
        }
        if ("text" == t.symbol.type) {
            var a = t.symbol, o = this.createElementNS("", "TEXTSYMBOL");
            for (e.appendChild(o), i = this.fontStyleKeys, n = 0, s = i.length; s > n; n++)r = i[n], a[r] && o.setAttribute(r, t[r])
        }
    },
    writePolygonGeometry: function (e) {
        if (!(e instanceof OpenLayers.Geometry.Polygon))throw{
            message: "Cannot write polygon geometry to ArcXML with an " + e.CLASS_NAME + " object.",
            geometry: e
        };
        for (var t = this.createElementNS("", "POLYGON"), i = 0, n = e.components.length; n > i; i++) {
            for (var s = e.components[i], r = this.createElementNS("", "RING"), a = 0, o = s.components.length; o > a; a++) {
                var l = s.components[a], h = this.createElementNS("", "POINT");
                h.setAttribute("x", l.x), h.setAttribute("y", l.y), r.appendChild(h)
            }
            t.appendChild(r)
        }
        return t
    },
    parseResponse: function (e) {
        "string" == typeof e && (e = (new OpenLayers.Format.XML).read(e));
        var t = new OpenLayers.Format.ArcXML.Response, i = e.getElementsByTagName("ERROR");
        if (null != i && 0 < i.length) t.error = this.getChildValue(i, "Unknown error."); else {
            if (i = e.getElementsByTagName("RESPONSE"), null == i || 0 == i.length)return t.error = "No RESPONSE tag found in ArcXML response.", t;
            var n = i[0].firstChild.nodeName;
            if ("#text" == n && (n = i[0].firstChild.nextSibling.nodeName), "IMAGE" == n) i = e.getElementsByTagName("ENVELOPE"), e = e.getElementsByTagName("OUTPUT"), null == i || 0 == i.length ? t.error = "No ENVELOPE tag found in ArcXML response." : null == e || 0 == e.length ? t.error = "No OUTPUT tag found in ArcXML response." : (i = this.parseAttributes(i[0]), n = this.parseAttributes(e[0]), t.image = "string" == typeof n.type ? {
                envelope: i,
                output: {type: n.type, data: this.getChildValue(e[0])}
            } : {envelope: i, output: n}); else if ("FEATURES" == n) {
                if (e = i[0].getElementsByTagName("FEATURES"), i = e[0].getElementsByTagName("FEATURECOUNT"), t.features.featurecount = i[0].getAttribute("count"), 0 < t.features.featurecount)for (i = e[0].getElementsByTagName("ENVELOPE"), t.features.envelope = this.parseAttributes(i[0], "number"), e = e[0].getElementsByTagName("FEATURE"), i = 0; i < e.length; i++) {
                    for (var n = new OpenLayers.Feature.Vector, s = e[i].getElementsByTagName("FIELD"), r = 0; r < s.length; r++) {
                        var a = s[r].getAttribute("name"), o = s[r].getAttribute("value");
                        n.attributes[a] = o
                    }
                    if (s = e[i].getElementsByTagName("POLYGON"), 0 < s.length) {
                        for (s = s[0].getElementsByTagName("RING"), r = [], a = 0; a < s.length; a++) {
                            o = [], o.push(this.parsePointGeometry(s[a]));
                            for (var l = s[a].getElementsByTagName("HOLE"), h = 0; h < l.length; h++)o.push(this.parsePointGeometry(l[h]));
                            r.push(new OpenLayers.Geometry.Polygon(o))
                        }
                        n.geometry = 1 == r.length ? r[0] : new OpenLayers.Geometry.MultiPolygon(r)
                    }
                    t.features.feature.push(n)
                }
            } else t.error = "Unidentified response type."
        }
        return t
    },
    parseAttributes: function (e, t) {
        for (var i = {}, n = 0; n < e.attributes.length; n++)i[e.attributes[n].nodeName] = "number" == t ? parseFloat(e.attributes[n].nodeValue) : e.attributes[n].nodeValue;
        return i
    },
    parsePointGeometry: function (e) {
        var t = [], i = e.getElementsByTagName("COORDS");
        if (0 < i.length)for (e = this.getChildValue(i[0]), e = e.split(/;/), i = 0; i < e.length; i++) {
            var n = e[i].split(/ /);
            t.push(new OpenLayers.Geometry.Point(n[0], n[1]))
        } else if (e = e.getElementsByTagName("POINT"), 0 < e.length)for (i = 0; i < e.length; i++)t.push(new OpenLayers.Geometry.Point(parseFloat(e[i].getAttribute("x")), parseFloat(e[i].getAttribute("y"))));
        return new OpenLayers.Geometry.LinearRing(t)
    },
    CLASS_NAME: "OpenLayers.Format.ArcXML"
}),OpenLayers.Format.ArcXML.Request = OpenLayers.Class({
    initialize: function () {
        return OpenLayers.Util.extend(this, {
            get_image: {
                properties: {
                    background: null,
                    draw: !0,
                    envelope: {minx: 0, miny: 0, maxx: 0, maxy: 0},
                    featurecoordsys: {id: 0, string: "", datumtransformid: 0, datumtransformstring: ""},
                    filtercoordsys: {id: 0, string: "", datumtransformid: 0, datumtransformstring: ""},
                    imagesize: {height: 0, width: 0, dpi: 96, printheight: 0, printwidth: 0, scalesymbols: !1},
                    layerlist: [],
                    output: {
                        baseurl: "",
                        legendbaseurl: "",
                        legendname: "",
                        legendpath: "",
                        legendurl: "",
                        name: "",
                        path: "",
                        type: "jpg",
                        url: ""
                    }
                }
            },
            get_feature: {
                layer: "",
                query: {
                    isspatial: !1,
                    featurecoordsys: {id: 0, string: "", datumtransformid: 0, datumtransformstring: ""},
                    filtercoordsys: {id: 0, string: "", datumtransformid: 0, datumtransformstring: ""},
                    buffer: 0,
                    where: "",
                    spatialfilter: {relation: "envelope_intersection", envelope: null}
                }
            },
            environment: {separators: {cs: " ", ts: ";"}},
            layer: [],
            workspaces: []
        })
    }, CLASS_NAME: "OpenLayers.Format.ArcXML.Request"
}),OpenLayers.Format.ArcXML.Response = OpenLayers.Class({
    initialize: function () {
        return OpenLayers.Util.extend(this, {
            image: {envelope: null, output: ""},
            features: {featurecount: 0, envelope: null, feature: []},
            error: ""
        })
    }, CLASS_NAME: "OpenLayers.Format.ArcXML.Response"
}),OpenLayers.ProxyHost = "",OpenLayers.Request = {
    DEFAULT_CONFIG: {
        method: "GET",
        url: window.location.href,
        async: !0,
        user: void 0,
        password: void 0,
        params: null,
        proxy: OpenLayers.ProxyHost,
        headers: {},
        data: null,
        callback: function () {
        },
        success: null,
        failure: null,
        scope: null
    },
    URL_SPLIT_REGEX: /([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/,
    events: new OpenLayers.Events(this),
    makeSameOrigin: function (e, t) {
        var i = 0 !== e.indexOf("http"), n = !i && e.match(this.URL_SPLIT_REGEX);
        if (n) {
            var s = window.location, i = n[1] == s.protocol && n[3] == s.hostname, n = n[4], s = s.port;
            (80 != n && "" != n || "80" != s && "" != s) && (i = i && n == s)
        }
        return i || (t ? e = "function" == typeof t ? t(e) : t + encodeURIComponent(e) : OpenLayers.Console.warn(OpenLayers.i18n("proxyNeeded"), {url: e})), e
    },
    issue: function (e) {
        var t, i = OpenLayers.Util.extend(this.DEFAULT_CONFIG, {proxy: OpenLayers.ProxyHost}), e = OpenLayers.Util.applyDefaults(e, i), i = !1;
        for (t in e.headers)e.headers.hasOwnProperty(t) && "x-requested-with" === t.toLowerCase() && (i = !0);
        !1 === i && (e.headers["X-Requested-With"] = "XMLHttpRequest");
        var n = new OpenLayers.Request.XMLHttpRequest, s = OpenLayers.Util.urlAppend(e.url, OpenLayers.Util.getParameterString(e.params || {})), s = OpenLayers.Request.makeSameOrigin(s, e.proxy);
        n.open(e.method, s, e.async, e.user, e.password);
        for (var r in e.headers)n.setRequestHeader(r, e.headers[r]);
        var a = this.events, o = this;
        return n.onreadystatechange = function () {
            n.readyState == OpenLayers.Request.XMLHttpRequest.DONE && !1 !== a.triggerEvent("complete", {
                request: n,
                config: e,
                requestUrl: s
            }) && o.runCallbacks({request: n, config: e, requestUrl: s})
        }, !1 === e.async ? n.send(e.data) : window.setTimeout(function () {
            0 !== n.readyState && n.send(e.data)
        }, 0), n
    },
    runCallbacks: function (e) {
        var t, i = e.request, n = e.config, s = n.scope ? OpenLayers.Function.bind(n.callback, n.scope) : n.callback;
        n.success && (t = n.scope ? OpenLayers.Function.bind(n.success, n.scope) : n.success);
        var r;
        n.failure && (r = n.scope ? OpenLayers.Function.bind(n.failure, n.scope) : n.failure), "file:" == OpenLayers.Util.createUrlObject(n.url).protocol && i.responseText && (i.status = 200), s(i), (!i.status || 200 <= i.status && 300 > i.status) && (this.events.triggerEvent("success", e), t && t(i)), i.status && (200 > i.status || 300 <= i.status) && (this.events.triggerEvent("failure", e), r && r(i))
    },
    GET: function (e) {
        return e = OpenLayers.Util.extend(e, {method: "GET"}), OpenLayers.Request.issue(e)
    },
    POST: function (e) {
        return e = OpenLayers.Util.extend(e, {method: "POST"}), e.headers = e.headers ? e.headers : {}, "CONTENT-TYPE" in OpenLayers.Util.upperCaseObject(e.headers) || (e.headers["Content-Type"] = "application/xml"), OpenLayers.Request.issue(e)
    },
    PUT: function (e) {
        return e = OpenLayers.Util.extend(e, {method: "PUT"}), e.headers = e.headers ? e.headers : {}, "CONTENT-TYPE" in OpenLayers.Util.upperCaseObject(e.headers) || (e.headers["Content-Type"] = "application/xml"), OpenLayers.Request.issue(e)
    },
    DELETE: function (e) {
        return e = OpenLayers.Util.extend(e, {method: "DELETE"}), OpenLayers.Request.issue(e)
    },
    HEAD: function (e) {
        return e = OpenLayers.Util.extend(e, {method: "HEAD"}), OpenLayers.Request.issue(e)
    },
    OPTIONS: function (e) {
        return e = OpenLayers.Util.extend(e, {method: "OPTIONS"}), OpenLayers.Request.issue(e)
    }
},OpenLayers.Layer.ArcIMS = OpenLayers.Class(OpenLayers.Layer.Grid, {
    DEFAULT_PARAMS: {
        ClientVersion: "9.2",
        ServiceName: ""
    },
    featureCoordSys: "4326",
    filterCoordSys: "4326",
    layers: null,
    async: !0,
    name: "ArcIMS",
    isBaseLayer: !0,
    DEFAULT_OPTIONS: {
        tileSize: new OpenLayers.Size(512, 512),
        featureCoordSys: "4326",
        filterCoordSys: "4326",
        layers: null,
        isBaseLayer: !0,
        async: !0,
        name: "ArcIMS"
    },
    initialize: function (e, t, i) {
        this.tileSize = new OpenLayers.Size(512, 512), this.params = OpenLayers.Util.applyDefaults({ServiceName: i.serviceName}, this.DEFAULT_PARAMS), this.options = OpenLayers.Util.applyDefaults(i, this.DEFAULT_OPTIONS), OpenLayers.Layer.Grid.prototype.initialize.apply(this, [e, t, this.params, i]), this.transparent && (this.isBaseLayer || (this.isBaseLayer = !1), "image/jpeg" == this.format) && (this.format = OpenLayers.Util.alphaHack() ? "image/gif" : "image/png"), null === this.options.layers && (this.options.layers = [])
    },
    getURL: function (e) {
        var t = "", e = this.adjustBounds(e), e = new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options, {
            requesttype: "image",
            envelope: e.toArray(),
            tileSize: this.tileSize
        })), e = new OpenLayers.Request.POST({url: this.getFullRequestString(), data: e.write(), async: !1});
        return null != e && (t = e.responseXML, t && t.documentElement || (t = e.responseText), t = this.getUrlOrImage((new OpenLayers.Format.ArcXML).read(t).image.output)), t
    },
    getURLasync: function (e, t, i) {
        e = this.adjustBounds(e), e = new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options, {
            requesttype: "image",
            envelope: e.toArray(),
            tileSize: this.tileSize
        })), OpenLayers.Request.POST({
            url: this.getFullRequestString(),
            async: !0,
            data: e.write(),
            callback: function (e) {
                var n = e.responseXML;
                n && n.documentElement || (n = e.responseText), e = (new OpenLayers.Format.ArcXML).read(n), t.call(i, this.getUrlOrImage(e.image.output))
            },
            scope: this
        })
    },
    getUrlOrImage: function (e) {
        var t = "";
        return e.url ? t = e.url : e.data && (t = "data:image/" + e.type + ";base64," + e.data), t
    },
    setLayerQuery: function (e, t) {
        for (var i = 0; i < this.options.layers.length; i++)if (e == this.options.layers[i].id)return this.options.layers[i].query = t, void 0;
        this.options.layers.push({id: e, visible: !0, query: t})
    },
    getFeatureInfo: function (e, t, i) {
        var n = i.buffer || 1, s = i.callback || function () {
            }, r = i.scope || window, a = {};
        OpenLayers.Util.extend(a, this.options), a.requesttype = "feature", e instanceof OpenLayers.LonLat ? (a.polygon = null, a.envelope = [e.lon - n, e.lat - n, e.lon + n, e.lat + n]) : e instanceof OpenLayers.Geometry.Polygon && (a.envelope = null, a.polygon = e);
        var o = new OpenLayers.Format.ArcXML(a);
        OpenLayers.Util.extend(o.request.get_feature, i), o.request.get_feature.layer = t.id, "number" == typeof t.query.accuracy ? o.request.get_feature.query.accuracy = t.query.accuracy : (e = this.map.getCenter(), i = this.map.getViewPortPxFromLonLat(e), i.x++, i = this.map.getLonLatFromPixel(i), o.request.get_feature.query.accuracy = i.lon - e.lon), o.request.get_feature.query.where = t.query.where, o.request.get_feature.query.spatialfilter.relation = "area_intersection", OpenLayers.Request.POST({
            url: this.getFullRequestString({CustomService: "Query"}),
            data: o.write(),
            callback: function (e) {
                e = o.parseResponse(e.responseText), o.iserror() ? s.call(r, null) : s.call(r, e.features)
            }
        })
    },
    clone: function (e) {
        return null == e && (e = new OpenLayers.Layer.ArcIMS(this.name, this.url, this.getOptions())), e = OpenLayers.Layer.Grid.prototype.clone.apply(this, [e])
    },
    CLASS_NAME: "OpenLayers.Layer.ArcIMS"
}),OpenLayers.Format.OWSCommon.v1_1_0 = OpenLayers.Class(OpenLayers.Format.OWSCommon.v1, {
    namespaces: {
        ows: "http://www.opengis.net/ows/1.1",
        xlink: "http://www.w3.org/1999/xlink"
    }, readers: {
        ows: OpenLayers.Util.applyDefaults({
            ExceptionReport: function (e, t) {
                t.exceptionReport = {
                    version: e.getAttribute("version"),
                    language: e.getAttribute("xml:lang"),
                    exceptions: []
                }, this.readChildNodes(e, t.exceptionReport)
            }, AllowedValues: function (e, t) {
                t.allowedValues = {}, this.readChildNodes(e, t.allowedValues)
            }, AnyValue: function (e, t) {
                t.anyValue = !0
            }, DataType: function (e, t) {
                t.dataType = this.getChildValue(e)
            }, Range: function (e, t) {
                t.range = {}, this.readChildNodes(e, t.range)
            }, MinimumValue: function (e, t) {
                t.minValue = this.getChildValue(e)
            }, MaximumValue: function (e, t) {
                t.maxValue = this.getChildValue(e)
            }, Identifier: function (e, t) {
                t.identifier = this.getChildValue(e)
            }, SupportedCRS: function (e, t) {
                t.supportedCRS = this.getChildValue(e)
            }
        }, OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)
    }, writers: {
        ows: OpenLayers.Util.applyDefaults({
            Range: function (e) {
                var t = this.createElementNSPlus("ows:Range", {attributes: {"ows:rangeClosure": e.closure}});
                return this.writeNode("ows:MinimumValue", e.minValue, t), this.writeNode("ows:MaximumValue", e.maxValue, t), t
            }, MinimumValue: function (e) {
                return this.createElementNSPlus("ows:MinimumValue", {value: e})
            }, MaximumValue: function (e) {
                return this.createElementNSPlus("ows:MaximumValue", {value: e})
            }, Value: function (e) {
                return this.createElementNSPlus("ows:Value", {value: e})
            }
        }, OpenLayers.Format.OWSCommon.v1.prototype.writers.ows)
    }, CLASS_NAME: "OpenLayers.Format.OWSCommon.v1_1_0"
}),OpenLayers.Format.WCSGetCoverage = OpenLayers.Class(OpenLayers.Format.XML, {
    namespaces: {
        ows: "http://www.opengis.net/ows/1.1",
        wcs: "http://www.opengis.net/wcs/1.1",
        xlink: "http://www.w3.org/1999/xlink",
        xsi: "http://www.w3.org/2001/XMLSchema-instance"
    },
    regExes: {trimSpace: /^\s*|\s*$/g, removeSpace: /\s*/g, splitSpace: /\s+/, trimComma: /\s*,\s*/g},
    VERSION: "1.1.2",
    schemaLocation: "http://www.opengis.net/wcs/1.1 http://schemas.opengis.net/wcs/1.1/wcsGetCoverage.xsd",
    write: function (e) {
        return e = this.writeNode("wcs:GetCoverage", e), this.setAttributeNS(e, this.namespaces.xsi, "xsi:schemaLocation", this.schemaLocation), OpenLayers.Format.XML.prototype.write.apply(this, [e])
    },
    writers: {
        wcs: {
            GetCoverage: function (e) {
                var t = this.createElementNSPlus("wcs:GetCoverage", {
                    attributes: {
                        version: e.version || this.VERSION,
                        service: "WCS"
                    }
                });
                return this.writeNode("ows:Identifier", e.identifier, t), this.writeNode("wcs:DomainSubset", e.domainSubset, t), this.writeNode("wcs:Output", e.output, t), t
            }, DomainSubset: function (e) {
                var t = this.createElementNSPlus("wcs:DomainSubset", {});
                return this.writeNode("ows:BoundingBox", e.boundingBox, t), e.temporalSubset && this.writeNode("wcs:TemporalSubset", e.temporalSubset, t), t
            }, TemporalSubset: function (e) {
                for (var t = this.createElementNSPlus("wcs:TemporalSubset", {}), i = 0, n = e.timePeriods.length; n > i; ++i)this.writeNode("wcs:TimePeriod", e.timePeriods[i], t);
                return t
            }, TimePeriod: function (e) {
                var t = this.createElementNSPlus("wcs:TimePeriod", {});
                return this.writeNode("wcs:BeginPosition", e.begin, t), this.writeNode("wcs:EndPosition", e.end, t), e.resolution && this.writeNode("wcs:TimeResolution", e.resolution, t), t
            }, BeginPosition: function (e) {
                return this.createElementNSPlus("wcs:BeginPosition", {value: e})
            }, EndPosition: function (e) {
                return this.createElementNSPlus("wcs:EndPosition", {value: e})
            }, TimeResolution: function (e) {
                return this.createElementNSPlus("wcs:TimeResolution", {value: e})
            }, Output: function (e) {
                var t = this.createElementNSPlus("wcs:Output", {attributes: {format: e.format, store: e.store}});
                return e.gridCRS && this.writeNode("wcs:GridCRS", e.gridCRS, t), t
            }, GridCRS: function (e) {
                var t = this.createElementNSPlus("wcs:GridCRS", {});
                return this.writeNode("wcs:GridBaseCRS", e.baseCRS, t), e.type && this.writeNode("wcs:GridType", e.type, t), e.origin && this.writeNode("wcs:GridOrigin", e.origin, t), this.writeNode("wcs:GridOffsets", e.offsets, t), e.CS && this.writeNode("wcs:GridCS", e.CS, t), t
            }, GridBaseCRS: function (e) {
                return this.createElementNSPlus("wcs:GridBaseCRS", {value: e})
            }, GridOrigin: function (e) {
                return this.createElementNSPlus("wcs:GridOrigin", {value: e})
            }, GridType: function (e) {
                return this.createElementNSPlus("wcs:GridType", {value: e})
            }, GridOffsets: function (e) {
                return this.createElementNSPlus("wcs:GridOffsets", {value: e})
            }, GridCS: function (e) {
                return this.createElementNSPlus("wcs:GridCS", {value: e})
            }
        }, ows: OpenLayers.Format.OWSCommon.v1_1_0.prototype.writers.ows
    },
    CLASS_NAME: "OpenLayers.Format.WCSGetCoverage"
}),OpenLayers.Format.WPSExecute = OpenLayers.Class(OpenLayers.Format.XML, {
    namespaces: {
        ows: "http://www.opengis.net/ows/1.1",
        gml: "http://www.opengis.net/gml",
        wps: "http://www.opengis.net/wps/1.0.0",
        wfs: "http://www.opengis.net/wfs",
        ogc: "http://www.opengis.net/ogc",
        wcs: "http://www.opengis.net/wcs",
        xlink: "http://www.w3.org/1999/xlink",
        xsi: "http://www.w3.org/2001/XMLSchema-instance"
    },
    regExes: {trimSpace: /^\s*|\s*$/g, removeSpace: /\s*/g, splitSpace: /\s+/, trimComma: /\s*,\s*/g},
    VERSION: "1.0.0",
    schemaLocation: "http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd",
    schemaLocationAttr: function () {
    },
    write: function (e) {
        var t;
        return window.ActiveXObject ? this.xmldom = t = new ActiveXObject("Microsoft.XMLDOM") : t = document.implementation.createDocument("", "", null), e = this.writeNode("wps:Execute", e, t), this.setAttributeNS(e, this.namespaces.xsi, "xsi:schemaLocation", this.schemaLocation), OpenLayers.Format.XML.prototype.write.apply(this, [e])
    },
    writers: {
        wps: {
            Execute: function (e) {
                var t = this.createElementNSPlus("wps:Execute", {attributes: {version: this.VERSION, service: "WPS"}});
                return this.writeNode("ows:Identifier", e.identifier, t), this.writeNode("wps:DataInputs", e.dataInputs, t), this.writeNode("wps:ResponseForm", e.responseForm, t), t
            }, ResponseForm: function (e) {
                var t = this.createElementNSPlus("wps:ResponseForm", {});
                return e.rawDataOutput && this.writeNode("wps:RawDataOutput", e.rawDataOutput, t), e.responseDocument && this.writeNode("wps:ResponseDocument", e.responseDocument, t), t
            }, ResponseDocument: function (e) {
                var t = this.createElementNSPlus("wps:ResponseDocument", {
                    attributes: {
                        storeExecuteResponse: e.storeExecuteResponse,
                        lineage: e.lineage,
                        status: e.status
                    }
                });
                return e.output && this.writeNode("wps:Output", e.output, t), t
            }, Output: function (e) {
                var t = this.createElementNSPlus("wps:Output", {attributes: {asReference: e.asReference}});
                return this.writeNode("ows:Identifier", e.identifier, t), this.writeNode("ows:Title", e.title, t), this.writeNode("ows:Abstract", e["abstract"], t), t
            }, RawDataOutput: function (e) {
                var t = this.createElementNSPlus("wps:RawDataOutput", {attributes: {mimeType: e.mimeType}});
                return this.writeNode("ows:Identifier", e.identifier, t), t
            }, DataInputs: function (e) {
                for (var t = this.createElementNSPlus("wps:DataInputs", {}), i = 0, n = e.length; n > i; ++i)this.writeNode("wps:Input", e[i], t);
                return t
            }, Input: function (e) {
                var t = this.createElementNSPlus("wps:Input", {});
                return this.writeNode("ows:Identifier", e.identifier, t), e.title && this.writeNode("ows:Title", e.title, t), e.data && this.writeNode("wps:Data", e.data, t), e.reference && this.writeNode("wps:Reference", e.reference, t), t
            }, Data: function (e) {
                var t = this.createElementNSPlus("wps:Data", {});
                return e.literalData ? this.writeNode("wps:LiteralData", e.literalData, t) : e.complexData && this.writeNode("wps:ComplexData", e.complexData, t), t
            }, LiteralData: function (e) {
                return this.createElementNSPlus("wps:LiteralData", {attributes: {uom: e.uom}, value: e.value})
            }, ComplexData: function (e) {
                var t = this.createElementNSPlus("wps:ComplexData", {
                    attributes: {
                        mimeType: e.mimeType,
                        encoding: e.encoding,
                        schema: e.schema
                    }
                }), i = e.value;
                return "string" == typeof i ? t.appendChild(this.getXMLDoc().createCDATASection(e.value)) : t.appendChild(i), t
            }, Reference: function (e) {
                var t = this.createElementNSPlus("wps:Reference", {
                    attributes: {
                        mimeType: e.mimeType,
                        "xlink:href": e.href,
                        method: e.method,
                        encoding: e.encoding,
                        schema: e.schema
                    }
                });
                return e.body && this.writeNode("wps:Body", e.body, t), t
            }, Body: function (e) {
                var t = this.createElementNSPlus("wps:Body", {});
                return e.wcs ? this.writeNode("wcs:GetCoverage", e.wcs, t) : e.wfs ? (this.featureType = e.wfs.featureType, this.version = e.wfs.version, this.writeNode("wfs:GetFeature", e.wfs, t)) : this.writeNode("wps:Execute", e, t), t
            }
        },
        wcs: OpenLayers.Format.WCSGetCoverage.prototype.writers.wcs,
        wfs: OpenLayers.Format.WFST.v1_1_0.prototype.writers.wfs,
        ogc: OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc,
        ows: OpenLayers.Format.OWSCommon.v1_1_0.prototype.writers.ows
    },
    CLASS_NAME: "OpenLayers.Format.WPSExecute"
}),OpenLayers.Control.PanZoom = OpenLayers.Class(OpenLayers.Control, {
    slideFactor: 50,
    slideRatio: null,
    buttons: null,
    position: null,
    initialize: function () {
        this.position = new OpenLayers.Pixel(OpenLayers.Control.PanZoom.X, OpenLayers.Control.PanZoom.Y), OpenLayers.Control.prototype.initialize.apply(this, arguments)
    },
    destroy: function () {
        this.map && this.map.events.unregister("buttonclick", this, this.onButtonClick), this.removeButtons(), this.position = this.buttons = null, OpenLayers.Control.prototype.destroy.apply(this, arguments)
    },
    setMap: function () {
        OpenLayers.Control.prototype.setMap.apply(this, arguments), this.map.events.register("buttonclick", this, this.onButtonClick)
    },
    draw: function (e) {
        OpenLayers.Control.prototype.draw.apply(this, arguments), e = this.position, this.buttons = [];
        var t = {w: 18, h: 18}, i = new OpenLayers.Pixel(e.x + t.w / 2, e.y);
        return this._addButton("panup", "north-mini.png", i, t), e.y = i.y + t.h, this._addButton("panleft", "west-mini.png", e, t), this._addButton("panright", "east-mini.png", e.add(t.w, 0), t), this._addButton("pandown", "south-mini.png", i.add(0, 2 * t.h), t), this._addButton("zoomin", "zoom-plus-mini.png", i.add(0, 3 * t.h + 5), t), this._addButton("zoomworld", "zoom-world-mini.png", i.add(0, 4 * t.h + 5), t), this._addButton("zoomout", "zoom-minus-mini.png", i.add(0, 5 * t.h + 5), t), this.div
    },
    _addButton: function (e, t, i, n) {
        return t = OpenLayers.Util.getImageLocation(t), i = OpenLayers.Util.createAlphaImageDiv(this.id + "_" + e, i, n, t, "absolute"), i.style.cursor = "pointer", this.div.appendChild(i), i.action = e, i.className = "olButton", this.buttons.push(i), i
    },
    _removeButton: function (e) {
        this.div.removeChild(e), OpenLayers.Util.removeItem(this.buttons, e)
    },
    removeButtons: function () {
        for (var e = this.buttons.length - 1; e >= 0; --e)this._removeButton(this.buttons[e])
    },
    onButtonClick: function (e) {
        switch (e.buttonElement.action) {
            case"panup":
                this.map.pan(0, -this.getSlideFactor("h"));
                break;
            case"pandown":
                this.map.pan(0, this.getSlideFactor("h"));
                break;
            case"panleft":
                this.map.pan(-this.getSlideFactor("w"), 0);
                break;
            case"panright":
                this.map.pan(this.getSlideFactor("w"), 0);
                break;
            case"zoomin":
                this.map.zoomIn();
                break;
            case"zoomout":
                this.map.zoomOut();
                break;
            case"zoomworld":
                this.map.zoomToMaxExtent()
        }
    },
    getSlideFactor: function (e) {
        return this.slideRatio ? this.map.getSize()[e] * this.slideRatio : this.slideFactor
    },
    CLASS_NAME: "OpenLayers.Control.PanZoom"
}),OpenLayers.Control.PanZoom.X = 4,OpenLayers.Control.PanZoom.Y = 4,OpenLayers.Control.PanZoomBar = OpenLayers.Class(OpenLayers.Control.PanZoom, {
    zoomStopWidth: 18,
    zoomStopHeight: 11,
    slider: null,
    sliderEvents: null,
    zoombarDiv: null,
    zoomWorldIcon: !1,
    panIcons: !0,
    forceFixedZoomLevel: !1,
    mouseDragStart: null,
    deltaY: null,
    zoomStart: null,
    destroy: function () {
        this._removeZoomBar(), this.map.events.un({
            changebaselayer: this.redraw,
            scope: this
        }), OpenLayers.Control.PanZoom.prototype.destroy.apply(this, arguments), delete this.mouseDragStart, delete this.zoomStart
    },
    setMap: function () {
        OpenLayers.Control.PanZoom.prototype.setMap.apply(this, arguments), this.map.events.register("changebaselayer", this, this.redraw)
    },
    redraw: function () {
        null != this.div && (this.removeButtons(), this._removeZoomBar()), this.draw()
    },
    draw: function (e) {
        OpenLayers.Control.prototype.draw.apply(this, arguments), e = this.position.clone(), this.buttons = [];
        var t = {w: 18, h: 18};
        if (this.panIcons) {
            var i = new OpenLayers.Pixel(e.x + t.w / 2, e.y), n = t.w;
            this.zoomWorldIcon && (i = new OpenLayers.Pixel(e.x + t.w, e.y)), this._addButton("panup", "north-mini.png", i, t), e.y = i.y + t.h, this._addButton("panleft", "west-mini.png", e, t), this.zoomWorldIcon && (this._addButton("zoomworld", "zoom-world-mini.png", e.add(t.w, 0), t), n *= 2), this._addButton("panright", "east-mini.png", e.add(n, 0), t), this._addButton("pandown", "south-mini.png", i.add(0, 2 * t.h), t), this._addButton("zoomin", "zoom-plus-mini.png", i.add(0, 3 * t.h + 5), t), i = this._addZoomBar(i.add(0, 4 * t.h + 5)), this._addButton("zoomout", "zoom-minus-mini.png", i, t)
        } else this._addButton("zoomin", "zoom-plus-mini.png", e, t), i = this._addZoomBar(e.add(0, t.h)), this._addButton("zoomout", "zoom-minus-mini.png", i, t), this.zoomWorldIcon && (i = i.add(0, t.h + 3), this._addButton("zoomworld", "zoom-world-mini.png", i, t));
        return this.div
    },
    _addZoomBar: function (e) {
        var t = OpenLayers.Util.getImageLocation("slider.png"), i = this.id + "_" + this.map.id, n = this.map.getNumZoomLevels() - 1 - this.map.getZoom(), n = OpenLayers.Util.createAlphaImageDiv(i, e.add(-1, n * this.zoomStopHeight), {
            w: 20,
            h: 9
        }, t, "absolute");
        n.style.cursor = "move", this.slider = n, this.sliderEvents = new OpenLayers.Events(this, n, null, !0, {includeXY: !0}), this.sliderEvents.on({
            touchstart: this.zoomBarDown,
            touchmove: this.zoomBarDrag,
            touchend: this.zoomBarUp,
            mousedown: this.zoomBarDown,
            mousemove: this.zoomBarDrag,
            mouseup: this.zoomBarUp
        });
        var s = {
            w: this.zoomStopWidth,
            h: this.zoomStopHeight * this.map.getNumZoomLevels()
        }, t = OpenLayers.Util.getImageLocation("zoombar.png"), i = null;
        return OpenLayers.Util.alphaHack() ? (i = this.id + "_" + this.map.id, i = OpenLayers.Util.createAlphaImageDiv(i, e, {
            w: s.w,
            h: this.zoomStopHeight
        }, t, "absolute", null, "crop"), i.style.height = s.h + "px") : i = OpenLayers.Util.createDiv("OpenLayers_Control_PanZoomBar_Zoombar" + this.map.id, e, s, t), i.style.cursor = "pointer", i.className = "olButton", this.zoombarDiv = i, this.div.appendChild(i), this.startTop = parseInt(i.style.top), this.div.appendChild(n), this.map.events.register("zoomend", this, this.moveZoomBar), e = e.add(0, this.zoomStopHeight * this.map.getNumZoomLevels())
    },
    _removeZoomBar: function () {
        this.sliderEvents.un({
            touchstart: this.zoomBarDown,
            touchmove: this.zoomBarDrag,
            touchend: this.zoomBarUp,
            mousedown: this.zoomBarDown,
            mousemove: this.zoomBarDrag,
            mouseup: this.zoomBarUp
        }), this.sliderEvents.destroy(), this.div.removeChild(this.zoombarDiv), this.zoombarDiv = null, this.div.removeChild(this.slider), this.slider = null, this.map.events.unregister("zoomend", this, this.moveZoomBar)
    },
    onButtonClick: function (e) {
        if (OpenLayers.Control.PanZoom.prototype.onButtonClick.apply(this, arguments), e.buttonElement === this.zoombarDiv) {
            var t = e.buttonXY.y / this.zoomStopHeight;
            (this.forceFixedZoomLevel || !this.map.fractionalZoom) && (t = Math.floor(t)), t = this.map.getNumZoomLevels() - 1 - t, t = Math.min(Math.max(t, 0), this.map.getNumZoomLevels() - 1), this.map.zoomTo(t)
        }
    },
    passEventToSlider: function (e) {
        this.sliderEvents.handleBrowserEvent(e)
    },
    zoomBarDown: function (e) {
        (OpenLayers.Event.isLeftClick(e) || OpenLayers.Event.isSingleTouch(e)) && (this.map.events.on({
            touchmove: this.passEventToSlider,
            mousemove: this.passEventToSlider,
            mouseup: this.passEventToSlider,
            scope: this
        }), this.mouseDragStart = e.xy.clone(), this.zoomStart = e.xy.clone(), this.div.style.cursor = "move", this.zoombarDiv.offsets = null, OpenLayers.Event.stop(e))
    },
    zoomBarDrag: function (e) {
        if (null != this.mouseDragStart) {
            var t = this.mouseDragStart.y - e.xy.y, i = OpenLayers.Util.pagePosition(this.zoombarDiv);
            0 < e.clientY - i[1] && e.clientY - i[1] < parseInt(this.zoombarDiv.style.height) - 2 && (this.slider.style.top = parseInt(this.slider.style.top) - t + "px", this.mouseDragStart = e.xy.clone()), this.deltaY = this.zoomStart.y - e.xy.y, OpenLayers.Event.stop(e)
        }
    },
    zoomBarUp: function (e) {
        if ((OpenLayers.Event.isLeftClick(e) || "touchend" === e.type) && this.mouseDragStart) {
            this.div.style.cursor = "", this.map.events.un({
                touchmove: this.passEventToSlider,
                mouseup: this.passEventToSlider,
                mousemove: this.passEventToSlider,
                scope: this
            });
            var t = this.map.zoom;
            !this.forceFixedZoomLevel && this.map.fractionalZoom ? (t += this.deltaY / this.zoomStopHeight, t = Math.min(Math.max(t, 0), this.map.getNumZoomLevels() - 1)) : (t += this.deltaY / this.zoomStopHeight, t = Math.max(Math.round(t), 0)), this.map.zoomTo(t), this.zoomStart = this.mouseDragStart = null, this.deltaY = 0, OpenLayers.Event.stop(e)
        }
    },
    moveZoomBar: function () {
        this.slider.style.top = (this.map.getNumZoomLevels() - 1 - this.map.getZoom()) * this.zoomStopHeight + this.startTop + 1 + "px"
    },
    CLASS_NAME: "OpenLayers.Control.PanZoomBar"
}),OpenLayers.Format.WFSCapabilities = OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC, {
    defaultVersion: "1.1.0",
    errorProperty: "service",
    CLASS_NAME: "OpenLayers.Format.WFSCapabilities"
}),OpenLayers.Format.WFSCapabilities.v1 = OpenLayers.Class(OpenLayers.Format.XML, {
    namespaces: {
        wfs: "http://www.opengis.net/wfs",
        xlink: "http://www.w3.org/1999/xlink",
        xsi: "http://www.w3.org/2001/XMLSchema-instance",
        ows: "http://www.opengis.net/ows"
    }, defaultPrefix: "wfs", read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e])), e && 9 == e.nodeType && (e = e.documentElement);
        var t = {};
        return this.readNode(e, t), t
    }, readers: {
        wfs: {
            WFS_Capabilities: function (e, t) {
                this.readChildNodes(e, t)
            }, FeatureTypeList: function (e, t) {
                t.featureTypeList = {featureTypes: []}, this.readChildNodes(e, t.featureTypeList)
            }, FeatureType: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), t.featureTypes.push(i)
            }, Name: function (e, t) {
                var i = this.getChildValue(e);
                i && (i = i.split(":"), t.name = i.pop(), 0 < i.length && (t.featureNS = this.lookupNamespaceURI(e, i[0])))
            }, Title: function (e, t) {
                var i = this.getChildValue(e);
                i && (t.title = i)
            }, Abstract: function (e, t) {
                var i = this.getChildValue(e);
                i && (t["abstract"] = i)
            }
        }
    }, CLASS_NAME: "OpenLayers.Format.WFSCapabilities.v1"
}),OpenLayers.Format.WFSCapabilities.v1_1_0 = OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1, {
    regExes: {
        trimSpace: /^\s*|\s*$/g,
        removeSpace: /\s*/g,
        splitSpace: /\s+/,
        trimComma: /\s*,\s*/g
    }, readers: {
        wfs: OpenLayers.Util.applyDefaults({
            DefaultSRS: function (e, t) {
                var i = this.getChildValue(e);
                i && (t.srs = i)
            }
        }, OpenLayers.Format.WFSCapabilities.v1.prototype.readers.wfs),
        ows: OpenLayers.Format.OWSCommon.v1.prototype.readers.ows
    }, CLASS_NAME: "OpenLayers.Format.WFSCapabilities.v1_1_0"
}),OpenLayers.Layer.Image = OpenLayers.Class(OpenLayers.Layer, {
    isBaseLayer: !0,
    url: null,
    extent: null,
    size: null,
    tile: null,
    aspectRatio: null,
    initialize: function (e, t, i, n, s) {
        this.url = t, this.maxExtent = this.extent = i, this.size = n, OpenLayers.Layer.prototype.initialize.apply(this, [e, s]), this.aspectRatio = this.extent.getHeight() / this.size.h / (this.extent.getWidth() / this.size.w)
    },
    destroy: function () {
        this.tile && (this.removeTileMonitoringHooks(this.tile), this.tile.destroy(), this.tile = null), OpenLayers.Layer.prototype.destroy.apply(this, arguments)
    },
    clone: function (e) {
        return null == e && (e = new OpenLayers.Layer.Image(this.name, this.url, this.extent, this.size, this.getOptions())), e = OpenLayers.Layer.prototype.clone.apply(this, [e])
    },
    setMap: function () {
        null == this.options.maxResolution && (this.options.maxResolution = this.aspectRatio * this.extent.getWidth() / this.size.w), OpenLayers.Layer.prototype.setMap.apply(this, arguments)
    },
    moveTo: function (e, t) {
        OpenLayers.Layer.prototype.moveTo.apply(this, arguments);
        var i = null == this.tile;
        if (t || i) {
            this.setTileSize();
            var n = this.map.getLayerPxFromLonLat({lon: this.extent.left, lat: this.extent.top});
            i ? (this.tile = new OpenLayers.Tile.Image(this, n, this.extent, null, this.tileSize), this.addTileMonitoringHooks(this.tile)) : (this.tile.size = this.tileSize.clone(), this.tile.position = n.clone()), this.tile.draw()
        }
    },
    setTileSize: function () {
        var e = this.extent.getWidth() / this.map.getResolution(), t = this.extent.getHeight() / this.map.getResolution();
        this.tileSize = new OpenLayers.Size(e, t)
    },
    addTileMonitoringHooks: function (e) {
        e.onLoadStart = function () {
            this.events.triggerEvent("loadstart")
        }, e.events.register("loadstart", this, e.onLoadStart), e.onLoadEnd = function () {
            this.events.triggerEvent("loadend")
        }, e.events.register("loadend", this, e.onLoadEnd), e.events.register("unload", this, e.onLoadEnd)
    },
    removeTileMonitoringHooks: function (e) {
        e.unload(), e.events.un({loadstart: e.onLoadStart, loadend: e.onLoadEnd, unload: e.onLoadEnd, scope: this})
    },
    setUrl: function (e) {
        this.url = e, this.tile.draw()
    },
    getURL: function () {
        return this.url
    },
    CLASS_NAME: "OpenLayers.Layer.Image"
}),OpenLayers.Strategy = OpenLayers.Class({
    layer: null,
    options: null,
    active: null,
    autoActivate: !0,
    autoDestroy: !0,
    initialize: function (e) {
        OpenLayers.Util.extend(this, e), this.options = e, this.active = !1
    },
    destroy: function () {
        this.deactivate(), this.options = this.layer = null
    },
    setLayer: function (e) {
        this.layer = e
    },
    activate: function () {
        return this.active ? !1 : this.active = !0
    },
    deactivate: function () {
        return this.active ? (this.active = !1, !0) : !1
    },
    CLASS_NAME: "OpenLayers.Strategy"
}),OpenLayers.Strategy.Save = OpenLayers.Class(OpenLayers.Strategy, {
    events: null,
    auto: !1,
    timer: null,
    initialize: function (e) {
        OpenLayers.Strategy.prototype.initialize.apply(this, [e]), this.events = new OpenLayers.Events(this)
    },
    activate: function () {
        var e = OpenLayers.Strategy.prototype.activate.call(this);
        return e && this.auto && ("number" == typeof this.auto ? this.timer = window.setInterval(OpenLayers.Function.bind(this.save, this), 1e3 * this.auto) : this.layer.events.on({
            featureadded: this.triggerSave,
            afterfeaturemodified: this.triggerSave,
            scope: this
        })), e
    },
    deactivate: function () {
        var e = OpenLayers.Strategy.prototype.deactivate.call(this);
        return e && this.auto && ("number" == typeof this.auto ? window.clearInterval(this.timer) : this.layer.events.un({
            featureadded: this.triggerSave,
            afterfeaturemodified: this.triggerSave,
            scope: this
        })), e
    },
    triggerSave: function (e) {
        var t = e.feature;
        (t.state === OpenLayers.State.INSERT || t.state === OpenLayers.State.UPDATE || t.state === OpenLayers.State.DELETE) && this.save([e.feature])
    },
    save: function (e) {
        e || (e = this.layer.features), this.events.triggerEvent("start", {features: e});
        var t = this.layer.projection, i = this.layer.map.getProjectionObject();
        if (!i.equals(t)) {
            for (var n, s, r = e.length, a = Array(r), o = 0; r > o; ++o)n = e[o], s = n.clone(), s.fid = n.fid, s.state = n.state, n.url && (s.url = n.url), s._original = n, s.geometry.transform(i, t), a[o] = s;
            e = a
        }
        this.layer.protocol.commit(e, {callback: this.onCommit, scope: this})
    },
    onCommit: function (e) {
        var t = {response: e};
        if (e.success()) {
            for (var i, n = e.reqFeatures, s = [], r = e.insertIds || [], a = 0, o = 0, l = n.length; l > o; ++o)i = n[o], i = i._original || i, (e = i.state) && (e == OpenLayers.State.DELETE ? s.push(i) : e == OpenLayers.State.INSERT && (i.fid = r[a], ++a), i.state = null);
            0 < s.length && this.layer.destroyFeatures(s), this.events.triggerEvent("success", t)
        } else this.events.triggerEvent("fail", t)
    },
    CLASS_NAME: "OpenLayers.Strategy.Save"
}),OpenLayers.Format.GPX = OpenLayers.Class(OpenLayers.Format.XML, {
    defaultDesc: "No description available",
    extractWaypoints: !0,
    extractTracks: !0,
    extractRoutes: !0,
    extractAttributes: !0,
    namespaces: {gpx: "http://www.topografix.com/GPX/1/1", xsi: "http://www.w3.org/2001/XMLSchema-instance"},
    schemaLocation: "http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",
    creator: "OpenLayers",
    initialize: function (e) {
        this.externalProjection = new OpenLayers.Projection("EPSG:4326"), OpenLayers.Format.XML.prototype.initialize.apply(this, [e])
    },
    read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e]));
        var t = [];
        if (this.extractTracks)for (var i = e.getElementsByTagName("trk"), n = 0, s = i.length; s > n; n++) {
            var r = {};
            this.extractAttributes && (r = this.parseAttributes(i[n]));
            for (var a = this.getElementsByTagNameNS(i[n], i[n].namespaceURI, "trkseg"), o = 0, l = a.length; l > o; o++) {
                var h = this.extractSegment(a[o], "trkpt");
                t.push(new OpenLayers.Feature.Vector(h, r))
            }
        }
        if (this.extractRoutes)for (s = e.getElementsByTagName("rte"), i = 0, n = s.length; n > i; i++)r = {}, this.extractAttributes && (r = this.parseAttributes(s[i])), a = this.extractSegment(s[i], "rtept"), t.push(new OpenLayers.Feature.Vector(a, r));
        if (this.extractWaypoints)for (e = e.getElementsByTagName("wpt"), i = 0, s = e.length; s > i; i++)r = {}, this.extractAttributes && (r = this.parseAttributes(e[i])), n = new OpenLayers.Geometry.Point(e[i].getAttribute("lon"), e[i].getAttribute("lat")), t.push(new OpenLayers.Feature.Vector(n, r));
        if (this.internalProjection && this.externalProjection)for (r = 0, e = t.length; e > r; r++)t[r].geometry.transform(this.externalProjection, this.internalProjection);
        return t
    },
    extractSegment: function (e, t) {
        for (var i = this.getElementsByTagNameNS(e, e.namespaceURI, t), n = [], s = 0, r = i.length; r > s; s++)n.push(new OpenLayers.Geometry.Point(i[s].getAttribute("lon"), i[s].getAttribute("lat")));
        return new OpenLayers.Geometry.LineString(n)
    },
    parseAttributes: function (e) {
        for (var t, i, n = {}, e = e.firstChild; e;)1 == e.nodeType && e.firstChild && (t = e.firstChild, 3 == t.nodeType || 4 == t.nodeType) && (i = e.prefix ? e.nodeName.split(":")[1] : e.nodeName, "trkseg" != i && "rtept" != i && (n[i] = t.nodeValue)), e = e.nextSibling;
        return n
    },
    write: function (e, t) {
        var e = OpenLayers.Util.isArray(e) ? e : [e], i = this.createElementNS(this.namespaces.gpx, "gpx");
        i.setAttribute("version", "1.1"), i.setAttribute("creator", this.creator), this.setAttributes(i, {"xsi:schemaLocation": this.schemaLocation}), t && "object" == typeof t && i.appendChild(this.buildMetadataNode(t));
        for (var n = 0, s = e.length; s > n; n++)i.appendChild(this.buildFeatureNode(e[n]));
        return OpenLayers.Format.XML.prototype.write.apply(this, [i])
    },
    buildMetadataNode: function (e) {
        for (var t = ["name", "desc", "author"], i = this.createElementNSPlus("gpx:metadata"), n = 0; n < t.length; n++) {
            var s = t[n];
            if (e[s]) {
                var r = this.createElementNSPlus("gpx:" + s);
                r.appendChild(this.createTextNode(e[s])), i.appendChild(r)
            }
        }
        return i
    },
    buildFeatureNode: function (e) {
        var t = e.geometry, t = t.clone();
        if (this.internalProjection && this.externalProjection && t.transform(this.internalProjection, this.externalProjection), "OpenLayers.Geometry.Point" == t.CLASS_NAME) {
            var i = this.buildWptNode(t);
            return this.appendAttributesNode(i, e), i
        }
        i = this.createElementNSPlus("gpx:trk"), this.appendAttributesNode(i, e);
        for (var e = this.buildTrkSegNode(t), e = OpenLayers.Util.isArray(e) ? e : [e], t = 0, n = e.length; n > t; t++)i.appendChild(e[t]);
        return i
    },
    buildTrkSegNode: function (e) {
        var t, i, n, s;
        if ("OpenLayers.Geometry.LineString" == e.CLASS_NAME || "OpenLayers.Geometry.LinearRing" == e.CLASS_NAME) {
            for (t = this.createElementNSPlus("gpx:trkseg"), i = 0, n = e.components.length; n > i; i++)s = e.components[i], t.appendChild(this.buildTrkPtNode(s));
            return t
        }
        for (t = [], i = 0, n = e.components.length; n > i; i++)t.push(this.buildTrkSegNode(e.components[i]));
        return t
    },
    buildTrkPtNode: function (e) {
        var t = this.createElementNSPlus("gpx:trkpt");
        return t.setAttribute("lon", e.x), t.setAttribute("lat", e.y), t
    },
    buildWptNode: function (e) {
        var t = this.createElementNSPlus("gpx:wpt");
        return t.setAttribute("lon", e.x), t.setAttribute("lat", e.y), t
    },
    appendAttributesNode: function (e, t) {
        var i = this.createElementNSPlus("gpx:name");
        i.appendChild(this.createTextNode(t.attributes.name || t.id)), e.appendChild(i), i = this.createElementNSPlus("gpx:desc"), i.appendChild(this.createTextNode(t.attributes.description || this.defaultDesc)), e.appendChild(i)
    },
    CLASS_NAME: "OpenLayers.Format.GPX"
}),OpenLayers.Format.WMSDescribeLayer = OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC, {
    defaultVersion: "1.1.1",
    getVersion: function () {
        var e = OpenLayers.Format.XML.VersionedOGC.prototype.getVersion.apply(this, arguments);
        return ("1.1.1" == e || "1.1.0" == e) && (e = "1.1"), e
    },
    CLASS_NAME: "OpenLayers.Format.WMSDescribeLayer"
}),OpenLayers.Format.WMSDescribeLayer.v1_1 = OpenLayers.Class(OpenLayers.Format.WMSDescribeLayer, {
    initialize: function (e) {
        OpenLayers.Format.WMSDescribeLayer.prototype.initialize.apply(this, [e])
    }, read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e]));
        for (var t, i, e = e.documentElement.childNodes, n = [], s = 0; s < e.length; ++s)if (t = e[s], i = t.nodeName, "LayerDescription" == i) {
            i = t.getAttribute("name");
            var r = "", a = "", o = "";
            t.getAttribute("owsType") ? (r = t.getAttribute("owsType"), a = t.getAttribute("owsURL")) : "" != t.getAttribute("wfs") ? (r = "WFS", a = t.getAttribute("wfs")) : "" != t.getAttribute("wcs") && (r = "WCS", a = t.getAttribute("wcs")), t = t.getElementsByTagName("Query"), 0 < t.length && ((o = t[0].getAttribute("typeName")) || (o = t[0].getAttribute("typename"))), n.push({
                layerName: i,
                owsType: r,
                owsURL: a,
                typeName: o
            })
        }
        return n
    }, CLASS_NAME: "OpenLayers.Format.WMSDescribeLayer.v1_1"
}),OpenLayers.Layer.XYZ = OpenLayers.Class(OpenLayers.Layer.Grid, {
    isBaseLayer: !0,
    sphericalMercator: !1,
    zoomOffset: 0,
    serverResolutions: null,
    initialize: function (e, t, i) {
        (i && i.sphericalMercator || this.sphericalMercator) && (i = OpenLayers.Util.extend({
            projection: "EPSG:900913",
            numZoomLevels: 19
        }, i)), OpenLayers.Layer.Grid.prototype.initialize.apply(this, [e || this.name, t || this.url, {}, i])
    },
    clone: function (e) {
        return null == e && (e = new OpenLayers.Layer.XYZ(this.name, this.url, this.getOptions())), e = OpenLayers.Layer.Grid.prototype.clone.apply(this, [e])
    },
    getURL: function (e) {
        var e = this.getXYZ(e), t = this.url;
        return OpenLayers.Util.isArray(t) && (t = this.selectUrl("" + e.x + e.y + e.z, t)), OpenLayers.String.format(t, e)
    },
    getXYZ: function (e) {
        var t = this.getServerResolution(), i = Math.round((e.left - this.maxExtent.left) / (t * this.tileSize.w)), e = Math.round((this.maxExtent.top - e.top) / (t * this.tileSize.h)), t = this.getServerZoom();
        if (this.wrapDateLine)var n = Math.pow(2, t), i = (i % n + n) % n;
        return {x: i, y: e, z: t}
    },
    setMap: function () {
        OpenLayers.Layer.Grid.prototype.setMap.apply(this, arguments), this.tileOrigin || (this.tileOrigin = new OpenLayers.LonLat(this.maxExtent.left, this.maxExtent.bottom))
    },
    CLASS_NAME: "OpenLayers.Layer.XYZ"
}),OpenLayers.Layer.OSM = OpenLayers.Class(OpenLayers.Layer.XYZ, {
    name: "OpenStreetMap",
    url: ["http://a.tile.openstreetmap.org/${z}/${x}/${y}.png", "http://b.tile.openstreetmap.org/${z}/${x}/${y}.png", "http://c.tile.openstreetmap.org/${z}/${x}/${y}.png"],
    attribution: "Data CC-By-SA by <a href='http://openstreetmap.org/'>OpenStreetMap</a>",
    sphericalMercator: !0,
    wrapDateLine: !0,
    tileOptions: null,
    initialize: function () {
        OpenLayers.Layer.XYZ.prototype.initialize.apply(this, arguments), this.tileOptions = OpenLayers.Util.extend({crossOriginKeyword: "anonymous"}, this.options && this.options.tileOptions)
    },
    clone: function (e) {
        return null == e && (e = new OpenLayers.Layer.OSM(this.name, this.url, this.getOptions())), e = OpenLayers.Layer.XYZ.prototype.clone.apply(this, [e])
    },
    CLASS_NAME: "OpenLayers.Layer.OSM"
}),OpenLayers.Renderer = OpenLayers.Class({
    container: null,
    root: null,
    extent: null,
    locked: !1,
    size: null,
    resolution: null,
    map: null,
    featureDx: 0,
    initialize: function (e, t) {
        this.container = OpenLayers.Util.getElement(e), OpenLayers.Util.extend(this, t)
    },
    destroy: function () {
        this.map = this.resolution = this.size = this.extent = this.container = null
    },
    supported: function () {
        return !1
    },
    setExtent: function (e, t) {
        if (this.extent = e.clone(), this.map.baseLayer && this.map.baseLayer.wrapDateLine) {
            var i = e.getWidth() / this.map.getExtent().getWidth(), e = e.scale(1 / i);
            this.extent = e.wrapDateLine(this.map.getMaxExtent()).scale(i)
        }
        return t && (this.resolution = null), !0
    },
    setSize: function (e) {
        this.size = e.clone(), this.resolution = null
    },
    getResolution: function () {
        return this.resolution = this.resolution || this.map.getResolution()
    },
    drawFeature: function (e, t) {
        if (null == t && (t = e.style), e.geometry) {
            var i = e.geometry.getBounds();
            if (i) {
                var n;
                if (this.map.baseLayer && this.map.baseLayer.wrapDateLine && (n = this.map.getMaxExtent()), i.intersectsBounds(this.extent, {worldBounds: n}) ? this.calculateFeatureDx(i, n) : t = {display: "none"}, i = this.drawGeometry(e.geometry, t, e.id), "none" != t.display && t.label && !1 !== i) {
                    if (n = e.geometry.getCentroid(), t.labelXOffset || t.labelYOffset) {
                        var s = isNaN(t.labelXOffset) ? 0 : t.labelXOffset, r = isNaN(t.labelYOffset) ? 0 : t.labelYOffset, a = this.getResolution();
                        n.move(s * a, r * a)
                    }
                    this.drawText(e.id, t, n)
                } else this.removeText(e.id);
                return i
            }
        }
    },
    calculateFeatureDx: function (e, t) {
        if (this.featureDx = 0, t) {
            var i = t.getWidth();
            this.featureDx = Math.round(((e.left + e.right) / 2 - (this.extent.left + this.extent.right) / 2) / i) * i
        }
    },
    drawGeometry: function () {
    },
    drawText: function () {
    },
    removeText: function () {
    },
    clear: function () {
    },
    getFeatureIdFromEvent: function () {
    },
    eraseFeatures: function (e) {
        OpenLayers.Util.isArray(e) || (e = [e]);
        for (var t = 0, i = e.length; i > t; ++t) {
            var n = e[t];
            this.eraseGeometry(n.geometry, n.id), this.removeText(n.id)
        }
    },
    eraseGeometry: function () {
    },
    moveRoot: function () {
    },
    getRenderLayerId: function () {
        return this.container.id
    },
    applyDefaultSymbolizer: function (e) {
        var t = OpenLayers.Util.extend({}, OpenLayers.Renderer.defaultSymbolizer);
        return !1 === e.stroke && (delete t.strokeWidth, delete t.strokeColor), !1 === e.fill && delete t.fillColor, OpenLayers.Util.extend(t, e), t
    },
    CLASS_NAME: "OpenLayers.Renderer"
}),OpenLayers.Renderer.defaultSymbolizer = {
    fillColor: "#000000",
    strokeColor: "#000000",
    strokeWidth: 2,
    fillOpacity: 1,
    strokeOpacity: 1,
    pointRadius: 0,
    labelAlign: "cm"
},OpenLayers.Renderer.symbol = {
    star: [350, 75, 379, 161, 469, 161, 397, 215, 423, 301, 350, 250, 277, 301, 303, 215, 231, 161, 321, 161, 350, 75],
    cross: [4, 0, 6, 0, 6, 4, 10, 4, 10, 6, 6, 6, 6, 10, 4, 10, 4, 6, 0, 6, 0, 4, 4, 4, 4, 0],
    x: [0, 0, 25, 0, 50, 35, 75, 0, 100, 0, 65, 50, 100, 100, 75, 100, 50, 65, 25, 100, 0, 100, 35, 50, 0, 0],
    square: [0, 0, 0, 1, 1, 1, 1, 0, 0, 0],
    triangle: [0, 10, 10, 10, 5, 0, 0, 10]
},OpenLayers.Renderer.Canvas = OpenLayers.Class(OpenLayers.Renderer, {
    hitDetection: !0,
    hitOverflow: 0,
    canvas: null,
    features: null,
    pendingRedraw: !1,
    cachedSymbolBounds: {},
    initialize: function () {
        OpenLayers.Renderer.prototype.initialize.apply(this, arguments), this.root = document.createElement("canvas"), this.container.appendChild(this.root), this.canvas = this.root.getContext("2d"), this.features = {}, this.hitDetection && (this.hitCanvas = document.createElement("canvas"), this.hitContext = this.hitCanvas.getContext("2d"))
    },
    setExtent: function () {
        return OpenLayers.Renderer.prototype.setExtent.apply(this, arguments), !1
    },
    eraseGeometry: function (e, t) {
        this.eraseFeatures(this.features[t][0])
    },
    supported: function () {
        return OpenLayers.CANVAS_SUPPORTED
    },
    setSize: function (e) {
        this.size = e.clone();
        var t = this.root;
        t.style.width = e.w + "px", t.style.height = e.h + "px", t.width = e.w, t.height = e.h, this.resolution = null, this.hitDetection && (t = this.hitCanvas, t.style.width = e.w + "px", t.style.height = e.h + "px", t.width = e.w, t.height = e.h)
    },
    drawFeature: function (e, t) {
        var i;
        if (e.geometry) {
            t = this.applyDefaultSymbolizer(t || e.style), i = e.geometry.getBounds();
            var n;
            this.map.baseLayer && this.map.baseLayer.wrapDateLine && (n = this.map.getMaxExtent()), n = i && i.intersectsBounds(this.extent, {worldBounds: n}), (i = "none" !== t.display && !!i && n) ? this.features[e.id] = [e, t] : delete this.features[e.id], this.pendingRedraw = !0
        }
        return this.pendingRedraw && !this.locked && (this.redraw(), this.pendingRedraw = !1), i
    },
    drawGeometry: function (e, t, i) {
        var n = e.CLASS_NAME;
        if ("OpenLayers.Geometry.Collection" == n || "OpenLayers.Geometry.MultiPoint" == n || "OpenLayers.Geometry.MultiLineString" == n || "OpenLayers.Geometry.MultiPolygon" == n)for (n = 0; n < e.components.length; n++)this.drawGeometry(e.components[n], t, i); else switch (e.CLASS_NAME) {
            case"OpenLayers.Geometry.Point":
                this.drawPoint(e, t, i);
                break;
            case"OpenLayers.Geometry.LineString":
                this.drawLineString(e, t, i);
                break;
            case"OpenLayers.Geometry.LinearRing":
                this.drawLinearRing(e, t, i);
                break;
            case"OpenLayers.Geometry.Polygon":
                this.drawPolygon(e, t, i)
        }
    },
    drawExternalGraphic: function (e, t, i) {
        var n = new Image;
        t.graphicTitle && (n.title = t.graphicTitle);
        var s = t.graphicWidth || t.graphicHeight, r = t.graphicHeight || t.graphicWidth, s = s ? s : 2 * t.pointRadius, r = r ? r : 2 * t.pointRadius, a = void 0 != t.graphicXOffset ? t.graphicXOffset : -(.5 * s), o = void 0 != t.graphicYOffset ? t.graphicYOffset : -(.5 * r), l = t.graphicOpacity || t.fillOpacity;
        n.onload = OpenLayers.Function.bind(function () {
            if (this.features[i]) {
                var t = this.getLocalXY(e), h = t[0], t = t[1];
                if (!isNaN(h) && !isNaN(t)) {
                    var h = 0 | h + a, t = 0 | t + o, u = this.canvas;
                    u.globalAlpha = l;
                    var c = OpenLayers.Renderer.Canvas.drawImageScaleFactor || (OpenLayers.Renderer.Canvas.drawImageScaleFactor = /android 2.1/.test(navigator.userAgent.toLowerCase()) ? 320 / window.screen.width : 1);
                    u.drawImage(n, h * c, t * c, s * c, r * c), this.hitDetection && (this.setHitContextStyle("fill", i), this.hitContext.fillRect(h, t, s, r))
                }
            }
        }, this), n.src = t.externalGraphic
    },
    drawNamedSymbol: function (e, t, i) {
        var n, s, r, a;
        r = Math.PI / 180;
        var o = OpenLayers.Renderer.symbol[t.graphicName];
        if (!o)throw Error(t.graphicName + " is not a valid symbol name");
        if (!(!o.length || 2 > o.length || (e = this.getLocalXY(e), s = e[0], a = e[1], isNaN(s) || isNaN(a)))) {
            if (this.canvas.lineCap = "round", this.canvas.lineJoin = "round", this.hitDetection && (this.hitContext.lineCap = "round", this.hitContext.lineJoin = "round"), t.graphicName in this.cachedSymbolBounds) n = this.cachedSymbolBounds[t.graphicName]; else {
                for (n = new OpenLayers.Bounds, e = 0; e < o.length; e += 2)n.extend(new OpenLayers.LonLat(o[e], o[e + 1]));
                this.cachedSymbolBounds[t.graphicName] = n
            }
            if (this.canvas.save(), this.hitDetection && this.hitContext.save(), this.canvas.translate(s, a), this.hitDetection && this.hitContext.translate(s, a), e = r * t.rotation, isNaN(e) || (this.canvas.rotate(e), this.hitDetection && this.hitContext.rotate(e)), r = 2 * t.pointRadius / Math.max(n.getWidth(), n.getHeight()), this.canvas.scale(r, r), this.hitDetection && this.hitContext.scale(r, r), e = n.getCenterLonLat().lon, n = n.getCenterLonLat().lat, this.canvas.translate(-e, -n), this.hitDetection && this.hitContext.translate(-e, -n), a = t.strokeWidth, t.strokeWidth = a / r, !1 !== t.fill) {
                for (this.setCanvasStyle("fill", t), this.canvas.beginPath(), e = 0; e < o.length; e += 2)n = o[e], s = o[e + 1], 0 == e && this.canvas.moveTo(n, s), this.canvas.lineTo(n, s);
                if (this.canvas.closePath(), this.canvas.fill(), this.hitDetection) {
                    for (this.setHitContextStyle("fill", i, t), this.hitContext.beginPath(), e = 0; e < o.length; e += 2)n = o[e], s = o[e + 1], 0 == e && this.canvas.moveTo(n, s), this.hitContext.lineTo(n, s);
                    this.hitContext.closePath(), this.hitContext.fill()
                }
            }
            if (!1 !== t.stroke) {
                for (this.setCanvasStyle("stroke", t), this.canvas.beginPath(), e = 0; e < o.length; e += 2)n = o[e], s = o[e + 1], 0 == e && this.canvas.moveTo(n, s), this.canvas.lineTo(n, s);
                if (this.canvas.closePath(), this.canvas.stroke(), this.hitDetection) {
                    for (this.setHitContextStyle("stroke", i, t, r), this.hitContext.beginPath(), e = 0; e < o.length; e += 2)n = o[e], s = o[e + 1], 0 == e && this.hitContext.moveTo(n, s), this.hitContext.lineTo(n, s);
                    this.hitContext.closePath(), this.hitContext.stroke()
                }
            }
            t.strokeWidth = a, this.canvas.restore(), this.hitDetection && this.hitContext.restore(), this.setCanvasStyle("reset")
        }
    },
    setCanvasStyle: function (e, t) {
        "fill" === e ? (this.canvas.globalAlpha = t.fillOpacity, this.canvas.fillStyle = t.fillColor) : "stroke" === e ? (this.canvas.globalAlpha = t.strokeOpacity, this.canvas.strokeStyle = t.strokeColor, this.canvas.lineWidth = t.strokeWidth) : (this.canvas.globalAlpha = 0, this.canvas.lineWidth = 1)
    },
    featureIdToHex: function (e) {
        e = Number(e.split("_").pop()) + 1, e >= 16777216 && (this.hitOverflow = e - 16777215, e = e % 16777216 + 1);
        var e = "000000" + e.toString(16), t = e.length;
        return e = "#" + e.substring(t - 6, t)
    },
    setHitContextStyle: function (e, t, i, n) {
        t = this.featureIdToHex(t), "fill" == e ? (this.hitContext.globalAlpha = 1, this.hitContext.fillStyle = t) : "stroke" == e ? (this.hitContext.globalAlpha = 1, this.hitContext.strokeStyle = t, "undefined" == typeof n ? this.hitContext.lineWidth = i.strokeWidth + 2 : isNaN(n) || (this.hitContext.lineWidth = i.strokeWidth + 2 / n)) : (this.hitContext.globalAlpha = 0, this.hitContext.lineWidth = 1)
    },
    drawPoint: function (e, t, i) {
        if (!1 !== t.graphic)if (t.externalGraphic) this.drawExternalGraphic(e, t, i); else if (t.graphicName && "circle" != t.graphicName) this.drawNamedSymbol(e, t, i); else {
            var n = this.getLocalXY(e), e = n[0], n = n[1];
            if (!isNaN(e) && !isNaN(n)) {
                var s = 2 * Math.PI, r = t.pointRadius;
                !1 !== t.fill && (this.setCanvasStyle("fill", t), this.canvas.beginPath(), this.canvas.arc(e, n, r, 0, s, !0), this.canvas.fill(), this.hitDetection && (this.setHitContextStyle("fill", i, t), this.hitContext.beginPath(), this.hitContext.arc(e, n, r, 0, s, !0), this.hitContext.fill())), !1 !== t.stroke && (this.setCanvasStyle("stroke", t), this.canvas.beginPath(), this.canvas.arc(e, n, r, 0, s, !0), this.canvas.stroke(), this.hitDetection && (this.setHitContextStyle("stroke", i, t), this.hitContext.beginPath(), this.hitContext.arc(e, n, r, 0, s, !0), this.hitContext.stroke()), this.setCanvasStyle("reset"))
            }
        }
    },
    drawLineString: function (e, t, i) {
        t = OpenLayers.Util.applyDefaults({fill: !1}, t), this.drawLinearRing(e, t, i)
    },
    drawLinearRing: function (e, t, i) {
        !1 !== t.fill && (this.setCanvasStyle("fill", t), this.renderPath(this.canvas, e, t, i, "fill"), this.hitDetection && (this.setHitContextStyle("fill", i, t), this.renderPath(this.hitContext, e, t, i, "fill"))), !1 !== t.stroke && (this.setCanvasStyle("stroke", t), this.renderPath(this.canvas, e, t, i, "stroke"), this.hitDetection && (this.setHitContextStyle("stroke", i, t), this.renderPath(this.hitContext, e, t, i, "stroke"))), this.setCanvasStyle("reset")
    },
    renderPath: function (e, t, i, n, s) {
        t = t.components, i = t.length, e.beginPath();
        var n = this.getLocalXY(t[0]), r = n[1];
        if (!isNaN(n[0]) && !isNaN(r)) {
            for (e.moveTo(n[0], n[1]), n = 1; i > n; ++n)r = this.getLocalXY(t[n]), e.lineTo(r[0], r[1]);
            "fill" === s ? e.fill() : e.stroke()
        }
    },
    drawPolygon: function (e, t, i) {
        var e = e.components, n = e.length;
        this.drawLinearRing(e[0], t, i);
        for (var s = 1; n > s; ++s)this.canvas.globalCompositeOperation = "destination-out", this.hitDetection && (this.hitContext.globalCompositeOperation = "destination-out"), this.drawLinearRing(e[s], OpenLayers.Util.applyDefaults({
            stroke: !1,
            fillOpacity: 1
        }, t), i), this.canvas.globalCompositeOperation = "source-over", this.hitDetection && (this.hitContext.globalCompositeOperation = "source-over"), this.drawLinearRing(e[s], OpenLayers.Util.applyDefaults({fill: !1}, t), i)
    },
    drawText: function (e, t) {
        var i = this.getLocalXY(e);
        this.setCanvasStyle("reset"), this.canvas.fillStyle = t.fontColor, this.canvas.globalAlpha = t.fontOpacity || 1;
        var n = [t.fontStyle ? t.fontStyle : "normal", "normal", t.fontWeight ? t.fontWeight : "normal", t.fontSize ? t.fontSize : "1em", t.fontFamily ? t.fontFamily : "sans-serif"].join(" "), s = t.label.split("\n"), r = s.length;
        if (this.canvas.fillText) {
            this.canvas.font = n, this.canvas.textAlign = OpenLayers.Renderer.Canvas.LABEL_ALIGN[t.labelAlign[0]] || "center", this.canvas.textBaseline = OpenLayers.Renderer.Canvas.LABEL_ALIGN[t.labelAlign[1]] || "middle";
            var a = OpenLayers.Renderer.Canvas.LABEL_FACTOR[t.labelAlign[1]];
            for (null == a && (a = -.5), n = this.canvas.measureText("Mg").height || this.canvas.measureText("xx").width, i[1] += n * a * (r - 1), a = 0; r > a; a++)t.labelOutlineWidth && (this.canvas.save(), this.canvas.strokeStyle = t.labelOutlineColor, this.canvas.lineWidth = t.labelOutlineWidth, this.canvas.strokeText(s[a], i[0], i[1] + n * a + 1), this.canvas.restore()), this.canvas.fillText(s[a], i[0], i[1] + n * a)
        } else if (this.canvas.mozDrawText) {
            this.canvas.mozTextStyle = n;
            var o = OpenLayers.Renderer.Canvas.LABEL_FACTOR[t.labelAlign[0]];
            for (null == o && (o = -.5), a = OpenLayers.Renderer.Canvas.LABEL_FACTOR[t.labelAlign[1]], null == a && (a = -.5), n = this.canvas.mozMeasureText("xx"), i[1] += n * (1 + a * r), a = 0; r > a; a++) {
                var l = i[0] + o * this.canvas.mozMeasureText(s[a]), h = i[1] + a * n;
                this.canvas.translate(l, h), this.canvas.mozDrawText(s[a]), this.canvas.translate(-l, -h)
            }
        }
        this.setCanvasStyle("reset")
    },
    getLocalXY: function (e) {
        var t = this.getResolution(), i = this.extent;
        return [(e.x - this.featureDx) / t + -i.left / t, i.top / t - e.y / t]
    },
    clear: function () {
        var e = this.root.height, t = this.root.width;
        this.canvas.clearRect(0, 0, t, e), this.features = {}, this.hitDetection && this.hitContext.clearRect(0, 0, t, e)
    },
    getFeatureIdFromEvent: function (e) {
        var t;
        if (this.hitDetection && "none" !== this.root.style.display && !this.map.dragging && (e = e.xy, e = this.hitContext.getImageData(0 | e.x, 0 | e.y, 1, 1).data, 255 === e[3] && (e = e[2] + 256 * (e[1] + 256 * e[0])))) {
            e = "OpenLayers.Feature.Vector_" + (e - 1 + this.hitOverflow);
            try {
                t = this.features[e][0]
            } catch (i) {
            }
        }
        return t
    },
    eraseFeatures: function (e) {
        OpenLayers.Util.isArray(e) || (e = [e]);
        for (var t = 0; t < e.length; ++t)delete this.features[e[t].id];
        this.redraw()
    },
    redraw: function () {
        if (!this.locked) {
            var e = this.root.height, t = this.root.width;
            this.canvas.clearRect(0, 0, t, e), this.hitDetection && this.hitContext.clearRect(0, 0, t, e);
            var i, n, s, e = [], r = this.map.baseLayer && this.map.baseLayer.wrapDateLine && this.map.getMaxExtent();
            for (s in this.features)this.features.hasOwnProperty(s) && (t = this.features[s][0], i = t.geometry, this.calculateFeatureDx(i.getBounds(), r), n = this.features[s][1], this.drawGeometry(i, n, t.id), n.label && e.push([t, n]));
            for (t = 0, i = e.length; i > t; ++t)s = e[t], this.drawText(s[0].geometry.getCentroid(), s[1])
        }
    },
    CLASS_NAME: "OpenLayers.Renderer.Canvas"
}),OpenLayers.Renderer.Canvas.LABEL_ALIGN = {
    l: "left",
    r: "right",
    t: "top",
    b: "bottom"
},OpenLayers.Renderer.Canvas.LABEL_FACTOR = {
    l: 0,
    r: -1,
    t: 0,
    b: -1
},OpenLayers.Renderer.Canvas.drawImageScaleFactor = null,OpenLayers.Format.OSM = OpenLayers.Class(OpenLayers.Format.XML, {
    checkTags: !1, interestingTagsExclude: null, areaTags: null, initialize: function (e) {
        for (var t = {
            interestingTagsExclude: "source source_ref source:ref history attribution created_by".split(" "),
            areaTags: "area building leisure tourism ruins historic landuse military natural sport".split(" ")
        }, t = OpenLayers.Util.extend(t, e), i = {}, e = 0; e < t.interestingTagsExclude.length; e++)i[t.interestingTagsExclude[e]] = !0;
        for (t.interestingTagsExclude = i, i = {}, e = 0; e < t.areaTags.length; e++)i[t.areaTags[e]] = !0;
        t.areaTags = i, this.externalProjection = new OpenLayers.Projection("EPSG:4326"), OpenLayers.Format.XML.prototype.initialize.apply(this, [t])
    }, read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e]));
        for (var t = this.getNodes(e), i = this.getWays(e), e = Array(i.length), n = 0; n < i.length; n++) {
            for (var s = Array(i[n].nodes.length), r = this.isWayArea(i[n]) ? 1 : 0, a = 0; a < i[n].nodes.length; a++) {
                var o = t[i[n].nodes[a]], l = new OpenLayers.Geometry.Point(o.lon, o.lat);
                l.osm_id = parseInt(i[n].nodes[a]), s[a] = l, o.used = !0
            }
            o = null, o = r ? new OpenLayers.Geometry.Polygon(new OpenLayers.Geometry.LinearRing(s)) : new OpenLayers.Geometry.LineString(s), this.internalProjection && this.externalProjection && o.transform(this.externalProjection, this.internalProjection), s = new OpenLayers.Feature.Vector(o, i[n].tags), s.osm_id = parseInt(i[n].id), s.fid = "way." + s.osm_id, e[n] = s
        }
        for (var h in t) {
            if (o = t[h], !o.used || this.checkTags) {
                if (i = null, this.checkTags) {
                    if (i = this.getTags(o.node, !0), o.used && !i[1])continue;
                    i = i[0]
                } else i = this.getTags(o.node);
                s = new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(o.lon, o.lat), i), this.internalProjection && this.externalProjection && s.geometry.transform(this.externalProjection, this.internalProjection), s.osm_id = parseInt(h), s.fid = "node." + s.osm_id, e.push(s)
            }
            o.node = null
        }
        return e
    }, getNodes: function (e) {
        for (var e = e.getElementsByTagName("node"), t = {}, i = 0; i < e.length; i++) {
            var n = e[i], s = n.getAttribute("id");
            t[s] = {lat: n.getAttribute("lat"), lon: n.getAttribute("lon"), node: n}
        }
        return t
    }, getWays: function (e) {
        for (var e = e.getElementsByTagName("way"), t = [], i = 0; i < e.length; i++) {
            var n = e[i], s = {id: n.getAttribute("id")};
            s.tags = this.getTags(n), n = n.getElementsByTagName("nd"), s.nodes = Array(n.length);
            for (var r = 0; r < n.length; r++)s.nodes[r] = n[r].getAttribute("ref");
            t.push(s)
        }
        return t
    }, getTags: function (e, t) {
        for (var i = e.getElementsByTagName("tag"), n = {}, s = !1, r = 0; r < i.length; r++) {
            var a = i[r].getAttribute("k");
            n[a] = i[r].getAttribute("v"), t && (this.interestingTagsExclude[a] || (s = !0))
        }
        return t ? [n, s] : n
    }, isWayArea: function (e) {
        var t = !1, i = !1;
        if (e.nodes[0] == e.nodes[e.nodes.length - 1] && (t = !0), this.checkTags)for (var n in e.tags)if (this.areaTags[n]) {
            i = !0;
            break
        }
        return t && (this.checkTags ? i : !0)
    }, write: function (e) {
        OpenLayers.Util.isArray(e) || (e = [e]), this.osm_id = 1, this.created_nodes = {};
        var t = this.createElementNS(null, "osm");
        t.setAttribute("version", "0.5"), t.setAttribute("generator", "OpenLayers " + OpenLayers.VERSION_NUMBER);
        for (var i = e.length - 1; i >= 0; i--)for (var n = this.createFeatureNodes(e[i]), s = 0; s < n.length; s++)t.appendChild(n[s]);
        return OpenLayers.Format.XML.prototype.write.apply(this, [t])
    }, createFeatureNodes: function (e) {
        var t = [], i = e.geometry.CLASS_NAME, i = i.substring(i.lastIndexOf(".") + 1), i = i.toLowerCase();
        return (i = this.createXML[i]) && (t = i.apply(this, [e])), t
    }, createXML: {
        point: function (e) {
            var t = null, i = e.geometry ? e.geometry : e;
            this.internalProjection && this.externalProjection && (i = i.clone(), i.transform(this.internalProjection, this.externalProjection));
            var n = !1;
            e.osm_id ? (t = e.osm_id, this.created_nodes[t] && (n = !0)) : (t = -this.osm_id, this.osm_id++);
            var s = n ? this.created_nodes[t] : this.createElementNS(null, "node");
            return this.created_nodes[t] = s, s.setAttribute("id", t), s.setAttribute("lon", i.x), s.setAttribute("lat", i.y), e.attributes && this.serializeTags(e, s), this.setState(e, s), n ? [] : [s]
        }, linestring: function (e) {
            var t, i = [], n = e.geometry;
            e.osm_id ? t = e.osm_id : (t = -this.osm_id, this.osm_id++);
            var s = this.createElementNS(null, "way");
            for (s.setAttribute("id", t), t = 0; t < n.components.length; t++) {
                var r = this.createXML.point.apply(this, [n.components[t]]);
                if (r.length) {
                    var r = r[0], a = r.getAttribute("id");
                    i.push(r)
                } else a = n.components[t].osm_id, r = this.created_nodes[a];
                this.setState(e, r), r = this.createElementNS(null, "nd"), r.setAttribute("ref", a), s.appendChild(r)
            }
            return this.serializeTags(e, s), i.push(s), i
        }, polygon: function (e) {
            var t = OpenLayers.Util.extend({area: "yes"}, e.attributes), t = new OpenLayers.Feature.Vector(e.geometry.components[0], t);
            return t.osm_id = e.osm_id, this.createXML.linestring.apply(this, [t])
        }
    }, serializeTags: function (e, t) {
        for (var i in e.attributes) {
            var n = this.createElementNS(null, "tag");
            n.setAttribute("k", i), n.setAttribute("v", e.attributes[i]), t.appendChild(n)
        }
    }, setState: function (e, t) {
        if (e.state) {
            var i = null;
            switch (e.state) {
                case OpenLayers.State.UPDATE:
                case OpenLayers.State.DELETE:
                    i = "delete"
            }
            i && t.setAttribute("action", i)
        }
    }, CLASS_NAME: "OpenLayers.Format.OSM"
}),OpenLayers.Handler = OpenLayers.Class({
    id: null,
    control: null,
    map: null,
    keyMask: null,
    active: !1,
    evt: null,
    initialize: function (e, t, i) {
        OpenLayers.Util.extend(this, i), this.control = e, this.callbacks = t, (e = this.map || e.map) && this.setMap(e), this.id = OpenLayers.Util.createUniqueID(this.CLASS_NAME + "_")
    },
    setMap: function (e) {
        this.map = e
    },
    checkModifiers: function (e) {
        return null == this.keyMask ? !0 : ((e.shiftKey ? OpenLayers.Handler.MOD_SHIFT : 0) | (e.ctrlKey ? OpenLayers.Handler.MOD_CTRL : 0) | (e.altKey ? OpenLayers.Handler.MOD_ALT : 0)) == this.keyMask
    },
    activate: function () {
        if (this.active)return !1;
        for (var e = OpenLayers.Events.prototype.BROWSER_EVENTS, t = 0, i = e.length; i > t; t++)this[e[t]] && this.register(e[t], this[e[t]]);
        return this.active = !0
    },
    deactivate: function () {
        if (!this.active)return !1;
        for (var e = OpenLayers.Events.prototype.BROWSER_EVENTS, t = 0, i = e.length; i > t; t++)this[e[t]] && this.unregister(e[t], this[e[t]]);
        return this.active = !1, !0
    },
    callback: function (e, t) {
        e && this.callbacks[e] && this.callbacks[e].apply(this.control, t)
    },
    register: function (e, t) {
        this.map.events.registerPriority(e, this, t), this.map.events.registerPriority(e, this, this.setEvent)
    },
    unregister: function (e, t) {
        this.map.events.unregister(e, this, t), this.map.events.unregister(e, this, this.setEvent)
    },
    setEvent: function (e) {
        return this.evt = e, !0
    },
    destroy: function () {
        this.deactivate(), this.control = this.map = null
    },
    CLASS_NAME: "OpenLayers.Handler"
}),OpenLayers.Handler.MOD_NONE = 0,OpenLayers.Handler.MOD_SHIFT = 1,OpenLayers.Handler.MOD_CTRL = 2,OpenLayers.Handler.MOD_ALT = 4,OpenLayers.Handler.Drag = OpenLayers.Class(OpenLayers.Handler, {
    started: !1,
    stopDown: !0,
    dragging: !1,
    touch: !1,
    last: null,
    start: null,
    lastMoveEvt: null,
    oldOnselectstart: null,
    interval: 0,
    timeoutId: null,
    documentDrag: !1,
    documentEvents: null,
    initialize: function () {
        if (OpenLayers.Handler.prototype.initialize.apply(this, arguments), !0 === this.documentDrag) {
            var e = this;
            this._docMove = function (t) {
                e.mousemove({xy: {x: t.clientX, y: t.clientY}, element: document})
            }, this._docUp = function (t) {
                e.mouseup({xy: {x: t.clientX, y: t.clientY}})
            }
        }
    },
    dragstart: function (e) {
        var t = !0;
        return this.dragging = !1, this.checkModifiers(e) && (OpenLayers.Event.isLeftClick(e) || OpenLayers.Event.isSingleTouch(e)) ? (this.started = !0, this.last = this.start = e.xy, OpenLayers.Element.addClass(this.map.viewPortDiv, "olDragDown"), this.down(e), this.callback("down", [e.xy]), OpenLayers.Event.stop(e), this.oldOnselectstart || (this.oldOnselectstart = document.onselectstart ? document.onselectstart : OpenLayers.Function.True), document.onselectstart = OpenLayers.Function.False, t = !this.stopDown) : (this.started = !1, this.last = this.start = null), t
    },
    dragmove: function (e) {
        return this.lastMoveEvt = e, !this.started || this.timeoutId || e.xy.x == this.last.x && e.xy.y == this.last.y || (!0 === this.documentDrag && this.documentEvents && (e.element === document ? (this.adjustXY(e), this.setEvent(e)) : this.removeDocumentEvents()), 0 < this.interval && (this.timeoutId = setTimeout(OpenLayers.Function.bind(this.removeTimeout, this), this.interval)), this.dragging = !0, this.move(e), this.callback("move", [e.xy]), this.oldOnselectstart || (this.oldOnselectstart = document.onselectstart, document.onselectstart = OpenLayers.Function.False), this.last = e.xy), !0
    },
    dragend: function (e) {
        if (this.started) {
            !0 === this.documentDrag && this.documentEvents && (this.adjustXY(e), this.removeDocumentEvents());
            var t = this.start != this.last;
            this.dragging = this.started = !1, OpenLayers.Element.removeClass(this.map.viewPortDiv, "olDragDown"), this.up(e), this.callback("up", [e.xy]), t && this.callback("done", [e.xy]), document.onselectstart = this.oldOnselectstart
        }
        return !0
    },
    down: function () {
    },
    move: function () {
    },
    up: function () {
    },
    out: function () {
    },
    mousedown: function (e) {
        return this.dragstart(e)
    },
    touchstart: function (e) {
        return this.touch || (this.touch = !0, this.map.events.un({
            mousedown: this.mousedown,
            mouseup: this.mouseup,
            mousemove: this.mousemove,
            click: this.click,
            scope: this
        })), this.dragstart(e)
    },
    mousemove: function (e) {
        return this.dragmove(e)
    },
    touchmove: function (e) {
        return this.dragmove(e)
    },
    removeTimeout: function () {
        this.timeoutId = null, this.dragging && this.mousemove(this.lastMoveEvt)
    },
    mouseup: function (e) {
        return this.dragend(e)
    },
    touchend: function (e) {
        return e.xy = this.last, this.dragend(e)
    },
    mouseout: function (e) {
        if (this.started && OpenLayers.Util.mouseLeft(e, this.map.viewPortDiv))if (!0 === this.documentDrag) this.addDocumentEvents(); else {
            var t = this.start != this.last;
            this.dragging = this.started = !1, OpenLayers.Element.removeClass(this.map.viewPortDiv, "olDragDown"), this.out(e), this.callback("out", []), t && this.callback("done", [e.xy]), document.onselectstart && (document.onselectstart = this.oldOnselectstart)
        }
        return !0
    },
    click: function () {
        return this.start == this.last
    },
    activate: function () {
        var e = !1;
        return OpenLayers.Handler.prototype.activate.apply(this, arguments) && (this.dragging = !1, e = !0), e
    },
    deactivate: function () {
        var e = !1;
        return OpenLayers.Handler.prototype.deactivate.apply(this, arguments) && (this.dragging = this.started = this.touch = !1, this.last = this.start = null, e = !0, OpenLayers.Element.removeClass(this.map.viewPortDiv, "olDragDown")), e
    },
    adjustXY: function (e) {
        var t = OpenLayers.Util.pagePosition(this.map.viewPortDiv);
        e.xy.x -= t[0], e.xy.y -= t[1]
    },
    addDocumentEvents: function () {
        OpenLayers.Element.addClass(document.body, "olDragDown"), this.documentEvents = !0, OpenLayers.Event.observe(document, "mousemove", this._docMove), OpenLayers.Event.observe(document, "mouseup", this._docUp)
    },
    removeDocumentEvents: function () {
        OpenLayers.Element.removeClass(document.body, "olDragDown"), this.documentEvents = !1, OpenLayers.Event.stopObserving(document, "mousemove", this._docMove), OpenLayers.Event.stopObserving(document, "mouseup", this._docUp)
    },
    CLASS_NAME: "OpenLayers.Handler.Drag"
}),OpenLayers.Handler.Feature = OpenLayers.Class(OpenLayers.Handler, {
    EVENTMAP: {
        click: {
            "in": "click",
            out: "clickout"
        },
        mousemove: {"in": "over", out: "out"},
        dblclick: {"in": "dblclick", out: null},
        mousedown: {"in": null, out: null},
        mouseup: {"in": null, out: null},
        touchstart: {"in": "click", out: "clickout"}
    },
    feature: null,
    lastFeature: null,
    down: null,
    up: null,
    touch: !1,
    clickTolerance: 4,
    geometryTypes: null,
    stopClick: !0,
    stopDown: !0,
    stopUp: !1,
    initialize: function (e, t, i, n) {
        OpenLayers.Handler.prototype.initialize.apply(this, [e, i, n]), this.layer = t
    },
    touchstart: function (e) {
        return this.touch || (this.touch = !0, this.map.events.un({
            mousedown: this.mousedown,
            mouseup: this.mouseup,
            mousemove: this.mousemove,
            click: this.click,
            dblclick: this.dblclick,
            scope: this
        })), OpenLayers.Event.isMultiTouch(e) ? !0 : this.mousedown(e)
    },
    touchmove: function (e) {
        OpenLayers.Event.stop(e)
    },
    mousedown: function (e) {
        return (OpenLayers.Event.isLeftClick(e) || OpenLayers.Event.isSingleTouch(e)) && (this.down = e.xy), this.handle(e) ? !this.stopDown : !0
    },
    mouseup: function (e) {
        return this.up = e.xy, this.handle(e) ? !this.stopUp : !0
    },
    click: function (e) {
        return this.handle(e) ? !this.stopClick : !0
    },
    mousemove: function (e) {
        return this.callbacks.over || this.callbacks.out ? (this.handle(e), !0) : !0
    },
    dblclick: function (e) {
        return !this.handle(e)
    },
    geometryTypeMatches: function (e) {
        return null == this.geometryTypes || -1 < OpenLayers.Util.indexOf(this.geometryTypes, e.geometry.CLASS_NAME)
    },
    handle: function (e) {
        this.feature && !this.feature.layer && (this.feature = null);
        var t = e.type, i = !1, n = !!this.feature, s = "click" == t || "dblclick" == t || "touchstart" == t;
        return (this.feature = this.layer.getFeatureFromEvent(e)) && !this.feature.layer && (this.feature = null), this.lastFeature && !this.lastFeature.layer && (this.lastFeature = null), this.feature ? ("touchstart" === t && OpenLayers.Event.stop(e), e = this.feature != this.lastFeature, this.geometryTypeMatches(this.feature) ? (n && e ? (this.lastFeature && this.triggerCallback(t, "out", [this.lastFeature]), this.triggerCallback(t, "in", [this.feature])) : (!n || s) && this.triggerCallback(t, "in", [this.feature]), this.lastFeature = this.feature, i = !0) : (this.lastFeature && (n && e || s) && this.triggerCallback(t, "out", [this.lastFeature]), this.feature = null)) : this.lastFeature && (n || s) && this.triggerCallback(t, "out", [this.lastFeature]), i
    },
    triggerCallback: function (e, t, i) {
        (t = this.EVENTMAP[e][t]) && ("click" == e && this.up && this.down ? Math.sqrt(Math.pow(this.up.x - this.down.x, 2) + Math.pow(this.up.y - this.down.y, 2)) <= this.clickTolerance && this.callback(t, i) : this.callback(t, i))
    },
    activate: function () {
        var e = !1;
        return OpenLayers.Handler.prototype.activate.apply(this, arguments) && (this.moveLayerToTop(), this.map.events.on({
            removelayer: this.handleMapEvents,
            changelayer: this.handleMapEvents,
            scope: this
        }), e = !0), e
    },
    deactivate: function () {
        var e = !1;
        return OpenLayers.Handler.prototype.deactivate.apply(this, arguments) && (this.moveLayerBack(), this.up = this.down = this.lastFeature = this.feature = null, this.touch = !1, this.map.events.un({
            removelayer: this.handleMapEvents,
            changelayer: this.handleMapEvents,
            scope: this
        }), e = !0), e
    },
    handleMapEvents: function (e) {
        ("removelayer" == e.type || "order" == e.property) && this.moveLayerToTop()
    },
    moveLayerToTop: function () {
        this.layer.setZIndex(Math.max(this.map.Z_INDEX_BASE.Feature - 1, this.layer.getZIndex()) + 1)
    },
    moveLayerBack: function () {
        var e = this.layer.getZIndex() - 1;
        e >= this.map.Z_INDEX_BASE.Feature ? this.layer.setZIndex(e) : this.map.setLayerZIndex(this.layer, this.map.getLayerIndex(this.layer))
    },
    CLASS_NAME: "OpenLayers.Handler.Feature"
}),OpenLayers.Control.DragFeature = OpenLayers.Class(OpenLayers.Control, {
    geometryTypes: null,
    onStart: function () {
    },
    onDrag: function () {
    },
    onComplete: function () {
    },
    onEnter: function () {
    },
    onLeave: function () {
    },
    documentDrag: !1,
    layer: null,
    feature: null,
    dragCallbacks: {},
    featureCallbacks: {},
    lastPixel: null,
    initialize: function (e, t) {
        OpenLayers.Control.prototype.initialize.apply(this, [t]), this.layer = e, this.handlers = {
            drag: new OpenLayers.Handler.Drag(this, OpenLayers.Util.extend({
                down: this.downFeature,
                move: this.moveFeature,
                up: this.upFeature,
                out: this.cancel,
                done: this.doneDragging
            }, this.dragCallbacks), {documentDrag: this.documentDrag}),
            feature: new OpenLayers.Handler.Feature(this, this.layer, OpenLayers.Util.extend({
                click: this.clickFeature,
                clickout: this.clickoutFeature,
                over: this.overFeature,
                out: this.outFeature
            }, this.featureCallbacks), {geometryTypes: this.geometryTypes})
        }
    },
    clickFeature: function (e) {
        this.handlers.feature.touch && !this.over && this.overFeature(e) && (this.handlers.drag.dragstart(this.handlers.feature.evt), this.handlers.drag.stopDown = !1)
    },
    clickoutFeature: function (e) {
        this.handlers.feature.touch && this.over && (this.outFeature(e), this.handlers.drag.stopDown = !0)
    },
    destroy: function () {
        this.layer = null, OpenLayers.Control.prototype.destroy.apply(this, [])
    },
    activate: function () {
        return this.handlers.feature.activate() && OpenLayers.Control.prototype.activate.apply(this, arguments)
    },
    deactivate: function () {
        return this.handlers.drag.deactivate(), this.handlers.feature.deactivate(), this.feature = null, this.dragging = !1, this.lastPixel = null, OpenLayers.Element.removeClass(this.map.viewPortDiv, this.displayClass + "Over"), OpenLayers.Control.prototype.deactivate.apply(this, arguments)
    },
    overFeature: function (e) {
        var t = !1;
        return this.handlers.drag.dragging ? this.over = this.feature.id == e.id ? !0 : !1 : (this.feature = e, this.handlers.drag.activate(), this.over = t = !0, OpenLayers.Element.addClass(this.map.viewPortDiv, this.displayClass + "Over"), this.onEnter(e)), t
    },
    downFeature: function (e) {
        this.lastPixel = e, this.onStart(this.feature, e)
    },
    moveFeature: function (e) {
        var t = this.map.getResolution();
        this.feature.geometry.move(t * (e.x - this.lastPixel.x), t * (this.lastPixel.y - e.y)), this.layer.drawFeature(this.feature), this.lastPixel = e, this.onDrag(this.feature, e)
    },
    upFeature: function () {
        this.over || this.handlers.drag.deactivate()
    },
    doneDragging: function (e) {
        this.onComplete(this.feature, e)
    },
    outFeature: function (e) {
        this.handlers.drag.dragging ? this.feature.id == e.id && (this.over = !1) : (this.over = !1, this.handlers.drag.deactivate(), OpenLayers.Element.removeClass(this.map.viewPortDiv, this.displayClass + "Over"), this.onLeave(e), this.feature = null)
    },
    cancel: function () {
        this.handlers.drag.deactivate(), this.over = !1
    },
    setMap: function (e) {
        this.handlers.drag.setMap(e), this.handlers.feature.setMap(e), OpenLayers.Control.prototype.setMap.apply(this, arguments)
    },
    CLASS_NAME: "OpenLayers.Control.DragFeature"
}),OpenLayers.StyleMap = OpenLayers.Class({
    styles: null, extendDefault: !0, initialize: function (e, t) {
        if (this.styles = {
                "default": new OpenLayers.Style(OpenLayers.Feature.Vector.style["default"]),
                select: new OpenLayers.Style(OpenLayers.Feature.Vector.style.select),
                temporary: new OpenLayers.Style(OpenLayers.Feature.Vector.style.temporary),
                "delete": new OpenLayers.Style(OpenLayers.Feature.Vector.style["delete"])
            }, e instanceof OpenLayers.Style) this.styles["default"] = e, this.styles.select = e, this.styles.temporary = e, this.styles["delete"] = e; else if ("object" == typeof e)for (var i in e)if (e[i] instanceof OpenLayers.Style) this.styles[i] = e[i]; else {
            if ("object" != typeof e[i]) {
                this.styles["default"] = new OpenLayers.Style(e), this.styles.select = new OpenLayers.Style(e), this.styles.temporary = new OpenLayers.Style(e), this.styles["delete"] = new OpenLayers.Style(e);
                break
            }
            this.styles[i] = new OpenLayers.Style(e[i])
        }
        OpenLayers.Util.extend(this, t)
    }, destroy: function () {
        for (var e in this.styles)this.styles[e].destroy();
        this.styles = null
    }, createSymbolizer: function (e, t) {
        e || (e = new OpenLayers.Feature.Vector), this.styles[t] || (t = "default"), e.renderIntent = t;
        var i = {};
        return this.extendDefault && "default" != t && (i = this.styles["default"].createSymbolizer(e)), OpenLayers.Util.extend(i, this.styles[t].createSymbolizer(e))
    }, addUniqueValueRules: function (e, t, i, n) {
        var s, r = [];
        for (s in i)r.push(new OpenLayers.Rule({
            symbolizer: i[s],
            context: n,
            filter: new OpenLayers.Filter.Comparison({
                type: OpenLayers.Filter.Comparison.EQUAL_TO,
                property: t,
                value: s
            })
        }));
        this.styles[e].addRules(r)
    }, CLASS_NAME: "OpenLayers.StyleMap"
}),OpenLayers.Layer.Vector = OpenLayers.Class(OpenLayers.Layer, {
    isBaseLayer: !1,
    isFixed: !1,
    features: null,
    filter: null,
    selectedFeatures: null,
    unrenderedFeatures: null,
    reportError: !0,
    style: null,
    styleMap: null,
    strategies: null,
    protocol: null,
    renderers: ["SVG", "VML", "Canvas"],
    renderer: null,
    rendererOptions: null,
    geometryType: null,
    drawn: !1,
    ratio: 1,
    initialize: function () {
        if (OpenLayers.Layer.prototype.initialize.apply(this, arguments), (!this.renderer || !this.renderer.supported()) && this.assignRenderer(), this.renderer && this.renderer.supported() || (this.renderer = null, this.displayError()), this.styleMap || (this.styleMap = new OpenLayers.StyleMap), this.features = [], this.selectedFeatures = [], this.unrenderedFeatures = {}, this.strategies)for (var e = 0, t = this.strategies.length; t > e; e++)this.strategies[e].setLayer(this)
    },
    destroy: function () {
        if (this.strategies) {
            var e, t, i;
            for (t = 0, i = this.strategies.length; i > t; t++)e = this.strategies[t], e.autoDestroy && e.destroy();
            this.strategies = null
        }
        this.protocol && (this.protocol.autoDestroy && this.protocol.destroy(), this.protocol = null), this.destroyFeatures(), this.unrenderedFeatures = this.selectedFeatures = this.features = null, this.renderer && this.renderer.destroy(), this.drawn = this.geometryType = this.renderer = null, OpenLayers.Layer.prototype.destroy.apply(this, arguments)
    },
    clone: function (e) {
        null == e && (e = new OpenLayers.Layer.Vector(this.name, this.getOptions()));
        for (var e = OpenLayers.Layer.prototype.clone.apply(this, [e]), t = this.features, i = t.length, n = Array(i), s = 0; i > s; ++s)n[s] = t[s].clone();
        return e.features = n, e
    },
    refresh: function (e) {
        this.calculateInRange() && this.visibility && this.events.triggerEvent("refresh", e)
    },
    assignRenderer: function () {
        for (var e = 0, t = this.renderers.length; t > e; e++) {
            var i = this.renderers[e];
            if ((i = "function" == typeof i ? i : OpenLayers.Renderer[i]) && i.prototype.supported()) {
                this.renderer = new i(this.div, this.rendererOptions);
                break
            }
        }
    },
    displayError: function () {
        this.reportError && OpenLayers.Console.userError(OpenLayers.i18n("browserNotSupported", {renderers: this.renderers.join("\n")}))
    },
    setMap: function () {
        if (OpenLayers.Layer.prototype.setMap.apply(this, arguments), this.renderer) {
            this.renderer.map = this.map;
            var e = this.map.getSize();
            e.w *= this.ratio, e.h *= this.ratio, this.renderer.setSize(e)
        } else this.map.removeLayer(this)
    },
    afterAdd: function () {
        if (this.strategies) {
            var e, t, i;
            for (t = 0, i = this.strategies.length; i > t; t++)e = this.strategies[t], e.autoActivate && e.activate()
        }
    },
    removeMap: function () {
        if (this.drawn = !1, this.strategies) {
            var e, t, i;
            for (t = 0, i = this.strategies.length; i > t; t++)e = this.strategies[t], e.autoActivate && e.deactivate()
        }
    },
    onMapResize: function () {
        OpenLayers.Layer.prototype.onMapResize.apply(this, arguments);
        var e = this.map.getSize();
        e.w *= this.ratio, e.h *= this.ratio, this.renderer.setSize(e)
    },
    moveTo: function (e, t, i) {
        OpenLayers.Layer.prototype.moveTo.apply(this, arguments);
        var n = !0;
        if (!i) {
            this.renderer.root.style.visibility = "hidden";
            var n = this.map.getSize(), s = n.w, n = n.h, s = s / 2 * this.ratio - s / 2, n = n / 2 * this.ratio - n / 2, s = s + parseInt(this.map.layerContainerDiv.style.left, 10), s = -Math.round(s), n = n + parseInt(this.map.layerContainerDiv.style.top, 10), n = -Math.round(n);
            if (this.div.style.left = s + "px", this.div.style.top = n + "px", n = this.renderer.setExtent(this.map.getExtent().scale(this.ratio), t), this.renderer.root.style.visibility = "visible", !0 === OpenLayers.IS_GECKO && (this.div.scrollLeft = this.div.scrollLeft), !t && n)for (var r in this.unrenderedFeatures)s = this.unrenderedFeatures[r], this.drawFeature(s)
        }
        if (!this.drawn || t || !n)for (this.drawn = !0, r = 0, n = this.features.length; n > r; r++)this.renderer.locked = r !== n - 1, s = this.features[r], this.drawFeature(s)
    },
    display: function () {
        OpenLayers.Layer.prototype.display.apply(this, arguments);
        var e = this.div.style.display;
        e != this.renderer.root.style.display && (this.renderer.root.style.display = e)
    },
    addFeatures: function (e, t) {
        OpenLayers.Util.isArray(e) || (e = [e]);
        var i = !t || !t.silent;
        if (i) {
            var n = {features: e};
            if (!1 === this.events.triggerEvent("beforefeaturesadded", n))return;
            e = n.features
        }
        for (var n = [], s = 0, r = e.length; r > s; s++) {
            this.renderer.locked = s != e.length - 1 ? !0 : !1;
            var a = e[s];
            if (this.geometryType && !(a.geometry instanceof this.geometryType))throw new TypeError("addFeatures: component should be an " + this.geometryType.prototype.CLASS_NAME);
            if (a.layer = this, !a.style && this.style && (a.style = OpenLayers.Util.extend({}, this.style)), i) {
                if (!1 === this.events.triggerEvent("beforefeatureadded", {feature: a}))continue;
                this.preFeatureInsert(a)
            }
            n.push(a), this.features.push(a), this.drawFeature(a), i && (this.events.triggerEvent("featureadded", {feature: a}), this.onFeatureInsert(a))
        }
        i && this.events.triggerEvent("featuresadded", {features: n})
    },
    removeFeatures: function (e, t) {
        if (e && 0 !== e.length) {
            if (e === this.features)return this.removeAllFeatures(t);
            OpenLayers.Util.isArray(e) || (e = [e]), e === this.selectedFeatures && (e = e.slice());
            var i = !t || !t.silent;
            i && this.events.triggerEvent("beforefeaturesremoved", {features: e});
            for (var n = e.length - 1; n >= 0; n--) {
                this.renderer.locked = 0 != n && e[n - 1].geometry ? !0 : !1;
                var s = e[n];
                delete this.unrenderedFeatures[s.id], i && this.events.triggerEvent("beforefeatureremoved", {feature: s}), this.features = OpenLayers.Util.removeItem(this.features, s), s.layer = null, s.geometry && this.renderer.eraseFeatures(s), -1 != OpenLayers.Util.indexOf(this.selectedFeatures, s) && OpenLayers.Util.removeItem(this.selectedFeatures, s), i && this.events.triggerEvent("featureremoved", {feature: s})
            }
            i && this.events.triggerEvent("featuresremoved", {features: e})
        }
    },
    removeAllFeatures: function (e) {
        var e = !e || !e.silent, t = this.features;
        e && this.events.triggerEvent("beforefeaturesremoved", {features: t});
        for (var i, n = t.length - 1; n >= 0; n--)i = t[n], e && this.events.triggerEvent("beforefeatureremoved", {feature: i}), i.layer = null, e && this.events.triggerEvent("featureremoved", {feature: i});
        this.renderer.clear(), this.features = [], this.unrenderedFeatures = {}, this.selectedFeatures = [], e && this.events.triggerEvent("featuresremoved", {features: t})
    },
    destroyFeatures: function (e, t) {
        if (void 0 == e && (e = this.features), e) {
            this.removeFeatures(e, t);
            for (var i = e.length - 1; i >= 0; i--)e[i].destroy()
        }
    },
    drawFeature: function (e, t) {
        if (this.drawn) {
            if ("object" != typeof t) {
                !t && e.state === OpenLayers.State.DELETE && (t = "delete");
                var i = t || e.renderIntent;
                (t = e.style || this.style) || (t = this.styleMap.createSymbolizer(e, i))
            }
            i = this.renderer.drawFeature(e, t), !1 === i || null === i ? this.unrenderedFeatures[e.id] = e : delete this.unrenderedFeatures[e.id]
        }
    },
    eraseFeatures: function (e) {
        this.renderer.eraseFeatures(e)
    },
    getFeatureFromEvent: function (e) {
        if (!this.renderer)throw Error("getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it.");
        var t = null;
        return (e = this.renderer.getFeatureIdFromEvent(e)) && (t = "string" == typeof e ? this.getFeatureById(e) : e), t
    },
    getFeatureBy: function (e, t) {
        for (var i = null, n = 0, s = this.features.length; s > n; ++n)if (this.features[n][e] == t) {
            i = this.features[n];
            break
        }
        return i
    },
    getFeatureById: function (e) {
        return this.getFeatureBy("id", e)
    },
    getFeatureByFid: function (e) {
        return this.getFeatureBy("fid", e)
    },
    getFeaturesByAttribute: function (e, t) {
        var i, n, s = this.features.length, r = [];
        for (i = 0; s > i; i++)(n = this.features[i]) && n.attributes && n.attributes[e] === t && r.push(n);
        return r
    },
    onFeatureInsert: function () {
    },
    preFeatureInsert: function () {
    },
    getDataExtent: function () {
        var e = null, t = this.features;
        if (t && 0 < t.length)for (var i = null, n = 0, s = t.length; s > n; n++)(i = t[n].geometry) && (null === e && (e = new OpenLayers.Bounds), e.extend(i.getBounds()));
        return e
    },
    CLASS_NAME: "OpenLayers.Layer.Vector"
}),OpenLayers.Layer.Vector.RootContainer = OpenLayers.Class(OpenLayers.Layer.Vector, {
    displayInLayerSwitcher: !1,
    layers: null,
    display: function () {
    },
    getFeatureFromEvent: function (e) {
        for (var t, i = this.layers, n = 0; n < i.length; n++)if (t = i[n].getFeatureFromEvent(e))return t
    },
    setMap: function (e) {
        OpenLayers.Layer.Vector.prototype.setMap.apply(this, arguments), this.collectRoots(), e.events.register("changelayer", this, this.handleChangeLayer)
    },
    removeMap: function (e) {
        e.events.unregister("changelayer", this, this.handleChangeLayer), this.resetRoots(), OpenLayers.Layer.Vector.prototype.removeMap.apply(this, arguments)
    },
    collectRoots: function () {
        for (var e, t = 0; t < this.map.layers.length; ++t)e = this.map.layers[t], -1 != OpenLayers.Util.indexOf(this.layers, e) && e.renderer.moveRoot(this.renderer)
    },
    resetRoots: function () {
        for (var e, t = 0; t < this.layers.length; ++t)e = this.layers[t], this.renderer && e.renderer.getRenderLayerId() == this.id && this.renderer.moveRoot(e.renderer)
    },
    handleChangeLayer: function (e) {
        var t = e.layer;
        "order" == e.property && -1 != OpenLayers.Util.indexOf(this.layers, t) && (this.resetRoots(), this.collectRoots())
    },
    CLASS_NAME: "OpenLayers.Layer.Vector.RootContainer"
}),OpenLayers.Control.SelectFeature = OpenLayers.Class(OpenLayers.Control, {
    multipleKey: null,
    toggleKey: null,
    multiple: !1,
    clickout: !0,
    toggle: !1,
    hover: !1,
    highlightOnly: !1,
    box: !1,
    onBeforeSelect: function () {
    },
    onSelect: function () {
    },
    onUnselect: function () {
    },
    scope: null,
    geometryTypes: null,
    layer: null,
    layers: null,
    callbacks: null,
    selectStyle: null,
    renderIntent: "select",
    handlers: null,
    initialize: function (e, t) {
        OpenLayers.Control.prototype.initialize.apply(this, [t]), null === this.scope && (this.scope = this), this.initLayer(e);
        var i = {click: this.clickFeature, clickout: this.clickoutFeature};
        this.hover && (i.over = this.overFeature, i.out = this.outFeature), this.callbacks = OpenLayers.Util.extend(i, this.callbacks), this.handlers = {feature: new OpenLayers.Handler.Feature(this, this.layer, this.callbacks, {geometryTypes: this.geometryTypes})}, this.box && (this.handlers.box = new OpenLayers.Handler.Box(this, {done: this.selectBox}, {boxDivClassName: "olHandlerBoxSelectFeature"}))
    },
    initLayer: function (e) {
        OpenLayers.Util.isArray(e) ? (this.layers = e, this.layer = new OpenLayers.Layer.Vector.RootContainer(this.id + "_container", {layers: e})) : this.layer = e
    },
    destroy: function () {
        this.active && this.layers && this.map.removeLayer(this.layer), OpenLayers.Control.prototype.destroy.apply(this, arguments), this.layers && this.layer.destroy()
    },
    activate: function () {
        return this.active || (this.layers && this.map.addLayer(this.layer), this.handlers.feature.activate(), this.box && this.handlers.box && this.handlers.box.activate()), OpenLayers.Control.prototype.activate.apply(this, arguments)
    },
    deactivate: function () {
        return this.active && (this.handlers.feature.deactivate(), this.handlers.box && this.handlers.box.deactivate(), this.layers && this.map.removeLayer(this.layer)), OpenLayers.Control.prototype.deactivate.apply(this, arguments)
    },
    unselectAll: function (e) {
        for (var t, i, n = this.layers || [this.layer], s = 0; s < n.length; ++s) {
            t = n[s];
            for (var r = t.selectedFeatures.length - 1; r >= 0; --r)i = t.selectedFeatures[r], (!e || e.except != i) && this.unselect(i)
        }
    },
    clickFeature: function (e) {
        this.hover || (-1 < OpenLayers.Util.indexOf(e.layer.selectedFeatures, e) ? this.toggleSelect() ? this.unselect(e) : this.multipleSelect() || this.unselectAll({except: e}) : (this.multipleSelect() || this.unselectAll({except: e}), this.select(e)))
    },
    multipleSelect: function () {
        return this.multiple || this.handlers.feature.evt && this.handlers.feature.evt[this.multipleKey]
    },
    toggleSelect: function () {
        return this.toggle || this.handlers.feature.evt && this.handlers.feature.evt[this.toggleKey]
    },
    clickoutFeature: function () {
        !this.hover && this.clickout && this.unselectAll()
    },
    overFeature: function (e) {
        var t = e.layer;
        this.hover && (this.highlightOnly ? this.highlight(e) : -1 == OpenLayers.Util.indexOf(t.selectedFeatures, e) && this.select(e))
    },
    outFeature: function (e) {
        if (this.hover)if (this.highlightOnly) {
            if (e._lastHighlighter == this.id)if (e._prevHighlighter && e._prevHighlighter != this.id) {
                delete e._lastHighlighter;
                var t = this.map.getControl(e._prevHighlighter);
                t && t.highlight(e)
            } else this.unhighlight(e)
        } else this.unselect(e)
    },
    highlight: function (e) {
        var t = e.layer;
        !1 !== this.events.triggerEvent("beforefeaturehighlighted", {feature: e}) && (e._prevHighlighter = e._lastHighlighter, e._lastHighlighter = this.id, t.drawFeature(e, this.selectStyle || this.renderIntent), this.events.triggerEvent("featurehighlighted", {feature: e}))
    },
    unhighlight: function (e) {
        var t = e.layer;
        void 0 == e._prevHighlighter ? delete e._lastHighlighter : (e._prevHighlighter != this.id && (e._lastHighlighter = e._prevHighlighter), delete e._prevHighlighter), t.drawFeature(e, e.style || e.layer.style || "default"), this.events.triggerEvent("featureunhighlighted", {feature: e})
    },
    select: function (e) {
        var t = this.onBeforeSelect.call(this.scope, e), i = e.layer;
        !1 !== t && (t = i.events.triggerEvent("beforefeatureselected", {feature: e}), !1 !== t && (i.selectedFeatures.push(e), this.highlight(e), this.handlers.feature.lastFeature || (this.handlers.feature.lastFeature = i.selectedFeatures[0]), i.events.triggerEvent("featureselected", {feature: e}), this.onSelect.call(this.scope, e)))
    },
    unselect: function (e) {
        var t = e.layer;
        this.unhighlight(e), OpenLayers.Util.removeItem(t.selectedFeatures, e), t.events.triggerEvent("featureunselected", {feature: e}), this.onUnselect.call(this.scope, e)
    },
    selectBox: function (e) {
        if (e instanceof OpenLayers.Bounds) {
            var t = this.map.getLonLatFromPixel({x: e.left, y: e.bottom}), e = this.map.getLonLatFromPixel({
                x: e.right,
                y: e.top
            }), t = new OpenLayers.Bounds(t.lon, t.lat, e.lon, e.lat);
            this.multipleSelect() || this.unselectAll(), e = this.multiple, this.multiple = !0;
            var i = this.layers || [this.layer];
            this.events.triggerEvent("boxselectionstart", {layers: i});
            for (var n, s = 0; s < i.length; ++s) {
                n = i[s];
                for (var r = 0, a = n.features.length; a > r; ++r) {
                    var o = n.features[r];
                    o.getVisibility() && (null == this.geometryTypes || -1 < OpenLayers.Util.indexOf(this.geometryTypes, o.geometry.CLASS_NAME)) && t.toGeometry().intersects(o.geometry) && -1 == OpenLayers.Util.indexOf(n.selectedFeatures, o) && this.select(o)
                }
            }
            this.multiple = e, this.events.triggerEvent("boxselectionend", {layers: i})
        }
    },
    setMap: function (e) {
        this.handlers.feature.setMap(e), this.box && this.handlers.box.setMap(e), OpenLayers.Control.prototype.setMap.apply(this, arguments)
    },
    setLayer: function (e) {
        var t = this.active;
        this.unselectAll(), this.deactivate(), this.layers && (this.layer.destroy(), this.layers = null), this.initLayer(e), this.handlers.feature.layer = this.layer, t && this.activate()
    },
    CLASS_NAME: "OpenLayers.Control.SelectFeature"
}),OpenLayers.Handler.Keyboard = OpenLayers.Class(OpenLayers.Handler, {
    KEY_EVENTS: ["keydown", "keyup"],
    eventListener: null,
    observeElement: null,
    initialize: function () {
        OpenLayers.Handler.prototype.initialize.apply(this, arguments), this.eventListener = OpenLayers.Function.bindAsEventListener(this.handleKeyEvent, this)
    },
    destroy: function () {
        this.deactivate(), this.eventListener = null, OpenLayers.Handler.prototype.destroy.apply(this, arguments)
    },
    activate: function () {
        if (OpenLayers.Handler.prototype.activate.apply(this, arguments)) {
            this.observeElement = this.observeElement || document;
            for (var e = 0, t = this.KEY_EVENTS.length; t > e; e++)OpenLayers.Event.observe(this.observeElement, this.KEY_EVENTS[e], this.eventListener);
            return !0
        }
        return !1
    },
    deactivate: function () {
        var e = !1;
        if (OpenLayers.Handler.prototype.deactivate.apply(this, arguments)) {
            for (var e = 0, t = this.KEY_EVENTS.length; t > e; e++)OpenLayers.Event.stopObserving(this.observeElement, this.KEY_EVENTS[e], this.eventListener);
            e = !0
        }
        return e
    },
    handleKeyEvent: function (e) {
        this.checkModifiers(e) && this.callback(e.type, [e])
    },
    CLASS_NAME: "OpenLayers.Handler.Keyboard"
}),OpenLayers.Control.ModifyFeature = OpenLayers.Class(OpenLayers.Control, {
    geometryTypes: null,
    clickout: !0,
    toggle: !0,
    standalone: !1,
    layer: null,
    feature: null,
    vertices: null,
    virtualVertices: null,
    selectControl: null,
    dragControl: null,
    handlers: null,
    deleteCodes: null,
    virtualStyle: null,
    vertexRenderIntent: null,
    mode: null,
    createVertices: !0,
    modified: !1,
    radiusHandle: null,
    dragHandle: null,
    onModificationStart: function () {
    },
    onModification: function () {
    },
    onModificationEnd: function () {
    },
    initialize: function (e, t) {
        t = t || {}, this.layer = e, this.vertices = [], this.virtualVertices = [], this.virtualStyle = OpenLayers.Util.extend({}, this.layer.style || this.layer.styleMap.createSymbolizer(null, t.vertexRenderIntent)), this.virtualStyle.fillOpacity = .3, this.virtualStyle.strokeOpacity = .3, this.deleteCodes = [46, 68], this.mode = OpenLayers.Control.ModifyFeature.RESHAPE, OpenLayers.Control.prototype.initialize.apply(this, [t]), OpenLayers.Util.isArray(this.deleteCodes) || (this.deleteCodes = [this.deleteCodes]);
        var i = this, n = {
            geometryTypes: this.geometryTypes,
            clickout: this.clickout,
            toggle: this.toggle,
            onBeforeSelect: this.beforeSelectFeature,
            onSelect: this.selectFeature,
            onUnselect: this.unselectFeature,
            scope: this
        };
        !1 === this.standalone && (this.selectControl = new OpenLayers.Control.SelectFeature(e, n)), this.dragControl = new OpenLayers.Control.DragFeature(e, {
            geometryTypes: ["OpenLayers.Geometry.Point"],
            onStart: function (e, t) {
                i.dragStart.apply(i, [e, t])
            },
            onDrag: function (e, t) {
                i.dragVertex.apply(i, [e, t])
            },
            onComplete: function (e) {
                i.dragComplete.apply(i, [e])
            },
            featureCallbacks: {
                over: function (e) {
                    (i.standalone !== !0 || e._sketch || i.feature === e) && i.dragControl.overFeature.apply(i.dragControl, [e])
                }
            }
        }), this.handlers = {keyboard: new OpenLayers.Handler.Keyboard(this, {keydown: this.handleKeypress})}
    },
    destroy: function () {
        this.layer = null, this.standalone || this.selectControl.destroy(), this.dragControl.destroy(), OpenLayers.Control.prototype.destroy.apply(this, [])
    },
    activate: function () {
        return (this.standalone || this.selectControl.activate()) && this.handlers.keyboard.activate() && OpenLayers.Control.prototype.activate.apply(this, arguments)
    },
    deactivate: function () {
        var e = !1;
        if (OpenLayers.Control.prototype.deactivate.apply(this, arguments)) {
            this.layer.removeFeatures(this.vertices, {silent: !0}), this.layer.removeFeatures(this.virtualVertices, {silent: !0}), this.vertices = [], this.dragControl.deactivate();
            var t = (e = this.feature) && e.geometry && e.layer;
            !1 === this.standalone ? (t && this.selectControl.unselect.apply(this.selectControl, [e]), this.selectControl.deactivate()) : t && this.unselectFeature(e), this.handlers.keyboard.deactivate(), e = !0
        }
        return e
    },
    beforeSelectFeature: function (e) {
        return this.layer.events.triggerEvent("beforefeaturemodified", {feature: e})
    },
    selectFeature: function (e) {
        this.standalone && !1 === this.beforeSelectFeature(e) || (this.feature = e, this.modified = !1, this.resetVertices(), this.dragControl.activate(), this.onModificationStart(this.feature));
        var t = e.modified;
        !e.geometry || t && t.geometry || (this._originalGeometry = e.geometry.clone())
    },
    unselectFeature: function (e) {
        this.layer.removeFeatures(this.vertices, {silent: !0}), this.vertices = [], this.layer.destroyFeatures(this.virtualVertices, {silent: !0}), this.virtualVertices = [], this.dragHandle && (this.layer.destroyFeatures([this.dragHandle], {silent: !0}), delete this.dragHandle), this.radiusHandle && (this.layer.destroyFeatures([this.radiusHandle], {silent: !0}), delete this.radiusHandle), this.feature = null, this.dragControl.deactivate(), this.onModificationEnd(e), this.layer.events.triggerEvent("afterfeaturemodified", {
            feature: e,
            modified: this.modified
        }), this.modified = !1
    },
    dragStart: function (e, t) {
        e == this.feature || e.geometry.parent || e == this.dragHandle || e == this.radiusHandle || (!1 === this.standalone && this.feature && this.selectControl.clickFeature.apply(this.selectControl, [this.feature]), null != this.geometryTypes && -1 == OpenLayers.Util.indexOf(this.geometryTypes, e.geometry.CLASS_NAME)) || (this.standalone || this.selectControl.clickFeature.apply(this.selectControl, [e]), this.dragControl.overFeature.apply(this.dragControl, [e]), this.dragControl.lastPixel = t, this.dragControl.handlers.drag.started = !0, this.dragControl.handlers.drag.start = t, this.dragControl.handlers.drag.last = t)
    },
    dragVertex: function (e, t) {
        this.modified = !0, "OpenLayers.Geometry.Point" == this.feature.geometry.CLASS_NAME ? (this.feature != e && (this.feature = e), this.layer.events.triggerEvent("vertexmodified", {
            vertex: e.geometry,
            feature: this.feature,
            pixel: t
        })) : (e._index ? (e.geometry.parent.addComponent(e.geometry, e._index), delete e._index, OpenLayers.Util.removeItem(this.virtualVertices, e), this.vertices.push(e)) : e == this.dragHandle ? (this.layer.removeFeatures(this.vertices, {silent: !0}), this.vertices = [], this.radiusHandle && (this.layer.destroyFeatures([this.radiusHandle], {silent: !0}), this.radiusHandle = null)) : e !== this.radiusHandle && this.layer.events.triggerEvent("vertexmodified", {
            vertex: e.geometry,
            feature: this.feature,
            pixel: t
        }), 0 < this.virtualVertices.length && (this.layer.destroyFeatures(this.virtualVertices, {silent: !0}), this.virtualVertices = []), this.layer.drawFeature(this.feature, this.standalone ? void 0 : this.selectControl.renderIntent)), this.layer.drawFeature(e)
    },
    dragComplete: function () {
        this.resetVertices(), this.setFeatureState(), this.onModification(this.feature), this.layer.events.triggerEvent("featuremodified", {feature: this.feature})
    },
    setFeatureState: function () {
        if (this.feature.state != OpenLayers.State.INSERT && this.feature.state != OpenLayers.State.DELETE && (this.feature.state = OpenLayers.State.UPDATE, this.modified && this._originalGeometry)) {
            var e = this.feature;
            e.modified = OpenLayers.Util.extend(e.modified, {geometry: this._originalGeometry}), delete this._originalGeometry
        }
    },
    resetVertices: function () {
        this.dragControl.feature && this.dragControl.outFeature(this.dragControl.feature), 0 < this.vertices.length && (this.layer.removeFeatures(this.vertices, {silent: !0}), this.vertices = []), 0 < this.virtualVertices.length && (this.layer.removeFeatures(this.virtualVertices, {silent: !0}), this.virtualVertices = []), this.dragHandle && (this.layer.destroyFeatures([this.dragHandle], {silent: !0}), this.dragHandle = null), this.radiusHandle && (this.layer.destroyFeatures([this.radiusHandle], {silent: !0}), this.radiusHandle = null), this.feature && "OpenLayers.Geometry.Point" != this.feature.geometry.CLASS_NAME && (this.mode & OpenLayers.Control.ModifyFeature.DRAG && this.collectDragHandle(), this.mode & (OpenLayers.Control.ModifyFeature.ROTATE | OpenLayers.Control.ModifyFeature.RESIZE) && this.collectRadiusHandle(), this.mode & OpenLayers.Control.ModifyFeature.RESHAPE && (this.mode & OpenLayers.Control.ModifyFeature.RESIZE || this.collectVertices()))
    },
    handleKeypress: function (e) {
        var t = e.keyCode;
        this.feature && -1 != OpenLayers.Util.indexOf(this.deleteCodes, t) && (t = this.dragControl.feature) && -1 != OpenLayers.Util.indexOf(this.vertices, t) && !this.dragControl.handlers.drag.dragging && t.geometry.parent && (t.geometry.parent.removeComponent(t.geometry), this.layer.events.triggerEvent("vertexremoved", {
            vertex: t.geometry,
            feature: this.feature,
            pixel: e.xy
        }), this.layer.drawFeature(this.feature, this.standalone ? void 0 : this.selectControl.renderIntent), this.modified = !0, this.resetVertices(), this.setFeatureState(), this.onModification(this.feature), this.layer.events.triggerEvent("featuremodified", {feature: this.feature}))
    },
    collectVertices: function () {
        function e(i) {
            var n, s, r;
            if ("OpenLayers.Geometry.Point" == i.CLASS_NAME) s = new OpenLayers.Feature.Vector(i), s._sketch = !0, s.renderIntent = t.vertexRenderIntent, t.vertices.push(s); else {
                for (r = i.components.length, "OpenLayers.Geometry.LinearRing" == i.CLASS_NAME && (r -= 1), n = 0; r > n; ++n)s = i.components[n], "OpenLayers.Geometry.Point" == s.CLASS_NAME ? (s = new OpenLayers.Feature.Vector(s), s._sketch = !0, s.renderIntent = t.vertexRenderIntent, t.vertices.push(s)) : e(s);
                if (t.createVertices && "OpenLayers.Geometry.MultiPoint" != i.CLASS_NAME)for (n = 0, r = i.components.length; r - 1 > n; ++n) {
                    s = i.components[n];
                    var a = i.components[n + 1];
                    "OpenLayers.Geometry.Point" == s.CLASS_NAME && "OpenLayers.Geometry.Point" == a.CLASS_NAME && (s = new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point((s.x + a.x) / 2, (s.y + a.y) / 2), null, t.virtualStyle), s.geometry.parent = i, s._index = n + 1, s._sketch = !0, t.virtualVertices.push(s))
                }
            }
        }

        this.vertices = [], this.virtualVertices = [];
        var t = this;
        e.call(this, this.feature.geometry), this.layer.addFeatures(this.virtualVertices, {silent: !0}), this.layer.addFeatures(this.vertices, {silent: !0})
    },
    collectDragHandle: function () {
        var e = this.feature.geometry, t = e.getBounds().getCenterLonLat(), t = new OpenLayers.Geometry.Point(t.lon, t.lat), i = new OpenLayers.Feature.Vector(t);
        t.move = function (t, i) {
            OpenLayers.Geometry.Point.prototype.move.call(this, t, i), e.move(t, i)
        }, i._sketch = !0, this.dragHandle = i, this.dragHandle.renderIntent = this.vertexRenderIntent, this.layer.addFeatures([this.dragHandle], {silent: !0})
    },
    collectRadiusHandle: function () {
        var e = this.feature.geometry, t = e.getBounds(), i = t.getCenterLonLat(), n = new OpenLayers.Geometry.Point(i.lon, i.lat), t = new OpenLayers.Geometry.Point(t.right, t.bottom), i = new OpenLayers.Feature.Vector(t), s = this.mode & OpenLayers.Control.ModifyFeature.RESIZE, r = this.mode & OpenLayers.Control.ModifyFeature.RESHAPE, a = this.mode & OpenLayers.Control.ModifyFeature.ROTATE;
        t.move = function (t, i) {
            OpenLayers.Geometry.Point.prototype.move.call(this, t, i);
            var o = this.x - n.x, l = this.y - n.y, h = o - t, u = l - i;
            if (a) {
                var c = Math.atan2(u, h), c = Math.atan2(l, o) - c, c = c * (180 / Math.PI);
                e.rotate(c, n)
            }
            if (s) {
                var p;
                r ? (l /= u, p = o / h / l) : (h = Math.sqrt(h * h + u * u), l = Math.sqrt(o * o + l * l) / h), e.resize(l, n, p)
            }
        }, i._sketch = !0, this.radiusHandle = i, this.radiusHandle.renderIntent = this.vertexRenderIntent, this.layer.addFeatures([this.radiusHandle], {silent: !0})
    },
    setMap: function (e) {
        this.standalone || this.selectControl.setMap(e), this.dragControl.setMap(e), OpenLayers.Control.prototype.setMap.apply(this, arguments)
    },
    CLASS_NAME: "OpenLayers.Control.ModifyFeature"
}),OpenLayers.Control.ModifyFeature.RESHAPE = 1,OpenLayers.Control.ModifyFeature.RESIZE = 2,OpenLayers.Control.ModifyFeature.ROTATE = 4,OpenLayers.Control.ModifyFeature.DRAG = 8,OpenLayers.Layer.Bing = OpenLayers.Class(OpenLayers.Layer.XYZ, {
    key: null,
    serverResolutions: [156543.03390625, 78271.516953125, 39135.7584765625, 19567.87923828125, 9783.939619140625, 4891.9698095703125, 2445.9849047851562, 1222.9924523925781, 611.4962261962891, 305.74811309814453, 152.87405654907226, 76.43702827453613, 38.218514137268066, 19.109257068634033, 9.554628534317017, 4.777314267158508, 2.388657133579254, 1.194328566789627, .5971642833948135, .29858214169740677, .14929107084870338, .07464553542435169],
    attributionTemplate: '<span class="olBingAttribution ${type}"><div><a target="_blank" href="http://www.bing.com/maps/"><img src="${logo}" /></a></div>${copyrights}<a style="white-space: nowrap" target="_blank" href="http://www.microsoft.com/maps/product/terms.html">Terms of Use</a></span>',
    metadata: null,
    type: "Road",
    culture: "en-US",
    metadataParams: null,
    tileOptions: null,
    initialize: function (e) {
        e = OpenLayers.Util.applyDefaults({sphericalMercator: !0}, e), OpenLayers.Layer.XYZ.prototype.initialize.apply(this, [e.name || "Bing " + (e.type || this.type), null, e]), this.tileOptions = OpenLayers.Util.extend({crossOriginKeyword: "anonymous"}, this.options.tileOptions), this.loadMetadata()
    },
    loadMetadata: function () {
        this._callbackId = "_callback_" + this.id.replace(/\./g, "_"), window[this._callbackId] = OpenLayers.Function.bind(OpenLayers.Layer.Bing.processMetadata, this);
        var e = OpenLayers.Util.applyDefaults({
            key: this.key,
            jsonp: this._callbackId,
            include: "ImageryProviders"
        }, this.metadataParams), e = "http://dev.virtualearth.net/REST/v1/Imagery/Metadata/" + this.type + "?" + OpenLayers.Util.getParameterString(e), t = document.createElement("script");
        t.type = "text/javascript", t.src = e, t.id = this._callbackId, document.getElementsByTagName("head")[0].appendChild(t)
    },
    initLayer: function () {
        var e = this.metadata.resourceSets[0].resources[0], t = e.imageUrl.replace("{quadkey}", "${quadkey}"), t = t.replace("{culture}", this.culture);
        this.url = [];
        for (var i = 0; i < e.imageUrlSubdomains.length; ++i)this.url.push(t.replace("{subdomain}", e.imageUrlSubdomains[i]));
        this.addOptions({
            maxResolution: Math.min(this.serverResolutions[e.zoomMin], this.maxResolution || Number.POSITIVE_INFINITY),
            numZoomLevels: Math.min(e.zoomMax + 1 - e.zoomMin, this.numZoomLevels)
        }, !0)
    },
    getURL: function (e) {
        if (this.url) {
            for (var t = this.getXYZ(e), e = t.x, i = t.y, t = t.z, n = [], s = t; s > 0; --s) {
                var r = "0", a = 1 << s - 1;
                0 != (e & a) && r++, 0 != (i & a) && (r++, r++), n.push(r)
            }
            return n = n.join(""), e = this.selectUrl("" + e + i + t, this.url), OpenLayers.String.format(e, {quadkey: n})
        }
    },
    updateAttribution: function () {
        var e = this.metadata;
        if (e.resourceSets && this.map && this.map.center) {
            var t, i, n, s, r, a, o, l = e.resourceSets[0].resources[0], h = this.map.getExtent().transform(this.map.getProjectionObject(), new OpenLayers.Projection("EPSG:4326")), l = l.imageryProviders, u = OpenLayers.Util.indexOf(this.serverResolutions, this.getServerResolution()), c = "";
            for (i = 0, n = l.length; n > i; ++i)for (t = l[i], s = 0, r = t.coverageAreas.length; r > s; ++s)o = t.coverageAreas[s], a = OpenLayers.Bounds.fromArray(o.bbox, !0), h.intersectsBounds(a) && u <= o.zoomMax && u >= o.zoomMin && (c += t.attribution + " ");
            this.attribution = OpenLayers.String.format(this.attributionTemplate, {
                type: this.type.toLowerCase(),
                logo: e.brandLogoUri,
                copyrights: c
            }), this.map && this.map.events.triggerEvent("changelayer", {layer: this, property: "attribution"})
        }
    },
    setMap: function () {
        OpenLayers.Layer.XYZ.prototype.setMap.apply(this, arguments), this.updateAttribution(), this.map.events.register("moveend", this, this.updateAttribution)
    },
    clone: function (e) {
        return null == e && (e = new OpenLayers.Layer.Bing(this.options)), e = OpenLayers.Layer.XYZ.prototype.clone.apply(this, [e])
    },
    destroy: function () {
        this.map && this.map.events.unregister("moveend", this, this.updateAttribution), OpenLayers.Layer.XYZ.prototype.destroy.apply(this, arguments)
    },
    CLASS_NAME: "OpenLayers.Layer.Bing"
}),OpenLayers.Layer.Bing.processMetadata = function (e) {
    this.metadata = e, this.initLayer(), e = document.getElementById(this._callbackId), e.parentNode.removeChild(e), window[this._callbackId] = void 0, delete this._callbackId
},OpenLayers.Layer.PointGrid = OpenLayers.Class(OpenLayers.Layer.Vector, {
    dx: null,
    dy: null,
    ratio: 1.5,
    maxFeatures: 250,
    rotation: 0,
    origin: null,
    gridBounds: null,
    initialize: function (e) {
        e = e || {}, OpenLayers.Layer.Vector.prototype.initialize.apply(this, [e.name, e])
    },
    setMap: function (e) {
        OpenLayers.Layer.Vector.prototype.setMap.apply(this, arguments), e.events.register("moveend", this, this.onMoveEnd)
    },
    removeMap: function (e) {
        e.events.unregister("moveend", this, this.onMoveEnd), OpenLayers.Layer.Vector.prototype.removeMap.apply(this, arguments)
    },
    setRatio: function (e) {
        this.ratio = e, this.updateGrid(!0)
    },
    setMaxFeatures: function (e) {
        this.maxFeatures = e, this.updateGrid(!0)
    },
    setSpacing: function (e, t) {
        this.dx = e, this.dy = t || e, this.updateGrid(!0)
    },
    setOrigin: function (e) {
        this.origin = e, this.updateGrid(!0)
    },
    getOrigin: function () {
        return this.origin || (this.origin = this.map.getExtent().getCenterLonLat()), this.origin
    },
    setRotation: function (e) {
        this.rotation = e, this.updateGrid(!0)
    },
    onMoveEnd: function () {
        this.updateGrid()
    },
    getViewBounds: function () {
        var e = this.map.getExtent();
        if (this.rotation) {
            var t = this.getOrigin(), t = new OpenLayers.Geometry.Point(t.lon, t.lat), e = e.toGeometry();
            e.rotate(-this.rotation, t), e = e.getBounds()
        }
        return e
    },
    updateGrid: function (e) {
        if (e || this.invalidBounds()) {
            var t = this.getViewBounds(), i = this.getOrigin(), e = new OpenLayers.Geometry.Point(i.lon, i.lat), n = t.getWidth(), s = t.getHeight(), r = n / s, a = Math.sqrt(this.dx * this.dy * this.maxFeatures / r), n = Math.min(n * this.ratio, a * r), s = Math.min(s * this.ratio, a), t = t.getCenterLonLat();
            this.gridBounds = new OpenLayers.Bounds(t.lon - n / 2, t.lat - s / 2, t.lon + n / 2, t.lat + s / 2);
            for (var o, t = Math.floor(s / this.dy), n = Math.floor(n / this.dx), s = i.lon + this.dx * Math.ceil((this.gridBounds.left - i.lon) / this.dx), i = i.lat + this.dy * Math.ceil((this.gridBounds.bottom - i.lat) / this.dy), a = Array(t * n), l = 0; n > l; ++l)for (var r = s + l * this.dx, h = 0; t > h; ++h)o = i + h * this.dy, o = new OpenLayers.Geometry.Point(r, o), this.rotation && o.rotate(this.rotation, e), a[l * t + h] = new OpenLayers.Feature.Vector(o);
            this.destroyFeatures(this.features, {silent: !0}), this.addFeatures(a, {silent: !0})
        }
    },
    invalidBounds: function () {
        return !this.gridBounds || !this.gridBounds.containsBounds(this.getViewBounds())
    },
    CLASS_NAME: "OpenLayers.Layer.PointGrid"
}),OpenLayers.Handler.MouseWheel = OpenLayers.Class(OpenLayers.Handler, {
    wheelListener: null,
    mousePosition: null,
    interval: 0,
    delta: 0,
    cumulative: !0,
    initialize: function () {
        OpenLayers.Handler.prototype.initialize.apply(this, arguments), this.wheelListener = OpenLayers.Function.bindAsEventListener(this.onWheelEvent, this)
    },
    destroy: function () {
        OpenLayers.Handler.prototype.destroy.apply(this, arguments), this.wheelListener = null
    },
    onWheelEvent: function (e) {
        if (this.map && this.checkModifiers(e)) {
            for (var t = !1, i = !1, n = !1, s = OpenLayers.Event.element(e); null != s && !n && !t;) {
                if (!t)try {
                    var r = s.currentStyle ? s.currentStyle.overflow : document.defaultView.getComputedStyle(s, null).getPropertyValue("overflow"), t = r && "auto" == r || "scroll" == r
                } catch (a) {
                }
                if (!i)for (var n = 0, o = this.map.layers.length; o > n; n++)if (s == this.map.layers[n].div || s == this.map.layers[n].pane) {
                    i = !0;
                    break
                }
                n = s == this.map.div, s = s.parentNode
            }
            !t && n && (i && (t = 0, e || (e = window.event), e.wheelDelta ? (t = e.wheelDelta / 120, window.opera && 9.2 > window.opera.version() && (t = -t)) : e.detail && (t = -e.detail / 3), this.delta += t, this.interval ? (window.clearTimeout(this._timeoutId), this._timeoutId = window.setTimeout(OpenLayers.Function.bind(function () {
                this.wheelZoom(e)
            }, this), this.interval)) : this.wheelZoom(e)), OpenLayers.Event.stop(e))
        }
    },
    wheelZoom: function (e) {
        var t = this.delta;
        this.delta = 0, t && (this.mousePosition && (e.xy = this.mousePosition), e.xy || (e.xy = this.map.getPixelFromLonLat(this.map.getCenter())), 0 > t ? this.callback("down", [e, this.cumulative ? t : -1]) : this.callback("up", [e, this.cumulative ? t : 1]))
    },
    mousemove: function (e) {
        this.mousePosition = e.xy
    },
    activate: function () {
        if (OpenLayers.Handler.prototype.activate.apply(this, arguments)) {
            var e = this.wheelListener;
            return OpenLayers.Event.observe(window, "DOMMouseScroll", e), OpenLayers.Event.observe(window, "mousewheel", e), OpenLayers.Event.observe(document, "mousewheel", e), !0
        }
        return !1
    },
    deactivate: function () {
        if (OpenLayers.Handler.prototype.deactivate.apply(this, arguments)) {
            var e = this.wheelListener;
            return OpenLayers.Event.stopObserving(window, "DOMMouseScroll", e), OpenLayers.Event.stopObserving(window, "mousewheel", e), OpenLayers.Event.stopObserving(document, "mousewheel", e), !0
        }
        return !1
    },
    CLASS_NAME: "OpenLayers.Handler.MouseWheel"
}),OpenLayers.Symbolizer = OpenLayers.Class({
    zIndex: 0, initialize: function (e) {
        OpenLayers.Util.extend(this, e)
    }, clone: function () {
        return new (eval(this.CLASS_NAME))(OpenLayers.Util.extend({}, this))
    }, CLASS_NAME: "OpenLayers.Symbolizer"
}),OpenLayers.Symbolizer.Raster = OpenLayers.Class(OpenLayers.Symbolizer, {
    initialize: function () {
        OpenLayers.Symbolizer.prototype.initialize.apply(this, arguments)
    }, CLASS_NAME: "OpenLayers.Symbolizer.Raster"
}),OpenLayers.Rule = OpenLayers.Class({
    id: null,
    name: null,
    title: null,
    description: null,
    context: null,
    filter: null,
    elseFilter: !1,
    symbolizer: null,
    symbolizers: null,
    minScaleDenominator: null,
    maxScaleDenominator: null,
    initialize: function (e) {
        this.symbolizer = {}, OpenLayers.Util.extend(this, e), this.symbolizers && delete this.symbolizer, this.id = OpenLayers.Util.createUniqueID(this.CLASS_NAME + "_")
    },
    destroy: function () {
        for (var e in this.symbolizer)this.symbolizer[e] = null;
        this.symbolizer = null, delete this.symbolizers
    },
    evaluate: function (e) {
        var t = this.getContext(e), i = !0;
        if (this.minScaleDenominator || this.maxScaleDenominator)var n = e.layer.map.getScale();
        return this.minScaleDenominator && (i = n >= OpenLayers.Style.createLiteral(this.minScaleDenominator, t)), i && this.maxScaleDenominator && (i = n < OpenLayers.Style.createLiteral(this.maxScaleDenominator, t)), i && this.filter && (i = "OpenLayers.Filter.FeatureId" == this.filter.CLASS_NAME ? this.filter.evaluate(e) : this.filter.evaluate(t)), i
    },
    getContext: function (e) {
        var t = this.context;
        return t || (t = e.attributes || e.data), "function" == typeof this.context && (t = this.context(e)), t
    },
    clone: function () {
        var e = OpenLayers.Util.extend({}, this);
        if (this.symbolizers) {
            var t = this.symbolizers.length;
            e.symbolizers = Array(t);
            for (var i = 0; t > i; ++i)e.symbolizers[i] = this.symbolizers[i].clone()
        } else {
            e.symbolizer = {};
            for (var n in this.symbolizer)t = this.symbolizer[n], i = typeof t, "object" === i ? e.symbolizer[n] = OpenLayers.Util.extend({}, t) : "string" === i && (e.symbolizer[n] = t)
        }
        return e.filter = this.filter && this.filter.clone(), e.context = this.context && OpenLayers.Util.extend({}, this.context), new OpenLayers.Rule(e)
    },
    CLASS_NAME: "OpenLayers.Rule"
}),OpenLayers.Filter.Spatial = OpenLayers.Class(OpenLayers.Filter, {
    type: null,
    property: null,
    value: null,
    distance: null,
    distanceUnits: null,
    evaluate: function (e) {
        var t = !1;
        switch (this.type) {
            case OpenLayers.Filter.Spatial.BBOX:
            case OpenLayers.Filter.Spatial.INTERSECTS:
                if (e.geometry) {
                    var i = this.value;
                    "OpenLayers.Bounds" == this.value.CLASS_NAME && (i = this.value.toGeometry()), e.geometry.intersects(i) && (t = !0)
                }
                break;
            default:
                throw Error("evaluate is not implemented for this filter type.")
        }
        return t
    },
    clone: function () {
        var e = OpenLayers.Util.applyDefaults({value: this.value && this.value.clone && this.value.clone()}, this);
        return new OpenLayers.Filter.Spatial(e)
    },
    CLASS_NAME: "OpenLayers.Filter.Spatial"
}),OpenLayers.Filter.Spatial.BBOX = "BBOX",OpenLayers.Filter.Spatial.INTERSECTS = "INTERSECTS",OpenLayers.Filter.Spatial.DWITHIN = "DWITHIN",OpenLayers.Filter.Spatial.WITHIN = "WITHIN",OpenLayers.Filter.Spatial.CONTAINS = "CONTAINS",OpenLayers.Format.SLD = OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC, {
    profile: null,
    defaultVersion: "1.0.0",
    stringifyOutput: !0,
    namedLayersAsArray: !1,
    CLASS_NAME: "OpenLayers.Format.SLD"
}),OpenLayers.Symbolizer.Polygon = OpenLayers.Class(OpenLayers.Symbolizer, {
    initialize: function () {
        OpenLayers.Symbolizer.prototype.initialize.apply(this, arguments)
    }, CLASS_NAME: "OpenLayers.Symbolizer.Polygon"
}),OpenLayers.Format.GML.v2 = OpenLayers.Class(OpenLayers.Format.GML.Base, {
    schemaLocation: "http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd",
    initialize: function (e) {
        OpenLayers.Format.GML.Base.prototype.initialize.apply(this, [e])
    },
    readers: {
        gml: OpenLayers.Util.applyDefaults({
            outerBoundaryIs: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), t.outer = i.components[0]
            }, innerBoundaryIs: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), t.inner.push(i.components[0])
            }, Box: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), t.components || (t.components = []);
                var n = i.points[0], i = i.points[1];
                t.components.push(new OpenLayers.Bounds(n.x, n.y, i.x, i.y))
            }
        }, OpenLayers.Format.GML.Base.prototype.readers.gml),
        feature: OpenLayers.Format.GML.Base.prototype.readers.feature,
        wfs: OpenLayers.Format.GML.Base.prototype.readers.wfs
    },
    write: function (e) {
        return e = this.writeNode(OpenLayers.Util.isArray(e) ? "wfs:FeatureCollection" : "gml:featureMember", e), this.setAttributeNS(e, this.namespaces.xsi, "xsi:schemaLocation", this.schemaLocation), OpenLayers.Format.XML.prototype.write.apply(this, [e])
    },
    writers: {
        gml: OpenLayers.Util.applyDefaults({
            Point: function (e) {
                var t = this.createElementNSPlus("gml:Point");
                return this.writeNode("coordinates", [e], t), t
            }, coordinates: function (e) {
                for (var t, i = e.length, n = Array(i), s = 0; i > s; ++s)t = e[s], n[s] = this.xy ? t.x + "," + t.y : t.y + "," + t.x, void 0 != t.z && (n[s] += "," + t.z);
                return this.createElementNSPlus("gml:coordinates", {
                    attributes: {decimal: ".", cs: ",", ts: " "},
                    value: 1 == i ? n[0] : n.join(" ")
                })
            }, LineString: function (e) {
                var t = this.createElementNSPlus("gml:LineString");
                return this.writeNode("coordinates", e.components, t), t
            }, Polygon: function (e) {
                var t = this.createElementNSPlus("gml:Polygon");
                this.writeNode("outerBoundaryIs", e.components[0], t);
                for (var i = 1; i < e.components.length; ++i)this.writeNode("innerBoundaryIs", e.components[i], t);
                return t
            }, outerBoundaryIs: function (e) {
                var t = this.createElementNSPlus("gml:outerBoundaryIs");
                return this.writeNode("LinearRing", e, t), t
            }, innerBoundaryIs: function (e) {
                var t = this.createElementNSPlus("gml:innerBoundaryIs");
                return this.writeNode("LinearRing", e, t), t
            }, LinearRing: function (e) {
                var t = this.createElementNSPlus("gml:LinearRing");
                return this.writeNode("coordinates", e.components, t), t
            }, Box: function (e) {
                var t = this.createElementNSPlus("gml:Box");
                return this.writeNode("coordinates", [{x: e.left, y: e.bottom}, {
                    x: e.right,
                    y: e.top
                }], t), this.srsName && t.setAttribute("srsName", this.srsName), t
            }
        }, OpenLayers.Format.GML.Base.prototype.writers.gml),
        feature: OpenLayers.Format.GML.Base.prototype.writers.feature,
        wfs: OpenLayers.Format.GML.Base.prototype.writers.wfs
    },
    CLASS_NAME: "OpenLayers.Format.GML.v2"
}),OpenLayers.Format.Filter.v1_0_0 = OpenLayers.Class(OpenLayers.Format.GML.v2, OpenLayers.Format.Filter.v1, {
    VERSION: "1.0.0",
    schemaLocation: "http://www.opengis.net/ogc/filter/1.0.0/filter.xsd",
    initialize: function (e) {
        OpenLayers.Format.GML.v2.prototype.initialize.apply(this, [e])
    },
    readers: {
        ogc: OpenLayers.Util.applyDefaults({
            PropertyIsEqualTo: function (e, t) {
                var i = new OpenLayers.Filter.Comparison({type: OpenLayers.Filter.Comparison.EQUAL_TO});
                this.readChildNodes(e, i), t.filters.push(i)
            }, PropertyIsNotEqualTo: function (e, t) {
                var i = new OpenLayers.Filter.Comparison({type: OpenLayers.Filter.Comparison.NOT_EQUAL_TO});
                this.readChildNodes(e, i), t.filters.push(i)
            }, PropertyIsLike: function (e, t) {
                var i = new OpenLayers.Filter.Comparison({type: OpenLayers.Filter.Comparison.LIKE});
                this.readChildNodes(e, i);
                var n = e.getAttribute("wildCard"), s = e.getAttribute("singleChar"), r = e.getAttribute("escape");
                i.value2regex(n, s, r), t.filters.push(i)
            }
        }, OpenLayers.Format.Filter.v1.prototype.readers.ogc),
        gml: OpenLayers.Format.GML.v2.prototype.readers.gml,
        feature: OpenLayers.Format.GML.v2.prototype.readers.feature
    },
    writers: {
        ogc: OpenLayers.Util.applyDefaults({
            PropertyIsEqualTo: function (e) {
                var t = this.createElementNSPlus("ogc:PropertyIsEqualTo");
                return this.writeNode("PropertyName", e, t), this.writeOgcExpression(e.value, t), t
            }, PropertyIsNotEqualTo: function (e) {
                var t = this.createElementNSPlus("ogc:PropertyIsNotEqualTo");
                return this.writeNode("PropertyName", e, t), this.writeOgcExpression(e.value, t), t
            }, PropertyIsLike: function (e) {
                var t = this.createElementNSPlus("ogc:PropertyIsLike", {
                    attributes: {
                        wildCard: "*",
                        singleChar: ".",
                        escape: "!"
                    }
                });
                return this.writeNode("PropertyName", e, t), this.writeNode("Literal", e.regex2value(), t), t
            }, BBOX: function (e) {
                var t = this.createElementNSPlus("ogc:BBOX");
                e.property && this.writeNode("PropertyName", e, t);
                var i = this.writeNode("gml:Box", e.value, t);
                return e.projection && i.setAttribute("srsName", e.projection), t
            }
        }, OpenLayers.Format.Filter.v1.prototype.writers.ogc),
        gml: OpenLayers.Format.GML.v2.prototype.writers.gml,
        feature: OpenLayers.Format.GML.v2.prototype.writers.feature
    },
    writeSpatial: function (e, t) {
        var i = this.createElementNSPlus("ogc:" + t);
        if (this.writeNode("PropertyName", e, i), e.value instanceof OpenLayers.Filter.Function) this.writeNode("Function", e.value, i); else {
            var n;
            n = e.value instanceof OpenLayers.Geometry ? this.writeNode("feature:_geometry", e.value).firstChild : this.writeNode("gml:Box", e.value), e.projection && n.setAttribute("srsName", e.projection), i.appendChild(n)
        }
        return i
    },
    CLASS_NAME: "OpenLayers.Format.Filter.v1_0_0"
}),OpenLayers.Format.WFST.v1_0_0 = OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0, OpenLayers.Format.WFST.v1, {
    version: "1.0.0",
    srsNameInQuery: !1,
    schemaLocations: {wfs: "http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd"},
    initialize: function (e) {
        OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(this, [e]), OpenLayers.Format.WFST.v1.prototype.initialize.apply(this, [e])
    },
    readNode: function (e, t) {
        return OpenLayers.Format.GML.v2.prototype.readNode.apply(this, [e, t])
    },
    readers: {
        wfs: OpenLayers.Util.applyDefaults({
            WFS_TransactionResponse: function (e, t) {
                t.insertIds = [], t.success = !1, this.readChildNodes(e, t)
            }, InsertResult: function (e, t) {
                var i = {fids: []};
                this.readChildNodes(e, i), t.insertIds.push(i.fids[0])
            }, TransactionResult: function (e, t) {
                this.readChildNodes(e, t)
            }, Status: function (e, t) {
                this.readChildNodes(e, t)
            }, SUCCESS: function (e, t) {
                t.success = !0
            }
        }, OpenLayers.Format.WFST.v1.prototype.readers.wfs),
        gml: OpenLayers.Format.GML.v2.prototype.readers.gml,
        feature: OpenLayers.Format.GML.v2.prototype.readers.feature,
        ogc: OpenLayers.Format.Filter.v1_0_0.prototype.readers.ogc
    },
    writers: {
        wfs: OpenLayers.Util.applyDefaults({
            Query: function (e) {
                var e = OpenLayers.Util.extend({
                    featureNS: this.featureNS,
                    featurePrefix: this.featurePrefix,
                    featureType: this.featureType,
                    srsName: this.srsName,
                    srsNameInQuery: this.srsNameInQuery
                }, e), t = e.featurePrefix, i = this.createElementNSPlus("wfs:Query", {attributes: {typeName: (t ? t + ":" : "") + e.featureType}});
                if (e.srsNameInQuery && e.srsName && i.setAttribute("srsName", e.srsName), e.featureNS && i.setAttribute("xmlns:" + t, e.featureNS), e.propertyNames)for (var t = 0, n = e.propertyNames.length; n > t; t++)this.writeNode("ogc:PropertyName", {property: e.propertyNames[t]}, i);
                return e.filter && (this.setFilterProperty(e.filter), this.writeNode("ogc:Filter", e.filter, i)), i
            }
        }, OpenLayers.Format.WFST.v1.prototype.writers.wfs),
        gml: OpenLayers.Format.GML.v2.prototype.writers.gml,
        feature: OpenLayers.Format.GML.v2.prototype.writers.feature,
        ogc: OpenLayers.Format.Filter.v1_0_0.prototype.writers.ogc
    },
    CLASS_NAME: "OpenLayers.Format.WFST.v1_0_0"
}),OpenLayers.ElementsIndexer = OpenLayers.Class({
    maxZIndex: null,
    order: null,
    indices: null,
    compare: null,
    initialize: function (e) {
        this.compare = e ? OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER : OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER, this.clear()
    },
    insert: function (e) {
        this.exists(e) && this.remove(e);
        var t = e.id;
        this.determineZIndex(e);
        for (var i, n = -1, s = this.order.length; s - n > 1;)i = parseInt((n + s) / 2), 0 < this.compare(this, e, OpenLayers.Util.getElement(this.order[i])) ? n = i : s = i;
        return this.order.splice(s, 0, t), this.indices[t] = this.getZIndex(e), this.getNextElement(s)
    },
    remove: function (e) {
        var e = e.id, t = OpenLayers.Util.indexOf(this.order, e);
        t >= 0 && (this.order.splice(t, 1), delete this.indices[e], this.maxZIndex = 0 < this.order.length ? this.indices[this.order[this.order.length - 1]] : 0)
    },
    clear: function () {
        this.order = [], this.indices = {}, this.maxZIndex = 0
    },
    exists: function (e) {
        return null != this.indices[e.id]
    },
    getZIndex: function (e) {
        return e._style.graphicZIndex
    },
    determineZIndex: function (e) {
        var t = e._style.graphicZIndex;
        null == t ? (t = this.maxZIndex, e._style.graphicZIndex = t) : t > this.maxZIndex && (this.maxZIndex = t)
    },
    getNextElement: function (e) {
        if (e += 1, e < this.order.length) {
            var t = OpenLayers.Util.getElement(this.order[e]);
            return void 0 == t && (t = this.getNextElement(e)), t
        }
        return null
    },
    CLASS_NAME: "OpenLayers.ElementsIndexer"
}),OpenLayers.ElementsIndexer.IndexingMethods = {
    Z_ORDER: function (e, t, i) {
        var t = e.getZIndex(t), n = 0;
        return i && (e = e.getZIndex(i), n = t - e), n
    }, Z_ORDER_DRAWING_ORDER: function (e, t, i) {
        return e = OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(e, t, i), i && 0 == e && (e = 1), e
    }, Z_ORDER_Y_ORDER: function (e, t, i) {
        return e = OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(e, t, i), i && 0 === e && (t = i._boundsBottom - t._boundsBottom, e = 0 === t ? 1 : t), e
    }
},OpenLayers.Renderer.Elements = OpenLayers.Class(OpenLayers.Renderer, {
    rendererRoot: null,
    root: null,
    vectorRoot: null,
    textRoot: null,
    xmlns: null,
    xOffset: 0,
    indexer: null,
    BACKGROUND_ID_SUFFIX: "_background",
    LABEL_ID_SUFFIX: "_label",
    LABEL_OUTLINE_SUFFIX: "_outline",
    initialize: function (e, t) {
        OpenLayers.Renderer.prototype.initialize.apply(this, arguments), this.rendererRoot = this.createRenderRoot(), this.root = this.createRoot("_root"), this.vectorRoot = this.createRoot("_vroot"), this.textRoot = this.createRoot("_troot"), this.root.appendChild(this.vectorRoot), this.root.appendChild(this.textRoot), this.rendererRoot.appendChild(this.root), this.container.appendChild(this.rendererRoot), t && (t.zIndexing || t.yOrdering) && (this.indexer = new OpenLayers.ElementsIndexer(t.yOrdering))
    },
    destroy: function () {
        this.clear(), this.xmlns = this.root = this.rendererRoot = null, OpenLayers.Renderer.prototype.destroy.apply(this, arguments)
    },
    clear: function () {
        var e, t = this.vectorRoot;
        if (t)for (; e = t.firstChild;)t.removeChild(e);
        if (t = this.textRoot)for (; e = t.firstChild;)t.removeChild(e);
        this.indexer && this.indexer.clear()
    },
    setExtent: function (e, t) {
        var i = OpenLayers.Renderer.prototype.setExtent.apply(this, arguments), n = this.getResolution();
        if (this.map.baseLayer && this.map.baseLayer.wrapDateLine) {
            var s, r = e.getWidth() / this.map.getExtent().getWidth(), e = e.scale(1 / r), r = this.map.getMaxExtent();
            r.right > e.left && r.right < e.right ? s = !0 : r.left > e.left && r.left < e.right && (s = !1), (s !== this.rightOfDateLine || t) && (i = !1, this.xOffset = !0 === s ? r.getWidth() / n : 0), this.rightOfDateLine = s
        }
        return i
    },
    getNodeType: function () {
    },
    drawGeometry: function (e, t, i) {
        var n = e.CLASS_NAME, s = !0;
        if ("OpenLayers.Geometry.Collection" == n || "OpenLayers.Geometry.MultiPoint" == n || "OpenLayers.Geometry.MultiLineString" == n || "OpenLayers.Geometry.MultiPolygon" == n) {
            for (var n = 0, r = e.components.length; r > n; n++)s = this.drawGeometry(e.components[n], t, i) && s;
            return s
        }
        return n = s = !1, "none" != t.display && (t.backgroundGraphic ? this.redrawBackgroundNode(e.id, e, t, i) : n = !0, s = this.redrawNode(e.id, e, t, i)), 0 == s && (t = document.getElementById(e.id)) && (t._style.backgroundGraphic && (n = !0), t.parentNode.removeChild(t)), n && (t = document.getElementById(e.id + this.BACKGROUND_ID_SUFFIX)) && t.parentNode.removeChild(t), s
    },
    redrawNode: function (e, t, i, n) {
        return i = this.applyDefaultSymbolizer(i), e = this.nodeFactory(e, this.getNodeType(t, i)), e._featureId = n, e._boundsBottom = t.getBounds().bottom, e._geometryClass = t.CLASS_NAME, e._style = i, t = this.drawGeometryNode(e, t, i), !1 === t ? !1 : (e = t.node, this.indexer ? (i = this.indexer.insert(e)) ? this.vectorRoot.insertBefore(e, i) : this.vectorRoot.appendChild(e) : e.parentNode !== this.vectorRoot && this.vectorRoot.appendChild(e), this.postDraw(e), t.complete)
    },
    redrawBackgroundNode: function (e, t, i) {
        return i = OpenLayers.Util.extend({}, i), i.externalGraphic = i.backgroundGraphic, i.graphicXOffset = i.backgroundXOffset, i.graphicYOffset = i.backgroundYOffset, i.graphicZIndex = i.backgroundGraphicZIndex, i.graphicWidth = i.backgroundWidth || i.graphicWidth, i.graphicHeight = i.backgroundHeight || i.graphicHeight, i.backgroundGraphic = null, i.backgroundXOffset = null, i.backgroundYOffset = null, i.backgroundGraphicZIndex = null, this.redrawNode(e + this.BACKGROUND_ID_SUFFIX, t, i, null)
    },
    drawGeometryNode: function (e, t, i) {
        var n, i = i || e._style, s = {
            isFilled: void 0 === i.fill ? !0 : i.fill,
            isStroked: void 0 === i.stroke ? !!i.strokeWidth : i.stroke
        };
        switch (t.CLASS_NAME) {
            case"OpenLayers.Geometry.Point":
                !1 === i.graphic && (s.isFilled = !1, s.isStroked = !1), n = this.drawPoint(e, t);
                break;
            case"OpenLayers.Geometry.LineString":
                s.isFilled = !1, n = this.drawLineString(e, t);
                break;
            case"OpenLayers.Geometry.LinearRing":
                n = this.drawLinearRing(e, t);
                break;
            case"OpenLayers.Geometry.Polygon":
                n = this.drawPolygon(e, t);
                break;
            case"OpenLayers.Geometry.Rectangle":
                n = this.drawRectangle(e, t)
        }
        return e._options = s, 0 != n ? {node: this.setStyle(e, i, s, t), complete: n} : !1
    },
    postDraw: function () {
    },
    drawPoint: function () {
    },
    drawLineString: function () {
    },
    drawLinearRing: function () {
    },
    drawPolygon: function () {
    },
    drawRectangle: function () {
    },
    drawCircle: function () {
    },
    removeText: function (e) {
        var t = document.getElementById(e + this.LABEL_ID_SUFFIX);
        t && this.textRoot.removeChild(t), (e = document.getElementById(e + this.LABEL_OUTLINE_SUFFIX)) && this.textRoot.removeChild(e)
    },
    getFeatureIdFromEvent: function (e) {
        var t = e.target, i = t && t.correspondingUseElement;
        return (i ? i : t || e.srcElement)._featureId
    },
    eraseGeometry: function (e, t) {
        if ("OpenLayers.Geometry.MultiPoint" == e.CLASS_NAME || "OpenLayers.Geometry.MultiLineString" == e.CLASS_NAME || "OpenLayers.Geometry.MultiPolygon" == e.CLASS_NAME || "OpenLayers.Geometry.Collection" == e.CLASS_NAME)for (var i = 0, n = e.components.length; n > i; i++)this.eraseGeometry(e.components[i], t); else(i = OpenLayers.Util.getElement(e.id)) && i.parentNode && (i.geometry && (i.geometry.destroy(), i.geometry = null), i.parentNode.removeChild(i), this.indexer && this.indexer.remove(i), i._style.backgroundGraphic && (i = OpenLayers.Util.getElement(e.id + this.BACKGROUND_ID_SUFFIX)) && i.parentNode && i.parentNode.removeChild(i))
    },
    nodeFactory: function (e, t) {
        var i = OpenLayers.Util.getElement(e);
        return i ? this.nodeTypeCompare(i, t) || (i.parentNode.removeChild(i), i = this.nodeFactory(e, t)) : i = this.createNode(t, e), i
    },
    nodeTypeCompare: function () {
    },
    createNode: function () {
    },
    moveRoot: function (e) {
        var t = this.root;
        e.root.parentNode == this.rendererRoot && (t = e.root), t.parentNode.removeChild(t), e.rendererRoot.appendChild(t)
    },
    getRenderLayerId: function () {
        return this.root.parentNode.parentNode.id
    },
    isComplexSymbol: function (e) {
        return "circle" != e && !!e
    },
    CLASS_NAME: "OpenLayers.Renderer.Elements"
}),OpenLayers.Control.ArgParser = OpenLayers.Class(OpenLayers.Control, {
    center: null, zoom: null, layers: null, displayProjection: null, getParameters: function (e) {
        var e = e || window.location.href, t = OpenLayers.Util.getParameters(e), i = e.indexOf("#");
        return i > 0 && (e = "?" + e.substring(i + 1, e.length), OpenLayers.Util.extend(t, OpenLayers.Util.getParameters(e))), t
    }, setMap: function () {
        OpenLayers.Control.prototype.setMap.apply(this, arguments);
        for (var e = 0, t = this.map.controls.length; t > e; e++) {
            var i = this.map.controls[e];
            if (i != this && "OpenLayers.Control.ArgParser" == i.CLASS_NAME) {
                i.displayProjection != this.displayProjection && (this.displayProjection = i.displayProjection);
                break
            }
        }
        e == this.map.controls.length && (e = this.getParameters(), e.layers && (this.layers = e.layers, this.map.events.register("addlayer", this, this.configureLayers), this.configureLayers()), e.lat && e.lon) && (this.center = new OpenLayers.LonLat(parseFloat(e.lon), parseFloat(e.lat)), e.zoom && (this.zoom = parseFloat(e.zoom)), this.map.events.register("changebaselayer", this, this.setCenter), this.setCenter())
    }, setCenter: function () {
        this.map.baseLayer && (this.map.events.unregister("changebaselayer", this, this.setCenter), this.displayProjection && this.center.transform(this.displayProjection, this.map.getProjectionObject()), this.map.setCenter(this.center, this.zoom))
    }, configureLayers: function () {
        if (this.layers.length == this.map.layers.length) {
            this.map.events.unregister("addlayer", this, this.configureLayers);
            for (var e = 0, t = this.layers.length; t > e; e++) {
                var i = this.map.layers[e], n = this.layers.charAt(e);
                "B" == n ? this.map.setBaseLayer(i) : ("T" == n || "F" == n) && i.setVisibility("T" == n)
            }
        }
    }, CLASS_NAME: "OpenLayers.Control.ArgParser"
}),OpenLayers.Control.Permalink = OpenLayers.Class(OpenLayers.Control, {
    argParserClass: OpenLayers.Control.ArgParser,
    element: null,
    anchor: !1,
    base: "",
    displayProjection: null,
    initialize: function (e, t, i) {
        null === e || "object" != typeof e || OpenLayers.Util.isElement(e) ? (OpenLayers.Control.prototype.initialize.apply(this, [i]), this.element = OpenLayers.Util.getElement(e), this.base = t || document.location.href) : (this.base = document.location.href, OpenLayers.Control.prototype.initialize.apply(this, [e]), null != this.element && (this.element = OpenLayers.Util.getElement(this.element)))
    },
    destroy: function () {
        this.element && this.element.parentNode == this.div && (this.div.removeChild(this.element), this.element = null), this.map && this.map.events.unregister("moveend", this, this.updateLink), OpenLayers.Control.prototype.destroy.apply(this, arguments)
    },
    setMap: function () {
        OpenLayers.Control.prototype.setMap.apply(this, arguments);
        for (var e = 0, t = this.map.controls.length; t > e; e++) {
            var i = this.map.controls[e];
            if (i.CLASS_NAME == this.argParserClass.CLASS_NAME) {
                i.displayProjection != this.displayProjection && (this.displayProjection = i.displayProjection);
                break
            }
        }
        e == this.map.controls.length && this.map.addControl(new this.argParserClass({displayProjection: this.displayProjection}))
    },
    draw: function () {
        return OpenLayers.Control.prototype.draw.apply(this, arguments), !this.element && !this.anchor && (this.element = document.createElement("a"), this.element.innerHTML = OpenLayers.i18n("Permalink"), this.element.href = "", this.div.appendChild(this.element)), this.map.events.on({
            moveend: this.updateLink,
            changelayer: this.updateLink,
            changebaselayer: this.updateLink,
            scope: this
        }), this.updateLink(), this.div
    },
    updateLink: function () {
        var e = this.anchor ? "#" : "?", t = this.base;
        -1 != t.indexOf(e) && (t = t.substring(0, t.indexOf(e))), t += e + OpenLayers.Util.getParameterString(this.createParams()), this.anchor && !this.element ? window.location.href = t : this.element.href = t
    },
    createParams: function (e, t, i) {
        var e = e || this.map.getCenter(), n = OpenLayers.Util.getParameters(this.base);
        if (e)for (n.zoom = t || this.map.getZoom(), t = e.lat, e = e.lon, this.displayProjection && (t = OpenLayers.Projection.transform({
            x: e,
            y: t
        }, this.map.getProjectionObject(), this.displayProjection), e = t.x, t = t.y), n.lat = Math.round(1e5 * t) / 1e5, n.lon = Math.round(1e5 * e) / 1e5, i = i || this.map.layers, n.layers = "", e = 0, t = i.length; t > e; e++) {
            var s = i[e];
            n.layers = s.isBaseLayer ? n.layers + (s == this.map.baseLayer ? "B" : "0") : n.layers + (s.getVisibility() ? "T" : "F")
        }
        return n
    },
    CLASS_NAME: "OpenLayers.Control.Permalink"
}),OpenLayers.Layer.TMS = OpenLayers.Class(OpenLayers.Layer.Grid, {
    serviceVersion: "1.0.0",
    layername: null,
    type: null,
    isBaseLayer: !0,
    tileOrigin: null,
    serverResolutions: null,
    zoomOffset: 0,
    initialize: function (e, t, i) {
        var n = [];
        n.push(e, t, {}, i), OpenLayers.Layer.Grid.prototype.initialize.apply(this, n)
    },
    clone: function (e) {
        return null == e && (e = new OpenLayers.Layer.TMS(this.name, this.url, this.getOptions())), e = OpenLayers.Layer.Grid.prototype.clone.apply(this, [e])
    },
    getURL: function (e) {
        var e = this.adjustBounds(e), t = this.getServerResolution(), i = Math.round((e.left - this.tileOrigin.lon) / (t * this.tileSize.w)), e = Math.round((e.bottom - this.tileOrigin.lat) / (t * this.tileSize.h)), i = this.serviceVersion + "/" + this.layername + "/" + this.getServerZoom() + "/" + i + "/" + e + "." + this.type, e = this.url;
        return OpenLayers.Util.isArray(e) && (e = this.selectUrl(i, e)), e + i
    },
    setMap: function () {
        OpenLayers.Layer.Grid.prototype.setMap.apply(this, arguments), this.tileOrigin || (this.tileOrigin = new OpenLayers.LonLat(this.map.maxExtent.left, this.map.maxExtent.bottom))
    },
    CLASS_NAME: "OpenLayers.Layer.TMS"
}),OpenLayers.Strategy.Fixed = OpenLayers.Class(OpenLayers.Strategy, {
    preload: !1, activate: function () {
        return OpenLayers.Strategy.prototype.activate.apply(this, arguments) ? (this.layer.events.on({
            refresh: this.load,
            scope: this
        }), 1 == this.layer.visibility || this.preload ? this.load() : this.layer.events.on({
            visibilitychanged: this.load,
            scope: this
        }), !0) : !1
    }, deactivate: function () {
        var e = OpenLayers.Strategy.prototype.deactivate.call(this);
        return e && this.layer.events.un({refresh: this.load, visibilitychanged: this.load, scope: this}), e
    }, load: function (e) {
        var t = this.layer;
        t.events.triggerEvent("loadstart"), t.protocol.read(OpenLayers.Util.applyDefaults({
            callback: OpenLayers.Function.bind(this.merge, this, t.map.getProjectionObject()),
            filter: t.filter
        }, e)), t.events.un({visibilitychanged: this.load, scope: this})
    }, merge: function (e, t) {
        var i = this.layer;
        i.destroyFeatures();
        var n = t.features;
        if (n && 0 < n.length) {
            if (!e.equals(i.projection))for (var s, r = 0, a = n.length; a > r; ++r)(s = n[r].geometry) && s.transform(i.projection, e);
            i.addFeatures(n)
        }
        i.events.triggerEvent("loadend")
    }, CLASS_NAME: "OpenLayers.Strategy.Fixed"
}),OpenLayers.Control.Zoom = OpenLayers.Class(OpenLayers.Control, {
    zoomInText: "+",
    zoomInId: "olZoomInLink",
    zoomOutText: "-",
    zoomOutId: "olZoomOutLink",
    draw: function () {
        var e = OpenLayers.Control.prototype.draw.apply(this), t = this.getOrCreateLinks(e), i = t.zoomIn, t = t.zoomOut, n = this.map.events;
        return t.parentNode !== e && (n = this.events, n.attachToElement(t.parentNode)), n.register("buttonclick", this, this.onZoomClick), this.zoomInLink = i, this.zoomOutLink = t, e
    },
    getOrCreateLinks: function (e) {
        var t = document.getElementById(this.zoomInId), i = document.getElementById(this.zoomOutId);
        return t || (t = document.createElement("a"), t.href = "#zoomIn", t.appendChild(document.createTextNode(this.zoomInText)), t.className = "olControlZoomIn", e.appendChild(t)), OpenLayers.Element.addClass(t, "olButton"), i || (i = document.createElement("a"), i.href = "#zoomOut", i.appendChild(document.createTextNode(this.zoomOutText)), i.className = "olControlZoomOut", e.appendChild(i)), OpenLayers.Element.addClass(i, "olButton"), {
            zoomIn: t,
            zoomOut: i
        }
    },
    onZoomClick: function (e) {
        e = e.buttonElement, e === this.zoomInLink ? this.map.zoomIn() : e === this.zoomOutLink && this.map.zoomOut()
    },
    destroy: function () {
        this.map && this.map.events.unregister("buttonclick", this, this.onZoomClick), delete this.zoomInLink, delete this.zoomOutLink, OpenLayers.Control.prototype.destroy.apply(this)
    },
    CLASS_NAME: "OpenLayers.Control.Zoom"
}),OpenLayers.Layer.PointTrack = OpenLayers.Class(OpenLayers.Layer.Vector, {
    dataFrom: null,
    styleFrom: null,
    addNodes: function (e, t) {
        if (2 > e.length)throw Error("At least two point features have to be added to create a line from");
        for (var i, n, s, r = Array(e.length - 1), a = 0, o = e.length; o > a; a++) {
            if (i = e[a], s = i.geometry) {
                if ("OpenLayers.Geometry.Point" != s.CLASS_NAME)throw new TypeError("Only features with point geometries are supported.")
            } else s = i.lonlat, s = new OpenLayers.Geometry.Point(s.lon, s.lat);
            if (a > 0) {
                i = null != this.dataFrom ? e[a + this.dataFrom].data || e[a + this.dataFrom].attributes : null;
                var l = null != this.styleFrom ? e[a + this.styleFrom].style : null;
                n = new OpenLayers.Geometry.LineString([n, s]), r[a - 1] = new OpenLayers.Feature.Vector(n, i, l)
            }
            n = s
        }
        this.addFeatures(r, t)
    },
    CLASS_NAME: "OpenLayers.Layer.PointTrack"
}),OpenLayers.Layer.PointTrack.SOURCE_NODE = -1,OpenLayers.Layer.PointTrack.TARGET_NODE = 0,OpenLayers.Layer.PointTrack.dataFrom = {
    SOURCE_NODE: -1,
    TARGET_NODE: 0
},OpenLayers.Protocol.WFS = function (e) {
    var e = OpenLayers.Util.applyDefaults(e, OpenLayers.Protocol.WFS.DEFAULTS), t = OpenLayers.Protocol.WFS["v" + e.version.replace(/\./g, "_")];
    if (!t)throw"Unsupported WFS version: " + e.version;
    return new t(e)
},OpenLayers.Protocol.WFS.fromWMSLayer = function (e, t) {
    var i, n;
    return i = e.params.LAYERS, i = (OpenLayers.Util.isArray(i) ? i[0] : i).split(":"), 1 < i.length && (n = i[0]), i = i.pop(), n = {
        url: e.url,
        featureType: i,
        featurePrefix: n,
        srsName: e.projection && e.projection.getCode() || e.map && e.map.getProjectionObject().getCode(),
        version: "1.1.0"
    }, new OpenLayers.Protocol.WFS(OpenLayers.Util.applyDefaults(t, n))
},OpenLayers.Protocol.WFS.DEFAULTS = {version: "1.0.0"},OpenLayers.Layer.Markers = OpenLayers.Class(OpenLayers.Layer, {
    isBaseLayer: !1,
    markers: null,
    drawn: !1,
    initialize: function () {
        OpenLayers.Layer.prototype.initialize.apply(this, arguments), this.markers = []
    },
    destroy: function () {
        this.clearMarkers(), this.markers = null, OpenLayers.Layer.prototype.destroy.apply(this, arguments)
    },
    setOpacity: function (e) {
        if (e != this.opacity) {
            this.opacity = e;
            for (var e = 0, t = this.markers.length; t > e; e++)this.markers[e].setOpacity(this.opacity)
        }
    },
    moveTo: function (e, t) {
        if (OpenLayers.Layer.prototype.moveTo.apply(this, arguments), t || !this.drawn) {
            for (var i = 0, n = this.markers.length; n > i; i++)this.drawMarker(this.markers[i]);
            this.drawn = !0
        }
    },
    addMarker: function (e) {
        this.markers.push(e), 1 > this.opacity && e.setOpacity(this.opacity), this.map && this.map.getExtent() && (e.map = this.map, this.drawMarker(e))
    },
    removeMarker: function (e) {
        this.markers && this.markers.length && (OpenLayers.Util.removeItem(this.markers, e), e.erase())
    },
    clearMarkers: function () {
        if (null != this.markers)for (; 0 < this.markers.length;)this.removeMarker(this.markers[0])
    },
    drawMarker: function (e) {
        var t = this.map.getLayerPxFromLonLat(e.lonlat);
        null == t ? e.display(!1) : e.isDrawn() ? e.icon && e.icon.moveTo(t) : this.div.appendChild(e.draw(t))
    },
    getDataExtent: function () {
        var e = null;
        if (this.markers && 0 < this.markers.length)for (var e = new OpenLayers.Bounds, t = 0, i = this.markers.length; i > t; t++)e.extend(this.markers[t].lonlat);
        return e
    },
    CLASS_NAME: "OpenLayers.Layer.Markers"
}),OpenLayers.Control.Pan = OpenLayers.Class(OpenLayers.Control, {
    slideFactor: 50,
    slideRatio: null,
    direction: null,
    type: OpenLayers.Control.TYPE_BUTTON,
    initialize: function (e, t) {
        this.direction = e, this.CLASS_NAME += this.direction, OpenLayers.Control.prototype.initialize.apply(this, [t])
    },
    trigger: function () {
        var e = OpenLayers.Function.bind(function (e) {
            return this.slideRatio ? this.map.getSize()[e] * this.slideRatio : this.slideFactor
        }, this);
        switch (this.direction) {
            case OpenLayers.Control.Pan.NORTH:
                this.map.pan(0, -e("h"));
                break;
            case OpenLayers.Control.Pan.SOUTH:
                this.map.pan(0, e("h"));
                break;
            case OpenLayers.Control.Pan.WEST:
                this.map.pan(-e("w"), 0);
                break;
            case OpenLayers.Control.Pan.EAST:
                this.map.pan(e("w"), 0)
        }
    },
    CLASS_NAME: "OpenLayers.Control.Pan"
}),OpenLayers.Control.Pan.NORTH = "North",OpenLayers.Control.Pan.SOUTH = "South",OpenLayers.Control.Pan.EAST = "East",OpenLayers.Control.Pan.WEST = "West",OpenLayers.Format.CSWGetDomain = function (e) {
    var e = OpenLayers.Util.applyDefaults(e, OpenLayers.Format.CSWGetDomain.DEFAULTS), t = OpenLayers.Format.CSWGetDomain["v" + e.version.replace(/\./g, "_")];
    if (!t)throw"Unsupported CSWGetDomain version: " + e.version;
    return new t(e)
},OpenLayers.Format.CSWGetDomain.DEFAULTS = {version: "2.0.2"},OpenLayers.Format.CSWGetDomain.v2_0_2 = OpenLayers.Class(OpenLayers.Format.XML, {
    namespaces: {
        xlink: "http://www.w3.org/1999/xlink",
        xsi: "http://www.w3.org/2001/XMLSchema-instance",
        csw: "http://www.opengis.net/cat/csw/2.0.2"
    },
    defaultPrefix: "csw",
    version: "2.0.2",
    schemaLocation: "http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",
    PropertyName: null,
    ParameterName: null,
    read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e])), e && 9 == e.nodeType && (e = e.documentElement);
        var t = {};
        return this.readNode(e, t), t
    },
    readers: {
        csw: {
            GetDomainResponse: function (e, t) {
                this.readChildNodes(e, t)
            }, DomainValues: function (e, t) {
                OpenLayers.Util.isArray(t.DomainValues) || (t.DomainValues = []);
                for (var i = e.attributes, n = {}, s = 0, r = i.length; r > s; ++s)n[i[s].name] = i[s].nodeValue;
                this.readChildNodes(e, n), t.DomainValues.push(n)
            }, PropertyName: function (e, t) {
                t.PropertyName = this.getChildValue(e)
            }, ParameterName: function (e, t) {
                t.ParameterName = this.getChildValue(e)
            }, ListOfValues: function (e, t) {
                OpenLayers.Util.isArray(t.ListOfValues) || (t.ListOfValues = []), this.readChildNodes(e, t.ListOfValues)
            }, Value: function (e, t) {
                for (var i = e.attributes, n = {}, s = 0, r = i.length; r > s; ++s)n[i[s].name] = i[s].nodeValue;
                n.value = this.getChildValue(e), t.push({Value: n})
            }, ConceptualScheme: function (e, t) {
                t.ConceptualScheme = {}, this.readChildNodes(e, t.ConceptualScheme)
            }, Name: function (e, t) {
                t.Name = this.getChildValue(e)
            }, Document: function (e, t) {
                t.Document = this.getChildValue(e)
            }, Authority: function (e, t) {
                t.Authority = this.getChildValue(e)
            }, RangeOfValues: function (e, t) {
                t.RangeOfValues = {}, this.readChildNodes(e, t.RangeOfValues)
            }, MinValue: function (e, t) {
                for (var i = e.attributes, n = {}, s = 0, r = i.length; r > s; ++s)n[i[s].name] = i[s].nodeValue;
                n.value = this.getChildValue(e), t.MinValue = n
            }, MaxValue: function (e, t) {
                for (var i = e.attributes, n = {}, s = 0, r = i.length; r > s; ++s)n[i[s].name] = i[s].nodeValue;
                n.value = this.getChildValue(e), t.MaxValue = n
            }
        }
    },
    write: function (e) {
        return e = this.writeNode("csw:GetDomain", e), OpenLayers.Format.XML.prototype.write.apply(this, [e])
    },
    writers: {
        csw: {
            GetDomain: function (e) {
                var t = this.createElementNSPlus("csw:GetDomain", {
                    attributes: {
                        service: "CSW",
                        version: this.version
                    }
                });
                return e.PropertyName || this.PropertyName ? this.writeNode("csw:PropertyName", e.PropertyName || this.PropertyName, t) : (e.ParameterName || this.ParameterName) && this.writeNode("csw:ParameterName", e.ParameterName || this.ParameterName, t), this.readChildNodes(t, e), t
            }, PropertyName: function (e) {
                return this.createElementNSPlus("csw:PropertyName", {value: e})
            }, ParameterName: function (e) {
                return this.createElementNSPlus("csw:ParameterName", {value: e})
            }
        }
    },
    CLASS_NAME: "OpenLayers.Format.CSWGetDomain.v2_0_2"
}),OpenLayers.Format.ArcXML.Features = OpenLayers.Class(OpenLayers.Format.XML, {
    read: function (e) {
        return (new OpenLayers.Format.ArcXML).read(e).features.feature
    }
}),OpenLayers.Control.Snapping = OpenLayers.Class(OpenLayers.Control, {
    DEFAULTS: {
        tolerance: 10,
        node: !0,
        edge: !0,
        vertex: !0
    },
    greedy: !0,
    precedence: ["node", "vertex", "edge"],
    resolution: null,
    geoToleranceCache: null,
    layer: null,
    feature: null,
    point: null,
    initialize: function (e) {
        OpenLayers.Control.prototype.initialize.apply(this, [e]), this.options = e || {}, this.options.layer && this.setLayer(this.options.layer), e = OpenLayers.Util.extend({}, this.options.defaults), this.defaults = OpenLayers.Util.applyDefaults(e, this.DEFAULTS), this.setTargets(this.options.targets), 0 === this.targets.length && this.layer && this.addTargetLayer(this.layer), this.geoToleranceCache = {}
    },
    setLayer: function (e) {
        this.active ? (this.deactivate(), this.layer = e, this.activate()) : this.layer = e
    },
    setTargets: function (e) {
        if (this.targets = [], e && e.length)for (var t, i = 0, n = e.length; n > i; ++i)t = e[i], t instanceof OpenLayers.Layer.Vector ? this.addTargetLayer(t) : this.addTarget(t)
    },
    addTargetLayer: function (e) {
        this.addTarget({layer: e})
    },
    addTarget: function (e) {
        e = OpenLayers.Util.applyDefaults(e, this.defaults), e.nodeTolerance = e.nodeTolerance || e.tolerance, e.vertexTolerance = e.vertexTolerance || e.tolerance, e.edgeTolerance = e.edgeTolerance || e.tolerance, this.targets.push(e)
    },
    removeTargetLayer: function (e) {
        for (var t, i = this.targets.length - 1; i >= 0; --i)t = this.targets[i], t.layer === e && this.removeTarget(t)
    },
    removeTarget: function (e) {
        return OpenLayers.Util.removeItem(this.targets, e)
    },
    activate: function () {
        var e = OpenLayers.Control.prototype.activate.call(this);
        return e && this.layer && this.layer.events && this.layer.events.on({
            sketchstarted: this.onSketchModified,
            sketchmodified: this.onSketchModified,
            vertexmodified: this.onVertexModified,
            scope: this
        }), e
    },
    deactivate: function () {
        var e = OpenLayers.Control.prototype.deactivate.call(this);
        return e && this.layer && this.layer.events && this.layer.events.un({
            sketchstarted: this.onSketchModified,
            sketchmodified: this.onSketchModified,
            vertexmodified: this.onVertexModified,
            scope: this
        }), this.point = this.feature = null, e
    },
    onSketchModified: function (e) {
        this.feature = e.feature, this.considerSnapping(e.vertex, e.vertex)
    },
    onVertexModified: function (e) {
        this.feature = e.feature;
        var t = this.layer.map.getLonLatFromViewPortPx(e.pixel);
        this.considerSnapping(e.vertex, new OpenLayers.Geometry.Point(t.lon, t.lat))
    },
    considerSnapping: function (e, t) {
        for (var i, n, s = {
            rank: Number.POSITIVE_INFINITY,
            dist: Number.POSITIVE_INFINITY,
            x: null,
            y: null
        }, r = !1, a = 0, o = this.targets.length; o > a; ++a)if (n = this.targets[a], i = this.testTarget(n, t)) {
            if (this.greedy) {
                s = i, s.target = n, r = !0;
                break
            }
            (i.rank < s.rank || i.rank === s.rank && i.dist < s.dist) && (s = i, s.target = n, r = !0)
        }
        r && (!1 !== this.events.triggerEvent("beforesnap", {
            point: e,
            x: s.x,
            y: s.y,
            distance: s.dist,
            layer: s.target.layer,
            snapType: this.precedence[s.rank]
        }) ? (e.x = s.x, e.y = s.y, this.point = e, this.events.triggerEvent("snap", {
            point: e,
            snapType: this.precedence[s.rank],
            layer: s.target.layer,
            distance: s.dist
        })) : r = !1), this.point && !r && (e.x = t.x, e.y = t.y, this.point = null, this.events.triggerEvent("unsnap", {point: e}))
    },
    testTarget: function (e, t) {
        var i = this.layer.map.getResolution();
        if ("minResolution" in e && i < e.minResolution || "maxResolution" in e && i >= e.maxResolution)return null;
        for (var n, s, r, a, o, l, i = {
            node: this.getGeoTolerance(e.nodeTolerance, i),
            vertex: this.getGeoTolerance(e.vertexTolerance, i),
            edge: this.getGeoTolerance(e.edgeTolerance, i)
        }, h = Math.max(i.node, i.vertex, i.edge), u = {
            rank: Number.POSITIVE_INFINITY,
            dist: Number.POSITIVE_INFINITY
        }, c = !1, p = e.layer.features, d = this.precedence.length, f = new OpenLayers.LonLat(t.x, t.y), m = 0, g = p.length; g > m; ++m)if (n = p[m], n !== this.feature && !n._sketch && n.state !== OpenLayers.State.DELETE && (!e.filter || e.filter.evaluate(n)) && n.atPoint(f, h, h))for (var y = 0, v = Math.min(u.rank + 1, d); v > y; ++y)if (s = this.precedence[y], e[s])if ("edge" === s) {
            if (r = n.geometry.distanceTo(t, {details: !0}), o = r.distance, o <= i[s] && o < u.dist) {
                u = {rank: y, dist: o, x: r.x0, y: r.y0}, c = !0;
                break
            }
        } else {
            r = n.geometry.getVertices("node" === s), l = !1;
            for (var b = 0, L = r.length; L > b; ++b)a = r[b], o = a.distanceTo(t), o <= i[s] && (y < u.rank || y === u.rank && o < u.dist) && (u = {
                rank: y,
                dist: o,
                x: a.x,
                y: a.y
            }, l = c = !0);
            if (l)break
        }
        return c ? u : null
    },
    getGeoTolerance: function (e, t) {
        t !== this.resolution && (this.resolution = t, this.geoToleranceCache = {});
        var i = this.geoToleranceCache[e];
        return void 0 === i && (i = e * t, this.geoToleranceCache[e] = i), i
    },
    destroy: function () {
        this.active && this.deactivate(), delete this.layer, delete this.targets, OpenLayers.Control.prototype.destroy.call(this)
    },
    CLASS_NAME: "OpenLayers.Control.Snapping"
}),OpenLayers.Date = {
    toISOString: function () {
        if ("toISOString" in Date.prototype)return function (e) {
            return e.toISOString()
        };
        var e = function (e, t) {
            for (var i = e + ""; i.length < t;)i = "0" + i;
            return i
        };
        return function (t) {
            return isNaN(t.getTime()) ? "Invalid Date" : t.getUTCFullYear() + "-" + e(t.getUTCMonth() + 1, 2) + "-" + e(t.getUTCDate(), 2) + "T" + e(t.getUTCHours(), 2) + ":" + e(t.getUTCMinutes(), 2) + ":" + e(t.getUTCSeconds(), 2) + "." + e(t.getUTCMilliseconds(), 3) + "Z"
        }
    }(), parse: function (e) {
        var t;
        if ((e = e.match(/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:(?:T(\d{1,2}):(\d{2}):(\d{2}(?:\.\d+)?)(Z|(?:[+-]\d{1,2}(?::(\d{2}))?)))|Z)?$/)) && (e[1] || e[7])) {
            t = parseInt(e[1], 10) || 0;
            var i = parseInt(e[2], 10) - 1 || 0, n = parseInt(e[3], 10) || 1;
            if (t = new Date(Date.UTC(t, i, n)), i = e[7]) {
                var n = parseInt(e[4], 10), s = parseInt(e[5], 10), r = parseFloat(e[6]), a = 0 | r, r = Math.round(1e3 * (r - a));
                t.setUTCHours(n, s, a, r), "Z" !== i && (i = parseInt(i, 10), e = parseInt(e[8], 10) || 0, t = new Date(t.getTime() + -1e3 * (3600 * i + 60 * e)))
            }
        } else t = new Date("invalid");
        return t
    }
},function () {
    function e() {
        this._object = r && !l ? new r : new window.ActiveXObject("Microsoft.XMLHTTP"), this._listeners = []
    }

    function t() {
        return new e
    }

    function i(e) {
        t.onreadystatechange && t.onreadystatechange.apply(e), e.dispatchEvent({
            type: "readystatechange",
            bubbles: !1,
            cancelable: !1,
            timeStamp: new Date + 0
        })
    }

    function n(e) {
        try {
            e.responseText = e._object.responseText
        } catch (t) {
        }
        try {
            var i, n = e._object, s = n.responseXML, r = n.responseText;
            o && r && s && !s.documentElement && n.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/) && (s = new window.ActiveXObject("Microsoft.XMLDOM"), s.async = !1, s.validateOnParse = !1, s.loadXML(r)), i = s && (o && 0 != s.parseError || !s.documentElement || s.documentElement && "parsererror" == s.documentElement.tagName) ? null : s, e.responseXML = i
        } catch (a) {
        }
        try {
            e.status = e._object.status
        } catch (l) {
        }
        try {
            e.statusText = e._object.statusText
        } catch (h) {
        }
    }

    function s(e) {
        e._object.onreadystatechange = new window.Function
    }

    var r = window.XMLHttpRequest, a = !!window.controllers, o = window.document.all && !window.opera, l = o && window.navigator.userAgent.match(/MSIE 7.0/);
    t.prototype = e.prototype, a && r.wrapped && (t.wrapped = r.wrapped), t.UNSENT = 0, t.OPENED = 1, t.HEADERS_RECEIVED = 2, t.LOADING = 3, t.DONE = 4, t.prototype.readyState = t.UNSENT, t.prototype.responseText = "", t.prototype.responseXML = null, t.prototype.status = 0, t.prototype.statusText = "", t.prototype.priority = "NORMAL", t.prototype.onreadystatechange = null, t.onreadystatechange = null, t.onopen = null, t.onsend = null, t.onabort = null, t.prototype.open = function (e, r, l, h, u) {
        delete this._headers, arguments.length < 3 && (l = !0), this._async = l;
        var c, p = this, d = this.readyState;
        o && l && (c = function () {
            d != t.DONE && (s(p), p.abort())
        }, window.attachEvent("onunload", c)), t.onopen && t.onopen.apply(this, arguments), arguments.length > 4 ? this._object.open(e, r, l, h, u) : arguments.length > 3 ? this._object.open(e, r, l, h) : this._object.open(e, r, l), this.readyState = t.OPENED, i(this), this._object.onreadystatechange = function () {
            (!a || l) && (p.readyState = p._object.readyState, n(p), p._aborted ? p.readyState = t.UNSENT : (p.readyState == t.DONE && (delete p._data, s(p), o && l && window.detachEvent("onunload", c)), d != p.readyState && i(p), d = p.readyState))
        }
    }, t.prototype.send = function (e) {
        t.onsend && t.onsend.apply(this, arguments), arguments.length || (e = null), e && e.nodeType && (e = window.XMLSerializer ? (new window.XMLSerializer).serializeToString(e) : e.xml, this._headers["Content-Type"] || this._object.setRequestHeader("Content-Type", "application/xml")), this._data = e;
        e:if (this._object.send(this._data), a && !this._async)for (this.readyState = t.OPENED, n(this); this.readyState < t.DONE;)if (this.readyState++, i(this), this._aborted)break e
    }, t.prototype.abort = function () {
        t.onabort && t.onabort.apply(this, arguments), this.readyState > t.UNSENT && (this._aborted = !0), this._object.abort(), s(this), this.readyState = t.UNSENT, delete this._data
    }, t.prototype.getAllResponseHeaders = function () {
        return this._object.getAllResponseHeaders()
    }, t.prototype.getResponseHeader = function (e) {
        return this._object.getResponseHeader(e)
    }, t.prototype.setRequestHeader = function (e, t) {
        return this._headers || (this._headers = {}), this._headers[e] = t, this._object.setRequestHeader(e, t)
    }, t.prototype.addEventListener = function (e, t, i) {
        for (var n, s = 0; n = this._listeners[s]; s++)if (n[0] == e && n[1] == t && n[2] == i)return;
        this._listeners.push([e, t, i])
    }, t.prototype.removeEventListener = function (e, t, i) {
        for (var n, s = 0; (n = this._listeners[s]) && (n[0] != e || n[1] != t || n[2] != i); s++);
        n && this._listeners.splice(s, 1)
    }, t.prototype.dispatchEvent = function (e) {
        e = {
            type: e.type,
            target: this,
            currentTarget: this,
            eventPhase: 2,
            bubbles: e.bubbles,
            cancelable: e.cancelable,
            timeStamp: e.timeStamp,
            stopPropagation: function () {
            },
            preventDefault: function () {
            },
            initEvent: function () {
            }
        }, "readystatechange" == e.type && this.onreadystatechange && (this.onreadystatechange.handleEvent || this.onreadystatechange).apply(this, [e]);
        for (var t, i = 0; t = this._listeners[i]; i++)t[0] == e.type && !t[2] && (t[1].handleEvent || t[1]).apply(this, [e])
    }, t.prototype.toString = function () {
        return "[object XMLHttpRequest]"
    }, t.toString = function () {
        return "[XMLHttpRequest]"
    }, window.Function.prototype.apply || (window.Function.prototype.apply = function (e, t) {
        t || (t = []), e.__func = this, e.__func(t[0], t[1], t[2], t[3], t[4]), delete e.__func
    }), OpenLayers.Request.XMLHttpRequest = t
}(),OpenLayers.Format.KML = OpenLayers.Class(OpenLayers.Format.XML, {
    namespaces: {kml: "http://www.opengis.net/kml/2.2", gx: "http://www.google.com/kml/ext/2.2"},
    kmlns: "http://earth.google.com/kml/2.0",
    placemarksDesc: "No description available",
    foldersName: "OpenLayers export",
    foldersDesc: "Exported on " + new Date,
    extractAttributes: !0,
    kvpAttributes: !1,
    extractStyles: !1,
    extractTracks: !1,
    trackAttributes: null,
    internalns: null,
    features: null,
    styles: null,
    styleBaseUrl: "",
    fetched: null,
    maxDepth: 0,
    initialize: function (e) {
        this.regExes = {
            trimSpace: /^\s*|\s*$/g,
            removeSpace: /\s*/g,
            splitSpace: /\s+/,
            trimComma: /\s*,\s*/g,
            kmlColor: /(\w{2})(\w{2})(\w{2})(\w{2})/,
            kmlIconPalette: /root:\/\/icons\/palette-(\d+)(\.\w+)/,
            straightBracket: /\$\[(.*?)\]/g
        }, this.externalProjection = new OpenLayers.Projection("EPSG:4326"), OpenLayers.Format.XML.prototype.initialize.apply(this, [e])
    },
    read: function (e) {
        return this.features = [], this.styles = {}, this.fetched = {}, this.parseData(e, {
            depth: 0,
            styleBaseUrl: this.styleBaseUrl
        })
    },
    parseData: function (e, t) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e]));
        for (var i = ["Link", "NetworkLink", "Style", "StyleMap", "Placemark"], n = 0, s = i.length; s > n; ++n) {
            var r = i[n], a = this.getElementsByTagNameNS(e, "*", r);
            if (0 != a.length)switch (r.toLowerCase()) {
                case"link":
                case"networklink":
                    this.parseLinks(a, t);
                    break;
                case"style":
                    this.extractStyles && this.parseStyles(a, t);
                    break;
                case"stylemap":
                    this.extractStyles && this.parseStyleMaps(a, t);
                    break;
                case"placemark":
                    this.parseFeatures(a, t)
            }
        }
        return this.features
    },
    parseLinks: function (e, t) {
        if (t.depth >= this.maxDepth)return !1;
        var i = OpenLayers.Util.extend({}, t);
        i.depth++;
        for (var n = 0, s = e.length; s > n; n++) {
            var r = this.parseProperty(e[n], "*", "href");
            r && !this.fetched[r] && (this.fetched[r] = !0, (r = this.fetchLink(r)) && this.parseData(r, i))
        }
    },
    fetchLink: function (e) {
        return (e = OpenLayers.Request.GET({url: e, async: !1})) ? e.responseText : void 0
    },
    parseStyles: function (e, t) {
        for (var i = 0, n = e.length; n > i; i++) {
            var s = this.parseStyle(e[i]);
            s && (this.styles[(t.styleBaseUrl || "") + "#" + s.id] = s)
        }
    },
    parseKmlColor: function (e) {
        var t = null;
        return e && (e = e.match(this.regExes.kmlColor)) && (t = {
            color: "#" + e[4] + e[3] + e[2],
            opacity: parseInt(e[1], 16) / 255
        }), t
    },
    parseStyle: function (e) {
        for (var t, i, n = {}, s = ["LineStyle", "PolyStyle", "IconStyle", "BalloonStyle", "LabelStyle"], r = 0, a = s.length; a > r; ++r)if (t = s[r], i = this.getElementsByTagNameNS(e, "*", t)[0])switch (t.toLowerCase()) {
            case"linestyle":
                t = this.parseProperty(i, "*", "color"), (t = this.parseKmlColor(t)) && (n.strokeColor = t.color, n.strokeOpacity = t.opacity), (t = this.parseProperty(i, "*", "width")) && (n.strokeWidth = t);
                break;
            case"polystyle":
                t = this.parseProperty(i, "*", "color"), (t = this.parseKmlColor(t)) && (n.fillOpacity = t.opacity, n.fillColor = t.color), "0" == this.parseProperty(i, "*", "fill") && (n.fillColor = "none"), "0" == this.parseProperty(i, "*", "outline") && (n.strokeWidth = "0");
                break;
            case"iconstyle":
                var o = parseFloat(this.parseProperty(i, "*", "scale") || 1);
                t = 32 * o;
                var l = 32 * o, h = this.getElementsByTagNameNS(i, "*", "Icon")[0];
                if (h) {
                    var u = this.parseProperty(h, "*", "href");
                    if (u) {
                        var c = this.parseProperty(h, "*", "w"), p = this.parseProperty(h, "*", "h");
                        OpenLayers.String.startsWith(u, "http://maps.google.com/mapfiles/kml") && !c && !p && (p = c = 64, o /= 2), c = c || p, p = p || c, c && (t = parseInt(c) * o), p && (l = parseInt(p) * o), (p = u.match(this.regExes.kmlIconPalette)) && (c = p[1], p = p[2], u = this.parseProperty(h, "*", "x"), h = this.parseProperty(h, "*", "y"), u = "http://maps.google.com/mapfiles/kml/pal" + c + "/icon" + (8 * (h ? 7 - h / 32 : 7) + (u ? u / 32 : 0)) + p), n.graphicOpacity = 1, n.externalGraphic = u
                    }
                }
                (i = this.getElementsByTagNameNS(i, "*", "hotSpot")[0]) && (u = parseFloat(i.getAttribute("x")), h = parseFloat(i.getAttribute("y")), c = i.getAttribute("xunits"), "pixels" == c ? n.graphicXOffset = -u * o : "insetPixels" == c ? n.graphicXOffset = -t + u * o : "fraction" == c && (n.graphicXOffset = -t * u), i = i.getAttribute("yunits"), "pixels" == i ? n.graphicYOffset = -l + h * o + 1 : "insetPixels" == i ? n.graphicYOffset = -(h * o) + 1 : "fraction" == i && (n.graphicYOffset = -l * (1 - h) + 1)), n.graphicWidth = t, n.graphicHeight = l;
                break;
            case"balloonstyle":
                (i = OpenLayers.Util.getXmlNodeValue(i)) && (n.balloonStyle = i.replace(this.regExes.straightBracket, "${$1}"));
                break;
            case"labelstyle":
                t = this.parseProperty(i, "*", "color"), (t = this.parseKmlColor(t)) && (n.fontColor = t.color, n.fontOpacity = t.opacity)
        }
        return !n.strokeColor && n.fillColor && (n.strokeColor = n.fillColor), (e = e.getAttribute("id")) && n && (n.id = e), n
    },
    parseStyleMaps: function (e, t) {
        for (var i = 0, n = e.length; n > i; i++)for (var s = e[i], r = this.getElementsByTagNameNS(s, "*", "Pair"), s = s.getAttribute("id"), a = 0, o = r.length; o > a; a++) {
            var l = r[a], h = this.parseProperty(l, "*", "key");
            (l = this.parseProperty(l, "*", "styleUrl")) && "normal" == h && (this.styles[(t.styleBaseUrl || "") + "#" + s] = this.styles[(t.styleBaseUrl || "") + l])
        }
    },
    parseFeatures: function (e, t) {
        for (var i = [], n = 0, s = e.length; s > n; n++) {
            var r = e[n], a = this.parseFeature.apply(this, [r]);
            if (!a)throw"Bad Placemark: " + n;
            if (this.extractStyles && a.attributes && a.attributes.styleUrl && (a.style = this.getStyle(a.attributes.styleUrl, t)), this.extractStyles) {
                var o = this.getElementsByTagNameNS(r, "*", "Style")[0];
                o && (o = this.parseStyle(o)) && (a.style = OpenLayers.Util.extend(a.style, o))
            }
            this.extractTracks ? (r = this.getElementsByTagNameNS(r, this.namespaces.gx, "Track")) && 0 < r.length && (a = {
                features: [],
                feature: a
            }, this.readNode(r[0], a), 0 < a.features.length && i.push.apply(i, a.features)) : i.push(a)
        }
        this.features = this.features.concat(i)
    },
    readers: {
        kml: {
            when: function (e, t) {
                t.whens.push(OpenLayers.Date.parse(this.getChildValue(e)))
            }, _trackPointAttribute: function (e, t) {
                var i = e.nodeName.split(":").pop();
                t.attributes[i].push(this.getChildValue(e))
            }
        }, gx: {
            Track: function (e, t) {
                var i = {whens: [], points: [], angles: []};
                if (this.trackAttributes) {
                    var n;
                    i.attributes = {};
                    for (var s = 0, r = this.trackAttributes.length; r > s; ++s)n = this.trackAttributes[s], i.attributes[n] = [], n in this.readers.kml || (this.readers.kml[n] = this.readers.kml._trackPointAttribute)
                }
                if (this.readChildNodes(e, i), i.whens.length !== i.points.length)throw Error("gx:Track with unequal number of when (" + i.whens.length + ") and gx:coord (" + i.points.length + ") elements.");
                var a = 0 < i.angles.length;
                if (a && i.whens.length !== i.angles.length)throw Error("gx:Track with unequal number of when (" + i.whens.length + ") and gx:angles (" + i.angles.length + ") elements.");
                for (var o, l, s = 0, r = i.whens.length; r > s; ++s) {
                    if (o = t.feature.clone(), o.fid = t.feature.fid || t.feature.id, l = i.points[s], o.geometry = l, "z" in l && (o.attributes.altitude = l.z), this.internalProjection && this.externalProjection && o.geometry.transform(this.externalProjection, this.internalProjection), this.trackAttributes) {
                        l = 0;
                        for (var h = this.trackAttributes.length; h > l; ++l)o.attributes[n] = i.attributes[this.trackAttributes[l]][s]
                    }
                    o.attributes.when = i.whens[s], o.attributes.trackId = t.feature.id, a && (l = i.angles[s], o.attributes.heading = parseFloat(l[0]), o.attributes.tilt = parseFloat(l[1]), o.attributes.roll = parseFloat(l[2])), t.features.push(o)
                }
            }, coord: function (e, t) {
                var i = this.getChildValue(e).replace(this.regExes.trimSpace, "").split(/\s+/), n = new OpenLayers.Geometry.Point(i[0], i[1]);
                2 < i.length && (n.z = parseFloat(i[2])), t.points.push(n)
            }, angles: function (e, t) {
                var i = this.getChildValue(e).replace(this.regExes.trimSpace, "").split(/\s+/);
                t.angles.push(i)
            }
        }
    },
    parseFeature: function (e) {
        for (var t, i, n, s = ["MultiGeometry", "Polygon", "LineString", "Point"], r = 0, a = s.length; a > r; ++r)if (t = s[r], this.internalns = e.namespaceURI ? e.namespaceURI : this.kmlns, i = this.getElementsByTagNameNS(e, this.internalns, t), 0 < i.length) {
            if (!(s = this.parseGeometry[t.toLowerCase()]))throw new TypeError("Unsupported geometry type: " + t);
            n = s.apply(this, [i[0]]), this.internalProjection && this.externalProjection && n.transform(this.externalProjection, this.internalProjection);
            break
        }
        var o;
        return this.extractAttributes && (o = this.parseAttributes(e)), t = new OpenLayers.Feature.Vector(n, o), e = e.getAttribute("id") || e.getAttribute("name"), null != e && (t.fid = e), t
    },
    getStyle: function (e, t) {
        var i = OpenLayers.Util.removeTail(e), n = OpenLayers.Util.extend({}, t);
        return n.depth++, n.styleBaseUrl = i, !this.styles[e] && !OpenLayers.String.startsWith(e, "#") && n.depth <= this.maxDepth && !this.fetched[i] && (i = this.fetchLink(i)) && this.parseData(i, n), OpenLayers.Util.extend({}, this.styles[e])
    },
    parseGeometry: {
        point: function (e) {
            var t = this.getElementsByTagNameNS(e, this.internalns, "coordinates"), e = [];
            if (0 < t.length)var i = t[0].firstChild.nodeValue, i = i.replace(this.regExes.removeSpace, ""), e = i.split(",");
            if (t = null, !(1 < e.length))throw"Bad coordinate string: " + i;
            return 2 == e.length && (e[2] = null), t = new OpenLayers.Geometry.Point(e[0], e[1], e[2])
        }, linestring: function (e, t) {
            var i = this.getElementsByTagNameNS(e, this.internalns, "coordinates"), n = null;
            if (0 < i.length) {
                for (var s, r, i = this.getChildValue(i[0]), i = i.replace(this.regExes.trimSpace, ""), i = i.replace(this.regExes.trimComma, ","), n = i.split(this.regExes.splitSpace), a = n.length, o = Array(a), l = 0; a > l; ++l) {
                    if (s = n[l].split(","), r = s.length, !(r > 1))throw"Bad LineString point coordinates: " + n[l];
                    2 == s.length && (s[2] = null), o[l] = new OpenLayers.Geometry.Point(s[0], s[1], s[2])
                }
                if (!a)throw"Bad LineString coordinates: " + i;
                n = t ? new OpenLayers.Geometry.LinearRing(o) : new OpenLayers.Geometry.LineString(o)
            }
            return n
        }, polygon: function (e) {
            var e = this.getElementsByTagNameNS(e, this.internalns, "LinearRing"), t = e.length, i = Array(t);
            if (t > 0)for (var n = 0, s = e.length; s > n; ++n) {
                if (!(t = this.parseGeometry.linestring.apply(this, [e[n], !0])))throw"Bad LinearRing geometry: " + n;
                i[n] = t
            }
            return new OpenLayers.Geometry.Polygon(i)
        }, multigeometry: function (e) {
            for (var t, i = [], n = e.childNodes, s = 0, r = n.length; r > s; ++s)e = n[s], 1 == e.nodeType && (t = this.parseGeometry[(e.prefix ? e.nodeName.split(":")[1] : e.nodeName).toLowerCase()]) && i.push(t.apply(this, [e]));
            return new OpenLayers.Geometry.Collection(i)
        }
    },
    parseAttributes: function (e) {
        var t = {}, i = e.getElementsByTagName("ExtendedData");
        i.length && (t = this.parseExtendedData(i[0]));
        for (var n, s, r, e = e.childNodes, i = 0, a = e.length; a > i; ++i)if (n = e[i], 1 == n.nodeType && (s = n.childNodes, 1 <= s.length && 3 >= s.length)) {
            switch (s.length) {
                case 1:
                    r = s[0];
                    break;
                case 2:
                    r = s[0], s = s[1], r = 3 == r.nodeType || 4 == r.nodeType ? r : s;
                    break;
                default:
                    r = s[1]
            }
            (3 == r.nodeType || 4 == r.nodeType) && (n = n.prefix ? n.nodeName.split(":")[1] : n.nodeName, (r = OpenLayers.Util.getXmlNodeValue(r)) && (r = r.replace(this.regExes.trimSpace, ""), t[n] = r))
        }
        return t
    },
    parseExtendedData: function (e) {
        var t, i, n, s, r = {}, a = e.getElementsByTagName("Data");
        for (t = 0, i = a.length; i > t; t++) {
            n = a[t], s = n.getAttribute("name");
            var o = {}, l = n.getElementsByTagName("value");
            l.length && (o.value = this.getChildValue(l[0])), this.kvpAttributes ? r[s] = o.value : (n = n.getElementsByTagName("displayName"), n.length && (o.displayName = this.getChildValue(n[0])), r[s] = o)
        }
        for (e = e.getElementsByTagName("SimpleData"), t = 0, i = e.length; i > t; t++)o = {}, n = e[t], s = n.getAttribute("name"), o.value = this.getChildValue(n), this.kvpAttributes ? r[s] = o.value : (o.displayName = s, r[s] = o);
        return r
    },
    parseProperty: function (e, t, i) {
        var n, e = this.getElementsByTagNameNS(e, t, i);
        try {
            n = OpenLayers.Util.getXmlNodeValue(e[0])
        } catch (s) {
            n = null
        }
        return n
    },
    write: function (e) {
        OpenLayers.Util.isArray(e) || (e = [e]);
        for (var t = this.createElementNS(this.kmlns, "kml"), i = this.createFolderXML(), n = 0, s = e.length; s > n; ++n)i.appendChild(this.createPlacemarkXML(e[n]));
        return t.appendChild(i), OpenLayers.Format.XML.prototype.write.apply(this, [t])
    },
    createFolderXML: function () {
        var e = this.createElementNS(this.kmlns, "Folder");
        if (this.foldersName) {
            var t = this.createElementNS(this.kmlns, "name"), i = this.createTextNode(this.foldersName);
            t.appendChild(i), e.appendChild(t)
        }
        return this.foldersDesc && (t = this.createElementNS(this.kmlns, "description"), i = this.createTextNode(this.foldersDesc), t.appendChild(i), e.appendChild(t)), e
    },
    createPlacemarkXML: function (e) {
        var t = this.createElementNS(this.kmlns, "name");
        t.appendChild(this.createTextNode(e.style && e.style.label ? e.style.label : e.attributes.name || e.id));
        var i = this.createElementNS(this.kmlns, "description");
        i.appendChild(this.createTextNode(e.attributes.description || this.placemarksDesc));
        var n = this.createElementNS(this.kmlns, "Placemark");
        return null != e.fid && n.setAttribute("id", e.fid), n.appendChild(t), n.appendChild(i), t = this.buildGeometryNode(e.geometry), n.appendChild(t), e.attributes && (e = this.buildExtendedData(e.attributes)) && n.appendChild(e), n
    },
    buildGeometryNode: function (e) {
        var t = e.CLASS_NAME, t = this.buildGeometry[t.substring(t.lastIndexOf(".") + 1).toLowerCase()], i = null;
        return t && (i = t.apply(this, [e])), i
    },
    buildGeometry: {
        point: function (e) {
            var t = this.createElementNS(this.kmlns, "Point");
            return t.appendChild(this.buildCoordinatesNode(e)), t
        }, multipoint: function (e) {
            return this.buildGeometry.collection.apply(this, [e])
        }, linestring: function (e) {
            var t = this.createElementNS(this.kmlns, "LineString");
            return t.appendChild(this.buildCoordinatesNode(e)), t
        }, multilinestring: function (e) {
            return this.buildGeometry.collection.apply(this, [e])
        }, linearring: function (e) {
            var t = this.createElementNS(this.kmlns, "LinearRing");
            return t.appendChild(this.buildCoordinatesNode(e)), t
        }, polygon: function (e) {
            for (var t, i, n = this.createElementNS(this.kmlns, "Polygon"), e = e.components, s = 0, r = e.length; r > s; ++s)t = 0 == s ? "outerBoundaryIs" : "innerBoundaryIs", t = this.createElementNS(this.kmlns, t), i = this.buildGeometry.linearring.apply(this, [e[s]]), t.appendChild(i), n.appendChild(t);
            return n
        }, multipolygon: function (e) {
            return this.buildGeometry.collection.apply(this, [e])
        }, collection: function (e) {
            for (var t, i = this.createElementNS(this.kmlns, "MultiGeometry"), n = 0, s = e.components.length; s > n; ++n)(t = this.buildGeometryNode.apply(this, [e.components[n]])) && i.appendChild(t);
            return i
        }
    },
    buildCoordinatesNode: function (e) {
        var t, i = this.createElementNS(this.kmlns, "coordinates");
        if (t = e.components) {
            for (var n = t.length, s = Array(n), r = 0; n > r; ++r)e = t[r], s[r] = this.buildCoordinates(e);
            t = s.join(" ")
        } else t = this.buildCoordinates(e);
        return t = this.createTextNode(t), i.appendChild(t), i
    },
    buildCoordinates: function (e) {
        return this.internalProjection && this.externalProjection && (e = e.clone(), e.transform(this.internalProjection, this.externalProjection)), e.x + "," + e.y
    },
    buildExtendedData: function (e) {
        var t, i = this.createElementNS(this.kmlns, "ExtendedData");
        for (t in e)if (e[t] && "name" != t && "description" != t && "styleUrl" != t) {
            var n = this.createElementNS(this.kmlns, "Data");
            n.setAttribute("name", t);
            var s = this.createElementNS(this.kmlns, "value");
            if ("object" == typeof e[t]) {
                if (e[t].value && s.appendChild(this.createTextNode(e[t].value)), e[t].displayName) {
                    var r = this.createElementNS(this.kmlns, "displayName");
                    r.appendChild(this.getXMLDoc().createCDATASection(e[t].displayName)), n.appendChild(r)
                }
            } else s.appendChild(this.createTextNode(e[t]));
            n.appendChild(s), i.appendChild(n)
        }
        return this.isSimpleContent(i) ? null : i
    },
    CLASS_NAME: "OpenLayers.Format.KML"
}),OpenLayers.Popup = OpenLayers.Class({
    events: null,
    id: "",
    lonlat: null,
    div: null,
    contentSize: null,
    size: null,
    contentHTML: null,
    backgroundColor: "",
    opacity: "",
    border: "",
    contentDiv: null,
    groupDiv: null,
    closeDiv: null,
    autoSize: !1,
    minSize: null,
    maxSize: null,
    displayClass: "olPopup",
    contentDisplayClass: "olPopupContent",
    padding: 0,
    disableFirefoxOverflowHack: !1,
    fixPadding: function () {
        "number" == typeof this.padding && (this.padding = new OpenLayers.Bounds(this.padding, this.padding, this.padding, this.padding))
    },
    panMapIfOutOfView: !1,
    keepInMap: !1,
    closeOnMove: !1,
    map: null,
    initialize: function (e, t, i, n, s, r) {
        null == e && (e = OpenLayers.Util.createUniqueID(this.CLASS_NAME + "_")), this.id = e, this.lonlat = t, this.contentSize = null != i ? i : new OpenLayers.Size(OpenLayers.Popup.WIDTH, OpenLayers.Popup.HEIGHT), null != n && (this.contentHTML = n), this.backgroundColor = OpenLayers.Popup.COLOR, this.opacity = OpenLayers.Popup.OPACITY, this.border = OpenLayers.Popup.BORDER, this.div = OpenLayers.Util.createDiv(this.id, null, null, null, null, null, "hidden"), this.div.className = this.displayClass, this.groupDiv = OpenLayers.Util.createDiv(this.id + "_GroupDiv", null, null, null, "relative", null, "hidden"), e = this.div.id + "_contentDiv", this.contentDiv = OpenLayers.Util.createDiv(e, null, this.contentSize.clone(), null, "relative"), this.contentDiv.className = this.contentDisplayClass, this.groupDiv.appendChild(this.contentDiv), this.div.appendChild(this.groupDiv), s && this.addCloseBox(r), this.registerEvents()
    },
    destroy: function () {
        this.border = this.opacity = this.backgroundColor = this.contentHTML = this.size = this.lonlat = this.id = null, this.closeOnMove && this.map && this.map.events.unregister("movestart", this, this.hide), this.events.destroy(), this.events = null, this.closeDiv && (OpenLayers.Event.stopObservingElement(this.closeDiv), this.groupDiv.removeChild(this.closeDiv)), this.closeDiv = null, this.div.removeChild(this.groupDiv), this.groupDiv = null, null != this.map && this.map.removePopup(this), this.panMapIfOutOfView = this.padding = this.maxSize = this.minSize = this.autoSize = this.div = this.map = null
    },
    draw: function (e) {
        return null == e && null != this.lonlat && null != this.map && (e = this.map.getLayerPxFromLonLat(this.lonlat)), this.closeOnMove && this.map.events.register("movestart", this, this.hide), !this.disableFirefoxOverflowHack && "firefox" == OpenLayers.BROWSER_NAME && (this.map.events.register("movestart", this, function () {
            var e = document.defaultView.getComputedStyle(this.contentDiv, null).getPropertyValue("overflow");
            "hidden" != e && (this.contentDiv._oldOverflow = e, this.contentDiv.style.overflow = "hidden")
        }), this.map.events.register("moveend", this, function () {
            var e = this.contentDiv._oldOverflow;
            e && (this.contentDiv.style.overflow = e, this.contentDiv._oldOverflow = null)
        })), this.moveTo(e), !this.autoSize && !this.size && this.setSize(this.contentSize), this.setBackgroundColor(), this.setOpacity(), this.setBorder(), this.setContentHTML(), this.panMapIfOutOfView && this.panIntoView(), this.div
    },
    updatePosition: function () {
        if (this.lonlat && this.map) {
            var e = this.map.getLayerPxFromLonLat(this.lonlat);
            e && this.moveTo(e)
        }
    },
    moveTo: function (e) {
        null != e && null != this.div && (this.div.style.left = e.x + "px", this.div.style.top = e.y + "px")
    },
    visible: function () {
        return OpenLayers.Element.visible(this.div)
    },
    toggle: function () {
        this.visible() ? this.hide() : this.show()
    },
    show: function () {
        this.div.style.display = "", this.panMapIfOutOfView && this.panIntoView()
    },
    hide: function () {
        this.div.style.display = "none"
    },
    setSize: function (e) {
        this.size = e.clone();
        var t = this.getContentDivPadding(), i = t.left + t.right, n = t.top + t.bottom;
        if (this.fixPadding(), i += this.padding.left + this.padding.right, n += this.padding.top + this.padding.bottom, this.closeDiv)var s = parseInt(this.closeDiv.style.width), i = i + (s + t.right);
        this.size.w += i, this.size.h += n, "msie" == OpenLayers.BROWSER_NAME && (this.contentSize.w += t.left + t.right, this.contentSize.h += t.bottom + t.top), null != this.div && (this.div.style.width = this.size.w + "px", this.div.style.height = this.size.h + "px"), null != this.contentDiv && (this.contentDiv.style.width = e.w + "px", this.contentDiv.style.height = e.h + "px")
    },
    updateSize: function () {
        var e = "<div class='" + this.contentDisplayClass + "'>" + this.contentDiv.innerHTML + "</div>", t = this.map ? this.map.div : document.body, i = OpenLayers.Util.getRenderedDimensions(e, null, {
            displayClass: this.displayClass,
            containerElement: t
        }), n = this.getSafeContentSize(i), s = null;
        n.equals(i) ? s = i : (i = {
            w: n.w < i.w ? n.w : null,
            h: n.h < i.h ? n.h : null
        }, i.w && i.h ? s = n : (e = OpenLayers.Util.getRenderedDimensions(e, i, {
            displayClass: this.contentDisplayClass,
            containerElement: t
        }), "hidden" != OpenLayers.Element.getStyle(this.contentDiv, "overflow") && e.equals(n) && (n = OpenLayers.Util.getScrollbarWidth(), i.w ? e.h += n : e.w += n), s = this.getSafeContentSize(e))), this.setSize(s)
    },
    setBackgroundColor: function (e) {
        void 0 != e && (this.backgroundColor = e), null != this.div && (this.div.style.backgroundColor = this.backgroundColor)
    },
    setOpacity: function (e) {
        void 0 != e && (this.opacity = e), null != this.div && (this.div.style.opacity = this.opacity, this.div.style.filter = "alpha(opacity=" + 100 * this.opacity + ")")
    },
    setBorder: function (e) {
        void 0 != e && (this.border = e), null != this.div && (this.div.style.border = this.border)
    },
    setContentHTML: function (e) {
        null != e && (this.contentHTML = e), null != this.contentDiv && null != this.contentHTML && this.contentHTML != this.contentDiv.innerHTML && (this.contentDiv.innerHTML = this.contentHTML, this.autoSize && (this.registerImageListeners(), this.updateSize()))
    },
    registerImageListeners: function () {
        for (var e = function () {
            null !== this.popup.id && (this.popup.updateSize(), this.popup.visible() && this.popup.panMapIfOutOfView && this.popup.panIntoView(), OpenLayers.Event.stopObserving(this.img, "load", this.img._onImageLoad))
        }, t = this.contentDiv.getElementsByTagName("img"), i = 0, n = t.length; n > i; i++) {
            var s = t[i];
            (0 == s.width || 0 == s.height) && (s._onImgLoad = OpenLayers.Function.bind(e, {
                popup: this,
                img: s
            }), OpenLayers.Event.observe(s, "load", s._onImgLoad))
        }
    },
    getSafeContentSize: function (e) {
        var e = e.clone(), t = this.getContentDivPadding(), i = t.left + t.right, n = t.top + t.bottom;
        if (this.fixPadding(), i += this.padding.left + this.padding.right, n += this.padding.top + this.padding.bottom, this.closeDiv)var s = parseInt(this.closeDiv.style.width), i = i + (s + t.right);
        if (this.minSize && (e.w = Math.max(e.w, this.minSize.w - i), e.h = Math.max(e.h, this.minSize.h - n)), this.maxSize && (e.w = Math.min(e.w, this.maxSize.w - i), e.h = Math.min(e.h, this.maxSize.h - n)), this.map && this.map.size) {
            if (s = t = 0, this.keepInMap && !this.panMapIfOutOfView)switch (s = this.map.getPixelFromLonLat(this.lonlat), this.relativePosition) {
                case"tr":
                    t = s.x, s = this.map.size.h - s.y;
                    break;
                case"tl":
                    t = this.map.size.w - s.x, s = this.map.size.h - s.y;
                    break;
                case"bl":
                    t = this.map.size.w - s.x, s = s.y;
                    break;
                case"br":
                    t = s.x, s = s.y;
                    break;
                default:
                    t = s.x, s = this.map.size.h - s.y
            }
            n = this.map.size.h - this.map.paddingForPopups.top - this.map.paddingForPopups.bottom - n - s, e.w = Math.min(e.w, this.map.size.w - this.map.paddingForPopups.left - this.map.paddingForPopups.right - i - t), e.h = Math.min(e.h, n)
        }
        return e
    },
    getContentDivPadding: function () {
        var e = this._contentDivPadding;
        return e || (null == this.div.parentNode && (this.div.style.display = "none", document.body.appendChild(this.div)), this._contentDivPadding = e = new OpenLayers.Bounds(OpenLayers.Element.getStyle(this.contentDiv, "padding-left"), OpenLayers.Element.getStyle(this.contentDiv, "padding-bottom"), OpenLayers.Element.getStyle(this.contentDiv, "padding-right"), OpenLayers.Element.getStyle(this.contentDiv, "padding-top")), this.div.parentNode != document.body) || (document.body.removeChild(this.div), this.div.style.display = ""), e
    },
    addCloseBox: function (e) {
        this.closeDiv = OpenLayers.Util.createDiv(this.id + "_close", null, {
            w: 17,
            h: 17
        }), this.closeDiv.className = "olPopupCloseBox";
        var t = this.getContentDivPadding();
        this.closeDiv.style.right = t.right + "px", this.closeDiv.style.top = t.top + "px", this.groupDiv.appendChild(this.closeDiv), e = e || function (e) {
                this.hide(), OpenLayers.Event.stop(e)
            }, OpenLayers.Event.observe(this.closeDiv, "touchend", OpenLayers.Function.bindAsEventListener(e, this)), OpenLayers.Event.observe(this.closeDiv, "click", OpenLayers.Function.bindAsEventListener(e, this))
    },
    panIntoView: function () {
        var e = this.map.getSize(), t = this.map.getViewPortPxFromLayerPx(new OpenLayers.Pixel(parseInt(this.div.style.left), parseInt(this.div.style.top))), i = t.clone();
        t.x < this.map.paddingForPopups.left ? i.x = this.map.paddingForPopups.left : t.x + this.size.w > e.w - this.map.paddingForPopups.right && (i.x = e.w - this.map.paddingForPopups.right - this.size.w), t.y < this.map.paddingForPopups.top ? i.y = this.map.paddingForPopups.top : t.y + this.size.h > e.h - this.map.paddingForPopups.bottom && (i.y = e.h - this.map.paddingForPopups.bottom - this.size.h), this.map.pan(t.x - i.x, t.y - i.y)
    },
    registerEvents: function () {
        this.events = new OpenLayers.Events(this, this.div, null, !0), this.events.on({
            mousedown: this.onmousedown,
            mousemove: this.onmousemove,
            mouseup: this.onmouseup,
            click: this.onclick,
            mouseout: this.onmouseout,
            dblclick: this.ondblclick,
            touchstart: function (e) {
                OpenLayers.Event.stop(e, !0)
            },
            scope: this
        })
    },
    onmousedown: function (e) {
        this.mousedown = !0, OpenLayers.Event.stop(e, !0)
    },
    onmousemove: function (e) {
        this.mousedown && OpenLayers.Event.stop(e, !0)
    },
    onmouseup: function (e) {
        this.mousedown && (this.mousedown = !1, OpenLayers.Event.stop(e, !0))
    },
    onclick: function (e) {
        OpenLayers.Event.stop(e, !0)
    },
    onmouseout: function () {
        this.mousedown = !1
    },
    ondblclick: function (e) {
        OpenLayers.Event.stop(e, !0)
    },
    CLASS_NAME: "OpenLayers.Popup"
}),OpenLayers.Popup.WIDTH = 200,OpenLayers.Popup.HEIGHT = 200,OpenLayers.Popup.COLOR = "white",OpenLayers.Popup.OPACITY = 1,OpenLayers.Popup.BORDER = "0px",OpenLayers.Popup.Anchored = OpenLayers.Class(OpenLayers.Popup, {
    relativePosition: null,
    keepInMap: !0,
    anchor: null,
    initialize: function (e, t, i, n, s, r, a) {
        OpenLayers.Popup.prototype.initialize.apply(this, [e, t, i, n, r, a]), this.anchor = null != s ? s : {
            size: new OpenLayers.Size(0, 0),
            offset: new OpenLayers.Pixel(0, 0)
        }
    },
    destroy: function () {
        this.relativePosition = this.anchor = null, OpenLayers.Popup.prototype.destroy.apply(this, arguments)
    },
    show: function () {
        this.updatePosition(), OpenLayers.Popup.prototype.show.apply(this, arguments)
    },
    moveTo: function (e) {
        var t = this.relativePosition;
        this.relativePosition = this.calculateRelativePosition(e), e = this.calculateNewPx(e), OpenLayers.Popup.prototype.moveTo.apply(this, Array(e)), this.relativePosition != t && this.updateRelativePosition()
    },
    setSize: function () {
        OpenLayers.Popup.prototype.setSize.apply(this, arguments), this.lonlat && this.map && this.moveTo(this.map.getLayerPxFromLonLat(this.lonlat))
    },
    calculateRelativePosition: function (e) {
        return e = this.map.getLonLatFromLayerPx(e), e = this.map.getExtent().determineQuadrant(e), OpenLayers.Bounds.oppositeQuadrant(e)
    },
    updateRelativePosition: function () {
    },
    calculateNewPx: function (e) {
        var e = e.offset(this.anchor.offset), t = this.size || this.contentSize, i = "t" == this.relativePosition.charAt(0);
        return e.y += i ? -t.h : this.anchor.size.h, i = "l" == this.relativePosition.charAt(1), e.x += i ? -t.w : this.anchor.size.w, e
    },
    CLASS_NAME: "OpenLayers.Popup.Anchored"
}),/*
 Apache 2

 Contains portions of Rico <http://openrico.org/>

 Copyright 2005 Sabre Airline Solutions

 Licensed under the Apache License, Version 2.0 (the "License"); you
 may not use this file except in compliance with the License. You
 may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied. See the License for the specific language governing
 permissions and limitations under the License.
 */
OpenLayers.Console.warn("OpenLayers.Rico is deprecated"),OpenLayers.Rico = OpenLayers.Rico || {},OpenLayers.Rico.Color = OpenLayers.Class({
    initialize: function (e, t, i) {
        this.rgb = {r: e, g: t, b: i}
    }, setRed: function (e) {
        this.rgb.r = e
    }, setGreen: function (e) {
        this.rgb.g = e
    }, setBlue: function (e) {
        this.rgb.b = e
    }, setHue: function (e) {
        var t = this.asHSB();
        t.h = e, this.rgb = OpenLayers.Rico.Color.HSBtoRGB(t.h, t.s, t.b)
    }, setSaturation: function (e) {
        var t = this.asHSB();
        t.s = e, this.rgb = OpenLayers.Rico.Color.HSBtoRGB(t.h, t.s, t.b)
    }, setBrightness: function (e) {
        var t = this.asHSB();
        t.b = e, this.rgb = OpenLayers.Rico.Color.HSBtoRGB(t.h, t.s, t.b)
    }, darken: function (e) {
        var t = this.asHSB();
        this.rgb = OpenLayers.Rico.Color.HSBtoRGB(t.h, t.s, Math.max(t.b - e, 0))
    }, brighten: function (e) {
        var t = this.asHSB();
        this.rgb = OpenLayers.Rico.Color.HSBtoRGB(t.h, t.s, Math.min(t.b + e, 1))
    }, blend: function (e) {
        this.rgb.r = Math.floor((this.rgb.r + e.rgb.r) / 2), this.rgb.g = Math.floor((this.rgb.g + e.rgb.g) / 2), this.rgb.b = Math.floor((this.rgb.b + e.rgb.b) / 2)
    }, isBright: function () {
        return this.asHSB(), .5 < this.asHSB().b
    }, isDark: function () {
        return !this.isBright()
    }, asRGB: function () {
        return "rgb(" + this.rgb.r + "," + this.rgb.g + "," + this.rgb.b + ")"
    }, asHex: function () {
        return "#" + this.rgb.r.toColorPart() + this.rgb.g.toColorPart() + this.rgb.b.toColorPart()
    }, asHSB: function () {
        return OpenLayers.Rico.Color.RGBtoHSB(this.rgb.r, this.rgb.g, this.rgb.b)
    }, toString: function () {
        return this.asHex()
    }
}),OpenLayers.Rico.Color.createFromHex = function (e) {
    if (4 == e.length)for (var t = e, e = "#", i = 1; 4 > i; i++)e += t.charAt(i) + t.charAt(i);
    return 0 == e.indexOf("#") && (e = e.substring(1)), t = e.substring(0, 2), i = e.substring(2, 4), e = e.substring(4, 6), new OpenLayers.Rico.Color(parseInt(t, 16), parseInt(i, 16), parseInt(e, 16))
},OpenLayers.Rico.Color.createColorFromBackground = function (e) {
    var t = OpenLayers.Element.getStyle(OpenLayers.Util.getElement(e), "backgroundColor");
    return "transparent" == t && e.parentNode ? OpenLayers.Rico.Color.createColorFromBackground(e.parentNode) : null == t ? new OpenLayers.Rico.Color(255, 255, 255) : 0 == t.indexOf("rgb(") ? (e = t.substring(4, t.length - 1).split(","), new OpenLayers.Rico.Color(parseInt(e[0]), parseInt(e[1]), parseInt(e[2]))) : 0 == t.indexOf("#") ? OpenLayers.Rico.Color.createFromHex(t) : new OpenLayers.Rico.Color(255, 255, 255)
},OpenLayers.Rico.Color.HSBtoRGB = function (e, t, i) {
    var n = 0, s = 0, r = 0;
    if (0 == t) r = s = n = parseInt(255 * i + .5); else {
        var e = 6 * (e - Math.floor(e)), a = e - Math.floor(e), o = i * (1 - t), l = i * (1 - t * a), t = i * (1 - t * (1 - a));
        switch (parseInt(e)) {
            case 0:
                n = 255 * i + .5, s = 255 * t + .5, r = 255 * o + .5;
                break;
            case 1:
                n = 255 * l + .5, s = 255 * i + .5, r = 255 * o + .5;
                break;
            case 2:
                n = 255 * o + .5, s = 255 * i + .5, r = 255 * t + .5;
                break;
            case 3:
                n = 255 * o + .5, s = 255 * l + .5, r = 255 * i + .5;
                break;
            case 4:
                n = 255 * t + .5, s = 255 * o + .5, r = 255 * i + .5;
                break;
            case 5:
                n = 255 * i + .5, s = 255 * o + .5, r = 255 * l + .5
        }
    }
    return {r: parseInt(n), g: parseInt(s), b: parseInt(r)}
},OpenLayers.Rico.Color.RGBtoHSB = function (e, t, i) {
    var n, s = e > t ? e : t;
    i > s && (s = i);
    var r = t > e ? e : t;
    if (r > i && (r = i), n = 0 != s ? (s - r) / s : 0, 0 == n) e = 0; else {
        var a = (s - e) / (s - r), o = (s - t) / (s - r), i = (s - i) / (s - r), e = (e == s ? i - o : t == s ? 2 + a - i : 4 + o - a) / 6;
        0 > e && (e += 1)
    }
    return {h: e, s: n, b: s / 255}
},OpenLayers.Console.warn("OpenLayers.Rico is deprecated"),OpenLayers.Rico = OpenLayers.Rico || {},OpenLayers.Rico.Corner = {
    round: function (e, t) {
        e = OpenLayers.Util.getElement(e), this._setOptions(t);
        var i = this.options.color;
        "fromElement" == this.options.color && (i = this._background(e));
        var n = this.options.bgColor;
        "fromParent" == this.options.bgColor && (n = this._background(e.offsetParent)), this._roundCornersImpl(e, i, n)
    }, changeColor: function (e, t) {
        e.style.backgroundColor = t;
        for (var i = e.parentNode.getElementsByTagName("span"), n = 0; n < i.length; n++)i[n].style.backgroundColor = t
    }, changeOpacity: function (e, t) {
        var i = "alpha(opacity=" + 100 * t + ")";
        e.style.opacity = t, e.style.filter = i;
        for (var n = e.parentNode.getElementsByTagName("span"), s = 0; s < n.length; s++)n[s].style.opacity = t, n[s].style.filter = i
    }, reRound: function (e, t) {
        var i = e.parentNode.childNodes[2];
        e.parentNode.removeChild(e.parentNode.childNodes[0]), e.parentNode.removeChild(i), this.round(e.parentNode, t)
    }, _roundCornersImpl: function (e, t, i) {
        this.options.border && this._renderBorder(e, i), this._isTopRounded() && this._roundTopCorners(e, t, i), this._isBottomRounded() && this._roundBottomCorners(e, t, i)
    }, _renderBorder: function (e, t) {
        var i = "1px solid " + this._borderColor(t);
        e.innerHTML = "<div " + ("style='border-left: " + i + ";" + ("border-right: " + i) + "'") + ">" + e.innerHTML + "</div>"
    }, _roundTopCorners: function (e, t, i) {
        for (var n = this._createCorner(i), s = 0; s < this.options.numSlices; s++)n.appendChild(this._createCornerSlice(t, i, s, "top"));
        e.style.paddingTop = 0, e.insertBefore(n, e.firstChild)
    }, _roundBottomCorners: function (e, t, i) {
        for (var n = this._createCorner(i), s = this.options.numSlices - 1; s >= 0; s--)n.appendChild(this._createCornerSlice(t, i, s, "bottom"));
        e.style.paddingBottom = 0, e.appendChild(n)
    }, _createCorner: function (e) {
        var t = document.createElement("div");
        return t.style.backgroundColor = this._isTransparent() ? "transparent" : e, t
    }, _createCornerSlice: function (e, t, i, n) {
        var s = document.createElement("span"), r = s.style;
        return r.backgroundColor = e, r.display = "block", r.height = "1px", r.overflow = "hidden", r.fontSize = "1px", e = this._borderColor(e, t), this.options.border && 0 == i ? (r.borderTopStyle = "solid", r.borderTopWidth = "1px", r.borderLeftWidth = "0px", r.borderRightWidth = "0px", r.borderBottomWidth = "0px", r.height = "0px", r.borderColor = e) : e && (r.borderColor = e, r.borderStyle = "solid", r.borderWidth = "0px 1px"), !this.options.compact && i == this.options.numSlices - 1 && (r.height = "2px"), this._setMargin(s, i, n), this._setBorder(s, i, n), s
    }, _setOptions: function (e) {
        this.options = {
            corners: "all",
            color: "fromElement",
            bgColor: "fromParent",
            blend: !0,
            border: !1,
            compact: !1
        }, OpenLayers.Util.extend(this.options, e || {}), this.options.numSlices = this.options.compact ? 2 : 4, this._isTransparent() && (this.options.blend = !1)
    }, _whichSideTop: function () {
        return this._hasString(this.options.corners, "all", "top") || 0 <= this.options.corners.indexOf("tl") && 0 <= this.options.corners.indexOf("tr") ? "" : 0 <= this.options.corners.indexOf("tl") ? "left" : 0 <= this.options.corners.indexOf("tr") ? "right" : ""
    }, _whichSideBottom: function () {
        return this._hasString(this.options.corners, "all", "bottom") || 0 <= this.options.corners.indexOf("bl") && 0 <= this.options.corners.indexOf("br") ? "" : 0 <= this.options.corners.indexOf("bl") ? "left" : 0 <= this.options.corners.indexOf("br") ? "right" : ""
    }, _borderColor: function (e, t) {
        return "transparent" == e ? t : this.options.border ? this.options.border : this.options.blend ? this._blend(t, e) : ""
    }, _setMargin: function (e, t, i) {
        t = this._marginSize(t), i = "top" == i ? this._whichSideTop() : this._whichSideBottom(), "left" == i ? (e.style.marginLeft = t + "px", e.style.marginRight = "0px") : "right" == i ? (e.style.marginRight = t + "px", e.style.marginLeft = "0px") : (e.style.marginLeft = t + "px", e.style.marginRight = t + "px")
    }, _setBorder: function (e, t, i) {
        t = this._borderSize(t), i = "top" == i ? this._whichSideTop() : this._whichSideBottom(), "left" == i ? (e.style.borderLeftWidth = t + "px", e.style.borderRightWidth = "0px") : "right" == i ? (e.style.borderRightWidth = t + "px", e.style.borderLeftWidth = "0px") : (e.style.borderLeftWidth = t + "px", e.style.borderRightWidth = t + "px"), 0 != this.options.border && (e.style.borderLeftWidth = t + "px", e.style.borderRightWidth = t + "px")
    }, _marginSize: function (e) {
        if (this._isTransparent())return 0;
        var t = [5, 3, 2, 1], i = [3, 2, 1, 0], n = [2, 1], s = [1, 0];
        return this.options.compact && this.options.blend ? s[e] : this.options.compact ? n[e] : this.options.blend ? i[e] : t[e]
    }, _borderSize: function (e) {
        var t = [5, 3, 2, 1], i = [2, 1, 1, 1], n = [1, 0], s = [0, 2, 0, 0];
        return this.options.compact && (this.options.blend || this._isTransparent()) ? 1 : this.options.compact ? n[e] : this.options.blend ? i[e] : this.options.border ? s[e] : this._isTransparent() ? t[e] : 0
    }, _hasString: function (e) {
        for (var t = 1; t < arguments.length; t++)if (0 <= e.indexOf(arguments[t]))return !0;
        return !1
    }, _blend: function (e, t) {
        var i = OpenLayers.Rico.Color.createFromHex(e);
        return i.blend(OpenLayers.Rico.Color.createFromHex(t)), i
    }, _background: function (e) {
        try {
            return OpenLayers.Rico.Color.createColorFromBackground(e).asHex()
        } catch (t) {
            return "#ffffff"
        }
    }, _isTransparent: function () {
        return "transparent" == this.options.color
    }, _isTopRounded: function () {
        return this._hasString(this.options.corners, "all", "top", "tl", "tr")
    }, _isBottomRounded: function () {
        return this._hasString(this.options.corners, "all", "bottom", "bl", "br")
    }, _hasSingleTextChild: function (e) {
        return 1 == e.childNodes.length && 3 == e.childNodes[0].nodeType
    }
},OpenLayers.Popup.AnchoredBubble = OpenLayers.Class(OpenLayers.Popup.Anchored, {
    rounded: !1, initialize: function () {
        OpenLayers.Console.warn("AnchoredBubble is deprecated"), this.padding = new OpenLayers.Bounds(0, OpenLayers.Popup.AnchoredBubble.CORNER_SIZE, 0, OpenLayers.Popup.AnchoredBubble.CORNER_SIZE), OpenLayers.Popup.Anchored.prototype.initialize.apply(this, arguments)
    }, draw: function () {
        return OpenLayers.Popup.Anchored.prototype.draw.apply(this, arguments), this.setContentHTML(), this.setBackgroundColor(), this.setOpacity(), this.div
    }, updateRelativePosition: function () {
        this.setRicoCorners()
    }, setSize: function () {
        OpenLayers.Popup.Anchored.prototype.setSize.apply(this, arguments), this.setRicoCorners()
    }, setBackgroundColor: function (e) {
        void 0 != e && (this.backgroundColor = e), null != this.div && null != this.contentDiv && (this.div.style.background = "transparent", OpenLayers.Rico.Corner.changeColor(this.groupDiv, this.backgroundColor))
    }, setOpacity: function (e) {
        OpenLayers.Popup.Anchored.prototype.setOpacity.call(this, e), null != this.div && null != this.groupDiv && OpenLayers.Rico.Corner.changeOpacity(this.groupDiv, this.opacity)
    }, setBorder: function () {
        this.border = 0
    }, setRicoCorners: function () {
        var e = {
            corners: this.getCornersToRound(this.relativePosition),
            color: this.backgroundColor,
            bgColor: "transparent",
            blend: !1
        };
        this.rounded ? (OpenLayers.Rico.Corner.reRound(this.groupDiv, e), this.setBackgroundColor(), this.setOpacity()) : (OpenLayers.Rico.Corner.round(this.div, e), this.rounded = !0)
    }, getCornersToRound: function () {
        var e = ["tl", "tr", "bl", "br"], t = OpenLayers.Bounds.oppositeQuadrant(this.relativePosition);
        return OpenLayers.Util.removeItem(e, t), e.join(" ")
    }, CLASS_NAME: "OpenLayers.Popup.AnchoredBubble"
}),OpenLayers.Popup.AnchoredBubble.CORNER_SIZE = 5,OpenLayers.Protocol.WFS.v1 = OpenLayers.Class(OpenLayers.Protocol, {
    version: null,
    srsName: "EPSG:4326",
    featureType: null,
    featureNS: null,
    geometryName: "the_geom",
    schema: null,
    featurePrefix: "feature",
    formatOptions: null,
    readFormat: null,
    readOptions: null,
    initialize: function (e) {
        OpenLayers.Protocol.prototype.initialize.apply(this, [e]), e.format || (this.format = OpenLayers.Format.WFST(OpenLayers.Util.extend({
            version: this.version,
            featureType: this.featureType,
            featureNS: this.featureNS,
            featurePrefix: this.featurePrefix,
            geometryName: this.geometryName,
            srsName: this.srsName,
            schema: this.schema
        }, this.formatOptions))), !e.geometryName && 1 < parseFloat(this.format.version) && this.setGeometryName(null)
    },
    destroy: function () {
        this.options && !this.options.format && this.format.destroy(), this.format = null, OpenLayers.Protocol.prototype.destroy.apply(this)
    },
    read: function (e) {
        OpenLayers.Protocol.prototype.read.apply(this, arguments), e = OpenLayers.Util.extend({}, e), OpenLayers.Util.applyDefaults(e, this.options || {});
        var t = new OpenLayers.Protocol.Response({requestType: "read"}), i = OpenLayers.Format.XML.prototype.write.apply(this.format, [this.format.writeNode("wfs:GetFeature", e)]);
        return t.priv = OpenLayers.Request.POST({
            url: e.url,
            callback: this.createCallback(this.handleRead, t, e),
            params: e.params,
            headers: e.headers,
            data: i
        }), t
    },
    setFeatureType: function (e) {
        this.featureType = e, this.format.featureType = e
    },
    setGeometryName: function (e) {
        this.geometryName = e, this.format.geometryName = e
    },
    handleRead: function (e, t) {
        if (t = OpenLayers.Util.extend({}, t), OpenLayers.Util.applyDefaults(t, this.options), t.callback) {
            var i = e.priv;
            200 <= i.status && 300 > i.status ? (i = this.parseResponse(i, t.readOptions)) && !1 !== i.success ? (t.readOptions && "object" == t.readOptions.output ? OpenLayers.Util.extend(e, i) : e.features = i, e.code = OpenLayers.Protocol.Response.SUCCESS) : (e.code = OpenLayers.Protocol.Response.FAILURE, e.error = i) : e.code = OpenLayers.Protocol.Response.FAILURE, t.callback.call(t.scope, e)
        }
    },
    parseResponse: function (e, t) {
        var i = e.responseXML;
        if (i && i.documentElement || (i = e.responseText), !i || 0 >= i.length)return null;
        if (i = null !== this.readFormat ? this.readFormat.read(i) : this.format.read(i, t), !this.featureNS) {
            var n = this.readFormat || this.format;
            this.featureNS = n.featureNS, n.autoConfig = !1, this.geometryName || this.setGeometryName(n.geometryName)
        }
        return i
    },
    commit: function (e, t) {
        t = OpenLayers.Util.extend({}, t), OpenLayers.Util.applyDefaults(t, this.options);
        var i = new OpenLayers.Protocol.Response({requestType: "commit", reqFeatures: e});
        return i.priv = OpenLayers.Request.POST({
            url: t.url,
            headers: t.headers,
            data: this.format.write(e, t),
            callback: this.createCallback(this.handleCommit, i, t)
        }), i
    },
    handleCommit: function (e, t) {
        if (t.callback) {
            var i = e.priv, n = i.responseXML;
            n && n.documentElement || (n = i.responseText), i = this.format.read(n) || {}, e.insertIds = i.insertIds || [], i.success ? e.code = OpenLayers.Protocol.Response.SUCCESS : (e.code = OpenLayers.Protocol.Response.FAILURE, e.error = i), t.callback.call(t.scope, e)
        }
    },
    filterDelete: function (e, t) {
        t = OpenLayers.Util.extend({}, t), OpenLayers.Util.applyDefaults(t, this.options), new OpenLayers.Protocol.Response({requestType: "commit"});
        var i = this.format.createElementNSPlus("wfs:Transaction", {
            attributes: {
                service: "WFS",
                version: this.version
            }
        }), n = this.format.createElementNSPlus("wfs:Delete", {attributes: {typeName: (t.featureNS ? this.featurePrefix + ":" : "") + t.featureType}});
        t.featureNS && n.setAttribute("xmlns:" + this.featurePrefix, t.featureNS);
        var s = this.format.writeNode("ogc:Filter", e);
        return n.appendChild(s), i.appendChild(n), i = OpenLayers.Format.XML.prototype.write.apply(this.format, [i]), OpenLayers.Request.POST({
            url: this.url,
            callback: t.callback || function () {
            },
            data: i
        })
    },
    abort: function (e) {
        e && e.priv.abort()
    },
    CLASS_NAME: "OpenLayers.Protocol.WFS.v1"
}),OpenLayers.Handler.Point = OpenLayers.Class(OpenLayers.Handler, {
    point: null,
    layer: null,
    multi: !1,
    citeCompliant: !1,
    mouseDown: !1,
    stoppedDown: null,
    lastDown: null,
    lastUp: null,
    persist: !1,
    stopDown: !1,
    stopUp: !1,
    layerOptions: null,
    pixelTolerance: 5,
    touch: !1,
    lastTouchPx: null,
    initialize: function (e, t, i) {
        i && i.layerOptions && i.layerOptions.styleMap || (this.style = OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"], {})), OpenLayers.Handler.prototype.initialize.apply(this, arguments)
    },
    activate: function () {
        if (!OpenLayers.Handler.prototype.activate.apply(this, arguments))return !1;
        var e = OpenLayers.Util.extend({
            displayInLayerSwitcher: !1,
            calculateInRange: OpenLayers.Function.True,
            wrapDateLine: this.citeCompliant
        }, this.layerOptions);
        return this.layer = new OpenLayers.Layer.Vector(this.CLASS_NAME, e), this.map.addLayer(this.layer), !0
    },
    createFeature: function (e) {
        e = this.layer.getLonLatFromViewPortPx(e), e = new OpenLayers.Geometry.Point(e.lon, e.lat), this.point = new OpenLayers.Feature.Vector(e), this.callback("create", [this.point.geometry, this.point]), this.point.geometry.clearBounds(), this.layer.addFeatures([this.point], {silent: !0})
    },
    deactivate: function () {
        return OpenLayers.Handler.prototype.deactivate.apply(this, arguments) ? (this.cancel(), null != this.layer.map && (this.destroyFeature(!0), this.layer.destroy(!1)), this.layer = null, this.touch = !1, !0) : !1
    },
    destroyFeature: function (e) {
        this.layer && (e || !this.persist) && this.layer.destroyFeatures(), this.point = null
    },
    destroyPersistedFeature: function () {
        var e = this.layer;
        e && 1 < e.features.length && this.layer.features[0].destroy()
    },
    finalize: function (e) {
        this.mouseDown = !1, this.lastTouchPx = this.lastUp = this.lastDown = null, this.callback(e ? "cancel" : "done", [this.geometryClone()]), this.destroyFeature(e)
    },
    cancel: function () {
        this.finalize(!0)
    },
    click: function (e) {
        return OpenLayers.Event.stop(e), !1
    },
    dblclick: function (e) {
        return OpenLayers.Event.stop(e), !1
    },
    modifyFeature: function (e) {
        this.point || this.createFeature(e), e = this.layer.getLonLatFromViewPortPx(e), this.point.geometry.x = e.lon, this.point.geometry.y = e.lat, this.callback("modify", [this.point.geometry, this.point, !1]), this.point.geometry.clearBounds(), this.drawFeature()
    },
    drawFeature: function () {
        this.layer.drawFeature(this.point, this.style)
    },
    getGeometry: function () {
        var e = this.point && this.point.geometry;
        return e && this.multi && (e = new OpenLayers.Geometry.MultiPoint([e])), e
    },
    geometryClone: function () {
        var e = this.getGeometry();
        return e && e.clone()
    },
    mousedown: function (e) {
        return this.down(e)
    },
    touchstart: function (e) {
        return this.touch || (this.touch = !0, this.map.events.un({
            mousedown: this.mousedown,
            mouseup: this.mouseup,
            mousemove: this.mousemove,
            click: this.click,
            dblclick: this.dblclick,
            scope: this
        })), this.lastTouchPx = e.xy, this.down(e)
    },
    mousemove: function (e) {
        return this.move(e)
    },
    touchmove: function (e) {
        return this.lastTouchPx = e.xy, this.move(e)
    },
    mouseup: function (e) {
        return this.up(e)
    },
    touchend: function (e) {
        return e.xy = this.lastTouchPx, this.up(e)
    },
    down: function (e) {
        return this.mouseDown = !0, this.lastDown = e.xy, this.touch || this.modifyFeature(e.xy), this.stoppedDown = this.stopDown, !this.stopDown
    },
    move: function (e) {
        return !this.touch && (!this.mouseDown || this.stoppedDown) && this.modifyFeature(e.xy), !0
    },
    up: function (e) {
        return this.mouseDown = !1, this.stoppedDown = this.stopDown, !this.checkModifiers(e) || this.lastUp && this.lastUp.equals(e.xy) || !this.lastDown || !this.passesTolerance(this.lastDown, e.xy, this.pixelTolerance) ? !0 : (this.touch && this.modifyFeature(e.xy), this.persist && this.destroyPersistedFeature(), this.lastUp = e.xy, this.finalize(), !this.stopUp)
    },
    mouseout: function (e) {
        OpenLayers.Util.mouseLeft(e, this.map.viewPortDiv) && (this.stoppedDown = this.stopDown, this.mouseDown = !1)
    },
    passesTolerance: function (e, t, i) {
        var n = !0;
        return null != i && e && t && e.distanceTo(t) > i && (n = !1), n
    },
    CLASS_NAME: "OpenLayers.Handler.Point"
}),OpenLayers.Handler.Path = OpenLayers.Class(OpenLayers.Handler.Point, {
    line: null,
    maxVertices: null,
    doubleTouchTolerance: 20,
    freehand: !1,
    freehandToggle: "shiftKey",
    timerId: null,
    redoStack: null,
    createFeature: function (e) {
        e = this.layer.getLonLatFromViewPortPx(e), e = new OpenLayers.Geometry.Point(e.lon, e.lat), this.point = new OpenLayers.Feature.Vector(e), this.line = new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([this.point.geometry])), this.callback("create", [this.point.geometry, this.getSketch()]), this.point.geometry.clearBounds(), this.layer.addFeatures([this.line, this.point], {silent: !0})
    },
    destroyFeature: function (e) {
        OpenLayers.Handler.Point.prototype.destroyFeature.call(this, e), this.line = null
    },
    destroyPersistedFeature: function () {
        var e = this.layer;
        e && 2 < e.features.length && this.layer.features[0].destroy()
    },
    removePoint: function () {
        this.point && this.layer.removeFeatures([this.point])
    },
    addPoint: function (e) {
        this.layer.removeFeatures([this.point]), e = this.layer.getLonLatFromViewPortPx(e), this.point = new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(e.lon, e.lat)), this.line.geometry.addComponent(this.point.geometry, this.line.geometry.components.length), this.layer.addFeatures([this.point]), this.callback("point", [this.point.geometry, this.getGeometry()]), this.callback("modify", [this.point.geometry, this.getSketch()]), this.drawFeature(), delete this.redoStack
    },
    insertXY: function (e, t) {
        this.line.geometry.addComponent(new OpenLayers.Geometry.Point(e, t), this.getCurrentPointIndex()), this.drawFeature(), delete this.redoStack
    },
    insertDeltaXY: function (e, t) {
        var i = this.line.geometry.components[this.getCurrentPointIndex() - 1];
        i && !isNaN(i.x) && !isNaN(i.y) && this.insertXY(i.x + e, i.y + t)
    },
    insertDirectionLength: function (e, t) {
        var e = e * (Math.PI / 180), i = t * Math.cos(e), n = t * Math.sin(e);
        this.insertDeltaXY(i, n)
    },
    insertDeflectionLength: function (e, t) {
        var i = this.getCurrentPointIndex() - 1;
        if (i > 0) {
            var n = this.line.geometry.components[i], i = this.line.geometry.components[i - 1];
            this.insertDirectionLength(180 * Math.atan2(n.y - i.y, n.x - i.x) / Math.PI + e, t)
        }
    },
    getCurrentPointIndex: function () {
        return this.line.geometry.components.length - 1
    },
    undo: function () {
        var e = this.line.geometry, t = e.components, i = this.getCurrentPointIndex() - 1, t = t[i];
        return (e = e.removeComponent(t)) && (this.redoStack || (this.redoStack = []), this.redoStack.push(t), this.drawFeature()), e
    },
    redo: function () {
        var e = this.redoStack && this.redoStack.pop();
        return e && (this.line.geometry.addComponent(e, this.getCurrentPointIndex()), this.drawFeature()), !!e
    },
    freehandMode: function (e) {
        return this.freehandToggle && e[this.freehandToggle] ? !this.freehand : this.freehand
    },
    modifyFeature: function (e, t) {
        this.line || this.createFeature(e);
        var i = this.layer.getLonLatFromViewPortPx(e);
        this.point.geometry.x = i.lon, this.point.geometry.y = i.lat, this.callback("modify", [this.point.geometry, this.getSketch(), t]), this.point.geometry.clearBounds(), this.drawFeature()
    },
    drawFeature: function () {
        this.layer.drawFeature(this.line, this.style), this.layer.drawFeature(this.point, this.style)
    },
    getSketch: function () {
        return this.line
    },
    getGeometry: function () {
        var e = this.line && this.line.geometry;
        return e && this.multi && (e = new OpenLayers.Geometry.MultiLineString([e])), e
    },
    touchstart: function (e) {
        return this.timerId && this.passesTolerance(this.lastTouchPx, e.xy, this.doubleTouchTolerance) ? (this.finishGeometry(), window.clearTimeout(this.timerId), this.timerId = null, !1) : (this.timerId && (window.clearTimeout(this.timerId), this.timerId = null), this.timerId = window.setTimeout(OpenLayers.Function.bind(function () {
            this.timerId = null
        }, this), 300), OpenLayers.Handler.Point.prototype.touchstart.call(this, e))
    },
    down: function (e) {
        var t = this.stopDown;
        return this.freehandMode(e) && (t = !0, this.touch && (this.modifyFeature(e.xy, !!this.lastUp), OpenLayers.Event.stop(e))), !(this.touch || this.lastDown && this.passesTolerance(this.lastDown, e.xy, this.pixelTolerance) || !this.modifyFeature(e.xy, !!this.lastUp)), this.mouseDown = !0, this.lastDown = e.xy, this.stoppedDown = t, !t
    },
    move: function (e) {
        return this.stoppedDown && this.freehandMode(e) ? (this.persist && this.destroyPersistedFeature(), this.maxVertices && this.line && this.line.geometry.components.length === this.maxVertices ? (this.removePoint(), this.finalize()) : this.addPoint(e.xy), !1) : (!this.touch && (!this.mouseDown || this.stoppedDown) && this.modifyFeature(e.xy, !!this.lastUp), !0)
    },
    up: function (e) {
        return !this.mouseDown || this.lastUp && this.lastUp.equals(e.xy) || (this.stoppedDown && this.freehandMode(e) ? (this.persist && this.destroyPersistedFeature(), this.removePoint(), this.finalize()) : this.passesTolerance(this.lastDown, e.xy, this.pixelTolerance) && (this.touch && this.modifyFeature(e.xy), null == this.lastUp && this.persist && this.destroyPersistedFeature(), this.addPoint(e.xy), this.lastUp = e.xy, this.line.geometry.components.length === this.maxVertices + 1 && this.finishGeometry())), this.stoppedDown = this.stopDown, this.mouseDown = !1, !this.stopUp
    },
    finishGeometry: function () {
        this.line.geometry.removeComponent(this.line.geometry.components[this.line.geometry.components.length - 1]), this.removePoint(), this.finalize()
    },
    dblclick: function (e) {
        return this.freehandMode(e) || this.finishGeometry(), !1
    },
    CLASS_NAME: "OpenLayers.Handler.Path"
}),OpenLayers.Spherical = OpenLayers.Spherical || {},OpenLayers.Spherical.DEFAULT_RADIUS = 6378137,OpenLayers.Spherical.computeDistanceBetween = function (e, t, i) {
    var i = i || OpenLayers.Spherical.DEFAULT_RADIUS, n = Math.sin(Math.PI * (t.lon - e.lon) / 360), s = Math.sin(Math.PI * (t.lat - e.lat) / 360), e = s * s + n * n * Math.cos(Math.PI * e.lat / 180) * Math.cos(Math.PI * t.lat / 180);
    return 2 * i * Math.atan2(Math.sqrt(e), Math.sqrt(1 - e))
},OpenLayers.Spherical.computeHeading = function (e, t) {
    var i = Math.sin(Math.PI * (e.lon - t.lon) / 180) * Math.cos(Math.PI * t.lat / 180), n = Math.cos(Math.PI * e.lat / 180) * Math.sin(Math.PI * t.lat / 180) - Math.sin(Math.PI * e.lat / 180) * Math.cos(Math.PI * t.lat / 180) * Math.cos(Math.PI * (e.lon - t.lon) / 180);
    return 180 * Math.atan2(i, n) / Math.PI
},OpenLayers.Control.CacheWrite = OpenLayers.Class(OpenLayers.Control, {
    layers: null,
    imageFormat: "image/png",
    quotaRegEx: /quota/i,
    setMap: function (e) {
        OpenLayers.Control.prototype.setMap.apply(this, arguments);
        var t, i = this.layers || e.layers;
        for (t = i.length - 1; t >= 0; --t)this.addLayer({layer: i[t]});
        this.layers || e.events.on({addlayer: this.addLayer, removeLayer: this.removeLayer, scope: this})
    },
    addLayer: function (e) {
        e.layer.events.on({tileloadstart: this.makeSameOrigin, tileloaded: this.cache, scope: this})
    },
    removeLayer: function (e) {
        e.layer.events.un({tileloadstart: this.makeSameOrigin, tileloaded: this.cache, scope: this})
    },
    makeSameOrigin: function (e) {
        if (this.active && (e = e.tile, e instanceof OpenLayers.Tile.Image && !e.crossOriginKeyword && "data:" !== e.url.substr(0, 5))) {
            var t = OpenLayers.Request.makeSameOrigin(e.url, OpenLayers.ProxyHost);
            OpenLayers.Control.CacheWrite.urlMap[t] = e.url, e.url = t
        }
    },
    cache: function (e) {
        if (this.active && window.localStorage && (e = e.tile, e instanceof OpenLayers.Tile.Image && "data:" !== e.url.substr(0, 5)))try {
            var t = e.getCanvasContext();
            if (t) {
                var i = OpenLayers.Control.CacheWrite.urlMap;
                window.localStorage.setItem("olCache_" + (i[e.url] || e.url), t.canvas.toDataURL(this.imageFormat)), delete i[e.url]
            }
        } catch (n) {
            (t = n.name || n.message) && this.quotaRegEx.test(t) ? this.events.triggerEvent("cachefull", {tile: e}) : OpenLayers.Console.error(n.toString())
        }
    },
    destroy: function () {
        if (this.layers || this.map) {
            var e, t = this.layers || this.map.layers;
            for (e = t.length - 1; e >= 0; --e)this.removeLayer({layer: t[e]})
        }
        this.map && this.map.events.un({
            addlayer: this.addLayer,
            removeLayer: this.removeLayer,
            scope: this
        }), OpenLayers.Control.prototype.destroy.apply(this, arguments)
    },
    CLASS_NAME: "OpenLayers.Control.CacheWrite"
}),OpenLayers.Control.CacheWrite.clearCache = function () {
    if (window.localStorage) {
        var e, t;
        for (e = window.localStorage.length - 1; e >= 0; --e)t = window.localStorage.key(e), "olCache_" === t.substr(0, 8) && window.localStorage.removeItem(t)
    }
},OpenLayers.Control.CacheWrite.urlMap = {},OpenLayers.Format.Context = OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC, {
    layerOptions: null,
    layerParams: null,
    read: function (e, t) {
        var i = OpenLayers.Format.XML.VersionedOGC.prototype.read.apply(this, arguments);
        if (t && t.map)if (this.context = i, t.map instanceof OpenLayers.Map) i = this.mergeContextToMap(i, t.map); else {
            var n = t.map;
            (OpenLayers.Util.isElement(n) || "string" == typeof n) && (n = {div: n}), i = this.contextToMap(i, n)
        }
        return i
    },
    getLayerFromContext: function (e) {
        var t, i, n = {
            queryable: e.queryable,
            visibility: e.visibility,
            maxExtent: e.maxExtent,
            metadata: OpenLayers.Util.applyDefaults(e.metadata, {
                styles: e.styles,
                formats: e.formats,
                "abstract": e["abstract"],
                dataURL: e.dataURL
            }),
            numZoomLevels: e.numZoomLevels,
            units: e.units,
            isBaseLayer: e.isBaseLayer,
            opacity: e.opacity,
            displayInLayerSwitcher: e.displayInLayerSwitcher,
            singleTile: e.singleTile,
            tileSize: e.tileSize ? new OpenLayers.Size(e.tileSize.width, e.tileSize.height) : void 0,
            minScale: e.minScale || e.maxScaleDenominator,
            maxScale: e.maxScale || e.minScaleDenominator,
            srs: e.srs,
            dimensions: e.dimensions,
            metadataURL: e.metadataURL
        };
        this.layerOptions && OpenLayers.Util.applyDefaults(n, this.layerOptions);
        var s = {layers: e.name, transparent: e.transparent, version: e.version};
        if (e.formats && 0 < e.formats.length)for (s.format = e.formats[0].value, t = 0, i = e.formats.length; i > t; t++) {
            var r = e.formats[t];
            if (1 == r.current) {
                s.format = r.value;
                break
            }
        }
        if (e.styles && 0 < e.styles.length)for (t = 0, i = e.styles.length; i > t; t++)if (r = e.styles[t], 1 == r.current) {
            r.href ? s.sld = r.href : r.body ? s.sld_body = r.body : s.styles = r.name;
            break
        }
        return this.layerParams && OpenLayers.Util.applyDefaults(s, this.layerParams), t = null, i = e.service, i == OpenLayers.Format.Context.serviceTypes.WFS ? (n.strategies = [new OpenLayers.Strategy.BBOX], n.protocol = new OpenLayers.Protocol.WFS({
            url: e.url,
            featurePrefix: e.name.split(":")[0],
            featureType: e.name.split(":").pop()
        }), t = new OpenLayers.Layer.Vector(e.title || e.name, n)) : i == OpenLayers.Format.Context.serviceTypes.KML ? (n.strategies = [new OpenLayers.Strategy.Fixed], n.protocol = new OpenLayers.Protocol.HTTP({
            url: e.url,
            format: new OpenLayers.Format.KML
        }), t = new OpenLayers.Layer.Vector(e.title || e.name, n)) : i == OpenLayers.Format.Context.serviceTypes.GML ? (n.strategies = [new OpenLayers.Strategy.Fixed], n.protocol = new OpenLayers.Protocol.HTTP({
            url: e.url,
            format: new OpenLayers.Format.GML
        }), t = new OpenLayers.Layer.Vector(e.title || e.name, n)) : e.features ? (t = new OpenLayers.Layer.Vector(e.title || e.name, n), t.addFeatures(e.features)) : !0 !== e.categoryLayer && (t = new OpenLayers.Layer.WMS(e.title || e.name, e.url, s, n)), t
    },
    getLayersFromContext: function (e) {
        for (var t = [], i = 0, n = e.length; n > i; i++) {
            var s = this.getLayerFromContext(e[i]);
            null !== s && t.push(s)
        }
        return t
    },
    contextToMap: function (e, t) {
        t = OpenLayers.Util.applyDefaults({
            maxExtent: e.maxExtent,
            projection: e.projection,
            units: e.units
        }, t), t.maxExtent && (t.maxResolution = t.maxExtent.getWidth() / OpenLayers.Map.TILE_WIDTH), t.metadata = {
            contactInformation: e.contactInformation,
            "abstract": e["abstract"],
            keywords: e.keywords,
            logo: e.logo,
            descriptionURL: e.descriptionURL
        };
        var i = new OpenLayers.Map(t);
        return i.addLayers(this.getLayersFromContext(e.layersContext)), i.setCenter(e.bounds.getCenterLonLat(), i.getZoomForExtent(e.bounds, !0)), i
    },
    mergeContextToMap: function (e, t) {
        return t.addLayers(this.getLayersFromContext(e.layersContext)), t
    },
    write: function (e) {
        return e = this.toContext(e), OpenLayers.Format.XML.VersionedOGC.prototype.write.apply(this, arguments)
    },
    CLASS_NAME: "OpenLayers.Format.Context"
}),OpenLayers.Format.Context.serviceTypes = {
    WMS: "urn:ogc:serviceType:WMS",
    WFS: "urn:ogc:serviceType:WFS",
    WCS: "urn:ogc:serviceType:WCS",
    GML: "urn:ogc:serviceType:GML",
    SLD: "urn:ogc:serviceType:SLD",
    FES: "urn:ogc:serviceType:FES",
    KML: "urn:ogc:serviceType:KML"
},OpenLayers.Format.WMC = OpenLayers.Class(OpenLayers.Format.Context, {
    defaultVersion: "1.1.0",
    layerToContext: function (e) {
        var t = this.getParser(), i = {
            queryable: e.queryable,
            visibility: e.visibility,
            name: e.params.LAYERS,
            title: e.name,
            "abstract": e.metadata["abstract"],
            dataURL: e.metadata.dataURL,
            metadataURL: e.metadataURL,
            server: {version: e.params.VERSION, url: e.url},
            maxExtent: e.maxExtent,
            transparent: e.params.TRANSPARENT,
            numZoomLevels: e.numZoomLevels,
            units: e.units,
            isBaseLayer: e.isBaseLayer,
            opacity: 1 == e.opacity ? void 0 : e.opacity,
            displayInLayerSwitcher: e.displayInLayerSwitcher,
            singleTile: e.singleTile,
            tileSize: e.singleTile || !e.tileSize ? void 0 : {width: e.tileSize.w, height: e.tileSize.h},
            minScale: e.options.resolutions || e.options.scales || e.options.maxResolution || e.options.minScale ? e.minScale : void 0,
            maxScale: e.options.resolutions || e.options.scales || e.options.minResolution || e.options.maxScale ? e.maxScale : void 0,
            formats: [],
            styles: [],
            srs: e.srs,
            dimensions: e.dimensions
        };
        if (e.metadata.servertitle && (i.server.title = e.metadata.servertitle), e.metadata.formats && 0 < e.metadata.formats.length)for (var n = 0, s = e.metadata.formats.length; s > n; n++) {
            var r = e.metadata.formats[n];
            i.formats.push({value: r.value, current: r.value == e.params.FORMAT})
        } else i.formats.push({value: e.params.FORMAT, current: !0});
        if (e.metadata.styles && 0 < e.metadata.styles.length)for (n = 0, s = e.metadata.styles.length; s > n; n++)t = e.metadata.styles[n], t.current = t.href == e.params.SLD || t.body == e.params.SLD_BODY || t.name == e.params.STYLES ? !0 : !1, i.styles.push(t); else i.styles.push({
            href: e.params.SLD,
            body: e.params.SLD_BODY,
            name: e.params.STYLES || t.defaultStyleName,
            title: t.defaultStyleTitle,
            current: !0
        });
        return i
    },
    toContext: function (e) {
        var t = {}, i = e.layers;
        if ("OpenLayers.Map" == e.CLASS_NAME) {
            var n = e.metadata || {};
            t.size = e.getSize(), t.bounds = e.getExtent(), t.projection = e.projection, t.title = e.title, t.keywords = n.keywords, t["abstract"] = n["abstract"], t.logo = n.logo, t.descriptionURL = n.descriptionURL, t.contactInformation = n.contactInformation, t.maxExtent = e.maxExtent
        } else OpenLayers.Util.applyDefaults(t, e), void 0 != t.layers && delete t.layers;
        if (void 0 == t.layersContext && (t.layersContext = []), void 0 != i && OpenLayers.Util.isArray(i))for (e = 0, n = i.length; n > e; e++) {
            var s = i[e];
            s instanceof OpenLayers.Layer.WMS && t.layersContext.push(this.layerToContext(s))
        }
        return t
    },
    CLASS_NAME: "OpenLayers.Format.WMC"
}),OpenLayers.Format.WMC.v1 = OpenLayers.Class(OpenLayers.Format.XML, {
    namespaces: {
        ol: "http://openlayers.org/context",
        wmc: "http://www.opengis.net/context",
        sld: "http://www.opengis.net/sld",
        xlink: "http://www.w3.org/1999/xlink",
        xsi: "http://www.w3.org/2001/XMLSchema-instance"
    },
    schemaLocation: "",
    getNamespacePrefix: function (e) {
        var t = null;
        if (null == e) t = this.namespaces[this.defaultPrefix]; else for (t in this.namespaces)if (this.namespaces[t] == e)break;
        return t
    },
    defaultPrefix: "wmc",
    rootPrefix: null,
    defaultStyleName: "",
    defaultStyleTitle: "Default",
    initialize: function (e) {
        OpenLayers.Format.XML.prototype.initialize.apply(this, [e])
    },
    read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e])), e = e.documentElement, this.rootPrefix = e.prefix;
        var t = {version: e.getAttribute("version")};
        return this.runChildNodes(t, e), t
    },
    runChildNodes: function (e, t) {
        for (var i, n, s, r = t.childNodes, a = 0, o = r.length; o > a; ++a)i = r[a], 1 == i.nodeType && (n = this.getNamespacePrefix(i.namespaceURI), s = i.nodeName.split(":").pop(), (n = this["read_" + n + "_" + s]) && n.apply(this, [e, i]))
    },
    read_wmc_General: function (e, t) {
        this.runChildNodes(e, t)
    },
    read_wmc_BoundingBox: function (e, t) {
        e.projection = t.getAttribute("SRS"), e.bounds = new OpenLayers.Bounds(t.getAttribute("minx"), t.getAttribute("miny"), t.getAttribute("maxx"), t.getAttribute("maxy"))
    },
    read_wmc_LayerList: function (e, t) {
        e.layersContext = [], this.runChildNodes(e, t)
    },
    read_wmc_Layer: function (e, t) {
        var i = {
            visibility: "1" != t.getAttribute("hidden"),
            queryable: "1" == t.getAttribute("queryable"),
            formats: [],
            styles: [],
            metadata: {}
        };
        this.runChildNodes(i, t), e.layersContext.push(i)
    },
    read_wmc_Extension: function (e, t) {
        this.runChildNodes(e, t)
    },
    read_ol_units: function (e, t) {
        e.units = this.getChildValue(t)
    },
    read_ol_maxExtent: function (e, t) {
        var i = new OpenLayers.Bounds(t.getAttribute("minx"), t.getAttribute("miny"), t.getAttribute("maxx"), t.getAttribute("maxy"));
        e.maxExtent = i
    },
    read_ol_transparent: function (e, t) {
        e.transparent = this.getChildValue(t)
    },
    read_ol_numZoomLevels: function (e, t) {
        e.numZoomLevels = parseInt(this.getChildValue(t))
    },
    read_ol_opacity: function (e, t) {
        e.opacity = parseFloat(this.getChildValue(t))
    },
    read_ol_singleTile: function (e, t) {
        e.singleTile = "true" == this.getChildValue(t)
    },
    read_ol_tileSize: function (e, t) {
        var i = {width: t.getAttribute("width"), height: t.getAttribute("height")};
        e.tileSize = i
    },
    read_ol_isBaseLayer: function (e, t) {
        e.isBaseLayer = "true" == this.getChildValue(t)
    },
    read_ol_displayInLayerSwitcher: function (e, t) {
        e.displayInLayerSwitcher = "true" == this.getChildValue(t)
    },
    read_wmc_Server: function (e, t) {
        e.version = t.getAttribute("version"), e.url = this.getOnlineResource_href(t), e.metadata.servertitle = t.getAttribute("title")
    },
    read_wmc_FormatList: function (e, t) {
        this.runChildNodes(e, t)
    },
    read_wmc_Format: function (e, t) {
        var i = {value: this.getChildValue(t)};
        "1" == t.getAttribute("current") && (i.current = !0), e.formats.push(i)
    },
    read_wmc_StyleList: function (e, t) {
        this.runChildNodes(e, t)
    },
    read_wmc_Style: function (e, t) {
        var i = {};
        this.runChildNodes(i, t), "1" == t.getAttribute("current") && (i.current = !0), e.styles.push(i)
    },
    read_wmc_SLD: function (e, t) {
        this.runChildNodes(e, t)
    },
    read_sld_StyledLayerDescriptor: function (e, t) {
        var i = OpenLayers.Format.XML.prototype.write.apply(this, [t]);
        e.body = i
    },
    read_sld_FeatureTypeStyle: function (e, t) {
        var i = OpenLayers.Format.XML.prototype.write.apply(this, [t]);
        e.body = i
    },
    read_wmc_OnlineResource: function (e, t) {
        e.href = this.getAttributeNS(t, this.namespaces.xlink, "href")
    },
    read_wmc_Name: function (e, t) {
        var i = this.getChildValue(t);
        i && (e.name = i)
    },
    read_wmc_Title: function (e, t) {
        var i = this.getChildValue(t);
        i && (e.title = i)
    },
    read_wmc_MetadataURL: function (e, t) {
        e.metadataURL = this.getOnlineResource_href(t)
    },
    read_wmc_KeywordList: function (e, t) {
        e.keywords = [], this.runChildNodes(e.keywords, t)
    },
    read_wmc_Keyword: function (e, t) {
        e.push(this.getChildValue(t))
    },
    read_wmc_Abstract: function (e, t) {
        var i = this.getChildValue(t);
        i && (e["abstract"] = i)
    },
    read_wmc_LogoURL: function (e, t) {
        e.logo = {
            width: t.getAttribute("width"),
            height: t.getAttribute("height"),
            format: t.getAttribute("format"),
            href: this.getOnlineResource_href(t)
        }
    },
    read_wmc_DescriptionURL: function (e, t) {
        e.descriptionURL = this.getOnlineResource_href(t)
    },
    read_wmc_ContactInformation: function (e, t) {
        var i = {};
        this.runChildNodes(i, t), e.contactInformation = i
    },
    read_wmc_ContactPersonPrimary: function (e, t) {
        var i = {};
        this.runChildNodes(i, t), e.personPrimary = i
    },
    read_wmc_ContactPerson: function (e, t) {
        var i = this.getChildValue(t);
        i && (e.person = i)
    },
    read_wmc_ContactOrganization: function (e, t) {
        var i = this.getChildValue(t);
        i && (e.organization = i)
    },
    read_wmc_ContactPosition: function (e, t) {
        var i = this.getChildValue(t);
        i && (e.position = i)
    },
    read_wmc_ContactAddress: function (e, t) {
        var i = {};
        this.runChildNodes(i, t), e.contactAddress = i
    },
    read_wmc_AddressType: function (e, t) {
        var i = this.getChildValue(t);
        i && (e.type = i)
    },
    read_wmc_Address: function (e, t) {
        var i = this.getChildValue(t);
        i && (e.address = i)
    },
    read_wmc_City: function (e, t) {
        var i = this.getChildValue(t);
        i && (e.city = i)
    },
    read_wmc_StateOrProvince: function (e, t) {
        var i = this.getChildValue(t);
        i && (e.stateOrProvince = i)
    },
    read_wmc_PostCode: function (e, t) {
        var i = this.getChildValue(t);
        i && (e.postcode = i)
    },
    read_wmc_Country: function (e, t) {
        var i = this.getChildValue(t);
        i && (e.country = i)
    },
    read_wmc_ContactVoiceTelephone: function (e, t) {
        var i = this.getChildValue(t);
        i && (e.phone = i)
    },
    read_wmc_ContactFacsimileTelephone: function (e, t) {
        var i = this.getChildValue(t);
        i && (e.fax = i)
    },
    read_wmc_ContactElectronicMailAddress: function (e, t) {
        var i = this.getChildValue(t);
        i && (e.email = i)
    },
    read_wmc_DataURL: function (e, t) {
        e.dataURL = this.getOnlineResource_href(t)
    },
    read_wmc_LegendURL: function (e, t) {
        var i = {
            width: t.getAttribute("width"),
            height: t.getAttribute("height"),
            format: t.getAttribute("format"),
            href: this.getOnlineResource_href(t)
        };
        e.legend = i
    },
    read_wmc_DimensionList: function (e, t) {
        e.dimensions = {}, this.runChildNodes(e.dimensions, t)
    },
    read_wmc_Dimension: function (e, t) {
        var i = {
            name: t.getAttribute("name").toLowerCase(),
            units: t.getAttribute("units") || "",
            unitSymbol: t.getAttribute("unitSymbol") || "",
            userValue: t.getAttribute("userValue") || "",
            nearestValue: "1" === t.getAttribute("nearestValue"),
            multipleValues: "1" === t.getAttribute("multipleValues"),
            current: "1" === t.getAttribute("current"),
            "default": t.getAttribute("default") || ""
        }, n = this.getChildValue(t);
        i.values = n.split(","), e[i.name] = i
    },
    write: function (e, t) {
        var i = this.createElementDefaultNS("ViewContext");
        return this.setAttributes(i, {
            version: this.VERSION,
            id: t && "string" == typeof t.id ? t.id : OpenLayers.Util.createUniqueID("OpenLayers_Context_")
        }), this.setAttributeNS(i, this.namespaces.xsi, "xsi:schemaLocation", this.schemaLocation), i.appendChild(this.write_wmc_General(e)), i.appendChild(this.write_wmc_LayerList(e)), OpenLayers.Format.XML.prototype.write.apply(this, [i])
    },
    createElementDefaultNS: function (e, t, i) {
        return e = this.createElementNS(this.namespaces[this.defaultPrefix], e), t && e.appendChild(this.createTextNode(t)), i && this.setAttributes(e, i), e
    },
    setAttributes: function (e, t) {
        var i, n;
        for (n in t)i = t[n].toString(), i.match(/[A-Z]/) ? this.setAttributeNS(e, null, n, i) : e.setAttribute(n, i)
    },
    write_wmc_General: function (e) {
        var t = this.createElementDefaultNS("General");
        e.size && t.appendChild(this.createElementDefaultNS("Window", null, {width: e.size.w, height: e.size.h}));
        var i = e.bounds;
        return t.appendChild(this.createElementDefaultNS("BoundingBox", null, {
            minx: i.left.toPrecision(18),
            miny: i.bottom.toPrecision(18),
            maxx: i.right.toPrecision(18),
            maxy: i.top.toPrecision(18),
            SRS: e.projection
        })), t.appendChild(this.createElementDefaultNS("Title", e.title)), e.keywords && t.appendChild(this.write_wmc_KeywordList(e.keywords)), e["abstract"] && t.appendChild(this.createElementDefaultNS("Abstract", e["abstract"])), e.logo && t.appendChild(this.write_wmc_URLType("LogoURL", e.logo.href, e.logo)), e.descriptionURL && t.appendChild(this.write_wmc_URLType("DescriptionURL", e.descriptionURL)), e.contactInformation && t.appendChild(this.write_wmc_ContactInformation(e.contactInformation)), t.appendChild(this.write_ol_MapExtension(e)), t
    },
    write_wmc_KeywordList: function (e) {
        for (var t = this.createElementDefaultNS("KeywordList"), i = 0, n = e.length; n > i; i++)t.appendChild(this.createElementDefaultNS("Keyword", e[i]));
        return t
    },
    write_wmc_ContactInformation: function (e) {
        var t = this.createElementDefaultNS("ContactInformation");
        return e.personPrimary && t.appendChild(this.write_wmc_ContactPersonPrimary(e.personPrimary)), e.position && t.appendChild(this.createElementDefaultNS("ContactPosition", e.position)), e.contactAddress && t.appendChild(this.write_wmc_ContactAddress(e.contactAddress)), e.phone && t.appendChild(this.createElementDefaultNS("ContactVoiceTelephone", e.phone)), e.fax && t.appendChild(this.createElementDefaultNS("ContactFacsimileTelephone", e.fax)), e.email && t.appendChild(this.createElementDefaultNS("ContactElectronicMailAddress", e.email)), t
    },
    write_wmc_ContactPersonPrimary: function (e) {
        var t = this.createElementDefaultNS("ContactPersonPrimary");
        return e.person && t.appendChild(this.createElementDefaultNS("ContactPerson", e.person)), e.organization && t.appendChild(this.createElementDefaultNS("ContactOrganization", e.organization)), t
    },
    write_wmc_ContactAddress: function (e) {
        var t = this.createElementDefaultNS("ContactAddress");
        return e.type && t.appendChild(this.createElementDefaultNS("AddressType", e.type)), e.address && t.appendChild(this.createElementDefaultNS("Address", e.address)), e.city && t.appendChild(this.createElementDefaultNS("City", e.city)), e.stateOrProvince && t.appendChild(this.createElementDefaultNS("StateOrProvince", e.stateOrProvince)), e.postcode && t.appendChild(this.createElementDefaultNS("PostCode", e.postcode)), e.country && t.appendChild(this.createElementDefaultNS("Country", e.country)), t
    },
    write_ol_MapExtension: function (e) {
        var t = this.createElementDefaultNS("Extension");
        if (e = e.maxExtent) {
            var i = this.createElementNS(this.namespaces.ol, "ol:maxExtent");
            this.setAttributes(i, {
                minx: e.left.toPrecision(18),
                miny: e.bottom.toPrecision(18),
                maxx: e.right.toPrecision(18),
                maxy: e.top.toPrecision(18)
            }), t.appendChild(i)
        }
        return t
    },
    write_wmc_LayerList: function (e) {
        for (var t = this.createElementDefaultNS("LayerList"), i = 0, n = e.layersContext.length; n > i; ++i)t.appendChild(this.write_wmc_Layer(e.layersContext[i]));
        return t
    },
    write_wmc_Layer: function (e) {
        var t = this.createElementDefaultNS("Layer", null, {
            queryable: e.queryable ? "1" : "0",
            hidden: e.visibility ? "0" : "1"
        });
        return t.appendChild(this.write_wmc_Server(e)), t.appendChild(this.createElementDefaultNS("Name", e.name)), t.appendChild(this.createElementDefaultNS("Title", e.title)), e["abstract"] && t.appendChild(this.createElementDefaultNS("Abstract", e["abstract"])), e.dataURL && t.appendChild(this.write_wmc_URLType("DataURL", e.dataURL)), e.metadataURL && t.appendChild(this.write_wmc_URLType("MetadataURL", e.metadataURL)), t
    },
    write_wmc_LayerExtension: function (e) {
        var t = this.createElementDefaultNS("Extension"), i = e.maxExtent, n = this.createElementNS(this.namespaces.ol, "ol:maxExtent");
        this.setAttributes(n, {
            minx: i.left.toPrecision(18),
            miny: i.bottom.toPrecision(18),
            maxx: i.right.toPrecision(18),
            maxy: i.top.toPrecision(18)
        }), t.appendChild(n), e.tileSize && !e.singleTile && (i = this.createElementNS(this.namespaces.ol, "ol:tileSize"), this.setAttributes(i, e.tileSize), t.appendChild(i));
        for (var i = "transparent numZoomLevels units isBaseLayer opacity displayInLayerSwitcher singleTile".split(" "), s = 0, r = i.length; r > s; ++s)(n = this.createOLPropertyNode(e, i[s])) && t.appendChild(n);
        return t
    },
    createOLPropertyNode: function (e, t) {
        var i = null;
        return null != e[t] && (i = this.createElementNS(this.namespaces.ol, "ol:" + t), i.appendChild(this.createTextNode(e[t].toString()))), i
    },
    write_wmc_Server: function (e) {
        var e = e.server, t = this.createElementDefaultNS("Server"), i = {service: "OGC:WMS", version: e.version};
        return e.title && (i.title = e.title), this.setAttributes(t, i), t.appendChild(this.write_wmc_OnlineResource(e.url)), t
    },
    write_wmc_URLType: function (e, t, i) {
        if (e = this.createElementDefaultNS(e), e.appendChild(this.write_wmc_OnlineResource(t)), i)for (var t = ["width", "height", "format"], n = 0; n < t.length; n++)t[n] in i && e.setAttribute(t[n], i[t[n]]);
        return e
    },
    write_wmc_DimensionList: function (e) {
        var t, i = this.createElementDefaultNS("DimensionList");
        for (t in e.dimensions) {
            var n, s = {}, r = e.dimensions[t];
            for (n in r)s[n] = "boolean" == typeof r[n] ? Number(r[n]) : r[n];
            r = "", s.values && (r = s.values.join(","), delete s.values), i.appendChild(this.createElementDefaultNS("Dimension", r, s))
        }
        return i
    },
    write_wmc_FormatList: function (e) {
        for (var t = this.createElementDefaultNS("FormatList"), i = 0, n = e.formats.length; n > i; i++) {
            var s = e.formats[i];
            t.appendChild(this.createElementDefaultNS("Format", s.value, s.current && 1 == s.current ? {current: "1"} : null))
        }
        return t
    },
    write_wmc_StyleList: function (e) {
        var t = this.createElementDefaultNS("StyleList");
        if ((e = e.styles) && OpenLayers.Util.isArray(e))for (var i, n = 0, s = e.length; s > n; n++) {
            var r = e[n], a = this.createElementDefaultNS("Style", null, r.current && 1 == r.current ? {current: "1"} : null);
            r.href ? (i = this.createElementDefaultNS("SLD"), r.name && i.appendChild(this.createElementDefaultNS("Name", r.name)), r.title && i.appendChild(this.createElementDefaultNS("Title", r.title)), r.legend && i.appendChild(this.write_wmc_URLType("LegendURL", r.legend.href, r.legend)), r = this.write_wmc_OnlineResource(r.href), i.appendChild(r), a.appendChild(i)) : r.body ? (i = this.createElementDefaultNS("SLD"), r.name && i.appendChild(this.createElementDefaultNS("Name", r.name)), r.title && i.appendChild(this.createElementDefaultNS("Title", r.title)), r.legend && i.appendChild(this.write_wmc_URLType("LegendURL", r.legend.href, r.legend)), r = OpenLayers.Format.XML.prototype.read.apply(this, [r.body]).documentElement, i.ownerDocument && i.ownerDocument.importNode && (r = i.ownerDocument.importNode(r, !0)), i.appendChild(r), a.appendChild(i)) : (a.appendChild(this.createElementDefaultNS("Name", r.name)), a.appendChild(this.createElementDefaultNS("Title", r.title)), r["abstract"] && a.appendChild(this.createElementDefaultNS("Abstract", r["abstract"])), r.legend && a.appendChild(this.write_wmc_URLType("LegendURL", r.legend.href, r.legend))), t.appendChild(a)
        }
        return t
    },
    write_wmc_OnlineResource: function (e) {
        var t = this.createElementDefaultNS("OnlineResource");
        return this.setAttributeNS(t, this.namespaces.xlink, "xlink:type", "simple"), this.setAttributeNS(t, this.namespaces.xlink, "xlink:href", e), t
    },
    getOnlineResource_href: function (e) {
        var t = {}, e = e.getElementsByTagName("OnlineResource");
        return 0 < e.length && this.read_wmc_OnlineResource(t, e[0]), t.href
    },
    CLASS_NAME: "OpenLayers.Format.WMC.v1"
}),OpenLayers.Control.PanPanel = OpenLayers.Class(OpenLayers.Control.Panel, {
    slideFactor: 50,
    slideRatio: null,
    initialize: function (e) {
        OpenLayers.Control.Panel.prototype.initialize.apply(this, [e]), e = {
            slideFactor: this.slideFactor,
            slideRatio: this.slideRatio
        }, this.addControls([new OpenLayers.Control.Pan(OpenLayers.Control.Pan.NORTH, e), new OpenLayers.Control.Pan(OpenLayers.Control.Pan.SOUTH, e), new OpenLayers.Control.Pan(OpenLayers.Control.Pan.EAST, e), new OpenLayers.Control.Pan(OpenLayers.Control.Pan.WEST, e)])
    },
    CLASS_NAME: "OpenLayers.Control.PanPanel"
}),OpenLayers.Control.Attribution = OpenLayers.Class(OpenLayers.Control, {
    separator: ", ",
    template: "${layers}",
    destroy: function () {
        this.map.events.un({
            removelayer: this.updateAttribution,
            addlayer: this.updateAttribution,
            changelayer: this.updateAttribution,
            changebaselayer: this.updateAttribution,
            scope: this
        }), OpenLayers.Control.prototype.destroy.apply(this, arguments)
    },
    draw: function () {
        return OpenLayers.Control.prototype.draw.apply(this, arguments), this.map.events.on({
            changebaselayer: this.updateAttribution,
            changelayer: this.updateAttribution,
            addlayer: this.updateAttribution,
            removelayer: this.updateAttribution,
            scope: this
        }), this.updateAttribution(), this.div
    },
    updateAttribution: function () {
        var e = [];
        if (this.map && this.map.layers) {
            for (var t = 0, i = this.map.layers.length; i > t; t++) {
                var n = this.map.layers[t];
                n.attribution && n.getVisibility() && -1 === OpenLayers.Util.indexOf(e, n.attribution) && e.push(n.attribution)
            }
            this.div.innerHTML = OpenLayers.String.format(this.template, {layers: e.join(this.separator)})
        }
    },
    CLASS_NAME: "OpenLayers.Control.Attribution"
}),OpenLayers.Kinetic = OpenLayers.Class({
    threshold: 0,
    deceleration: .0035,
    nbPoints: 100,
    delay: 200,
    points: void 0,
    timerId: void 0,
    initialize: function (e) {
        OpenLayers.Util.extend(this, e)
    },
    begin: function () {
        OpenLayers.Animation.stop(this.timerId), this.timerId = void 0, this.points = []
    },
    update: function (e) {
        this.points.unshift({
            xy: e,
            tick: (new Date).getTime()
        }), this.points.length > this.nbPoints && this.points.pop()
    },
    end: function (e) {
        for (var t, i, n = (new Date).getTime(), s = 0, r = this.points.length; r > s && (i = this.points[s], !(n - i.tick > this.delay)); s++)t = i;
        return !t || (s = (new Date).getTime() - t.tick, n = Math.sqrt(Math.pow(e.x - t.xy.x, 2) + Math.pow(e.y - t.xy.y, 2)), s = n / s, 0 == s || s < this.threshold) ? void 0 : (n = Math.asin((e.y - t.xy.y) / n), t.xy.x <= e.x && (n = Math.PI - n), {
            speed: s,
            theta: n
        })
    },
    move: function (e, t) {
        var i = e.speed, n = Math.cos(e.theta), s = -Math.sin(e.theta), r = (new Date).getTime(), a = 0, o = 0;
        this.timerId = OpenLayers.Animation.start(OpenLayers.Function.bind(function () {
            if (null != this.timerId) {
                var e, l, h = (new Date).getTime() - r, u = -this.deceleration * Math.pow(h, 2) / 2 + i * h, c = u * n, u = u * s;
                e = !1, 0 >= -this.deceleration * h + i && (OpenLayers.Animation.stop(this.timerId), this.timerId = null, e = !0), h = c - a, l = u - o, a = c, o = u, t(h, l, e)
            }
        }, this))
    },
    CLASS_NAME: "OpenLayers.Kinetic"
}),OpenLayers.Layer.GeoRSS = OpenLayers.Class(OpenLayers.Layer.Markers, {
    location: null,
    features: null,
    formatOptions: null,
    selectedFeature: null,
    icon: null,
    popupSize: null,
    useFeedTitle: !0,
    initialize: function (e, t, i) {
        OpenLayers.Layer.Markers.prototype.initialize.apply(this, [e, i]), this.location = t, this.features = []
    },
    destroy: function () {
        OpenLayers.Layer.Markers.prototype.destroy.apply(this, arguments), this.clearFeatures(), this.features = null
    },
    loadRSS: function () {
        this.loaded || (this.events.triggerEvent("loadstart"), OpenLayers.Request.GET({
            url: this.location,
            success: this.parseData,
            scope: this
        }), this.loaded = !0)
    },
    moveTo: function () {
        OpenLayers.Layer.Markers.prototype.moveTo.apply(this, arguments), this.visibility && !this.loaded && this.loadRSS()
    },
    parseData: function (e) {
        var t = e.responseXML;
        if (t && t.documentElement || (t = OpenLayers.Format.XML.prototype.read(e.responseText)), this.useFeedTitle) {
            e = null;
            try {
                e = t.getElementsByTagNameNS("*", "title")[0].firstChild.nodeValue
            } catch (i) {
                e = t.getElementsByTagName("title")[0].firstChild.nodeValue
            }
            e && this.setName(e)
        }
        e = {}, OpenLayers.Util.extend(e, this.formatOptions), this.map && !this.projection.equals(this.map.getProjectionObject()) && (e.externalProjection = this.projection, e.internalProjection = this.map.getProjectionObject());
        for (var t = new OpenLayers.Format.GeoRSS(e).read(t), e = 0, n = t.length; n > e; e++) {
            var s = {}, r = t[e];
            if (r.geometry) {
                var a = r.attributes.title ? r.attributes.title : "Untitled", o = r.attributes.description ? r.attributes.description : "No description.", l = r.attributes.link ? r.attributes.link : "", r = r.geometry.getBounds().getCenterLonLat();
                if (s.icon = null == this.icon ? OpenLayers.Marker.defaultIcon() : this.icon.clone(), s.popupSize = this.popupSize ? this.popupSize.clone() : new OpenLayers.Size(250, 120), a || o) {
                    s.title = a, s.description = o;
                    var h = '<div class="olLayerGeoRSSClose">[x]</div>', h = h + '<div class="olLayerGeoRSSTitle">';
                    l && (h += '<a class="link" href="' + l + '" target="_blank">'), h += a, l && (h += "</a>"), h += "</div>", h += '<div style="" class="olLayerGeoRSSDescription">', h += o, h += "</div>", s.popupContentHTML = h
                }
                r = new OpenLayers.Feature(this, r, s), this.features.push(r), s = r.createMarker(), s.events.register("click", r, this.markerClick), this.addMarker(s)
            }
        }
        this.events.triggerEvent("loadend")
    },
    markerClick: function (e) {
        var t = this == this.layer.selectedFeature;
        this.layer.selectedFeature = t ? null : this;
        for (var i = 0, n = this.layer.map.popups.length; n > i; i++)this.layer.map.removePopup(this.layer.map.popups[i]);
        t || (t = this.createPopup(), OpenLayers.Event.observe(t.div, "click", OpenLayers.Function.bind(function () {
            for (var e = 0, t = this.layer.map.popups.length; t > e; e++)this.layer.map.removePopup(this.layer.map.popups[e])
        }, this)), this.layer.map.addPopup(t)), OpenLayers.Event.stop(e)
    },
    clearFeatures: function () {
        if (null != this.features)for (; 0 < this.features.length;) {
            var e = this.features[0];
            OpenLayers.Util.removeItem(this.features, e), e.destroy()
        }
    },
    CLASS_NAME: "OpenLayers.Layer.GeoRSS"
}),OpenLayers.Symbolizer.Point = OpenLayers.Class(OpenLayers.Symbolizer, {
    initialize: function () {
        OpenLayers.Symbolizer.prototype.initialize.apply(this, arguments)
    }, CLASS_NAME: "OpenLayers.Symbolizer.Point"
}),OpenLayers.Symbolizer.Line = OpenLayers.Class(OpenLayers.Symbolizer, {
    initialize: function () {
        OpenLayers.Symbolizer.prototype.initialize.apply(this, arguments)
    }, CLASS_NAME: "OpenLayers.Symbolizer.Line"
}),OpenLayers.Symbolizer.Text = OpenLayers.Class(OpenLayers.Symbolizer, {
    initialize: function () {
        OpenLayers.Symbolizer.prototype.initialize.apply(this, arguments)
    }, CLASS_NAME: "OpenLayers.Symbolizer.Text"
}),OpenLayers.Format.SLD.v1 = OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0, {
    namespaces: {
        sld: "http://www.opengis.net/sld",
        ogc: "http://www.opengis.net/ogc",
        gml: "http://www.opengis.net/gml",
        xlink: "http://www.w3.org/1999/xlink",
        xsi: "http://www.w3.org/2001/XMLSchema-instance"
    },
    defaultPrefix: "sld",
    schemaLocation: null,
    multipleSymbolizers: !1,
    featureTypeCounter: null,
    defaultSymbolizer: {
        fillColor: "#808080",
        fillOpacity: 1,
        strokeColor: "#000000",
        strokeOpacity: 1,
        strokeWidth: 1,
        strokeDashstyle: "solid",
        pointRadius: 3,
        graphicName: "square"
    },
    read: function (e, t) {
        var t = OpenLayers.Util.applyDefaults(t, this.options), i = {namedLayers: !0 === t.namedLayersAsArray ? [] : {}};
        return this.readChildNodes(e, i), i
    },
    readers: OpenLayers.Util.applyDefaults({
        sld: {
            StyledLayerDescriptor: function (e, t) {
                t.version = e.getAttribute("version"), this.readChildNodes(e, t)
            }, Name: function (e, t) {
                t.name = this.getChildValue(e)
            }, Title: function (e, t) {
                t.title = this.getChildValue(e)
            }, Abstract: function (e, t) {
                t.description = this.getChildValue(e)
            }, NamedLayer: function (e, t) {
                var i = {userStyles: [], namedStyles: []};
                this.readChildNodes(e, i);
                for (var n = 0, s = i.userStyles.length; s > n; ++n)i.userStyles[n].layerName = i.name;
                OpenLayers.Util.isArray(t.namedLayers) ? t.namedLayers.push(i) : t.namedLayers[i.name] = i
            }, NamedStyle: function (e, t) {
                t.namedStyles.push(this.getChildName(e.firstChild))
            }, UserStyle: function (e, t) {
                var i = {defaultsPerSymbolizer: !0, rules: []};
                this.featureTypeCounter = -1, this.readChildNodes(e, i), this.multipleSymbolizers ? (delete i.defaultsPerSymbolizer, i = new OpenLayers.Style2(i)) : i = new OpenLayers.Style(this.defaultSymbolizer, i), t.userStyles.push(i)
            }, IsDefault: function (e, t) {
                "1" == this.getChildValue(e) && (t.isDefault = !0)
            }, FeatureTypeStyle: function (e, t) {
                ++this.featureTypeCounter;
                var i = {rules: this.multipleSymbolizers ? t.rules : []};
                this.readChildNodes(e, i), this.multipleSymbolizers || (t.rules = i.rules)
            }, Rule: function (e, t) {
                var i;
                this.multipleSymbolizers && (i = {symbolizers: []}), i = new OpenLayers.Rule(i), this.readChildNodes(e, i), t.rules.push(i)
            }, ElseFilter: function (e, t) {
                t.elseFilter = !0
            }, MinScaleDenominator: function (e, t) {
                t.minScaleDenominator = parseFloat(this.getChildValue(e))
            }, MaxScaleDenominator: function (e, t) {
                t.maxScaleDenominator = parseFloat(this.getChildValue(e))
            }, TextSymbolizer: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), this.multipleSymbolizers ? (i.zIndex = this.featureTypeCounter, t.symbolizers.push(new OpenLayers.Symbolizer.Text(i))) : t.symbolizer.Text = OpenLayers.Util.applyDefaults(i, t.symbolizer.Text)
            }, LabelPlacement: function (e, t) {
                this.readChildNodes(e, t)
            }, PointPlacement: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), i.labelRotation = i.rotation, delete i.rotation;
                var n, s = t.labelAnchorPointX, r = t.labelAnchorPointY;
                1 / 3 >= s ? n = "l" : s > 1 / 3 && 2 / 3 > s ? n = "c" : s >= 2 / 3 && (n = "r"), 1 / 3 >= r ? n += "b" : r > 1 / 3 && 2 / 3 > r ? n += "m" : r >= 2 / 3 && (n += "t"), i.labelAlign = n, OpenLayers.Util.applyDefaults(t, i)
            }, AnchorPoint: function (e, t) {
                this.readChildNodes(e, t)
            }, AnchorPointX: function (e, t) {
                var i = this.readers.ogc._expression.call(this, e);
                i && (t.labelAnchorPointX = i)
            }, AnchorPointY: function (e, t) {
                var i = this.readers.ogc._expression.call(this, e);
                i && (t.labelAnchorPointY = i)
            }, Displacement: function (e, t) {
                this.readChildNodes(e, t)
            }, DisplacementX: function (e, t) {
                var i = this.readers.ogc._expression.call(this, e);
                i && (t.labelXOffset = i)
            }, DisplacementY: function (e, t) {
                var i = this.readers.ogc._expression.call(this, e);
                i && (t.labelYOffset = i)
            }, LinePlacement: function (e, t) {
                this.readChildNodes(e, t)
            }, PerpendicularOffset: function (e, t) {
                var i = this.readers.ogc._expression.call(this, e);
                i && (t.labelPerpendicularOffset = i)
            }, Label: function (e, t) {
                var i = this.readers.ogc._expression.call(this, e);
                i && (t.label = i)
            }, Font: function (e, t) {
                this.readChildNodes(e, t)
            }, Halo: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), t.haloRadius = i.haloRadius, t.haloColor = i.fillColor, t.haloOpacity = i.fillOpacity
            }, Radius: function (e, t) {
                var i = this.readers.ogc._expression.call(this, e);
                null != i && (t.haloRadius = i)
            }, RasterSymbolizer: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), this.multipleSymbolizers ? (i.zIndex = this.featureTypeCounter, t.symbolizers.push(new OpenLayers.Symbolizer.Raster(i))) : t.symbolizer.Raster = OpenLayers.Util.applyDefaults(i, t.symbolizer.Raster)
            }, Geometry: function (e, t) {
                t.geometry = {}, this.readChildNodes(e, t.geometry)
            }, ColorMap: function (e, t) {
                t.colorMap = [], this.readChildNodes(e, t.colorMap)
            }, ColorMapEntry: function (e, t) {
                var i = e.getAttribute("quantity"), n = e.getAttribute("opacity");
                t.push({
                    color: e.getAttribute("color"),
                    quantity: null !== i ? parseFloat(i) : void 0,
                    label: e.getAttribute("label") || void 0,
                    opacity: null !== n ? parseFloat(n) : void 0
                })
            }, LineSymbolizer: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), this.multipleSymbolizers ? (i.zIndex = this.featureTypeCounter, t.symbolizers.push(new OpenLayers.Symbolizer.Line(i))) : t.symbolizer.Line = OpenLayers.Util.applyDefaults(i, t.symbolizer.Line)
            }, PolygonSymbolizer: function (e, t) {
                var i = {fill: !1, stroke: !1};
                this.multipleSymbolizers || (i = t.symbolizer.Polygon || i), this.readChildNodes(e, i), this.multipleSymbolizers ? (i.zIndex = this.featureTypeCounter, t.symbolizers.push(new OpenLayers.Symbolizer.Polygon(i))) : t.symbolizer.Polygon = i
            }, PointSymbolizer: function (e, t) {
                var i = {fill: !1, stroke: !1, graphic: !1};
                this.multipleSymbolizers || (i = t.symbolizer.Point || i), this.readChildNodes(e, i), this.multipleSymbolizers ? (i.zIndex = this.featureTypeCounter, t.symbolizers.push(new OpenLayers.Symbolizer.Point(i))) : t.symbolizer.Point = i
            }, Stroke: function (e, t) {
                t.stroke = !0, this.readChildNodes(e, t)
            }, Fill: function (e, t) {
                t.fill = !0, this.readChildNodes(e, t)
            }, CssParameter: function (e, t) {
                var i = e.getAttribute("name"), n = this.cssMap[i];
                t.label && ("fill" === i ? n = "fontColor" : "fill-opacity" === i && (n = "fontOpacity")), n && (i = this.readers.ogc._expression.call(this, e)) && (t[n] = i)
            }, Graphic: function (e, t) {
                t.graphic = !0;
                var i = {};
                this.readChildNodes(e, i);
                for (var n, s, r = "stroke strokeColor strokeWidth strokeOpacity strokeLinecap fill fillColor fillOpacity graphicName rotation graphicFormat".split(" "), a = 0, o = r.length; o > a; ++a)n = r[a], s = i[n], void 0 != s && (t[n] = s);
                void 0 != i.opacity && (t.graphicOpacity = i.opacity), void 0 != i.size && (isNaN(i.size / 2) ? t.graphicWidth = i.size : t.pointRadius = i.size / 2), void 0 != i.href && (t.externalGraphic = i.href), void 0 != i.rotation && (t.rotation = i.rotation)
            }, ExternalGraphic: function (e, t) {
                this.readChildNodes(e, t)
            }, Mark: function (e, t) {
                this.readChildNodes(e, t)
            }, WellKnownName: function (e, t) {
                t.graphicName = this.getChildValue(e)
            }, Opacity: function (e, t) {
                var i = this.readers.ogc._expression.call(this, e);
                i && (t.opacity = i)
            }, Size: function (e, t) {
                var i = this.readers.ogc._expression.call(this, e);
                i && (t.size = i)
            }, Rotation: function (e, t) {
                var i = this.readers.ogc._expression.call(this, e);
                i && (t.rotation = i)
            }, OnlineResource: function (e, t) {
                t.href = this.getAttributeNS(e, this.namespaces.xlink, "href")
            }, Format: function (e, t) {
                t.graphicFormat = this.getChildValue(e)
            }
        }
    }, OpenLayers.Format.Filter.v1_0_0.prototype.readers),
    cssMap: {
        stroke: "strokeColor",
        "stroke-opacity": "strokeOpacity",
        "stroke-width": "strokeWidth",
        "stroke-linecap": "strokeLinecap",
        "stroke-dasharray": "strokeDashstyle",
        fill: "fillColor",
        "fill-opacity": "fillOpacity",
        "font-family": "fontFamily",
        "font-size": "fontSize",
        "font-weight": "fontWeight",
        "font-style": "fontStyle"
    },
    getCssProperty: function (e) {
        var t, i = null;
        for (t in this.cssMap)if (this.cssMap[t] == e) {
            i = t;
            break
        }
        return i
    },
    getGraphicFormat: function (e) {
        var t, i;
        for (i in this.graphicFormats)if (this.graphicFormats[i].test(e)) {
            t = i;
            break
        }
        return t || this.defaultGraphicFormat
    },
    defaultGraphicFormat: "image/png",
    graphicFormats: {"image/jpeg": /\.jpe?g$/i, "image/gif": /\.gif$/i, "image/png": /\.png$/i},
    write: function (e) {
        return this.writers.sld.StyledLayerDescriptor.apply(this, [e])
    },
    writers: OpenLayers.Util.applyDefaults({
        sld: {
            _OGCExpression: function (e, t) {
                var i = this.createElementNSPlus(e), n = "string" == typeof t ? t.split("${") : [t];
                i.appendChild(this.createTextNode(n[0]));
                for (var s, r, a = 1, o = n.length; o > a; a++)s = n[a], r = s.indexOf("}"), r > 0 ? (this.writeNode("ogc:PropertyName", {property: s.substring(0, r)}, i), i.appendChild(this.createTextNode(s.substring(++r)))) : i.appendChild(this.createTextNode("${" + s));
                return i
            }, StyledLayerDescriptor: function (e) {
                var t = this.createElementNSPlus("sld:StyledLayerDescriptor", {
                    attributes: {
                        version: this.VERSION,
                        "xsi:schemaLocation": this.schemaLocation
                    }
                });
                if (t.setAttribute("xmlns:ogc", this.namespaces.ogc), t.setAttribute("xmlns:gml", this.namespaces.gml), e.name && this.writeNode("Name", e.name, t), e.title && this.writeNode("Title", e.title, t), e.description && this.writeNode("Abstract", e.description, t), OpenLayers.Util.isArray(e.namedLayers))for (var i = 0, n = e.namedLayers.length; n > i; ++i)this.writeNode("NamedLayer", e.namedLayers[i], t); else for (i in e.namedLayers)this.writeNode("NamedLayer", e.namedLayers[i], t);
                return t
            }, Name: function (e) {
                return this.createElementNSPlus("sld:Name", {value: e})
            }, Title: function (e) {
                return this.createElementNSPlus("sld:Title", {value: e})
            }, Abstract: function (e) {
                return this.createElementNSPlus("sld:Abstract", {value: e})
            }, NamedLayer: function (e) {
                var t = this.createElementNSPlus("sld:NamedLayer");
                if (this.writeNode("Name", e.name, t), e.namedStyles)for (var i = 0, n = e.namedStyles.length; n > i; ++i)this.writeNode("NamedStyle", e.namedStyles[i], t);
                if (e.userStyles)for (i = 0, n = e.userStyles.length; n > i; ++i)this.writeNode("UserStyle", e.userStyles[i], t);
                return t
            }, NamedStyle: function (e) {
                var t = this.createElementNSPlus("sld:NamedStyle");
                return this.writeNode("Name", e, t), t
            }, UserStyle: function (e) {
                var t = this.createElementNSPlus("sld:UserStyle");
                if (e.name && this.writeNode("Name", e.name, t), e.title && this.writeNode("Title", e.title, t), e.description && this.writeNode("Abstract", e.description, t), e.isDefault && this.writeNode("IsDefault", e.isDefault, t), this.multipleSymbolizers && e.rules) {
                    for (var i, n, s, r, a, o = {0: []}, l = [0], h = 0, u = e.rules.length; u > h; ++h)if (i = e.rules[h], i.symbolizers) {
                        n = {};
                        for (var c = 0, p = i.symbolizers.length; p > c; ++c)s = i.symbolizers[c], r = s.zIndex, r in n || (a = i.clone(), a.symbolizers = [], n[r] = a), n[r].symbolizers.push(s.clone());
                        for (r in n)r in o || (l.push(r), o[r] = []), o[r].push(n[r])
                    } else o[0].push(i.clone());
                    for (l.sort(), h = 0, u = l.length; u > h; ++h)i = o[l[h]], 0 < i.length && (a = e.clone(), a.rules = o[l[h]], this.writeNode("FeatureTypeStyle", a, t))
                } else this.writeNode("FeatureTypeStyle", e, t);
                return t
            }, IsDefault: function (e) {
                return this.createElementNSPlus("sld:IsDefault", {value: e ? "1" : "0"})
            }, FeatureTypeStyle: function (e) {
                for (var t = this.createElementNSPlus("sld:FeatureTypeStyle"), i = 0, n = e.rules.length; n > i; ++i)this.writeNode("Rule", e.rules[i], t);
                return t
            }, Rule: function (e) {
                var t = this.createElementNSPlus("sld:Rule");
                e.name && this.writeNode("Name", e.name, t), e.title && this.writeNode("Title", e.title, t), e.description && this.writeNode("Abstract", e.description, t), e.elseFilter ? this.writeNode("ElseFilter", null, t) : e.filter && this.writeNode("ogc:Filter", e.filter, t), void 0 != e.minScaleDenominator && this.writeNode("MinScaleDenominator", e.minScaleDenominator, t), void 0 != e.maxScaleDenominator && this.writeNode("MaxScaleDenominator", e.maxScaleDenominator, t);
                var i, n;
                if (this.multipleSymbolizers && e.symbolizers)for (var s = 0, r = e.symbolizers.length; r > s; ++s)n = e.symbolizers[s], i = n.CLASS_NAME.split(".").pop(), this.writeNode(i + "Symbolizer", n, t); else for (var r = OpenLayers.Style.SYMBOLIZER_PREFIXES, s = 0, a = r.length; a > s; ++s)i = r[s], (n = e.symbolizer[i]) && this.writeNode(i + "Symbolizer", n, t);
                return t
            }, ElseFilter: function () {
                return this.createElementNSPlus("sld:ElseFilter")
            }, MinScaleDenominator: function (e) {
                return this.createElementNSPlus("sld:MinScaleDenominator", {value: e})
            }, MaxScaleDenominator: function (e) {
                return this.createElementNSPlus("sld:MaxScaleDenominator", {value: e})
            }, LineSymbolizer: function (e) {
                var t = this.createElementNSPlus("sld:LineSymbolizer");
                return this.writeNode("Stroke", e, t), t
            }, Stroke: function (e) {
                var t = this.createElementNSPlus("sld:Stroke");
                return void 0 != e.strokeColor && this.writeNode("CssParameter", {
                    symbolizer: e,
                    key: "strokeColor"
                }, t), void 0 != e.strokeOpacity && this.writeNode("CssParameter", {
                    symbolizer: e,
                    key: "strokeOpacity"
                }, t), void 0 != e.strokeWidth && this.writeNode("CssParameter", {
                    symbolizer: e,
                    key: "strokeWidth"
                }, t), void 0 != e.strokeDashstyle && "solid" !== e.strokeDashstyle && this.writeNode("CssParameter", {
                    symbolizer: e,
                    key: "strokeDashstyle"
                }, t), void 0 != e.strokeLinecap && this.writeNode("CssParameter", {
                    symbolizer: e,
                    key: "strokeLinecap"
                }, t), t
            }, CssParameter: function (e) {
                return this.createElementNSPlus("sld:CssParameter", {
                    attributes: {name: this.getCssProperty(e.key)},
                    value: e.symbolizer[e.key]
                })
            }, TextSymbolizer: function (e) {
                var t = this.createElementNSPlus("sld:TextSymbolizer");
                return null != e.label && this.writeNode("Label", e.label, t), (null != e.fontFamily || null != e.fontSize || null != e.fontWeight || null != e.fontStyle) && this.writeNode("Font", e, t), (null != e.labelAnchorPointX || null != e.labelAnchorPointY || null != e.labelAlign || null != e.labelXOffset || null != e.labelYOffset || null != e.labelRotation || null != e.labelPerpendicularOffset) && this.writeNode("LabelPlacement", e, t), (null != e.haloRadius || null != e.haloColor || null != e.haloOpacity) && this.writeNode("Halo", e, t), (null != e.fontColor || null != e.fontOpacity) && this.writeNode("Fill", {
                    fillColor: e.fontColor,
                    fillOpacity: e.fontOpacity
                }, t), t
            }, LabelPlacement: function (e) {
                var t = this.createElementNSPlus("sld:LabelPlacement");
                return (null != e.labelAnchorPointX || null != e.labelAnchorPointY || null != e.labelAlign || null != e.labelXOffset || null != e.labelYOffset || null != e.labelRotation) && null == e.labelPerpendicularOffset && this.writeNode("PointPlacement", e, t), null != e.labelPerpendicularOffset && this.writeNode("LinePlacement", e, t), t
            }, LinePlacement: function (e) {
                var t = this.createElementNSPlus("sld:LinePlacement");
                return this.writeNode("PerpendicularOffset", e.labelPerpendicularOffset, t), t
            }, PerpendicularOffset: function (e) {
                return this.createElementNSPlus("sld:PerpendicularOffset", {value: e})
            }, PointPlacement: function (e) {
                var t = this.createElementNSPlus("sld:PointPlacement");
                return (null != e.labelAnchorPointX || null != e.labelAnchorPointY || null != e.labelAlign) && this.writeNode("AnchorPoint", e, t), (null != e.labelXOffset || null != e.labelYOffset) && this.writeNode("Displacement", e, t), null != e.labelRotation && this.writeNode("Rotation", e.labelRotation, t), t
            }, AnchorPoint: function (e) {
                var t = this.createElementNSPlus("sld:AnchorPoint"), i = e.labelAnchorPointX, n = e.labelAnchorPointY;
                if (null != i && this.writeNode("AnchorPointX", i, t), null != n && this.writeNode("AnchorPointY", n, t), null == i && null == n) {
                    var s = e.labelAlign.substr(0, 1), e = e.labelAlign.substr(1, 1);
                    "l" === s ? i = 0 : "c" === s ? i = .5 : "r" === s && (i = 1), "b" === e ? n = 0 : "m" === e ? n = .5 : "t" === e && (n = 1), this.writeNode("AnchorPointX", i, t), this.writeNode("AnchorPointY", n, t)
                }
                return t
            }, AnchorPointX: function (e) {
                return this.createElementNSPlus("sld:AnchorPointX", {value: e})
            }, AnchorPointY: function (e) {
                return this.createElementNSPlus("sld:AnchorPointY", {value: e})
            }, Displacement: function (e) {
                var t = this.createElementNSPlus("sld:Displacement");
                return null != e.labelXOffset && this.writeNode("DisplacementX", e.labelXOffset, t), null != e.labelYOffset && this.writeNode("DisplacementY", e.labelYOffset, t), t
            }, DisplacementX: function (e) {
                return this.createElementNSPlus("sld:DisplacementX", {value: e})
            }, DisplacementY: function (e) {
                return this.createElementNSPlus("sld:DisplacementY", {value: e})
            }, Font: function (e) {
                var t = this.createElementNSPlus("sld:Font");
                return e.fontFamily && this.writeNode("CssParameter", {
                    symbolizer: e,
                    key: "fontFamily"
                }, t), e.fontSize && this.writeNode("CssParameter", {
                    symbolizer: e,
                    key: "fontSize"
                }, t), e.fontWeight && this.writeNode("CssParameter", {
                    symbolizer: e,
                    key: "fontWeight"
                }, t), e.fontStyle && this.writeNode("CssParameter", {symbolizer: e, key: "fontStyle"}, t), t
            }, Label: function (e) {
                return this.writers.sld._OGCExpression.call(this, "sld:Label", e)
            }, Halo: function (e) {
                var t = this.createElementNSPlus("sld:Halo");
                return e.haloRadius && this.writeNode("Radius", e.haloRadius, t), (e.haloColor || e.haloOpacity) && this.writeNode("Fill", {
                    fillColor: e.haloColor,
                    fillOpacity: e.haloOpacity
                }, t), t
            }, Radius: function (e) {
                return this.createElementNSPlus("sld:Radius", {value: e})
            }, RasterSymbolizer: function (e) {
                var t = this.createElementNSPlus("sld:RasterSymbolizer");
                return e.geometry && this.writeNode("Geometry", e.geometry, t), e.opacity && this.writeNode("Opacity", e.opacity, t), e.colorMap && this.writeNode("ColorMap", e.colorMap, t), t
            }, Geometry: function (e) {
                var t = this.createElementNSPlus("sld:Geometry");
                return e.property && this.writeNode("ogc:PropertyName", e, t), t
            }, ColorMap: function (e) {
                for (var t = this.createElementNSPlus("sld:ColorMap"), i = 0, n = e.length; n > i; ++i)this.writeNode("ColorMapEntry", e[i], t);
                return t
            }, ColorMapEntry: function (e) {
                var t = this.createElementNSPlus("sld:ColorMapEntry");
                return t.setAttribute("color", e.color), void 0 !== e.opacity && t.setAttribute("opacity", parseFloat(e.opacity)), void 0 !== e.quantity && t.setAttribute("quantity", parseFloat(e.quantity)), void 0 !== e.label && t.setAttribute("label", e.label), t
            }, PolygonSymbolizer: function (e) {
                var t = this.createElementNSPlus("sld:PolygonSymbolizer");
                return !1 !== e.fill && this.writeNode("Fill", e, t), !1 !== e.stroke && this.writeNode("Stroke", e, t), t
            }, Fill: function (e) {
                var t = this.createElementNSPlus("sld:Fill");
                return e.fillColor && this.writeNode("CssParameter", {
                    symbolizer: e,
                    key: "fillColor"
                }, t), null != e.fillOpacity && this.writeNode("CssParameter", {
                    symbolizer: e,
                    key: "fillOpacity"
                }, t), t
            }, PointSymbolizer: function (e) {
                var t = this.createElementNSPlus("sld:PointSymbolizer");
                return this.writeNode("Graphic", e, t), t
            }, Graphic: function (e) {
                var t = this.createElementNSPlus("sld:Graphic");
                return void 0 != e.externalGraphic ? this.writeNode("ExternalGraphic", e, t) : this.writeNode("Mark", e, t), void 0 != e.graphicOpacity && this.writeNode("Opacity", e.graphicOpacity, t), void 0 != e.pointRadius ? this.writeNode("Size", 2 * e.pointRadius, t) : void 0 != e.graphicWidth && this.writeNode("Size", e.graphicWidth, t), void 0 != e.rotation && this.writeNode("Rotation", e.rotation, t), t
            }, ExternalGraphic: function (e) {
                var t = this.createElementNSPlus("sld:ExternalGraphic");
                return this.writeNode("OnlineResource", e.externalGraphic, t), this.writeNode("Format", e.graphicFormat || this.getGraphicFormat(e.externalGraphic), t), t
            }, Mark: function (e) {
                var t = this.createElementNSPlus("sld:Mark");
                return e.graphicName && this.writeNode("WellKnownName", e.graphicName, t), !1 !== e.fill && this.writeNode("Fill", e, t), !1 !== e.stroke && this.writeNode("Stroke", e, t), t
            }, WellKnownName: function (e) {
                return this.createElementNSPlus("sld:WellKnownName", {value: e})
            }, Opacity: function (e) {
                return this.createElementNSPlus("sld:Opacity", {value: e})
            }, Size: function (e) {
                return this.writers.sld._OGCExpression.call(this, "sld:Size", e)
            }, Rotation: function (e) {
                return this.createElementNSPlus("sld:Rotation", {value: e})
            }, OnlineResource: function (e) {
                return this.createElementNSPlus("sld:OnlineResource", {
                    attributes: {
                        "xlink:type": "simple",
                        "xlink:href": e
                    }
                })
            }, Format: function (e) {
                return this.createElementNSPlus("sld:Format", {value: e})
            }
        }
    }, OpenLayers.Format.Filter.v1_0_0.prototype.writers),
    CLASS_NAME: "OpenLayers.Format.SLD.v1"
}),OpenLayers.Layer.WMS = OpenLayers.Class(OpenLayers.Layer.Grid, {
    DEFAULT_PARAMS: {
        service: "WMS",
        version: "1.1.1",
        request: "GetMap",
        styles: "",
        format: "image/jpeg"
    }, isBaseLayer: !0, encodeBBOX: !1, noMagic: !1, yx: {}, initialize: function (e, t, i, n) {
        var s = [], i = OpenLayers.Util.upperCaseObject(i);
        1.3 <= parseFloat(i.VERSION) && !i.EXCEPTIONS && (i.EXCEPTIONS = "INIMAGE"), s.push(e, t, i, n), OpenLayers.Layer.Grid.prototype.initialize.apply(this, s), OpenLayers.Util.applyDefaults(this.params, OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS)), !this.noMagic && this.params.TRANSPARENT && "true" == this.params.TRANSPARENT.toString().toLowerCase() && (null != n && n.isBaseLayer || (this.isBaseLayer = !1), "image/jpeg" == this.params.FORMAT && (this.params.FORMAT = OpenLayers.Util.alphaHack() ? "image/gif" : "image/png"))
    }, clone: function (e) {
        return null == e && (e = new OpenLayers.Layer.WMS(this.name, this.url, this.params, this.getOptions())), e = OpenLayers.Layer.Grid.prototype.clone.apply(this, [e])
    }, reverseAxisOrder: function () {
        var e = this.projection.getCode();
        return 1.3 <= parseFloat(this.params.VERSION) && !(!this.yx[e] && !OpenLayers.Projection.defaults[e].yx)
    }, getURL: function (e) {
        var e = this.adjustBounds(e), t = this.getImageSize(), i = {}, n = this.reverseAxisOrder();
        return i.BBOX = this.encodeBBOX ? e.toBBOX(null, n) : e.toArray(n), i.WIDTH = t.w, i.HEIGHT = t.h, this.getFullRequestString(i)
    }, mergeNewParams: function (e) {
        return e = [OpenLayers.Util.upperCaseObject(e)], OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this, e)
    }, getFullRequestString: function (e) {
        var t = this.map.getProjectionObject(), t = this.projection && this.projection.equals(t) ? this.projection.getCode() : t.getCode(), t = "none" == t ? null : t;
        return 1.3 <= parseFloat(this.params.VERSION) ? this.params.CRS = t : this.params.SRS = t, "boolean" == typeof this.params.TRANSPARENT && (e.TRANSPARENT = this.params.TRANSPARENT ? "TRUE" : "FALSE"), OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this, arguments)
    }, CLASS_NAME: "OpenLayers.Layer.WMS"
}),OpenLayers.Format.WMC.v1_1_0 = OpenLayers.Class(OpenLayers.Format.WMC.v1, {
    VERSION: "1.1.0",
    schemaLocation: "http://www.opengis.net/context http://schemas.opengis.net/context/1.1.0/context.xsd",
    initialize: function (e) {
        OpenLayers.Format.WMC.v1.prototype.initialize.apply(this, [e])
    },
    read_sld_MinScaleDenominator: function (e, t) {
        var i = parseFloat(this.getChildValue(t));
        i > 0 && (e.maxScale = i)
    },
    read_sld_MaxScaleDenominator: function (e, t) {
        e.minScale = parseFloat(this.getChildValue(t))
    },
    read_wmc_SRS: function (e, t) {
        "srs" in e || (e.srs = {}), e.srs[this.getChildValue(t)] = !0
    },
    write_wmc_Layer: function (e) {
        var t = OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this, [e]);
        if (e.maxScale) {
            var i = this.createElementNS(this.namespaces.sld, "sld:MinScaleDenominator");
            i.appendChild(this.createTextNode(e.maxScale.toPrecision(16))), t.appendChild(i)
        }
        if (e.minScale && (i = this.createElementNS(this.namespaces.sld, "sld:MaxScaleDenominator"), i.appendChild(this.createTextNode(e.minScale.toPrecision(16))), t.appendChild(i)), e.srs)for (var n in e.srs)t.appendChild(this.createElementDefaultNS("SRS", n));
        return t.appendChild(this.write_wmc_FormatList(e)), t.appendChild(this.write_wmc_StyleList(e)), e.dimensions && t.appendChild(this.write_wmc_DimensionList(e)), t.appendChild(this.write_wmc_LayerExtension(e)), t
    },
    CLASS_NAME: "OpenLayers.Format.WMC.v1_1_0"
}),OpenLayers.Format.XLS = OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC, {
    defaultVersion: "1.1.0",
    stringifyOutput: !0,
    CLASS_NAME: "OpenLayers.Format.XLS"
}),OpenLayers.Format.XLS.v1 = OpenLayers.Class(OpenLayers.Format.XML, {
    namespaces: {
        xls: "http://www.opengis.net/xls",
        gml: "http://www.opengis.net/gml",
        xsi: "http://www.w3.org/2001/XMLSchema-instance"
    },
    regExes: {trimSpace: /^\s*|\s*$/g, removeSpace: /\s*/g, splitSpace: /\s+/, trimComma: /\s*,\s*/g},
    xy: !0,
    defaultPrefix: "xls",
    schemaLocation: null,
    read: function (e, t) {
        OpenLayers.Util.applyDefaults(t, this.options);
        var i = {};
        return this.readChildNodes(e, i), i
    },
    readers: {
        xls: {
            XLS: function (e, t) {
                t.version = e.getAttribute("version"), this.readChildNodes(e, t)
            }, Response: function (e, t) {
                this.readChildNodes(e, t)
            }, GeocodeResponse: function (e, t) {
                t.responseLists = [], this.readChildNodes(e, t)
            }, GeocodeResponseList: function (e, t) {
                var i = {
                    features: [],
                    numberOfGeocodedAddresses: parseInt(e.getAttribute("numberOfGeocodedAddresses"))
                };
                t.responseLists.push(i), this.readChildNodes(e, i)
            }, GeocodedAddress: function (e, t) {
                var i = new OpenLayers.Feature.Vector;
                t.features.push(i), this.readChildNodes(e, i), i.geometry = i.components[0]
            }, GeocodeMatchCode: function (e, t) {
                t.attributes.matchCode = {
                    accuracy: parseFloat(e.getAttribute("accuracy")),
                    matchType: e.getAttribute("matchType")
                }
            }, Address: function (e, t) {
                var i = {
                    countryCode: e.getAttribute("countryCode"),
                    addressee: e.getAttribute("addressee"),
                    street: [],
                    place: []
                };
                t.attributes.address = i, this.readChildNodes(e, i)
            }, freeFormAddress: function (e, t) {
                t.freeFormAddress = this.getChildValue(e)
            }, StreetAddress: function (e, t) {
                this.readChildNodes(e, t)
            }, Building: function (e, t) {
                t.building = {
                    number: e.getAttribute("number"),
                    subdivision: e.getAttribute("subdivision"),
                    buildingName: e.getAttribute("buildingName")
                }
            }, Street: function (e, t) {
                t.street.push(this.getChildValue(e))
            }, Place: function (e, t) {
                t.place[e.getAttribute("type")] = this.getChildValue(e)
            }, PostalCode: function (e, t) {
                t.postalCode = this.getChildValue(e)
            }
        }, gml: OpenLayers.Format.GML.v3.prototype.readers.gml
    },
    write: function (e) {
        return this.writers.xls.XLS.apply(this, [e])
    },
    writers: {
        xls: {
            XLS: function (e) {
                var t = this.createElementNSPlus("xls:XLS", {
                    attributes: {
                        version: this.VERSION,
                        "xsi:schemaLocation": this.schemaLocation
                    }
                });
                return this.writeNode("RequestHeader", e.header, t), this.writeNode("Request", e, t), t
            }, RequestHeader: function () {
                return this.createElementNSPlus("xls:RequestHeader")
            }, Request: function (e) {
                var t = this.createElementNSPlus("xls:Request", {
                    attributes: {
                        methodName: "GeocodeRequest",
                        requestID: e.requestID || "",
                        version: this.VERSION
                    }
                });
                return this.writeNode("GeocodeRequest", e.addresses, t), t
            }, GeocodeRequest: function (e) {
                for (var t = this.createElementNSPlus("xls:GeocodeRequest"), i = 0, n = e.length; n > i; i++)this.writeNode("Address", e[i], t);
                return t
            }, Address: function (e) {
                var t = this.createElementNSPlus("xls:Address", {attributes: {countryCode: e.countryCode}});
                return e.freeFormAddress ? this.writeNode("freeFormAddress", e.freeFormAddress, t) : (e.street && this.writeNode("StreetAddress", e, t), e.municipality && this.writeNode("Municipality", e.municipality, t), e.countrySubdivision && this.writeNode("CountrySubdivision", e.countrySubdivision, t), e.postalCode && this.writeNode("PostalCode", e.postalCode, t)), t
            }, freeFormAddress: function (e) {
                return this.createElementNSPlus("freeFormAddress", {value: e})
            }, StreetAddress: function (e) {
                var t = this.createElementNSPlus("xls:StreetAddress");
                e.building && this.writeNode(t, "Building", e.building), e = e.street, OpenLayers.Util.isArray(e) || (e = [e]);
                for (var i = 0, n = e.length; n > i; i++)this.writeNode("Street", e[i], t);
                return t
            }, Building: function (e) {
                return this.createElementNSPlus("xls:Building", {
                    attributes: {
                        number: e.number,
                        subdivision: e.subdivision,
                        buildingName: e.buildingName
                    }
                })
            }, Street: function (e) {
                return this.createElementNSPlus("xls:Street", {value: e})
            }, Municipality: function (e) {
                return this.createElementNSPlus("xls:Place", {attributes: {type: "Municipality"}, value: e})
            }, CountrySubdivision: function (e) {
                return this.createElementNSPlus("xls:Place", {attributes: {type: "CountrySubdivision"}, value: e})
            }, PostalCode: function (e) {
                return this.createElementNSPlus("xls:PostalCode", {value: e})
            }
        }
    },
    CLASS_NAME: "OpenLayers.Format.XLS.v1"
}),OpenLayers.Format.XLS.v1_1_0 = OpenLayers.Class(OpenLayers.Format.XLS.v1, {
    VERSION: "1.1",
    schemaLocation: "http://www.opengis.net/xls http://schemas.opengis.net/ols/1.1.0/LocationUtilityService.xsd",
    CLASS_NAME: "OpenLayers.Format.XLS.v1_1_0"
}),OpenLayers.Format.XLS.v1_1 = OpenLayers.Format.XLS.v1_1_0,OpenLayers.Renderer.SVG = OpenLayers.Class(OpenLayers.Renderer.Elements, {
    xmlns: "http://www.w3.org/2000/svg",
    xlinkns: "http://www.w3.org/1999/xlink",
    MAX_PIXEL: 15e3,
    translationParameters: null,
    symbolMetrics: null,
    initialize: function () {
        this.supported() && (OpenLayers.Renderer.Elements.prototype.initialize.apply(this, arguments), this.translationParameters = {
            x: 0,
            y: 0
        }, this.symbolMetrics = {})
    },
    supported: function () {
        return document.implementation && (document.implementation.hasFeature("org.w3c.svg", "1.0") || document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#SVG", "1.1") || document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure", "1.1"))
    },
    inValidRange: function (e, t, i) {
        return e += i ? 0 : this.translationParameters.x, t += i ? 0 : this.translationParameters.y, e >= -this.MAX_PIXEL && e <= this.MAX_PIXEL && t >= -this.MAX_PIXEL && t <= this.MAX_PIXEL
    },
    setExtent: function (e, t) {
        var i = OpenLayers.Renderer.Elements.prototype.setExtent.apply(this, arguments), n = this.getResolution(), s = -e.left / n, n = e.top / n;
        return t ? (this.left = s, this.top = n, this.rendererRoot.setAttributeNS(null, "viewBox", "0 0 " + this.size.w + " " + this.size.h), this.translate(this.xOffset, 0), !0) : ((s = this.translate(s - this.left + this.xOffset, n - this.top)) || this.setExtent(e, !0), i && s)
    },
    translate: function (e, t) {
        if (this.inValidRange(e, t, !0)) {
            var i = "";
            return (e || t) && (i = "translate(" + e + "," + t + ")"), this.root.setAttributeNS(null, "transform", i), this.translationParameters = {
                x: e,
                y: t
            }, !0
        }
        return !1
    },
    setSize: function () {
        OpenLayers.Renderer.prototype.setSize.apply(this, arguments), this.rendererRoot.setAttributeNS(null, "width", this.size.w), this.rendererRoot.setAttributeNS(null, "height", this.size.h)
    },
    getNodeType: function (e, t) {
        var i = null;
        switch (e.CLASS_NAME) {
            case"OpenLayers.Geometry.Point":
                i = t.externalGraphic ? "image" : this.isComplexSymbol(t.graphicName) ? "svg" : "circle";
                break;
            case"OpenLayers.Geometry.Rectangle":
                i = "rect";
                break;
            case"OpenLayers.Geometry.LineString":
                i = "polyline";
                break;
            case"OpenLayers.Geometry.LinearRing":
                i = "polygon";
                break;
            case"OpenLayers.Geometry.Polygon":
            case"OpenLayers.Geometry.Curve":
                i = "path"
        }
        return i
    },
    setStyle: function (e, t, i) {
        var n, t = t || e._style, i = i || e._options, s = parseFloat(e.getAttributeNS(null, "r")), r = 1;
        if ("OpenLayers.Geometry.Point" == e._geometryClass && s) {
            if (e.style.visibility = "", !1 === t.graphic) e.style.visibility = "hidden"; else if (t.externalGraphic) {
                n = this.getPosition(e), t.graphicTitle && (e.setAttributeNS(null, "title", t.graphicTitle), s = e.getElementsByTagName("title"), 0 < s.length ? s[0].firstChild.textContent = t.graphicTitle : (s = this.nodeFactory(null, "title"), s.textContent = t.graphicTitle, e.appendChild(s))), t.graphicWidth && t.graphicHeight && e.setAttributeNS(null, "preserveAspectRatio", "none");
                var s = t.graphicWidth || t.graphicHeight, a = t.graphicHeight || t.graphicWidth, s = s ? s : 2 * t.pointRadius, a = a ? a : 2 * t.pointRadius, o = void 0 != t.graphicYOffset ? t.graphicYOffset : -(.5 * a), l = t.graphicOpacity || t.fillOpacity;
                e.setAttributeNS(null, "x", (n.x + (void 0 != t.graphicXOffset ? t.graphicXOffset : -(.5 * s))).toFixed()), e.setAttributeNS(null, "y", (n.y + o).toFixed()), e.setAttributeNS(null, "width", s), e.setAttributeNS(null, "height", a), e.setAttributeNS(this.xlinkns, "href", t.externalGraphic), e.setAttributeNS(null, "style", "opacity: " + l), e.onclick = OpenLayers.Renderer.SVG.preventDefault
            } else if (this.isComplexSymbol(t.graphicName)) {
                var s = 3 * t.pointRadius, a = 2 * s, h = this.importSymbol(t.graphicName);
                n = this.getPosition(e), r = 3 * this.symbolMetrics[h.id][0] / a, o = e.parentNode, l = e.nextSibling, o && o.removeChild(e), e.firstChild && e.removeChild(e.firstChild), e.appendChild(h.firstChild.cloneNode(!0)), e.setAttributeNS(null, "viewBox", h.getAttributeNS(null, "viewBox")), e.setAttributeNS(null, "width", a), e.setAttributeNS(null, "height", a), e.setAttributeNS(null, "x", n.x - s), e.setAttributeNS(null, "y", n.y - s), l ? o.insertBefore(e, l) : o && o.appendChild(e)
            } else e.setAttributeNS(null, "r", t.pointRadius);
            s = t.rotation, void 0 === s && void 0 === e._rotation || !n || (e._rotation = s, s |= 0, "svg" !== e.nodeName ? e.setAttributeNS(null, "transform", "rotate(" + s + " " + n.x + " " + n.y + ")") : (n = this.symbolMetrics[h.id], e.firstChild.setAttributeNS(null, "transform", "rotate(" + s + " " + n[1] + " " + n[2] + ")")))
        }
        return i.isFilled ? (e.setAttributeNS(null, "fill", t.fillColor), e.setAttributeNS(null, "fill-opacity", t.fillOpacity)) : e.setAttributeNS(null, "fill", "none"), i.isStroked ? (e.setAttributeNS(null, "stroke", t.strokeColor), e.setAttributeNS(null, "stroke-opacity", t.strokeOpacity), e.setAttributeNS(null, "stroke-width", t.strokeWidth * r), e.setAttributeNS(null, "stroke-linecap", t.strokeLinecap || "round"), e.setAttributeNS(null, "stroke-linejoin", "round"), t.strokeDashstyle && e.setAttributeNS(null, "stroke-dasharray", this.dashStyle(t, r))) : e.setAttributeNS(null, "stroke", "none"), t.pointerEvents && e.setAttributeNS(null, "pointer-events", t.pointerEvents), null != t.cursor && e.setAttributeNS(null, "cursor", t.cursor), e
    },
    dashStyle: function (e, t) {
        var i = e.strokeWidth * t, n = e.strokeDashstyle;
        switch (n) {
            case"solid":
                return "none";
            case"dot":
                return [1, 4 * i].join();
            case"dash":
                return [4 * i, 4 * i].join();
            case"dashdot":
                return [4 * i, 4 * i, 1, 4 * i].join();
            case"longdash":
                return [8 * i, 4 * i].join();
            case"longdashdot":
                return [8 * i, 4 * i, 1, 4 * i].join();
            default:
                return OpenLayers.String.trim(n).replace(/\s+/g, ",")
        }
    },
    createNode: function (e, t) {
        var i = document.createElementNS(this.xmlns, e);
        return t && i.setAttributeNS(null, "id", t), i
    },
    nodeTypeCompare: function (e, t) {
        return t == e.nodeName
    },
    createRenderRoot: function () {
        var e = this.nodeFactory(this.container.id + "_svgRoot", "svg");
        return e.style.display = "block", e
    },
    createRoot: function (e) {
        return this.nodeFactory(this.container.id + e, "g")
    },
    createDefs: function () {
        var e = this.nodeFactory(this.container.id + "_defs", "defs");
        return this.rendererRoot.appendChild(e), e
    },
    drawPoint: function (e, t) {
        return this.drawCircle(e, t, 1)
    },
    drawCircle: function (e, t, i) {
        var n = this.getResolution(), s = (t.x - this.featureDx) / n + this.left, t = this.top - t.y / n;
        return this.inValidRange(s, t) ? (e.setAttributeNS(null, "cx", s), e.setAttributeNS(null, "cy", t), e.setAttributeNS(null, "r", i), e) : !1
    },
    drawLineString: function (e, t) {
        var i = this.getComponentsString(t.components);
        return i.path ? (e.setAttributeNS(null, "points", i.path), i.complete ? e : null) : !1
    },
    drawLinearRing: function (e, t) {
        var i = this.getComponentsString(t.components);
        return i.path ? (e.setAttributeNS(null, "points", i.path), i.complete ? e : null) : !1
    },
    drawPolygon: function (e, t) {
        for (var i, n, s = "", r = !0, a = !0, o = 0, l = t.components.length; l > o; o++)s += " M", i = this.getComponentsString(t.components[o].components, " "), (n = i.path) ? (s += " " + n, a = i.complete && a) : r = !1;
        return r ? (e.setAttributeNS(null, "d", s + " z"), e.setAttributeNS(null, "fill-rule", "evenodd"), a ? e : null) : !1
    },
    drawRectangle: function (e, t) {
        var i = this.getResolution(), n = (t.x - this.featureDx) / i + this.left, s = this.top - t.y / i;
        return this.inValidRange(n, s) ? (e.setAttributeNS(null, "x", n), e.setAttributeNS(null, "y", s), e.setAttributeNS(null, "width", t.width / i), e.setAttributeNS(null, "height", t.height / i), e) : !1
    },
    drawText: function (e, t, i) {
        var n = !!t.labelOutlineWidth;
        if (n) {
            var s = OpenLayers.Util.extend({}, t);
            s.fontColor = s.labelOutlineColor, s.fontStrokeColor = s.labelOutlineColor, s.fontStrokeWidth = t.labelOutlineWidth, delete s.labelOutlineWidth, this.drawText(e, s, i)
        }
        var r = this.getResolution(), s = (i.x - this.featureDx) / r + this.left, a = i.y / r - this.top, n = n ? this.LABEL_OUTLINE_SUFFIX : this.LABEL_ID_SUFFIX, r = this.nodeFactory(e + n, "text");
        r.setAttributeNS(null, "x", s), r.setAttributeNS(null, "y", -a), t.fontColor && r.setAttributeNS(null, "fill", t.fontColor), t.fontStrokeColor && r.setAttributeNS(null, "stroke", t.fontStrokeColor), t.fontStrokeWidth && r.setAttributeNS(null, "stroke-width", t.fontStrokeWidth), t.fontOpacity && r.setAttributeNS(null, "opacity", t.fontOpacity), t.fontFamily && r.setAttributeNS(null, "font-family", t.fontFamily), t.fontSize && r.setAttributeNS(null, "font-size", t.fontSize), t.fontWeight && r.setAttributeNS(null, "font-weight", t.fontWeight), t.fontStyle && r.setAttributeNS(null, "font-style", t.fontStyle), !0 === t.labelSelect ? (r.setAttributeNS(null, "pointer-events", "visible"), r._featureId = e) : r.setAttributeNS(null, "pointer-events", "none"), a = t.labelAlign || OpenLayers.Renderer.defaultSymbolizer.labelAlign, r.setAttributeNS(null, "text-anchor", OpenLayers.Renderer.SVG.LABEL_ALIGN[a[0]] || "middle"), !0 === OpenLayers.IS_GECKO && r.setAttributeNS(null, "dominant-baseline", OpenLayers.Renderer.SVG.LABEL_ALIGN[a[1]] || "central");
        for (var o = t.label.split("\n"), l = o.length; r.childNodes.length > l;)r.removeChild(r.lastChild);
        for (var h = 0; l > h; h++) {
            var u = this.nodeFactory(e + n + "_tspan_" + h, "tspan");
            if (!0 === t.labelSelect && (u._featureId = e, u._geometry = i, u._geometryClass = i.CLASS_NAME), !1 === OpenLayers.IS_GECKO && u.setAttributeNS(null, "baseline-shift", OpenLayers.Renderer.SVG.LABEL_VSHIFT[a[1]] || "-35%"), u.setAttribute("x", s), 0 == h) {
                var c = OpenLayers.Renderer.SVG.LABEL_VFACTOR[a[1]];
                null == c && (c = -.5), u.setAttribute("dy", c * (l - 1) + "em")
            } else u.setAttribute("dy", "1em");
            u.textContent = "" === o[h] ? " " : o[h], u.parentNode || r.appendChild(u)
        }
        r.parentNode || this.textRoot.appendChild(r)
    },
    getComponentsString: function (e, t) {
        for (var i, n = [], s = !0, r = e.length, a = [], o = 0; r > o; o++)i = e[o], n.push(i), (i = this.getShortString(i)) ? a.push(i) : (o > 0 && this.getShortString(e[o - 1]) && a.push(this.clipLine(e[o], e[o - 1])), r - 1 > o && this.getShortString(e[o + 1]) && a.push(this.clipLine(e[o], e[o + 1])), s = !1);
        return {path: a.join(t || ","), complete: s}
    },
    clipLine: function (e, t) {
        if (t.equals(e))return "";
        var i, n = this.getResolution(), s = this.MAX_PIXEL - this.translationParameters.x, r = this.MAX_PIXEL - this.translationParameters.y, a = (t.x - this.featureDx) / n + this.left, o = this.top - t.y / n, l = (e.x - this.featureDx) / n + this.left, n = this.top - e.y / n;
        return (-s > l || l > s) && (i = (n - o) / (l - a), l = 0 > l ? -s : s, n = o + (l - a) * i), (-r > n || n > r) && (i = (l - a) / (n - o), n = 0 > n ? -r : r, l = a + (n - o) * i), l + "," + n
    },
    getShortString: function (e) {
        var t = this.getResolution(), i = (e.x - this.featureDx) / t + this.left, e = this.top - e.y / t;
        return this.inValidRange(i, e) ? i + "," + e : !1
    },
    getPosition: function (e) {
        return {x: parseFloat(e.getAttributeNS(null, "cx")), y: parseFloat(e.getAttributeNS(null, "cy"))}
    },
    importSymbol: function (e) {
        this.defs || (this.defs = this.createDefs());
        var t = this.container.id + "-" + e, i = document.getElementById(t);
        if (null != i)return i;
        var n = OpenLayers.Renderer.symbol[e];
        if (!n)throw Error(e + " is not a valid symbol name");
        var e = this.nodeFactory(t, "symbol"), s = this.nodeFactory(null, "polygon");
        e.appendChild(s);
        for (var r, a, i = new OpenLayers.Bounds(Number.MAX_VALUE, Number.MAX_VALUE, 0, 0), o = [], l = 0; l < n.length; l += 2)r = n[l], a = n[l + 1], i.left = Math.min(i.left, r), i.bottom = Math.min(i.bottom, a), i.right = Math.max(i.right, r), i.top = Math.max(i.top, a), o.push(r, ",", a);
        return s.setAttributeNS(null, "points", o.join(" ")), n = i.getWidth(), s = i.getHeight(), e.setAttributeNS(null, "viewBox", [i.left - n, i.bottom - s, 3 * n, 3 * s].join(" ")), this.symbolMetrics[t] = [Math.max(n, s), i.getCenterLonLat().lon, i.getCenterLonLat().lat], this.defs.appendChild(e), e
    },
    getFeatureIdFromEvent: function (e) {
        var t = OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this, arguments);
        return t || (t = e.target, t = t.parentNode && t != this.rendererRoot ? t.parentNode._featureId : void 0), t
    },
    CLASS_NAME: "OpenLayers.Renderer.SVG"
}),OpenLayers.Renderer.SVG.LABEL_ALIGN = {
    l: "start",
    r: "end",
    b: "bottom",
    t: "hanging"
},OpenLayers.Renderer.SVG.LABEL_VSHIFT = {t: "-70%", b: "0"},OpenLayers.Renderer.SVG.LABEL_VFACTOR = {
    t: 0,
    b: -1
},OpenLayers.Renderer.SVG.preventDefault = function (e) {
    e.preventDefault && e.preventDefault()
},OpenLayers.Format.SLD.v1_0_0 = OpenLayers.Class(OpenLayers.Format.SLD.v1, {
    VERSION: "1.0.0",
    schemaLocation: "http://www.opengis.net/sld http://schemas.opengis.net/sld/1.0.0/StyledLayerDescriptor.xsd",
    CLASS_NAME: "OpenLayers.Format.SLD.v1_0_0"
}),OpenLayers.Format.OWSContext = OpenLayers.Class(OpenLayers.Format.Context, {
    defaultVersion: "0.3.1",
    getVersion: function () {
        var e = OpenLayers.Format.XML.VersionedOGC.prototype.getVersion.apply(this, arguments);
        return "0.3.0" === e && (e = this.defaultVersion), e
    },
    toContext: function (e) {
        var t = {};
        return "OpenLayers.Map" == e.CLASS_NAME && (t.bounds = e.getExtent(), t.maxExtent = e.maxExtent, t.projection = e.projection, t.size = e.getSize(), t.layers = e.layers), t
    },
    CLASS_NAME: "OpenLayers.Format.OWSContext"
}),OpenLayers.Format.OWSContext.v0_3_1 = OpenLayers.Class(OpenLayers.Format.XML, {
    namespaces: {
        owc: "http://www.opengis.net/ows-context",
        gml: "http://www.opengis.net/gml",
        kml: "http://www.opengis.net/kml/2.2",
        ogc: "http://www.opengis.net/ogc",
        ows: "http://www.opengis.net/ows",
        sld: "http://www.opengis.net/sld",
        xlink: "http://www.w3.org/1999/xlink",
        xsi: "http://www.w3.org/2001/XMLSchema-instance"
    },
    VERSION: "0.3.1",
    schemaLocation: "http://www.opengis.net/ows-context http://www.ogcnetwork.net/schemas/owc/0.3.1/owsContext.xsd",
    defaultPrefix: "owc",
    extractAttributes: !0,
    xy: !0,
    regExes: {trimSpace: /^\s*|\s*$/g, removeSpace: /\s*/g, splitSpace: /\s+/, trimComma: /\s*,\s*/g},
    featureNS: "http://mapserver.gis.umn.edu/mapserver",
    featureType: "vector",
    geometryName: "geometry",
    nestingLayerLookup: null,
    initialize: function (e) {
        OpenLayers.Format.XML.prototype.initialize.apply(this, [e]), OpenLayers.Format.GML.v2.prototype.setGeometryTypes.call(this)
    },
    setNestingPath: function (e) {
        if (e.layersContext)for (var t = 0, i = e.layersContext.length; i > t; t++) {
            var n = e.layersContext[t], s = [], r = e.title || "";
            e.metadata && e.metadata.nestingPath && (s = e.metadata.nestingPath.slice()), "" != r && s.push(r), n.metadata.nestingPath = s, n.layersContext && this.setNestingPath(n)
        }
    },
    decomposeNestingPath: function (e) {
        var t = [];
        if (OpenLayers.Util.isArray(e)) {
            for (e = e.slice(); 0 < e.length;)t.push(e.slice()), e.pop();
            t.reverse()
        }
        return t
    },
    read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e])), e && 9 == e.nodeType && (e = e.documentElement);
        var t = {};
        return this.readNode(e, t), this.setNestingPath({layersContext: t.layersContext}), e = [], this.processLayer(e, t), delete t.layersContext, t.layersContext = e, t
    },
    processLayer: function (e, t) {
        if (t.layersContext)for (var i = 0, n = t.layersContext.length; n > i; i++) {
            var s = t.layersContext[i];
            e.push(s), s.layersContext && this.processLayer(e, s)
        }
    },
    write: function (e, t) {
        this.nestingLayerLookup = {}, t = t || {}, OpenLayers.Util.applyDefaults(t, e);
        var i = this.writeNode("OWSContext", t);
        return this.nestingLayerLookup = null, this.setAttributeNS(i, this.namespaces.xsi, "xsi:schemaLocation", this.schemaLocation), OpenLayers.Format.XML.prototype.write.apply(this, [i])
    },
    readers: {
        kml: {
            Document: function (e, t) {
                t.features = new OpenLayers.Format.KML({kmlns: this.namespaces.kml, extractStyles: !0}).read(e)
            }
        },
        owc: {
            OWSContext: function (e, t) {
                this.readChildNodes(e, t)
            }, General: function (e, t) {
                this.readChildNodes(e, t)
            }, ResourceList: function (e, t) {
                this.readChildNodes(e, t)
            }, Layer: function (e, t) {
                var i = {
                    metadata: {},
                    visibility: "1" != e.getAttribute("hidden"),
                    queryable: "1" == e.getAttribute("queryable"),
                    opacity: null != e.getAttribute("opacity") ? parseFloat(e.getAttribute("opacity")) : null,
                    name: e.getAttribute("name"),
                    categoryLayer: null == e.getAttribute("name"),
                    formats: [],
                    styles: []
                };
                t.layersContext || (t.layersContext = []), t.layersContext.push(i), this.readChildNodes(e, i)
            }, InlineGeometry: function (e, t) {
                t.features = [];
                var i, n = this.getElementsByTagNameNS(e, this.namespaces.gml, "featureMember");
                1 <= n.length && (i = n[0]), i && i.firstChild && (n = i.firstChild.nextSibling ? i.firstChild.nextSibling : i.firstChild, this.setNamespace("feature", n.namespaceURI), this.featureType = n.localName || n.nodeName.split(":").pop(), this.readChildNodes(e, t))
            }, Server: function (e, t) {
                (!t.service && !t.version || t.service != OpenLayers.Format.Context.serviceTypes.WMS) && (t.service = e.getAttribute("service"), t.version = e.getAttribute("version"), this.readChildNodes(e, t))
            }, Name: function (e, t) {
                t.name = this.getChildValue(e), this.readChildNodes(e, t)
            }, Title: function (e, t) {
                t.title = this.getChildValue(e), this.readChildNodes(e, t)
            }, StyleList: function (e, t) {
                this.readChildNodes(e, t.styles)
            }, Style: function (e, t) {
                var i = {};
                t.push(i), this.readChildNodes(e, i)
            }, LegendURL: function (e, t) {
                var i = {};
                t.legend = i, this.readChildNodes(e, i)
            }, OnlineResource: function (e, t) {
                t.url = this.getAttributeNS(e, this.namespaces.xlink, "href"), this.readChildNodes(e, t)
            }
        },
        ows: OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows,
        gml: OpenLayers.Format.GML.v2.prototype.readers.gml,
        sld: OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld,
        feature: OpenLayers.Format.GML.v2.prototype.readers.feature
    },
    writers: {
        owc: {
            OWSContext: function (e) {
                var t = this.createElementNSPlus("OWSContext", {
                    attributes: {
                        version: this.VERSION,
                        id: e.id || OpenLayers.Util.createUniqueID("OpenLayers_OWSContext_")
                    }
                });
                return this.writeNode("General", e, t), this.writeNode("ResourceList", e, t), t
            }, General: function (e) {
                var t = this.createElementNSPlus("General");
                return this.writeNode("ows:BoundingBox", e, t), this.writeNode("ows:Title", e.title || "OpenLayers OWSContext", t), t
            }, ResourceList: function (e) {
                for (var t = this.createElementNSPlus("ResourceList"), i = 0, n = e.layers.length; n > i; i++) {
                    var s = e.layers[i], r = this.decomposeNestingPath(s.metadata.nestingPath);
                    this.writeNode("_Layer", {layer: s, subPaths: r}, t)
                }
                return t
            }, Server: function (e) {
                var t = this.createElementNSPlus("Server", {attributes: {version: e.version, service: e.service}});
                return this.writeNode("OnlineResource", e, t), t
            }, OnlineResource: function (e) {
                return this.createElementNSPlus("OnlineResource", {attributes: {"xlink:href": e.url}})
            }, InlineGeometry: function (e) {
                var t = this.createElementNSPlus("InlineGeometry");
                this.writeNode("gml:boundedBy", e.getDataExtent(), t);
                for (var i = 0, n = e.features.length; n > i; i++)this.writeNode("gml:featureMember", e.features[i], t);
                return t
            }, StyleList: function (e) {
                for (var t = this.createElementNSPlus("StyleList"), i = 0, n = e.length; n > i; i++)this.writeNode("Style", e[i], t);
                return t
            }, Style: function (e) {
                var t = this.createElementNSPlus("Style");
                return this.writeNode("Name", e, t), this.writeNode("Title", e, t), e.legend && this.writeNode("LegendURL", e, t), t
            }, Name: function (e) {
                return this.createElementNSPlus("Name", {value: e.name})
            }, Title: function (e) {
                return this.createElementNSPlus("Title", {value: e.title})
            }, LegendURL: function (e) {
                var t = this.createElementNSPlus("LegendURL");
                return this.writeNode("OnlineResource", e.legend, t), t
            }, _WMS: function (e) {
                var t = this.createElementNSPlus("Layer", {
                    attributes: {
                        name: e.params.LAYERS,
                        queryable: e.queryable ? "1" : "0",
                        hidden: e.visibility ? "0" : "1",
                        opacity: e.hasOwnProperty("opacity") ? e.opacity : null
                    }
                });
                return this.writeNode("ows:Title", e.name, t), this.writeNode("ows:OutputFormat", e.params.FORMAT, t), this.writeNode("Server", {
                    service: OpenLayers.Format.Context.serviceTypes.WMS,
                    version: e.params.VERSION,
                    url: e.url
                }, t), e.metadata.styles && 0 < e.metadata.styles.length && this.writeNode("StyleList", e.metadata.styles, t), t
            }, _Layer: function (e) {
                var t, i, n;
                return t = e.layer, i = e.subPaths, n = null, 0 < i.length ? (t = i[0].join("/"), i = t.lastIndexOf("/"), n = this.nestingLayerLookup[t], i = i > 0 ? t.substring(i + 1, t.length) : t, n || (n = this.createElementNSPlus("Layer"), this.writeNode("ows:Title", i, n), this.nestingLayerLookup[t] = n), e.subPaths.shift(), this.writeNode("_Layer", e, n)) : (t instanceof OpenLayers.Layer.WMS ? n = this.writeNode("_WMS", t) : t instanceof OpenLayers.Layer.Vector && (t.protocol instanceof OpenLayers.Protocol.WFS.v1 ? n = this.writeNode("_WFS", t) : t.protocol instanceof OpenLayers.Protocol.HTTP ? t.protocol.format instanceof OpenLayers.Format.GML ? (t.protocol.format.version = "2.1.2", n = this.writeNode("_GML", t)) : t.protocol.format instanceof OpenLayers.Format.KML && (t.protocol.format.version = "2.2", n = this.writeNode("_KML", t)) : (this.setNamespace("feature", this.featureNS), n = this.writeNode("_InlineGeometry", t))), t.options.maxScale && this.writeNode("sld:MinScaleDenominator", t.options.maxScale, n), t.options.minScale && this.writeNode("sld:MaxScaleDenominator", t.options.minScale, n), this.nestingLayerLookup[t.name] = n), n
            }, _WFS: function (e) {
                var t = this.createElementNSPlus("Layer", {
                    attributes: {
                        name: e.protocol.featurePrefix + ":" + e.protocol.featureType,
                        hidden: e.visibility ? "0" : "1"
                    }
                });
                return this.writeNode("ows:Title", e.name, t), this.writeNode("Server", {
                    service: OpenLayers.Format.Context.serviceTypes.WFS,
                    version: e.protocol.version,
                    url: e.protocol.url
                }, t), t
            }, _InlineGeometry: function (e) {
                var t = this.createElementNSPlus("Layer", {
                    attributes: {
                        name: this.featureType,
                        hidden: e.visibility ? "0" : "1"
                    }
                });
                return this.writeNode("ows:Title", e.name, t), this.writeNode("InlineGeometry", e, t), t
            }, _GML: function (e) {
                var t = this.createElementNSPlus("Layer");
                return this.writeNode("ows:Title", e.name, t), this.writeNode("Server", {
                    service: OpenLayers.Format.Context.serviceTypes.GML,
                    url: e.protocol.url,
                    version: e.protocol.format.version
                }, t), t
            }, _KML: function (e) {
                var t = this.createElementNSPlus("Layer");
                return this.writeNode("ows:Title", e.name, t), this.writeNode("Server", {
                    service: OpenLayers.Format.Context.serviceTypes.KML,
                    version: e.protocol.format.version,
                    url: e.protocol.url
                }, t), t
            }
        },
        gml: OpenLayers.Util.applyDefaults({
            boundedBy: function (e) {
                var t = this.createElementNSPlus("gml:boundedBy");
                return this.writeNode("gml:Box", e, t), t
            }
        }, OpenLayers.Format.GML.v2.prototype.writers.gml),
        ows: OpenLayers.Format.OWSCommon.v1_0_0.prototype.writers.ows,
        sld: OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld,
        feature: OpenLayers.Format.GML.v2.prototype.writers.feature
    },
    CLASS_NAME: "OpenLayers.Format.OWSContext.v0_3_1"
}),OpenLayers.Control.ScaleLine = OpenLayers.Class(OpenLayers.Control, {
    maxWidth: 100,
    topOutUnits: "km",
    topInUnits: "m",
    bottomOutUnits: "mi",
    bottomInUnits: "ft",
    eTop: null,
    eBottom: null,
    geodesic: !1,
    draw: function () {
        return OpenLayers.Control.prototype.draw.apply(this, arguments), this.eTop || (this.eTop = document.createElement("div"), this.eTop.className = this.displayClass + "Top", this.div.appendChild(this.eTop), this.eTop.style.visibility = "" == this.topOutUnits || "" == this.topInUnits ? "hidden" : "visible", this.eBottom = document.createElement("div"), this.eBottom.className = this.displayClass + "Bottom", this.div.appendChild(this.eBottom), this.eBottom.style.visibility = "" == this.bottomOutUnits || "" == this.bottomInUnits ? "hidden" : "visible"), this.map.events.register("moveend", this, this.update), this.update(), this.div
    },
    getBarLen: function (e) {
        var t = parseInt(Math.log(e) / Math.log(10)), t = Math.pow(10, t), e = parseInt(e / t);
        return (e > 5 ? 5 : e > 2 ? 2 : 1) * t
    },
    update: function () {
        var e = this.map.getResolution();
        if (e) {
            var t = this.map.getUnits(), i = OpenLayers.INCHES_PER_UNIT, n = this.maxWidth * e * i[t], s = 1;
            !0 === this.geodesic && (s = (this.map.getGeodesicPixelSize().w || 1e-6) * this.maxWidth / (n / i.km), n *= s);
            var r, a;
            n > 1e5 ? (r = this.topOutUnits, a = this.bottomOutUnits) : (r = this.topInUnits, a = this.bottomInUnits);
            var o = n / i[r], l = n / i[a], n = this.getBarLen(o), h = this.getBarLen(l), o = n / i[t] * i[r], l = h / i[t] * i[a], t = o / e / s, e = l / e / s;
            "visible" == this.eBottom.style.visibility && (this.eBottom.style.width = Math.round(e) + "px", this.eBottom.innerHTML = h + " " + a), "visible" == this.eTop.style.visibility && (this.eTop.style.width = Math.round(t) + "px", this.eTop.innerHTML = n + " " + r)
        }
    },
    CLASS_NAME: "OpenLayers.Control.ScaleLine"
}),OpenLayers.Icon = OpenLayers.Class({
    url: null,
    size: null,
    offset: null,
    calculateOffset: null,
    imageDiv: null,
    px: null,
    initialize: function (e, t, i, n) {
        this.url = e, this.size = t || {w: 20, h: 20}, this.offset = i || {
                x: -(this.size.w / 2),
                y: -(this.size.h / 2)
            }, this.calculateOffset = n, e = OpenLayers.Util.createUniqueID("OL_Icon_"), this.imageDiv = OpenLayers.Util.createAlphaImageDiv(e)
    },
    destroy: function () {
        this.erase(), OpenLayers.Event.stopObservingElement(this.imageDiv.firstChild), this.imageDiv.innerHTML = "", this.imageDiv = null
    },
    clone: function () {
        return new OpenLayers.Icon(this.url, this.size, this.offset, this.calculateOffset)
    },
    setSize: function (e) {
        null != e && (this.size = e), this.draw()
    },
    setUrl: function (e) {
        null != e && (this.url = e), this.draw()
    },
    draw: function (e) {
        return OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv, null, null, this.size, this.url, "absolute"), this.moveTo(e), this.imageDiv
    },
    erase: function () {
        null != this.imageDiv && null != this.imageDiv.parentNode && OpenLayers.Element.remove(this.imageDiv)
    },
    setOpacity: function (e) {
        OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv, null, null, null, null, null, null, null, e)
    },
    moveTo: function (e) {
        null != e && (this.px = e), null != this.imageDiv && (null == this.px ? this.display(!1) : (this.calculateOffset && (this.offset = this.calculateOffset(this.size)), OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv, null, {
            x: this.px.x + this.offset.x,
            y: this.px.y + this.offset.y
        })))
    },
    display: function (e) {
        this.imageDiv.style.display = e ? "" : "none"
    },
    isDrawn: function () {
        return this.imageDiv && this.imageDiv.parentNode && 11 != this.imageDiv.parentNode.nodeType
    },
    CLASS_NAME: "OpenLayers.Icon"
}),OpenLayers.Marker = OpenLayers.Class({
    icon: null,
    lonlat: null,
    events: null,
    map: null,
    initialize: function (e, t) {
        this.lonlat = e;
        var i = t ? t : OpenLayers.Marker.defaultIcon();
        null == this.icon ? this.icon = i : (this.icon.url = i.url, this.icon.size = i.size, this.icon.offset = i.offset, this.icon.calculateOffset = i.calculateOffset), this.events = new OpenLayers.Events(this, this.icon.imageDiv)
    },
    destroy: function () {
        this.erase(), this.map = null, this.events.destroy(), this.events = null, null != this.icon && (this.icon.destroy(), this.icon = null)
    },
    draw: function (e) {
        return this.icon.draw(e)
    },
    erase: function () {
        null != this.icon && this.icon.erase()
    },
    moveTo: function (e) {
        null != e && null != this.icon && this.icon.moveTo(e), this.lonlat = this.map.getLonLatFromLayerPx(e)
    },
    isDrawn: function () {
        return this.icon && this.icon.isDrawn()
    },
    onScreen: function () {
        var e = !1;
        return this.map && (e = this.map.getExtent().containsLonLat(this.lonlat)), e
    },
    inflate: function (e) {
        this.icon && this.icon.setSize({w: this.icon.size.w * e, h: this.icon.size.h * e})
    },
    setOpacity: function (e) {
        this.icon.setOpacity(e)
    },
    setUrl: function (e) {
        this.icon.setUrl(e)
    },
    display: function (e) {
        this.icon.display(e)
    },
    CLASS_NAME: "OpenLayers.Marker"
}),OpenLayers.Marker.defaultIcon = function () {
    return new OpenLayers.Icon(OpenLayers.Util.getImageLocation("marker.png"), {w: 21, h: 25}, {x: -10.5, y: -25})
},OpenLayers.Layer.TileCache = OpenLayers.Class(OpenLayers.Layer.Grid, {
    isBaseLayer: !0,
    format: "image/png",
    serverResolutions: null,
    initialize: function (e, t, i, n) {
        this.layername = i, OpenLayers.Layer.Grid.prototype.initialize.apply(this, [e, t, {}, n]), this.extension = this.format.split("/")[1].toLowerCase(), this.extension = "jpg" == this.extension ? "jpeg" : this.extension
    },
    clone: function (e) {
        return null == e && (e = new OpenLayers.Layer.TileCache(this.name, this.url, this.layername, this.getOptions())), e = OpenLayers.Layer.Grid.prototype.clone.apply(this, [e])
    },
    getURL: function (e) {
        function t(e, t) {
            for (var e = "" + e, i = [], n = 0; t > n; ++n)i.push("0");
            return i.join("").substring(0, t - e.length) + e
        }

        var i = this.getServerResolution(), n = this.maxExtent, s = this.tileSize, r = Math.round((e.left - n.left) / (i * s.w)), e = Math.round((e.bottom - n.bottom) / (i * s.h)), i = null != this.serverResolutions ? OpenLayers.Util.indexOf(this.serverResolutions, i) : this.map.getZoom(), r = [this.layername, t(i, 2), t(parseInt(r / 1e6), 3), t(parseInt(r / 1e3) % 1e3, 3), t(parseInt(r) % 1e3, 3), t(parseInt(e / 1e6), 3), t(parseInt(e / 1e3) % 1e3, 3), t(parseInt(e) % 1e3, 3) + "." + this.extension].join("/"), i = this.url;
        return OpenLayers.Util.isArray(i) && (i = this.selectUrl(r, i)), i = "/" == i.charAt(i.length - 1) ? i : i + "/", i + r
    },
    CLASS_NAME: "OpenLayers.Layer.TileCache"
}),OpenLayers.Layer.KaMap = OpenLayers.Class(OpenLayers.Layer.Grid, {
    isBaseLayer: !0,
    DEFAULT_PARAMS: {i: "jpeg", map: ""},
    initialize: function () {
        OpenLayers.Layer.Grid.prototype.initialize.apply(this, arguments), this.params = OpenLayers.Util.applyDefaults(this.params, this.DEFAULT_PARAMS)
    },
    getURL: function (e) {
        var e = this.adjustBounds(e), t = this.map.getResolution(), i = Math.round(1e4 * this.map.getScale()) / 1e4, n = Math.round(e.left / t);
        return this.getFullRequestString({t: -Math.round(e.top / t), l: n, s: i})
    },
    calculateGridLayout: function (e, t, i) {
        var t = i * this.tileSize.w, i = i * this.tileSize.h, n = e.left, s = Math.floor(n / t) - this.buffer, n = -(n / t - s) * this.tileSize.w, s = s * t, e = e.top, r = Math.ceil(e / i) + this.buffer;
        return {
            tilelon: t,
            tilelat: i,
            tileoffsetlon: s,
            tileoffsetlat: r * i,
            tileoffsetx: n,
            tileoffsety: -(r - e / i + 1) * this.tileSize.h
        }
    },
    clone: function (e) {
        return null == e && (e = new OpenLayers.Layer.KaMap(this.name, this.url, this.params, this.getOptions())), e = OpenLayers.Layer.Grid.prototype.clone.apply(this, [e]), null != this.tileSize && (e.tileSize = this.tileSize.clone()), e.grid = [], e
    },
    getTileBounds: function (e) {
        var t = this.getResolution(), i = t * this.tileSize.w, t = t * this.tileSize.h, n = this.getLonLatFromViewPortPx(e), e = i * Math.floor(n.lon / i), n = t * Math.floor(n.lat / t);
        return new OpenLayers.Bounds(e, n, e + i, n + t)
    },
    CLASS_NAME: "OpenLayers.Layer.KaMap"
}),OpenLayers.Control.TransformFeature = OpenLayers.Class(OpenLayers.Control, {
    geometryTypes: null,
    layer: null,
    preserveAspectRatio: !1,
    rotate: !0,
    feature: null,
    renderIntent: "temporary",
    rotationHandleSymbolizer: null,
    box: null,
    center: null,
    scale: 1,
    ratio: 1,
    rotation: 0,
    handles: null,
    rotationHandles: null,
    dragControl: null,
    irregular: !1,
    initialize: function (e, t) {
        OpenLayers.Control.prototype.initialize.apply(this, [t]), this.layer = e, this.rotationHandleSymbolizer || (this.rotationHandleSymbolizer = {
            stroke: !1,
            pointRadius: 10,
            fillOpacity: 0,
            cursor: "pointer"
        }), this.createBox(), this.createControl()
    },
    activate: function () {
        var e = !1;
        return OpenLayers.Control.prototype.activate.apply(this, arguments) && (this.dragControl.activate(), this.layer.addFeatures([this.box]), this.rotate && this.layer.addFeatures(this.rotationHandles), this.layer.addFeatures(this.handles), e = !0), e
    },
    deactivate: function () {
        var e = !1;
        return OpenLayers.Control.prototype.deactivate.apply(this, arguments) && (this.layer.removeFeatures(this.handles), this.rotate && this.layer.removeFeatures(this.rotationHandles), this.layer.removeFeatures([this.box]), this.dragControl.deactivate(), e = !0), e
    },
    setMap: function (e) {
        this.dragControl.setMap(e), OpenLayers.Control.prototype.setMap.apply(this, arguments)
    },
    setFeature: function (e, t) {
        var t = OpenLayers.Util.applyDefaults(t, {rotation: 0, scale: 1, ratio: 1}), i = this.rotation, n = this.center;
        if (OpenLayers.Util.extend(this, t), !1 !== this.events.triggerEvent("beforesetfeature", {feature: e})) {
            this.feature = e, this.activate(), this._setfeature = !0;
            var s = this.feature.geometry.getBounds();
            this.box.move(s.getCenterLonLat()), this.box.geometry.rotate(-i, n), this._angle = 0, this.rotation ? (i = e.geometry.clone(), i.rotate(-this.rotation, this.center), i = new OpenLayers.Feature.Vector(i.getBounds().toGeometry()), i.geometry.rotate(this.rotation, this.center), this.box.geometry.rotate(this.rotation, this.center), this.box.move(i.geometry.getBounds().getCenterLonLat()), i = i.geometry.components[0].components[0].getBounds().getCenterLonLat()) : i = new OpenLayers.LonLat(s.left, s.bottom), this.handles[0].move(i), delete this._setfeature, this.events.triggerEvent("setfeature", {feature: e})
        }
    },
    unsetFeature: function () {
        this.active ? this.deactivate() : (this.feature = null, this.rotation = 0, this.ratio = this.scale = 1)
    },
    createBox: function () {
        var e = this;
        this.center = new OpenLayers.Geometry.Point(0, 0), this.box = new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([new OpenLayers.Geometry.Point(-1, -1), new OpenLayers.Geometry.Point(0, -1), new OpenLayers.Geometry.Point(1, -1), new OpenLayers.Geometry.Point(1, 0), new OpenLayers.Geometry.Point(1, 1), new OpenLayers.Geometry.Point(0, 1), new OpenLayers.Geometry.Point(-1, 1), new OpenLayers.Geometry.Point(-1, 0), new OpenLayers.Geometry.Point(-1, -1)]), null, "string" == typeof this.renderIntent ? null : this.renderIntent), this.box.geometry.move = function (t, i) {
            e._moving = !0, OpenLayers.Geometry.LineString.prototype.move.apply(this, arguments), e.center.move(t, i), delete e._moving
        };
        for (var t, i, n, s = function (e, t) {
            OpenLayers.Geometry.Point.prototype.move.apply(this, arguments), this._rotationHandle && this._rotationHandle.geometry.move(e, t), this._handle.geometry.move(e, t)
        }, r = function (e, t, i) {
            OpenLayers.Geometry.Point.prototype.resize.apply(this, arguments), this._rotationHandle && this._rotationHandle.geometry.resize(e, t, i), this._handle.geometry.resize(e, t, i)
        }, a = function (e, t) {
            OpenLayers.Geometry.Point.prototype.rotate.apply(this, arguments), this._rotationHandle && this._rotationHandle.geometry.rotate(e, t), this._handle.geometry.rotate(e, t)
        }, o = function (t, i) {
            var n = this.x, s = this.y;
            if (OpenLayers.Geometry.Point.prototype.move.call(this, t, i), !e._moving) {
                var r = e.dragControl.handlers.drag.evt, a = !(!e._setfeature && e.preserveAspectRatio || r && r.shiftKey), o = new OpenLayers.Geometry.Point(n, s), r = e.center;
                this.rotate(-e.rotation, r), o.rotate(-e.rotation, r);
                var l = this.x - r.x, h = this.y - r.y, u = l - (this.x - o.x), c = h - (this.y - o.y);
                e.irregular && !e._setfeature && (l -= (this.x - o.x) / 2, h -= (this.y - o.y) / 2), this.x = n, this.y = s, o = 1, a ? (h = 1e-5 > Math.abs(c) ? 1 : h / c, o = (1e-5 > Math.abs(u) ? 1 : l / u) / h) : (u = Math.sqrt(u * u + c * c), h = Math.sqrt(l * l + h * h) / u), e._moving = !0, e.box.geometry.rotate(-e.rotation, r), delete e._moving, e.box.geometry.resize(h, r, o), e.box.geometry.rotate(e.rotation, r), e.transformFeature({
                    scale: h,
                    ratio: o
                }), e.irregular && !e._setfeature && (l = r.clone(), l.x += 1e-5 > Math.abs(n - r.x) ? 0 : this.x - n, l.y += 1e-5 > Math.abs(s - r.y) ? 0 : this.y - s, e.box.geometry.move(this.x - n, this.y - s), e.transformFeature({center: l}))
            }
        }, l = function (t, i) {
            var n = this.x, s = this.y;
            if (OpenLayers.Geometry.Point.prototype.move.call(this, t, i), !e._moving) {
                var r = e.dragControl.handlers.drag.evt, r = r && r.shiftKey ? 45 : 1, a = e.center, o = this.x - a.x, l = this.y - a.y;
                this.x = n, this.y = s, n = Math.atan2(l - i, o - t), n = Math.atan2(l, o) - n, n *= 180 / Math.PI, e._angle = (e._angle + n) % 360, n = e.rotation % r, (Math.abs(e._angle) >= r || 0 !== n) && (n = Math.round(e._angle / r) * r - n, e._angle = 0, e.box.geometry.rotate(n, a), e.transformFeature({rotation: n}))
            }
        }, h = Array(8), u = Array(4), c = "sw s se e ne n nw w".split(" "), p = 0; 8 > p; ++p)t = this.box.geometry.components[p], i = new OpenLayers.Feature.Vector(t.clone(), {role: c[p] + "-resize"}, "string" == typeof this.renderIntent ? null : this.renderIntent), 0 == p % 2 && (n = new OpenLayers.Feature.Vector(t.clone(), {role: c[p] + "-rotate"}, "string" == typeof this.rotationHandleSymbolizer ? null : this.rotationHandleSymbolizer), n.geometry.move = l, t._rotationHandle = n, u[p / 2] = n), t.move = s, t.resize = r, t.rotate = a, i.geometry.move = o, t._handle = i, h[p] = i;
        this.rotationHandles = u, this.handles = h
    },
    createControl: function () {
        var e = this;
        this.dragControl = new OpenLayers.Control.DragFeature(this.layer, {
            documentDrag: !0, moveFeature: function () {
                this.feature === e.feature && (this.feature = e.box), OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this, arguments)
            }, onDrag: function (t) {
                t === e.box && e.transformFeature({center: e.center})
            }, onStart: function (t) {
                var i = !e.geometryTypes || -1 !== OpenLayers.Util.indexOf(e.geometryTypes, t.geometry.CLASS_NAME), n = OpenLayers.Util.indexOf(e.handles, t), n = n + OpenLayers.Util.indexOf(e.rotationHandles, t);
                t !== e.feature && t !== e.box && -2 == n && i && e.setFeature(t)
            }, onComplete: function () {
                e.events.triggerEvent("transformcomplete", {feature: e.feature})
            }
        })
    },
    drawHandles: function () {
        for (var e = this.layer, t = 0; 8 > t; ++t)this.rotate && 0 === t % 2 && e.drawFeature(this.rotationHandles[t / 2], this.rotationHandleSymbolizer), e.drawFeature(this.handles[t], this.renderIntent)
    },
    transformFeature: function (e) {
        if (!this._setfeature) {
            this.scale *= e.scale || 1, this.ratio *= e.ratio || 1;
            var t = this.rotation;
            if (this.rotation = (this.rotation + (e.rotation || 0)) % 360, !1 !== this.events.triggerEvent("beforetransform", e)) {
                var i = this.feature, n = i.geometry, s = this.center;
                n.rotate(-t, s), e.scale || e.ratio ? n.resize(e.scale, s, e.ratio) : e.center && i.move(e.center.getBounds().getCenterLonLat()), n.rotate(this.rotation, s), this.layer.drawFeature(i), i.toState(OpenLayers.State.UPDATE), this.events.triggerEvent("transform", e)
            }
        }
        this.layer.drawFeature(this.box, this.renderIntent), this.drawHandles()
    },
    destroy: function () {
        for (var e, t = 0; 8 > t; ++t)e = this.box.geometry.components[t], e._handle.destroy(), e._handle = null, e._rotationHandle && e._rotationHandle.destroy(), e._rotationHandle = null;
        this.rotationHandles = this.rotationHandleSymbolizer = this.handles = this.feature = this.center = null, this.box.destroy(), this.layer = this.box = null, this.dragControl.destroy(), this.dragControl = null, OpenLayers.Control.prototype.destroy.apply(this, arguments)
    },
    CLASS_NAME: "OpenLayers.Control.TransformFeature"
}),OpenLayers.Handler.Box = OpenLayers.Class(OpenLayers.Handler, {
    dragHandler: null,
    boxDivClassName: "olHandlerBoxZoomBox",
    boxOffsets: null,
    initialize: function () {
        OpenLayers.Handler.prototype.initialize.apply(this, arguments), this.dragHandler = new OpenLayers.Handler.Drag(this, {
            down: this.startBox,
            move: this.moveBox,
            out: this.removeBox,
            up: this.endBox
        }, {keyMask: this.keyMask})
    },
    destroy: function () {
        OpenLayers.Handler.prototype.destroy.apply(this, arguments), this.dragHandler && (this.dragHandler.destroy(), this.dragHandler = null)
    },
    setMap: function (e) {
        OpenLayers.Handler.prototype.setMap.apply(this, arguments), this.dragHandler && this.dragHandler.setMap(e)
    },
    startBox: function () {
        this.callback("start", []), this.zoomBox = OpenLayers.Util.createDiv("zoomBox", {
            x: -9999,
            y: -9999
        }), this.zoomBox.className = this.boxDivClassName, this.zoomBox.style.zIndex = this.map.Z_INDEX_BASE.Popup - 1, this.map.viewPortDiv.appendChild(this.zoomBox), OpenLayers.Element.addClass(this.map.viewPortDiv, "olDrawBox")
    },
    moveBox: function (e) {
        var t = this.dragHandler.start.x, i = this.dragHandler.start.y, n = Math.abs(t - e.x), s = Math.abs(i - e.y), r = this.getBoxOffsets();
        this.zoomBox.style.width = n + r.width + 1 + "px", this.zoomBox.style.height = s + r.height + 1 + "px", this.zoomBox.style.left = (e.x < t ? t - n - r.left : t - r.left) + "px", this.zoomBox.style.top = (e.y < i ? i - s - r.top : i - r.top) + "px"
    },
    endBox: function (e) {
        var t;
        if (5 < Math.abs(this.dragHandler.start.x - e.x) || 5 < Math.abs(this.dragHandler.start.y - e.y)) {
            var i = this.dragHandler.start;
            t = Math.min(i.y, e.y);
            var n = Math.max(i.y, e.y), s = Math.min(i.x, e.x), e = Math.max(i.x, e.x);
            t = new OpenLayers.Bounds(s, n, e, t)
        } else t = this.dragHandler.start.clone();
        this.removeBox(), this.callback("done", [t])
    },
    removeBox: function () {
        this.map.viewPortDiv.removeChild(this.zoomBox), this.boxOffsets = this.zoomBox = null, OpenLayers.Element.removeClass(this.map.viewPortDiv, "olDrawBox")
    },
    activate: function () {
        return OpenLayers.Handler.prototype.activate.apply(this, arguments) ? (this.dragHandler.activate(), !0) : !1
    },
    deactivate: function () {
        return OpenLayers.Handler.prototype.deactivate.apply(this, arguments) ? (this.dragHandler.deactivate() && this.zoomBox && this.removeBox(), !0) : !1
    },
    getBoxOffsets: function () {
        if (!this.boxOffsets) {
            var e = document.createElement("div");
            e.style.position = "absolute", e.style.border = "1px solid black", e.style.width = "3px", document.body.appendChild(e);
            var t = 3 == e.clientWidth;
            document.body.removeChild(e);
            var e = parseInt(OpenLayers.Element.getStyle(this.zoomBox, "border-left-width")), i = parseInt(OpenLayers.Element.getStyle(this.zoomBox, "border-right-width")), n = parseInt(OpenLayers.Element.getStyle(this.zoomBox, "border-top-width")), s = parseInt(OpenLayers.Element.getStyle(this.zoomBox, "border-bottom-width"));
            this.boxOffsets = {
                left: e,
                right: i,
                top: n,
                bottom: s,
                width: !1 === t ? e + i : 0,
                height: !1 === t ? n + s : 0
            }
        }
        return this.boxOffsets
    },
    CLASS_NAME: "OpenLayers.Handler.Box"
}),OpenLayers.Control.ZoomBox = OpenLayers.Class(OpenLayers.Control, {
    type: OpenLayers.Control.TYPE_TOOL,
    out: !1,
    keyMask: null,
    alwaysZoom: !1,
    draw: function () {
        this.handler = new OpenLayers.Handler.Box(this, {done: this.zoomBox}, {keyMask: this.keyMask})
    },
    zoomBox: function (e) {
        if (e instanceof OpenLayers.Bounds) {
            var t;
            if (this.out) {
                t = Math.abs(e.right - e.left);
                var i = Math.abs(e.top - e.bottom);
                t = Math.min(this.map.size.h / i, this.map.size.w / t);
                var i = this.map.getExtent(), n = this.map.getLonLatFromPixel(e.getCenterPixel()), e = n.lon - i.getWidth() / 2 * t, s = n.lon + i.getWidth() / 2 * t, r = n.lat - i.getHeight() / 2 * t;
                t = n.lat + i.getHeight() / 2 * t, t = new OpenLayers.Bounds(e, r, s, t)
            } else t = this.map.getLonLatFromPixel({
                x: e.left,
                y: e.bottom
            }), i = this.map.getLonLatFromPixel({
                x: e.right,
                y: e.top
            }), t = new OpenLayers.Bounds(t.lon, t.lat, i.lon, i.lat);
            i = this.map.getZoom(), this.map.zoomToExtent(t), i == this.map.getZoom() && 1 == this.alwaysZoom && this.map.zoomTo(i + (this.out ? -1 : 1))
        } else this.out ? this.map.setCenter(this.map.getLonLatFromPixel(e), this.map.getZoom() - 1) : this.map.setCenter(this.map.getLonLatFromPixel(e), this.map.getZoom() + 1)
    },
    CLASS_NAME: "OpenLayers.Control.ZoomBox"
}),OpenLayers.Control.DragPan = OpenLayers.Class(OpenLayers.Control, {
    type: OpenLayers.Control.TYPE_TOOL,
    panned: !1,
    interval: 1,
    documentDrag: !1,
    kinetic: null,
    enableKinetic: !1,
    kineticInterval: 10,
    draw: function () {
        if (this.enableKinetic) {
            var e = {interval: this.kineticInterval};
            "object" == typeof this.enableKinetic && (e = OpenLayers.Util.extend(e, this.enableKinetic)), this.kinetic = new OpenLayers.Kinetic(e)
        }
        this.handler = new OpenLayers.Handler.Drag(this, {
            move: this.panMap,
            done: this.panMapDone,
            down: this.panMapStart
        }, {interval: this.interval, documentDrag: this.documentDrag})
    },
    panMapStart: function () {
        this.kinetic && this.kinetic.begin()
    },
    panMap: function (e) {
        this.kinetic && this.kinetic.update(e), this.panned = !0, this.map.pan(this.handler.last.x - e.x, this.handler.last.y - e.y, {
            dragging: !0,
            animate: !1
        })
    },
    panMapDone: function (e) {
        if (this.panned) {
            var t = null;
            if (this.kinetic && (t = this.kinetic.end(e)), this.map.pan(this.handler.last.x - e.x, this.handler.last.y - e.y, {
                    dragging: !!t,
                    animate: !1
                }), t) {
                var i = this;
                this.kinetic.move(t, function (e, t, n) {
                    i.map.pan(e, t, {dragging: !n, animate: !1})
                })
            }
            this.panned = !1
        }
    },
    CLASS_NAME: "OpenLayers.Control.DragPan"
}),OpenLayers.Handler.Click = OpenLayers.Class(OpenLayers.Handler, {
    delay: 300,
    single: !0,
    "double": !1,
    pixelTolerance: 0,
    dblclickTolerance: 13,
    stopSingle: !1,
    stopDouble: !1,
    timerId: null,
    touch: !1,
    down: null,
    last: null,
    first: null,
    rightclickTimerId: null,
    touchstart: function (e) {
        return this.touch || (this.unregisterMouseListeners(), this.touch = !0), this.down = this.getEventInfo(e), this.last = this.getEventInfo(e), !0
    },
    touchmove: function (e) {
        return this.last = this.getEventInfo(e), !0
    },
    touchend: function (e) {
        return this.down && (e.xy = this.last.xy, e.lastTouches = this.last.touches, this.handleSingle(e), this.down = null), !0
    },
    unregisterMouseListeners: function () {
        this.map.events.un({
            mousedown: this.mousedown,
            mouseup: this.mouseup,
            click: this.click,
            dblclick: this.dblclick,
            scope: this
        })
    },
    mousedown: function (e) {
        return this.down = this.getEventInfo(e), this.last = this.getEventInfo(e), !0
    },
    mouseup: function (e) {
        var t = !0;
        return this.checkModifiers(e) && this.control.handleRightClicks && OpenLayers.Event.isRightClick(e) && (t = this.rightclick(e)), t
    },
    rightclick: function (e) {
        if (this.passesTolerance(e)) {
            if (null != this.rightclickTimerId)return this.clearTimer(), this.callback("dblrightclick", [e]), !this.stopDouble;
            e = this["double"] ? OpenLayers.Util.extend({}, e) : this.callback("rightclick", [e]), e = OpenLayers.Function.bind(this.delayedRightCall, this, e), this.rightclickTimerId = window.setTimeout(e, this.delay)
        }
        return !this.stopSingle
    },
    delayedRightCall: function (e) {
        this.rightclickTimerId = null, e && this.callback("rightclick", [e])
    },
    click: function (e) {
        return this.last || (this.last = this.getEventInfo(e)), this.handleSingle(e), !this.stopSingle
    },
    dblclick: function (e) {
        return this.handleDouble(e), !this.stopDouble
    },
    handleDouble: function (e) {
        this.passesDblclickTolerance(e) && (this["double"] && this.callback("dblclick", [e]), this.clearTimer())
    },
    handleSingle: function (e) {
        this.passesTolerance(e) && (null != this.timerId ? (this.last.touches && 1 === this.last.touches.length && (this["double"] && OpenLayers.Event.stop(e), this.handleDouble(e)), (!this.last.touches || 2 !== this.last.touches.length) && this.clearTimer()) : (this.first = this.getEventInfo(e), this.queuePotentialClick(this.single ? OpenLayers.Util.extend({}, e) : null)))
    },
    queuePotentialClick: function (e) {
        this.timerId = window.setTimeout(OpenLayers.Function.bind(this.delayedCall, this, e), this.delay)
    },
    passesTolerance: function (e) {
        var t = !0;
        if (null != this.pixelTolerance && this.down && this.down.xy && (t = this.pixelTolerance >= this.down.xy.distanceTo(e.xy)) && this.touch && this.down.touches.length === this.last.touches.length)for (var e = 0, i = this.down.touches.length; i > e; ++e)if (this.getTouchDistance(this.down.touches[e], this.last.touches[e]) > this.pixelTolerance) {
            t = !1;
            break
        }
        return t
    },
    getTouchDistance: function (e, t) {
        return Math.sqrt(Math.pow(e.clientX - t.clientX, 2) + Math.pow(e.clientY - t.clientY, 2))
    },
    passesDblclickTolerance: function () {
        var e = !0;
        return this.down && this.first && (e = this.down.xy.distanceTo(this.first.xy) <= this.dblclickTolerance), e
    },
    clearTimer: function () {
        null != this.timerId && (window.clearTimeout(this.timerId), this.timerId = null), null != this.rightclickTimerId && (window.clearTimeout(this.rightclickTimerId), this.rightclickTimerId = null)
    },
    delayedCall: function (e) {
        this.timerId = null, e && this.callback("click", [e])
    },
    getEventInfo: function (e) {
        var t;
        if (e.touches) {
            var i = e.touches.length;
            t = Array(i);
            for (var n, s = 0; i > s; s++)n = e.touches[s], t[s] = {clientX: n.clientX, clientY: n.clientY}
        }
        return {xy: e.xy, touches: t}
    },
    deactivate: function () {
        var e = !1;
        return OpenLayers.Handler.prototype.deactivate.apply(this, arguments) && (this.clearTimer(), this.last = this.first = this.down = null, this.touch = !1, e = !0), e
    },
    CLASS_NAME: "OpenLayers.Handler.Click"
}),OpenLayers.Control.Navigation = OpenLayers.Class(OpenLayers.Control, {
    dragPan: null,
    dragPanOptions: null,
    pinchZoom: null,
    pinchZoomOptions: null,
    documentDrag: !1,
    zoomBox: null,
    zoomBoxEnabled: !0,
    zoomWheelEnabled: !0,
    mouseWheelOptions: null,
    handleRightClicks: !1,
    zoomBoxKeyMask: OpenLayers.Handler.MOD_SHIFT,
    autoActivate: !0,
    initialize: function () {
        this.handlers = {}, OpenLayers.Control.prototype.initialize.apply(this, arguments)
    },
    destroy: function () {
        this.deactivate(), this.dragPan && this.dragPan.destroy(), this.dragPan = null, this.zoomBox && this.zoomBox.destroy(), this.zoomBox = null, this.pinchZoom && this.pinchZoom.destroy(), this.pinchZoom = null, OpenLayers.Control.prototype.destroy.apply(this, arguments)
    },
    activate: function () {
        return this.dragPan.activate(), this.zoomWheelEnabled && this.handlers.wheel.activate(), this.handlers.click.activate(), this.zoomBoxEnabled && this.zoomBox.activate(), this.pinchZoom && this.pinchZoom.activate(), OpenLayers.Control.prototype.activate.apply(this, arguments)
    },
    deactivate: function () {
        return this.pinchZoom && this.pinchZoom.deactivate(), this.zoomBox.deactivate(), this.dragPan.deactivate(), this.handlers.click.deactivate(), this.handlers.wheel.deactivate(), OpenLayers.Control.prototype.deactivate.apply(this, arguments)
    },
    draw: function () {
        this.handleRightClicks && (this.map.viewPortDiv.oncontextmenu = OpenLayers.Function.False), this.handlers.click = new OpenLayers.Handler.Click(this, {
            click: this.defaultClick,
            dblclick: this.defaultDblClick,
            dblrightclick: this.defaultDblRightClick
        }, {
            "double": !0,
            stopDouble: !0
        }), this.dragPan = new OpenLayers.Control.DragPan(OpenLayers.Util.extend({
            map: this.map,
            documentDrag: this.documentDrag
        }, this.dragPanOptions)), this.zoomBox = new OpenLayers.Control.ZoomBox({
            map: this.map,
            keyMask: this.zoomBoxKeyMask
        }), this.dragPan.draw(), this.zoomBox.draw(), this.handlers.wheel = new OpenLayers.Handler.MouseWheel(this, {
            up: this.wheelUp,
            down: this.wheelDown
        }, this.mouseWheelOptions), OpenLayers.Control.PinchZoom && (this.pinchZoom = new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map: this.map}, this.pinchZoomOptions)))
    },
    defaultClick: function (e) {
        e.lastTouches && 2 == e.lastTouches.length && this.map.zoomOut()
    },
    defaultDblClick: function (e) {
        this.map.setCenter(this.map.getLonLatFromViewPortPx(e.xy), this.map.zoom + 1)
    },
    defaultDblRightClick: function (e) {
        this.map.setCenter(this.map.getLonLatFromViewPortPx(e.xy), this.map.zoom - 1)
    },
    wheelChange: function (e, t) {
        var i = this.map.getZoom(), n = this.map.getZoom() + Math.round(t), n = Math.max(n, 0), n = Math.min(n, this.map.getNumZoomLevels());
        if (n !== i) {
            var s = this.map.getSize(), i = s.w / 2 - e.xy.x, s = e.xy.y - s.h / 2, r = this.map.baseLayer.getResolutionForZoom(n), a = this.map.getLonLatFromPixel(e.xy);
            this.map.setCenter(new OpenLayers.LonLat(a.lon + i * r, a.lat + s * r), n)
        }
    },
    wheelUp: function (e, t) {
        this.wheelChange(e, t || 1)
    },
    wheelDown: function (e, t) {
        this.wheelChange(e, t || -1)
    },
    disableZoomBox: function () {
        this.zoomBoxEnabled = !1, this.zoomBox.deactivate()
    },
    enableZoomBox: function () {
        this.zoomBoxEnabled = !0, this.active && this.zoomBox.activate()
    },
    disableZoomWheel: function () {
        this.zoomWheelEnabled = !1, this.handlers.wheel.deactivate()
    },
    enableZoomWheel: function () {
        this.zoomWheelEnabled = !0, this.active && this.handlers.wheel.activate()
    },
    CLASS_NAME: "OpenLayers.Control.Navigation"
}),OpenLayers.Control.DrawFeature = OpenLayers.Class(OpenLayers.Control, {
    layer: null,
    callbacks: null,
    multi: !1,
    featureAdded: function () {
    },
    handlerOptions: null,
    initialize: function (e, t, i) {
        OpenLayers.Control.prototype.initialize.apply(this, [i]), this.callbacks = OpenLayers.Util.extend({
            done: this.drawFeature,
            modify: function (e, t) {
                this.layer.events.triggerEvent("sketchmodified", {vertex: e, feature: t})
            },
            create: function (e, t) {
                this.layer.events.triggerEvent("sketchstarted", {vertex: e, feature: t})
            }
        }, this.callbacks), this.layer = e, this.handlerOptions = this.handlerOptions || {}, this.handlerOptions.layerOptions = OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions, {
            renderers: e.renderers,
            rendererOptions: e.rendererOptions
        }), "multi" in this.handlerOptions || (this.handlerOptions.multi = this.multi), (e = this.layer.styleMap && this.layer.styleMap.styles.temporary) && (this.handlerOptions.layerOptions = OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions, {styleMap: new OpenLayers.StyleMap({"default": e})})), this.handler = new t(this, this.callbacks, this.handlerOptions)
    },
    drawFeature: function (e) {
        e = new OpenLayers.Feature.Vector(e), !1 !== this.layer.events.triggerEvent("sketchcomplete", {feature: e}) && (e.state = OpenLayers.State.INSERT, this.layer.addFeatures([e]), this.featureAdded(e), this.events.triggerEvent("featureadded", {feature: e}))
    },
    insertXY: function (e, t) {
        this.handler && this.handler.line && this.handler.insertXY(e, t)
    },
    insertDeltaXY: function (e, t) {
        this.handler && this.handler.line && this.handler.insertDeltaXY(e, t)
    },
    insertDirectionLength: function (e, t) {
        this.handler && this.handler.line && this.handler.insertDirectionLength(e, t)
    },
    insertDeflectionLength: function (e, t) {
        this.handler && this.handler.line && this.handler.insertDeflectionLength(e, t)
    },
    undo: function () {
        return this.handler.undo && this.handler.undo()
    },
    redo: function () {
        return this.handler.redo && this.handler.redo()
    },
    finishSketch: function () {
        this.handler.finishGeometry()
    },
    cancel: function () {
        this.handler.cancel()
    },
    CLASS_NAME: "OpenLayers.Control.DrawFeature"
}),OpenLayers.Handler.Polygon = OpenLayers.Class(OpenLayers.Handler.Path, {
    holeModifier: null,
    drawingHole: !1,
    polygon: null,
    createFeature: function (e) {
        e = this.layer.getLonLatFromViewPortPx(e), e = new OpenLayers.Geometry.Point(e.lon, e.lat), this.point = new OpenLayers.Feature.Vector(e), this.line = new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LinearRing([this.point.geometry])), this.polygon = new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([this.line.geometry])), this.callback("create", [this.point.geometry, this.getSketch()]), this.point.geometry.clearBounds(), this.layer.addFeatures([this.polygon, this.point], {silent: !0})
    },
    addPoint: function () {
        if (!this.drawingHole && this.holeModifier && this.evt && this.evt[this.holeModifier])for (var e, t = this.point.geometry, i = this.control.layer.features, n = i.length - 1; n >= 0; --n)if (e = i[n].geometry, (e instanceof OpenLayers.Geometry.Polygon || e instanceof OpenLayers.Geometry.MultiPolygon) && e.intersects(t)) {
            t = i[n], this.control.layer.removeFeatures([t], {silent: !0}), this.control.layer.events.registerPriority("sketchcomplete", this, this.finalizeInteriorRing), this.control.layer.events.registerPriority("sketchmodified", this, this.enforceTopology), t.geometry.addComponent(this.line.geometry), this.polygon = t, this.drawingHole = !0;
            break
        }
        OpenLayers.Handler.Path.prototype.addPoint.apply(this, arguments)
    },
    getCurrentPointIndex: function () {
        return this.line.geometry.components.length - 2
    },
    enforceTopology: function (e) {
        var e = e.vertex, t = this.line.geometry.components;
        this.polygon.geometry.intersects(e) || (t = t[t.length - 3], e.x = t.x, e.y = t.y)
    },
    finishGeometry: function () {
        this.line.geometry.removeComponent(this.line.geometry.components[this.line.geometry.components.length - 2]), this.removePoint(), this.finalize()
    },
    finalizeInteriorRing: function () {
        var e = this.line.geometry, t = 0 !== e.getArea();
        if (t) {
            for (var i = this.polygon.geometry.components, n = i.length - 2; n >= 0; --n)if (e.intersects(i[n])) {
                t = !1;
                break
            }
            if (t) {
                n = i.length - 2;
                e:for (; n > 0; --n)for (var s = i[n].components, r = 0, a = s.length; a > r; ++r)if (e.containsPoint(s[r])) {
                    t = !1;
                    break e
                }
            }
        }
        return t ? this.polygon.state !== OpenLayers.State.INSERT && (this.polygon.state = OpenLayers.State.UPDATE) : this.polygon.geometry.removeComponent(e), this.restoreFeature(), !1
    },
    cancel: function () {
        return this.drawingHole && (this.polygon.geometry.removeComponent(this.line.geometry), this.restoreFeature(!0)), OpenLayers.Handler.Path.prototype.cancel.apply(this, arguments)
    },
    restoreFeature: function (e) {
        this.control.layer.events.unregister("sketchcomplete", this, this.finalizeInteriorRing), this.control.layer.events.unregister("sketchmodified", this, this.enforceTopology), this.layer.removeFeatures([this.polygon], {silent: !0}), this.control.layer.addFeatures([this.polygon], {silent: !0}), this.drawingHole = !1, e || this.control.layer.events.triggerEvent("sketchcomplete", {feature: this.polygon})
    },
    destroyFeature: function (e) {
        OpenLayers.Handler.Path.prototype.destroyFeature.call(this, e), this.polygon = null
    },
    drawFeature: function () {
        this.layer.drawFeature(this.polygon, this.style), this.layer.drawFeature(this.point, this.style)
    },
    getSketch: function () {
        return this.polygon
    },
    getGeometry: function () {
        var e = this.polygon && this.polygon.geometry;
        return e && this.multi && (e = new OpenLayers.Geometry.MultiPolygon([e])), e
    },
    CLASS_NAME: "OpenLayers.Handler.Polygon"
}),OpenLayers.Control.EditingToolbar = OpenLayers.Class(OpenLayers.Control.Panel, {
    citeCompliant: !1,
    initialize: function (e, t) {
        OpenLayers.Control.Panel.prototype.initialize.apply(this, [t]), this.addControls([new OpenLayers.Control.Navigation]), this.addControls([new OpenLayers.Control.DrawFeature(e, OpenLayers.Handler.Point, {
            displayClass: "olControlDrawFeaturePoint",
            handlerOptions: {citeCompliant: this.citeCompliant}
        }), new OpenLayers.Control.DrawFeature(e, OpenLayers.Handler.Path, {
            displayClass: "olControlDrawFeaturePath",
            handlerOptions: {citeCompliant: this.citeCompliant}
        }), new OpenLayers.Control.DrawFeature(e, OpenLayers.Handler.Polygon, {
            displayClass: "olControlDrawFeaturePolygon",
            handlerOptions: {citeCompliant: this.citeCompliant}
        })])
    },
    draw: function () {
        var e = OpenLayers.Control.Panel.prototype.draw.apply(this, arguments);
        return null === this.defaultControl && (this.defaultControl = this.controls[0]), e
    },
    CLASS_NAME: "OpenLayers.Control.EditingToolbar"
}),OpenLayers.Strategy.BBOX = OpenLayers.Class(OpenLayers.Strategy, {
    bounds: null, resolution: null, ratio: 2, resFactor: null, response: null, activate: function () {
        var e = OpenLayers.Strategy.prototype.activate.call(this);
        return e && (this.layer.events.on({
            moveend: this.update,
            refresh: this.update,
            visibilitychanged: this.update,
            scope: this
        }), this.update()), e
    }, deactivate: function () {
        var e = OpenLayers.Strategy.prototype.deactivate.call(this);
        return e && this.layer.events.un({
            moveend: this.update,
            refresh: this.update,
            visibilitychanged: this.update,
            scope: this
        }), e
    }, update: function (e) {
        var t = this.getMapBounds();
        null !== t && (e && e.force || this.layer.visibility && this.layer.calculateInRange() && this.invalidBounds(t)) && (this.calculateBounds(t), this.resolution = this.layer.map.getResolution(), this.triggerRead(e))
    }, getMapBounds: function () {
        if (null === this.layer.map)return null;
        var e = this.layer.map.getExtent();
        return e && !this.layer.projection.equals(this.layer.map.getProjectionObject()) && (e = e.clone().transform(this.layer.map.getProjectionObject(), this.layer.projection)), e
    }, invalidBounds: function (e) {
        return e || (e = this.getMapBounds()), e = !this.bounds || !this.bounds.containsBounds(e), !e && this.resFactor && (e = this.resolution / this.layer.map.getResolution(), e = e >= this.resFactor || e <= 1 / this.resFactor), e
    }, calculateBounds: function (e) {
        e || (e = this.getMapBounds());
        var t = e.getCenterLonLat(), i = e.getWidth() * this.ratio, e = e.getHeight() * this.ratio;
        this.bounds = new OpenLayers.Bounds(t.lon - i / 2, t.lat - e / 2, t.lon + i / 2, t.lat + e / 2)
    }, triggerRead: function (e) {
        this.response && !(e && !0 === e.noAbort) && (this.layer.protocol.abort(this.response), this.layer.events.triggerEvent("loadend")), this.layer.events.triggerEvent("loadstart"), this.response = this.layer.protocol.read(OpenLayers.Util.applyDefaults({
            filter: this.createFilter(),
            callback: this.merge,
            scope: this
        }, e))
    }, createFilter: function () {
        var e = new OpenLayers.Filter.Spatial({
            type: OpenLayers.Filter.Spatial.BBOX,
            value: this.bounds,
            projection: this.layer.projection
        });
        return this.layer.filter && (e = new OpenLayers.Filter.Logical({
            type: OpenLayers.Filter.Logical.AND,
            filters: [this.layer.filter, e]
        })), e
    }, merge: function (e) {
        if (this.layer.destroyFeatures(), (e = e.features) && 0 < e.length) {
            var t = this.layer.projection, i = this.layer.map.getProjectionObject();
            if (!i.equals(t))for (var n, s = 0, r = e.length; r > s; ++s)(n = e[s].geometry) && n.transform(t, i);
            this.layer.addFeatures(e)
        }
        this.response = null, this.layer.events.triggerEvent("loadend")
    }, CLASS_NAME: "OpenLayers.Strategy.BBOX"
}),OpenLayers.Layer.WorldWind = OpenLayers.Class(OpenLayers.Layer.Grid, {
    DEFAULT_PARAMS: {},
    isBaseLayer: !0,
    lzd: null,
    zoomLevels: null,
    initialize: function (e, t, i, n, s, r) {
        this.lzd = i, this.zoomLevels = n, i = [], i.push(e, t, s, r), OpenLayers.Layer.Grid.prototype.initialize.apply(this, i), this.params = OpenLayers.Util.applyDefaults(this.params, this.DEFAULT_PARAMS)
    },
    getZoom: function () {
        var e = this.map.getZoom();
        return this.map.getMaxExtent(), e -= Math.log(this.maxResolution / (this.lzd / 512)) / Math.log(2)
    },
    getURL: function (e) {
        var e = this.adjustBounds(e), t = this.getZoom(), i = this.map.getMaxExtent(), n = this.lzd / Math.pow(2, this.getZoom()), s = Math.floor((e.left - i.left) / n), e = Math.floor((e.bottom - i.bottom) / n);
        return this.map.getResolution() <= this.lzd / 512 && this.getZoom() <= this.zoomLevels ? this.getFullRequestString({
            L: t,
            X: s,
            Y: e
        }) : OpenLayers.Util.getImageLocation("blank.gif")
    },
    CLASS_NAME: "OpenLayers.Layer.WorldWind"
}),OpenLayers.Protocol.CSW = function (e) {
    var e = OpenLayers.Util.applyDefaults(e, OpenLayers.Protocol.CSW.DEFAULTS), t = OpenLayers.Protocol.CSW["v" + e.version.replace(/\./g, "_")];
    if (!t)throw"Unsupported CSW version: " + e.version;
    return new t(e)
},OpenLayers.Protocol.CSW.DEFAULTS = {version: "2.0.2"},OpenLayers.Format.WMTSCapabilities = OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC, {
    defaultVersion: "1.0.0",
    yx: {"urn:ogc:def:crs:EPSG::4326": !0},
    createLayer: function (e, t) {
        var i, n, s = {layer: !0, matrixSet: !0};
        for (n in s)if (!(n in t))throw Error("Missing property '" + n + "' in layer configuration.");
        s = e.contents, n = s.tileMatrixSets[t.matrixSet];
        for (var r, a = 0, o = s.layers.length; o > a; ++a)if (s.layers[a].identifier === t.layer) {
            r = s.layers[a];
            break
        }
        if (r && n) {
            for (var l, a = 0, o = r.styles.length; o > a && (l = r.styles[a], !l.isDefault); ++a);
            i = new OpenLayers.Layer.WMTS(OpenLayers.Util.applyDefaults(t, {
                url: "REST" === t.requestEncoding && r.resourceUrl ? r.resourceUrl.tile.template : e.operationsMetadata.GetTile.dcp.http.get[0].url,
                name: r.title,
                style: l.identifier,
                matrixIds: n.matrixIds,
                tileFullExtent: n.bounds
            }))
        }
        return i
    },
    CLASS_NAME: "OpenLayers.Format.WMTSCapabilities"
}),OpenLayers.Layer.Google.v3 = {
    DEFAULTS: {sphericalMercator: !0, projection: "EPSG:900913"},
    animationEnabled: !0,
    loadMapObject: function () {
        this.type || (this.type = google.maps.MapTypeId.ROADMAP);
        var e, t = OpenLayers.Layer.Google.cache[this.map.id];
        t ? (e = t.mapObject, ++t.count) : (t = this.map.viewPortDiv, e = document.createElement("div"), e.id = this.map.id + "_GMapContainer", e.style.position = "absolute", e.style.width = "100%", e.style.height = "100%", t.appendChild(e), t = this.map.getCenter(), e = new google.maps.Map(e, {
            center: t ? new google.maps.LatLng(t.lat, t.lon) : new google.maps.LatLng(0, 0),
            zoom: this.map.getZoom() || 0,
            mapTypeId: this.type,
            disableDefaultUI: !0,
            keyboardShortcuts: !1,
            draggable: !1,
            disableDoubleClickZoom: !0,
            scrollwheel: !1,
            streetViewControl: !1
        }), t = {
            mapObject: e,
            count: 1
        }, OpenLayers.Layer.Google.cache[this.map.id] = t, this.repositionListener = google.maps.event.addListenerOnce(e, "center_changed", OpenLayers.Function.bind(this.repositionMapElements, this))), this.mapObject = e, this.setGMapVisibility(this.visibility)
    },
    repositionMapElements: function () {
        google.maps.event.trigger(this.mapObject, "resize");
        var e = this.mapObject.getDiv().firstChild;
        if (!e || 3 > e.childNodes.length)return this.repositionTimer = window.setTimeout(OpenLayers.Function.bind(this.repositionMapElements, this), 250), !1;
        for (var t = OpenLayers.Layer.Google.cache[this.map.id], i = this.map.viewPortDiv, n = e.children.length - 1; n >= 0; --n) {
            if (1000001 == e.children[n].style.zIndex) {
                var s = e.children[n];
                i.appendChild(s), s.style.zIndex = "1100", s.style.bottom = "", s.className = "olLayerGoogleCopyright olLayerGoogleV3", s.style.display = "", t.termsOfUse = s
            }
            1e6 == e.children[n].style.zIndex && (s = e.children[n], i.appendChild(s), s.style.zIndex = "1100", s.style.bottom = "", s.className = "olLayerGooglePoweredBy olLayerGoogleV3 gmnoprint", s.style.display = "", t.poweredBy = s), 10000002 == e.children[n].style.zIndex && i.appendChild(e.children[n])
        }
        this.setGMapVisibility(this.visibility)
    },
    onMapResize: function () {
        if (this.visibility) google.maps.event.trigger(this.mapObject, "resize"); else {
            var e = OpenLayers.Layer.Google.cache[this.map.id];
            if (!e.resized) {
                var t = this;
                google.maps.event.addListenerOnce(this.mapObject, "tilesloaded", function () {
                    google.maps.event.trigger(t.mapObject, "resize"), t.moveTo(t.map.getCenter(), t.map.getZoom()), delete e.resized
                })
            }
            e.resized = !0
        }
    },
    setGMapVisibility: function (e) {
        var t = OpenLayers.Layer.Google.cache[this.map.id];
        if (t) {
            for (var i, n = this.type, s = this.map.layers, r = s.length - 1; r >= 0; --r)if (i = s[r], i instanceof OpenLayers.Layer.Google && !0 === i.visibility && !0 === i.inRange) {
                n = i.type, e = !0;
                break
            }
            s = this.mapObject.getDiv(), !0 === e ? (this.mapObject.setMapTypeId(n), s.style.left = "", t.termsOfUse && t.termsOfUse.style && (t.termsOfUse.style.left = "", t.termsOfUse.style.display = "", t.poweredBy.style.display = ""), t.displayed = this.id) : (delete t.displayed, s.style.left = "-9999px", t.termsOfUse && t.termsOfUse.style && (t.termsOfUse.style.display = "none", t.termsOfUse.style.left = "-9999px", t.poweredBy.style.display = "none"))
        }
    },
    getMapContainer: function () {
        return this.mapObject.getDiv()
    },
    getMapObjectBoundsFromOLBounds: function (e) {
        var t = null;
        return null != e && (t = this.sphericalMercator ? this.inverseMercator(e.bottom, e.left) : new OpenLayers.LonLat(e.bottom, e.left), e = this.sphericalMercator ? this.inverseMercator(e.top, e.right) : new OpenLayers.LonLat(e.top, e.right), t = new google.maps.LatLngBounds(new google.maps.LatLng(t.lat, t.lon), new google.maps.LatLng(e.lat, e.lon))), t
    },
    getMapObjectLonLatFromMapObjectPixel: function (e) {
        var t = this.map.getSize(), i = this.getLongitudeFromMapObjectLonLat(this.mapObject.center), n = this.getLatitudeFromMapObjectLonLat(this.mapObject.center), s = this.map.getResolution(), e = new OpenLayers.LonLat(i + (e.x - t.w / 2) * s, n - (e.y - t.h / 2) * s);
        return this.wrapDateLine && (e = e.wrapDateLine(this.maxExtent)), this.getMapObjectLonLatFromLonLat(e.lon, e.lat)
    },
    getMapObjectPixelFromMapObjectLonLat: function (e) {
        var t = this.getLongitudeFromMapObjectLonLat(e), e = this.getLatitudeFromMapObjectLonLat(e), i = this.map.getResolution(), n = this.map.getExtent();
        return this.getMapObjectPixelFromXY(1 / i * (t - n.left), 1 / i * (n.top - e))
    },
    setMapObjectCenter: function (e, t) {
        if (!1 === this.animationEnabled && t != this.mapObject.zoom) {
            var i = this.getMapContainer();
            google.maps.event.addListenerOnce(this.mapObject, "idle", function () {
                i.style.visibility = ""
            }), i.style.visibility = "hidden"
        }
        this.mapObject.setOptions({center: e, zoom: t})
    },
    getMapObjectZoomFromMapObjectBounds: function (e) {
        return this.mapObject.getBoundsZoomLevel(e)
    },
    getMapObjectLonLatFromLonLat: function (e, t) {
        var i;
        return this.sphericalMercator ? (i = this.inverseMercator(e, t), i = new google.maps.LatLng(i.lat, i.lon)) : i = new google.maps.LatLng(t, e), i
    },
    getMapObjectPixelFromXY: function (e, t) {
        return new google.maps.Point(e, t)
    },
    destroy: function () {
        this.repositionListener && google.maps.event.removeListener(this.repositionListener), this.repositionTimer && window.clearTimeout(this.repositionTimer), OpenLayers.Layer.Google.prototype.destroy.apply(this, arguments)
    }
},OpenLayers.Format.WPSDescribeProcess = OpenLayers.Class(OpenLayers.Format.XML, {
    VERSION: "1.0.0",
    namespaces: {
        wps: "http://www.opengis.net/wps/1.0.0",
        ows: "http://www.opengis.net/ows/1.1",
        xsi: "http://www.w3.org/2001/XMLSchema-instance"
    },
    schemaLocation: "http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd",
    defaultPrefix: "wps",
    regExes: {trimSpace: /^\s*|\s*$/g, removeSpace: /\s*/g, splitSpace: /\s+/, trimComma: /\s*,\s*/g},
    read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e])), e && 9 == e.nodeType && (e = e.documentElement);
        var t = {};
        return this.readNode(e, t), t
    },
    readers: {
        wps: {
            ProcessDescriptions: function (e, t) {
                t.processDescriptions = {}, this.readChildNodes(e, t.processDescriptions)
            }, ProcessDescription: function (e, t) {
                var i = {
                    processVersion: this.getAttributeNS(e, this.namespaces.wps, "processVersion"),
                    statusSupported: "true" === e.getAttribute("statusSupported"),
                    storeSupported: "true" === e.getAttribute("storeSupported")
                };
                this.readChildNodes(e, i), t[i.identifier] = i
            }, DataInputs: function (e, t) {
                t.dataInputs = [], this.readChildNodes(e, t.dataInputs)
            }, ProcessOutputs: function (e, t) {
                t.processOutputs = [], this.readChildNodes(e, t.processOutputs)
            }, Output: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), t.push(i)
            }, ComplexOutput: function (e, t) {
                t.complexOutput = {}, this.readChildNodes(e, t.complexOutput)
            }, Input: function (e, t) {
                var i = {
                    maxOccurs: parseInt(e.getAttribute("maxOccurs")),
                    minOccurs: parseInt(e.getAttribute("minOccurs"))
                };
                this.readChildNodes(e, i), t.push(i)
            }, BoundingBoxData: function (e, t) {
                t.boundingBoxData = {}, this.readChildNodes(e, t.boundingBoxData)
            }, CRS: function (e, t) {
                t.CRSs || (t.CRSs = {}), t.CRSs[this.getChildValue(e)] = !0
            }, LiteralData: function (e, t) {
                t.literalData = {}, this.readChildNodes(e, t.literalData)
            }, ComplexData: function (e, t) {
                t.complexData = {}, this.readChildNodes(e, t.complexData)
            }, Default: function (e, t) {
                t["default"] = {}, this.readChildNodes(e, t["default"])
            }, Supported: function (e, t) {
                t.supported = {}, this.readChildNodes(e, t.supported)
            }, Format: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), t.formats || (t.formats = {}), t.formats[i.mimeType] = !0
            }, MimeType: function (e, t) {
                t.mimeType = this.getChildValue(e)
            }
        }, ows: OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows
    },
    CLASS_NAME: "OpenLayers.Format.WPSDescribeProcess"
}),OpenLayers.Format.CSWGetRecords.v2_0_2 = OpenLayers.Class(OpenLayers.Format.XML, {
    namespaces: {
        csw: "http://www.opengis.net/cat/csw/2.0.2",
        dc: "http://purl.org/dc/elements/1.1/",
        dct: "http://purl.org/dc/terms/",
        gmd: "http://www.isotc211.org/2005/gmd",
        geonet: "http://www.fao.org/geonetwork",
        ogc: "http://www.opengis.net/ogc",
        ows: "http://www.opengis.net/ows",
        xlink: "http://www.w3.org/1999/xlink",
        xsi: "http://www.w3.org/2001/XMLSchema-instance"
    },
    defaultPrefix: "csw",
    version: "2.0.2",
    schemaLocation: "http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",
    requestId: null,
    resultType: null,
    outputFormat: null,
    outputSchema: null,
    startPosition: null,
    maxRecords: null,
    DistributedSearch: null,
    ResponseHandler: null,
    Query: null,
    regExes: {trimSpace: /^\s*|\s*$/g, removeSpace: /\s*/g, splitSpace: /\s+/, trimComma: /\s*,\s*/g},
    initialize: function (e) {
        OpenLayers.Format.XML.prototype.initialize.apply(this, [e])
    },
    read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e])), e && 9 == e.nodeType && (e = e.documentElement);
        var t = {};
        return this.readNode(e, t), t
    },
    readers: {
        csw: {
            GetRecordsResponse: function (e, t) {
                t.records = [], this.readChildNodes(e, t);
                var i = this.getAttributeNS(e, "", "version");
                "" != i && (t.version = i)
            }, RequestId: function (e, t) {
                t.RequestId = this.getChildValue(e)
            }, SearchStatus: function (e, t) {
                t.SearchStatus = {};
                var i = this.getAttributeNS(e, "", "timestamp");
                "" != i && (t.SearchStatus.timestamp = i)
            }, SearchResults: function (e, t) {
                this.readChildNodes(e, t);
                for (var i = e.attributes, n = {}, s = 0, r = i.length; r > s; ++s)n[i[s].name] = "numberOfRecordsMatched" == i[s].name || "numberOfRecordsReturned" == i[s].name || "nextRecord" == i[s].name ? parseInt(i[s].nodeValue) : i[s].nodeValue;
                t.SearchResults = n
            }, SummaryRecord: function (e, t) {
                var i = {type: "SummaryRecord"};
                this.readChildNodes(e, i), t.records.push(i)
            }, BriefRecord: function (e, t) {
                var i = {type: "BriefRecord"};
                this.readChildNodes(e, i), t.records.push(i)
            }, DCMIRecord: function (e, t) {
                var i = {type: "DCMIRecord"};
                this.readChildNodes(e, i), t.records.push(i)
            }, Record: function (e, t) {
                var i = {type: "Record"};
                this.readChildNodes(e, i), t.records.push(i)
            }, "*": function (e, t) {
                var i = e.localName || e.nodeName.split(":").pop();
                t[i] = this.getChildValue(e)
            }
        }, geonet: {
            info: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), t.gninfo = i
            }
        }, dc: {
            "*": function (e, t) {
                var i = e.localName || e.nodeName.split(":").pop();
                OpenLayers.Util.isArray(t[i]) || (t[i] = []);
                for (var n = {}, s = e.attributes, r = 0, a = s.length; a > r; ++r)n[s[r].name] = s[r].nodeValue;
                n.value = this.getChildValue(e), "" != n.value && t[i].push(n)
            }
        }, dct: {
            "*": function (e, t) {
                var i = e.localName || e.nodeName.split(":").pop();
                OpenLayers.Util.isArray(t[i]) || (t[i] = []), t[i].push(this.getChildValue(e))
            }
        }, ows: OpenLayers.Util.applyDefaults({
            BoundingBox: function (e, t) {
                t.bounds && (t.BoundingBox = [{
                    crs: t.projection,
                    value: [t.bounds.left, t.bounds.bottom, t.bounds.right, t.bounds.top]
                }], delete t.projection, delete t.bounds), OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows.BoundingBox.apply(this, arguments)
            }
        }, OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows)
    },
    write: function (e) {
        return e = this.writeNode("csw:GetRecords", e), e.setAttribute("xmlns:gmd", this.namespaces.gmd), OpenLayers.Format.XML.prototype.write.apply(this, [e])
    },
    writers: {
        csw: {
            GetRecords: function (e) {
                e || (e = {});
                var t = this.createElementNSPlus("csw:GetRecords", {
                    attributes: {
                        service: "CSW",
                        version: this.version,
                        requestId: e.requestId || this.requestId,
                        resultType: e.resultType || this.resultType,
                        outputFormat: e.outputFormat || this.outputFormat,
                        outputSchema: e.outputSchema || this.outputSchema,
                        startPosition: e.startPosition || this.startPosition,
                        maxRecords: e.maxRecords || this.maxRecords
                    }
                });
                (e.DistributedSearch || this.DistributedSearch) && this.writeNode("csw:DistributedSearch", e.DistributedSearch || this.DistributedSearch, t);
                var i = e.ResponseHandler || this.ResponseHandler;
                if (OpenLayers.Util.isArray(i) && 0 < i.length)for (var n = 0, s = i.length; s > n; n++)this.writeNode("csw:ResponseHandler", i[n], t);
                return this.writeNode("Query", e.Query || this.Query, t), t
            }, DistributedSearch: function (e) {
                return this.createElementNSPlus("csw:DistributedSearch", {attributes: {hopCount: e.hopCount}})
            }, ResponseHandler: function (e) {
                return this.createElementNSPlus("csw:ResponseHandler", {value: e.value})
            }, Query: function (e) {
                e || (e = {});
                var t = this.createElementNSPlus("csw:Query", {attributes: {typeNames: e.typeNames || "csw:Record"}}), i = e.ElementName;
                if (OpenLayers.Util.isArray(i) && 0 < i.length)for (var n = 0, s = i.length; s > n; n++)this.writeNode("csw:ElementName", i[n], t); else this.writeNode("csw:ElementSetName", e.ElementSetName || {value: "summary"}, t);
                return e.Constraint && this.writeNode("csw:Constraint", e.Constraint, t), e.SortBy && this.writeNode("ogc:SortBy", e.SortBy, t), t
            }, ElementName: function (e) {
                return this.createElementNSPlus("csw:ElementName", {value: e.value})
            }, ElementSetName: function (e) {
                return this.createElementNSPlus("csw:ElementSetName", {
                    attributes: {typeNames: e.typeNames},
                    value: e.value
                })
            }, Constraint: function (e) {
                var t = this.createElementNSPlus("csw:Constraint", {attributes: {version: e.version}});
                if (e.Filter) {
                    var i = new OpenLayers.Format.Filter({version: e.version});
                    t.appendChild(i.write(e.Filter))
                } else e.CqlText && (e = this.createElementNSPlus("CqlText", {value: e.CqlText.value}), t.appendChild(e));
                return t
            }
        }, ogc: OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc
    },
    CLASS_NAME: "OpenLayers.Format.CSWGetRecords.v2_0_2"
}),OpenLayers.Marker.Box = OpenLayers.Class(OpenLayers.Marker, {
    bounds: null,
    div: null,
    initialize: function (e, t, i) {
        this.bounds = e, this.div = OpenLayers.Util.createDiv(), this.div.style.overflow = "hidden", this.events = new OpenLayers.Events(this, this.div), this.setBorder(t, i)
    },
    destroy: function () {
        this.div = this.bounds = null, OpenLayers.Marker.prototype.destroy.apply(this, arguments)
    },
    setBorder: function (e, t) {
        e || (e = "red"), t || (t = 2), this.div.style.border = t + "px solid " + e
    },
    draw: function (e, t) {
        return OpenLayers.Util.modifyDOMElement(this.div, null, e, t), this.div
    },
    onScreen: function () {
        var e = !1;
        return this.map && (e = this.map.getExtent().containsBounds(this.bounds, !0, !0)), e
    },
    display: function (e) {
        this.div.style.display = e ? "" : "none"
    },
    CLASS_NAME: "OpenLayers.Marker.Box"
}),OpenLayers.Format.Text = OpenLayers.Class(OpenLayers.Format, {
    defaultStyle: null,
    extractStyles: !0,
    initialize: function (e) {
        e = e || {}, !1 !== e.extractStyles && (e.defaultStyle = {
            externalGraphic: OpenLayers.Util.getImageLocation("marker.png"),
            graphicWidth: 21,
            graphicHeight: 25,
            graphicXOffset: -10.5,
            graphicYOffset: -12.5
        }), OpenLayers.Format.prototype.initialize.apply(this, [e])
    },
    read: function (e) {
        for (var t, e = e.split("\n"), i = [], n = 0; n < e.length - 1; n++) {
            var s = e[n].replace(/^\s*/, "").replace(/\s*$/, "");
            if ("#" != s.charAt(0))if (t) {
                for (var s = s.split("	"), r = new OpenLayers.Geometry.Point(0, 0), a = {}, o = this.defaultStyle ? OpenLayers.Util.applyDefaults({}, this.defaultStyle) : null, l = !1, h = 0; h < s.length; h++)if (s[h])if ("point" == t[h]) l = s[h].split(","), r.y = parseFloat(l[0]), r.x = parseFloat(l[1]), l = !0; else if ("lat" == t[h]) r.y = parseFloat(s[h]), l = !0; else if ("lon" == t[h]) r.x = parseFloat(s[h]), l = !0; else if ("title" == t[h]) a.title = s[h]; else if ("image" == t[h] || "icon" == t[h] && o) o.externalGraphic = s[h]; else if ("iconSize" == t[h] && o) {
                    var u = s[h].split(",");
                    o.graphicWidth = parseFloat(u[0]), o.graphicHeight = parseFloat(u[1])
                } else"iconOffset" == t[h] && o ? (u = s[h].split(","), o.graphicXOffset = parseFloat(u[0]), o.graphicYOffset = parseFloat(u[1])) : "description" == t[h] ? a.description = s[h] : "overflow" == t[h] ? a.overflow = s[h] : a[t[h]] = s[h];
                l && (this.internalProjection && this.externalProjection && r.transform(this.externalProjection, this.internalProjection), s = new OpenLayers.Feature.Vector(r, a, o), i.push(s))
            } else t = s.split("	")
        }
        return i
    },
    CLASS_NAME: "OpenLayers.Format.Text"
}),OpenLayers.Layer.Text = OpenLayers.Class(OpenLayers.Layer.Markers, {
    location: null,
    features: null,
    formatOptions: null,
    selectedFeature: null,
    initialize: function () {
        OpenLayers.Layer.Markers.prototype.initialize.apply(this, arguments), this.features = []
    },
    destroy: function () {
        OpenLayers.Layer.Markers.prototype.destroy.apply(this, arguments), this.clearFeatures(), this.features = null
    },
    loadText: function () {
        !this.loaded && null != this.location && (this.events.triggerEvent("loadstart"), OpenLayers.Request.GET({
            url: this.location,
            success: this.parseData,
            failure: function () {
                this.events.triggerEvent("loadend")
            },
            scope: this
        }), this.loaded = !0)
    },
    moveTo: function () {
        OpenLayers.Layer.Markers.prototype.moveTo.apply(this, arguments), this.visibility && !this.loaded && this.loadText()
    },
    parseData: function (e) {
        var e = e.responseText, t = {};
        OpenLayers.Util.extend(t, this.formatOptions), this.map && !this.projection.equals(this.map.getProjectionObject()) && (t.externalProjection = this.projection, t.internalProjection = this.map.getProjectionObject());
        for (var e = new OpenLayers.Format.Text(t).read(e), t = 0, i = e.length; i > t; t++) {
            var n, s, r, a = {}, o = e[t];
            n = new OpenLayers.LonLat(o.geometry.x, o.geometry.y), o.style.graphicWidth && o.style.graphicHeight && (s = new OpenLayers.Size(o.style.graphicWidth, o.style.graphicHeight)), void 0 !== o.style.graphicXOffset && void 0 !== o.style.graphicYOffset && (r = new OpenLayers.Pixel(o.style.graphicXOffset, o.style.graphicYOffset)), null != o.style.externalGraphic ? a.icon = new OpenLayers.Icon(o.style.externalGraphic, s, r) : (a.icon = OpenLayers.Marker.defaultIcon(), null != s && a.icon.setSize(s)), null != o.attributes.title && null != o.attributes.description && (a.popupContentHTML = "<h2>" + o.attributes.title + "</h2><p>" + o.attributes.description + "</p>"), a.overflow = o.attributes.overflow || "auto", a = new OpenLayers.Feature(this, n, a), this.features.push(a), n = a.createMarker(), null != o.attributes.title && null != o.attributes.description && n.events.register("click", a, this.markerClick), this.addMarker(n)
        }
        this.events.triggerEvent("loadend")
    },
    markerClick: function (e) {
        var t = this == this.layer.selectedFeature;
        this.layer.selectedFeature = t ? null : this;
        for (var i = 0, n = this.layer.map.popups.length; n > i; i++)this.layer.map.removePopup(this.layer.map.popups[i]);
        t || this.layer.map.addPopup(this.createPopup()), OpenLayers.Event.stop(e)
    },
    clearFeatures: function () {
        if (null != this.features)for (; 0 < this.features.length;) {
            var e = this.features[0];
            OpenLayers.Util.removeItem(this.features, e), e.destroy()
        }
    },
    CLASS_NAME: "OpenLayers.Layer.Text"
}),OpenLayers.Handler.RegularPolygon = OpenLayers.Class(OpenLayers.Handler.Drag, {
    sides: 4,
    radius: null,
    snapAngle: null,
    snapToggle: "shiftKey",
    layerOptions: null,
    persist: !1,
    irregular: !1,
    citeCompliant: !1,
    angle: null,
    fixedRadius: !1,
    feature: null,
    layer: null,
    origin: null,
    initialize: function (e, t, i) {
        i && i.layerOptions && i.layerOptions.styleMap || (this.style = OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"], {})), OpenLayers.Handler.Drag.prototype.initialize.apply(this, [e, t, i]), this.options = i ? i : {}
    },
    setOptions: function (e) {
        OpenLayers.Util.extend(this.options, e), OpenLayers.Util.extend(this, e)
    },
    activate: function () {
        var e = !1;
        return OpenLayers.Handler.Drag.prototype.activate.apply(this, arguments) && (e = OpenLayers.Util.extend({
            displayInLayerSwitcher: !1,
            calculateInRange: OpenLayers.Function.True,
            wrapDateLine: this.citeCompliant
        }, this.layerOptions), this.layer = new OpenLayers.Layer.Vector(this.CLASS_NAME, e), this.map.addLayer(this.layer), e = !0), e
    },
    deactivate: function () {
        var e = !1;
        return OpenLayers.Handler.Drag.prototype.deactivate.apply(this, arguments) && (this.dragging && this.cancel(), null != this.layer.map && (this.layer.destroy(!1), this.feature && this.feature.destroy()), this.feature = this.layer = null, e = !0), e
    },
    down: function (e) {
        this.fixedRadius = !!this.radius, e = this.layer.getLonLatFromViewPortPx(e.xy), this.origin = new OpenLayers.Geometry.Point(e.lon, e.lat), (!this.fixedRadius || this.irregular) && (this.radius = this.map.getResolution()), this.persist && this.clear(), this.feature = new OpenLayers.Feature.Vector, this.createGeometry(), this.callback("create", [this.origin, this.feature]), this.layer.addFeatures([this.feature], {silent: !0}), this.layer.drawFeature(this.feature, this.style)
    },
    move: function (e) {
        var t = this.layer.getLonLatFromViewPortPx(e.xy), t = new OpenLayers.Geometry.Point(t.lon, t.lat);
        this.irregular ? (e = Math.sqrt(2) * Math.abs(t.y - this.origin.y) / 2, this.radius = Math.max(this.map.getResolution() / 2, e)) : this.fixedRadius ? this.origin = t : (this.calculateAngle(t, e), this.radius = Math.max(this.map.getResolution() / 2, t.distanceTo(this.origin))), this.modifyGeometry(), this.irregular && (e = t.x - this.origin.x, t = t.y - this.origin.y, this.feature.geometry.resize(1, this.origin, 0 == t ? e / (this.radius * Math.sqrt(2)) : e / t), this.feature.geometry.move(e / 2, t / 2)), this.layer.drawFeature(this.feature, this.style)
    },
    up: function (e) {
        this.finalize(), this.start == this.last && this.callback("done", [e.xy])
    },
    out: function () {
        this.finalize()
    },
    createGeometry: function () {
        this.angle = Math.PI * (1 / this.sides - .5), this.snapAngle && (this.angle += this.snapAngle * (Math.PI / 180)), this.feature.geometry = OpenLayers.Geometry.Polygon.createRegularPolygon(this.origin, this.radius, this.sides, this.snapAngle)
    },
    modifyGeometry: function () {
        var e, t, i = this.feature.geometry.components[0];
        i.components.length != this.sides + 1 && (this.createGeometry(), i = this.feature.geometry.components[0]);
        for (var n = 0; n < this.sides; ++n)t = i.components[n], e = this.angle + 2 * n * Math.PI / this.sides, t.x = this.origin.x + this.radius * Math.cos(e), t.y = this.origin.y + this.radius * Math.sin(e), t.clearBounds()
    },
    calculateAngle: function (e, t) {
        var i = Math.atan2(e.y - this.origin.y, e.x - this.origin.x);
        if (this.snapAngle && this.snapToggle && !t[this.snapToggle]) {
            var n = Math.PI / 180 * this.snapAngle;
            this.angle = Math.round(i / n) * n
        } else this.angle = i
    },
    cancel: function () {
        this.callback("cancel", null), this.finalize()
    },
    finalize: function () {
        this.origin = null, this.radius = this.options.radius
    },
    clear: function () {
        this.layer && (this.layer.renderer.clear(), this.layer.destroyFeatures())
    },
    callback: function (e) {
        this.callbacks[e] && this.callbacks[e].apply(this.control, [this.feature.geometry.clone()]), !this.persist && ("done" == e || "cancel" == e) && this.clear()
    },
    CLASS_NAME: "OpenLayers.Handler.RegularPolygon"
}),OpenLayers.Control.SLDSelect = OpenLayers.Class(OpenLayers.Control, {
    clearOnDeactivate: !1,
    layers: null,
    callbacks: null,
    selectionSymbolizer: {
        Polygon: {fillColor: "#FF0000", stroke: !1},
        Line: {strokeColor: "#FF0000", strokeWidth: 2},
        Point: {graphicName: "square", fillColor: "#FF0000", pointRadius: 5}
    },
    layerOptions: null,
    handlerOptions: null,
    sketchStyle: null,
    wfsCache: {},
    layerCache: {},
    initialize: function (e, t) {
        OpenLayers.Control.prototype.initialize.apply(this, [t]), this.callbacks = OpenLayers.Util.extend({
            done: this.select,
            click: this.select
        }, this.callbacks), this.handlerOptions = this.handlerOptions || {}, this.layerOptions = OpenLayers.Util.applyDefaults(this.layerOptions, {
            displayInLayerSwitcher: !1,
            tileOptions: {maxGetUrlLength: 2048}
        }), this.sketchStyle && (this.handlerOptions.layerOptions = OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions, {styleMap: new OpenLayers.StyleMap({"default": this.sketchStyle})})), this.handler = new e(this, this.callbacks, this.handlerOptions)
    },
    destroy: function () {
        for (var e in this.layerCache)delete this.layerCache[e];
        for (e in this.wfsCache)delete this.wfsCache[e];
        OpenLayers.Control.prototype.destroy.apply(this, arguments)
    },
    coupleLayerVisiblity: function (e) {
        this.setVisibility(e.object.getVisibility())
    },
    createSelectionLayer: function (e) {
        var t;
        return this.layerCache[e.id] ? t = this.layerCache[e.id] : (t = new OpenLayers.Layer.WMS(e.name, e.url, e.params, OpenLayers.Util.applyDefaults(this.layerOptions, e.getOptions())), this.layerCache[e.id] = t, !1 === this.layerOptions.displayInLayerSwitcher && e.events.on({
            visibilitychanged: this.coupleLayerVisiblity,
            scope: t
        }), this.map.addLayer(t)), t
    },
    createSLD: function (e, t, i) {
        for (var n = {
            version: "1.0.0",
            namedLayers: {}
        }, s = ("" + e.params.LAYERS).split(","), r = 0, a = s.length; a > r; r++) {
            var o = s[r];
            n.namedLayers[o] = {name: o, userStyles: []};
            var l = this.selectionSymbolizer, h = i[r];
            0 <= h.type.indexOf("Polygon") ? l = {Polygon: this.selectionSymbolizer.Polygon} : 0 <= h.type.indexOf("LineString") ? l = {Line: this.selectionSymbolizer.Line} : 0 <= h.type.indexOf("Point") && (l = {Point: this.selectionSymbolizer.Point}), n.namedLayers[o].userStyles.push({
                name: "default",
                rules: [new OpenLayers.Rule({symbolizer: l, filter: t[r], maxScaleDenominator: e.options.minScale})]
            })
        }
        return new OpenLayers.Format.SLD({srsName: this.map.getProjection()}).write(n)
    },
    parseDescribeLayer: function (e) {
        var t = new OpenLayers.Format.WMSDescribeLayer, i = e.responseXML;
        i && i.documentElement || (i = e.responseText);
        for (var e = t.read(i), t = [], i = null, n = 0, s = e.length; s > n; n++)"WFS" == e[n].owsType && (t.push(e[n].typeName), i = e[n].owsURL);
        OpenLayers.Request.GET({
            url: i,
            params: {SERVICE: "WFS", TYPENAME: t.toString(), REQUEST: "DescribeFeatureType", VERSION: "1.0.0"},
            callback: function (e) {
                var t = new OpenLayers.Format.WFSDescribeFeatureType, i = e.responseXML;
                i && i.documentElement || (i = e.responseText), this.control.wfsCache[this.layer.id] = t.read(i), this.control._queue && this.control.applySelection()
            },
            scope: this
        })
    },
    getGeometryAttributes: function (e) {
        for (var t = [], e = this.wfsCache[e.id], i = 0, n = e.featureTypes.length; n > i; i++)for (var s = e.featureTypes[i].properties, r = 0, a = s.length; a > r; r++) {
            var o = s[r], l = o.type;
            (0 <= l.indexOf("LineString") || 0 <= l.indexOf("GeometryAssociationType") || 0 <= l.indexOf("GeometryPropertyType") || 0 <= l.indexOf("Point") || 0 <= l.indexOf("Polygon")) && t.push(o)
        }
        return t
    },
    activate: function () {
        var e = OpenLayers.Control.prototype.activate.call(this);
        if (e)for (var t = 0, i = this.layers.length; i > t; t++) {
            var n = this.layers[t];
            n && !this.wfsCache[n.id] && OpenLayers.Request.GET({
                url: n.url,
                params: {SERVICE: "WMS", VERSION: n.params.VERSION, LAYERS: n.params.LAYERS, REQUEST: "DescribeLayer"},
                callback: this.parseDescribeLayer,
                scope: {layer: n, control: this}
            })
        }
        return e
    },
    deactivate: function () {
        var e = OpenLayers.Control.prototype.deactivate.call(this);
        if (e)for (var t = 0, i = this.layers.length; i > t; t++) {
            var n = this.layers[t];
            if (n && !0 === this.clearOnDeactivate) {
                var s = this.layerCache, r = s[n.id];
                r && (n.events.un({
                    visibilitychanged: this.coupleLayerVisiblity,
                    scope: r
                }), r.destroy(), delete s[n.id])
            }
        }
        return e
    },
    setLayers: function (e) {
        this.active ? (this.deactivate(), this.layers = e, this.activate()) : this.layers = e
    },
    createFilter: function (e, t) {
        var i = null;
        return this.handler instanceof OpenLayers.Handler.RegularPolygon ? i = !0 === this.handler.irregular ? new OpenLayers.Filter.Spatial({
            type: OpenLayers.Filter.Spatial.BBOX,
            property: e.name,
            value: t.getBounds()
        }) : new OpenLayers.Filter.Spatial({
            type: OpenLayers.Filter.Spatial.INTERSECTS,
            property: e.name,
            value: t
        }) : this.handler instanceof OpenLayers.Handler.Polygon ? i = new OpenLayers.Filter.Spatial({
            type: OpenLayers.Filter.Spatial.INTERSECTS,
            property: e.name,
            value: t
        }) : this.handler instanceof OpenLayers.Handler.Path ? i = 0 <= e.type.indexOf("Point") ? new OpenLayers.Filter.Spatial({
            type: OpenLayers.Filter.Spatial.DWITHIN,
            property: e.name,
            distance: .01 * this.map.getExtent().getWidth(),
            distanceUnits: this.map.getUnits(),
            value: t
        }) : new OpenLayers.Filter.Spatial({
            type: OpenLayers.Filter.Spatial.INTERSECTS,
            property: e.name,
            value: t
        }) : this.handler instanceof OpenLayers.Handler.Click && (i = 0 <= e.type.indexOf("Polygon") ? new OpenLayers.Filter.Spatial({
            type: OpenLayers.Filter.Spatial.INTERSECTS,
            property: e.name,
            value: t
        }) : new OpenLayers.Filter.Spatial({
            type: OpenLayers.Filter.Spatial.DWITHIN,
            property: e.name,
            distance: .01 * this.map.getExtent().getWidth(),
            distanceUnits: this.map.getUnits(),
            value: t
        })), i
    },
    select: function (e) {
        this._queue = function () {
            for (var t = 0, i = this.layers.length; i > t; t++) {
                for (var n = this.layers[t], s = this.getGeometryAttributes(n), r = [], a = 0, o = s.length; o > a; a++) {
                    var l = s[a];
                    if (null !== l) {
                        if (!(e instanceof OpenLayers.Geometry)) {
                            var h = this.map.getLonLatFromPixel(e.xy);
                            e = new OpenLayers.Geometry.Point(h.lon, h.lat)
                        }
                        l = this.createFilter(l, e), null !== l && r.push(l)
                    }
                }
                a = this.createSelectionLayer(n), s = this.createSLD(n, r, s), this.events.triggerEvent("selected", {
                    layer: n,
                    filters: r
                }), a.mergeNewParams({SLD_BODY: s}), delete this._queue
            }
        }, this.applySelection()
    },
    applySelection: function () {
        for (var e = !0, t = 0, i = this.layers.length; i > t; t++)if (!this.wfsCache[this.layers[t].id]) {
            e = !1;
            break
        }
        e && this._queue.call(this)
    },
    CLASS_NAME: "OpenLayers.Control.SLDSelect"
}),OpenLayers.Control.Scale = OpenLayers.Class(OpenLayers.Control, {
    element: null,
    geodesic: !1,
    initialize: function (e, t) {
        OpenLayers.Control.prototype.initialize.apply(this, [t]), this.element = OpenLayers.Util.getElement(e)
    },
    draw: function () {
        return OpenLayers.Control.prototype.draw.apply(this, arguments), this.element || (this.element = document.createElement("div"), this.div.appendChild(this.element)), this.map.events.register("moveend", this, this.updateScale), this.updateScale(), this.div
    },
    updateScale: function () {
        var e;
        if (!0 === this.geodesic) {
            if (!this.map.getUnits())return;
            e = OpenLayers.INCHES_PER_UNIT, e = (this.map.getGeodesicPixelSize().w || 1e-6) * e.km * OpenLayers.DOTS_PER_INCH
        } else e = this.map.getScale();
        e && (e = e >= 9500 && 95e4 >= e ? Math.round(e / 1e3) + "K" : e >= 95e4 ? Math.round(e / 1e6) + "M" : Math.round(e), this.element.innerHTML = OpenLayers.i18n("Scale = 1 : ${scaleDenom}", {scaleDenom: e}))
    },
    CLASS_NAME: "OpenLayers.Control.Scale"
}),OpenLayers.Control.Button = OpenLayers.Class(OpenLayers.Control, {
    type: OpenLayers.Control.TYPE_BUTTON,
    trigger: function () {
    },
    CLASS_NAME: "OpenLayers.Control.Button"
}),OpenLayers.Layer.MapGuide = OpenLayers.Class(OpenLayers.Layer.Grid, {
    isBaseLayer: !0,
    useHttpTile: !1,
    singleTile: !1,
    useOverlay: !1,
    useAsyncOverlay: !0,
    TILE_PARAMS: {operation: "GETTILEIMAGE", version: "1.2.0"},
    SINGLE_TILE_PARAMS: {operation: "GETMAPIMAGE", format: "PNG", locale: "en", clip: "1", version: "1.0.0"},
    OVERLAY_PARAMS: {operation: "GETDYNAMICMAPOVERLAYIMAGE", format: "PNG", locale: "en", clip: "1", version: "2.0.0"},
    FOLDER_PARAMS: {tileColumnsPerFolder: 30, tileRowsPerFolder: 30, format: "png", querystring: null},
    defaultSize: new OpenLayers.Size(300, 300),
    tileOriginCorner: "tl",
    initialize: function (e, t, i, n) {
        OpenLayers.Layer.Grid.prototype.initialize.apply(this, arguments), (null == n || null == n.isBaseLayer) && (this.isBaseLayer = "true" != this.transparent && 1 != this.transparent), n && null != n.useOverlay && (this.useOverlay = n.useOverlay), this.singleTile ? this.useOverlay ? (OpenLayers.Util.applyDefaults(this.params, this.OVERLAY_PARAMS), this.useAsyncOverlay || (this.params.version = "1.0.0")) : OpenLayers.Util.applyDefaults(this.params, this.SINGLE_TILE_PARAMS) : (this.useHttpTile ? OpenLayers.Util.applyDefaults(this.params, this.FOLDER_PARAMS) : OpenLayers.Util.applyDefaults(this.params, this.TILE_PARAMS), this.setTileSize(this.defaultSize))
    },
    clone: function (e) {
        return null == e && (e = new OpenLayers.Layer.MapGuide(this.name, this.url, this.params, this.getOptions())), e = OpenLayers.Layer.Grid.prototype.clone.apply(this, [e])
    },
    getURL: function (e) {
        var t;
        t = e.getCenterLonLat();
        var i = this.map.getSize();
        return this.singleTile ? (e = {
            setdisplaydpi: OpenLayers.DOTS_PER_INCH,
            setdisplayheight: i.h * this.ratio,
            setdisplaywidth: i.w * this.ratio,
            setviewcenterx: t.lon,
            setviewcentery: t.lat,
            setviewscale: this.map.getScale()
        }, this.useOverlay && !this.useAsyncOverlay && (t = {}, t = OpenLayers.Util.extend(t, e), t.operation = "GETVISIBLEMAPEXTENT", t.version = "1.0.0", t.session = this.params.session, t.mapName = this.params.mapName, t.format = "text/xml", t = this.getFullRequestString(t), OpenLayers.Request.GET({
            url: t,
            async: !1
        })), t = this.getFullRequestString(e)) : (i = this.map.getResolution(), t = Math.floor((e.left - this.maxExtent.left) / i), t = Math.round(t / this.tileSize.w), e = Math.floor((this.maxExtent.top - e.top) / i), e = Math.round(e / this.tileSize.h), t = this.useHttpTile ? this.getImageFilePath({
            tilecol: t,
            tilerow: e,
            scaleindex: this.resolutions.length - this.map.zoom - 1
        }) : this.getFullRequestString({
            tilecol: t,
            tilerow: e,
            scaleindex: this.resolutions.length - this.map.zoom - 1
        })), t
    },
    getFullRequestString: function (e, t) {
        var i = null == t ? this.url : t;
        "object" == typeof i && (i = i[Math.floor(Math.random() * i.length)]);
        var n, s = i, r = OpenLayers.Util.extend({}, this.params), r = OpenLayers.Util.extend(r, e), a = OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(i));
        for (n in r)n.toUpperCase() in a && delete r[n];
        return r = OpenLayers.Util.getParameterString(r), r = r.replace(/,/g, "+"), "" != r && (a = i.charAt(i.length - 1), s = "&" == a || "?" == a ? s + r : -1 == i.indexOf("?") ? s + ("?" + r) : s + ("&" + r)), s
    },
    getImageFilePath: function (e, t) {
        var i = null == t ? this.url : t;
        "object" == typeof i && (i = i[Math.floor(Math.random() * i.length)]);
        var n = "", s = "";
        return 0 > e.tilerow && (n = "-"), n = 0 == e.tilerow ? n + "0" : n + Math.floor(Math.abs(e.tilerow / this.params.tileRowsPerFolder)) * this.params.tileRowsPerFolder, 0 > e.tilecol && (s = "-"), s = 0 == e.tilecol ? s + "0" : s + Math.floor(Math.abs(e.tilecol / this.params.tileColumnsPerFolder)) * this.params.tileColumnsPerFolder, n = "/S" + Math.floor(e.scaleindex) + "/" + this.params.basemaplayergroupname + "/R" + n + "/C" + s + "/" + e.tilerow % this.params.tileRowsPerFolder + "_" + e.tilecol % this.params.tileColumnsPerFolder + "." + this.params.format, this.params.querystring && (n += "?" + this.params.querystring), i + n
    },
    calculateGridLayout: function (e, t, i) {
        var n = i * this.tileSize.w, i = i * this.tileSize.h, s = e.left - t.lon, r = Math.floor(s / n) - this.buffer, e = t.lat - e.top + i, a = Math.floor(e / i) - this.buffer;
        return {
            tilelon: n,
            tilelat: i,
            tileoffsetlon: t.lon + r * n,
            tileoffsetlat: t.lat - i * a,
            tileoffsetx: -(s / n - r) * this.tileSize.w,
            tileoffsety: (a - e / i) * this.tileSize.h
        }
    },
    CLASS_NAME: "OpenLayers.Layer.MapGuide"
}),OpenLayers.Control.Measure = OpenLayers.Class(OpenLayers.Control, {
    handlerOptions: null,
    callbacks: null,
    displaySystem: "metric",
    geodesic: !1,
    displaySystemUnits: {geographic: ["dd"], english: ["mi", "ft", "in"], metric: ["km", "m"]},
    partialDelay: 300,
    delayedTrigger: null,
    persist: !1,
    immediate: !1,
    initialize: function (e, t) {
        OpenLayers.Control.prototype.initialize.apply(this, [t]);
        var i = {done: this.measureComplete, point: this.measurePartial};
        this.immediate && (i.modify = this.measureImmediate), this.callbacks = OpenLayers.Util.extend(i, this.callbacks), this.handlerOptions = OpenLayers.Util.extend({persist: this.persist}, this.handlerOptions), this.handler = new e(this, this.callbacks, this.handlerOptions)
    },
    deactivate: function () {
        return this.cancelDelay(), OpenLayers.Control.prototype.deactivate.apply(this, arguments)
    },
    cancel: function () {
        this.cancelDelay(), this.handler.cancel()
    },
    setImmediate: function (e) {
        (this.immediate = e) ? this.callbacks.modify = this.measureImmediate : delete this.callbacks.modify
    },
    updateHandler: function (e, t) {
        var i = this.active;
        i && this.deactivate(), this.handler = new e(this, this.callbacks, t), i && this.activate()
    },
    measureComplete: function (e) {
        this.cancelDelay(), this.measure(e, "measure")
    },
    measurePartial: function (e, t) {
        this.cancelDelay(), t = t.clone(), this.handler.freehandMode(this.handler.evt) ? this.measure(t, "measurepartial") : this.delayedTrigger = window.setTimeout(OpenLayers.Function.bind(function () {
            this.delayedTrigger = null, this.measure(t, "measurepartial")
        }, this), this.partialDelay)
    },
    measureImmediate: function (e, t, i) {
        i && !this.handler.freehandMode(this.handler.evt) && (this.cancelDelay(), this.measure(t.geometry, "measurepartial"))
    },
    cancelDelay: function () {
        null !== this.delayedTrigger && (window.clearTimeout(this.delayedTrigger), this.delayedTrigger = null)
    },
    measure: function (e, t) {
        var i, n;
        -1 < e.CLASS_NAME.indexOf("LineString") ? (i = this.getBestLength(e), n = 1) : (i = this.getBestArea(e), n = 2), this.events.triggerEvent(t, {
            measure: i[0],
            units: i[1],
            order: n,
            geometry: e
        })
    },
    getBestArea: function (e) {
        for (var t, i, n = this.displaySystemUnits[this.displaySystem], s = 0, r = n.length; r > s && (t = n[s], i = this.getArea(e, t), !(i > 1)); ++s);
        return [i, t]
    },
    getArea: function (e, t) {
        var i, n;
        this.geodesic ? (i = e.getGeodesicArea(this.map.getProjectionObject()), n = "m") : (i = e.getArea(), n = this.map.getUnits());
        var s = OpenLayers.INCHES_PER_UNIT[t];
        return s && (i *= Math.pow(OpenLayers.INCHES_PER_UNIT[n] / s, 2)), i
    },
    getBestLength: function (e) {
        for (var t, i, n = this.displaySystemUnits[this.displaySystem], s = 0, r = n.length; r > s && (t = n[s], i = this.getLength(e, t), !(i > 1)); ++s);
        return [i, t]
    },
    getLength: function (e, t) {
        var i, n;
        this.geodesic ? (i = e.getGeodesicLength(this.map.getProjectionObject()), n = "m") : (i = e.getLength(), n = this.map.getUnits());
        var s = OpenLayers.INCHES_PER_UNIT[t];
        return s && (i *= OpenLayers.INCHES_PER_UNIT[n] / s), i
    },
    CLASS_NAME: "OpenLayers.Control.Measure"
}),OpenLayers.Format.WMC.v1_0_0 = OpenLayers.Class(OpenLayers.Format.WMC.v1, {
    VERSION: "1.0.0",
    schemaLocation: "http://www.opengis.net/context http://schemas.opengis.net/context/1.0.0/context.xsd",
    initialize: function (e) {
        OpenLayers.Format.WMC.v1.prototype.initialize.apply(this, [e])
    },
    read_wmc_SRS: function (e, t) {
        var i = this.getChildValue(t);
        "object" != typeof e.projections && (e.projections = {});
        for (var i = i.split(/ +/), n = 0, s = i.length; s > n; n++)e.projections[i[n]] = !0
    },
    write_wmc_Layer: function (e) {
        var t = OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this, [e]);
        if (e.srs) {
            var i, n = [];
            for (i in e.srs)n.push(i);
            t.appendChild(this.createElementDefaultNS("SRS", n.join(" ")))
        }
        t.appendChild(this.write_wmc_FormatList(e)), t.appendChild(this.write_wmc_StyleList(e)), e.dimensions && t.appendChild(this.write_wmc_DimensionList(e)), t.appendChild(this.write_wmc_LayerExtension(e))
    },
    CLASS_NAME: "OpenLayers.Format.WMC.v1_0_0"
}),OpenLayers.Popup.Framed = OpenLayers.Class(OpenLayers.Popup.Anchored, {
    imageSrc: null,
    imageSize: null,
    isAlphaImage: !1,
    positionBlocks: null,
    blocks: null,
    fixedRelativePosition: !1,
    initialize: function (e, t, i, n, s, r) {
        OpenLayers.Popup.Anchored.prototype.initialize.apply(this, arguments), this.fixedRelativePosition && (this.updateRelativePosition(), this.calculateRelativePosition = function () {
            return this.relativePosition
        }), this.contentDiv.style.position = "absolute", this.contentDiv.style.zIndex = 1, r && (this.closeDiv.style.zIndex = 1), this.groupDiv.style.position = "absolute", this.groupDiv.style.top = "0px", this.groupDiv.style.left = "0px", this.groupDiv.style.height = "100%", this.groupDiv.style.width = "100%"
    },
    destroy: function () {
        this.isAlphaImage = this.imageSize = this.imageSrc = null, this.fixedRelativePosition = !1, this.positionBlocks = null;
        for (var e = 0; e < this.blocks.length; e++) {
            var t = this.blocks[e];
            t.image && t.div.removeChild(t.image), t.image = null, t.div && this.groupDiv.removeChild(t.div), t.div = null
        }
        this.blocks = null, OpenLayers.Popup.Anchored.prototype.destroy.apply(this, arguments)
    },
    setBackgroundColor: function () {
    },
    setBorder: function () {
    },
    setOpacity: function () {
    },
    setSize: function () {
        OpenLayers.Popup.Anchored.prototype.setSize.apply(this, arguments), this.updateBlocks()
    },
    updateRelativePosition: function () {
        if (this.padding = this.positionBlocks[this.relativePosition].padding, this.closeDiv) {
            var e = this.getContentDivPadding();
            this.closeDiv.style.right = e.right + this.padding.right + "px", this.closeDiv.style.top = e.top + this.padding.top + "px"
        }
        this.updateBlocks()
    },
    calculateNewPx: function () {
        var e = OpenLayers.Popup.Anchored.prototype.calculateNewPx.apply(this, arguments);
        return e = e.offset(this.positionBlocks[this.relativePosition].offset)
    },
    createBlocks: function () {
        this.blocks = [];
        var e, t = null;
        for (e in this.positionBlocks) {
            t = e;
            break
        }
        for (t = this.positionBlocks[t], e = 0; e < t.blocks.length; e++) {
            var i = {};
            this.blocks.push(i), i.div = OpenLayers.Util.createDiv(this.id + "_FrameDecorationDiv_" + e, null, null, null, "absolute", null, "hidden", null), i.image = (this.isAlphaImage ? OpenLayers.Util.createAlphaImageDiv : OpenLayers.Util.createImage)(this.id + "_FrameDecorationImg_" + e, null, this.imageSize, this.imageSrc, "absolute", null, null, null), i.div.appendChild(i.image), this.groupDiv.appendChild(i.div)
        }
    },
    updateBlocks: function () {
        if (this.blocks || this.createBlocks(), this.size && this.relativePosition) {
            for (var e = this.positionBlocks[this.relativePosition], t = 0; t < e.blocks.length; t++) {
                var i = e.blocks[t], n = this.blocks[t], s = i.anchor.left, r = i.anchor.bottom, a = i.anchor.right, o = i.anchor.top, l = isNaN(i.size.w) ? this.size.w - (a + s) : i.size.w, h = isNaN(i.size.h) ? this.size.h - (r + o) : i.size.h;
                n.div.style.width = (0 > l ? 0 : l) + "px", n.div.style.height = (0 > h ? 0 : h) + "px", n.div.style.left = null != s ? s + "px" : "", n.div.style.bottom = null != r ? r + "px" : "", n.div.style.right = null != a ? a + "px" : "", n.div.style.top = null != o ? o + "px" : "", n.image.style.left = i.position.x + "px", n.image.style.top = i.position.y + "px"
            }
            this.contentDiv.style.left = this.padding.left + "px", this.contentDiv.style.top = this.padding.top + "px"
        }
    },
    CLASS_NAME: "OpenLayers.Popup.Framed"
}),OpenLayers.Popup.FramedCloud = OpenLayers.Class(OpenLayers.Popup.Framed, {
    contentDisplayClass: "olFramedCloudPopupContent",
    autoSize: !0,
    panMapIfOutOfView: !0,
    imageSize: new OpenLayers.Size(1276, 736),
    isAlphaImage: !1,
    fixedRelativePosition: !1,
    positionBlocks: {
        tl: {
            offset: new OpenLayers.Pixel(44, 0),
            padding: new OpenLayers.Bounds(8, 40, 8, 9),
            blocks: [{
                size: new OpenLayers.Size("auto", "auto"),
                anchor: new OpenLayers.Bounds(0, 51, 22, 0),
                position: new OpenLayers.Pixel(0, 0)
            }, {
                size: new OpenLayers.Size(22, "auto"),
                anchor: new OpenLayers.Bounds(null, 50, 0, 0),
                position: new OpenLayers.Pixel(-1238, 0)
            }, {
                size: new OpenLayers.Size("auto", 19),
                anchor: new OpenLayers.Bounds(0, 32, 22, null),
                position: new OpenLayers.Pixel(0, -631)
            }, {
                size: new OpenLayers.Size(22, 18),
                anchor: new OpenLayers.Bounds(null, 32, 0, null),
                position: new OpenLayers.Pixel(-1238, -632)
            }, {
                size: new OpenLayers.Size(81, 35),
                anchor: new OpenLayers.Bounds(null, 0, 0, null),
                position: new OpenLayers.Pixel(0, -688)
            }]
        },
        tr: {
            offset: new OpenLayers.Pixel(-45, 0),
            padding: new OpenLayers.Bounds(8, 40, 8, 9),
            blocks: [{
                size: new OpenLayers.Size("auto", "auto"),
                anchor: new OpenLayers.Bounds(0, 51, 22, 0),
                position: new OpenLayers.Pixel(0, 0)
            }, {
                size: new OpenLayers.Size(22, "auto"),
                anchor: new OpenLayers.Bounds(null, 50, 0, 0),
                position: new OpenLayers.Pixel(-1238, 0)
            }, {
                size: new OpenLayers.Size("auto", 19),
                anchor: new OpenLayers.Bounds(0, 32, 22, null),
                position: new OpenLayers.Pixel(0, -631)
            }, {
                size: new OpenLayers.Size(22, 19),
                anchor: new OpenLayers.Bounds(null, 32, 0, null),
                position: new OpenLayers.Pixel(-1238, -631)
            }, {
                size: new OpenLayers.Size(81, 35),
                anchor: new OpenLayers.Bounds(0, 0, null, null),
                position: new OpenLayers.Pixel(-215, -687)
            }]
        },
        bl: {
            offset: new OpenLayers.Pixel(45, 0),
            padding: new OpenLayers.Bounds(8, 9, 8, 40),
            blocks: [{
                size: new OpenLayers.Size("auto", "auto"),
                anchor: new OpenLayers.Bounds(0, 21, 22, 32),
                position: new OpenLayers.Pixel(0, 0)
            }, {
                size: new OpenLayers.Size(22, "auto"),
                anchor: new OpenLayers.Bounds(null, 21, 0, 32),
                position: new OpenLayers.Pixel(-1238, 0)
            }, {
                size: new OpenLayers.Size("auto", 21),
                anchor: new OpenLayers.Bounds(0, 0, 22, null),
                position: new OpenLayers.Pixel(0, -629)
            }, {
                size: new OpenLayers.Size(22, 21),
                anchor: new OpenLayers.Bounds(null, 0, 0, null),
                position: new OpenLayers.Pixel(-1238, -629)
            }, {
                size: new OpenLayers.Size(81, 33),
                anchor: new OpenLayers.Bounds(null, null, 0, 0),
                position: new OpenLayers.Pixel(-101, -674)
            }]
        },
        br: {
            offset: new OpenLayers.Pixel(-44, 0),
            padding: new OpenLayers.Bounds(8, 9, 8, 40),
            blocks: [{
                size: new OpenLayers.Size("auto", "auto"),
                anchor: new OpenLayers.Bounds(0, 21, 22, 32),
                position: new OpenLayers.Pixel(0, 0)
            }, {
                size: new OpenLayers.Size(22, "auto"),
                anchor: new OpenLayers.Bounds(null, 21, 0, 32),
                position: new OpenLayers.Pixel(-1238, 0)
            }, {
                size: new OpenLayers.Size("auto", 21),
                anchor: new OpenLayers.Bounds(0, 0, 22, null),
                position: new OpenLayers.Pixel(0, -629)
            }, {
                size: new OpenLayers.Size(22, 21),
                anchor: new OpenLayers.Bounds(null, 0, 0, null),
                position: new OpenLayers.Pixel(-1238, -629)
            }, {
                size: new OpenLayers.Size(81, 33),
                anchor: new OpenLayers.Bounds(0, null, null, 0),
                position: new OpenLayers.Pixel(-311, -674)
            }]
        }
    },
    minSize: new OpenLayers.Size(105, 10),
    maxSize: new OpenLayers.Size(1200, 660),
    initialize: function () {
        this.imageSrc = OpenLayers.Util.getImageLocation("cloud-popup-relative.png"), OpenLayers.Popup.Framed.prototype.initialize.apply(this, arguments), this.contentDiv.className = this.contentDisplayClass
    },
    CLASS_NAME: "OpenLayers.Popup.FramedCloud"
}),OpenLayers.Tile.Image.IFrame = {
    useIFrame: null, draw: function () {
        if (OpenLayers.Tile.Image.prototype.shouldDraw.call(this)) {
            var e = this.layer.getURL(this.bounds), t = this.useIFrame;
            this.useIFrame = null !== this.maxGetUrlLength && !this.layer.async && e.length > this.maxGetUrlLength, e = t && !this.useIFrame, t = !t && this.useIFrame, (e || t) && (this.imgDiv && this.imgDiv.parentNode === this.frame && this.frame.removeChild(this.imgDiv), this.imgDiv = null, e ? (this.blankImageUrl = this._blankImageUrl, this.frame.removeChild(this.frame.firstChild)) : (this._blankImageUrl = this.blankImageUrl, this.blankImageUrl = "about:blank"))
        }
        return OpenLayers.Tile.Image.prototype.draw.apply(this, arguments)
    }, getImage: function () {
        if (!0 === this.useIFrame) {
            if (!this.frame.childNodes.length) {
                var e = document.createElement("div"), t = e.style;
                t.position = "absolute", t.width = "100%", t.height = "100%", t.zIndex = 1, t.backgroundImage = "url(" + this._blankImageUrl + ")", this.frame.appendChild(e)
            }
            return e = this.id + "_iFrame", 9 > parseFloat(navigator.appVersion.split("MSIE")[1]) ? (t = document.createElement('<iframe name="' + e + '">'), t.style.backgroundColor = "#FFFFFF", t.style.filter = "chroma(color=#FFFFFF)") : (t = document.createElement("iframe"), t.style.backgroundColor = "transparent", t.name = e), t.scrolling = "no", t.marginWidth = "0px", t.marginHeight = "0px", t.frameBorder = "0", t.style.position = "absolute", t.style.width = "100%", t.style.height = "100%", 1 > this.layer.opacity && OpenLayers.Util.modifyDOMElement(t, null, null, null, null, null, null, this.layer.opacity), this.frame.appendChild(t), this.imgDiv = t
        }
        return OpenLayers.Tile.Image.prototype.getImage.apply(this, arguments)
    }, createRequestForm: function () {
        var e = document.createElement("form");
        e.method = "POST";
        var t = this.layer.params._OLSALT, t = (t ? t + "_" : "") + this.bounds.toBBOX();
        e.action = OpenLayers.Util.urlAppend(this.layer.url, t), e.target = this.id + "_iFrame", this.layer.getImageSize();
        var i, n, t = OpenLayers.Util.getParameters(this.url);
        for (n in t)i = document.createElement("input"), i.type = "hidden", i.name = n, i.value = t[n], e.appendChild(i);
        return e
    }, setImgSrc: function (e) {
        if (!0 === this.useIFrame)if (e) {
            var t = this.createRequestForm();
            this.frame.appendChild(t), t.submit(), this.frame.removeChild(t)
        } else this.imgDiv.parentNode === this.frame && (this.frame.removeChild(this.imgDiv), this.imgDiv = null); else OpenLayers.Tile.Image.prototype.setImgSrc.apply(this, arguments)
    }, onImageLoad: function () {
        OpenLayers.Tile.Image.prototype.onImageLoad.apply(this, arguments), !0 === this.useIFrame && (this.imgDiv.style.opacity = 1, this.frame.style.opacity = this.layer.opacity)
    }, createBackBuffer: function () {
        var e;
        return !1 === this.useIFrame && (e = OpenLayers.Tile.Image.prototype.createBackBuffer.call(this)), e
    }
},OpenLayers.Format.SOSCapabilities = OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC, {
    defaultVersion: "1.0.0",
    CLASS_NAME: "OpenLayers.Format.SOSCapabilities"
}),OpenLayers.Format.SOSCapabilities.v1_0_0 = OpenLayers.Class(OpenLayers.Format.SOSCapabilities, {
    namespaces: {
        ows: "http://www.opengis.net/ows/1.1",
        sos: "http://www.opengis.net/sos/1.0",
        gml: "http://www.opengis.net/gml",
        xlink: "http://www.w3.org/1999/xlink"
    },
    regExes: {trimSpace: /^\s*|\s*$/g, removeSpace: /\s*/g, splitSpace: /\s+/, trimComma: /\s*,\s*/g},
    initialize: function (e) {
        OpenLayers.Format.XML.prototype.initialize.apply(this, [e]), this.options = e
    },
    read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e])), e && 9 == e.nodeType && (e = e.documentElement);
        var t = {};
        return this.readNode(e, t), t
    },
    readers: {
        gml: OpenLayers.Util.applyDefaults({
            name: function (e, t) {
                t.name = this.getChildValue(e)
            }, TimePeriod: function (e, t) {
                t.timePeriod = {}, this.readChildNodes(e, t.timePeriod)
            }, beginPosition: function (e, t) {
                t.beginPosition = this.getChildValue(e)
            }, endPosition: function (e, t) {
                t.endPosition = this.getChildValue(e)
            }
        }, OpenLayers.Format.GML.v3.prototype.readers.gml), sos: {
            Capabilities: function (e, t) {
                this.readChildNodes(e, t)
            }, Contents: function (e, t) {
                t.contents = {}, this.readChildNodes(e, t.contents)
            }, ObservationOfferingList: function (e, t) {
                t.offeringList = {}, this.readChildNodes(e, t.offeringList)
            }, ObservationOffering: function (e, t) {
                var i = this.getAttributeNS(e, this.namespaces.gml, "id");
                t[i] = {
                    procedures: [],
                    observedProperties: [],
                    featureOfInterestIds: [],
                    responseFormats: [],
                    resultModels: [],
                    responseModes: []
                }, this.readChildNodes(e, t[i])
            }, time: function (e, t) {
                t.time = {}, this.readChildNodes(e, t.time)
            }, procedure: function (e, t) {
                t.procedures.push(this.getAttributeNS(e, this.namespaces.xlink, "href"))
            }, observedProperty: function (e, t) {
                t.observedProperties.push(this.getAttributeNS(e, this.namespaces.xlink, "href"))
            }, featureOfInterest: function (e, t) {
                t.featureOfInterestIds.push(this.getAttributeNS(e, this.namespaces.xlink, "href"))
            }, responseFormat: function (e, t) {
                t.responseFormats.push(this.getChildValue(e))
            }, resultModel: function (e, t) {
                t.resultModels.push(this.getChildValue(e))
            }, responseMode: function (e, t) {
                t.responseModes.push(this.getChildValue(e))
            }
        }, ows: OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows
    },
    CLASS_NAME: "OpenLayers.Format.SOSCapabilities.v1_0_0"
}),OpenLayers.Handler.Pinch = OpenLayers.Class(OpenLayers.Handler, {
    started: !1,
    stopDown: !1,
    pinching: !1,
    last: null,
    start: null,
    touchstart: function (e) {
        var t = !0;
        return this.pinching = !1, OpenLayers.Event.isMultiTouch(e) ? (this.started = !0, this.last = this.start = {
            distance: this.getDistance(e.touches),
            delta: 0,
            scale: 1
        }, this.callback("start", [e, this.start]), t = !this.stopDown) : (this.started = !1, this.last = this.start = null), OpenLayers.Event.stop(e), t
    },
    touchmove: function (e) {
        if (this.started && OpenLayers.Event.isMultiTouch(e)) {
            this.pinching = !0;
            var t = this.getPinchData(e);
            this.callback("move", [e, t]), this.last = t, OpenLayers.Event.stop(e)
        }
        return !0
    },
    touchend: function (e) {
        return this.started && (this.pinching = this.started = !1, this.callback("done", [e, this.start, this.last]), this.last = this.start = null), !0
    },
    activate: function () {
        var e = !1;
        return OpenLayers.Handler.prototype.activate.apply(this, arguments) && (this.pinching = !1, e = !0), e
    },
    deactivate: function () {
        var e = !1;
        return OpenLayers.Handler.prototype.deactivate.apply(this, arguments) && (this.pinching = this.started = !1, this.last = this.start = null, e = !0), e
    },
    getDistance: function (e) {
        var t = e[0], e = e[1];
        return Math.sqrt(Math.pow(t.clientX - e.clientX, 2) + Math.pow(t.clientY - e.clientY, 2))
    },
    getPinchData: function (e) {
        return e = this.getDistance(e.touches), {
            distance: e,
            delta: this.last.distance - e,
            scale: e / this.start.distance
        }
    },
    CLASS_NAME: "OpenLayers.Handler.Pinch"
}),OpenLayers.Control.NavToolbar = OpenLayers.Class(OpenLayers.Control.Panel, {
    initialize: function (e) {
        OpenLayers.Control.Panel.prototype.initialize.apply(this, [e]), this.addControls([new OpenLayers.Control.Navigation, new OpenLayers.Control.ZoomBox])
    }, draw: function () {
        var e = OpenLayers.Control.Panel.prototype.draw.apply(this, arguments);
        return null === this.defaultControl && (this.defaultControl = this.controls[0]), e
    }, CLASS_NAME: "OpenLayers.Control.NavToolbar"
}),OpenLayers.Strategy.Refresh = OpenLayers.Class(OpenLayers.Strategy, {
    force: !1,
    interval: 0,
    timer: null,
    activate: function () {
        var e = OpenLayers.Strategy.prototype.activate.call(this);
        return e && (!0 === this.layer.visibility && this.start(), this.layer.events.on({
            visibilitychanged: this.reset,
            scope: this
        })), e
    },
    deactivate: function () {
        var e = OpenLayers.Strategy.prototype.deactivate.call(this);
        return e && this.stop(), e
    },
    reset: function () {
        !0 === this.layer.visibility ? this.start() : this.stop()
    },
    start: function () {
        this.interval && "number" == typeof this.interval && 0 < this.interval && (this.timer = window.setInterval(OpenLayers.Function.bind(this.refresh, this), this.interval))
    },
    refresh: function () {
        this.layer && this.layer.refresh && "function" == typeof this.layer.refresh && this.layer.refresh({force: this.force})
    },
    stop: function () {
        null !== this.timer && (window.clearInterval(this.timer), this.timer = null)
    },
    CLASS_NAME: "OpenLayers.Strategy.Refresh"
}),OpenLayers.Layer.ArcGIS93Rest = OpenLayers.Class(OpenLayers.Layer.Grid, {
    DEFAULT_PARAMS: {format: "png"},
    isBaseLayer: !0,
    initialize: function (e, t, i, n) {
        var s = [], i = OpenLayers.Util.upperCaseObject(i);
        s.push(e, t, i, n), OpenLayers.Layer.Grid.prototype.initialize.apply(this, s), OpenLayers.Util.applyDefaults(this.params, OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS)), this.params.TRANSPARENT && "true" == this.params.TRANSPARENT.toString().toLowerCase() && (null != n && n.isBaseLayer || (this.isBaseLayer = !1), "jpg" == this.params.FORMAT && (this.params.FORMAT = OpenLayers.Util.alphaHack() ? "gif" : "png"))
    },
    clone: function (e) {
        return null == e && (e = new OpenLayers.Layer.ArcGIS93Rest(this.name, this.url, this.params, this.getOptions())), e = OpenLayers.Layer.Grid.prototype.clone.apply(this, [e])
    },
    getURL: function (e) {
        var e = this.adjustBounds(e), t = this.projection.getCode().split(":"), t = t[t.length - 1], i = this.getImageSize(), e = {
            BBOX: e.toBBOX(),
            SIZE: i.w + "," + i.h,
            F: "image",
            BBOXSR: t,
            IMAGESR: t
        };
        if (this.layerDefs) {
            var n, t = [];
            for (n in this.layerDefs)this.layerDefs.hasOwnProperty(n) && this.layerDefs[n] && (t.push(n), t.push(":"), t.push(this.layerDefs[n]), t.push(";"));
            0 < t.length && (e.LAYERDEFS = t.join(""))
        }
        return this.getFullRequestString(e)
    },
    setLayerFilter: function (e, t) {
        this.layerDefs || (this.layerDefs = {}), t ? this.layerDefs[e] = t : delete this.layerDefs[e]
    },
    clearLayerFilter: function (e) {
        e ? delete this.layerDefs[e] : delete this.layerDefs
    },
    mergeNewParams: function (e) {
        return e = [OpenLayers.Util.upperCaseObject(e)], OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this, e)
    },
    CLASS_NAME: "OpenLayers.Layer.ArcGIS93Rest"
}),OpenLayers.Format.WKT = OpenLayers.Class(OpenLayers.Format, {
    initialize: function (e) {
        this.regExes = {
            typeStr: /^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,
            spaces: /\s+/,
            parenComma: /\)\s*,\s*\(/,
            doubleParenComma: /\)\s*\)\s*,\s*\(\s*\(/,
            trimParens: /^\s*\(?(.*?)\)?\s*$/
        }, OpenLayers.Format.prototype.initialize.apply(this, [e])
    }, read: function (e) {
        var t, i, e = e.replace(/[\n\r]/g, " ");
        if ((i = this.regExes.typeStr.exec(e)) && (e = i[1].toLowerCase(), i = i[2], this.parse[e] && (t = this.parse[e].apply(this, [i])), this.internalProjection && this.externalProjection))if (t && "OpenLayers.Feature.Vector" == t.CLASS_NAME) t.geometry.transform(this.externalProjection, this.internalProjection); else if (t && "geometrycollection" != e && "object" == typeof t)for (e = 0, i = t.length; i > e; e++)t[e].geometry.transform(this.externalProjection, this.internalProjection);
        return t
    }, write: function (e) {
        var t, i;
        e.constructor == Array ? i = !0 : (e = [e], i = !1);
        var n = [];
        i && n.push("GEOMETRYCOLLECTION(");
        for (var s = 0, r = e.length; r > s; ++s)i && s > 0 && n.push(","), t = e[s].geometry, n.push(this.extractGeometry(t));
        return i && n.push(")"), n.join("")
    }, extractGeometry: function (e) {
        var t = e.CLASS_NAME.split(".")[2].toLowerCase();
        return this.extract[t] ? (this.internalProjection && this.externalProjection && (e = e.clone(), e.transform(this.internalProjection, this.externalProjection)), ("collection" == t ? "GEOMETRYCOLLECTION" : t.toUpperCase()) + "(" + this.extract[t].apply(this, [e]) + ")") : null
    }, extract: {
        point: function (e) {
            return e.x + " " + e.y
        }, multipoint: function (e) {
            for (var t = [], i = 0, n = e.components.length; n > i; ++i)t.push("(" + this.extract.point.apply(this, [e.components[i]]) + ")");
            return t.join(",")
        }, linestring: function (e) {
            for (var t = [], i = 0, n = e.components.length; n > i; ++i)t.push(this.extract.point.apply(this, [e.components[i]]));
            return t.join(",")
        }, multilinestring: function (e) {
            for (var t = [], i = 0, n = e.components.length; n > i; ++i)t.push("(" + this.extract.linestring.apply(this, [e.components[i]]) + ")");
            return t.join(",")
        }, polygon: function (e) {
            for (var t = [], i = 0, n = e.components.length; n > i; ++i)t.push("(" + this.extract.linestring.apply(this, [e.components[i]]) + ")");
            return t.join(",")
        }, multipolygon: function (e) {
            for (var t = [], i = 0, n = e.components.length; n > i; ++i)t.push("(" + this.extract.polygon.apply(this, [e.components[i]]) + ")");
            return t.join(",")
        }, collection: function (e) {
            for (var t = [], i = 0, n = e.components.length; n > i; ++i)t.push(this.extractGeometry.apply(this, [e.components[i]]));
            return t.join(",")
        }
    }, parse: {
        point: function (e) {
            return e = OpenLayers.String.trim(e).split(this.regExes.spaces), new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(e[0], e[1]))
        }, multipoint: function (e) {
            for (var t = OpenLayers.String.trim(e).split(","), i = [], n = 0, s = t.length; s > n; ++n)e = t[n].replace(this.regExes.trimParens, "$1"), i.push(this.parse.point.apply(this, [e]).geometry);
            return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPoint(i))
        }, linestring: function (e) {
            for (var e = OpenLayers.String.trim(e).split(","), t = [], i = 0, n = e.length; n > i; ++i)t.push(this.parse.point.apply(this, [e[i]]).geometry);
            return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(t))
        }, multilinestring: function (e) {
            for (var t = OpenLayers.String.trim(e).split(this.regExes.parenComma), i = [], n = 0, s = t.length; s > n; ++n)e = t[n].replace(this.regExes.trimParens, "$1"), i.push(this.parse.linestring.apply(this, [e]).geometry);
            return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiLineString(i))
        }, polygon: function (e) {
            for (var t, e = OpenLayers.String.trim(e).split(this.regExes.parenComma), i = [], n = 0, s = e.length; s > n; ++n)t = e[n].replace(this.regExes.trimParens, "$1"), t = this.parse.linestring.apply(this, [t]).geometry, t = new OpenLayers.Geometry.LinearRing(t.components), i.push(t);
            return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon(i))
        }, multipolygon: function (e) {
            for (var t = OpenLayers.String.trim(e).split(this.regExes.doubleParenComma), i = [], n = 0, s = t.length; s > n; ++n)e = t[n].replace(this.regExes.trimParens, "$1"), i.push(this.parse.polygon.apply(this, [e]).geometry);
            return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPolygon(i))
        }, geometrycollection: function (e) {
            for (var e = e.replace(/,\s*([A-Za-z])/g, "|$1"), e = OpenLayers.String.trim(e).split("|"), t = [], i = 0, n = e.length; n > i; ++i)t.push(OpenLayers.Format.WKT.prototype.read.apply(this, [e[i]]));
            return t
        }
    }, CLASS_NAME: "OpenLayers.Format.WKT"
}),OpenLayers.Handler.Hover = OpenLayers.Class(OpenLayers.Handler, {
    delay: 500,
    pixelTolerance: null,
    stopMove: !1,
    px: null,
    timerId: null,
    mousemove: function (e) {
        return this.passesTolerance(e.xy) && (this.clearTimer(), this.callback("move", [e]), this.px = e.xy, e = OpenLayers.Util.extend({}, e), this.timerId = window.setTimeout(OpenLayers.Function.bind(this.delayedCall, this, e), this.delay)), !this.stopMove
    },
    mouseout: function (e) {
        return OpenLayers.Util.mouseLeft(e, this.map.viewPortDiv) && (this.clearTimer(), this.callback("move", [e])), !0
    },
    passesTolerance: function (e) {
        var t = !0;
        return this.pixelTolerance && this.px && Math.sqrt(Math.pow(this.px.x - e.x, 2) + Math.pow(this.px.y - e.y, 2)) < this.pixelTolerance && (t = !1), t
    },
    clearTimer: function () {
        null != this.timerId && (window.clearTimeout(this.timerId), this.timerId = null)
    },
    delayedCall: function (e) {
        this.callback("pause", [e])
    },
    deactivate: function () {
        var e = !1;
        return OpenLayers.Handler.prototype.deactivate.apply(this, arguments) && (this.clearTimer(), e = !0), e
    },
    CLASS_NAME: "OpenLayers.Handler.Hover"
}),OpenLayers.Control.GetFeature = OpenLayers.Class(OpenLayers.Control, {
    protocol: null,
    multipleKey: null,
    toggleKey: null,
    modifiers: null,
    multiple: !1,
    click: !0,
    single: !0,
    clickout: !0,
    toggle: !1,
    clickTolerance: 5,
    hover: !1,
    box: !1,
    maxFeatures: 10,
    features: null,
    hoverFeature: null,
    handlerOptions: null,
    handlers: null,
    hoverResponse: null,
    filterType: OpenLayers.Filter.Spatial.BBOX,
    initialize: function (e) {
        e.handlerOptions = e.handlerOptions || {}, OpenLayers.Control.prototype.initialize.apply(this, [e]), this.features = {}, this.handlers = {}, this.click && (this.handlers.click = new OpenLayers.Handler.Click(this, {click: this.selectClick}, this.handlerOptions.click || {})), this.box && (this.handlers.box = new OpenLayers.Handler.Box(this, {done: this.selectBox}, OpenLayers.Util.extend(this.handlerOptions.box, {boxDivClassName: "olHandlerBoxSelectFeature"}))), this.hover && (this.handlers.hover = new OpenLayers.Handler.Hover(this, {
            move: this.cancelHover,
            pause: this.selectHover
        }, OpenLayers.Util.extend(this.handlerOptions.hover, {delay: 250, pixelTolerance: 2})))
    },
    activate: function () {
        if (!this.active)for (var e in this.handlers)this.handlers[e].activate();
        return OpenLayers.Control.prototype.activate.apply(this, arguments)
    },
    deactivate: function () {
        if (this.active)for (var e in this.handlers)this.handlers[e].deactivate();
        return OpenLayers.Control.prototype.deactivate.apply(this, arguments)
    },
    selectClick: function (e) {
        var t = this.pixelToBounds(e.xy);
        this.setModifiers(e), this.request(t, {single: this.single})
    },
    selectBox: function (e) {
        var t;
        if (e instanceof OpenLayers.Bounds) t = this.map.getLonLatFromPixel({
            x: e.left,
            y: e.bottom
        }), e = this.map.getLonLatFromPixel({
            x: e.right,
            y: e.top
        }), t = new OpenLayers.Bounds(t.lon, t.lat, e.lon, e.lat); else {
            if (this.click)return;
            t = this.pixelToBounds(e)
        }
        this.setModifiers(this.handlers.box.dragHandler.evt), this.request(t)
    },
    selectHover: function (e) {
        this.request(this.pixelToBounds(e.xy), {single: !0, hover: !0})
    },
    cancelHover: function () {
        this.hoverResponse && (this.protocol.abort(this.hoverResponse), this.hoverResponse = null, OpenLayers.Element.removeClass(this.map.viewPortDiv, "olCursorWait"))
    },
    request: function (e, t) {
        var t = t || {}, i = new OpenLayers.Filter.Spatial({type: this.filterType, value: e});
        OpenLayers.Element.addClass(this.map.viewPortDiv, "olCursorWait"), i = this.protocol.read({
            maxFeatures: 1 == t.single ? this.maxFeatures : void 0,
            filter: i,
            callback: function (i) {
                i.success() && (i.features.length ? 1 == t.single ? this.selectBestFeature(i.features, e.getCenterLonLat(), t) : this.select(i.features) : t.hover ? this.hoverSelect() : (this.events.triggerEvent("clickout"), this.clickout && this.unselectAll())), OpenLayers.Element.removeClass(this.map.viewPortDiv, "olCursorWait")
            },
            scope: this
        }), 1 == t.hover && (this.hoverResponse = i)
    },
    selectBestFeature: function (e, t, i) {
        if (i = i || {}, e.length) {
            for (var n, s, r, t = new OpenLayers.Geometry.Point(t.lon, t.lat), a = Number.MAX_VALUE, o = 0; o < e.length && (n = e[o], !(n.geometry && (r = t.distanceTo(n.geometry, {edge: !1}), a > r && (a = r, s = n, 0 == a)))); ++o);
            1 == i.hover ? this.hoverSelect(s) : this.select(s || e)
        }
    },
    setModifiers: function (e) {
        this.modifiers = {
            multiple: this.multiple || this.multipleKey && e[this.multipleKey],
            toggle: this.toggle || this.toggleKey && e[this.toggleKey]
        }
    },
    select: function (e) {
        !this.modifiers.multiple && !this.modifiers.toggle && this.unselectAll(), OpenLayers.Util.isArray(e) || (e = [e]);
        var t = this.events.triggerEvent("beforefeaturesselected", {features: e});
        if (!1 !== t) {
            for (var i, n = [], s = 0, r = e.length; r > s; ++s)i = e[s], this.features[i.fid || i.id] ? this.modifiers.toggle && this.unselect(this.features[i.fid || i.id]) : (t = this.events.triggerEvent("beforefeatureselected", {feature: i}), !1 !== t && (this.features[i.fid || i.id] = i, n.push(i), this.events.triggerEvent("featureselected", {feature: i})));
            this.events.triggerEvent("featuresselected", {features: n})
        }
    },
    hoverSelect: function (e) {
        var t = e ? e.fid || e.id : null, i = this.hoverFeature ? this.hoverFeature.fid || this.hoverFeature.id : null;
        i && i != t && (this.events.triggerEvent("outfeature", {feature: this.hoverFeature}), this.hoverFeature = null), t && t != i && (this.events.triggerEvent("hoverfeature", {feature: e}), this.hoverFeature = e)
    },
    unselect: function (e) {
        delete this.features[e.fid || e.id], this.events.triggerEvent("featureunselected", {feature: e})
    },
    unselectAll: function () {
        for (var e in this.features)this.unselect(this.features[e])
    },
    setMap: function (e) {
        for (var t in this.handlers)this.handlers[t].setMap(e);
        OpenLayers.Control.prototype.setMap.apply(this, arguments)
    },
    pixelToBounds: function (e) {
        var t = e.add(-this.clickTolerance / 2, this.clickTolerance / 2), e = e.add(this.clickTolerance / 2, -this.clickTolerance / 2), t = this.map.getLonLatFromPixel(t), e = this.map.getLonLatFromPixel(e);
        return new OpenLayers.Bounds(t.lon, t.lat, e.lon, e.lat)
    },
    CLASS_NAME: "OpenLayers.Control.GetFeature"
}),OpenLayers.Format.QueryStringFilter = function () {
    function e(e) {
        return e = e.replace(/%/g, "\\%"), e = e.replace(/\\\\\.(\*)?/g, function (e, t) {
            return t ? e : "\\\\_"
        }), e = e.replace(/\\\\\.\*/g, "\\\\%"), e = e.replace(/(\\)?\.(\*)?/g, function (e, t, i) {
            return t || i ? e : "_"
        }), e = e.replace(/(\\)?\.\*/g, function (e, t) {
            return t ? e : "%"
        }), e = e.replace(/\\\./g, "."), e = e.replace(/(\\)?\\\*/g, function (e, t) {
            return t ? e : "*"
        })
    }

    var t = {};
    return t[OpenLayers.Filter.Comparison.EQUAL_TO] = "eq", t[OpenLayers.Filter.Comparison.NOT_EQUAL_TO] = "ne", t[OpenLayers.Filter.Comparison.LESS_THAN] = "lt", t[OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO] = "lte", t[OpenLayers.Filter.Comparison.GREATER_THAN] = "gt", t[OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO] = "gte", t[OpenLayers.Filter.Comparison.LIKE] = "ilike", OpenLayers.Class(OpenLayers.Format, {
        wildcarded: !1,
        srsInBBOX: !1,
        write: function (i, n) {
            var n = n || {}, s = i.CLASS_NAME, s = s.substring(s.lastIndexOf(".") + 1);
            switch (s) {
                case"Spatial":
                    switch (i.type) {
                        case OpenLayers.Filter.Spatial.BBOX:
                            n.bbox = i.value.toArray(), this.srsInBBOX && i.projection && n.bbox.push(i.projection.getCode());
                            break;
                        case OpenLayers.Filter.Spatial.DWITHIN:
                            n.tolerance = i.distance;
                        case OpenLayers.Filter.Spatial.WITHIN:
                            n.lon = i.value.x, n.lat = i.value.y;
                            break;
                        default:
                            OpenLayers.Console.warn("Unknown spatial filter type " + i.type)
                    }
                    break;
                case"Comparison":
                    if (s = t[i.type], void 0 !== s) {
                        var r = i.value;
                        i.type == OpenLayers.Filter.Comparison.LIKE && (r = e(r), this.wildcarded && (r = "%" + r + "%")), n[i.property + "__" + s] = r, n.queryable = n.queryable || [], n.queryable.push(i.property)
                    } else OpenLayers.Console.warn("Unknown comparison filter type " + i.type);
                    break;
                case"Logical":
                    if (i.type === OpenLayers.Filter.Logical.AND)for (s = 0, r = i.filters.length; r > s; s++)n = this.write(i.filters[s], n); else OpenLayers.Console.warn("Unsupported logical filter type " + i.type);
                    break;
                default:
                    OpenLayers.Console.warn("Unknown filter type " + s)
            }
            return n
        },
        CLASS_NAME: "OpenLayers.Format.QueryStringFilter"
    })
}(),OpenLayers.Control.MousePosition = OpenLayers.Class(OpenLayers.Control, {
    autoActivate: !0,
    element: null,
    prefix: "",
    separator: ", ",
    suffix: "",
    numDigits: 5,
    granularity: 10,
    emptyString: null,
    lastXy: null,
    displayProjection: null,
    destroy: function () {
        this.deactivate(), OpenLayers.Control.prototype.destroy.apply(this, arguments)
    },
    activate: function () {
        return OpenLayers.Control.prototype.activate.apply(this, arguments) ? (this.map.events.register("mousemove", this, this.redraw), this.map.events.register("mouseout", this, this.reset), this.redraw(), !0) : !1
    },
    deactivate: function () {
        return OpenLayers.Control.prototype.deactivate.apply(this, arguments) ? (this.map.events.unregister("mousemove", this, this.redraw), this.map.events.unregister("mouseout", this, this.reset), this.element.innerHTML = "", !0) : !1
    },
    draw: function () {
        return OpenLayers.Control.prototype.draw.apply(this, arguments), this.element || (this.div.left = "", this.div.top = "", this.element = this.div), this.div
    },
    redraw: function (e) {
        var t;
        null == e ? this.reset() : null == this.lastXy || Math.abs(e.xy.x - this.lastXy.x) > this.granularity || Math.abs(e.xy.y - this.lastXy.y) > this.granularity ? this.lastXy = e.xy : (t = this.map.getLonLatFromPixel(e.xy)) && (this.displayProjection && t.transform(this.map.getProjectionObject(), this.displayProjection), this.lastXy = e.xy, e = this.formatOutput(t), e != this.element.innerHTML && (this.element.innerHTML = e))
    },
    reset: function () {
        null != this.emptyString && (this.element.innerHTML = this.emptyString)
    },
    formatOutput: function (e) {
        var t = parseInt(this.numDigits);
        return this.prefix + e.lon.toFixed(t) + this.separator + e.lat.toFixed(t) + this.suffix
    },
    CLASS_NAME: "OpenLayers.Control.MousePosition"
}),OpenLayers.Control.Geolocate = OpenLayers.Class(OpenLayers.Control, {
    geolocation: navigator.geolocation,
    bind: !0,
    watch: !1,
    geolocationOptions: null,
    destroy: function () {
        this.deactivate(), OpenLayers.Control.prototype.destroy.apply(this, arguments)
    },
    activate: function () {
        return this.geolocation ? OpenLayers.Control.prototype.activate.apply(this, arguments) ? (this.watch ? this.watchId = this.geolocation.watchPosition(OpenLayers.Function.bind(this.geolocate, this), OpenLayers.Function.bind(this.failure, this), this.geolocationOptions) : this.getCurrentLocation(), !0) : !1 : (this.events.triggerEvent("locationuncapable"), !1)
    },
    deactivate: function () {
        return this.active && null !== this.watchId && this.geolocation.clearWatch(this.watchId), OpenLayers.Control.prototype.deactivate.apply(this, arguments)
    },
    geolocate: function (e) {
        var t = new OpenLayers.LonLat(e.coords.longitude, e.coords.latitude).transform(new OpenLayers.Projection("EPSG:4326"), this.map.getProjectionObject());
        this.bind && this.map.setCenter(t), this.events.triggerEvent("locationupdated", {
            position: e,
            point: new OpenLayers.Geometry.Point(t.lon, t.lat)
        })
    },
    getCurrentLocation: function () {
        return !this.active || this.watch ? !1 : (this.geolocation.getCurrentPosition(OpenLayers.Function.bind(this.geolocate, this), OpenLayers.Function.bind(this.failure, this), this.geolocationOptions), !0)
    },
    failure: function (e) {
        this.events.triggerEvent("locationfailed", {error: e})
    },
    CLASS_NAME: "OpenLayers.Control.Geolocate"
}),OpenLayers.Tile.UTFGrid = OpenLayers.Class(OpenLayers.Tile, {
    url: null,
    utfgridResolution: 2,
    json: null,
    format: null,
    destroy: function () {
        this.clear(), OpenLayers.Tile.prototype.destroy.apply(this, arguments)
    },
    draw: function () {
        var e = OpenLayers.Tile.prototype.draw.apply(this, arguments);
        if (e)if (this.isLoading ? (this.abortLoading(), this.events.triggerEvent("reload")) : (this.isLoading = !0, this.events.triggerEvent("loadstart")), this.url = this.layer.getURL(this.bounds), this.layer.useJSONP) {
            var t = new OpenLayers.Protocol.Script({
                url: this.url, callback: function (e) {
                    this.isLoading = !1, this.events.triggerEvent("loadend"), this.json = e.data
                }, scope: this
            });
            t.read(), this.request = t
        } else this.request = OpenLayers.Request.GET({
            url: this.url, callback: function (e) {
                this.isLoading = !1, this.events.triggerEvent("loadend"), 200 === e.status && this.parseData(e.responseText)
            }, scope: this
        }); else this.unload();
        return e
    },
    abortLoading: function () {
        this.request && (this.request.abort(), delete this.request), this.isLoading = !1
    },
    getFeatureInfo: function (e, t) {
        var i = null;
        if (this.json) {
            var n = this.getFeatureId(e, t);
            null !== n && (i = {id: n, data: this.json.data[n]})
        }
        return i
    },
    getFeatureId: function (e, t) {
        var i = null;
        if (this.json) {
            var n = this.utfgridResolution, n = this.indexFromCharCode(this.json.grid[Math.floor(t / n)].charCodeAt(Math.floor(e / n))), s = this.json.keys;
            !isNaN(n) && n in s && (i = s[n])
        }
        return i
    },
    indexFromCharCode: function (e) {
        return e >= 93 && e--, e >= 35 && e--, e - 32
    },
    parseData: function (e) {
        this.format || (this.format = new OpenLayers.Format.JSON), this.json = this.format.read(e)
    },
    clear: function () {
        this.json = null
    },
    CLASS_NAME: "OpenLayers.Tile.UTFGrid"
}),OpenLayers.Control.NavigationHistory = OpenLayers.Class(OpenLayers.Control, {
    type: OpenLayers.Control.TYPE_TOGGLE,
    previous: null,
    previousOptions: null,
    next: null,
    nextOptions: null,
    limit: 50,
    autoActivate: !0,
    clearOnDeactivate: !1,
    registry: null,
    nextStack: null,
    previousStack: null,
    listeners: null,
    restoring: !1,
    initialize: function (e) {
        OpenLayers.Control.prototype.initialize.apply(this, [e]), this.registry = OpenLayers.Util.extend({moveend: this.getState}, this.registry), e = {
            trigger: OpenLayers.Function.bind(this.previousTrigger, this),
            displayClass: this.displayClass + " " + this.displayClass + "Previous"
        }, OpenLayers.Util.extend(e, this.previousOptions), this.previous = new OpenLayers.Control.Button(e), e = {
            trigger: OpenLayers.Function.bind(this.nextTrigger, this),
            displayClass: this.displayClass + " " + this.displayClass + "Next"
        }, OpenLayers.Util.extend(e, this.nextOptions), this.next = new OpenLayers.Control.Button(e), this.clear()
    },
    onPreviousChange: function (e) {
        e && !this.previous.active ? this.previous.activate() : !e && this.previous.active && this.previous.deactivate()
    },
    onNextChange: function (e) {
        e && !this.next.active ? this.next.activate() : !e && this.next.active && this.next.deactivate()
    },
    destroy: function () {
        OpenLayers.Control.prototype.destroy.apply(this), this.previous.destroy(), this.next.destroy(), this.deactivate();
        for (var e in this)this[e] = null
    },
    setMap: function (e) {
        this.map = e, this.next.setMap(e), this.previous.setMap(e)
    },
    draw: function () {
        OpenLayers.Control.prototype.draw.apply(this, arguments), this.next.draw(), this.previous.draw()
    },
    previousTrigger: function () {
        var e = this.previousStack.shift(), t = this.previousStack.shift();
        return void 0 != t ? (this.nextStack.unshift(e), this.previousStack.unshift(t), this.restoring = !0, this.restore(t), this.restoring = !1, this.onNextChange(this.nextStack[0], this.nextStack.length), this.onPreviousChange(this.previousStack[1], this.previousStack.length - 1)) : this.previousStack.unshift(e), t
    },
    nextTrigger: function () {
        var e = this.nextStack.shift();
        return void 0 != e && (this.previousStack.unshift(e), this.restoring = !0, this.restore(e), this.restoring = !1, this.onNextChange(this.nextStack[0], this.nextStack.length), this.onPreviousChange(this.previousStack[1], this.previousStack.length - 1)), e
    },
    clear: function () {
        this.previousStack = [], this.previous.deactivate(), this.nextStack = [], this.next.deactivate()
    },
    getState: function () {
        return {
            center: this.map.getCenter(),
            resolution: this.map.getResolution(),
            projection: this.map.getProjectionObject(),
            units: this.map.getProjectionObject().getUnits() || this.map.units || this.map.baseLayer.units
        }
    },
    restore: function (e) {
        var t, i;
        if (this.map.getProjectionObject() == e.projection) i = this.map.getZoomForResolution(e.resolution), t = e.center; else {
            t = e.center.clone(), t.transform(e.projection, this.map.getProjectionObject()), i = e.units;
            var n = this.map.getProjectionObject().getUnits() || this.map.units || this.map.baseLayer.units;
            i = this.map.getZoomForResolution((i && n ? OpenLayers.INCHES_PER_UNIT[i] / OpenLayers.INCHES_PER_UNIT[n] : 1) * e.resolution)
        }
        this.map.setCenter(t, i)
    },
    setListeners: function () {
        this.listeners = {};
        for (var e in this.registry)this.listeners[e] = OpenLayers.Function.bind(function () {
            return this.restoring || (this.previousStack.unshift(this.registry[e].apply(this, arguments)), 1 < this.previousStack.length && this.onPreviousChange(this.previousStack[1], this.previousStack.length - 1), this.previousStack.length > this.limit + 1 && this.previousStack.pop(), 0 < this.nextStack.length && (this.nextStack = [], this.onNextChange(null, 0))), !0
        }, this)
    },
    activate: function () {
        var e = !1;
        if (this.map && OpenLayers.Control.prototype.activate.apply(this)) {
            null == this.listeners && this.setListeners();
            for (var t in this.listeners)this.map.events.register(t, this, this.listeners[t]);
            e = !0, 0 == this.previousStack.length && this.initStack()
        }
        return e
    },
    initStack: function () {
        this.map.getCenter() && this.listeners.moveend()
    },
    deactivate: function () {
        var e = !1;
        if (this.map && OpenLayers.Control.prototype.deactivate.apply(this)) {
            for (var t in this.listeners)this.map.events.unregister(t, this, this.listeners[t]);
            this.clearOnDeactivate && this.clear(), e = !0
        }
        return e
    },
    CLASS_NAME: "OpenLayers.Control.NavigationHistory"
}),OpenLayers.Protocol.HTTP = OpenLayers.Class(OpenLayers.Protocol, {
    url: null,
    headers: null,
    params: null,
    callback: null,
    scope: null,
    readWithPOST: !1,
    updateWithPOST: !1,
    deleteWithPOST: !1,
    wildcarded: !1,
    srsInBBOX: !1,
    initialize: function (e) {
        if (e = e || {}, this.params = {}, this.headers = {}, OpenLayers.Protocol.prototype.initialize.apply(this, arguments), !this.filterToParams && OpenLayers.Format.QueryStringFilter) {
            var t = new OpenLayers.Format.QueryStringFilter({wildcarded: this.wildcarded, srsInBBOX: this.srsInBBOX});
            this.filterToParams = function (e, i) {
                return t.write(e, i)
            }
        }
    },
    destroy: function () {
        this.headers = this.params = null, OpenLayers.Protocol.prototype.destroy.apply(this)
    },
    read: function (e) {
        OpenLayers.Protocol.prototype.read.apply(this, arguments), e = e || {}, e.params = OpenLayers.Util.applyDefaults(e.params, this.options.params), e = OpenLayers.Util.applyDefaults(e, this.options), e.filter && this.filterToParams && (e.params = this.filterToParams(e.filter, e.params));
        var t = void 0 !== e.readWithPOST ? e.readWithPOST : this.readWithPOST, i = new OpenLayers.Protocol.Response({requestType: "read"});
        return t ? (t = e.headers || {}, t["Content-Type"] = "application/x-www-form-urlencoded", i.priv = OpenLayers.Request.POST({
            url: e.url,
            callback: this.createCallback(this.handleRead, i, e),
            data: OpenLayers.Util.getParameterString(e.params),
            headers: t
        })) : i.priv = OpenLayers.Request.GET({
            url: e.url,
            callback: this.createCallback(this.handleRead, i, e),
            params: e.params,
            headers: e.headers
        }), i
    },
    handleRead: function (e, t) {
        this.handleResponse(e, t)
    },
    create: function (e, t) {
        var t = OpenLayers.Util.applyDefaults(t, this.options), i = new OpenLayers.Protocol.Response({
            reqFeatures: e,
            requestType: "create"
        });
        return i.priv = OpenLayers.Request.POST({
            url: t.url,
            callback: this.createCallback(this.handleCreate, i, t),
            headers: t.headers,
            data: this.format.write(e)
        }), i
    },
    handleCreate: function (e, t) {
        this.handleResponse(e, t)
    },
    update: function (e, t) {
        var t = t || {}, i = t.url || e.url || this.options.url + "/" + e.fid, t = OpenLayers.Util.applyDefaults(t, this.options), n = new OpenLayers.Protocol.Response({
            reqFeatures: e,
            requestType: "update"
        });
        return n.priv = OpenLayers.Request[this.updateWithPOST ? "POST" : "PUT"]({
            url: i,
            callback: this.createCallback(this.handleUpdate, n, t),
            headers: t.headers,
            data: this.format.write(e)
        }), n
    },
    handleUpdate: function (e, t) {
        this.handleResponse(e, t)
    },
    "delete": function (e, t) {
        var t = t || {}, i = t.url || e.url || this.options.url + "/" + e.fid, t = OpenLayers.Util.applyDefaults(t, this.options), n = new OpenLayers.Protocol.Response({
            reqFeatures: e,
            requestType: "delete"
        }), s = this.deleteWithPOST ? "POST" : "DELETE", i = {
            url: i,
            callback: this.createCallback(this.handleDelete, n, t),
            headers: t.headers
        };
        return this.deleteWithPOST && (i.data = this.format.write(e)), n.priv = OpenLayers.Request[s](i), n
    },
    handleDelete: function (e, t) {
        this.handleResponse(e, t)
    },
    handleResponse: function (e, t) {
        var i = e.priv;
        t.callback && (200 <= i.status && 300 > i.status ? ("delete" != e.requestType && (e.features = this.parseFeatures(i)), e.code = OpenLayers.Protocol.Response.SUCCESS) : e.code = OpenLayers.Protocol.Response.FAILURE, t.callback.call(t.scope, e))
    },
    parseFeatures: function (e) {
        var t = e.responseXML;
        return t && t.documentElement || (t = e.responseText), !t || 0 >= t.length ? null : this.format.read(t)
    },
    commit: function (e, t) {
        function i(e) {
            for (var t = e.features ? e.features.length : 0, i = Array(t), s = 0; t > s; ++s)i[s] = e.features[s].fid;
            f.insertIds = i, n.apply(this, [e])
        }

        function n(e) {
            this.callUserCallback(e, t), d = d && e.success(), r++, r >= p && t.callback && (f.code = d ? OpenLayers.Protocol.Response.SUCCESS : OpenLayers.Protocol.Response.FAILURE, t.callback.apply(t.scope, [f]))
        }

        var t = OpenLayers.Util.applyDefaults(t, this.options), s = [], r = 0, a = {};
        a[OpenLayers.State.INSERT] = [], a[OpenLayers.State.UPDATE] = [], a[OpenLayers.State.DELETE] = [];
        for (var o, l, h = [], u = 0, c = e.length; c > u; ++u)o = e[u], (l = a[o.state]) && (l.push(o), h.push(o));
        var p = (0 < a[OpenLayers.State.INSERT].length ? 1 : 0) + a[OpenLayers.State.UPDATE].length + a[OpenLayers.State.DELETE].length, d = !0, f = new OpenLayers.Protocol.Response({reqFeatures: h});
        for (o = a[OpenLayers.State.INSERT], 0 < o.length && s.push(this.create(o, OpenLayers.Util.applyDefaults({
            callback: i,
            scope: this
        }, t.create))), o = a[OpenLayers.State.UPDATE], u = o.length - 1; u >= 0; --u)s.push(this.update(o[u], OpenLayers.Util.applyDefaults({
            callback: n,
            scope: this
        }, t.update)));
        for (o = a[OpenLayers.State.DELETE], u = o.length - 1; u >= 0; --u)s.push(this["delete"](o[u], OpenLayers.Util.applyDefaults({
            callback: n,
            scope: this
        }, t["delete"])));
        return s
    },
    abort: function (e) {
        e && e.priv.abort()
    },
    callUserCallback: function (e, t) {
        var i = t[e.requestType];
        i && i.callback && i.callback.call(i.scope, e)
    },
    CLASS_NAME: "OpenLayers.Protocol.HTTP"
}),OpenLayers.Strategy.Cluster = OpenLayers.Class(OpenLayers.Strategy, {
    distance: 20,
    threshold: null,
    features: null,
    clusters: null,
    clustering: !1,
    resolution: null,
    activate: function () {
        var e = OpenLayers.Strategy.prototype.activate.call(this);
        return e && this.layer.events.on({
            beforefeaturesadded: this.cacheFeatures,
            moveend: this.cluster,
            scope: this
        }), e
    },
    deactivate: function () {
        var e = OpenLayers.Strategy.prototype.deactivate.call(this);
        return e && (this.clearCache(), this.layer.events.un({
            beforefeaturesadded: this.cacheFeatures,
            moveend: this.cluster,
            scope: this
        })), e
    },
    cacheFeatures: function (e) {
        var t = !0;
        return this.clustering || (this.clearCache(), this.features = e.features, this.cluster(), t = !1), t
    },
    clearCache: function () {
        this.features = null
    },
    cluster: function (e) {
        if ((!e || e.zoomChanged) && this.features && (e = this.layer.map.getResolution(), e != this.resolution || !this.clustersExist())) {
            this.resolution = e;
            for (var t, i, n, e = [], s = 0; s < this.features.length; ++s)if (t = this.features[s], t.geometry) {
                i = !1;
                for (var r = e.length - 1; r >= 0; --r)if (n = e[r], this.shouldCluster(n, t)) {
                    this.addToCluster(n, t), i = !0;
                    break
                }
                i || e.push(this.createCluster(this.features[s]))
            }
            if (this.layer.removeAllFeatures(), 0 < e.length) {
                if (1 < this.threshold)for (t = e.slice(), e = [], s = 0, n = t.length; n > s; ++s)i = t[s], i.attributes.count < this.threshold ? Array.prototype.push.apply(e, i.cluster) : e.push(i);
                this.clustering = !0, this.layer.addFeatures(e), this.clustering = !1
            }
            this.clusters = e
        }
    },
    clustersExist: function () {
        var e = !1;
        if (this.clusters && 0 < this.clusters.length && this.clusters.length == this.layer.features.length)for (var e = !0, t = 0; t < this.clusters.length; ++t)if (this.clusters[t] != this.layer.features[t]) {
            e = !1;
            break
        }
        return e
    },
    shouldCluster: function (e, t) {
        var i = e.geometry.getBounds().getCenterLonLat(), n = t.geometry.getBounds().getCenterLonLat();
        return Math.sqrt(Math.pow(i.lon - n.lon, 2) + Math.pow(i.lat - n.lat, 2)) / this.resolution <= this.distance
    },
    addToCluster: function (e, t) {
        e.cluster.push(t), e.attributes.count += 1
    },
    createCluster: function (e) {
        var t = e.geometry.getBounds().getCenterLonLat(), t = new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(t.lon, t.lat), {count: 1});
        return t.cluster = [e], t
    },
    CLASS_NAME: "OpenLayers.Strategy.Cluster"
}),OpenLayers.Strategy.Filter = OpenLayers.Class(OpenLayers.Strategy, {
    filter: null,
    cache: null,
    caching: !1,
    activate: function () {
        var e = OpenLayers.Strategy.prototype.activate.apply(this, arguments);
        return e && (this.cache = [], this.layer.events.on({
            beforefeaturesadded: this.handleAdd,
            beforefeaturesremoved: this.handleRemove,
            scope: this
        })), e
    },
    deactivate: function () {
        return this.cache = null, this.layer && this.layer.events && this.layer.events.un({
            beforefeaturesadded: this.handleAdd,
            beforefeaturesremoved: this.handleRemove,
            scope: this
        }), OpenLayers.Strategy.prototype.deactivate.apply(this, arguments)
    },
    handleAdd: function (e) {
        if (!this.caching && this.filter) {
            var t = e.features;
            e.features = [];
            for (var i, n = 0, s = t.length; s > n; ++n)i = t[n], this.filter.evaluate(i) ? e.features.push(i) : this.cache.push(i)
        }
    },
    handleRemove: function () {
        this.caching || (this.cache = [])
    },
    setFilter: function (e) {
        this.filter = e, e = this.cache, this.cache = [], this.handleAdd({features: this.layer.features}), 0 < this.cache.length && (this.caching = !0, this.layer.removeFeatures(this.cache.slice()), this.caching = !1), 0 < e.length && (e = {features: e}, this.handleAdd(e), 0 < e.features.length && (this.caching = !0, this.layer.addFeatures(e.features), this.caching = !1))
    },
    CLASS_NAME: "OpenLayers.Strategy.Filter"
}),OpenLayers.Protocol.SOS = function (e) {
    var e = OpenLayers.Util.applyDefaults(e, OpenLayers.Protocol.SOS.DEFAULTS), t = OpenLayers.Protocol.SOS["v" + e.version.replace(/\./g, "_")];
    if (!t)throw"Unsupported SOS version: " + e.version;
    return new t(e)
},OpenLayers.Protocol.SOS.DEFAULTS = {version: "1.0.0"},OpenLayers.Format.WFSDescribeFeatureType = OpenLayers.Class(OpenLayers.Format.XML, {
    namespaces: {xsd: "http://www.w3.org/2001/XMLSchema"},
    readers: {
        xsd: {
            schema: function (e, t) {
                var i = [], n = {};
                this.readChildNodes(e, {complexTypes: i, customTypes: n});
                for (var s, r, a = e.attributes, o = 0, l = a.length; l > o; ++o)s = a[o], r = s.name, 0 == r.indexOf("xmlns") ? this.setNamespace(r.split(":")[1] || "", s.value) : t[r] = s.value;
                for (t.featureTypes = i, t.targetPrefix = this.namespaceAlias[t.targetNamespace], o = 0, l = i.length; l > o; ++o)a = i[o], s = n[a.typeName], n[a.typeName] && (a.typeName = s.name)
            }, complexType: function (e, t) {
                var i = {typeName: e.getAttribute("name")};
                this.readChildNodes(e, i), t.complexTypes.push(i)
            }, complexContent: function (e, t) {
                this.readChildNodes(e, t)
            }, extension: function (e, t) {
                this.readChildNodes(e, t)
            }, sequence: function (e, t) {
                var i = {elements: []};
                this.readChildNodes(e, i), t.properties = i.elements
            }, element: function (e, t) {
                if (t.elements) {
                    for (var i, n = {}, s = e.attributes, r = 0, a = s.length; a > r; ++r)i = s[r], n[i.name] = i.value;
                    s = n.type, s || (s = {}, this.readChildNodes(e, s), n.restriction = s, n.type = s.base), n.localType = (s.base || s).split(":").pop(), t.elements.push(n)
                }
                t.complexTypes && (s = e.getAttribute("type"), n = s.split(":").pop(), t.customTypes[n] = {
                    name: e.getAttribute("name"),
                    type: s
                })
            }, simpleType: function (e, t) {
                this.readChildNodes(e, t)
            }, restriction: function (e, t) {
                t.base = e.getAttribute("base"), this.readRestriction(e, t)
            }
        }
    },
    readRestriction: function (e, t) {
        for (var i, n, s = e.childNodes, r = 0, a = s.length; a > r; ++r)i = s[r], 1 == i.nodeType && (n = i.nodeName.split(":").pop(), i = i.getAttribute("value"), t[n] ? ("string" == typeof t[n] && (t[n] = [t[n]]), t[n].push(i)) : t[n] = i)
    },
    read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e])), e && 9 == e.nodeType && (e = e.documentElement);
        var t = {};
        return this.readNode(e, t), t
    },
    CLASS_NAME: "OpenLayers.Format.WFSDescribeFeatureType"
}),OpenLayers.Format.GeoRSS = OpenLayers.Class(OpenLayers.Format.XML, {
    rssns: "http://backend.userland.com/rss2",
    featureNS: "http://mapserver.gis.umn.edu/mapserver",
    georssns: "http://www.georss.org/georss",
    geons: "http://www.w3.org/2003/01/geo/wgs84_pos#",
    featureTitle: "Untitled",
    featureDescription: "No Description",
    gmlParser: null,
    xy: !1,
    createGeometryFromItem: function (e) {
        var t = this.getElementsByTagNameNS(e, this.georssns, "point"), i = this.getElementsByTagNameNS(e, this.geons, "lat"), n = this.getElementsByTagNameNS(e, this.geons, "long"), s = this.getElementsByTagNameNS(e, this.georssns, "line"), r = this.getElementsByTagNameNS(e, this.georssns, "polygon"), a = this.getElementsByTagNameNS(e, this.georssns, "where"), e = this.getElementsByTagNameNS(e, this.georssns, "box");
        if (0 < t.length || 0 < i.length && 0 < n.length) {
            0 < t.length ? (i = OpenLayers.String.trim(t[0].firstChild.nodeValue).split(/\s+/), 2 != i.length && (i = OpenLayers.String.trim(t[0].firstChild.nodeValue).split(/\s*,\s*/))) : i = [parseFloat(i[0].firstChild.nodeValue), parseFloat(n[0].firstChild.nodeValue)];
            var o = new OpenLayers.Geometry.Point(i[1], i[0])
        } else if (0 < s.length) {
            for (i = OpenLayers.String.trim(this.getChildValue(s[0])).split(/\s+/), n = [], s = 0, r = i.length; r > s; s += 2)t = new OpenLayers.Geometry.Point(i[s + 1], i[s]), n.push(t);
            o = new OpenLayers.Geometry.LineString(n)
        } else if (0 < r.length) {
            for (i = OpenLayers.String.trim(this.getChildValue(r[0])).split(/\s+/), n = [], s = 0, r = i.length; r > s; s += 2)t = new OpenLayers.Geometry.Point(i[s + 1], i[s]), n.push(t);
            o = new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(n)])
        } else 0 < a.length ? (this.gmlParser || (this.gmlParser = new OpenLayers.Format.GML({xy: this.xy})), o = this.gmlParser.parseFeature(a[0]).geometry) : 0 < e.length && (i = OpenLayers.String.trim(e[0].firstChild.nodeValue).split(/\s+/), n = [], 3 < i.length && (t = new OpenLayers.Geometry.Point(i[1], i[0]), n.push(t), t = new OpenLayers.Geometry.Point(i[1], i[2]), n.push(t), t = new OpenLayers.Geometry.Point(i[3], i[2]), n.push(t), t = new OpenLayers.Geometry.Point(i[3], i[0]), n.push(t), t = new OpenLayers.Geometry.Point(i[1], i[0]), n.push(t)), o = new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(n)]));
        return o && this.internalProjection && this.externalProjection && o.transform(this.externalProjection, this.internalProjection), o
    },
    createFeatureFromItem: function (e) {
        var t = this.createGeometryFromItem(e), i = this._getChildValue(e, "*", "title", this.featureTitle), n = this._getChildValue(e, "*", "description", this._getChildValue(e, "*", "content", this._getChildValue(e, "*", "summary", this.featureDescription))), s = this._getChildValue(e, "*", "link");
        if (!s)try {
            s = this.getElementsByTagNameNS(e, "*", "link")[0].getAttribute("href")
        } catch (r) {
            s = null
        }
        return e = this._getChildValue(e, "*", "id", null), t = new OpenLayers.Feature.Vector(t, {
            title: i,
            description: n,
            link: s
        }), t.fid = e, t
    },
    _getChildValue: function (e, t, i, n) {
        return (e = this.getElementsByTagNameNS(e, t, i)) && e[0] && e[0].firstChild && e[0].firstChild.nodeValue ? this.getChildValue(e[0]) : void 0 == n ? "" : n
    },
    read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e]));
        var t = null, t = this.getElementsByTagNameNS(e, "*", "item");
        0 == t.length && (t = this.getElementsByTagNameNS(e, "*", "entry"));
        for (var e = t.length, i = Array(e), n = 0; e > n; n++)i[n] = this.createFeatureFromItem(t[n]);
        return i
    },
    write: function (e) {
        var t;
        if (OpenLayers.Util.isArray(e)) {
            t = this.createElementNS(this.rssns, "rss");
            for (var i = 0, n = e.length; n > i; i++)t.appendChild(this.createFeatureXML(e[i]))
        } else t = this.createFeatureXML(e);
        return OpenLayers.Format.XML.prototype.write.apply(this, [t])
    },
    createFeatureXML: function (e) {
        var t = this.buildGeometryNode(e.geometry), i = this.createElementNS(this.rssns, "item"), n = this.createElementNS(this.rssns, "title");
        n.appendChild(this.createTextNode(e.attributes.title ? e.attributes.title : ""));
        var s = this.createElementNS(this.rssns, "description");
        s.appendChild(this.createTextNode(e.attributes.description ? e.attributes.description : "")), i.appendChild(n), i.appendChild(s), e.attributes.link && (n = this.createElementNS(this.rssns, "link"), n.appendChild(this.createTextNode(e.attributes.link)), i.appendChild(n));
        for (var r in e.attributes)"link" == r || "title" == r || "description" == r || (n = this.createTextNode(e.attributes[r]), s = r, -1 != r.search(":") && (s = r.split(":")[1]), s = this.createElementNS(this.featureNS, "feature:" + s), s.appendChild(n), i.appendChild(s));
        return i.appendChild(t), i
    },
    buildGeometryNode: function (e) {
        this.internalProjection && this.externalProjection && (e = e.clone(), e.transform(this.internalProjection, this.externalProjection));
        var t;
        if ("OpenLayers.Geometry.Polygon" == e.CLASS_NAME) t = this.createElementNS(this.georssns, "georss:polygon"), t.appendChild(this.buildCoordinatesNode(e.components[0])); else if ("OpenLayers.Geometry.LineString" == e.CLASS_NAME) t = this.createElementNS(this.georssns, "georss:line"), t.appendChild(this.buildCoordinatesNode(e)); else {
            if ("OpenLayers.Geometry.Point" != e.CLASS_NAME)throw"Couldn't parse " + e.CLASS_NAME;
            t = this.createElementNS(this.georssns, "georss:point"), t.appendChild(this.buildCoordinatesNode(e))
        }
        return t
    },
    buildCoordinatesNode: function (e) {
        var t = null;
        if (e.components && (t = e.components), t) {
            for (var e = t.length, i = Array(e), n = 0; e > n; n++)i[n] = t[n].y + " " + t[n].x;
            t = i.join(" ")
        } else t = e.y + " " + e.x;
        return this.createTextNode(t)
    },
    CLASS_NAME: "OpenLayers.Format.GeoRSS"
}),OpenLayers.Format.WPSCapabilities = OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC, {
    defaultVersion: "1.0.0",
    CLASS_NAME: "OpenLayers.Format.WPSCapabilities"
}),OpenLayers.Format.WPSCapabilities.v1_0_0 = OpenLayers.Class(OpenLayers.Format.XML, {
    namespaces: {
        ows: "http://www.opengis.net/ows/1.1",
        wps: "http://www.opengis.net/wps/1.0.0",
        xlink: "http://www.w3.org/1999/xlink"
    },
    regExes: {trimSpace: /^\s*|\s*$/g, removeSpace: /\s*/g, splitSpace: /\s+/, trimComma: /\s*,\s*/g},
    initialize: function (e) {
        OpenLayers.Format.XML.prototype.initialize.apply(this, [e])
    },
    read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e])), e && 9 == e.nodeType && (e = e.documentElement);
        var t = {};
        return this.readNode(e, t), t
    },
    readers: {
        wps: {
            Capabilities: function (e, t) {
                this.readChildNodes(e, t)
            }, ProcessOfferings: function (e, t) {
                t.processOfferings = {}, this.readChildNodes(e, t.processOfferings)
            }, Process: function (e, t) {
                var i = {processVersion: this.getAttributeNS(e, this.namespaces.wps, "processVersion")};
                this.readChildNodes(e, i), t[i.identifier] = i
            }, Languages: function (e, t) {
                t.languages = [], this.readChildNodes(e, t.languages)
            }, Default: function (e, t) {
                var i = {isDefault: !0};
                this.readChildNodes(e, i), t.push(i)
            }, Supported: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), t.push(i)
            }
        }, ows: OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows
    },
    CLASS_NAME: "OpenLayers.Format.WPSCapabilities.v1_0_0"
}),OpenLayers.Control.PinchZoom = OpenLayers.Class(OpenLayers.Control, {
    type: OpenLayers.Control.TYPE_TOOL,
    containerCenter: null,
    pinchOrigin: null,
    currentCenter: null,
    autoActivate: !0,
    initialize: function () {
        OpenLayers.Control.prototype.initialize.apply(this, arguments), this.handler = new OpenLayers.Handler.Pinch(this, {
            start: this.pinchStart,
            move: this.pinchMove,
            done: this.pinchDone
        }, this.handlerOptions)
    },
    activate: function () {
        var e = OpenLayers.Control.prototype.activate.apply(this, arguments);
        return e && (this.map.events.on({
            moveend: this.updateContainerCenter,
            scope: this
        }), this.updateContainerCenter()), e
    },
    deactivate: function () {
        var e = OpenLayers.Control.prototype.deactivate.apply(this, arguments);
        return this.map && this.map.events && this.map.events.un({moveend: this.updateContainerCenter, scope: this}), e
    },
    updateContainerCenter: function () {
        var e = this.map.layerContainerDiv;
        this.containerCenter = {x: parseInt(e.style.left, 10) + 50, y: parseInt(e.style.top, 10) + 50}
    },
    pinchStart: function (e) {
        this.currentCenter = this.pinchOrigin = e.xy
    },
    pinchMove: function (e, t) {
        var i = t.scale, n = this.containerCenter, s = this.pinchOrigin, r = e.xy, a = Math.round(r.x - s.x + (i - 1) * (n.x - s.x)), n = Math.round(r.y - s.y + (i - 1) * (n.y - s.y));
        this.applyTransform("translate(" + a + "px, " + n + "px) scale(" + i + ")"), this.currentCenter = r
    },
    applyTransform: function (e) {
        var t = this.map.layerContainerDiv.style;
        t["-webkit-transform"] = e, t["-moz-transform"] = e
    },
    pinchDone: function (e, t, i) {
        if (this.applyTransform(""), e = this.map.getZoomForResolution(this.map.getResolution() / i.scale, !0), e !== this.map.getZoom() || !this.currentCenter.equals(this.pinchOrigin)) {
            var t = this.map.getResolutionForZoom(e), i = this.map.getLonLatFromPixel(this.pinchOrigin), n = this.currentCenter, s = this.map.getSize();
            i.lon += t * (s.w / 2 - n.x), i.lat -= t * (s.h / 2 - n.y), this.map.div.clientWidth = this.map.div.clientWidth, this.map.setCenter(i, e)
        }
    },
    CLASS_NAME: "OpenLayers.Control.PinchZoom"
}),OpenLayers.Control.TouchNavigation = OpenLayers.Class(OpenLayers.Control, {
    dragPan: null,
    dragPanOptions: null,
    pinchZoom: null,
    pinchZoomOptions: null,
    clickHandlerOptions: null,
    documentDrag: !1,
    autoActivate: !0,
    initialize: function () {
        this.handlers = {}, OpenLayers.Control.prototype.initialize.apply(this, arguments)
    },
    destroy: function () {
        this.deactivate(), this.dragPan && this.dragPan.destroy(), this.dragPan = null, this.pinchZoom && (this.pinchZoom.destroy(), delete this.pinchZoom), OpenLayers.Control.prototype.destroy.apply(this, arguments)
    },
    activate: function () {
        return OpenLayers.Control.prototype.activate.apply(this, arguments) ? (this.dragPan.activate(), this.handlers.click.activate(), this.pinchZoom.activate(), !0) : !1
    },
    deactivate: function () {
        return OpenLayers.Control.prototype.deactivate.apply(this, arguments) ? (this.dragPan.deactivate(), this.handlers.click.deactivate(), this.pinchZoom.deactivate(), !0) : !1
    },
    draw: function () {
        var e = {click: this.defaultClick, dblclick: this.defaultDblClick}, t = OpenLayers.Util.extend({
            "double": !0,
            stopDouble: !0,
            pixelTolerance: 2
        }, this.clickHandlerOptions);
        this.handlers.click = new OpenLayers.Handler.Click(this, e, t), this.dragPan = new OpenLayers.Control.DragPan(OpenLayers.Util.extend({
            map: this.map,
            documentDrag: this.documentDrag
        }, this.dragPanOptions)), this.dragPan.draw(), this.pinchZoom = new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map: this.map}, this.pinchZoomOptions))
    },
    defaultClick: function (e) {
        e.lastTouches && 2 == e.lastTouches.length && this.map.zoomOut()
    },
    defaultDblClick: function (e) {
        this.map.setCenter(this.map.getLonLatFromViewPortPx(e.xy), this.map.zoom + 1)
    },
    CLASS_NAME: "OpenLayers.Control.TouchNavigation"
}),OpenLayers.Style2 = OpenLayers.Class({
    id: null,
    name: null,
    title: null,
    description: null,
    layerName: null,
    isDefault: !1,
    rules: null,
    initialize: function (e) {
        OpenLayers.Util.extend(this, e), this.id = OpenLayers.Util.createUniqueID(this.CLASS_NAME + "_")
    },
    destroy: function () {
        for (var e = 0, t = this.rules.length; t > e; e++)this.rules[e].destroy();
        delete this.rules
    },
    clone: function () {
        var e = OpenLayers.Util.extend({}, this);
        if (this.rules) {
            e.rules = [];
            for (var t = 0, i = this.rules.length; i > t; ++t)e.rules.push(this.rules[t].clone())
        }
        return new OpenLayers.Style2(e)
    },
    CLASS_NAME: "OpenLayers.Style2"
}),OpenLayers.Format.WFS = OpenLayers.Class(OpenLayers.Format.GML, {
    layer: null,
    wfsns: "http://www.opengis.net/wfs",
    ogcns: "http://www.opengis.net/ogc",
    initialize: function (e, t) {
        OpenLayers.Format.GML.prototype.initialize.apply(this, [e]), this.layer = t, this.layer.featureNS && (this.featureNS = this.layer.featureNS), this.layer.options.geometry_column && (this.geometryName = this.layer.options.geometry_column), this.layer.options.typename && (this.featureName = this.layer.options.typename)
    },
    write: function (e) {
        var t = this.createElementNS(this.wfsns, "wfs:Transaction");
        t.setAttribute("version", "1.0.0"), t.setAttribute("service", "WFS");
        for (var i = 0; i < e.length; i++)switch (e[i].state) {
            case OpenLayers.State.INSERT:
                t.appendChild(this.insert(e[i]));
                break;
            case OpenLayers.State.UPDATE:
                t.appendChild(this.update(e[i]));
                break;
            case OpenLayers.State.DELETE:
                t.appendChild(this.remove(e[i]))
        }
        return OpenLayers.Format.XML.prototype.write.apply(this, [t])
    },
    createFeatureXML: function (e) {
        var t = this.buildGeometryNode(e.geometry), i = this.createElementNS(this.featureNS, "feature:" + this.geometryName);
        i.appendChild(t), t = this.createElementNS(this.featureNS, "feature:" + this.featureName), t.appendChild(i);
        for (var n in e.attributes) {
            var i = this.createTextNode(e.attributes[n]), s = n;
            -1 != n.search(":") && (s = n.split(":")[1]), s = this.createElementNS(this.featureNS, "feature:" + s), s.appendChild(i), t.appendChild(s)
        }
        return t
    },
    insert: function (e) {
        var t = this.createElementNS(this.wfsns, "wfs:Insert");
        return t.appendChild(this.createFeatureXML(e)), t
    },
    update: function (e) {
        e.fid || OpenLayers.Console.userError(OpenLayers.i18n("noFID"));
        var t = this.createElementNS(this.wfsns, "wfs:Update");
        t.setAttribute("typeName", this.featurePrefix + ":" + this.featureName), t.setAttribute("xmlns:" + this.featurePrefix, this.featureNS);
        var i = this.createElementNS(this.wfsns, "wfs:Property"), n = this.createElementNS(this.wfsns, "wfs:Name"), s = this.createTextNode(this.geometryName);
        n.appendChild(s), i.appendChild(n), n = this.createElementNS(this.wfsns, "wfs:Value"), s = this.buildGeometryNode(e.geometry), e.layer && s.setAttribute("srsName", e.layer.projection.getCode()), n.appendChild(s), i.appendChild(n), t.appendChild(i);
        for (var r in e.attributes)i = this.createElementNS(this.wfsns, "wfs:Property"), n = this.createElementNS(this.wfsns, "wfs:Name"), n.appendChild(this.createTextNode(r)), i.appendChild(n), n = this.createElementNS(this.wfsns, "wfs:Value"), n.appendChild(this.createTextNode(e.attributes[r])), i.appendChild(n), t.appendChild(i);
        return i = this.createElementNS(this.ogcns, "ogc:Filter"), r = this.createElementNS(this.ogcns, "ogc:FeatureId"), r.setAttribute("fid", e.fid), i.appendChild(r), t.appendChild(i), t
    },
    remove: function (e) {
        if (!e.fid)return OpenLayers.Console.userError(OpenLayers.i18n("noFID")), !1;
        var t = this.createElementNS(this.wfsns, "wfs:Delete");
        t.setAttribute("typeName", this.featurePrefix + ":" + this.featureName), t.setAttribute("xmlns:" + this.featurePrefix, this.featureNS);
        var i = this.createElementNS(this.ogcns, "ogc:Filter"), n = this.createElementNS(this.ogcns, "ogc:FeatureId");
        return n.setAttribute("fid", e.fid), i.appendChild(n), t.appendChild(i), t
    },
    destroy: function () {
        this.layer = null
    },
    CLASS_NAME: "OpenLayers.Format.WFS"
}),OpenLayers.Format.SLD.v1_0_0_GeoServer = OpenLayers.Class(OpenLayers.Format.SLD.v1_0_0, {
    version: "1.0.0",
    profile: "GeoServer",
    readers: OpenLayers.Util.applyDefaults({
        sld: OpenLayers.Util.applyDefaults({
            Priority: function (e, t) {
                var i = this.readers.ogc._expression.call(this, e);
                i && (t.priority = i)
            }, VendorOption: function (e, t) {
                t.vendorOptions || (t.vendorOptions = {}), t.vendorOptions[e.getAttribute("name")] = this.getChildValue(e)
            }
        }, OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld)
    }, OpenLayers.Format.SLD.v1_0_0.prototype.readers),
    writers: OpenLayers.Util.applyDefaults({
        sld: OpenLayers.Util.applyDefaults({
            Priority: function (e) {
                return this.writers.sld._OGCExpression.call(this, "sld:Priority", e)
            }, VendorOption: function (e) {
                return this.createElementNSPlus("sld:VendorOption", {attributes: {name: e.name}, value: e.value})
            }, TextSymbolizer: function (e) {
                var t = OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.TextSymbolizer.apply(this, arguments);
                return !1 !== e.graphic && (e.externalGraphic || e.graphicName) && this.writeNode("Graphic", e, t), "priority" in e && this.writeNode("Priority", e.priority, t), this.addVendorOptions(t, e)
            }, PointSymbolizer: function (e) {
                return this.addVendorOptions(OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.PointSymbolizer.apply(this, arguments), e)
            }, LineSymbolizer: function (e) {
                return this.addVendorOptions(OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.LineSymbolizer.apply(this, arguments), e)
            }, PolygonSymbolizer: function (e) {
                return this.addVendorOptions(OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.PolygonSymbolizer.apply(this, arguments), e)
            }
        }, OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld)
    }, OpenLayers.Format.SLD.v1_0_0.prototype.writers),
    addVendorOptions: function (e, t) {
        if (t.vendorOptions)for (var i in t.vendorOptions)this.writeNode("VendorOption", {
            name: i,
            value: t.vendorOptions[i]
        }, e);
        return e
    },
    CLASS_NAME: "OpenLayers.Format.SLD.v1_0_0_GeoServer"
}),OpenLayers.Layer.Boxes = OpenLayers.Class(OpenLayers.Layer.Markers, {
    drawMarker: function (e) {
        var t = this.map.getLayerPxFromLonLat({
            lon: e.bounds.left,
            lat: e.bounds.top
        }), i = this.map.getLayerPxFromLonLat({lon: e.bounds.right, lat: e.bounds.bottom});
        null == i || null == t ? e.display(!1) : (t = e.draw(t, {
            w: Math.max(1, i.x - t.x),
            h: Math.max(1, i.y - t.y)
        }), e.drawn || (this.div.appendChild(t), e.drawn = !0))
    }, removeMarker: function (e) {
        OpenLayers.Util.removeItem(this.markers, e), null != e.div && e.div.parentNode == this.div && this.div.removeChild(e.div)
    }, CLASS_NAME: "OpenLayers.Layer.Boxes"
}),OpenLayers.Format.WFSCapabilities.v1_0_0 = OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1, {
    readers: {
        wfs: OpenLayers.Util.applyDefaults({
            Service: function (e, t) {
                t.service = {}, this.readChildNodes(e, t.service)
            }, Fees: function (e, t) {
                var i = this.getChildValue(e);
                i && "none" != i.toLowerCase() && (t.fees = i)
            }, AccessConstraints: function (e, t) {
                var i = this.getChildValue(e);
                i && "none" != i.toLowerCase() && (t.accessConstraints = i)
            }, OnlineResource: function (e, t) {
                var i = this.getChildValue(e);
                i && "none" != i.toLowerCase() && (t.onlineResource = i)
            }, Keywords: function (e, t) {
                var i = this.getChildValue(e);
                i && "none" != i.toLowerCase() && (t.keywords = i.split(", "))
            }, Capability: function (e, t) {
                t.capability = {}, this.readChildNodes(e, t.capability)
            }, Request: function (e, t) {
                t.request = {}, this.readChildNodes(e, t.request)
            }, GetFeature: function (e, t) {
                t.getfeature = {href: {}, formats: []}, this.readChildNodes(e, t.getfeature)
            }, ResultFormat: function (e, t) {
                for (var i, n = e.childNodes, s = 0; s < n.length; s++)i = n[s], 1 == i.nodeType && t.formats.push(i.nodeName)
            }, DCPType: function (e, t) {
                this.readChildNodes(e, t)
            }, HTTP: function (e, t) {
                this.readChildNodes(e, t.href)
            }, Get: function (e, t) {
                t.get = e.getAttribute("onlineResource")
            }, Post: function (e, t) {
                t.post = e.getAttribute("onlineResource")
            }, SRS: function (e, t) {
                var i = this.getChildValue(e);
                i && (t.srs = i)
            }
        }, OpenLayers.Format.WFSCapabilities.v1.prototype.readers.wfs)
    }, CLASS_NAME: "OpenLayers.Format.WFSCapabilities.v1_0_0"
}),OpenLayers.Format.WMSCapabilities = OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC, {
    defaultVersion: "1.1.1",
    profile: null,
    CLASS_NAME: "OpenLayers.Format.WMSCapabilities"
}),OpenLayers.Format.WMSCapabilities.v1 = OpenLayers.Class(OpenLayers.Format.XML, {
    namespaces: {
        wms: "http://www.opengis.net/wms",
        xlink: "http://www.w3.org/1999/xlink",
        xsi: "http://www.w3.org/2001/XMLSchema-instance"
    }, defaultPrefix: "wms", read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e]));
        var t = e;
        e && 9 == e.nodeType && (e = e.documentElement);
        var i = {};
        return this.readNode(e, i), void 0 === i.service && (e = new OpenLayers.Format.OGCExceptionReport, i.error = e.read(t)), i
    }, readers: {
        wms: {
            Service: function (e, t) {
                t.service = {}, this.readChildNodes(e, t.service)
            }, Name: function (e, t) {
                t.name = this.getChildValue(e)
            }, Title: function (e, t) {
                t.title = this.getChildValue(e)
            }, Abstract: function (e, t) {
                t["abstract"] = this.getChildValue(e)
            }, BoundingBox: function (e) {
                var t = {};
                return t.bbox = [parseFloat(e.getAttribute("minx")), parseFloat(e.getAttribute("miny")), parseFloat(e.getAttribute("maxx")), parseFloat(e.getAttribute("maxy"))], e = {
                    x: parseFloat(e.getAttribute("resx")),
                    y: parseFloat(e.getAttribute("resy"))
                }, isNaN(e.x) && isNaN(e.y) || (t.res = e), t
            }, OnlineResource: function (e, t) {
                t.href = this.getAttributeNS(e, this.namespaces.xlink, "href")
            }, ContactInformation: function (e, t) {
                t.contactInformation = {}, this.readChildNodes(e, t.contactInformation)
            }, ContactPersonPrimary: function (e, t) {
                t.personPrimary = {}, this.readChildNodes(e, t.personPrimary)
            }, ContactPerson: function (e, t) {
                t.person = this.getChildValue(e)
            }, ContactOrganization: function (e, t) {
                t.organization = this.getChildValue(e)
            }, ContactPosition: function (e, t) {
                t.position = this.getChildValue(e)
            }, ContactAddress: function (e, t) {
                t.contactAddress = {}, this.readChildNodes(e, t.contactAddress)
            }, AddressType: function (e, t) {
                t.type = this.getChildValue(e)
            }, Address: function (e, t) {
                t.address = this.getChildValue(e)
            }, City: function (e, t) {
                t.city = this.getChildValue(e)
            }, StateOrProvince: function (e, t) {
                t.stateOrProvince = this.getChildValue(e)
            }, PostCode: function (e, t) {
                t.postcode = this.getChildValue(e)
            }, Country: function (e, t) {
                t.country = this.getChildValue(e)
            }, ContactVoiceTelephone: function (e, t) {
                t.phone = this.getChildValue(e)
            }, ContactFacsimileTelephone: function (e, t) {
                t.fax = this.getChildValue(e)
            }, ContactElectronicMailAddress: function (e, t) {
                t.email = this.getChildValue(e)
            }, Fees: function (e, t) {
                var i = this.getChildValue(e);
                i && "none" != i.toLowerCase() && (t.fees = i)
            }, AccessConstraints: function (e, t) {
                var i = this.getChildValue(e);
                i && "none" != i.toLowerCase() && (t.accessConstraints = i)
            }, Capability: function (e, t) {
                t.capability = {nestedLayers: [], layers: []}, this.readChildNodes(e, t.capability)
            }, Request: function (e, t) {
                t.request = {}, this.readChildNodes(e, t.request)
            }, GetCapabilities: function (e, t) {
                t.getcapabilities = {formats: []}, this.readChildNodes(e, t.getcapabilities)
            }, Format: function (e, t) {
                OpenLayers.Util.isArray(t.formats) ? t.formats.push(this.getChildValue(e)) : t.format = this.getChildValue(e)
            }, DCPType: function (e, t) {
                this.readChildNodes(e, t)
            }, HTTP: function (e, t) {
                this.readChildNodes(e, t)
            }, Get: function (e, t) {
                t.get = {}, this.readChildNodes(e, t.get), t.href || (t.href = t.get.href)
            }, Post: function (e, t) {
                t.post = {}, this.readChildNodes(e, t.post), t.href || (t.href = t.get.href)
            }, GetMap: function (e, t) {
                t.getmap = {formats: []}, this.readChildNodes(e, t.getmap)
            }, GetFeatureInfo: function (e, t) {
                t.getfeatureinfo = {formats: []}, this.readChildNodes(e, t.getfeatureinfo)
            }, Exception: function (e, t) {
                t.exception = {formats: []}, this.readChildNodes(e, t.exception)
            }, Layer: function (e, t) {
                var i, n;
                t.capability ? (n = t.capability, i = t) : n = t;
                var s = e.getAttributeNode("queryable"), r = s && s.specified ? e.getAttribute("queryable") : null, a = (s = e.getAttributeNode("cascaded")) && s.specified ? e.getAttribute("cascaded") : null, s = (s = e.getAttributeNode("opaque")) && s.specified ? e.getAttribute("opaque") : null, o = e.getAttribute("noSubsets"), l = e.getAttribute("fixedWidth"), h = e.getAttribute("fixedHeight"), u = i || {}, c = OpenLayers.Util.extend;
                i = {
                    nestedLayers: [],
                    styles: i ? [].concat(i.styles) : [],
                    srs: i ? c({}, u.srs) : {},
                    metadataURLs: [],
                    bbox: i ? c({}, u.bbox) : {},
                    llbbox: u.llbbox,
                    dimensions: i ? c({}, u.dimensions) : {},
                    authorityURLs: i ? c({}, u.authorityURLs) : {},
                    identifiers: {},
                    keywords: [],
                    queryable: r && "" !== r ? "1" === r || "true" === r : u.queryable || !1,
                    cascaded: null !== a ? parseInt(a) : u.cascaded || 0,
                    opaque: s ? "1" === s || "true" === s : u.opaque || !1,
                    noSubsets: null !== o ? "1" === o || "true" === o : u.noSubsets || !1,
                    fixedWidth: null != l ? parseInt(l) : u.fixedWidth || 0,
                    fixedHeight: null != h ? parseInt(h) : u.fixedHeight || 0,
                    minScale: u.minScale,
                    maxScale: u.maxScale,
                    attribution: u.attribution
                }, t.nestedLayers.push(i), i.capability = n, this.readChildNodes(e, i), delete i.capability, i.name && (r = i.name.split(":"), a = n.request, s = a.getfeatureinfo, 0 < r.length && (i.prefix = r[0]), n.layers.push(i), void 0 === i.formats && (i.formats = a.getmap.formats), void 0 === i.infoFormats && s) && (i.infoFormats = s.formats)
            }, Attribution: function (e, t) {
                t.attribution = {}, this.readChildNodes(e, t.attribution)
            }, LogoURL: function (e, t) {
                t.logo = {
                    width: e.getAttribute("width"),
                    height: e.getAttribute("height")
                }, this.readChildNodes(e, t.logo)
            }, Style: function (e, t) {
                var i = {};
                t.styles.push(i), this.readChildNodes(e, i)
            }, LegendURL: function (e, t) {
                var i = {width: e.getAttribute("width"), height: e.getAttribute("height")};
                t.legend = i, this.readChildNodes(e, i)
            }, MetadataURL: function (e, t) {
                var i = {type: e.getAttribute("type")};
                t.metadataURLs.push(i), this.readChildNodes(e, i)
            }, DataURL: function (e, t) {
                t.dataURL = {}, this.readChildNodes(e, t.dataURL)
            }, FeatureListURL: function (e, t) {
                t.featureListURL = {}, this.readChildNodes(e, t.featureListURL)
            }, AuthorityURL: function (e, t) {
                var i = e.getAttribute("name"), n = {};
                this.readChildNodes(e, n), t.authorityURLs[i] = n.href
            }, Identifier: function (e, t) {
                var i = e.getAttribute("authority");
                t.identifiers[i] = this.getChildValue(e)
            }, KeywordList: function (e, t) {
                this.readChildNodes(e, t)
            }, SRS: function (e, t) {
                t.srs[this.getChildValue(e)] = !0
            }
        }
    }, CLASS_NAME: "OpenLayers.Format.WMSCapabilities.v1"
}),OpenLayers.Format.WMSCapabilities.v1_3 = OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1, {
    readers: {
        wms: OpenLayers.Util.applyDefaults({
            WMS_Capabilities: function (e, t) {
                this.readChildNodes(e, t)
            }, LayerLimit: function (e, t) {
                t.layerLimit = parseInt(this.getChildValue(e))
            }, MaxWidth: function (e, t) {
                t.maxWidth = parseInt(this.getChildValue(e))
            }, MaxHeight: function (e, t) {
                t.maxHeight = parseInt(this.getChildValue(e))
            }, BoundingBox: function (e, t) {
                var i = OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this, [e, t]);
                i.srs = e.getAttribute("CRS"), t.bbox[i.srs] = i
            }, CRS: function (e, t) {
                this.readers.wms.SRS.apply(this, [e, t])
            }, EX_GeographicBoundingBox: function (e, t) {
                t.llbbox = [], this.readChildNodes(e, t.llbbox)
            }, westBoundLongitude: function (e, t) {
                t[0] = this.getChildValue(e)
            }, eastBoundLongitude: function (e, t) {
                t[2] = this.getChildValue(e)
            }, southBoundLatitude: function (e, t) {
                t[1] = this.getChildValue(e)
            }, northBoundLatitude: function (e, t) {
                t[3] = this.getChildValue(e)
            }, MinScaleDenominator: function (e, t) {
                t.maxScale = parseFloat(this.getChildValue(e)).toPrecision(16)
            }, MaxScaleDenominator: function (e, t) {
                t.minScale = parseFloat(this.getChildValue(e)).toPrecision(16)
            }, Dimension: function (e, t) {
                var i = {
                    name: e.getAttribute("name").toLowerCase(),
                    units: e.getAttribute("units"),
                    unitsymbol: e.getAttribute("unitSymbol"),
                    nearestVal: "1" === e.getAttribute("nearestValue"),
                    multipleVal: "1" === e.getAttribute("multipleValues"),
                    "default": e.getAttribute("default") || "",
                    current: "1" === e.getAttribute("current"),
                    values: this.getChildValue(e).split(",")
                };
                t.dimensions[i.name] = i
            }, Keyword: function (e, t) {
                var i = {value: this.getChildValue(e), vocabulary: e.getAttribute("vocabulary")};
                t.keywords && t.keywords.push(i)
            }
        }, OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms), sld: {
            UserDefinedSymbolization: function (e, t) {
                this.readers.wms.UserDefinedSymbolization.apply(this, [e, t]), t.userSymbols.inlineFeature = 1 == parseInt(e.getAttribute("InlineFeature")), t.userSymbols.remoteWCS = 1 == parseInt(e.getAttribute("RemoteWCS"))
            }, DescribeLayer: function (e, t) {
                this.readers.wms.DescribeLayer.apply(this, [e, t])
            }, GetLegendGraphic: function (e, t) {
                this.readers.wms.GetLegendGraphic.apply(this, [e, t])
            }
        }
    }, CLASS_NAME: "OpenLayers.Format.WMSCapabilities.v1_3"
}),OpenLayers.Layer.Zoomify = OpenLayers.Class(OpenLayers.Layer.Grid, {
    size: null,
    isBaseLayer: !0,
    standardTileSize: 256,
    tileOriginCorner: "tl",
    numberOfTiers: 0,
    tileCountUpToTier: null,
    tierSizeInTiles: null,
    tierImageSize: null,
    initialize: function (e, t, i, n) {
        this.initializeZoomify(i), OpenLayers.Layer.Grid.prototype.initialize.apply(this, [e, t, i, {}, n])
    },
    initializeZoomify: function (e) {
        var e = e.clone(), t = new OpenLayers.Size(Math.ceil(e.w / this.standardTileSize), Math.ceil(e.h / this.standardTileSize));
        for (this.tierSizeInTiles = [t], this.tierImageSize = [e]; e.w > this.standardTileSize || e.h > this.standardTileSize;)e = new OpenLayers.Size(Math.floor(e.w / 2), Math.floor(e.h / 2)), t = new OpenLayers.Size(Math.ceil(e.w / this.standardTileSize), Math.ceil(e.h / this.standardTileSize)), this.tierSizeInTiles.push(t), this.tierImageSize.push(e);
        for (this.tierSizeInTiles.reverse(), this.tierImageSize.reverse(), this.numberOfTiers = this.tierSizeInTiles.length, this.tileCountUpToTier = [0], e = 1; e < this.numberOfTiers; e++)this.tileCountUpToTier.push(this.tierSizeInTiles[e - 1].w * this.tierSizeInTiles[e - 1].h + this.tileCountUpToTier[e - 1])
    },
    destroy: function () {
        OpenLayers.Layer.Grid.prototype.destroy.apply(this, arguments), this.tileCountUpToTier.length = 0, this.tierSizeInTiles.length = 0, this.tierImageSize.length = 0
    },
    clone: function (e) {
        return null == e && (e = new OpenLayers.Layer.Zoomify(this.name, this.url, this.size, this.options)), e = OpenLayers.Layer.Grid.prototype.clone.apply(this, [e])
    },
    getURL: function (e) {
        var e = this.adjustBounds(e), t = this.map.getResolution(), i = Math.round((e.left - this.tileOrigin.lon) / (t * this.tileSize.w)), e = Math.round((this.tileOrigin.lat - e.top) / (t * this.tileSize.h)), t = this.map.getZoom(), i = "TileGroup" + Math.floor((i + e * this.tierSizeInTiles[t].w + this.tileCountUpToTier[t]) / 256) + "/" + t + "-" + i + "-" + e + ".jpg", e = this.url;
        return OpenLayers.Util.isArray(e) && (e = this.selectUrl(i, e)), e + i
    },
    getImageSize: function () {
        if (0 < arguments.length) {
            var e = this.adjustBounds(arguments[0]), t = this.map.getResolution(), i = Math.round((e.left - this.tileOrigin.lon) / (t * this.tileSize.w)), e = Math.round((this.tileOrigin.lat - e.top) / (t * this.tileSize.h)), t = this.map.getZoom(), n = this.standardTileSize, s = this.standardTileSize;
            return i == this.tierSizeInTiles[t].w - 1 && (n = this.tierImageSize[t].w % this.standardTileSize), e == this.tierSizeInTiles[t].h - 1 && (s = this.tierImageSize[t].h % this.standardTileSize), new OpenLayers.Size(n, s)
        }
        return this.tileSize
    },
    setMap: function () {
        OpenLayers.Layer.Grid.prototype.setMap.apply(this, arguments), this.tileOrigin = new OpenLayers.LonLat(this.map.maxExtent.left, this.map.maxExtent.top)
    },
    calculateGridLayout: function (e, t, i) {
        var n = i * this.tileSize.w, i = i * this.tileSize.h, s = e.left - t.lon, r = Math.floor(s / n) - this.buffer, e = t.lat - e.top + i, a = Math.floor(e / i) - this.buffer;
        return {
            tilelon: n,
            tilelat: i,
            tileoffsetlon: t.lon + r * n,
            tileoffsetlat: t.lat - i * a,
            tileoffsetx: -(s / n - r) * this.tileSize.w,
            tileoffsety: (a - e / i) * this.tileSize.h
        }
    },
    CLASS_NAME: "OpenLayers.Layer.Zoomify"
}),OpenLayers.Layer.MapServer = OpenLayers.Class(OpenLayers.Layer.Grid, {
    DEFAULT_PARAMS: {
        mode: "map",
        map_imagetype: "png"
    }, initialize: function (e, t, i, n) {
        OpenLayers.Layer.Grid.prototype.initialize.apply(this, arguments), this.params = OpenLayers.Util.applyDefaults(this.params, this.DEFAULT_PARAMS), (null == n || null == n.isBaseLayer) && (this.isBaseLayer = "true" != this.params.transparent && 1 != this.params.transparent)
    }, clone: function (e) {
        return null == e && (e = new OpenLayers.Layer.MapServer(this.name, this.url, this.params, this.getOptions())), e = OpenLayers.Layer.Grid.prototype.clone.apply(this, [e])
    }, getURL: function (e) {
        var e = this.adjustBounds(e), e = [e.left, e.bottom, e.right, e.top], t = this.getImageSize();
        return this.getFullRequestString({
            mapext: e,
            imgext: e,
            map_size: [t.w, t.h],
            imgx: t.w / 2,
            imgy: t.h / 2,
            imgxy: [t.w, t.h]
        })
    }, getFullRequestString: function (e, t) {
        var i = null == t ? this.url : t, n = OpenLayers.Util.extend({}, this.params), n = OpenLayers.Util.extend(n, e), s = OpenLayers.Util.getParameterString(n);
        OpenLayers.Util.isArray(i) && (i = this.selectUrl(s, i));
        var r, s = OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(i));
        for (r in n)r.toUpperCase() in s && delete n[r];
        return s = OpenLayers.Util.getParameterString(n), n = i, s = s.replace(/,/g, "+"), "" != s && (r = i.charAt(i.length - 1), n = "&" == r || "?" == r ? n + s : -1 == i.indexOf("?") ? n + ("?" + s) : n + ("&" + s)), n
    }, CLASS_NAME: "OpenLayers.Layer.MapServer"
}),OpenLayers.Renderer.VML = OpenLayers.Class(OpenLayers.Renderer.Elements, {
    xmlns: "urn:schemas-microsoft-com:vml",
    symbolCache: {},
    offset: null,
    initialize: function () {
        if (this.supported()) {
            if (!document.namespaces.olv) {
                document.namespaces.add("olv", this.xmlns);
                for (var e = document.createStyleSheet(), t = "shape rect oval fill stroke imagedata group textbox".split(" "), i = 0, n = t.length; n > i; i++)e.addRule("olv\\:" + t[i], "behavior: url(#default#VML); position: absolute; display: inline-block;")
            }
            OpenLayers.Renderer.Elements.prototype.initialize.apply(this, arguments)
        }
    },
    supported: function () {
        return !!document.namespaces
    },
    setExtent: function (e, t) {
        var i = OpenLayers.Renderer.Elements.prototype.setExtent.apply(this, arguments), n = this.getResolution(), s = 0 | e.left / n, n = 0 | e.top / n - this.size.h;
        t || !this.offset ? (this.offset = {
            x: s,
            y: n
        }, n = s = 0) : (s -= this.offset.x, n -= this.offset.y), this.root.coordorigin = s - this.xOffset + " " + n;
        for (var s = [this.root, this.vectorRoot, this.textRoot], r = 0, a = s.length; a > r; ++r)n = s[r], n.coordsize = this.size.w + " " + this.size.h;
        return this.root.style.flip = "y", i
    },
    setSize: function () {
        OpenLayers.Renderer.prototype.setSize.apply(this, arguments);
        for (var e, t = [this.rendererRoot, this.root, this.vectorRoot, this.textRoot], i = this.size.w + "px", n = this.size.h + "px", s = 0, r = t.length; r > s; ++s)e = t[s], e.style.width = i, e.style.height = n
    },
    getNodeType: function (e, t) {
        var i = null;
        switch (e.CLASS_NAME) {
            case"OpenLayers.Geometry.Point":
                i = t.externalGraphic ? "olv:rect" : this.isComplexSymbol(t.graphicName) ? "olv:shape" : "olv:oval";
                break;
            case"OpenLayers.Geometry.Rectangle":
                i = "olv:rect";
                break;
            case"OpenLayers.Geometry.LineString":
            case"OpenLayers.Geometry.LinearRing":
            case"OpenLayers.Geometry.Polygon":
            case"OpenLayers.Geometry.Curve":
                i = "olv:shape"
        }
        return i
    },
    setStyle: function (e, t, i, n) {
        var t = t || e._style, i = i || e._options, s = t.fillColor;
        if ("OpenLayers.Geometry.Point" === e._geometryClass)if (t.externalGraphic) {
            i.isFilled = !0, t.graphicTitle && (e.title = t.graphicTitle);
            var s = t.graphicWidth || t.graphicHeight, r = t.graphicHeight || t.graphicWidth, s = s ? s : 2 * t.pointRadius, r = r ? r : 2 * t.pointRadius, a = this.getResolution(), o = void 0 != t.graphicXOffset ? t.graphicXOffset : -(.5 * s), l = void 0 != t.graphicYOffset ? t.graphicYOffset : -(.5 * r);
            e.style.left = (0 | (n.x - this.featureDx) / a - this.offset.x + o) + "px", e.style.top = (0 | n.y / a - this.offset.y - (l + r)) + "px", e.style.width = s + "px", e.style.height = r + "px", e.style.flip = "y", s = "none", i.isStroked = !1
        } else this.isComplexSymbol(t.graphicName) ? (r = this.importSymbol(t.graphicName), e.path = r.path, e.coordorigin = r.left + "," + r.bottom, r = r.size, e.coordsize = r + "," + r, this.drawCircle(e, n, t.pointRadius), e.style.flip = "y") : this.drawCircle(e, n, t.pointRadius);
        return i.isFilled ? e.fillcolor = s : e.filled = "false", n = e.getElementsByTagName("fill"), n = 0 == n.length ? null : n[0], i.isFilled ? (n || (n = this.createNode("olv:fill", e.id + "_fill")), n.opacity = t.fillOpacity, "OpenLayers.Geometry.Point" !== e._geometryClass || !t.externalGraphic || (t.graphicOpacity && (n.opacity = t.graphicOpacity), n.src = t.externalGraphic, n.type = "frame", t.graphicWidth && t.graphicHeight) || (n.aspect = "atmost"), n.parentNode != e && e.appendChild(n)) : n && e.removeChild(n), s = t.rotation, (void 0 !== s || void 0 !== e._rotation) && (e._rotation = s, t.externalGraphic ? (this.graphicRotate(e, o, l, t), n.opacity = 0) : "OpenLayers.Geometry.Point" === e._geometryClass && (e.style.rotation = s || 0)), o = e.getElementsByTagName("stroke"), o = 0 == o.length ? null : o[0], i.isStroked ? (o || (o = this.createNode("olv:stroke", e.id + "_stroke"), e.appendChild(o)), o.on = !0, o.color = t.strokeColor, o.weight = t.strokeWidth + "px", o.opacity = t.strokeOpacity, o.endcap = "butt" == t.strokeLinecap ? "flat" : t.strokeLinecap || "round", t.strokeDashstyle && (o.dashstyle = this.dashStyle(t))) : (e.stroked = !1, o && (o.on = !1)), "inherit" != t.cursor && null != t.cursor && (e.style.cursor = t.cursor), e
    },
    graphicRotate: function (e, t, i, n) {
        var s, r, n = n || e._style, a = n.rotation || 0;
        if (n.graphicWidth && n.graphicHeight) {
            r = Math.max(n.graphicWidth, n.graphicHeight), s = n.graphicWidth / n.graphicHeight;
            var o = Math.round(n.graphicWidth || r * s), l = Math.round(n.graphicHeight || r);
            e.style.width = o + "px", e.style.height = l + "px";
            var h = document.getElementById(e.id + "_image");
            h || (h = this.createNode("olv:imagedata", e.id + "_image"), e.appendChild(h)), h.style.width = o + "px", h.style.height = l + "px", h.src = n.externalGraphic, h.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')", h = a * Math.PI / 180, a = Math.sin(h), h = Math.cos(h), a = "progid:DXImageTransform.Microsoft.Matrix(M11=" + h + ",M12=" + -a + ",M21=" + a + ",M22=" + h + ",SizingMethod='auto expand')\n", (h = n.graphicOpacity || n.fillOpacity) && 1 != h && (a += "progid:DXImageTransform.Microsoft.BasicImage(opacity=" + h + ")\n"), e.style.filter = a, a = new OpenLayers.Geometry.Point(-t, -i), o = new OpenLayers.Bounds(0, 0, o, l).toGeometry(), o.rotate(n.rotation, a), o = o.getBounds(), e.style.left = Math.round(parseInt(e.style.left) + o.left) + "px", e.style.top = Math.round(parseInt(e.style.top) - o.bottom) + "px"
        } else {
            var u = new Image;
            u.onreadystatechange = OpenLayers.Function.bind(function () {
                ("complete" == u.readyState || "interactive" == u.readyState) && (s = u.width / u.height, r = Math.max(2 * n.pointRadius, n.graphicWidth || 0, n.graphicHeight || 0), t *= s, n.graphicWidth = r * s, n.graphicHeight = r, this.graphicRotate(e, t, i, n))
            }, this), u.src = n.externalGraphic
        }
    },
    postDraw: function (e) {
        e.style.visibility = "visible";
        var t = e._style.fillColor, i = e._style.strokeColor;
        "none" == t && e.fillcolor != t && (e.fillcolor = t), "none" == i && e.strokecolor != i && (e.strokecolor = i)
    },
    setNodeDimension: function (e, t) {
        var i = t.getBounds();
        if (i) {
            var n = this.getResolution(), i = new OpenLayers.Bounds(0 | (i.left - this.featureDx) / n - this.offset.x, 0 | i.bottom / n - this.offset.y, 0 | (i.right - this.featureDx) / n - this.offset.x, 0 | i.top / n - this.offset.y);
            e.style.left = i.left + "px", e.style.top = i.top + "px", e.style.width = i.getWidth() + "px", e.style.height = i.getHeight() + "px", e.coordorigin = i.left + " " + i.top, e.coordsize = i.getWidth() + " " + i.getHeight()
        }
    },
    dashStyle: function (e) {
        switch (e = e.strokeDashstyle) {
            case"solid":
            case"dot":
            case"dash":
            case"dashdot":
            case"longdash":
            case"longdashdot":
                return e;
            default:
                return e = e.split(/[ ,]/), 2 == e.length ? 1 * e[0] >= 2 * e[1] ? "longdash" : 1 == e[0] || 1 == e[1] ? "dot" : "dash" : 4 == e.length ? 1 * e[0] >= 2 * e[1] ? "longdashdot" : "dashdot" : "solid"
        }
    },
    createNode: function (e, t) {
        var i = document.createElement(e);
        return t && (i.id = t), i.unselectable = "on", i.onselectstart = OpenLayers.Function.False, i
    },
    nodeTypeCompare: function (e, t) {
        var i = t, n = i.indexOf(":");
        -1 != n && (i = i.substr(n + 1));
        var s = e.nodeName, n = s.indexOf(":");
        return -1 != n && (s = s.substr(n + 1)), i == s
    },
    createRenderRoot: function () {
        return this.nodeFactory(this.container.id + "_vmlRoot", "div")
    },
    createRoot: function (e) {
        return this.nodeFactory(this.container.id + e, "olv:group")
    },
    drawPoint: function (e, t) {
        return this.drawCircle(e, t, 1)
    },
    drawCircle: function (e, t, i) {
        if (!isNaN(t.x) && !isNaN(t.y)) {
            var n = this.getResolution();
            return e.style.left = (0 | (t.x - this.featureDx) / n - this.offset.x) - i + "px", e.style.top = (0 | t.y / n - this.offset.y) - i + "px", t = 2 * i, e.style.width = t + "px", e.style.height = t + "px", e
        }
        return !1
    },
    drawLineString: function (e, t) {
        return this.drawLine(e, t, !1)
    },
    drawLinearRing: function (e, t) {
        return this.drawLine(e, t, !0)
    },
    drawLine: function (e, t, i) {
        this.setNodeDimension(e, t);
        for (var n, s, r = this.getResolution(), a = t.components.length, o = Array(a), l = 0; a > l; l++)n = t.components[l], s = 0 | (n.x - this.featureDx) / r - this.offset.x, n = 0 | n.y / r - this.offset.y, o[l] = " " + s + "," + n + " l ";
        return e.path = "m" + o.join("") + (i ? " x e" : " e"), e
    },
    drawPolygon: function (e, t) {
        this.setNodeDimension(e, t);
        var i, n, s, r, a, o, l, h, u, c, p = this.getResolution(), d = [];
        for (i = 0, n = t.components.length; n > i; i++) {
            for (d.push("m"), s = t.components[i].components, r = 0 === i, o = a = null, l = 0, h = s.length; h > l; l++)u = s[l], c = 0 | (u.x - this.featureDx) / p - this.offset.x, u = 0 | u.y / p - this.offset.y, c = " " + c + "," + u, d.push(c), 0 == l && d.push(" l"), r || (a ? a != c && (o ? o != c && (r = !0) : o = c) : a = c);
            d.push(r ? " x " : " ")
        }
        return d.push("e"), e.path = d.join(""), e
    },
    drawRectangle: function (e, t) {
        var i = this.getResolution();
        return e.style.left = (0 | (t.x - this.featureDx) / i - this.offset.x) + "px", e.style.top = (0 | t.y / i - this.offset.y) + "px", e.style.width = (0 | t.width / i) + "px", e.style.height = (0 | t.height / i) + "px", e
    },
    drawText: function (e, t, i) {
        var n = this.nodeFactory(e + this.LABEL_ID_SUFFIX, "olv:rect"), s = this.nodeFactory(e + this.LABEL_ID_SUFFIX + "_textbox", "olv:textbox"), r = this.getResolution();
        n.style.left = (0 | (i.x - this.featureDx) / r - this.offset.x) + "px", n.style.top = (0 | i.y / r - this.offset.y) + "px", n.style.flip = "y", s.innerText = t.label, "inherit" != t.cursor && null != t.cursor && (s.style.cursor = t.cursor), t.fontColor && (s.style.color = t.fontColor), t.fontOpacity && (s.style.filter = "alpha(opacity=" + 100 * t.fontOpacity + ")"), t.fontFamily && (s.style.fontFamily = t.fontFamily), t.fontSize && (s.style.fontSize = t.fontSize), t.fontWeight && (s.style.fontWeight = t.fontWeight), t.fontStyle && (s.style.fontStyle = t.fontStyle), !0 === t.labelSelect && (n._featureId = e, s._featureId = e, s._geometry = i, s._geometryClass = i.CLASS_NAME), s.style.whiteSpace = "nowrap", s.inset = "1px,0px,0px,0px", n.parentNode || (n.appendChild(s), this.textRoot.appendChild(n)), t = t.labelAlign || "cm", 1 == t.length && (t += "m"), e = s.clientWidth * OpenLayers.Renderer.VML.LABEL_SHIFT[t.substr(0, 1)], s = s.clientHeight * OpenLayers.Renderer.VML.LABEL_SHIFT[t.substr(1, 1)], n.style.left = parseInt(n.style.left) - e - 1 + "px", n.style.top = parseInt(n.style.top) + s + "px"
    },
    moveRoot: function (e) {
        var t = this.map.getLayer(e.container.id);
        t instanceof OpenLayers.Layer.Vector.RootContainer && (t = this.map.getLayer(this.container.id)), t && t.renderer.clear(), OpenLayers.Renderer.Elements.prototype.moveRoot.apply(this, arguments), t && t.redraw()
    },
    importSymbol: function (e) {
        var t = this.container.id + "-" + e, i = this.symbolCache[t];
        if (i)return i;
        if (i = OpenLayers.Renderer.symbol[e], !i)throw Error(e + " is not a valid symbol name");
        for (var e = new OpenLayers.Bounds(Number.MAX_VALUE, Number.MAX_VALUE, 0, 0), n = ["m"], s = 0; s < i.length; s += 2) {
            var r = i[s], a = i[s + 1];
            e.left = Math.min(e.left, r), e.bottom = Math.min(e.bottom, a), e.right = Math.max(e.right, r), e.top = Math.max(e.top, a), n.push(r), n.push(a), 0 == s && n.push("l")
        }
        return n.push("x e"), i = n.join(" "), n = (e.getWidth() - e.getHeight()) / 2, n > 0 ? (e.bottom -= n, e.top += n) : (e.left += n, e.right -= n), i = {
            path: i,
            size: e.getWidth(),
            left: e.left,
            bottom: e.bottom
        }, this.symbolCache[t] = i
    },
    CLASS_NAME: "OpenLayers.Renderer.VML"
}),OpenLayers.Renderer.VML.LABEL_SHIFT = {
    l: 0,
    c: .5,
    r: 1,
    t: 0,
    m: .5,
    b: 1
},OpenLayers.Control.CacheRead = OpenLayers.Class(OpenLayers.Control, {
    fetchEvent: "tileloadstart",
    layers: null,
    autoActivate: !0,
    setMap: function (e) {
        OpenLayers.Control.prototype.setMap.apply(this, arguments);
        var t, i = this.layers || e.layers;
        for (t = i.length - 1; t >= 0; --t)this.addLayer({layer: i[t]});
        this.layers || e.events.on({addlayer: this.addLayer, removeLayer: this.removeLayer, scope: this})
    },
    addLayer: function (e) {
        e.layer.events.register(this.fetchEvent, this, this.fetch)
    },
    removeLayer: function (e) {
        e.layer.events.unregister(this.fetchEvent, this, this.fetch)
    },
    fetch: function (e) {
        if (this.active && window.localStorage && e.tile instanceof OpenLayers.Tile.Image) {
            var t = e.tile, i = t.url;
            !t.layer.crossOriginKeyword && OpenLayers.ProxyHost && 0 === i.indexOf(OpenLayers.ProxyHost) && (i = OpenLayers.Control.CacheWrite.urlMap[i]), (i = window.localStorage.getItem("olCache_" + i)) && (t.url = i, "tileerror" === e.type && t.setImgSrc(i))
        }
    },
    destroy: function () {
        if (this.layers || this.map) {
            var e, t = this.layers || this.map.layers;
            for (e = t.length - 1; e >= 0; --e)this.removeLayer({layer: t[e]})
        }
        this.map && this.map.events.un({
            addlayer: this.addLayer,
            removeLayer: this.removeLayer,
            scope: this
        }), OpenLayers.Control.prototype.destroy.apply(this, arguments)
    },
    CLASS_NAME: "OpenLayers.Control.CacheRead"
}),OpenLayers.Protocol.WFS.v1_0_0 = OpenLayers.Class(OpenLayers.Protocol.WFS.v1, {
    version: "1.0.0",
    CLASS_NAME: "OpenLayers.Protocol.WFS.v1_0_0"
}),OpenLayers.Format.WMSGetFeatureInfo = OpenLayers.Class(OpenLayers.Format.XML, {
    layerIdentifier: "_layer",
    featureIdentifier: "_feature",
    regExes: {trimSpace: /^\s*|\s*$/g, removeSpace: /\s*/g, splitSpace: /\s+/, trimComma: /\s*,\s*/g},
    gmlFormat: null,
    read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e]));
        var t = e.documentElement;
        if (t)var i = this["read_" + t.nodeName], e = i ? i.call(this, t) : new OpenLayers.Format.GML(this.options ? this.options : {}).read(e);
        return e
    },
    read_msGMLOutput: function (e) {
        var t = [];
        if (e = this.getSiblingNodesByTagCriteria(e, this.layerIdentifier))for (var i = 0, n = e.length; n > i; ++i) {
            var s = e[i], r = s.nodeName;
            if (s.prefix && (r = r.split(":")[1]), r = r.replace(this.layerIdentifier, ""), s = this.getSiblingNodesByTagCriteria(s, this.featureIdentifier))for (var a = 0; a < s.length; a++) {
                var o = s[a], l = this.parseGeometry(o), o = this.parseAttributes(o), o = new OpenLayers.Feature.Vector(l.geometry, o, null);
                o.bounds = l.bounds, o.type = r, t.push(o)
            }
        }
        return t
    },
    read_FeatureInfoResponse: function (e) {
        for (var t = [], e = this.getElementsByTagNameNS(e, "*", "FIELDS"), i = 0, n = e.length; n > i; i++) {
            var s, r = e[i], a = {}, o = r.attributes.length;
            if (o > 0)for (s = 0; o > s; s++) {
                var l = r.attributes[s];
                a[l.nodeName] = l.nodeValue
            } else for (r = r.childNodes, s = 0, o = r.length; o > s; ++s)l = r[s], 3 != l.nodeType && (a[l.getAttribute("name")] = l.getAttribute("value"));
            t.push(new OpenLayers.Feature.Vector(null, a, null))
        }
        return t
    },
    getSiblingNodesByTagCriteria: function (e, t) {
        var i, n, s, r, a = [];
        if (e && e.hasChildNodes()) {
            i = e.childNodes, s = i.length;
            for (var o = 0; s > o; o++) {
                for (r = i[o]; r && 1 != r.nodeType;)r = r.nextSibling, o++;
                n = r ? r.nodeName : "", 0 < n.length && -1 < n.indexOf(t) ? a.push(r) : (n = this.getSiblingNodesByTagCriteria(r, t), 0 < n.length && (0 == a.length ? a = n : a.push(n)))
            }
        }
        return a
    },
    parseAttributes: function (e) {
        var t = {};
        if (1 == e.nodeType)for (var e = e.childNodes, i = e.length, n = 0; i > n; ++n) {
            var s = e[n];
            if (1 == s.nodeType) {
                var r = s.childNodes, s = s.prefix ? s.nodeName.split(":")[1] : s.nodeName;
                0 == r.length ? t[s] = null : 1 == r.length && (r = r[0], 3 == r.nodeType || 4 == r.nodeType) && (r = r.nodeValue.replace(this.regExes.trimSpace, ""), t[s] = r)
            }
        }
        return t
    },
    parseGeometry: function (e) {
        this.gmlFormat || (this.gmlFormat = new OpenLayers.Format.GML);
        var t, e = this.gmlFormat.parseFeature(e), i = null;
        return e && (t = e.geometry && e.geometry.clone(), i = e.bounds && e.bounds.clone(), e.destroy()), {
            geometry: t,
            bounds: i
        }
    },
    CLASS_NAME: "OpenLayers.Format.WMSGetFeatureInfo"
}),OpenLayers.Control.WMTSGetFeatureInfo = OpenLayers.Class(OpenLayers.Control, {
    hover: !1,
    requestEncoding: "KVP",
    drillDown: !1,
    maxFeatures: 10,
    clickCallback: "click",
    layers: null,
    queryVisible: !0,
    infoFormat: "text/html",
    vendorParams: {},
    format: null,
    formatOptions: null,
    handlerOptions: null,
    handler: null,
    hoverRequest: null,
    pending: 0,
    initialize: function (e) {
        e = e || {}, e.handlerOptions = e.handlerOptions || {}, OpenLayers.Control.prototype.initialize.apply(this, [e]), this.format || (this.format = new OpenLayers.Format.WMSGetFeatureInfo(e.formatOptions)), !0 === this.drillDown && (this.hover = !1), this.hover ? this.handler = new OpenLayers.Handler.Hover(this, {
            move: this.cancelHover,
            pause: this.getInfoForHover
        }, OpenLayers.Util.extend(this.handlerOptions.hover || {}, {delay: 250})) : (e = {}, e[this.clickCallback] = this.getInfoForClick, this.handler = new OpenLayers.Handler.Click(this, e, this.handlerOptions.click || {}))
    },
    getInfoForClick: function (e) {
        this.request(e.xy, {})
    },
    getInfoForHover: function (e) {
        this.request(e.xy, {hover: !0})
    },
    cancelHover: function () {
        this.hoverRequest && (--this.pending, 0 >= this.pending && (OpenLayers.Element.removeClass(this.map.viewPortDiv, "olCursorWait"), this.pending = 0), this.hoverRequest.abort(), this.hoverRequest = null)
    },
    findLayers: function () {
        for (var e, t = this.layers || this.map.layers, i = [], n = t.length - 1; n >= 0 && (e = t[n], !(e instanceof OpenLayers.Layer.WMTS && e.requestEncoding === this.requestEncoding) || this.queryVisible && !e.getVisibility() || (i.push(e), this.drillDown && !this.hover)); --n);
        return i
    },
    buildRequestOptions: function (e, t) {
        var i = this.map.getLonLatFromPixel(t), n = e.getURL(new OpenLayers.Bounds(i.lon, i.lat, i.lon, i.lat)), n = OpenLayers.Util.getParameters(n), i = e.getTileInfo(i);
        return OpenLayers.Util.extend(n, {
            service: "WMTS",
            version: e.version,
            request: "GetFeatureInfo",
            infoFormat: this.infoFormat,
            i: i.i,
            j: i.j
        }), OpenLayers.Util.applyDefaults(n, this.vendorParams), {
            url: OpenLayers.Util.isArray(e.url) ? e.url[0] : e.url,
            params: OpenLayers.Util.upperCaseObject(n),
            callback: function (i) {
                this.handleResponse(t, i, e)
            },
            scope: this
        }
    },
    request: function (e, t) {
        var t = t || {}, i = this.findLayers();
        if (0 < i.length) {
            for (var n, s, r = 0, a = i.length; a > r; r++)s = i[r], n = this.events.triggerEvent("beforegetfeatureinfo", {
                xy: e,
                layer: s
            }), !1 !== n && (++this.pending, n = this.buildRequestOptions(s, e), n = OpenLayers.Request.GET(n), !0 === t.hover && (this.hoverRequest = n));
            0 < this.pending && OpenLayers.Element.addClass(this.map.viewPortDiv, "olCursorWait")
        }
    },
    handleResponse: function (e, t, i) {
        if (--this.pending, 0 >= this.pending && (OpenLayers.Element.removeClass(this.map.viewPortDiv, "olCursorWait"), this.pending = 0), t.status && (200 > t.status || 300 <= t.status)) this.events.triggerEvent("exception", {
            xy: e,
            request: t,
            layer: i
        }); else {
            var n = t.responseXML;
            n && n.documentElement || (n = t.responseText);
            var s, r;
            try {
                s = this.format.read(n)
            } catch (a) {
                r = !0, this.events.triggerEvent("exception", {xy: e, request: t, error: a, layer: i})
            }
            r || this.events.triggerEvent("getfeatureinfo", {
                text: t.responseText,
                features: s,
                request: t,
                xy: e,
                layer: i
            })
        }
    },
    CLASS_NAME: "OpenLayers.Control.WMTSGetFeatureInfo"
}),OpenLayers.Strategy.Paging = OpenLayers.Class(OpenLayers.Strategy, {
    features: null, length: 10, num: null, paging: !1, activate: function () {
        var e = OpenLayers.Strategy.prototype.activate.call(this);
        return e && this.layer.events.on({beforefeaturesadded: this.cacheFeatures, scope: this}), e
    }, deactivate: function () {
        var e = OpenLayers.Strategy.prototype.deactivate.call(this);
        return e && (this.clearCache(), this.layer.events.un({beforefeaturesadded: this.cacheFeatures, scope: this})), e
    }, cacheFeatures: function (e) {
        this.paging || (this.clearCache(), this.features = e.features, this.pageNext(e))
    }, clearCache: function () {
        if (this.features)for (var e = 0; e < this.features.length; ++e)this.features[e].destroy();
        this.num = this.features = null
    }, pageCount: function () {
        return Math.ceil((this.features ? this.features.length : 0) / this.length)
    }, pageNum: function () {
        return this.num
    }, pageLength: function (e) {
        return e && e > 0 && (this.length = e), this.length
    }, pageNext: function (e) {
        var t = !1;
        return this.features && (null === this.num && (this.num = -1), t = this.page((this.num + 1) * this.length, e)), t
    }, pagePrevious: function () {
        var e = !1;
        return this.features && (null === this.num && (this.num = this.pageCount()), e = this.page((this.num - 1) * this.length)), e
    }, page: function (e, t) {
        var i = !1;
        if (this.features && e >= 0 && e < this.features.length) {
            var n = Math.floor(e / this.length);
            n != this.num && (this.paging = !0, i = this.features.slice(e, e + this.length), this.layer.removeFeatures(this.layer.features), this.num = n, t && t.features ? t.features = i : this.layer.addFeatures(i), this.paging = !1, i = !0)
        }
        return i
    }, CLASS_NAME: "OpenLayers.Strategy.Paging"
}),OpenLayers.Protocol.CSW.v2_0_2 = OpenLayers.Class(OpenLayers.Protocol, {
    formatOptions: null,
    initialize: function (e) {
        OpenLayers.Protocol.prototype.initialize.apply(this, [e]), e.format || (this.format = new OpenLayers.Format.CSWGetRecords.v2_0_2(OpenLayers.Util.extend({}, this.formatOptions)))
    },
    destroy: function () {
        this.options && !this.options.format && this.format.destroy(), this.format = null, OpenLayers.Protocol.prototype.destroy.apply(this)
    },
    read: function (e) {
        e = OpenLayers.Util.extend({}, e), OpenLayers.Util.applyDefaults(e, this.options || {});
        var t = new OpenLayers.Protocol.Response({requestType: "read"}), i = this.format.write(e.params);
        return t.priv = OpenLayers.Request.POST({
            url: e.url,
            callback: this.createCallback(this.handleRead, t, e),
            params: e.params,
            headers: e.headers,
            data: i
        }), t
    },
    handleRead: function (e, t) {
        if (t.callback) {
            var i = e.priv;
            200 <= i.status && 300 > i.status ? (e.data = this.parseData(i), e.code = OpenLayers.Protocol.Response.SUCCESS) : e.code = OpenLayers.Protocol.Response.FAILURE, t.callback.call(t.scope, e)
        }
    },
    parseData: function (e) {
        var t = e.responseXML;
        return t && t.documentElement || (t = e.responseText), !t || 0 >= t.length ? null : this.format.read(t)
    },
    CLASS_NAME: "OpenLayers.Protocol.CSW.v2_0_2"
}),OpenLayers.Format.WMSCapabilities.v1_1 = OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1, {
    readers: {
        wms: OpenLayers.Util.applyDefaults({
            WMT_MS_Capabilities: function (e, t) {
                this.readChildNodes(e, t)
            }, Keyword: function (e, t) {
                t.keywords && t.keywords.push(this.getChildValue(e))
            }, DescribeLayer: function (e, t) {
                t.describelayer = {formats: []}, this.readChildNodes(e, t.describelayer)
            }, GetLegendGraphic: function (e, t) {
                t.getlegendgraphic = {formats: []}, this.readChildNodes(e, t.getlegendgraphic)
            }, GetStyles: function (e, t) {
                t.getstyles = {formats: []}, this.readChildNodes(e, t.getstyles)
            }, PutStyles: function (e, t) {
                t.putstyles = {formats: []}, this.readChildNodes(e, t.putstyles)
            }, UserDefinedSymbolization: function (e, t) {
                var i = {
                    supportSLD: 1 == parseInt(e.getAttribute("SupportSLD")),
                    userLayer: 1 == parseInt(e.getAttribute("UserLayer")),
                    userStyle: 1 == parseInt(e.getAttribute("UserStyle")),
                    remoteWFS: 1 == parseInt(e.getAttribute("RemoteWFS"))
                };
                t.userSymbols = i
            }, LatLonBoundingBox: function (e, t) {
                t.llbbox = [parseFloat(e.getAttribute("minx")), parseFloat(e.getAttribute("miny")), parseFloat(e.getAttribute("maxx")), parseFloat(e.getAttribute("maxy"))]
            }, BoundingBox: function (e, t) {
                var i = OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this, [e, t]);
                i.srs = e.getAttribute("SRS"), t.bbox[i.srs] = i
            }, ScaleHint: function (e, t) {
                var i = e.getAttribute("min"), n = e.getAttribute("max"), s = Math.pow(2, .5), r = OpenLayers.INCHES_PER_UNIT.m;
                t.maxScale = parseFloat((i / s * r * OpenLayers.DOTS_PER_INCH).toPrecision(13)), t.minScale = parseFloat((n / s * r * OpenLayers.DOTS_PER_INCH).toPrecision(13))
            }, Dimension: function (e, t) {
                var i = {
                    name: e.getAttribute("name").toLowerCase(),
                    units: e.getAttribute("units"),
                    unitsymbol: e.getAttribute("unitSymbol")
                };
                t.dimensions[i.name] = i
            }, Extent: function (e, t) {
                var i = e.getAttribute("name").toLowerCase();
                if (i in t.dimensions) {
                    i = t.dimensions[i], i.nearestVal = "1" === e.getAttribute("nearestValue"), i.multipleVal = "1" === e.getAttribute("multipleValues"), i.current = "1" === e.getAttribute("current"), i["default"] = e.getAttribute("default") || "";
                    var n = this.getChildValue(e);
                    i.values = n.split(",")
                }
            }
        }, OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms)
    }, CLASS_NAME: "OpenLayers.Format.WMSCapabilities.v1_1"
}),OpenLayers.Control.Graticule = OpenLayers.Class(OpenLayers.Control, {
    autoActivate: !0,
    intervals: [45, 30, 20, 10, 5, 2, 1, .5, .2, .1, .05, .01, .005, .002, .001],
    displayInLayerSwitcher: !0,
    visible: !0,
    numPoints: 50,
    targetSize: 200,
    layerName: null,
    labelled: !0,
    labelFormat: "dm",
    lineSymbolizer: {strokeColor: "#333", strokeWidth: 1, strokeOpacity: .5},
    labelSymbolizer: {},
    gratLayer: null,
    initialize: function (e) {
        e = e || {}, e.layerName = e.layerName || OpenLayers.i18n("Graticule"), OpenLayers.Control.prototype.initialize.apply(this, [e]), this.labelSymbolizer.stroke = !1, this.labelSymbolizer.fill = !1, this.labelSymbolizer.label = "${label}", this.labelSymbolizer.labelAlign = "${labelAlign}", this.labelSymbolizer.labelXOffset = "${xOffset}", this.labelSymbolizer.labelYOffset = "${yOffset}"
    },
    destroy: function () {
        this.deactivate(), OpenLayers.Control.prototype.destroy.apply(this, arguments), this.gratLayer && (this.gratLayer.destroy(), this.gratLayer = null)
    },
    draw: function () {
        if (OpenLayers.Control.prototype.draw.apply(this, arguments), !this.gratLayer) {
            var e = new OpenLayers.Style({}, {
                rules: [new OpenLayers.Rule({
                    symbolizer: {
                        Point: this.labelSymbolizer,
                        Line: this.lineSymbolizer
                    }
                })]
            });
            this.gratLayer = new OpenLayers.Layer.Vector(this.layerName, {
                styleMap: new OpenLayers.StyleMap({"default": e}),
                visibility: this.visible,
                displayInLayerSwitcher: this.displayInLayerSwitcher
            })
        }
        return this.div
    },
    activate: function () {
        return OpenLayers.Control.prototype.activate.apply(this, arguments) ? (this.map.addLayer(this.gratLayer), this.map.events.register("moveend", this, this.update), this.update(), !0) : !1
    },
    deactivate: function () {
        return OpenLayers.Control.prototype.deactivate.apply(this, arguments) ? (this.map.events.unregister("moveend", this, this.update), this.map.removeLayer(this.gratLayer), !0) : !1
    },
    update: function () {
        var e = this.map.getExtent();
        if (e) {
            this.gratLayer.destroyFeatures();
            var t = new OpenLayers.Projection("EPSG:4326"), i = this.map.getProjectionObject(), n = this.map.getResolution();
            i.proj && "longlat" == i.proj.projName && (this.numPoints = 1);
            var s = this.map.getCenter(), r = new OpenLayers.Pixel(s.lon, s.lat);
            OpenLayers.Projection.transform(r, i, t);
            for (var a, s = this.targetSize * n, s = s * s, n = 0; n < this.intervals.length; ++n) {
                a = this.intervals[n];
                var o = a / 2, l = r.offset({x: -o, y: -o}), o = r.offset({x: o, y: o});
                if (OpenLayers.Projection.transform(l, t, i), OpenLayers.Projection.transform(o, t, i), (l.x - o.x) * (l.x - o.x) + (l.y - o.y) * (l.y - o.y) <= s)break
            }
            r.x = Math.floor(r.x / a) * a, r.y = Math.floor(r.y / a) * a;
            var h, n = 0, s = [r.clone()], o = r.clone();
            do o = o.offset({
                x: 0,
                y: a
            }), h = OpenLayers.Projection.transform(o.clone(), t, i), s.unshift(o); while (e.containsPixel(h) && 1e3 > ++n);
            o = r.clone();
            do o = o.offset({
                x: 0,
                y: -a
            }), h = OpenLayers.Projection.transform(o.clone(), t, i), s.push(o); while (e.containsPixel(h) && 1e3 > ++n);
            n = 0, l = [r.clone()], o = r.clone();
            do o = o.offset({
                x: -a,
                y: 0
            }), h = OpenLayers.Projection.transform(o.clone(), t, i), l.unshift(o); while (e.containsPixel(h) && 1e3 > ++n);
            o = r.clone();
            do o = o.offset({
                x: a,
                y: 0
            }), h = OpenLayers.Projection.transform(o.clone(), t, i), l.push(o); while (e.containsPixel(h) && 1e3 > ++n);
            for (a = [], n = 0; n < l.length; ++n) {
                h = l[n].x;
                for (var r = [], u = null, c = Math.min(s[0].y, 90), o = Math.max(s[s.length - 1].y, -90), p = (c - o) / this.numPoints, c = o, o = 0; o <= this.numPoints; ++o) {
                    var d = new OpenLayers.Geometry.Point(h, c);
                    d.transform(t, i), r.push(d), c += p, d.y >= e.bottom && !u && (u = d)
                }
                this.labelled && (u = new OpenLayers.Geometry.Point(u.x, e.bottom), h = {
                    value: h,
                    label: this.labelled ? OpenLayers.Util.getFormattedLonLat(h, "lon", this.labelFormat) : "",
                    labelAlign: "cb",
                    xOffset: 0,
                    yOffset: 2
                }, this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(u, h))), r = new OpenLayers.Geometry.LineString(r), a.push(new OpenLayers.Feature.Vector(r))
            }
            for (o = 0; o < s.length; ++o)if (c = s[o].y, !(-90 > c || c > 90)) {
                for (r = [], n = l[0].x, p = (l[l.length - 1].x - n) / this.numPoints, h = n, u = null, n = 0; n <= this.numPoints; ++n)d = new OpenLayers.Geometry.Point(h, c), d.transform(t, i), r.push(d), h += p, d.x < e.right && (u = d);
                this.labelled && (u = new OpenLayers.Geometry.Point(e.right, u.y), h = {
                    value: c,
                    label: this.labelled ? OpenLayers.Util.getFormattedLonLat(c, "lat", this.labelFormat) : "",
                    labelAlign: "rb",
                    xOffset: -2,
                    yOffset: 2
                }, this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(u, h))), r = new OpenLayers.Geometry.LineString(r), a.push(new OpenLayers.Feature.Vector(r))
            }
            this.gratLayer.addFeatures(a)
        }
    },
    CLASS_NAME: "OpenLayers.Control.Graticule"
}),OpenLayers.Layer.UTFGrid = OpenLayers.Class(OpenLayers.Layer.XYZ, {
    isBaseLayer: !1,
    projection: new OpenLayers.Projection("EPSG:900913"),
    useJSONP: !1,
    tileClass: OpenLayers.Tile.UTFGrid,
    initialize: function (e) {
        OpenLayers.Layer.Grid.prototype.initialize.apply(this, [e.name, e.url, {}, e]), this.tileOptions = OpenLayers.Util.extend({utfgridResolution: this.utfgridResolution}, this.tileOptions)
    },
    clone: function (e) {
        return null == e && (e = new OpenLayers.Layer.UTFGrid(this.getOptions())), e = OpenLayers.Layer.Grid.prototype.clone.apply(this, [e])
    },
    getFeatureInfo: function (e) {
        var t = null, e = this.getTileData(e);
        return e.tile && (t = e.tile.getFeatureInfo(e.i, e.j)), t
    },
    getFeatureId: function (e) {
        var t = null, e = this.getTileData(e);
        return e.tile && (t = e.tile.getFeatureId(e.i, e.j)), t
    },
    CLASS_NAME: "OpenLayers.Layer.UTFGrid"
}),OpenLayers.Layer.ArcGISCache = OpenLayers.Class(OpenLayers.Layer.XYZ, {
    url: null,
    tileOrigin: null,
    tileSize: new OpenLayers.Size(256, 256),
    useArcGISServer: !0,
    type: "png",
    useScales: !1,
    overrideDPI: !1,
    initialize: function () {
        if (OpenLayers.Layer.XYZ.prototype.initialize.apply(this, arguments), this.resolutions && (this.serverResolutions = this.resolutions, this.maxExtent = this.getMaxExtentForResolution(this.resolutions[0])), this.layerInfo) {
            var e = this.layerInfo, t = new OpenLayers.Bounds(e.fullExtent.xmin, e.fullExtent.ymin, e.fullExtent.xmax, e.fullExtent.ymax);
            if (this.projection = "EPSG:" + e.spatialReference.wkid, this.sphericalMercator = 102100 == e.spatialReference.wkid, this.units = "esriFeet" == e.units ? "ft" : "m", e.tileInfo) {
                this.tileSize = new OpenLayers.Size(e.tileInfo.width || e.tileInfo.cols, e.tileInfo.height || e.tileInfo.rows), this.tileOrigin = new OpenLayers.LonLat(e.tileInfo.origin.x, e.tileInfo.origin.y);
                var i = new OpenLayers.Geometry.Point(t.left, t.top), t = new OpenLayers.Geometry.Point(t.right, t.bottom);
                this.useScales ? this.scales = [] : this.resolutions = [], this.lods = [];
                for (var n in e.tileInfo.lods)if (e.tileInfo.lods.hasOwnProperty(n)) {
                    var s = e.tileInfo.lods[n];
                    this.useScales ? this.scales.push(s.scale) : this.resolutions.push(s.resolution);
                    var r = this.getContainingTileCoords(i, s.resolution);
                    s.startTileCol = r.x, s.startTileRow = r.y, r = this.getContainingTileCoords(t, s.resolution), s.endTileCol = r.x, s.endTileRow = r.y, this.lods.push(s)
                }
                this.maxExtent = this.calculateMaxExtentWithLOD(this.lods[0]), this.serverResolutions = this.resolutions, this.overrideDPI && e.tileInfo.dpi && (OpenLayers.DOTS_PER_INCH = e.tileInfo.dpi)
            }
        }
    },
    getContainingTileCoords: function (e, t) {
        return new OpenLayers.Pixel(Math.max(Math.floor((e.x - this.tileOrigin.lon) / (this.tileSize.w * t)), 0), Math.max(Math.floor((this.tileOrigin.lat - e.y) / (this.tileSize.h * t)), 0))
    },
    calculateMaxExtentWithLOD: function (e) {
        var t = this.tileOrigin.lon + e.startTileCol * this.tileSize.w * e.resolution, i = this.tileOrigin.lat - e.startTileRow * this.tileSize.h * e.resolution;
        return new OpenLayers.Bounds(t, i - (e.endTileRow - e.startTileRow + 1) * this.tileSize.h * e.resolution, t + (e.endTileCol - e.startTileCol + 1) * this.tileSize.w * e.resolution, i)
    },
    calculateMaxExtentWithExtent: function (e, t) {
        var i = new OpenLayers.Geometry.Point(e.left, e.top), n = new OpenLayers.Geometry.Point(e.right, e.bottom), i = this.getContainingTileCoords(i, t), n = this.getContainingTileCoords(n, t);
        return this.calculateMaxExtentWithLOD({
            resolution: t,
            startTileCol: i.x,
            startTileRow: i.y,
            endTileCol: n.x,
            endTileRow: n.y
        })
    },
    getUpperLeftTileCoord: function (e) {
        return this.getContainingTileCoords(new OpenLayers.Geometry.Point(this.maxExtent.left, this.maxExtent.top), e)
    },
    getLowerRightTileCoord: function (e) {
        return this.getContainingTileCoords(new OpenLayers.Geometry.Point(this.maxExtent.right, this.maxExtent.bottom), e)
    },
    getMaxExtentForResolution: function (e) {
        var t = this.getUpperLeftTileCoord(e), i = this.getLowerRightTileCoord(e), n = this.tileOrigin.lon + t.x * this.tileSize.w * e, s = this.tileOrigin.lat - t.y * this.tileSize.h * e;
        return new OpenLayers.Bounds(n, s - (i.y - t.y + 1) * this.tileSize.h * e, n + (i.x - t.x + 1) * this.tileSize.w * e, s)
    },
    clone: function (e) {
        return null == e && (e = new OpenLayers.Layer.ArcGISCache(this.name, this.url, this.options)), OpenLayers.Layer.XYZ.prototype.clone.apply(this, [e])
    },
    getMaxExtent: function () {
        return this.maxExtent = this.getMaxExtentForResolution(this.map.getResolution())
    },
    getTileOrigin: function () {
        var e = this.getMaxExtent();
        return new OpenLayers.LonLat(e.left, e.bottom)
    },
    getURL: function (e) {
        var t = this.getResolution(), i = this.tileOrigin.lon + t * this.tileSize.w / 2, n = this.tileOrigin.lat - t * this.tileSize.h / 2, e = e.getCenterLonLat(), i = Math.round(Math.abs((e.lon - i) / (t * this.tileSize.w))), n = Math.round(Math.abs((n - e.lat) / (t * this.tileSize.h))), e = this.map.getZoom();
        if (this.lods) {
            if (t = this.lods[this.map.getZoom()], i < t.startTileCol || i > t.endTileCol || n < t.startTileRow || n > t.endTileRow)return null
        } else {
            var s = this.getUpperLeftTileCoord(t), t = this.getLowerRightTileCoord(t);
            if (i < s.x || i >= t.x || n < s.y || n >= t.y)return null
        }
        return t = this.url, s = "" + i + n + e, OpenLayers.Util.isArray(t) && (t = this.selectUrl(s, t)), this.useArcGISServer ? t += "/tile/${z}/${y}/${x}" : (i = "C" + this.zeroPad(i, 8, 16), n = "R" + this.zeroPad(n, 8, 16), e = "L" + this.zeroPad(e, 2, 16), t = t + "/${z}/${y}/${x}." + this.type), t = OpenLayers.String.format(t, {
            x: i,
            y: n,
            z: e
        }), OpenLayers.Util.urlAppend(t, OpenLayers.Util.getParameterString(this.params))
    },
    zeroPad: function (e, t, i) {
        for (e = e.toString(i || 10); e.length < t;)e = "0" + e;
        return e
    },
    CLASS_NAME: "OpenLayers.Layer.ArcGISCache"
}),OpenLayers.Control.WMSGetFeatureInfo = OpenLayers.Class(OpenLayers.Control, {
    hover: !1,
    drillDown: !1,
    maxFeatures: 10,
    clickCallback: "click",
    output: "features",
    layers: null,
    queryVisible: !1,
    url: null,
    layerUrls: null,
    infoFormat: "text/html",
    vendorParams: {},
    format: null,
    formatOptions: null,
    handlerOptions: null,
    handler: null,
    hoverRequest: null,
    initialize: function (e) {
        e = e || {}, e.handlerOptions = e.handlerOptions || {}, OpenLayers.Control.prototype.initialize.apply(this, [e]), this.format || (this.format = new OpenLayers.Format.WMSGetFeatureInfo(e.formatOptions)), !0 === this.drillDown && (this.hover = !1), this.hover ? this.handler = new OpenLayers.Handler.Hover(this, {
            move: this.cancelHover,
            pause: this.getInfoForHover
        }, OpenLayers.Util.extend(this.handlerOptions.hover || {}, {delay: 250})) : (e = {}, e[this.clickCallback] = this.getInfoForClick, this.handler = new OpenLayers.Handler.Click(this, e, this.handlerOptions.click || {}))
    },
    getInfoForClick: function (e) {
        this.events.triggerEvent("beforegetfeatureinfo", {xy: e.xy}), OpenLayers.Element.addClass(this.map.viewPortDiv, "olCursorWait"), this.request(e.xy, {})
    },
    getInfoForHover: function (e) {
        this.events.triggerEvent("beforegetfeatureinfo", {xy: e.xy}), this.request(e.xy, {hover: !0})
    },
    cancelHover: function () {
        this.hoverRequest && (this.hoverRequest.abort(), this.hoverRequest = null)
    },
    findLayers: function () {
        for (var e, t, i = this.layers || this.map.layers, n = [], s = i.length - 1; s >= 0; --s)e = i[s], e instanceof OpenLayers.Layer.WMS && (!this.queryVisible || e.getVisibility()) && (t = OpenLayers.Util.isArray(e.url) ? e.url[0] : e.url, !1 === this.drillDown && !this.url && (this.url = t), (!0 === this.drillDown || this.urlMatches(t)) && n.push(e));
        return n
    },
    urlMatches: function (e) {
        var t = OpenLayers.Util.isEquivalentUrl(this.url, e);
        if (!t && this.layerUrls)for (var i = 0, n = this.layerUrls.length; n > i; ++i)if (OpenLayers.Util.isEquivalentUrl(this.layerUrls[i], e)) {
            t = !0;
            break
        }
        return t
    },
    buildWMSOptions: function (e, t, i, n) {
        for (var s = [], r = [], a = 0, o = t.length; o > a; a++)null != t[a].params.LAYERS && (s = s.concat(t[a].params.LAYERS), r = r.concat(this.getStyleNames(t[a])));
        return t = t[0], a = this.map.getProjection(), (o = t.projection) && o.equals(this.map.getProjectionObject()) && (a = o.getCode()), n = OpenLayers.Util.extend({
            service: "WMS",
            version: t.params.VERSION,
            request: "GetFeatureInfo",
            exceptions: t.params.EXCEPTIONS,
            bbox: this.map.getExtent().toBBOX(null, t.reverseAxisOrder()),
            feature_count: this.maxFeatures,
            height: this.map.getSize().h,
            width: this.map.getSize().w,
            format: n,
            info_format: t.params.INFO_FORMAT || this.infoFormat
        }, 1.3 <= parseFloat(t.params.VERSION) ? {crs: a, i: parseInt(i.x), j: parseInt(i.y)} : {
            srs: a,
            x: parseInt(i.x),
            y: parseInt(i.y)
        }), 0 != s.length && (n = OpenLayers.Util.extend({
            layers: s,
            query_layers: s,
            styles: r
        }, n)), OpenLayers.Util.applyDefaults(n, this.vendorParams), {
            url: e,
            params: OpenLayers.Util.upperCaseObject(n),
            callback: function (t) {
                this.handleResponse(i, t, e)
            },
            scope: this
        }
    },
    getStyleNames: function (e) {
        return e.params.STYLES ? e.params.STYLES : OpenLayers.Util.isArray(e.params.LAYERS) ? Array(e.params.LAYERS.length) : e.params.LAYERS.replace(/[^,]/g, "")
    },
    request: function (e, t) {
        var i = this.findLayers();
        if (0 == i.length) this.events.triggerEvent("nogetfeatureinfo"), OpenLayers.Element.removeClass(this.map.viewPortDiv, "olCursorWait"); else if (t = t || {}, !1 === this.drillDown) {
            var i = this.buildWMSOptions(this.url, i, e, i[0].params.FORMAT), n = OpenLayers.Request.GET(i);
            !0 === t.hover && (this.hoverRequest = n)
        } else {
            this._numRequests = this._requestCount = 0, this.features = [];
            for (var s, n = {}, r = 0, a = i.length; a > r; r++) {
                var o = i[r];
                s = OpenLayers.Util.isArray(o.url) ? o.url[0] : o.url, s in n ? n[s].push(o) : (this._numRequests++, n[s] = [o])
            }
            for (s in n)i = n[s], i = this.buildWMSOptions(s, i, e, i[0].params.FORMAT), OpenLayers.Request.GET(i)
        }
    },
    triggerGetFeatureInfo: function (e, t, i) {
        this.events.triggerEvent("getfeatureinfo", {
            text: e.responseText,
            features: i,
            request: e,
            xy: t
        }), OpenLayers.Element.removeClass(this.map.viewPortDiv, "olCursorWait")
    },
    handleResponse: function (e, t, i) {
        var n = t.responseXML;
        n && n.documentElement || (n = t.responseText), n = this.format.read(n), !1 === this.drillDown ? this.triggerGetFeatureInfo(t, e, n) : (this._requestCount++, this._features = "object" === this.output ? (this._features || []).concat({
            url: i,
            features: n
        }) : (this._features || []).concat(n), this._requestCount === this._numRequests && (this.triggerGetFeatureInfo(t, e, this._features.concat()), delete this._features, delete this._requestCount, delete this._numRequests))
    },
    CLASS_NAME: "OpenLayers.Control.WMSGetFeatureInfo"
}),OpenLayers.Format.WMSCapabilities.v1_3_0 = OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_3, {
    version: "1.3.0",
    CLASS_NAME: "OpenLayers.Format.WMSCapabilities.v1_3_0"
}),OpenLayers.Format.SOSGetFeatureOfInterest = OpenLayers.Class(OpenLayers.Format.XML, {
    VERSION: "1.0.0",
    namespaces: {
        sos: "http://www.opengis.net/sos/1.0",
        gml: "http://www.opengis.net/gml",
        sa: "http://www.opengis.net/sampling/1.0",
        xsi: "http://www.w3.org/2001/XMLSchema-instance"
    },
    schemaLocation: "http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosAll.xsd",
    defaultPrefix: "sos",
    regExes: {trimSpace: /^\s*|\s*$/g, removeSpace: /\s*/g, splitSpace: /\s+/, trimComma: /\s*,\s*/g},
    read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e])), e && 9 == e.nodeType && (e = e.documentElement);
        var t = {features: []};
        this.readNode(e, t);
        for (var e = [], i = 0, n = t.features.length; n > i; i++) {
            var s = t.features[i];
            this.internalProjection && this.externalProjection && s.components[0] && s.components[0].transform(this.externalProjection, this.internalProjection), s = new OpenLayers.Feature.Vector(s.components[0], s.attributes), e.push(s)
        }
        return e
    },
    readers: {
        sa: {
            SamplingPoint: function (e, t) {
                if (!t.attributes) {
                    var i = {attributes: {}};
                    t.features.push(i), t = i
                }
                t.attributes.id = this.getAttributeNS(e, this.namespaces.gml, "id"), this.readChildNodes(e, t)
            }, position: function (e, t) {
                this.readChildNodes(e, t)
            }
        }, gml: OpenLayers.Util.applyDefaults({
            FeatureCollection: function (e, t) {
                this.readChildNodes(e, t)
            }, featureMember: function (e, t) {
                var i = {attributes: {}};
                t.features.push(i), this.readChildNodes(e, i)
            }, name: function (e, t) {
                t.attributes.name = this.getChildValue(e)
            }, pos: function (e, t) {
                this.externalProjection || (this.externalProjection = new OpenLayers.Projection(e.getAttribute("srsName"))), OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(this, [e, t])
            }
        }, OpenLayers.Format.GML.v3.prototype.readers.gml)
    },
    writers: {
        sos: {
            GetFeatureOfInterest: function (e) {
                for (var t = this.createElementNSPlus("GetFeatureOfInterest", {
                    attributes: {
                        version: this.VERSION,
                        service: "SOS",
                        "xsi:schemaLocation": this.schemaLocation
                    }
                }), i = 0, n = e.fois.length; n > i; i++)this.writeNode("FeatureOfInterestId", {foi: e.fois[i]}, t);
                return t
            }, FeatureOfInterestId: function (e) {
                return this.createElementNSPlus("FeatureOfInterestId", {value: e.foi})
            }
        }
    },
    CLASS_NAME: "OpenLayers.Format.SOSGetFeatureOfInterest"
}),OpenLayers.Format.SOSGetObservation = OpenLayers.Class(OpenLayers.Format.XML, {
    namespaces: {
        ows: "http://www.opengis.net/ows",
        gml: "http://www.opengis.net/gml",
        sos: "http://www.opengis.net/sos/1.0",
        ogc: "http://www.opengis.net/ogc",
        om: "http://www.opengis.net/om/1.0",
        sa: "http://www.opengis.net/sampling/1.0",
        xlink: "http://www.w3.org/1999/xlink",
        xsi: "http://www.w3.org/2001/XMLSchema-instance"
    },
    regExes: {trimSpace: /^\s*|\s*$/g, removeSpace: /\s*/g, splitSpace: /\s+/, trimComma: /\s*,\s*/g},
    VERSION: "1.0.0",
    schemaLocation: "http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosGetObservation.xsd",
    defaultPrefix: "sos",
    read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e])), e && 9 == e.nodeType && (e = e.documentElement);
        var t = {measurements: [], observations: []};
        return this.readNode(e, t), t
    },
    write: function (e) {
        return e = this.writeNode("sos:GetObservation", e), e.setAttribute("xmlns:om", this.namespaces.om), e.setAttribute("xmlns:ogc", this.namespaces.ogc), this.setAttributeNS(e, this.namespaces.xsi, "xsi:schemaLocation", this.schemaLocation), OpenLayers.Format.XML.prototype.write.apply(this, [e])
    },
    readers: {
        om: {
            ObservationCollection: function (e, t) {
                t.id = this.getAttributeNS(e, this.namespaces.gml, "id"), this.readChildNodes(e, t)
            }, member: function (e, t) {
                this.readChildNodes(e, t)
            }, Measurement: function (e, t) {
                var i = {};
                t.measurements.push(i), this.readChildNodes(e, i)
            }, Observation: function (e, t) {
                var i = {};
                t.observations.push(i), this.readChildNodes(e, i)
            }, samplingTime: function (e, t) {
                var i = {};
                t.samplingTime = i, this.readChildNodes(e, i)
            }, observedProperty: function (e, t) {
                t.observedProperty = this.getAttributeNS(e, this.namespaces.xlink, "href"), this.readChildNodes(e, t)
            }, procedure: function (e, t) {
                t.procedure = this.getAttributeNS(e, this.namespaces.xlink, "href"), this.readChildNodes(e, t)
            }, featureOfInterest: function (e, t) {
                var i = {features: []};
                t.fois = [], t.fois.push(i), this.readChildNodes(e, i);
                for (var n = [], s = 0, r = i.features.length; r > s; s++) {
                    var a = i.features[s];
                    n.push(new OpenLayers.Feature.Vector(a.components[0], a.attributes))
                }
                i.features = n
            }, result: function (e, t) {
                var i = {};
                t.result = i, "" !== this.getChildValue(e) ? (i.value = this.getChildValue(e), i.uom = e.getAttribute("uom")) : this.readChildNodes(e, i)
            }
        },
        sa: OpenLayers.Format.SOSGetFeatureOfInterest.prototype.readers.sa,
        gml: OpenLayers.Util.applyDefaults({
            TimeInstant: function (e, t) {
                var i = {};
                t.timeInstant = i, this.readChildNodes(e, i)
            }, timePosition: function (e, t) {
                t.timePosition = this.getChildValue(e)
            }
        }, OpenLayers.Format.SOSGetFeatureOfInterest.prototype.readers.gml)
    },
    writers: {
        sos: {
            GetObservation: function (e) {
                var t = this.createElementNSPlus("GetObservation", {
                    attributes: {
                        version: this.VERSION,
                        service: "SOS"
                    }
                });
                this.writeNode("offering", e, t), e.eventTime && this.writeNode("eventTime", e, t);
                for (var i in e.procedures)this.writeNode("procedure", e.procedures[i], t);
                for (var n in e.observedProperties)this.writeNode("observedProperty", e.observedProperties[n], t);
                return e.foi && this.writeNode("featureOfInterest", e.foi, t), this.writeNode("responseFormat", e, t), e.resultModel && this.writeNode("resultModel", e, t), e.responseMode && this.writeNode("responseMode", e, t), t
            }, featureOfInterest: function (e) {
                var t = this.createElementNSPlus("featureOfInterest");
                return this.writeNode("ObjectID", e.objectId, t), t
            }, ObjectID: function (e) {
                return this.createElementNSPlus("ObjectID", {value: e})
            }, responseFormat: function (e) {
                return this.createElementNSPlus("responseFormat", {value: e.responseFormat})
            }, procedure: function (e) {
                return this.createElementNSPlus("procedure", {value: e})
            }, offering: function (e) {
                return this.createElementNSPlus("offering", {value: e.offering})
            }, observedProperty: function (e) {
                return this.createElementNSPlus("observedProperty", {value: e})
            }, eventTime: function (e) {
                var t = this.createElementNSPlus("eventTime");
                return "latest" === e.eventTime && this.writeNode("ogc:TM_Equals", e, t), t
            }, resultModel: function (e) {
                return this.createElementNSPlus("resultModel", {value: e.resultModel})
            }, responseMode: function (e) {
                return this.createElementNSPlus("responseMode", {value: e.responseMode})
            }
        }, ogc: {
            TM_Equals: function (e) {
                var t = this.createElementNSPlus("ogc:TM_Equals");
                return this.writeNode("ogc:PropertyName", {property: "urn:ogc:data:time:iso8601"}, t), "latest" === e.eventTime && this.writeNode("gml:TimeInstant", {value: "latest"}, t), t
            }, PropertyName: function (e) {
                return this.createElementNSPlus("ogc:PropertyName", {value: e.property})
            }
        }, gml: {
            TimeInstant: function (e) {
                var t = this.createElementNSPlus("gml:TimeInstant");
                return this.writeNode("gml:timePosition", e, t), t
            }, timePosition: function (e) {
                return this.createElementNSPlus("gml:timePosition", {value: e.value})
            }
        }
    },
    CLASS_NAME: "OpenLayers.Format.SOSGetObservation"
}),OpenLayers.Control.UTFGrid = OpenLayers.Class(OpenLayers.Control, {
    autoActivate: !0,
    layers: null,
    defaultHandlerOptions: {
        delay: 300,
        pixelTolerance: 4,
        stopMove: !1,
        single: !0,
        "double": !1,
        stopSingle: !1,
        stopDouble: !1
    },
    handlerMode: "click",
    setHandler: function (e) {
        this.handlerMode = e, this.resetHandler()
    },
    resetHandler: function () {
        return this.handler && (this.handler.deactivate(), this.handler.destroy(), this.handler = null), "hover" == this.handlerMode ? this.handler = new OpenLayers.Handler.Hover(this, {
            pause: this.handleEvent,
            move: this.reset
        }, this.handlerOptions) : "click" == this.handlerMode ? this.handler = new OpenLayers.Handler.Click(this, {click: this.handleEvent}, this.handlerOptions) : "move" == this.handlerMode && (this.handler = new OpenLayers.Handler.Hover(this, {
            pause: this.handleEvent,
            move: this.handleEvent
        }, this.handlerOptions)), this.handler ? !0 : !1
    },
    initialize: function (e) {
        e = e || {}, e.handlerOptions = e.handlerOptions || this.defaultHandlerOptions, OpenLayers.Control.prototype.initialize.apply(this, [e]), this.resetHandler()
    },
    handleEvent: function (e) {
        if (null == e) this.reset(); else {
            var t = this.map.getLonLatFromPixel(e.xy);
            if (t) {
                var i = this.findLayers();
                if (0 < i.length) {
                    for (var n, s, r = {}, a = 0, o = i.length; o > a; a++)n = i[a], s = OpenLayers.Util.indexOf(this.map.layers, n), r[s] = n.getFeatureInfo(t);
                    this.callback(r, t, e.xy)
                }
            }
        }
    },
    callback: function () {
    },
    reset: function () {
        this.callback(null)
    },
    findLayers: function () {
        for (var e, t = this.layers || this.map.layers, i = [], n = t.length - 1; n >= 0; --n)e = t[n], e instanceof OpenLayers.Layer.UTFGrid && i.push(e);
        return i
    },
    CLASS_NAME: "OpenLayers.Control.UTFGrid"
}),OpenLayers.Format.CQL = function () {
    function e(e) {
        function t() {
            var e = n.pop();
            switch (e.type) {
                case"LOGICAL":
                    var i = t(), r = t();
                    return new OpenLayers.Filter.Logical({filters: [r, i], type: a[e.text.toUpperCase()]});
                case"NOT":
                    return i = t(), new OpenLayers.Filter.Logical({filters: [i], type: OpenLayers.Filter.Logical.NOT});
                case"BETWEEN":
                    return n.pop(), r = t(), e = t(), i = t(), new OpenLayers.Filter.Comparison({
                        property: i,
                        lowerBoundary: e,
                        upperBoundary: r,
                        type: OpenLayers.Filter.Comparison.BETWEEN
                    });
                case"COMPARISON":
                    return r = t(), i = t(), new OpenLayers.Filter.Comparison({
                        property: i,
                        value: r,
                        type: s[e.text.toUpperCase()]
                    });
                case"VALUE":
                    return /^'.*'$/.test(e.text) ? e.text.substr(1, e.text.length - 2) : Number(e.text);
                case"SPATIAL":
                    switch (e.text.toUpperCase()) {
                        case"BBOX":
                            var i = t(), e = t(), r = t(), o = t(), l = t();
                            return new OpenLayers.Filter.Spatial({
                                type: OpenLayers.Filter.Spatial.BBOX,
                                property: l,
                                value: OpenLayers.Bounds.fromArray([o, r, e, i])
                            });
                        case"INTERSECTS":
                            return r = t(), i = t(), new OpenLayers.Filter.Spatial({
                                type: OpenLayers.Filter.Spatial.INTERSECTS,
                                property: i,
                                value: r
                            });
                        case"WITHIN":
                            return r = t(), i = t(), new OpenLayers.Filter.Spatial({
                                type: OpenLayers.Filter.Spatial.WITHIN,
                                property: i,
                                value: r
                            });
                        case"CONTAINS":
                            return r = t(), i = t(), new OpenLayers.Filter.Spatial({
                                type: OpenLayers.Filter.Spatial.CONTAINS,
                                property: i,
                                value: r
                            });
                        case"DWITHIN":
                            return e = t(), r = t(), i = t(), new OpenLayers.Filter.Spatial({
                                type: OpenLayers.Filter.Spatial.DWITHIN,
                                value: r,
                                property: i,
                                distance: Number(e)
                            })
                    }
                case"GEOMETRY":
                    return OpenLayers.Geometry.fromWKT(e.text);
                default:
                    return e.text
            }
        }

        for (var i = [], n = []; e.length;) {
            var r = e.shift();
            switch (r.type) {
                case"PROPERTY":
                case"GEOMETRY":
                case"VALUE":
                    n.push(r);
                    break;
                case"COMPARISON":
                case"BETWEEN":
                case"LOGICAL":
                    for (var o = l[r.type]; 0 < i.length && l[i[i.length - 1].type] <= o;)n.push(i.pop());
                    i.push(r);
                    break;
                case"SPATIAL":
                case"NOT":
                case"LPAREN":
                    i.push(r);
                    break;
                case"RPAREN":
                    for (; 0 < i.length && "LPAREN" != i[i.length - 1].type;)n.push(i.pop());
                    i.pop(), 0 < i.length && "SPATIAL" == i[i.length - 1].type && n.push(i.pop());
                case"COMMA":
                case"END":
                    break;
                default:
                    throw Error("Unknown token type " + r.type)
            }
        }
        for (; 0 < i.length;)n.push(i.pop());
        if (e = t(), 0 < n.length) {
            for (e = "Remaining tokens after building AST: \n", i = n.length - 1; i >= 0; i--)e += n[i].type + ": " + n[i].text + "\n";
            throw Error(e)
        }
        return e
    }

    var t, i = {
        PROPERTY: /^[_a-zA-Z]\w*/,
        COMPARISON: /^(=|<>|<=|<|>=|>|LIKE)/i,
        COMMA: /^,/,
        LOGICAL: /^(AND|OR)/i,
        VALUE: /^('\w+'|\d+(\.\d*)?|\.\d+)/,
        LPAREN: /^\(/,
        RPAREN: /^\)/,
        SPATIAL: /^(BBOX|INTERSECTS|DWITHIN|WITHIN|CONTAINS)/i,
        NOT: /^NOT/i,
        BETWEEN: /^BETWEEN/i,
        GEOMETRY: function (e) {
            var t = /^(POINT|LINESTRING|POLYGON|MULTIPOINT|MULTILINESTRING|MULTIPOLYGON|GEOMETRYCOLLECTION)/.exec(e);
            if (t) {
                var i = e.length, t = e.indexOf("(", t[0].length);
                if (t > -1)for (var n = 1; i > t && n > 0;)switch (t++, e.charAt(t)) {
                    case"(":
                        n++;
                        break;
                    case")":
                        n--
                }
                return [e.substr(0, t + 1)]
            }
        },
        END: /^$/
    }, n = {
        LPAREN: ["GEOMETRY", "SPATIAL", "PROPERTY", "VALUE", "LPAREN"],
        RPAREN: ["NOT", "LOGICAL", "END", "RPAREN"],
        PROPERTY: ["COMPARISON", "BETWEEN", "COMMA"],
        BETWEEN: ["VALUE"],
        COMPARISON: ["VALUE"],
        COMMA: ["GEOMETRY", "VALUE", "PROPERTY"],
        VALUE: ["LOGICAL", "COMMA", "RPAREN", "END"],
        SPATIAL: ["LPAREN"],
        LOGICAL: ["NOT", "VALUE", "SPATIAL", "PROPERTY", "LPAREN"],
        NOT: ["PROPERTY", "LPAREN"],
        GEOMETRY: ["COMMA", "RPAREN"]
    }, s = {
        "=": OpenLayers.Filter.Comparison.EQUAL_TO,
        "<>": OpenLayers.Filter.Comparison.NOT_EQUAL_TO,
        "<": OpenLayers.Filter.Comparison.LESS_THAN,
        "<=": OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO,
        ">": OpenLayers.Filter.Comparison.GREATER_THAN,
        ">=": OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO,
        LIKE: OpenLayers.Filter.Comparison.LIKE,
        BETWEEN: OpenLayers.Filter.Comparison.BETWEEN
    }, r = {}, a = {AND: OpenLayers.Filter.Logical.AND, OR: OpenLayers.Filter.Logical.OR}, o = {}, l = {
        RPAREN: 3,
        LOGICAL: 2,
        COMPARISON: 1
    };
    for (t in s)s.hasOwnProperty(t) && (r[s[t]] = t);
    for (t in a)a.hasOwnProperty(t) && (o[a[t]] = t);
    return OpenLayers.Class(OpenLayers.Format, {
        read: function (t) {
            var s, r = t, t = [], a = ["NOT", "GEOMETRY", "SPATIAL", "PROPERTY", "LPAREN"];
            do {
                e:{
                    s = a;
                    for (var o = void 0, a = void 0, l = s.length, o = 0; l > o; o++) {
                        var a = s[o], h = i[a] instanceof RegExp ? i[a].exec(r) : i[a](r);
                        if (h) {
                            s = h[0], r = r.substr(s.length).replace(/^\s*/, ""), s = {type: a, text: s, remainder: r};
                            break e
                        }
                    }
                    for (t = "ERROR: In parsing: [" + r + "], expected one of: ", o = 0; l > o; o++)a = s[o], t += "\n    " + a + ": " + i[a];
                    throw Error(t)
                }
                if (r = s.remainder, a = n[s.type], "END" != s.type && !a)throw Error("No follows list for " + s.type);
                t.push(s)
            } while ("END" != s.type);
            return t = e(t), this.keepData && (this.data = t), t
        }, write: function (e) {
            if (e instanceof OpenLayers.Geometry)return e.toString();
            switch (e.CLASS_NAME) {
                case"OpenLayers.Filter.Spatial":
                    switch (e.type) {
                        case OpenLayers.Filter.Spatial.BBOX:
                            return "BBOX(" + e.property + "," + e.value.toBBOX() + ")";
                        case OpenLayers.Filter.Spatial.DWITHIN:
                            return "DWITHIN(" + e.property + ", " + this.write(e.value) + ", " + e.distance + ")";
                        case OpenLayers.Filter.Spatial.WITHIN:
                            return "WITHIN(" + e.property + ", " + this.write(e.value) + ")";
                        case OpenLayers.Filter.Spatial.INTERSECTS:
                            return "INTERSECTS(" + e.property + ", " + this.write(e.value) + ")";
                        case OpenLayers.Filter.Spatial.CONTAINS:
                            return "CONTAINS(" + e.property + ", " + this.write(e.value) + ")";
                        default:
                            throw Error("Unknown spatial filter type: " + e.type)
                    }
                case"OpenLayers.Filter.Logical":
                    if (e.type == OpenLayers.Filter.Logical.NOT)return "NOT (" + this.write(e.filters[0]) + ")";
                    for (var t = "(", i = !0, n = 0; n < e.filters.length; n++)i ? i = !1 : t += ") " + o[e.type] + " (", t += this.write(e.filters[n]);
                    return t + ")";
                case"OpenLayers.Filter.Comparison":
                    return e.type == OpenLayers.Filter.Comparison.BETWEEN ? e.property + " BETWEEN " + this.write(e.lowerBoundary) + " AND " + this.write(e.upperBoundary) : e.property + " " + r[e.type] + " " + this.write(e.value);
                case void 0:
                    if ("string" == typeof e)return "'" + e + "'";
                    if ("number" == typeof e)return "" + e;
                default:
                    throw Error("Can't encode: " + e.CLASS_NAME + " " + e)
            }
        }, CLASS_NAME: "OpenLayers.Format.CQL"
    })
}(),OpenLayers.Control.Split = OpenLayers.Class(OpenLayers.Control, {
    layer: null,
    source: null,
    sourceOptions: null,
    tolerance: null,
    edge: !0,
    deferDelete: !1,
    mutual: !0,
    targetFilter: null,
    sourceFilter: null,
    handler: null,
    initialize: function (e) {
        OpenLayers.Control.prototype.initialize.apply(this, [e]), this.options = e || {}, this.options.source && this.setSource(this.options.source)
    },
    setSource: function (e) {
        this.active ? (this.deactivate(), this.handler && (this.handler.destroy(), delete this.handler), this.source = e, this.activate()) : this.source = e
    },
    activate: function () {
        var e = OpenLayers.Control.prototype.activate.call(this);
        return e && (this.source ? this.source.events && this.source.events.on({
            sketchcomplete: this.onSketchComplete,
            afterfeaturemodified: this.afterFeatureModified,
            scope: this
        }) : (this.handler || (this.handler = new OpenLayers.Handler.Path(this, {
            done: function (e) {
                this.onSketchComplete({feature: new OpenLayers.Feature.Vector(e)})
            }
        }, {layerOptions: this.sourceOptions})), this.handler.activate())), e
    },
    deactivate: function () {
        var e = OpenLayers.Control.prototype.deactivate.call(this);
        return e && this.source && this.source.events && this.layer.events.un({
            sketchcomplete: this.onSketchComplete,
            afterfeaturemodified: this.afterFeatureModified,
            scope: this
        }), e
    },
    onSketchComplete: function (e) {
        return this.feature = null, !this.considerSplit(e.feature)
    },
    afterFeatureModified: function (e) {
        e.modified && "function" == typeof e.feature.geometry.split && (this.feature = e.feature, this.considerSplit(e.feature))
    },
    removeByGeometry: function (e, t) {
        for (var i = 0, n = e.length; n > i; ++i)if (e[i].geometry === t) {
            e.splice(i, 1);
            break
        }
    },
    isEligible: function (e) {
        return e.geometry ? e.state !== OpenLayers.State.DELETE && "function" == typeof e.geometry.split && this.feature !== e && (!this.targetFilter || this.targetFilter.evaluate(e.attributes)) : !1
    },
    considerSplit: function (e) {
        var t = !1, i = !1;
        if (!this.sourceFilter || this.sourceFilter.evaluate(e.attributes)) {
            for (var n, s, r, a, o, l = this.layer && this.layer.features || [], h = [], u = [], c = this.layer === this.source && this.mutual, p = {
                edge: this.edge,
                tolerance: this.tolerance,
                mutual: c
            }, d = [e.geometry], f = 0, m = l.length; m > f; ++f)if (r = l[f], this.isEligible(r)) {
                a = [r.geometry];
                for (var g = 0; g < d.length; ++g) {
                    o = d[g];
                    for (var y = 0; y < a.length; ++y)n = a[y], o.getBounds().intersectsBounds(n.getBounds()) && (n = o.split(n, p)) && (s = this.events.triggerEvent("beforesplit", {
                        source: e,
                        target: r
                    }), !1 !== s && (c && (s = n[0], 1 < s.length && (s.unshift(g, 1), Array.prototype.splice.apply(d, s), g += s.length - 3), n = n[1]), 1 < n.length) && (n.unshift(y, 1), Array.prototype.splice.apply(a, n), y += n.length - 3))
                }
                a && 1 < a.length && (this.geomsToFeatures(r, a), this.events.triggerEvent("split", {
                    original: r,
                    features: a
                }), Array.prototype.push.apply(h, a), u.push(r), i = !0)
            }
            if (d && 1 < d.length && (this.geomsToFeatures(e, d), this.events.triggerEvent("split", {
                    original: e,
                    features: d
                }), Array.prototype.push.apply(h, d), u.push(e), t = !0), t || i) {
                if (this.deferDelete) {
                    for (l = [], f = 0, m = u.length; m > f; ++f)i = u[f], i.state === OpenLayers.State.INSERT ? l.push(i) : (i.state = OpenLayers.State.DELETE, this.layer.drawFeature(i));
                    for (this.layer.destroyFeatures(l, {silent: !0}), f = 0, m = h.length; m > f; ++f)h[f].state = OpenLayers.State.INSERT
                } else this.layer.destroyFeatures(u, {silent: !0});
                this.layer.addFeatures(h, {silent: !0}), this.events.triggerEvent("aftersplit", {
                    source: e,
                    features: h
                })
            }
        }
        return t
    },
    geomsToFeatures: function (e, t) {
        var i = e.clone();
        delete i.geometry;
        for (var n, s = 0, r = t.length; r > s; ++s)n = i.clone(), n.geometry = t[s], n.state = OpenLayers.State.INSERT, t[s] = n
    },
    destroy: function () {
        this.active && this.deactivate(), OpenLayers.Control.prototype.destroy.call(this)
    },
    CLASS_NAME: "OpenLayers.Control.Split"
}),OpenLayers.Layer.WMTS = OpenLayers.Class(OpenLayers.Layer.Grid, {
    isBaseLayer: !0,
    version: "1.0.0",
    requestEncoding: "KVP",
    url: null,
    layer: null,
    matrixSet: null,
    style: null,
    format: "image/jpeg",
    tileOrigin: null,
    tileFullExtent: null,
    formatSuffix: null,
    matrixIds: null,
    dimensions: null,
    params: null,
    zoomOffset: 0,
    serverResolutions: null,
    formatSuffixMap: {
        "image/png": "png",
        "image/png8": "png",
        "image/png24": "png",
        "image/png32": "png",
        png: "png",
        "image/jpeg": "jpg",
        "image/jpg": "jpg",
        jpeg: "jpg",
        jpg: "jpg"
    },
    matrix: null,
    initialize: function (e) {
        var t, i = {url: !0, layer: !0, style: !0, matrixSet: !0};
        for (t in i)if (!(t in e))throw Error("Missing property '" + t + "' in layer configuration.");
        if (e.params = OpenLayers.Util.upperCaseObject(e.params), OpenLayers.Layer.Grid.prototype.initialize.apply(this, [e.name, e.url, e.params, e]), this.formatSuffix || (this.formatSuffix = this.formatSuffixMap[this.format] || this.format.split("/").pop()), this.matrixIds && (e = this.matrixIds.length) && "string" == typeof this.matrixIds[0])for (i = this.matrixIds, this.matrixIds = Array(e), t = 0; e > t; ++t)this.matrixIds[t] = {identifier: i[t]}
    },
    setMap: function () {
        OpenLayers.Layer.Grid.prototype.setMap.apply(this, arguments), this.updateMatrixProperties()
    },
    updateMatrixProperties: function () {
        (this.matrix = this.getMatrix()) && (this.matrix.topLeftCorner && (this.tileOrigin = this.matrix.topLeftCorner), this.matrix.tileWidth && this.matrix.tileHeight && (this.tileSize = new OpenLayers.Size(this.matrix.tileWidth, this.matrix.tileHeight)), this.tileOrigin || (this.tileOrigin = new OpenLayers.LonLat(this.maxExtent.left, this.maxExtent.top)), this.tileFullExtent || (this.tileFullExtent = this.maxExtent))
    },
    moveTo: function (e, t) {
        return (t || !this.matrix) && this.updateMatrixProperties(), OpenLayers.Layer.Grid.prototype.moveTo.apply(this, arguments)
    },
    clone: function (e) {
        return null == e && (e = new OpenLayers.Layer.WMTS(this.options)), e = OpenLayers.Layer.Grid.prototype.clone.apply(this, [e])
    },
    getIdentifier: function () {
        return this.getServerZoom()
    },
    getMatrix: function () {
        var e;
        if (this.matrixIds && 0 !== this.matrixIds.length)if ("scaleDenominator" in this.matrixIds[0])for (var t, i = OpenLayers.METERS_PER_INCH * OpenLayers.INCHES_PER_UNIT[this.units] * this.getServerResolution() / 28e-5, n = Number.POSITIVE_INFINITY, s = 0, r = this.matrixIds.length; r > s; ++s)t = Math.abs(1 - this.matrixIds[s].scaleDenominator / i), n > t && (n = t, e = this.matrixIds[s]); else e = this.matrixIds[this.getIdentifier()]; else e = {identifier: this.getIdentifier()};
        return e
    },
    getTileInfo: function (e) {
        var t = this.getServerResolution(), i = (e.lon - this.tileOrigin.lon) / (t * this.tileSize.w), e = (this.tileOrigin.lat - e.lat) / (t * this.tileSize.h), t = Math.floor(i), n = Math.floor(e);
        return {col: t, row: n, i: Math.floor((i - t) * this.tileSize.w), j: Math.floor((e - n) * this.tileSize.h)}
    },
    getURL: function (e) {
        var e = this.adjustBounds(e), t = "";
        if (!this.tileFullExtent || this.tileFullExtent.intersectsBounds(e)) {
            var i = this.getTileInfo(e.getCenterLonLat()), e = this.dimensions;
            if ("REST" === this.requestEncoding.toUpperCase())if (t = this.params, "string" == typeof this.url && -1 !== this.url.indexOf("{")) {
                var n = this.url.replace(/\{/g, "${"), i = {
                    style: this.style,
                    Style: this.style,
                    TileMatrixSet: this.matrixSet,
                    TileMatrix: this.matrix.identifier,
                    TileRow: i.row,
                    TileCol: i.col
                };
                if (e) {
                    var s, r;
                    for (r = e.length - 1; r >= 0; --r)s = e[r], i[s] = t[s.toUpperCase()]
                }
                t = OpenLayers.String.format(n, i)
            } else {
                if (n = this.version + "/" + this.layer + "/" + this.style + "/", e)for (r = 0; r < e.length; r++)t[e[r]] && (n = n + t[e[r]] + "/");
                n = n + this.matrixSet + "/" + this.matrix.identifier + "/" + i.row + "/" + i.col + "." + this.formatSuffix, t = OpenLayers.Util.isArray(this.url) ? this.selectUrl(n, this.url) : this.url, t.match(/\/$/) || (t += "/"), t += n
            } else"KVP" === this.requestEncoding.toUpperCase() && (t = {
                SERVICE: "WMTS",
                REQUEST: "GetTile",
                VERSION: this.version,
                LAYER: this.layer,
                STYLE: this.style,
                TILEMATRIXSET: this.matrixSet,
                TILEMATRIX: this.matrix.identifier,
                TILEROW: i.row,
                TILECOL: i.col,
                FORMAT: this.format
            }, t = OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this, [t]))
        }
        return t
    },
    mergeNewParams: function (e) {
        return "KVP" === this.requestEncoding.toUpperCase() ? OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this, [OpenLayers.Util.upperCaseObject(e)]) : void 0
    },
    CLASS_NAME: "OpenLayers.Layer.WMTS"
}),OpenLayers.Protocol.SOS.v1_0_0 = OpenLayers.Class(OpenLayers.Protocol, {
    fois: null,
    formatOptions: null,
    initialize: function (e) {
        OpenLayers.Protocol.prototype.initialize.apply(this, [e]), e.format || (this.format = new OpenLayers.Format.SOSGetFeatureOfInterest(this.formatOptions))
    },
    destroy: function () {
        this.options && !this.options.format && this.format.destroy(), this.format = null, OpenLayers.Protocol.prototype.destroy.apply(this)
    },
    read: function (e) {
        e = OpenLayers.Util.extend({}, e), OpenLayers.Util.applyDefaults(e, this.options || {});
        var t = new OpenLayers.Protocol.Response({requestType: "read"}), i = this.format, i = OpenLayers.Format.XML.prototype.write.apply(i, [i.writeNode("sos:GetFeatureOfInterest", {fois: this.fois})]);
        return t.priv = OpenLayers.Request.POST({
            url: e.url,
            callback: this.createCallback(this.handleRead, t, e),
            data: i
        }), t
    },
    handleRead: function (e, t) {
        if (t.callback) {
            var i = e.priv;
            200 <= i.status && 300 > i.status ? (e.features = this.parseFeatures(i), e.code = OpenLayers.Protocol.Response.SUCCESS) : e.code = OpenLayers.Protocol.Response.FAILURE, t.callback.call(t.scope, e)
        }
    },
    parseFeatures: function (e) {
        var t = e.responseXML;
        return t && t.documentElement || (t = e.responseText), !t || 0 >= t.length ? null : this.format.read(t)
    },
    CLASS_NAME: "OpenLayers.Protocol.SOS.v1_0_0"
}),OpenLayers.Layer.KaMapCache = OpenLayers.Class(OpenLayers.Layer.KaMap, {
    IMAGE_EXTENSIONS: {
        jpeg: "jpg",
        gif: "gif",
        png: "png",
        png8: "png",
        png24: "png",
        dithered: "png"
    }, DEFAULT_FORMAT: "jpeg", initialize: function () {
        OpenLayers.Layer.KaMap.prototype.initialize.apply(this, arguments), this.extension = this.IMAGE_EXTENSIONS[this.params.i.toLowerCase() || this.DEFAULT_FORMAT]
    }, getURL: function (e) {
        var e = this.adjustBounds(e), t = this.map.getResolution(), i = Math.round(1e4 * this.map.getScale()) / 1e4, n = Math.round(e.left / t), e = -Math.round(e.top / t), t = Math.floor(n / this.tileSize.w / this.params.metaTileSize.w) * this.tileSize.w * this.params.metaTileSize.w, s = Math.floor(e / this.tileSize.h / this.params.metaTileSize.h) * this.tileSize.h * this.params.metaTileSize.h, i = ["/", this.params.map, "/", i, "/", this.params.g.replace(/\s/g, "_"), "/def/t", s, "/l", t, "/t", e, "l", n, ".", this.extension], n = this.url;
        return OpenLayers.Util.isArray(n) && (n = this.selectUrl(i.join(""), n)), n + i.join("")
    }, CLASS_NAME: "OpenLayers.Layer.KaMapCache"
}),OpenLayers.Protocol.WFS.v1_1_0 = OpenLayers.Class(OpenLayers.Protocol.WFS.v1, {
    version: "1.1.0",
    initialize: function () {
        OpenLayers.Protocol.WFS.v1.prototype.initialize.apply(this, arguments), this.outputFormat && !this.readFormat && ("gml2" == this.outputFormat.toLowerCase() ? this.readFormat = new OpenLayers.Format.GML.v2({
            featureType: this.featureType,
            featureNS: this.featureNS,
            geometryName: this.geometryName
        }) : "json" == this.outputFormat.toLowerCase() && (this.readFormat = new OpenLayers.Format.GeoJSON))
    },
    CLASS_NAME: "OpenLayers.Protocol.WFS.v1_1_0"
}),OpenLayers.Format.WMSCapabilities.v1_1_1 = OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1, {
    version: "1.1.1",
    readers: {
        wms: OpenLayers.Util.applyDefaults({
            SRS: function (e, t) {
                t.srs[this.getChildValue(e)] = !0
            }
        }, OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)
    },
    CLASS_NAME: "OpenLayers.Format.WMSCapabilities.v1_1_1"
}),OpenLayers.Format.WMSCapabilities.v1_1_1_WMSC = OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1_1, {
    version: "1.1.1",
    profile: "WMSC",
    readers: {
        wms: OpenLayers.Util.applyDefaults({
            VendorSpecificCapabilities: function (e, t) {
                t.vendorSpecific = {tileSets: []}, this.readChildNodes(e, t.vendorSpecific)
            }, TileSet: function (e, t) {
                var i = {srs: {}, bbox: {}, resolutions: []};
                this.readChildNodes(e, i), t.tileSets.push(i)
            }, Resolutions: function (e, t) {
                for (var i = this.getChildValue(e).split(" "), n = 0, s = i.length; s > n; n++)"" != i[n] && t.resolutions.push(parseFloat(i[n]))
            }, Width: function (e, t) {
                t.width = parseInt(this.getChildValue(e))
            }, Height: function (e, t) {
                t.height = parseInt(this.getChildValue(e))
            }, Layers: function (e, t) {
                t.layers = this.getChildValue(e)
            }, Styles: function (e, t) {
                t.styles = this.getChildValue(e)
            }
        }, OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.readers.wms)
    },
    CLASS_NAME: "OpenLayers.Format.WMSCapabilities.v1_1_1_WMSC"
}),OpenLayers.Format.WMSCapabilities.v1_1_0 = OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1, {
    version: "1.1.0",
    readers: {
        wms: OpenLayers.Util.applyDefaults({
            SRS: function (e, t) {
                for (var i = this.getChildValue(e).split(/ +/), n = 0, s = i.length; s > n; n++)t.srs[i[n]] = !0
            }
        }, OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)
    },
    CLASS_NAME: "OpenLayers.Format.WMSCapabilities.v1_1_0"
}),OpenLayers.Control.LayerSwitcher = OpenLayers.Class(OpenLayers.Control, {
    roundedCorner: !1,
    roundedCornerColor: "darkblue",
    layerStates: null,
    layersDiv: null,
    baseLayersDiv: null,
    baseLayers: null,
    dataLbl: null,
    dataLayersDiv: null,
    dataLayers: null,
    minimizeDiv: null,
    maximizeDiv: null,
    ascending: !0,
    initialize: function () {
        OpenLayers.Control.prototype.initialize.apply(this, arguments), this.layerStates = [], this.roundedCorner && OpenLayers.Console.warn("roundedCorner option is deprecated")
    },
    destroy: function () {
        this.clearLayersArray("base"), this.clearLayersArray("data"), this.map.events.un({
            buttonclick: this.onButtonClick,
            addlayer: this.redraw,
            changelayer: this.redraw,
            removelayer: this.redraw,
            changebaselayer: this.redraw,
            scope: this
        }), this.events.unregister("buttonclick", this, this.onButtonClick), OpenLayers.Control.prototype.destroy.apply(this, arguments)
    },
    setMap: function () {
        OpenLayers.Control.prototype.setMap.apply(this, arguments), this.map.events.on({
            addlayer: this.redraw,
            changelayer: this.redraw,
            removelayer: this.redraw,
            changebaselayer: this.redraw,
            scope: this
        }), this.outsideViewport ? (this.events.attachToElement(this.div), this.events.register("buttonclick", this, this.onButtonClick)) : this.map.events.register("buttonclick", this, this.onButtonClick)
    },
    draw: function () {
        return OpenLayers.Control.prototype.draw.apply(this), this.loadContents(), this.outsideViewport || this.minimizeControl(), this.redraw(), this.div
    },
    onButtonClick: function (e) {
        e = e.buttonElement, e === this.minimizeDiv ? this.minimizeControl() : e === this.maximizeDiv ? this.maximizeControl() : e._layerSwitcher === this.id && (e["for"] && (e = document.getElementById(e["for"])), e.disabled || ("radio" == e.type ? (e.checked = !0, this.map.setBaseLayer(this.map.getLayer(e._layer))) : (e.checked = !e.checked, this.updateMap())))
    },
    clearLayersArray: function (e) {
        this[e + "LayersDiv"].innerHTML = "", this[e + "Layers"] = []
    },
    checkRedraw: function () {
        var e = !1;
        if (this.layerStates.length && this.map.layers.length == this.layerStates.length)for (var t = 0, i = this.layerStates.length; i > t; t++) {
            var n = this.layerStates[t], s = this.map.layers[t];
            if (n.name != s.name || n.inRange != s.inRange || n.id != s.id || n.visibility != s.visibility) {
                e = !0;
                break
            }
        } else e = !0;
        return e
    },
    redraw: function () {
        if (!this.checkRedraw())return this.div;
        this.clearLayersArray("base"), this.clearLayersArray("data");
        var e = !1, t = !1, i = this.map.layers.length;
        this.layerStates = Array(i);
        for (var n = 0; i > n; n++) {
            var s = this.map.layers[n];
            this.layerStates[n] = {name: s.name, visibility: s.visibility, inRange: s.inRange, id: s.id}
        }
        var r = this.map.layers.slice();
        for (this.ascending || r.reverse(), n = 0, i = r.length; i > n; n++) {
            var s = r[n], a = s.isBaseLayer;
            if (s.displayInLayerSwitcher) {
                a ? t = !0 : e = !0;
                var o = a ? s == this.map.baseLayer : s.getVisibility(), l = document.createElement("input");
                l.id = this.id + "_input_" + s.name, l.name = a ? this.id + "_baseLayers" : s.name, l.type = a ? "radio" : "checkbox", l.value = s.name, l.checked = o, l.defaultChecked = o, l.className = "olButton", l._layer = s.id, l._layerSwitcher = this.id, !a && !s.inRange && (l.disabled = !0), o = document.createElement("label"), o["for"] = l.id, OpenLayers.Element.addClass(o, "labelSpan olButton"), o._layer = s.id, o._layerSwitcher = this.id, !a && !s.inRange && (o.style.color = "gray"), o.innerHTML = s.name, o.style.verticalAlign = a ? "bottom" : "baseline";
                var h = document.createElement("br");
                (a ? this.baseLayers : this.dataLayers).push({
                    layer: s,
                    inputElem: l,
                    labelSpan: o
                }), s = a ? this.baseLayersDiv : this.dataLayersDiv, s.appendChild(l), s.appendChild(o), s.appendChild(h)
            }
        }
        return this.dataLbl.style.display = e ? "" : "none", this.baseLbl.style.display = t ? "" : "none", this.div
    },
    updateMap: function () {
        for (var e = 0, t = this.baseLayers.length; t > e; e++) {
            var i = this.baseLayers[e];
            i.inputElem.checked && this.map.setBaseLayer(i.layer, !1)
        }
        for (e = 0, t = this.dataLayers.length; t > e; e++)i = this.dataLayers[e], i.layer.setVisibility(i.inputElem.checked)
    },
    maximizeControl: function (e) {
        this.div.style.width = "", this.div.style.height = "", this.showControls(!1), null != e && OpenLayers.Event.stop(e)
    },
    minimizeControl: function (e) {
        this.div.style.width = "0px", this.div.style.height = "0px", this.showControls(!0), null != e && OpenLayers.Event.stop(e)
    },
    showControls: function (e) {
        this.maximizeDiv.style.display = e ? "" : "none", this.minimizeDiv.style.display = e ? "none" : "", this.layersDiv.style.display = e ? "none" : ""
    },
    loadContents: function () {
        this.layersDiv = document.createElement("div"), this.layersDiv.id = this.id + "_layersDiv", OpenLayers.Element.addClass(this.layersDiv, "layersDiv"), this.baseLbl = document.createElement("div"), this.baseLbl.innerHTML = OpenLayers.i18n("Base Layer"), OpenLayers.Element.addClass(this.baseLbl, "baseLbl"), this.baseLayersDiv = document.createElement("div"), OpenLayers.Element.addClass(this.baseLayersDiv, "baseLayersDiv"), this.dataLbl = document.createElement("div"), this.dataLbl.innerHTML = OpenLayers.i18n("Overlays"), OpenLayers.Element.addClass(this.dataLbl, "dataLbl"), this.dataLayersDiv = document.createElement("div"), OpenLayers.Element.addClass(this.dataLayersDiv, "dataLayersDiv"), this.ascending ? (this.layersDiv.appendChild(this.baseLbl), this.layersDiv.appendChild(this.baseLayersDiv), this.layersDiv.appendChild(this.dataLbl), this.layersDiv.appendChild(this.dataLayersDiv)) : (this.layersDiv.appendChild(this.dataLbl), this.layersDiv.appendChild(this.dataLayersDiv), this.layersDiv.appendChild(this.baseLbl), this.layersDiv.appendChild(this.baseLayersDiv)), this.div.appendChild(this.layersDiv), this.roundedCorner && (OpenLayers.Rico.Corner.round(this.div, {
            corners: "tl bl",
            bgColor: "transparent",
            color: this.roundedCornerColor,
            blend: !1
        }), OpenLayers.Rico.Corner.changeOpacity(this.layersDiv, .75));
        var e = OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");
        this.maximizeDiv = OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MaximizeDiv", null, null, e, "absolute"), OpenLayers.Element.addClass(this.maximizeDiv, "maximizeDiv olButton"), this.maximizeDiv.style.display = "none", this.div.appendChild(this.maximizeDiv), e = OpenLayers.Util.getImageLocation("layer-switcher-minimize.png"), this.minimizeDiv = OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MinimizeDiv", null, null, e, "absolute"), OpenLayers.Element.addClass(this.minimizeDiv, "minimizeDiv olButton"), this.minimizeDiv.style.display = "none", this.div.appendChild(this.minimizeDiv)
    },
    CLASS_NAME: "OpenLayers.Control.LayerSwitcher"
}),OpenLayers.Format.Atom = OpenLayers.Class(OpenLayers.Format.XML, {
    namespaces: {
        atom: "http://www.w3.org/2005/Atom",
        georss: "http://www.georss.org/georss"
    }, feedTitle: "untitled", defaultEntryTitle: "untitled", gmlParser: null, xy: !1, read: function (e) {
        return "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e])), this.parseFeatures(e)
    }, write: function (e) {
        var t;
        if (OpenLayers.Util.isArray(e)) {
            t = this.createElementNSPlus("atom:feed"), t.appendChild(this.createElementNSPlus("atom:title", {value: this.feedTitle}));
            for (var i = 0, n = e.length; n > i; i++)t.appendChild(this.buildEntryNode(e[i]))
        } else t = this.buildEntryNode(e);
        return OpenLayers.Format.XML.prototype.write.apply(this, [t])
    }, buildContentNode: function (e) {
        var t = this.createElementNSPlus("atom:content", {attributes: {type: e.type || null}});
        if (e.src) t.setAttribute("src", e.src); else if ("text" == e.type || null == e.type) t.appendChild(this.createTextNode(e.value)); else if ("html" == e.type) {
            if ("string" != typeof e.value)throw"HTML content must be in form of an escaped string";
            t.appendChild(this.createTextNode(e.value))
        } else"xhtml" == e.type ? t.appendChild(e.value) : "xhtml" == e.type || e.type.match(/(\+|\/)xml$/) ? t.appendChild(e.value) : t.appendChild(this.createTextNode(e.value));
        return t
    }, buildEntryNode: function (e) {
        var t = e.attributes, i = t.atom || {}, n = this.createElementNSPlus("atom:entry");
        if (i.authors)for (var s = OpenLayers.Util.isArray(i.authors) ? i.authors : [i.authors], r = 0, a = s.length; a > r; r++)n.appendChild(this.buildPersonConstructNode("author", s[r]));
        if (i.categories)for (var o, s = OpenLayers.Util.isArray(i.categories) ? i.categories : [i.categories], r = 0, a = s.length; a > r; r++)o = s[r], n.appendChild(this.createElementNSPlus("atom:category", {
            attributes: {
                term: o.term,
                scheme: o.scheme || null,
                label: o.label || null
            }
        }));
        if (i.content && n.appendChild(this.buildContentNode(i.content)), i.contributors)for (s = OpenLayers.Util.isArray(i.contributors) ? i.contributors : [i.contributors], r = 0, a = s.length; a > r; r++)n.appendChild(this.buildPersonConstructNode("contributor", s[r]));
        if (e.fid && n.appendChild(this.createElementNSPlus("atom:id", {value: e.fid})), i.links)for (s = OpenLayers.Util.isArray(i.links) ? i.links : [i.links], r = 0, a = s.length; a > r; r++)o = s[r], n.appendChild(this.createElementNSPlus("atom:link", {
            attributes: {
                href: o.href,
                rel: o.rel || null,
                type: o.type || null,
                hreflang: o.hreflang || null,
                title: o.title || null,
                length: o.length || null
            }
        }));
        return i.published && n.appendChild(this.createElementNSPlus("atom:published", {value: i.published})), i.rights && n.appendChild(this.createElementNSPlus("atom:rights", {value: i.rights})), (i.summary || t.description) && n.appendChild(this.createElementNSPlus("atom:summary", {value: i.summary || t.description})), n.appendChild(this.createElementNSPlus("atom:title", {value: i.title || t.title || this.defaultEntryTitle})), i.updated && n.appendChild(this.createElementNSPlus("atom:updated", {value: i.updated})), e.geometry && (t = this.createElementNSPlus("georss:where"), t.appendChild(this.buildGeometryNode(e.geometry)), n.appendChild(t)), n
    }, initGmlParser: function () {
        this.gmlParser = new OpenLayers.Format.GML.v3({
            xy: this.xy,
            featureNS: "http://example.com#feature",
            internalProjection: this.internalProjection,
            externalProjection: this.externalProjection
        })
    }, buildGeometryNode: function (e) {
        return this.gmlParser || this.initGmlParser(), this.gmlParser.writeNode("feature:_geometry", e).firstChild
    }, buildPersonConstructNode: function (e, t) {
        var i = ["uri", "email"], n = this.createElementNSPlus("atom:" + e);
        n.appendChild(this.createElementNSPlus("atom:name", {value: t.name}));
        for (var s = 0, r = i.length; r > s; s++)t[i[s]] && n.appendChild(this.createElementNSPlus("atom:" + i[s], {value: t[i[s]]}));
        return n
    }, getFirstChildValue: function (e, t, i, n) {
        return (e = this.getElementsByTagNameNS(e, t, i)) && 0 < e.length ? this.getChildValue(e[0], n) : n
    }, parseFeature: function (e) {
        var t = {}, i = null, n = null, s = null, r = this.namespaces.atom;
        this.parsePersonConstructs(e, "author", t), n = this.getElementsByTagNameNS(e, r, "category"), 0 < n.length && (t.categories = []);
        for (var a = 0, o = n.length; o > a; a++)i = {}, i.term = n[a].getAttribute("term"), (s = n[a].getAttribute("scheme")) && (i.scheme = s), (s = n[a].getAttribute("label")) && (i.label = s), t.categories.push(i);
        n = this.getElementsByTagNameNS(e, r, "content"), 0 < n.length && (i = {}, (s = n[0].getAttribute("type")) && (i.type = s), (s = n[0].getAttribute("src")) ? i.src = s : (i.value = "text" == i.type || "html" == i.type || null == i.type ? this.getFirstChildValue(e, r, "content", null) : "xhtml" == i.type || i.type.match(/(\+|\/)xml$/) ? this.getChildEl(n[0]) : this.getFirstChildValue(e, r, "content", null), t.content = i)), this.parsePersonConstructs(e, "contributor", t), t.id = this.getFirstChildValue(e, r, "id", null), n = this.getElementsByTagNameNS(e, r, "link"), 0 < n.length && (t.links = Array(n.length));
        for (var l = ["rel", "type", "hreflang", "title", "length"], a = 0, o = n.length; o > a; a++) {
            i = {}, i.href = n[a].getAttribute("href");
            for (var h = 0, u = l.length; u > h; h++)(s = n[a].getAttribute(l[h])) && (i[l[h]] = s);
            t.links[a] = i
        }
        return (i = this.getFirstChildValue(e, r, "published", null)) && (t.published = i), (i = this.getFirstChildValue(e, r, "rights", null)) && (t.rights = i), (i = this.getFirstChildValue(e, r, "summary", null)) && (t.summary = i), t.title = this.getFirstChildValue(e, r, "title", null), t.updated = this.getFirstChildValue(e, r, "updated", null), i = {
            title: t.title,
            description: t.summary,
            atom: t
        }, e = this.parseLocations(e)[0], e = new OpenLayers.Feature.Vector(e, i), e.fid = t.id, e
    }, parseFeatures: function (e) {
        var t = [], i = this.getElementsByTagNameNS(e, this.namespaces.atom, "entry");
        0 == i.length && (i = [e]);
        for (var e = 0, n = i.length; n > e; e++)t.push(this.parseFeature(i[e]));
        return t
    }, parseLocations: function (e) {
        var t = this.namespaces.georss, i = {components: []}, n = this.getElementsByTagNameNS(e, t, "where");
        if (n && 0 < n.length) {
            this.gmlParser || this.initGmlParser();
            for (var s = 0, r = n.length; r > s; s++)this.gmlParser.readChildNodes(n[s], i)
        }
        if (i = i.components, (n = this.getElementsByTagNameNS(e, t, "point")) && 0 < n.length)for (s = 0, r = n.length; r > s; s++) {
            var a = OpenLayers.String.trim(n[s].firstChild.nodeValue).split(/\s+/);
            2 != a.length && (a = OpenLayers.String.trim(n[s].firstChild.nodeValue).split(/\s*,\s*/)), i.push(new OpenLayers.Geometry.Point(a[1], a[0]))
        }
        var o = this.getElementsByTagNameNS(e, t, "line");
        if (o && 0 < o.length)for (var l, s = 0, r = o.length; r > s; s++) {
            n = OpenLayers.String.trim(o[s].firstChild.nodeValue).split(/\s+/), l = [];
            for (var h = 0, u = n.length; u > h; h += 2)a = new OpenLayers.Geometry.Point(n[h + 1], n[h]), l.push(a);
            i.push(new OpenLayers.Geometry.LineString(l))
        }
        if ((e = this.getElementsByTagNameNS(e, t, "polygon")) && 0 < e.length)for (s = 0, r = e.length; r > s; s++) {
            for (n = OpenLayers.String.trim(e[s].firstChild.nodeValue).split(/\s+/), l = [], h = 0, u = n.length; u > h; h += 2)a = new OpenLayers.Geometry.Point(n[h + 1], n[h]), l.push(a);
            i.push(new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(i)]))
        }
        if (this.internalProjection && this.externalProjection)for (s = 0, r = i.length; r > s; s++)i[s] && i[s].transform(this.externalProjection, this.internalProjection);
        return i
    }, parsePersonConstructs: function (e, t, i) {
        for (var n = [], s = this.namespaces.atom, e = this.getElementsByTagNameNS(e, s, t), r = ["uri", "email"], a = 0, o = e.length; o > a; a++) {
            var l = {};
            l.name = this.getFirstChildValue(e[a], s, "name", null);
            for (var h = 0, u = r.length; u > h; h++) {
                var c = this.getFirstChildValue(e[a], s, r[h], null);
                c && (l[r[h]] = c)
            }
            n.push(l)
        }
        0 < n.length && (i[t + "s"] = n)
    }, CLASS_NAME: "OpenLayers.Format.Atom"
}),OpenLayers.Control.KeyboardDefaults = OpenLayers.Class(OpenLayers.Control, {
    autoActivate: !0,
    slideFactor: 75,
    observeElement: null,
    draw: function () {
        this.handler = new OpenLayers.Handler.Keyboard(this, {keydown: this.defaultKeyPress}, {observeElement: this.observeElement || document})
    },
    defaultKeyPress: function (e) {
        var t, i = !0;
        switch (e.keyCode) {
            case OpenLayers.Event.KEY_LEFT:
                this.map.pan(-this.slideFactor, 0);
                break;
            case OpenLayers.Event.KEY_RIGHT:
                this.map.pan(this.slideFactor, 0);
                break;
            case OpenLayers.Event.KEY_UP:
                this.map.pan(0, -this.slideFactor);
                break;
            case OpenLayers.Event.KEY_DOWN:
                this.map.pan(0, this.slideFactor);
                break;
            case 33:
                t = this.map.getSize(), this.map.pan(0, -.75 * t.h);
                break;
            case 34:
                t = this.map.getSize(), this.map.pan(0, .75 * t.h);
                break;
            case 35:
                t = this.map.getSize(), this.map.pan(.75 * t.w, 0);
                break;
            case 36:
                t = this.map.getSize(), this.map.pan(-.75 * t.w, 0);
                break;
            case 43:
            case 61:
            case 187:
            case 107:
                this.map.zoomIn();
                break;
            case 45:
            case 109:
            case 189:
            case 95:
                this.map.zoomOut();
                break;
            default:
                i = !1
        }
        i && OpenLayers.Event.stop(e)
    },
    CLASS_NAME: "OpenLayers.Control.KeyboardDefaults"
}),OpenLayers.Format.WMTSCapabilities.v1_0_0 = OpenLayers.Class(OpenLayers.Format.OWSCommon.v1_1_0, {
    version: "1.0.0",
    namespaces: {
        ows: "http://www.opengis.net/ows/1.1",
        wmts: "http://www.opengis.net/wmts/1.0",
        xlink: "http://www.w3.org/1999/xlink"
    },
    yx: null,
    defaultPrefix: "wmts",
    initialize: function (e) {
        OpenLayers.Format.XML.prototype.initialize.apply(this, [e]), this.options = e, e = OpenLayers.Util.extend({}, OpenLayers.Format.WMTSCapabilities.prototype.yx), this.yx = OpenLayers.Util.extend(e, this.yx)
    },
    read: function (e) {
        "string" == typeof e && (e = OpenLayers.Format.XML.prototype.read.apply(this, [e])), e && 9 == e.nodeType && (e = e.documentElement);
        var t = {};
        return this.readNode(e, t), t.version = this.version, t
    },
    readers: {
        wmts: {
            Capabilities: function (e, t) {
                this.readChildNodes(e, t)
            }, Contents: function (e, t) {
                t.contents = {}, t.contents.layers = [], t.contents.tileMatrixSets = {}, this.readChildNodes(e, t.contents)
            }, Layer: function (e, t) {
                var i = {styles: [], formats: [], dimensions: [], tileMatrixSetLinks: [], layers: []};
                this.readChildNodes(e, i), t.layers.push(i)
            }, Style: function (e, t) {
                var i = {};
                i.isDefault = "true" === e.getAttribute("isDefault"), this.readChildNodes(e, i), t.styles.push(i)
            }, Format: function (e, t) {
                t.formats.push(this.getChildValue(e))
            }, TileMatrixSetLink: function (e, t) {
                var i = {};
                this.readChildNodes(e, i), t.tileMatrixSetLinks.push(i)
            }, TileMatrixSet: function (e, t) {
                if (t.layers) {
                    var i = {matrixIds: []};
                    this.readChildNodes(e, i), t.tileMatrixSets[i.identifier] = i
                } else t.tileMatrixSet = this.getChildValue(e)
            }, TileMatrix: function (e, t) {
                var i = {supportedCRS: t.supportedCRS};
                this.readChildNodes(e, i), t.matrixIds.push(i)
            }, ScaleDenominator: function (e, t) {
                t.scaleDenominator = parseFloat(this.getChildValue(e))
            }, TopLeftCorner: function (e, t) {
                var i, n = this.getChildValue(e).split(" ");
                t.supportedCRS && (i = !!this.yx[t.supportedCRS.replace(/urn:ogc:def:crs:(\w+):.+:(\w+)$/, "urn:ogc:def:crs:$1::$2")]), t.topLeftCorner = i ? new OpenLayers.LonLat(n[1], n[0]) : new OpenLayers.LonLat(n[0], n[1])
            }, TileWidth: function (e, t) {
                t.tileWidth = parseInt(this.getChildValue(e))
            }, TileHeight: function (e, t) {
                t.tileHeight = parseInt(this.getChildValue(e))
            }, MatrixWidth: function (e, t) {
                t.matrixWidth = parseInt(this.getChildValue(e))
            }, MatrixHeight: function (e, t) {
                t.matrixHeight = parseInt(this.getChildValue(e))
            }, ResourceURL: function (e, t) {
                t.resourceUrl = t.resourceUrl || {}, t.resourceUrl[e.getAttribute("resourceType")] = {
                    format: e.getAttribute("format"),
                    template: e.getAttribute("template")
                }
            }, WSDL: function (e, t) {
                t.wsdl = {}, t.wsdl.href = e.getAttribute("xlink:href")
            }, ServiceMetadataURL: function (e, t) {
                t.serviceMetadataUrl = {}, t.serviceMetadataUrl.href = e.getAttribute("xlink:href")
            }, LegendURL: function (e, t) {
                t.legend = {}, t.legend.href = e.getAttribute("xlink:href"), t.legend.format = e.getAttribute("format")
            }, Dimension: function (e, t) {
                var i = {values: []};
                this.readChildNodes(e, i), t.dimensions.push(i)
            }, Default: function (e, t) {
                t["default"] = this.getChildValue(e)
            }, Value: function (e, t) {
                t.values.push(this.getChildValue(e))
            }
        }, ows: OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows
    },
    CLASS_NAME: "OpenLayers.Format.WMTSCapabilities.v1_0_0"
});
var Nao = Nao ? Nao : {};
Nao.Beacons = function (e) {
    function t(e, t, n, s) {
        var r = {
            onPSButtonClicked: function () {
                (self.btnAdd.isPressed || self.btnMove.isPressed) && self.lastBtn.reset(), e.setControl("select"), e.toggleMultiselectBox(self.btnBox.isPressed)
            }
        }, a = {
            onPSButtonClicked: function () {
                self.btnAdd.isPressed ? (self.btnBox.reset(), e.removeAllPopups(), e.setControl("point"), e.controls.hiddenselect.unselectAll(), e.site.psMap.setMapInstructions("Click to add a beacon"), self.lastBtn && self.lastBtn != self.btnAdd && self.lastBtn.reset(), self.btnNumber.reset(), self.lastBtn = self.btnAdd) : e.setControl("select")
            }
        }, o = {
            onPSButtonClicked: function () {
                self.btnMove.isPressed ? (self.btnBox.reset(), e.removeAllPopups(), e.setControl("drag"), e.controls.hiddenselect.unselectAll(), e.site.psMap.setMapInstructions("Grab and move a beacon"), self.lastBtn && self.lastBtn != self.btnMove && self.lastBtn.reset(), self.btnNumber.reset(), self.lastBtn = self.btnMove) : e.setControl("select")
            }
        }, l = {
            onPSButtonClicked: function () {
                if (0 == t.currentSelectedModels.length) e.setControl("select"), e.toggleMultiselectBox(self.btnBox.isPressed), e.site.psMap.setMapInstructions("No beacons are selected for deletion"); else {
                    var n = function () {
                        return confirm("Delete the selected beacons ?")
                    };
                    if (n()) {
                        var s = t.currentSelectedModels.length;
                        for (i = 0; s > i; i++)beacon = t.currentSelectedModels[0], e.trigger("removed", beacon), beacon.erase()
                    }
                }
                self.lastBtn && self.lastBtn != self.btnErase && self.lastBtn.reset(), self.btnErase.reset(), self.lastBtn = null
            }
        }, h = {
            onPSButtonClicked: function () {
                (self.btnAdd.isPressed || self.btnMove.isPressed) && (e.setControl("select"), self.lastBtn.reset()), e.setIdPopupsEnabled(self.btnNumber.isPressed)
            }
        }, u = {
            onPSButtonClicked: function () {
                e.setRadiusEnabled(self.btnRadius.isPressed)
            }
        }, c = {
            onPSButtonClicked: function () {
                if (0 == t.currentSelectedModels.length) e.setControl("select"), e.toggleMultiselectBox(self.btnBox.isPressed), e.site.psMap.setMapInstructions("Select a single beacon to display its label (barcode)"); else {
                    var i = t.getSingleSelectedModel();
                    if (i) {
                        var n;
                        self.beacons.some(function (e) {
                            return n = e.id, e.number == i.id
                        }), $("#beacon-data-number").val(i.getId()), $("#beacon-data-label").val(i.getLabel()), $("#beacon-data-coordinates").html(i.lon() + " / " + i.lat()), $("#beacon-data-comment").val(i.comment), $("#beacon-data-tags").html(i.getTags()), $("#btn-tag-edit").show(), $("#beacon-data-dialog").modal()
                    }
                }
                self.lastBtn && self.lastBtn != self.btnLabel && self.lastBtn.reset(), self.btnLabel.reset(), self.lastBtn = self.btnLabel
            }
        }, p = {
            onPSButtonClicked: function () {
                nb_beacons_per_alt = {};
                for (var e in n) {
                    var t = n[e].alt;
                    nb_beacons_per_alt[t] ? nb_beacons_per_alt[t] += 1 : nb_beacons_per_alt[t] = 1
                }
                var i = "";
                for (var t in nb_beacons_per_alt) {
                    var s = find_floor_by_lonlatalt(null, null, t);
                    i += '<li class="list-group-item">Level ' + s.level_number + ' <span class="beacon_alt"><input type="text" class="beacon_alt_new" value="' + t + '"><i class="beacon_alt_old hidden">' + t + '</i></span> <i class="badge">' + nb_beacons_per_alt[t] + "</i></li>"
                }
                $("#beacon-analytics-body ul").html(i), $("#beacon-analytics-dialog").modal(), self.lastBtn && self.lastBtn != self.btnLevel && self.lastBtn.reset(), self.btnLevel.reset(), self.lastBtn = self.btnLevel
            }
        }, d = {
            onPSButtonClicked: function () {
                e.setControl("measureTool"), e.site.psMap.setMapInstructions("Click on 2 points to measure their distance"), self.lastBtn && self.lastBtn != self.btnMeasure && self.lastBtn.reset(), self.btnMeasure.reset(), self.lastBtn = self.btnMeasure
            }
        }, f = new PSButtonPanel("custom-tools");
        self.btnBox = new PSFAButton({
            iconId: "fa fa-square-o",
            title: "Box selection",
            listeners: [r]
        }), self.btnAdd = new PSFAButton({
            iconId: "fa fa-plus",
            title: "Add beacon",
            listeners: [a]
        }), self.btnMove = new PSFAButton({
            iconId: "fa fa-arrows",
            title: "Move selected beacon, White-Space to toggle radius",
            listeners: [o]
        }), self.btnErase = new PSFAButton({
            iconId: "fa fa-trash-o",
            title: "Delete selected beacon",
            listeners: [l]
        }), self.btnNumber = new PSFAButton({
            iconId: "fa fa-tag",
            title: "Display ID of all beacons",
            listeners: [h]
        }), self.btnRadius = new PSFAButton({
            iconId: "fa-circle-o",
            title: "Toggle beacon radius",
            listeners: [u]
        }), self.btnLabel = new PSFAButton({
            iconId: "fa fa-barcode",
            title: "Edit metadata of selected beacon",
            listeners: [c]
        }), self.btnLevel = new PSFAButton({
            iconId: "fa-bar-chart-o",
            title: "Number of beacons per level",
            listeners: [p]
        }), self.btnMeasure = new PSFAButton({
            iconId: "fa-arrows-h",
            title: "Measure distance between 2 points",
            listeners: [d]
        }), f.buttons = [self.btnBox, self.btnAdd, self.btnMove, self.btnErase, self.btnNumber, self.btnRadius, self.btnLabel, self.btnLevel, self.btnMeasure], f.addTo("map_zone_header"), e.actionPanel = f, self.lastBtn = self.btnAdd, $("#beacon-analytics-dialog-save").click(function () {
            var t = $(".beacon_alt"), i = t.find(".beacon_alt_new").map(function () {
                return parseFloat(this.value)
            }), n = t.find(".beacon_alt_old").map(function () {
                return parseFloat($(this).html())
            });
            e.setBeaconAltitudes(n, i), $("#beacon-analytics-dialog").modal("hide")
        }), $("#beacon-data-dialog-save").click(function () {
            var e = n[parseFloat($("#beacon-data-number").val())];
            e && (e.setLabel($("#beacon-data-label").val()), e.comment = $("#beacon-data-comment").val()), e.trigger("data_updated"), $("#beacon-data-dialog").modal("hide")
        }), $("#btn-tag-edit").click(function () {
            var e, t = $("#beacon-data-number").val(), i = self.beacons.some(function (i) {
                return e = i.id, i.number == t
            });
            i ? ($.get("/tags?site_id=" + s.id + "&tagged_type=PhysicalBeacon&tagged_id=" + e, function (e) {
                $("#beacon-data-tags").html(e)
            }), $("#beacon-data-tags").html('<div class="spinner bounce-spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>')) : $("#beacon-data-tags").html('<span class="text-danger">Please save the beacons and reload the page to assign tags to this beacon</span>'), $("#btn-tag-edit").hide()
        })
    }

    return e.BeaconsToolbar = t, e
}(Nao.Beacons || {});
var Nao = Nao ? Nao : {};
Nao.Beacons = function (e) {
    function t(e, t) {
        e.setStatusType = function (i) {
            e.currentStatusType = i, e.loadFilterAndTitlesForStatusType(i);
            var n = $("#dt-states-filter"), s = '<div class="button-group"><button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="fa fa-filter"></span></button><ul class="dropdown-menu dropdown-menu-right">';
            t.concat(["<empty>"]).forEach(function (e) {
                s += '<div class="dt-state checkbox checkbox-circle checkbox-default"><input type="checkbox" id="model-state-' + e + '" name="' + e + '" value="unknown" checked>', s += '<label for="model-state-' + e + '">' + e + "</label></div>"
            }), s += "</ul></div>", $(".dt-state", n).detach(), n.html(s), $("#mt-title").html(i.titleHtml), e._onStatusTypeSourceChanged(i.source, i.states), $("input", n).on("change", function () {
                var t = $("input[type=checkbox]:checked", n);
                self.values = $.map(t, function (e) {
                    return $(e).attr("name")
                });
                var i = [];
                $.each(e.dataToDisplay, function (t, n) {
                    var s = n[n.length - 1], r = e.extraData[s].model, a = !1;
                    a = r.tags.some(function (e) {
                        return -1 != self.values.indexOf(e)
                    }), 0 == r.tags.length && -1 != self.values.indexOf("<empty>") && (a = !0), a && i.push(r)
                }), e._onModelsFiltered(i)
            })
        }
    }

    return e.TagsFilter = t, e
}(Nao.Beacons || {});
var changelogsController = null, ChangelogsController = function () {
    var e = this, t = $("<div>").attr("class", "changelog-popup");
    this.processData = function (i) {
        jQuery.each(i, function (t, i) {
            var n = i.id;
            e.shouldBeDisplayed(n) && e.displayChangelog(i)
        }), $("#changelog-popups").append(t), t.effect("shake")
    }, this.onChangelogClosed = function (e) {
        $("#changelog-" + e).remove();
        var t = "displayed_changelog_" + e;
        createCookie(t, !0, 30)
    }, this.shouldBeDisplayed = function (e) {
        return !readCookie("displayed_changelog_" + e)
    }, this.displayChangelog = function (e) {
        var i = e.changelog_type, n = e.name, s = e.description, r = e.image_direct_url, a = $("<div>").attr({
            id: "changelog-" + e.id,
            "class": "alert alert-warning"
        }), o = '<button type="button" class="close" data-dismiss="alert" onclick="changelogsController.onChangelogClosed(' + e.id + ')">Got it!</button>', l = $("<p>").html('<i class="badge badge-warning">' + i + "</i>");
        l.append($("<h2>").html(n)), l.append(o), a.append(l);
        var h = $("<p>").text(s);
        if (a.append(h), r) {
            var u = $("<img>").attr({src: r, alt: "Image tutoriel", "class": "changelog-img"});
            a.append(u)
        }
        t.append(a)
    }
};
DistanceMeasureController = OpenLayers.Class(OpenLayers.Control, {
    initialize: function (e) {
        currentFloor && (OpenLayers.Control.prototype.initialize.apply(this, []), this.reinit(), this.listener = e)
    }, reinit: function () {
        this.deactivate(), currentFloor.measureLayer || (currentFloor.measureLayer = new OpenLayers.Layer.Vector("MeasureLayer" + currentFloor.id), site.map.addLayers([currentFloor.measureLayer])), this.layer = currentFloor.measureLayer, this.handlers = {
            hover: new OpenLayers.Handler.Hover(this, {move: this.onMouseMove}),
            draw: new OpenLayers.Handler.Point(this, {done: this.onNewPoint}),
            keyboard: new OpenLayers.Handler.Keyboard(this, {keydown: this.onKeyDown})
        }, site.map.addControl(this), this.activate()
    }, setMap: function (e) {
        this.handlers.draw.setMap(e), this.handlers.hover.setMap(e), OpenLayers.Control.prototype.setMap.apply(this, arguments)
    }, activate: function () {
        return this.handlers.hover.activate() && this.handlers.draw.activate() && this.handlers.keyboard.activate() && OpenLayers.Control.prototype.activate.apply(this, arguments)
    }, deactivate: function () {
        return null != this.feature && this.layer && this.layer.removeFeatures([this.feature, this.lastPointFeature]), this.handlers && (this.handlers.hover.deactivate(), this.handlers.draw.deactivate(), this.handlers.keyboard.deactivate()), this.lastPoint = null, this.feature = null, OpenLayers.Control.prototype.deactivate.apply(this, arguments)
    }, onMouseMove: function (e) {
        var t = this.map.getLonLatFromViewPortPx(e.xy);
        if (null != this.lastPoint) {
            this.feature && this.layer.removeFeatures([this.feature, this.lastPointFeature]);
            var i = new OpenLayers.LonLat(this.lastPoint.x, this.lastPoint.y), n = "blue";
            this.feature = createDotLine(t, i, n), this.layer.addFeatures([this.feature, this.lastPointFeature]);
            var s = new OpenLayers.Geometry.LineString([this.lastPoint, new OpenLayers.Geometry.Point(t.lon, t.lat)]), r = s.getGeodesicLength(new OpenLayers.Projection("EPSG:900913"));
            this.listener && this.listener.onDistanceMeasuring(r)
        }
    }, onNewPoint: function (e) {
        if (null == this.lastPoint) this.lastPoint = e, this.lastPointFeature = new OpenLayers.Feature.Vector(e); else {
            var t = new OpenLayers.Geometry.LineString([this.lastPoint, e]), i = t.getGeodesicLength(new OpenLayers.Projection("EPSG:900913"));
            this.deactivate(), this.listener && this.listener.onDistanceMeasured(i)
        }
    }, onKeyDown: function (e) {
        switch (e.keyCode) {
            case 27:
                log("DistanceMeasureController ESC"), this.listener && this.listener.onDistanceMeasureCanceled(), this.deactivate()
        }
    }, CLASS_NAME: "DistanceMeasureController"
});
var Nao = Nao ? Nao : {};
Nao.Map = function (e) {
    function t(e, t, i) {
        var n = this;
        this.isRunning = !1, this.btn = new PSFAButton({
            iconId: "fa-arrows-h",
            title: "Measure distance between 2 points",
            listeners: [this]
        }), this.btn.addTo(e), this.control = new DistanceMeasureController({
            onDistanceMeasuring: function (e) {
                $("#" + t).html(e + " m")
            }, onDistanceMeasured: function () {
                n.reset()
            }, onDistanceMeasureCanceled: function () {
                n.reset()
            }
        }), this.onPSButtonClicked = function (e) {
            e == n.btn.id && (n.isRunning ? n.reset() : n.activateMeasureControl())
        }, this.reset = function () {
            n.oldContentInResultDomId ? $("#" + t).html(n.oldContentInResultDomId) : $("#" + t).html(i), n.control.deactivate(), n.btn.reset(), n.isRunning = !1
        }, this.activateMeasureControl = function () {
            n.oldContentInResultDomId = $("#" + t).html(), n.control.activate(), n.isRunning = !0
        }, this.reset()
    }

    return e.DistanceMeasureTool = t, e
}(Nao.Map || {});
var floorController = null, FloorController = OpenLayers.Class(OpenLayers.Control, {
    panel: null,
    buttons: [],
    displayedIndex: null,
    selectedIndex: null,
    nbFloors: null,
    floorsIdsSortedByLevel: [],
    initialize: function () {
        OpenLayers.Control.prototype.initialize.apply(this, {}), this.nbFloors = Object.keys(floors).length, this.isThereTooMuchFloorsToDisplay() ? (this.displayedIndex = 1, this.selectedIndex = 1) : (this.displayedIndex = 0, this.selectedIndex = 0), this.floorsIdsSortedByLevel = this.sortFloorsIds(floors)
    },
    sortFloorsIds: function (e) {
        var t = [];
        for (var i in e)"overview" != i && t.push([i, e[i].level_number]);
        return t.sort(function (e, t) {
            return e[1] - t[1]
        }), t.push(["overview", null]), t.map(function (e) {
            return e[0]
        })
    },
    draw: function () {
        var e = this;
        e.createButtons();
        for (var t in floors)e.addFloorListeners(floors[t]);
        e.panel = new OpenLayers.Control.Panel({
            displayClass: "floorSelectorPanel", createControlMarkup: function (e) {
                var t = document.createElement("div");
                return t.setAttribute("id", e.id), t.setAttribute("class", "btn btn-circle btn-raised btn-success btn-lg floorButton"), t.innerHTML = e.text, t
            }
        }), e.panel.addControls(e.buttons), e.map.addControl(e.panel), e.moveAndResizeFloorControllerPanelAccordingToMapSize(), e.bindMapResizingCallbacks()
    },
    isThereTooMuchFloorsToDisplay: function () {
        return this.nbFloors > this.MAX_DISPLAYED_BUTTON
    },
    floorIcon: function (e) {
        return "overview" == e.id ? this.SITE_OVERVIEW_ICON : e.level_number
    },
    floorText: function (e) {
        return "overview" == e.id ? "Map Overview" : e.name + " (" + e.altitude + "m)"
    },
    createButtons: function () {
        var e = this, t = 0, i = 0, n = e.nbFloors - 1;
        e.isThereTooMuchFloorsToDisplay() && (t = 1, i = e.displayedIndex, n = e.displayedIndex + (e.MAX_DISPLAYED_BUTTON - 2) - 1);
        for (var s = i; n >= s; s++) {
            var r = floors[e.floorsIdsSortedByLevel[s]], a = "floor-button-" + t;
            t++;
            var o = e.floorIcon(r), l = e.floorText(r), h = new OpenLayers.Control.Button({
                id: a,
                title: l,
                text: o,
                displayClass: "floor",
                trigger: e.onButtonTriggered.bind(e, a)
            });
            e.buttons.unshift(h)
        }
        e.isThereTooMuchFloorsToDisplay() && e.createTopAndBotButton()
    },
    minDisplayedIndex: function () {
        return 1
    },
    maxDisplayedIndex: function () {
        return this.nbFloors - (this.MAX_DISPLAYED_BUTTON - 2) - 1
    },
    createTopAndBotButton: function () {
        var e = this, t = "floor-button-" + (e.MAX_DISPLAYED_BUTTON - 1), i = null;
        e.displayedIndex == e.maxDisplayedIndex() ? (floors[e.floorsIdsSortedByLevel[e.floorsIdsSortedByLevel.length - 1]], i = new OpenLayers.Control.Button({
            id: t,
            title: e.floorText(r),
            text: e.floorIcon(r),
            displayClass: "floor",
            trigger: e.onButtonTriggered.bind(e, t)
        })) : i = new OpenLayers.Control.Button({
            id: t,
            title: "Slide upward",
            text: e.UP_BUTTON_ICON,
            displayClass: "floor",
            trigger: e.onButtonTriggered.bind(e, t)
        });
        var n = "floor-button-0", s = null;
        if (e.displayedIndex == e.minDisplayedIndex()) {
            var r = floors[e.floorsIdsSortedByLevel[0]];
            s = new OpenLayers.Control.Button({
                id: n,
                title: e.floorText(r),
                text: e.floorIcon(r),
                displayClass: "floor",
                trigger: e.onButtonTriggered.bind(e, n)
            })
        } else s = new OpenLayers.Control.Button({
            id: n,
            title: "Slide downward",
            text: e.DOWN_BUTTON_ICON,
            displayClass: "floor",
            trigger: e.onButtonTriggered.bind(e, n)
        });
        e.buttons.unshift(i), e.buttons.push(s)
    },
    transformToDownButton: function (e) {
        e.html(this.DOWN_BUTTON_ICON), e.attr("title", "Slide down")
    },
    transformToUpButton: function (e) {
        e.html(this.UP_BUTTON_ICON), e.attr("title", "Slide up")
    },
    transformToFloorButton: function (e, t) {
        t.html(this.floorIcon(e)), t.attr("title", this.floorText(e))
    },
    upButtonTriggered: function () {
        this.displayedIndex++, this.redrawFloorSelector(), this.selectFloor(this.selectedIndex)
    },
    downButtonTriggered: function () {
        this.displayedIndex--, this.redrawFloorSelector(), this.selectFloor(this.selectedIndex)
    },
    redrawFloorSelector: function () {
        this.redrawFirstButton(), this.redrawButtons(), this.redrawLastButton()
    },
    redrawButtons: function () {
        for (var e = $(".floorSelectorPanel"), t = 1, i = this.buttons.length - 2, n = this.displayedIndex, s = t; i >= s; s++) {
            var r = $("#floor-button-" + s, e), a = floors[this.floorsIdsSortedByLevel[n]];
            this.transformToFloorButton(a, r), n++
        }
    },
    redrawFirstButton: function () {
        var e = $(".floorSelectorPanel"), t = $("#floor-button-0", e);
        this.displayedIndex == this.minDisplayedIndex() ? (firstFloor = floors[this.floorsIdsSortedByLevel[0]], this.transformToFloorButton(firstFloor, t)) : t.html() != this.DOWN_BUTTON_ICON && this.transformToDownButton(t)
    },
    redrawLastButton: function () {
        var e = $(".floorSelectorPanel"), t = $("#floor-button-" + (this.buttons.length - 1), e);
        this.displayedIndex == this.maxDisplayedIndex() ? (lastFloor = floors[this.floorsIdsSortedByLevel[this.floorsIdsSortedByLevel.length - 1]], this.transformToFloorButton(lastFloor, t)) : t.html() != this.UP_BUTTON_ICON && this.transformToUpButton(t)
    },
    listeners: [],
    addFloorListeners: function (e) {
        var t = this;
        e.addListener({
            onFloorAboutToChange: function (e) {
                $.each(t.listeners, function (t, i) {
                    i.onFloorAboutToChange(e)
                })
            }, onFloorChanged: function (e) {
                $.each(t.listeners, function (t, i) {
                    i.onFloorChanged(e)
                }), t.isThereTooMuchFloorsToDisplay() && t.redrawFloorSelectorIfNecessary(e), t.selectFloor(t.displayedIndexFromFloor(e))
            }
        })
    },
    addListener: function (e) {
        this.listeners.push(e)
    },
    removeListener: function (e) {
        this.listeners.slice(e)
    },
    selectFloor: function (e) {
        var t = $(".floorSelectorPanel"), i = $(".selectedFloorButton", t);
        i.removeClass("selectedFloorButton");
        var n = 0;
        n = this.isThereTooMuchFloorsToDisplay() ? e - this.displayedIndex + 1 : e - this.displayedIndex, 0 > n ? n = 0 : n > this.buttons.length - 1 && (n = this.buttons.length - 1);
        var s = $("#floor-button-" + n, t);
        s.hasClass("selectedFloorButton") || s.addClass("selectedFloorButton"), this.selectedIndex = e
    },
    redrawFloorSelectorIfNecessary: function (e) {
        var t = this.displayedIndexFromFloor(e);
        null !== t && this.needToSlide(t) && (this.displayedIndex = t < this.minDisplayedIndex() ? this.minDisplayedIndex() : t > this.maxDisplayedIndex() ? this.maxDisplayedIndex() : t, this.redrawFloorSelector())
    },
    displayedIndexFromFloor: function (e) {
        for (var t = 0, i = !1; !i && t <= this.floorsIdsSortedByLevel.length - 1;)e.id == this.floorsIdsSortedByLevel[t] ? i = !0 : t++;
        return i ? t : null
    },
    needToSlide: function (e) {
        return this.needToSlideDown(e) || this.needToSlideUp(e)
    },
    needToSlideDown: function (e) {
        return e < this.displayedIndex && this.displayedIndex > this.minDisplayedIndex()
    },
    needToSlideUp: function (e) {
        return e > this.displayedIndex + (this.MAX_DISPLAYED_BUTTON - 2) && this.displayedIndex < this.maxDisplayedIndex()
    },
    onButtonTriggered: function (e) {
        var t = $(".floorSelectorPanel #" + e).html();
        t == this.UP_BUTTON_ICON ? this.upButtonTriggered() : t == this.DOWN_BUTTON_ICON ? this.downButtonTriggered() : this.floorButtonTriggered(e)
    },
    floorButtonTriggered: function (e) {
        var t = $(".floorSelectorPanel #" + e).html(), i = floors.overview;
        if (t !== self.SITE_OVERVIEW_ICON)for (var n in floors)if (floors[n].level_number == t) {
            i = floors[n];
            break
        }
        i.setAsCurrent()
    },
    onMapResized: function () {
        this.moveAndResizeFloorControllerPanelAccordingToMapSize()
    },
    moveAndResizeFloorControllerPanelAccordingToMapSize: function () {
        var e = this.map.getCurrentSize(), t = this.panel.controls.length, i = t * this.button_total_height();
        i > e.h * this.PANEL_MAX_HEIGHT_OF_HEIGHT_MAP && (i = e.h * this.PANEL_MAX_HEIGHT_OF_HEIGHT_MAP);
        var n = e.w * this.PANEL_MARGIN_RIGHT_PERCENT_OF_WIDTH_MAP, s = e.w - this.PANEL_WIDTH - n, r = e.h / 2 - i / 2;
        this.panel.moveTo(new OpenLayers.Pixel(s, r)), $(this.panel.div).height(i)
    },
    bindMapResizingCallbacks: function () {
        $(window).resize(this.moveAndResizeFloorControllerPanelAccordingToMapSize.bind(this))
    },
    MAX_DISPLAYED_BUTTON: 8,
    PANEL_MAX_HEIGHT_OF_HEIGHT_MAP: .95,
    PANEL_MARGIN_RIGHT_PERCENT_OF_WIDTH_MAP: .04,
    PANEL_WIDTH: 70,
    BUTTON_HEIGHT: 45,
    BUTTON_MARGIN: 8,
    SITE_OVERVIEW_ICON: '<i class="fa fa-map-o"></i>',
    UP_BUTTON_ICON: '<i class="glyphicon glyphicon-chevron-up"></i>',
    DOWN_BUTTON_ICON: '<i class="glyphicon glyphicon-chevron-down"></i>',
    button_total_height: function () {
        return this.BUTTON_HEIGHT + this.BUTTON_MARGIN
    },
    CLASS_NAME: "OpenLayers.FloorControl"
}), georefManager, graphController = null;
GraphController = OpenLayers.Class(OpenLayers.Control, {
    hoveredFeature: null,
    draggedFeature: null,
    lastNode: null,
    lastPixel: null,
    isDrawingTransition: !1,
    actionPanel: null,
    opacitySlider: null,
    documentDrag: !1,
    listeners: [],
    initialize: function (e) {
        currentFloor && (OpenLayers.Control.prototype.initialize.apply(this, []), this.addActionPanel(e), this.reinit())
    },
    addListener: function (e) {
        this.listeners.push(e)
    },
    notifyListeners: function (e) {
        this.listeners.forEach(function (t) {
            t.onFloorModified(e)
        })
    },
    addActionPanel: function (e) {
        this.actionPanel = new PSButtonPanel("graph-drawing"), this.measure = new PSFAButton({
            iconId: "fa-arrows-h",
            title: "Measure distance between 2 points",
            listeners: [this]
        }), this.resetButton = new PSFAButton({
            iconId: "fa-undo",
            title: "Cancel All Changes",
            listeners: [this]
        }), this.deleteGraphOnFloorBtn = new PSFAButton({
            iconId: "fa-trash-o",
            title: "Delete walkways on current floor",
            listeners: [this]
        }), this.opacitySlider = new PSSlider({
            text: "Opacity",
            value: 1,
            listeners: [this]
        }), this.actionPanel.buttons = [this.resetButton, this.measure, this.deleteGraphOnFloorBtn, this.opacitySlider], this.actionPanel.addTo(e)
    },
    activate_measure_tool: function () {
        this.deactivate();
        var e = new DistanceMeasureController(this);
        e.activate()
    },
    onDistanceMeasuring: function (e) {
        this.actionPanel.setStatus(e + " m")
    },
    onDistanceMeasured: function () {
        this.activate(), this.actionPanel.setStatus("")
    },
    onDistanceMeasureCanceled: function () {
        this.activate(), this.actionPanel.setStatus("")
    },
    onPSButtonClicked: function (e) {
        switch (e) {
            case this.measure.id:
                graphController.activate_measure_tool();
                break;
            case this.resetButton.id:
                site.graph.fromJson(original_graph);
                break;
            case this.deleteGraphOnFloorBtn.id:
                site.graph.deleteOnFloor(currentFloor)
        }
        return !1
    },
    onPSSliderChanged: function (e, t) {
        switch (e) {
            case this.opacitySlider.id:
                this.changeOpacity(t)
        }
        return !1
    },
    changeOpacity: function (e) {
        currentFloor.setOpacity(e), this.referenceFloor && this.referenceFloor.setOpacity(1 - e)
    },
    removeHTMLTools: function () {
        this.actionPanel.remove()
    },
    reinit: function () {
        this.deactivate(), this.layer = currentFloor.graphLayer, this.referenceFloor = currentFloor.downStairs(), this.handlers = {
            hover: new OpenLayers.Handler.Hover(this, {move: this.onMouseMove}),
            draw: new OpenLayers.Handler.Point(this, {done: this.onNewPoint}),
            keyboard: new OpenLayers.Handler.Keyboard(this, {keydown: this.onKeyDown}),
            feature: new OpenLayers.Handler.Feature(this, this.layer, {}, {geometryTypes: ["OpenLayers.Geometry.Point", "OpenLayers.Geometry.LineString"]}),
            drag: new OpenLayers.Handler.Drag(this, {
                down: this.onDragStarted,
                move: this.onDrag,
                up: this.onDragDeactivated,
                out: this.onDragCanceled,
                done: this.onDragComplete
            }, {documentDrag: this.documentDrag, keyMask: OpenLayers.Handler.MOD_SHIFT})
        }, site.map.addControl(this), this.activate()
    },
    changeCurrentFloor: function () {
        this.lastNode && this.lastNode.floor.id != currentFloor.id ? (this.isDrawingTransition = !0, this.referenceFloor = this.lastNode.floor, this.referenceFloor.setAsReference()) : (this.isDrawingTransition = !1, this.referenceFloor && this.referenceFloor.unsetAsReference(), this.referenceFloor = currentFloor.downStairs()), this.nextSegment && this.layer.removeFeatures([this.nextSegment]), this.layer = currentFloor.graphLayer, currentFloor.setOpacity(1), $("#" + this.opacitySlider.valueDomId).html(1), $("#" + this.opacitySlider.controlDomId).slider("value", 1), this.handlers.feature.deactivate(), this.handlers.feature = new OpenLayers.Handler.Feature(this, this.layer, {}, {geometryTypes: ["OpenLayers.Geometry.Point", "OpenLayers.Geometry.LineString"]}), this.handlers.feature.activate(), this.handlers.draw.deactivate(), this.handlers.draw.activate(), site.graph.redrawOnCurrentFloor()
    },
    setMap: function (e) {
        this.handlers.drag.setMap(e), this.handlers.draw.setMap(e), this.handlers.feature.setMap(e), this.handlers.hover.setMap(e), OpenLayers.Control.prototype.setMap.apply(this, arguments)
    },
    activate: function () {
        return this.handlers.feature.activate() && this.handlers.draw.activate() && this.handlers.hover.activate() && this.handlers.keyboard.activate() && OpenLayers.Control.prototype.activate.apply(this, arguments)
    },
    deactivate: function () {
        return this.nextSegment && this.layer.removeFeatures([this.nextSegment]), this.handlers && (this.handlers.drag.deactivate(), this.handlers.feature.deactivate(), this.handlers.draw.deactivate(), this.handlers.hover.deactivate(), this.handlers.keyboard.deactivate()), this.feature = null, this.dragging = !1, this.lastNode = null, this.nextSegment = null, OpenLayers.Control.prototype.deactivate.apply(this, arguments)
    },
    onMouseMove: function (e) {
        var t = this.map.getLonLatFromViewPortPx(e.xy), i = site.graph.getCloseFeature(t.lon, t.lat, this.draggedFeature);
        if (null != i ? this.onHoverFeature(i) : null != this.hoveredFeature && this.outHoverFeature(this.hoveredFeature), !this.handlers.drag.dragging && this.lastNode) {
            var n = new OpenLayers.LonLat(this.lastNode.feature.geometry.x, this.lastNode.feature.geometry.y);
            this.nextSegment && this.layer.removeFeatures([this.nextSegment]);
            var s = this.isDrawingTransition ? "red" : "blue";
            this.nextSegment = createDotLine(t, n, s), this.layer.addFeatures([this.nextSegment])
        }
    },
    onKeyDown: function (e) {
        switch (e.keyCode) {
            case 27:
            case 70:
                log("GraphController ESC"), this.onStopLine();
                break;
            case 13:
                this.onStopLine();
                break;
            case 68:
            case 46:
                this.onStopLine(), this.deleteFeature()
        }
    },
    onHoverFeature: function (e) {
        null != this.hoveredFeature && this.hoveredFeature != e && this.outHoverFeature(this.hoveredFeature), this.hoveredFeature = e, this.highlightFeature(e);
        var t = !1;
        return e.geometry instanceof OpenLayers.Geometry.Point && (this.handlers.drag.dragging ? this.over = this.draggedFeature.id == e.id ? !0 : !1 : (this.handlers.drag.activate(), t = !0, this.over = !0)), t
    },
    outHoverFeature: function (e) {
        this.hoveredFeature = null, this.unhighlightFeature(e), this.handlers.drag.dragging ? this.draggedFeature.id == e.id && (this.over = !1) : (this.draggedFeature = null, this.over = !1, this.handlers.drag.deactivate())
    },
    highlightFeature: function (e) {
        e != this.draggedFeature && e.geometry instanceof OpenLayers.Geometry.Point ? this.layer.drawFeature(e, selectedgraphNodeStyle) : this.layer.drawFeature(e, selectedgraphSegmentStyle)
    },
    unhighlightFeature: function (e) {
        e.geometry instanceof OpenLayers.Geometry.Point ? this.layer.drawFeature(e) : this.layer.drawFeature(e)
    },
    onDragStarted: function (e) {
        this.onStopLine(), this.lastPixel = e, this.draggedFeature = this.hoveredFeature
    },
    onDrag: function (e) {
        var t = this.draggedFeature, i = this.map.getResolution();
        t.geometry.move(i * (e.x - this.lastPixel.x), i * (this.lastPixel.y - e.y)), this.layer.drawFeature(t), this.lastPixel = e;
        var n = t.attributes.id, s = site.graph.nodes[n];
        s.feature = t, s.point = t.geometry;
        for (var r = 0; r < s.connectedSegments.length; r++)s.connectedSegments[r].floor == currentFloor && this.layer.drawFeature(s.connectedSegments[r].feature)
    },
    onDragComplete: function () {
        for (var e = this.draggedFeature, t = e.attributes.id, i = site.graph.nodes[t], n = i.connectedNodes(), s = i.connectedSegments.length - 1; s >= 0; s--)site.graph.removeSegment(i.connectedSegments[s]);
        this.hoveredFeature && this.hoveredFeature != e && (new_node = this.onNewPoint(e.geometry), new_node && (site.graph.removeNode(i), i = new_node));
        for (var s = n.length - 1; s >= 0; s--)n[s].id != i.id && this.onNewSegment(n[s], i);
        this.lastNode = null, this.draggedFeature = null, this.notifyListeners(currentFloor.id), site.graph.redrawOnCurrentFloor()
    },
    onDragDeactivated: function () {
        this.over || this.handlers.drag.deactivate()
    },
    onDragCanceled: function () {
        this.handlers.drag.deactivate(), this.over = !1
    },
    deleteFeature: function () {
        if (this.hoveredFeature) {
            var e = this.hoveredFeature;
            e.geometry instanceof OpenLayers.Geometry.LineString ? site.graph.removeSegment(site.graph.segments[e.attributes.id]) : e.geometry instanceof OpenLayers.Geometry.Point && (site.graph.removeNodeAndItsConnectedSegments(site.graph.nodes[e.attributes.id]), this.lastNode && e == this.lastNode.feature && (this.lastNode = null, this.layer.removeFeatures([this.nextSegment]))), site.graph.removeLonelyNodes(), this.hoveredFeature = null
        }
        this.notifyListeners(currentFloor.id), site.graph.redrawOnCurrentFloor()
    },
    onStopLine: function () {
        this.lastNode && (0 == this.lastNode.connectedSegments.length && site.graph.removeNode(this.lastNode), this.lastNode = null), this.nextSegment && (this.layer.removeFeatures([this.nextSegment]), this.nextSegment = null), this.isDrawingTransition && (this.isDrawingTransition = !1, this.referenceFloor && this.referenceFloor.unsetAsReference(), this.referenceFloor = currentFloor.downStairs()), site.graph.redrawOnCurrentFloor()
    },
    onNewPoint: function (e) {
        var t;
        if (null == this.hoveredFeature) t = new GraphNode(generate_guid(), site.graph, e, currentFloor); else if (this.hoveredFeature.geometry instanceof OpenLayers.Geometry.Point) {
            var i = this.hoveredFeature.attributes.id;
            t = site.graph.nodes[i]
        } else if (this.hoveredFeature.geometry instanceof OpenLayers.Geometry.LineString && !this.hoveredFeature.attributes.isTransition) {
            var n = e.distanceTo(this.hoveredFeature.geometry, {details: !0}), s = new OpenLayers.Geometry.Point(n.x1, n.y1);
            t = new GraphNode(generate_guid(), site.graph, s, currentFloor);
            var i = this.hoveredFeature.attributes.id;
            null != site.graph.segments[i] && this.splitSegmentWithNode(t, site.graph.segments[i]), this.hoveredFeature = null
        }
        return this.lastNode && t && this.onNewSegment(this.lastNode, t), this.isDrawingTransition && (this.referenceFloor && this.referenceFloor.unsetAsReference(), this.referenceFloor = currentFloor.downStairs(), this.isDrawingTransition = !1), t && (this.lastNode = t), this.notifyListeners(currentFloor.id), site.graph.redrawOnCurrentFloor(), t
    },
    onNewSegment: function (e, t) {
        var i = this.getIntersectionsWithGraph(e, t);
        this.isDrawingTransition || 0 == i.length ? this.drawNewSegment(e, t) : this.drawSegmentsWithIntersections(i, e, t)
    },
    getIntersectionsWithGraph: function (e, t) {
        for (var i = [], n = [], s = [], r = 0; r < e.connectedSegments.length; r++)s.push(e.connectedSegments[r].id);
        for (var a = 0; a < t.connectedSegments.length; a++)s.push(t.connectedSegments[a].id);
        var o = new OpenLayers.Geometry.LineString([e.point, t.point]);
        e:for (var r in site.graph.segments) {
            var l = site.graph.segments[r];
            if (l && !l.isTransition && l.floor == currentFloor) {
                var h = o.split(l.feature.geometry, {mutual: !0});
                if (h) {
                    for (var a = 0; a < s.length; a++)if (l.feature.attributes.id == s[a])continue e;
                    var u = h[0][1].getVertices(), c = u[0];
                    i.push(new Intersection(c, [l]))
                }
            }
        }
        for (var r = 0; r < i.length; r++) {
            var p = e.point.distanceTo(i[r].point, {details: !0});
            i[r].abscisseCurviligne = p.distance
        }
        i.sort(function (e, t) {
            return e.abscisseCurviligne - t.abscisseCurviligne
        });
        for (var d = 2, f = [], m = [i[0]], r = 0; r < i.length; r++)r == i.length - 1 ? f.push(m) : Math.abs(i[r + 1].abscisseCurviligne - i[r].abscisseCurviligne) < d ? m.push(i[r + 1]) : (f.push(m), m = [i[r + 1]]);
        for (var r = 0; r < f.length; r++) {
            for (var g = null, y = null, v = null, b = [], a = 0; a < f[r].length; a++)g += f[r][a].point.x, y += f[r][a].point.y, b.push(f[r][a].segments[0]);
            g /= f[r].length, y /= f[r].length, v = new OpenLayers.Geometry.Point(g, y), n.push(new Intersection(v, b))
        }
        return n
    },
    drawNewSegment: function (e, t) {
        t.isConnectedTo(e) || new GraphSegment(generate_guid(), site.graph, [e, t])
    },
    splitSegmentWithNode: function (e, t) {
        nodeStore = [], nodeStore.push(t.nodes[0]), nodeStore.push(t.nodes[1]), site.graph.removeSegment(t);
        for (var i = 0; 2 > i; i++)this.drawNewSegment(nodeStore[i], e)
    },
    drawSegmentsWithIntersections: function (e, t, i) {
        for (var n = [], s = 0; s < e.length; s++)if (1 == e[s].segments.length) {
            var r = e[s].segments[0], a = new GraphNode(generate_guid(), site.graph, e[s].point, currentFloor);
            this.splitSegmentWithNode(a, r), n.push(a)
        } else {
            var o, l = e[s].segments[0].nodes[0].id;
            o = l == e[s].segments[1].nodes[0].id ? e[s].segments[1].nodes[0] : l == e[s].segments[1].nodes[1].id ? e[s].segments[1].nodes[1] : e[s].segments[0].nodes[1], o.setCoordinates(e[s].point), n.push(o)
        }
        this.drawNewSegment(t, n[0]), this.drawNewSegment(n[n.length - 1], i);
        for (var s = 0; s < n.length - 1; s++)this.drawNewSegment(n[s], n[s + 1])
    },
    CLASS_NAME: "GraphController"
});
var Nao = Nao ? Nao : {};
Nao.Controllers = function (e) {
    function t(e, t, i, n, s) {
        var r = this;
        r.dirty = !1, r.onSuccessCallbacks = [], r.progressBars = [], r.errorZones = [], r.autosaveDelay = 5e3, r.savePlanned = !1, r.floorSavedAt = {}, Object.keys(i).forEach(function (e) {
            r.floorSavedAt[e] = window.requestDate
        }), r.addOnSuccessCallback = function (e) {
            -1 === r.onSuccessCallbacks.indexOf(e) && r.onSuccessCallbacks.push(e)
        }, r.addProgressBar = function (e) {
            -1 === r.progressBars.indexOf(e) && r.progressBars.push(e)
        }, r.addErrorZone = function (e) {
            -1 === r.errorZones.indexOf(e) && r.errorZones.push(e)
        }, r.onFloorModified = function (e) {
            var t = i[e];
            t && (t.dirty = !0)
        }, r.prepare_save_graph = function () {
            var t = Object.keys(i);
            -1 != t.indexOf("overview") && t.splice(t.indexOf("overview"), 1);
            var n = {}, s = {}, r = [];
            return t.forEach(function (e) {
                n[e] = [], s[e] = []
            }), $.each(e.graph.nodes, function (e, t) {
                t.floor && "overview" != t.floor.id && n[t.floor.id].push(t.toJson())
            }), $.each(e.graph.segments, function (e, t) {
                t.isTransition ? r.push(t.toJson()) : s[t.floor.id].push(t.toJson())
            }), {nodes: n, links: s, transitions: r}
        }, r.save_graph = function () {
            if (r.savePlanned = !1, e.total_graph_requests !== e.processed_graph_requests)return r.saveWithDelay(), void 0;
            r.errorStatus = [], r.errorMsg = [];
            var a = [];
            if (Object.keys(i).forEach(function (e) {
                    i[e].dirty && a.push(e)
                }), -1 != a.indexOf("overview") && a.splice(a.indexOf("overview"), 1), 0 === a.length)return r.onSuccess(), r.saveWithDelay(), void 0;
            r.dirty = !0, r.progressBars.forEach(function (e) {
                e.removeClass("progress-bar-success"), e.removeClass("progress-bar-danger"), e.attr("style", "width:0%")
            }), r.errorZones.forEach(function (e) {
                e.html(""), e.attr("hidden", !0)
            }), e.total_graph_requests = 1, e.processed_graph_requests = 0, e.failed_graph_requests = 0;
            var o = r.prepare_save_graph();
            a.forEach(function (t) {
                if (i[t].dirty) {
                    e.total_graph_requests++;
                    var n = {n: o.nodes[t], l: o.links[t]};
                    $.ajax({
                        type: "PUT",
                        url: s,
                        data: {graph_data: JSON.stringify(n), floor_id: t, date: r.floorSavedAt[t]},
                        success: function (e) {
                            i[e.id].dirty = !1, r.floorSavedAt[t] = e.updated_at, r.on_partial_save_success(e)
                        },
                        error: r.on_partial_save_error,
                        complete: r.update_progress_bar
                    })
                }
            });
            var l = {cl: o.transitions};
            $.ajax({
                type: "PUT",
                url: n,
                data: {graph_data: JSON.stringify(l), building_id: t.id},
                success: r.on_partial_save_success,
                error: r.on_partial_save_error,
                complete: r.update_progress_bar
            })
        }, r.on_partial_save_success = function () {
        }, r.on_partial_save_error = function (t) {
            e.failed_graph_requests++, r.errorStatus.push(t.statusText), t.responseJSON && (r.errorMsg = r.errorMsg.concat(t.responseJSON)), r.progressBars.forEach(function (e) {
                e.addClass("progress-bar-danger")
            }), r.errorZones.forEach(function (e) {
                e.removeAttr("hidden"), e.html(r.errorMsg.join("<br>"))
            })
        }, r.update_progress_bar = function () {
            e.processed_graph_requests++;
            var t = r.errorStatus.filter(function (e, t) {
                return r.errorStatus.indexOf(e) == t
            });
            r.progressBars.forEach(function (i) {
                if (e.processed_graph_requests === e.total_graph_requests) e.failed_graph_requests > 0 ? (i.attr("style", "width:100%"), i.removeClass("progress-bar-success"), i.addClass("progress-bar-danger"), i.html("Error : " + t.join(", ") + " | " + timeHMSString())) : (i.attr("style", "width:100%"), i.removeClass("progress-bar-danger"), i.addClass("progress-bar-success"), i.html("Saved at " + timeHMSString())); else {
                    var n = Math.floor(100 * e.processed_graph_requests / e.total_graph_requests);
                    i.attr("style", "width:" + n + "%"), i.html("Saving... " + n + "%")
                }
            }), e.processed_graph_requests === e.total_graph_requests && 0 === e.failed_graph_requests && (r.saveWithDelay(), r.onSuccess())
        }, r.onSuccess = function () {
            r.onSuccessCallbacks.forEach(function (e) {
                e.call()
            }), r.onSuccessCallbacks = []
        }, r.saveWithDelay = function () {
            r.savePlanned || (r.savePlanned = !0, setTimeout(function () {
                0 != $(".submit-control:visible").length && r.save_graph()
            }, r.autosaveDelay))
        }
    }

    return e.GraphSaveController = t, e
}(Nao.Controllers || {});
var currentLog = null;
micelloMapController = null, iconTypes = {}, MicelloMapController = OpenLayers.Class({
    apiKey: "b7f1223e-5a56-40b5-8536-4274f95b2d1d",
    communityUrl: "http://maps.micello.com/v3_java/map/community/",
    drawingUrl: "http://maps.micello.com/v3_java/map/drawing/",
    searchUrl: "http://maps.micello.com/v3/search/community/",
    drawings: {},
    isFetchingLastDrawing: !1,
    fetchingQueueSize: 0,
    communityId: null,
    site: null,
    initialize: function () {
        OpenLayers.Control.prototype.initialize.apply(this, [])
    },
    loadCommunityFromSite: function (e) {
        this.site = e, this.loadCommunityFromLatlon(e.lon, e.lat)
    },
    loadCommunityFromLatlon: function (e, t) {
        notify("Searching for Micello Community. Please wait..."), $.getJSON(this.searchUrl + "lat/" + t + "/lon/" + e + "/radius/1" + "?api_key=" + this.apiKey, function (e) {
            e && e.results[0] ? (micelloMapController.communityId = e.results[0].id, micelloMapController.fetchCommunityData(micelloMapController.communityId)) : error("Can not find any Micello Community near this site.")
        }).error(function () {
            error("Can not fetch Micello Data. Please check your API key.")
        })
    },
    fetchCommunityData: function (e) {
        notify("Fetching data from Community ID " + e + ". Please wait..."), $.getJSON(this.communityUrl + e + "?api_key=" + this.apiKey, function (e) {
            if (e)for (var t = e.d.length - 1; t >= 0; t--)if (0 == t && (micelloMapController.isFetchingLastDrawing = !0), e.d[t].l) micelloMapController.addDrawing(e.d[t]); else {
                var i = e.d[t].id;
                micelloMapController.fetchingQueueSize += 1, micelloMapController.fetchDrawingData(i)
            }
        }).error(function () {
            error("Can not fetch Micello Data. Please check your API key.")
        })
    },
    fetchDrawingData: function (e) {
        notify("Fetching data from Drawing ID " + e + ". Please wait..."), $.getJSON(this.drawingUrl + e + "?api_key=" + this.apiKey, function (e) {
            micelloMapController.fetchingQueueSize -= 1, micelloMapController.addDrawing(e)
        }).error(function () {
            error("Can not fetch Micello Data. Please check your API key.")
        })
    },
    addDrawing: function (e) {
        this.drawings[e.id] = e, this.site && this.isFetchingLastDrawing && 0 == this.fetchingQueueSize && (notify("Drawing data on the map. Please wait..."), this.addToPoleStarSite(this.site), notify("Micello Map Successfully Loaded!!!"))
    },
    toPoleStarJson: function () {
        var e = [];
        for (var t in this.drawings) {
            var i = this.drawings[t], n = i.t;
            e[e.length] = {name: i.nm, floors: []};
            for (var s = 0; s < i.l.length; s++) {
                for (var r = i.l[s], a = r.nm, o = 5 * r.z, l = {
                    name: "Level " + a,
                    level_number: a,
                    altitude: o,
                    polygons: [],
                    lines: [],
                    points: []
                }, h = r.g, u = 0; u < h.length; u++) {
                    var c = h[u].t, p = h[u].shp, d = [], f = 0;
                    if (d[f] = [], p)for (var m = 0; m < p.length; m++) {
                        var g = p[m];
                        if (0 == g[0] || 1 == g[0]) {
                            var y = this.affineTransform(g[1], g[2], n);
                            d[f].push(y)
                        } else if (2 == g[0]) {
                            var v = d[f][d[f].length - 1], b = this.affineTransform(g[1], g[2], n), L = this.affineTransform(g[3], g[4], n), w = this.getBezierQuadricPoints(v, b, L);
                            d[f].push.apply(d[f], w)
                        } else if (3 == g[0]) {
                            var v = d[f][d[f].length - 1], b = this.affineTransform(g[1], g[2], n), L = this.affineTransform(g[3], g[4], n), O = this.affineTransform(g[5], g[6], n), w = this.getBezierCubicPoints(v, b, L, O);
                            d[f].push.apply(d[f], w)
                        } else 4 == g[0] && (f += 1, d[f] = [])
                    } else {
                        c = h[u].nm;
                        var y = this.affineTransform(h[u].l[0], h[u].l[1], n);
                        d[f].push(y), iconTypes[c] = !0
                    }
                    d.length > 0 && (this.addGeometryToFloorJson(l, d, c), d = [])
                }
                e[e.length - 1].floors.push(l)
            }
        }
        return e
    },
    getBezierCubicPoints: function (e, t, i, n) {
        for (var s = [], r = .2; 1 >= r; r += .2) {
            var a = [];
            a[0] = (1 - r) * (1 - r) * (1 - r) * e[0] + 3 * (1 - r) * (1 - r) * r * t[0] + 3 * (1 - r) * r * r * i[0] + r * r * r * n[0], a[1] = (1 - r) * (1 - r) * (1 - r) * e[1] + 3 * (1 - r) * (1 - r) * r * t[1] + 3 * (1 - r) * r * r * i[1] + r * r * r * n[1], s.push(a)
        }
        return s
    },
    getBezierQuadricPoints: function (e, t, i) {
        for (var n = [], s = .1; 1 >= s; s += .1) {
            var r = [];
            r[0] = 2 * (1 - s) * (t[0] - e[0]) + 2 * s * (i[0] - t[0]), r[1] = 2 * (1 - s) * (t[1] - e[1]) + 2 * s * (i[1] - t[1]), n[n.length - 1] = r
        }
        return n
    },
    affineTransform: function (e, t, i) {
        var n = [];
        return n[0] = i[0] * e + i[2] * t + i[4], n[1] = i[1] * e + i[3] * t + i[5], n
    },
    addGeometryToFloorJson: function (e, t, i) {
        if (t.length > 1)for (var n = 0; n < t.length; n++) {
            var s = [];
            for (k = 0; k < t[n].length; k++)s.push(t[n][k]);
            s.length > 0 && e.polygons.push([s, i])
        } else 1 == t.length && t[0].length > 1 ? e.lines.push([t[0], i]) : 1 == t[0].length && e.points.push([t[0], i])
    },
    addToPoleStarSite: function (e) {
        var t = this.toPoleStarJson();
        $("#buildings").html("");
        for (var i = t.length - 1; i >= 0; i--) {
            buildings["b" + i] = new Building("b" + i, t[i].name, e);
            var n = '				<li class="building" id="building-b' + i + '">					<div id="building-b' + i + '-metadata" class="building-metadata">						<a onclick="buildings[\'b' + i + '\'].setAsCurrent();" id="building-b' + i + '-name" href="#">' + t[i].name + '</a>					</div>					<ul id="building-b' + i + '-floors" class="floors"></ul>				</li>			';
            $("#buildings").append(n), t[i].floors.sort(function (e, t) {
                return t.altitude - e.altitude
            });
            for (var s = 0; s < t[i].floors.length; s++) {
                var r = "b" + i + "f" + s, a = t[i].floors[s], o = new VectorBlueprint(e.map, a);
                floors[r] = new Floor(r, a.name, a.level_number, a.altitude, o, buildings["b" + i]);
                var l = '					  <li class="floor" id="floor-' + r + '">					  	<div id="floor-' + r + '-metadata" class="floor-metadata">					  		<a onclick="floors[\'' + r + '\'].setAsCurrent()" id="floor-' + r + '-name" href="#">' + a.name + "</a>					  	</div>					  </li>				";
                $("#building-b" + i + "-floors").append(l)
            }
        }
    },
    CLASS_NAME: "MicelloMapController"
});
var Nao = Nao ? Nao : {};
Nao.CustomAttributes = function (e) {
    function t() {
        var e = this, t = function (e) {
            if (!$(e.currentTarget).attr("disabled")) {
                $(e.currentTarget).attr("disabled", !0);
                var t = $(e.currentTarget).parents("tr");
                $.ajax({
                    type: "DELETE", url: "/custom_attributes/" + t.data("id") + ".json", success: function () {
                        t.remove()
                    }, error: function (e) {
                        var t = JSON.parse(e.responseText).errors;
                        null != t ? alert(t.join(",")) : alert("An unknown error occured during attribute deletion")
                    }
                })
            }
            return !1
        }, i = function (t) {
            return $(t.currentTarget).attr("disabled") || ($(t.currentTarget).attr("disabled", !0), e.parent = $(t.currentTarget).parents("tr"), $.ajax({
                type: "PUT",
                url: "/custom_attributes/" + e.parent.data("id") + ".json",
                data: {attribute: {value: e.parent.find("#attribute_value").val()}},
                success: function () {
                    e.parent.find(".btn-upd-attribute").attr("disabled", !1)
                },
                error: function (t) {
                    var i = JSON.parse(t.responseText).errors;
                    null != i ? alert(i.join(",")) : alert("An unknown error occured during attribute update"), e.parent.find(".btn-upd-attribute").attr("disabled", !1)
                }
            })), !1
        }, n = function (n) {
            if (!$(n.currentTarget).attr("disabled")) {
                $(n.currentTarget).attr("disabled", !0), e.parent = $(n.currentTarget).parents("tr");
                var s;
                try {
                    s = JSON.parse($(n.currentTarget).parents("table").find("#attribute_map").val())
                } catch (r) {
                    if (!(r instanceof SyntaxError))throw r;
                    s = null
                }
                $.ajax({
                    type: "POST",
                    url: "/custom_attributes",
                    data: {
                        type: e.parent.find("#type").val(),
                        attribute: {
                            customizable_type: e.parent.find("#attribute_customizable_type").val(),
                            customizable_id: e.parent.find("#attribute_customizable_id").val(),
                            key: e.parent.find("#attribute_key").val(),
                            value: e.parent.find("#attribute_value").val()
                        },
                        value_text_area: $(n.currentTarget).parents("table").data("value_text_area"),
                        attribute_map: s
                    },
                    success: function (n) {
                        $(n).insertBefore(e.parent);
                        var s = e.parent.prev();
                        s.find(".btn-upd-attribute").click(i), s.find(".btn-del-attribute").click(t), e.parent.find(".btn-new-attribute").attr("disabled", !1), e.parent.find("#attribute_key").val(""), e.parent.find("#attribute_value").val("")
                    },
                    error: function (t, i, n) {
                        var n = JSON.parse(t.responseText).errors;
                        null != n ? alert(n.join(",")) : alert("An unknown error occured during attribute creation"), e.parent.find(".btn-new-attribute").attr("disabled", !1)
                    }
                })
            }
            return !1
        };
        $(".btn-del-attribute").click(t), $(".btn-upd-attribute").click(i), $(".btn-new-attribute").click(n)
    }

    return e.FormControls = t, e
}(Nao.CustomAttributes || {}), RAINBOW_COLOR_34 = [[.3, 0, 0], [.5, 0, 0], [.7, 0, 0], [.9, 0, 0], [1, .078125, 0], [1, .234375, 0], [1, .390625, 0], [1, .546875, 0], [1, .703125, 0], [1, .859375, 0], [.984375, 1, 0], [.828125, 1, 0], [.671875, 1, 0], [.515625, 1, 0], [.359375, 1, 0], [.203125, 1, 0], [.046875, 1, 0], [0, 1, .109375], [0, 1, .265625], [0, 1, .421875], [0, 1, .578125], [0, 1, .734375], [0, 1, .890625], [0, .953125, 1], [0, .796875, 1], [0, .640625, 1], [0, .484375, 1], [0, .328125, 1], [0, .171875, 1], [0, .015625, 1], [.140625, 0, 1], [.296875, 0, 1], [.453125, 0, 1], [.60937, 0, 1]];
var dbgVal = null;
Object.size = function (e) {
    var t, i = 0;
    for (t in e)e.hasOwnProperty(t) && i++;
    return i
}, jQuery.expr[":"].Contains = function (e, t, i) {
    return (e.textContent || e.innerText || "").toUpperCase().indexOf(i[3].toUpperCase()) >= 0
}, jQuery.browser = {}, jQuery.browser.mozilla = /mozilla/.test(navigator.userAgent.toLowerCase()) && !/webkit/.test(navigator.userAgent.toLowerCase()), jQuery.browser.webkit = /webkit/.test(navigator.userAgent.toLowerCase()), jQuery.browser.opera = /opera/.test(navigator.userAgent.toLowerCase()), jQuery.browser.msie = /msie/.test(navigator.userAgent.toLowerCase()), jQuery.browser.firefox = /firefox/.test(navigator.userAgent.toLowerCase()), function () {
    jQuery(function () {
        return $("#fileupload").fileupload({
            add: function (e, t) {
                var i, n, s;
                return s = new RegExp("(.|/)(" + $("#fileupload").data("exts") + ")$", "i"), i = t.files[0], s.test(i.type) || s.test(i.name) ? (n = {
                    name: i.name,
                    progress: 0
                }, t.context = $(tmpl("template-upload", n)), $("#fileupload").append(t.context), t.submit()) : alert(i.name + " does not have valid extension. Only " + $("#fileupload").data("exts") + " files are supported")
            }, progress: function (e, t) {
                var i;
                return t.context ? (i = parseInt(100 * (t.loaded / t.total), 10), t.context.find(".bar").css("width", i + "%")) : void 0
            }, done: function (e, t) {
                var i, n, s, r, a, o, l;
                return s = t.files[0], n = $("#fileupload").attr("action"), o = $("#fileupload input[name=key]").val().replace("${filename}", s.name), r = $("#fileupload").data("action"), l = $("#fileupload").data("to"), a = $("#fileupload").data("params"), i = {}, i[$("#fileupload").data("as")] = o, i = $.extend({}, i, a), $.ajax({
                    type: r,
                    url: l,
                    data: i
                }), t.context ? t.context.remove() : void 0
            }, fail: function (e, t) {
                return t.context && t.context.remove(), alert(t.files[0].name + " failed to upload."), console.log("Upload failed:"), console.log(t)
            }
        })
    })
}.call(this), OpenLayers.Control.Click = OpenLayers.Class(OpenLayers.Control, {
    defaultHandlerOptions: {
        single: !0,
        "double": !0,
        pixelTolerance: 0,
        stopSingle: !0,
        stopDouble: !0
    }, handleRightClicks: !0, initialize: function () {
        this.handlerOptions = OpenLayers.Util.extend({}, this.defaultHandlerOptions), OpenLayers.Control.prototype.initialize.apply(this, arguments), this.handler = new OpenLayers.Handler.Click(this, this.eventMethods, this.handlerOptions)
    }, CLASS_NAME: "OpenLayers.Control.Click"
}), Nao = function (e) {
    function t() {
        this.listeners = [], this._isSelected = !1, this._isHidden = !1, this.addListener = function (e) {
            this.listeners.indexOf(e) < 0 && this.listeners.push(e)
        }, this.removeListener = function (e) {
            var t;
            switch ($.type(e)) {
                case"function":
                    t = this.listeners.indexOf(e);
                    break;
                case"number":
                    t = e;
                    break;
                default:
                    return !1
            }
            t > -1 && this.listeners.splice(t, 1)
        }, this.trigger = function (e) {
            var t = this;
            $.each(this.listeners, function (i, n) {
                n.call(null, e, t)
            })
        }, this.select = function () {
            this.highlight(), this._isSelected = !0, this.trigger("selected")
        }, this.unselect = function () {
            this._isSelected && (this.unhighlight(), this._isSelected = !1, this.trigger("unselected"))
        }, this.isSelected = function () {
            return this._isSelected
        }, this.show = function () {
            this.feature.style.display = "", this.redraw(), this._isHidden = !1, this.trigger("show")
        }, this.hide = function () {
            this.feature.style.display = "none", this.redraw(), this._isHidden = !0, this.trigger("hide")
        }, this.hidden = function () {
            return this._isHidden
        }, this.redraw = function () {
            this.feature.layer.drawFeature(this.feature)
        }, this.setStatus = function () {
        }, this.getCenter = function () {
            return this.center
        }, this.getInfo = function () {
            return this.toString()
        }, this.getId = function () {
            return this.id
        }, this.highlight = function () {
            this.feature.attributes.isHighlighted = !0, this.redraw()
        }, this.unhighlight = function () {
            this.feature.attributes.isHighlighted = !1, this.redraw()
        }
    }

    return e.SingleFeatureModel = t, e
}(Nao || {}), Nao = function (e) {
    function t() {
        this.show = function () {
            for (var e = this.features(), t = 0; t < e.length; t++)e[t].style.display = "";
            this.redraw(), this._isHidden = !1, this.trigger("show")
        }, this.hide = function () {
            for (var e = this.features(), t = 0; t < e.length; t++)e[t].style.display = "none";
            this.redraw(), this._isHidden = !0, this.trigger("hide")
        }, this.redraw = function () {
            for (var e = this.features(), t = 0; t < e.length; t++)e[t].layer.drawFeature(e[t])
        }, this.highlight = function () {
            for (var e = this.features(), t = 0; t < e.length; t++)e[t].attributes.isHighlighted = !0;
            this.redraw()
        }, this.unhighlight = function () {
            for (var e = this.features(), t = 0; t < e.length; t++)e[t].attributes.isHighlighted = !1;
            this.redraw()
        }
    }

    return t.prototype = new Nao.SingleFeatureModel, t.prototype.constructor = t, e.MultiFeatureModel = t, e
}(Nao || {});
var MapDatatableController = function (e, t, i) {
    var n = this;
    this._init = function (e, t, i) {
        this.dataTable = e, this.modelPainter = t, this.models = i;
        for (var n in i)this.modelPainter && i[n].addListener(this.modelPainter._onModelEvent);
        this.currentDisplayedModels = this.models, this.currentSelectedModels = [], this._defineUICallbacks()
    }, this.getSingleSelectedModel = function () {
        return 1 != this.currentSelectedModels.length ? (alert("Please select a single beacon on the map"), null) : n.currentSelectedModels[0]
    }, this.unselectAll = function () {
        $.each(this.currentSelectedModels, function (e, t) {
            t.unselect()
        }), this.currentSelectedModels = []
    }, this._redrawUiComponents = function () {
        this.dataTable.redraw(), this.modelPainter && this.modelPainter.redraw()
    }, this._switchFloorIfNecessary = function (e) {
        e.getFloor().id !== currentFloor.id && e.getFloor().setAsCurrent()
    }, this._centerMapOnModel = function (e) {
        psMap.map.setCenter(e.getCenter())
    }, this._displayModelInfo = function (e) {
        psMap.setMapInstructions(e.getInfo())
    }, this._switchPage = function (e) {
        this.dataTable.switchPageForModel(e)
    }, this._onModelsStatusChanged = function (e, t) {
        $.each(n.models, function (i, n) {
            var s;
            s = $.isFunction(n.status_type[e]) ? n.status_type[e]() : n.status_type[e], n.setStatus(t[s])
        }), n._redrawUiComponents()
    }, this._onModelsFiltered = function (e) {
        $.each(e, function (e, t) {
            t.hidden() && t.show()
        }), $.each(n.currentDisplayedModels, function (t, i) {
            -1 === $.inArray(i, e) && i.hide()
        }), n.currentDisplayedModels = e, n.unselectAll(), n._redrawUiComponents()
    }, this._onModelsSelected = function (e) {
        $.each(e, function (e, t) {
            t.isSelected() || t.select()
        }), n.currentSelectedModels = _.uniq(n.currentSelectedModels.concat(e))
    }, this._onModelsUnselected = function (e) {
        e.length > 0 ? ($.each(e, function (e, t) {
            t.isSelected() && t.unselect()
        }), n.currentSelectedModels.length && e.forEach(function (e) {
            var t = n.currentSelectedModels.indexOf(e);
            -1 !== t && n.currentSelectedModels.splice(t, 1)
        })) : n.unselectAll()
    }, this._onModelsAdded = function (e) {
        for (var t = e.length - 1; t >= 0; t--)this.modelPainter && e[t].addListener(this.modelPainter._onModelEvent), this.dataTable.addModel(e[t])
    }, this._onModelsRemoved = function (e) {
        for (var t = e.length - 1; t >= 0; t--)this.dataTable.removeModel(e[t])
    }, this._onModelsUpdated = function (e) {
        for (var t = e.length - 1; t >= 0; t--)this.dataTable.updateModel(e[t])
    }, this._onCallBack = function (e, t) {
        switch (log("MapDatatableController " + t), t) {
            case"selected":
                n._onModelsSelected(e);
                break;
            case"unselected":
                n._onModelsUnselected(e);
                break;
            case"added":
                n._onModelsAdded(e), this.dataTable.reload();
                break;
            case"removed":
                n._onModelsUnselected(e), n._onModelsRemoved(e), this.dataTable.reload();
                break;
            case"updated":
                n._onModelsUpdated(e), this.dataTable.reload()
        }
    }, this._onCallbackFromMap = function (e, t) {
        n._onCallBack(e, t), n.currentSelectedModels.length > 0 && "selected" == t && (n._displayModelInfo(_.last(n.currentSelectedModels)), n._switchPage(_.last(n.currentSelectedModels))), n._redrawUiComponents()
    }, this._onRowClicked = function (e, t) {
        n._onCallBack(e, t), n.currentSelectedModels.length > 0 && (n._switchFloorIfNecessary(_.last(n.currentSelectedModels)), n._centerMapOnModel(_.last(n.currentSelectedModels)), n._displayModelInfo(_.last(n.currentSelectedModels))), n._redrawUiComponents()
    }, this._defineUICallbacks = function () {
        this.dataTable.onStatusTypeSourceChanged(this._onModelsStatusChanged), this.dataTable.onModelsFiltered(this._onModelsFiltered), this.dataTable.onRowClicked(this._onRowClicked), this.modelPainter && this.modelPainter.addListener(n._onCallbackFromMap)
    }, this._init(e, t, i)
};
Nao = function (e) {
    function t() {
        this.listeners = [], this.currentModel = null;
        var e = this;
        this._onModelEvent = function (t, i) {
            switch (t) {
                case"selected":
                    e.currentModel = i, e.currentModel.highlight();
                    break;
                case"unselected":
                    i.unhighlight()
            }
        }, this.addListener = function (e) {
            this.listeners.push(e)
        }, this.removeListener = function (e) {
            var t = this.listeners.indexOf(e);
            t > -1 && this.listeners.slice(t, 1)
        }, this.trigger = function (e, t) {
            var i = [t];
            $.each(this.listeners, function (t, n) {
                n(i, e)
            })
        }
    }

    return e.ModelPainter = t, e
}(Nao || {}), jQuery.support.cors = !0;
var data_table_counter = 0, ICON_SHOW_MORE = "https://ncpasst.s3.amazonaws.com/assets/icon_show_comments-17a668d2f63de9eb10afbf99ecd0485f.png", ICON_HIDE_MORE = "https://ncpasst.s3.amazonaws.com/assets/icon_hide_comments-7a35e7316fa1549346171388fd184d32.png";
$.fn.dataTableExt.oApi.fnGetHiddenTrNodes = function (e) {
    for (var t = this.oApi._fnGetTrNodes(e), i = $("tbody tr", e.nTable), n = 0, s = i.length; s > n; n++) {
        var r = jQuery.inArray(i[n], t);
        -1 !== r && t.splice(r, 1)
    }
    return t
}, $.fn.dataTableExt.oApi.fnGetPageOfRow = function (e, t) {
    var i = e._iDisplayLength, n = e.oInstance.$("tr", {filter: "applied"});
    if (!(n.length <= i)) {
        var s = n.index(t), r = Math.floor(s / i);
        e.oInstance.fnPageChange(r)
    }
}, String.prototype.toCamelCase = function () {
    return this.replace(/(?:^\w|[A-Z]|\b\w)/g, function (e, t) {
        return 0 == t ? e.toLowerCase() : e.toUpperCase()
    }).replace(/\s+/g, "")
};
var currentBluespot = null, allBluespots = {}, bluespotMaxId = 0, currentBuilding = null, buildings = {}, currentFloor = null, floors = {};
downTransitionMarkerStyle = {
    externalGraphic: "https://ncpasst.s3.amazonaws.com/assets/down-56388e8e127f6fdae472d4ae475aa818.png",
    graphicWidth: 16,
    graphicHeight: 16,
    graphicXOffset: -8,
    graphicYOffset: -8
}, upTransitionMarkerStyle = {
    externalGraphic: "https://ncpasst.s3.amazonaws.com/assets/up-433d9df6bd058892c82e16426220e46e.png",
    graphicWidth: 16,
    graphicHeight: 16,
    graphicXOffset: -8,
    graphicYOffset: -8
}, updownTransitionMarkerStyle = {
    externalGraphic: "https://ncpasst.s3.amazonaws.com/assets/updown-ff42cad490d9709620c3ac2ea8e6f64a.png",
    graphicWidth: 16,
    graphicHeight: 16,
    graphicXOffset: -8,
    graphicYOffset: -8
}, graphExtremityStyle = {
    strokeColor: "#ff0000",
    fillColor: "#ff0000",
    strokeOpacity: .8,
    strokeWidth: 1,
    fillOpacity: .3,
    cursor: "default",
    pointRadius: 6
}, graphNodeStyle = {
    strokeColor: "#0000cc",
    fillColor: "#0000cc",
    strokeOpacity: .8,
    strokeWidth: 1,
    fillOpacity: .3,
    cursor: "default",
    pointRadius: 6
}, selectedgraphNodeStyle = {
    strokeColor: "#36CC00",
    fillColor: "#36CC00",
    strokeOpacity: .8,
    strokeWidth: 1,
    fillOpacity: .3,
    cursor: "default",
    pointRadius: 8
}, graphSegmentStyle = {
    strokeColor: "#0000FF",
    strokeOpacity: .5,
    strokeWidth: 4,
    display: "inline"
}, graphSegmentIndoorStyle = {
    strokeColor: "#0000FF",
    strokeOpacity: .5,
    strokeWidth: 4,
    display: "inline"
}, graphSegmentOutdoorStyle = {
    strokeColor: "#FF4000",
    strokeOpacity: .5,
    strokeWidth: 4,
    display: "inline"
}, graphBuildingTransitionStyle = {
    strokeColor: "#0499CC",
    strokeOpacity: .5,
    strokeWidth: 4,
    display: "inline"
}, selectedgraphSegmentStyle = {
    strokeColor: "#36CC00",
    strokeOpacity: .5,
    strokeWidth: 6,
    display: "inline"
}, graphTransitionStyle = {
    strokeColor: "#EF5DFC",
    strokeOpacity: .5,
    strokeWidth: 4,
    display: "inline"
}, selectedgraphTransitionStyle = {
    strokeColor: "#36CC00",
    strokeOpacity: .5,
    strokeWidth: 6,
    display: "inline"
}, Nao = function (e) {
    function t(e, t, i) {
        this.lon = e, this.lat = t, this.alt = i, this.getFloor = function () {
            return find_floor_by_lonlatalt(null, null, this.alt)
        }, this.toOLPoint = function () {
            var e = new OpenLayers.Geometry.Point(this.lon, this.lat);
            return wgs84ToMercator(e), e
        }, this.toOLLonLat = function () {
            var e = new OpenLayers.LonLat(this.lon, this.lat);
            return e.transform("EPSG:4326", "EPSG:3857")
        }, this.isValid = function () {
            return this.lon && this.lat
        }
    }

    return e.LLAPoint = t, e
}(Nao || {}), logSegmentStyle = {
    strokeColor: "#42E01B",
    strokeOpacity: .5,
    strokeWidth: 4,
    display: "inline"
}, logSegmentHighlightStyle = {strokeColor: "#D01BE0", strokeOpacity: .5, strokeWidth: 4, display: "inline"};
var currentPolygon = null, allPolygons = {}, psMap = null, baseLayer = null;
OpenLayers.Popup.FramedCloud.prototype.autoSize = !1, AutoSizeFramedCloud = OpenLayers.Class(OpenLayers.Popup.FramedCloud, {autoSize: !0});
var allResolutions = [156543.03390625, 78271.516953125, 39135.7584765625, 19567.87923828125, 9783.939619140625, 4891.9698095703125, 2445.9849047851562, 1222.9924523925781, 611.4962261962891, 305.74811309814453, 152.87405654907226, 76.43702827453613, 38.218514137268066, 19.109257068634033, 9.554628534317017, 4.777314267158508, 2.388657133579254, 1.194328566789627, .5971642833948135, .25, .2, .19, .18, .17, .16, .15, .14, .13, .12, .11, .1, .09, .08, .07, .06, .05, .03, .02, .01], site = null, Nao = Nao ? Nao : {};
Nao.Tracking = function (e) {
    function t(e, t) {
        this.floor = e, this.polygons = t ? t : []
    }

    return e.FloorCoverage = t, e
}(Nao.Tracking || {});
var Nao = Nao ? Nao : {};
Nao.Tracking = function (e) {
    function t(e, t, i, n, s) {
        var r = this;
        this.psMap = e, this.map = t, this.floorCoverages = i, this.currentFloorCoverage = null, this.controls = {}, this.currentControl = null, this.featureStyle = s, this.dirty = !1, this.buildFeatureFromPolygon = function (e) {
            var t = [];
            _.each(e, function (e) {
                var i = new OpenLayers.Geometry.Point(e[0], e[1]);
                wgs84ToMercator(i), t.push(i)
            });
            var i = new OpenLayers.Geometry.LinearRing(t);
            return new OpenLayers.Feature.Vector(i)
        }, this.buildPolygonFromFeature = function (e) {
            if (e) {
                var t = [], i = e.geometry.components;
                "OpenLayers.Geometry.Polygon" == e.geometry.CLASS_NAME && (i = e.geometry.components[0].components);
                for (var n = 0; n < i.length; n++) {
                    var s = i[n], r = new OpenLayers.Geometry.Point(s.x, s.y);
                    mercatorToWgs84(r), t[n] = [r.x, r.y]
                }
                return t
            }
        }, this.buildLayersAndFeatures = function () {
            _.each(this.floorCoverages, function (e) {
                e.layer || (e.layer = new OpenLayers.Layer.Vector("CoverageLvl" + e.floor.id), e.layer.setOpacity(0), t.addLayer(e.layer)), e.polygons && !e.features && (e.features = [], _.each(e.polygons, function (t, i) {
                    var n = r.buildFeatureFromPolygon(t);
                    r.featureStyle && (n.style = r.featureStyle), n.attributes.floorCoveragePolygonId = i, e.features[i] = n, e.layer.addFeatures([n])
                }))
            })
        }, this.buildLayersAndFeatures(), this.addActionPanel = function (e) {
            this.actionPanel = new PSButtonPanel("floor-coverage-drawer"), this.drawPolygonBtn = new PSFAButton({
                iconId: "fa fa-plus",
                title: "Draw polygon, double click to finish",
                listeners: [this]
            }), this.eraseBtn = new PSFAButton({
                iconId: "fa fa-trash-o",
                title: "Delete selected polygon",
                listeners: [this]
            }), this.actionPanel.buttons = [this.drawPolygonBtn, this.eraseBtn], this.actionPanel.addTo(e)
        }, n && this.addActionPanel(n), this.onPSButtonClicked = function (e) {
            switch (r.currentBtn && r.currentBtn.id != e && (r.currentBtn.isPressed = !1, r.currentBtn.refresh()), e) {
                case r.drawPolygonBtn.id:
                    r.currentBtn = r.drawPolygonBtn, r.drawPolygon();
                    break;
                case r.eraseBtn.id:
                    r.currentBtn = r.eraseBtn, r.erasePolygon()
            }
        }, this.drawPolygon = function () {
            this.setControl("polygon"), message = "Click to add points. Double click to finish the polygon. ESC to cancel.", this.psMap.setMapInstructions(message)
        }, this.erasePolygon = function () {
            this.setControl("erase"), "erase" == this.currentControl && this.psMap.setMapInstructions("Click on a polygon to delete it")
        }, this.setControl = function (e) {
            this.controls[e] ? r.currentControl != e ? (this.disableCurrentControl(), this.enableControl(e)) : this.disableCurrentControl() : this.disableCurrentControl()
        }, this.disableCurrentControl = function () {
            this.psMap.setMapInstructions("Drag the mouse to pan"), this.currentControl && this.controls[this.currentControl] && this.controls[this.currentControl].deactivate()
        }, this.enableControl = function (e) {
            this.currentControl = e, this.currentControl && this.controls[this.currentControl] && this.controls[this.currentControl].activate()
        }, this.createOrUpdateControls = function () {
            if (this.currentFloorCoverage) {
                var e = !this.controls.polygon;
                if (e) {
                    this.controls.polygon = new OpenLayers.Control.DrawFeature(this.vectorLayer(), OpenLayers.Handler.Polygon), this.controls.erase = new OpenLayers.Control.SelectFeature(this.vectorLayer());
                    for (var t in this.controls)this.map.addControl(this.controls[t])
                } else for (var t in this.controls)this.controls[t].setLayer ? this.controls[t].setLayer(this.vectorLayer()) : this.controls[t].layer = this.vectorLayer()
            }
        }, this.vectorLayer = function () {
            return this.currentFloorCoverage ? this.currentFloorCoverage.layer : void 0
        }, this.onFloorAboutToChange = function () {
            this.currentFloorCoverage && (this.currentFloorCoverage.layer.setOpacity(0), this.vectorLayer().events.un({
                featureselected: this.onFeatureSelected,
                featureadded: this.onPolygonAdded,
                scope: r
            })), this.disableCurrentControl(), this.currentFloorCoverage = null
        }, this.onFloorChanged = function (e) {
            e && (this.currentFloorCoverage = this.floorCoverages[e.id], this.createOrUpdateControls(), this.currentControl && this.enableControl(this.currentControl), this.vectorLayer().events.on({
                featureselected: this.onFeatureSelected,
                featureadded: this.onPolygonAdded,
                scope: r
            }), this.currentFloorCoverage.layer.setOpacity(1))
        }, this.onPolygonAdded = function (e) {
            if (this.dirty = !0, r.controls.polygon.active) {
                var t = e.feature, i = this.buildPolygonFromFeature(t);
                i && (t.attributes.floorCoveragePolygonId = this.currentFloorCoverage.features.length, this.currentFloorCoverage.features.push(t), this.currentFloorCoverage.polygons.push(i))
            }
        }, this.onFeatureSelected = function (e) {
            if ("erase" == r.currentControl) {
                var t = e.feature, i = t.attributes.floorCoveragePolygonId, n = this.currentFloorCoverage.polygons[i];
                if (n) {
                    var s = function () {
                        return confirm("Do you want to erase polygon")
                    };
                    s() && (this.dirty = !0, this.currentFloorCoverage.layer.removeFeatures([t]), this.currentFloorCoverage.polygons.splice(i, 1), this.currentFloorCoverage.features.splice(i, 1))
                }
                r.controls[r.currentControl].unselect(t)
            }
        }, this.areaForFeature = function (e) {
            var t = 0;
            return e && (t = Math.abs(Math.floor(e.geometry.getGeodesicArea(new OpenLayers.Projection("EPSG:900913"))))), t
        }, this.coverageAsJson = function () {
            var e = {};
            return _.each(this.floorCoverages, function (t) {
                if (t.polygons && t.polygons.length > 0) {
                    var i = {polygons: t.polygons, area: r.areaForFloorCoverage(t)};
                    e[t.floor.id] = i
                }
            }), e
        }, this.areaForFloorCoverage = function (e) {
            var t = 0;
            return e.features && _.each(e.features, function (e) {
                t += r.areaForFeature(e)
            }), t
        }
    }

    return e.FloorCoveragePresenter = t, e
}(Nao.Tracking || {});
var Nao = Nao ? Nao : {};
Nao.Tracking = function (e) {
    function t(e, t) {
        this.endpoint = e, this.refreshRate = t
    }

    return e.NaoDefaultTracker = t, e
}(Nao.Tracking || {});
var Nao = Nao ? Nao : {};
Nao.Tracking = function (e) {
    function t(e, t, i, n, s, r, a, o, l, h) {
        Interface.ensureImplements(this, MapTableModel), this.id = e, this.code = t, this.name = i, this.category = n, this.color = s, this.type = l, this.properties = h, this.setLLAPoint(r, o, a)
    }

    return t.prototype = new Nao.MultiFeatureModel, t.prototype.constructor = t, t.prototype.features = function () {
        var e = [];
        return this.feature && e.push(this.feature), this.uncertaintyFeature && e.push(this.uncertaintyFeature), e
    }, t.prototype.date = function () {
        return this.lastUpdatedAt
    }, t.prototype.time = function () {
        return this.lastUpdatedAt ? this.lastUpdatedAt.substring(11) : ""
    }, t.prototype.toString = function () {
        return this.id + " : " + this.name
    }, t.prototype.setLLAPoint = function (e, t, i) {
        return this.llaPoint = e, this.center = this.llaPoint.toOLLonLat(), this.lastUpdatedAt = t, this.uncertainty = i, this.feature ? e.isValid() ? this.moveFeature(this.time(), this.llaPoint, this.uncertainty) : this.deleteFeature() : e.isValid() && this.createFeature(this.time(), this.llaPoint, this.code, this.color, this.uncertainty), this
    }, t.prototype.deleteFeature = function () {
        this.feature.layer.removeFeatures([this.feature]), this.uncertaintyFeature.layer.removeFeatures([this.uncertaintyFeature]), this.feature = null, this.uncertaintyFeature = null
    }, t.prototype.createFeature = function (e, t, i, n, s) {
        var r = t.toOLPoint(), a = t.getFloor();
        n = n ? n : "#b5d", this.feature = new OpenLayers.Feature.Vector(r, {
            text: i,
            color: n,
            time: e,
            uncertainty: s
        }), a.trackablesLayer.addFeatures([this.feature]), this.uncertaintyFeature = new OpenLayers.Feature.Vector(r.clone(), {uncertainty: s}), a.uncertaintyLayer.addFeatures([this.uncertaintyFeature]), this._isSelected && this.highlight()
    }, t.prototype.moveFeature = function (e, t, i) {
        this.feature.attributes.time = e, this.uncertaintyFeature.attributes.uncertainty = i;
        var n = t.toOLLonLat(), s = t.getFloor();
        s.trackablesLayer == this.feature.layer ? (this.feature.move(n), this.uncertaintyFeature.move(n.clone())) : (this.feature.layer.removeFeatures([this.feature]), this.uncertaintyFeature.layer.removeFeatures([this.uncertaintyFeature]), s.trackablesLayer.addFeatures([this.feature]), s.uncertaintyLayer.addFeatures([this.uncertaintyFeature]), this._isSelected && this.highlight())
    }, t.prototype.getFloor = function () {
        return this.llaPoint.getFloor()
    }, e.Trackable = t, e
}(Nao.Tracking || {});
var Nao = Nao ? Nao : {};
Nao.Tracking = function (e) {
    function t(e, t, i) {
        var n = this;
        this.trackable = e, this.locations = t, this.features = [];
        for (var s = 0; s < this.locations.length; s++) {
            var r = this.locations[s];
            r.llaPoint = new Nao.LLAPoint(r.lon, r.lat, r.alt);
            var a = r.llaPoint.getFloor();
            if (a) {
                var o = new OpenLayers.Feature.Vector(r.llaPoint.toOLPoint());
                a.trackableHistoryLayer || (a.trackableHistoryLayer = new OpenLayers.Layer.Vector("TrackableHistory"), i.addLayer(a.trackableHistoryLayer), a.trackableHistoryLayer.setOpacity(a.isCurrentFloor() ? 1 : 0), a.additionalLayers.push(a.trackableHistoryLayer)), a.trackableHistoryLayer.addFeatures(o), this.features.push(o)
            } else alert("ERROR: cannot find floor for location " + r)
        }
        this.nblocations = n.locations.length, this.actionPanel = new PSButtonPanel("custom-tools"), this.timeSlider = new PSSlider({
            text: "Timeline",
            min: 1,
            max: this.nblocations,
            width: 500,
            step: 1,
            value: this.nblocations,
            listeners: [this]
        }), this.actionPanel.buttons = [this.timeSlider], this.actionPanel.addTo("map_zone_header"), this.onPSSliderChanged = function (t, i) {
            switch (t) {
                case n.timeSlider.id:
                    var s = i - 1, r = n.locations[Math.round(s)];
                    n.trackable.setLLAPoint(r.llaPoint, r.date);
                    var a = e.getFloor();
                    a && a.id != n.currentFloorId && (n.currentFloorId = a.id, a.setAsCurrent())
            }
        }
    }

    return e.TrackableHistory = t, e
}(Nao.Tracking || {});
var Nao = Nao ? Nao : {};
Nao.Tracking = function (my) {
    function TrackablesPainter(tracker, psMap, floors) {
        var self = this;
        this.trackables = {}, this.liveLocationUpdate = !1, this.tracker = tracker, this.tracker && this.tracker.logo_url && (psMap.setMapTitle(this.tracker.mapTitleHtml()), psMap.addMapAttribution(this.tracker.dataAttributionHtml())), this.toggleLiveLocationUpdate = function () {
            self.liveLocationUpdate ? self.stopLiveLocationUpdate() : self.startLiveLocationUpdate()
        }, this.processData = function (data) {
            if (data) {
                "string" == typeof data && (data = eval("(" + data + ")")), Array.isArray(data) || (data = [data]);
                for (var i = 0; i < data.length; i++) {
                    var trackable_json = data[i];
                    self.tracker && self.tracker.formatData && (trackable_json = self.tracker.formatData(trackable_json));
                    var llaPoint = new Nao.LLAPoint(trackable_json.lon, trackable_json.lat, trackable_json.alt), floor = llaPoint.getFloor();
                    if (floor) {
                        var trackable = self.trackables[trackable_json.id];
                        trackable ? (trackable.setLLAPoint(llaPoint, trackable_json.loc_updated_at, trackable_json.loc_uncertainty), self.trigger("updated", trackable)) : (trackable = self.addTrackable(trackable_json, llaPoint), self.trigger("added", trackable))
                    }
                }
            }
        }, this.updateTrackableLocations = function () {
            $.get(self.tracker.endpoint, function (e) {
                self.dataAvailable(), self.processData(e), self.liveLocationUpdate && setTimeout(self.updateTrackableLocations, 1e3 * self.tracker.refreshRate)
            }).fail(function () {
                alert("ERROR: Cannot update trackables and their locations")
            })
        }, this.dataAvailable = function () {
            return Object.size(this.trackables) > 0
        }, this.addTrackable = function (e, t) {
            var i = new Nao.Tracking.Trackable(e.id, e.code, e.name, e.category, e.color, t, e.loc_uncertainty, e.loc_updated_at, e.kind, {trackingid: e.tracking_id});
            return self.trackables[i.getId()] = i, i
        }, this.redraw = function () {
            currentFloorId && floors[currentFloorId] && floors[currentFloorId].redraw()
        };
        var currentFloorId = null, style = new OpenLayers.Style({
            label: "${getTime}",
            labelYOffset: 47,
            labelOutlineColor: "white",
            labelOutlineWidth: 3,
            pointRadius: 18,
            graphicName: "fa-blazon",
            backgroundGraphic: "",
            fillColor: "${getFillColor}",
            gradient: "",
            symbolYOffset: -20,
            symbolXOffset: 0,
            rotation: 0,
            faLabel: "${getText}",
            faColor: "#fff",
            faSize: .6,
            faLabel_1: "none",
            faColor_1: "#fff",
            faSize_1: .6,
            faLabel_2: "none",
            faColor_2: "red",
            faSize_2: 1,
            strokeWidth: "${getStrockeWidth}",
            stroke: !0,
            strokeColor: "${getStrockeColor}",
            backgroundXOffset: 0,
            backgroundYOffset: 0,
            graphicZIndex: 11,
            backgroundGraphicZIndex: 10
        }, {
            context: {
                getTime: function (e) {
                    return e.attributes.time
                }, getText: function (e) {
                    return e.attributes.text
                }, getFillColor: function (e) {
                    return e.attributes.color
                }, getStrockeColor: function (e) {
                    return e.attributes.isHighlighted ? "#FF0000" : "#fff"
                }, getStrockeWidth: function (e) {
                    return e.attributes.isHighlighted ? 5 : 2
                }
            }
        }), uncertaintyStyle = new OpenLayers.Style({
            fillColor: "#33BBE8",
            strokeWidth: 0,
            pointRadius: "${getRadius}",
            fillOpacity: "${getOpacity}"
        }, {
            context: {
                getRadius: function (e) {
                    return e.attributes.uncertainty / e.layer.map.getResolution()
                }, getOpacity: function (e) {
                    return e.attributes.isHighlighted ? .5 : 0
                }
            }
        });
        this.initialize = function () {
            this.initIconsLayers()
        }, this.initIconsLayers = function () {
            for (var e in floors) {
                var t = floors[e], i = new OpenLayers.Layer.Vector("Trackables", {
                    visibility: !0,
                    rendererOptions: {yOrdering: !0},
                    styleMap: new OpenLayers.StyleMap({
                        "default": style,
                        select: {pointRadius: 24, symbolYOffset: -24, backgroundYOffset: -32}
                    })
                });
                t.additionalLayers.push(i), i.setOpacity(t.isCurrentFloor() ? 1 : 0), t.trackablesLayer = i;
                var n = new OpenLayers.Layer.Vector("TrackableUncertainties", {
                    visibility: !0,
                    styleMap: new OpenLayers.StyleMap({"default": uncertaintyStyle})
                });
                t.additionalLayers.push(n), n.setOpacity(t.isCurrentFloor() ? 1 : 0), t.uncertaintyLayer = n, psMap.map.addLayers([n, i]), i.setZIndex(parseInt(i.getZIndex() + 5))
            }
        }, this.startLiveLocationUpdate = function () {
            self.liveLocationUpdate = !0, self.updateTrackableLocations()
        }, this.stopLiveLocationUpdate = function () {
            self.liveLocationUpdate = !1
        }, this.initialize()
    }

    return TrackablesPainter.prototype = new Nao.ModelPainter, TrackablesPainter.prototype.constructor = TrackablesPainter, my.TrackablesPainter = TrackablesPainter, my
}(Nao.Tracking || {});
var Nao = Nao ? Nao : {};
Nao.Tracking = function (e) {
    function t(e, t, i, n, s) {
        var r = function () {
            var t = s.replace("-1", e.currentModel.id);
            window.location = t
        }, a = function () {
            window.location = n
        }, o = function () {
            if (e.currentModel) {
                var t = i.replace("-1", e.currentModel.id);
                window.location = t
            }
        }, l = function () {
            e.toggleLiveLocationUpdate(), e.liveLocationUpdate ? p.updateIcon("fa-stop") : p.updateIcon("fa-play")
        }, h = new PSButtonPanel("custom-tools");
        h.css_klass = "";
        var u = new PSFAButton({
            iconId: "fa-plus",
            title: "Add trackable object",
            listeners: [{onPSButtonClicked: a}]
        }), c = new PSFAButton({
            iconId: "fa-pencil",
            title: "Modify selected item",
            listeners: [{onPSButtonClicked: o}]
        }), p = new PSFAButton({
            iconId: "fa-play",
            title: "Live location update",
            listeners: [{onPSButtonClicked: l}]
        }), d = new PSFAButton({
            iconId: "fa-clock-o",
            title: "History of selected item",
            listeners: [{onPSButtonClicked: r}]
        });
        h.buttons = [d, c, u], h.addTo(t)
    }

    return e.TrackablesToolbar = t, e
}(Nao.Tracking || {});
var Nao = Nao ? Nao : {};
Nao.Tracking = function (e) {
    function t(e, t) {
        this.ps_company_url = "http://www.polestar.eu", this.ps_logo_url = "http://www.polestar.eu/public/page/logo.png", this.logo_url = "http://uwinloc.com/wp-content/uploads/2016/03/uwinloc_entier_CMJN_trans.jpg", this.company_url = "http://uwinloc.com", this.endpoint = e, this.refreshRate = t, this.mapTitleHtml = function () {
            var e = '<a target="_blank" href="' + this.ps_company_url + '">';
            return e += '<img src="' + this.ps_logo_url + '" style="height:2em"/>', e += "</a>", e += '<a target="_blank" href="' + this.company_url + '">', e += '<img src="' + this.logo_url + '" style="height:3em"/>', e += "</a>"
        }, this.dataAttributionHtml = function () {
            var e = '<span class="text-muted">Tracking data from </span><a target="_blank" href="' + this.company_url + '"><img src="' + this.logo_url + '" style="height:2em"/></a>.';
            return e
        }, this.formatData = function (e) {
            var t = e;
            if (!t.id && t.ID && (t.id = t.ID), t.name || (t.name = "T" + t.id.toString()), !t.lon && t.Pos && t.Pos.LLA && (t.lon = t.Pos.LLA.Lon, t.lat = t.Pos.LLA.Lat, t.alt = Math.round(t.Pos.LLA.Alt)), !t.loc_updated_at && t.Pos && t.Pos.T) {
                var i = new Date(t.Pos.T), n = i.getFullYear().toString(), s = (i.getMonth() + 1).toString(), r = i.getDate().toString(), a = i.getHours().toString(), o = i.getMinutes().toString(), l = i.getSeconds().toString(), h = n + "/" + (s[1] ? s : "0" + s[0]) + "/" + (r[1] ? r : "0" + r[0]);
                h += " " + (a[1] ? a : "0" + a[0]) + ":" + (o[1] ? o : "0" + o[0]) + ":" + (l[1] ? l : "0" + l[0]), t.loc_updated_at = h
            }
            return t.color || (t.color = "#b5d"), t.category || (t.category = "Tag"), t
        }
    }

    return e.UwinlocTracker = t, e
}(Nao.Tracking || {}), /* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
    OpenLayers.Renderer.DrawAlwaysRenderer = OpenLayers.Class(OpenLayers.Renderer, {
        drawFeature: function (e, t) {
            if (log("drawFeature"), null == t && (t = e.style), e.geometry) {
                var i = e.geometry.getBounds();
                if (i) {
                    i.intersectsBounds(this.extent) || "undefined" != e.attributes.render && "drawAlways" == e.attributes.render || (t = {display: "none"});
                    var n = this.drawGeometry(e.geometry, t, e.id);
                    return n
                }
            }
        }, CLASS_NAME: "OpenLayers.Renderer.DrawAlwaysRenderer"
    }), /* Copyright (c) 2015 by Jean-Marc.Viglino [at]ign.fr
 * Dual-licensed under the CeCILL-B Licence (http://www.cecill.info/)
 * and the Beerware license (http://en.wikipedia.org/wiki/Beerware),
 * feel free to use and abuse it in your projects (the code, not the beer ;-).
 */
    function () {
        var e = OpenLayers.Renderer.SVG.prototype.setStyle, t = new RegExp(OpenLayers.Renderer.Elements.prototype.BACKGROUND_ID_SUFFIX + "$");
        new OpenLayers.Format.JSON, OpenLayers.Renderer.SVG.prototype.setStyle = function (i, n) {
            if ("OpenLayers.Geometry.Point" != i._geometryClass || t.test(i.id)) e.apply(this, arguments); else {
                for (var s = [], r = 0; ; r++) {
                    var a = 0 != r ? "_" + r : "";
                    if (!n["faLabel" + a])break;
                    if ("none" != n["faLabel" + a]) {
                        var o, l;
                        if (l = n["faLabel" + a], "string" == typeof l)switch (n["faLabel" + a].substring(0, 2)) {
                            case"fa":
                                o = "FontAwesome", l = OpenLayers.Renderer.fontawesomeicons[n["faLabel" + a]];
                                break;
                            case"io":
                                o = "Ionicons", l = OpenLayers.Renderer.ionicons[n["faLabel" + a]];
                                break;
                            case"gi":
                                o = "Glyphicons Regular", l = OpenLayers.Renderer.glyphicons[n["faLabel" + a]];
                                break;
                            case"bs":
                                o = "Glyphicons Halflings", l = OpenLayers.Renderer.bootstrapicons[n["faLabel" + a]];
                                break;
                            default:
                                l = n["faLabel" + a]
                        }
                        var h = this.nodeFactory(null, "text"), u = 100, c = n["faSize" + a] ? u * n["faSize" + a] : 60;
                        h.setAttributeNS(null, "fill", n["faColor" + a] || n.strokeColor), h.textContent = l, h.setAttributeNS(null, "x", n["faXOffset" + a] || 0 === n["faXOffset" + a] ? u * n["faXOffset" + a] : 50), h.setAttributeNS(null, "y", n["faYOffset" + a] || 0 === n["faYOffset" + a] ? u * n["faYOffset" + a] : 50 + .35 * c), n.rotation && h.setAttributeNS(null, "transform", "rotate(" + n.rotation + " 50 50)"), h.setAttributeNS(null, "stroke", n["faSColor" + a] || "none"), h.setAttributeNS(null, "font-family", n["faFont" + a] || o), h.setAttributeNS(null, "text-anchor", "middle"), h.setAttributeNS(null, "font-size", c), s.push(h)
                    }
                }
                if (s.length) {
                    for (/^fa-/.test(n.graphicName) || (n.graphicName = "fa-none"); i.firstChild;)i.removeChild(i.firstChild);
                    if (e.apply(this, arguments), i.firstChild)if ("fa-none" == n.graphicName) i.removeChild(i.firstChild); else if ("fa-circle" == n.graphicName) {
                        i.removeChild(i.firstChild);
                        var p = this.nodeFactory(null, "circle");
                        p.setAttributeNS(null, "r", 50), p.setAttributeNS(null, "cx", 50), p.setAttributeNS(null, "cy", 50), i.appendChild(p)
                    }
                    if (i.firstChild && n.gradient) {
                        for (var d = this.createDefs(), f = !1, m = d.childNodes, g = n.gradient, y = n.gradient.split("-"), v = 0; v < m.length; v++)if (m[v].id == g) {
                            f = !0;
                            break
                        }
                        if (!f) {
                            var b = this.nodeFactory(null, "linearGradient");
                            b.setAttribute("id", g), b.setAttribute("x1", "0%"), b.setAttribute("x2", "100%"), b.setAttribute("y1", "0%"), b.setAttribute("y2", "100%");
                            var L = this.nodeFactory(null, "stop");
                            L.setAttribute("offset", "0%"), L.setAttribute("style", "stop-color:" + y[1] + "; stop-opacity:1;"), b.appendChild(L);
                            var L = this.nodeFactory(null, "stop");
                            L.setAttribute("offset", "100%"), L.setAttribute("style", "stop-color:" + y[2] + "; stop-opacity:1;"), b.appendChild(L), d.appendChild(b)
                        }
                        i.firstChild.style.fill = "url(#" + g + ")"
                    }
                    for (var r = 0; r < s.length; r++)i.appendChild(s[r]);
                    n.symbolXOffset && i.setAttributeNS(null, "x", Number(i.getAttributeNS(null, "x")) + n.symbolXOffset), n.symbolYOffset && i.setAttributeNS(null, "y", Number(i.getAttributeNS(null, "y")) + n.symbolYOffset)
                } else e.apply(this, arguments)
            }
            return i
        }, OpenLayers.Renderer.symbol["fa-none"] = [0, 0, 100, 100], OpenLayers.Renderer.symbol["fa-circle"] = [0, 0, 100, 100], OpenLayers.Renderer.symbol["fa-square"] = [0, 0, 0, 100, 100, 100, 100, 0, 0, 0], OpenLayers.Renderer.symbol["fa-triangle"] = [0, 0, 50, 120, 100, 0, 0, 0], OpenLayers.Renderer.symbol["fa-diamond"] = [25, 0, 0, 25, 0, 40, 50, 130, 100, 40, 100, 25, 75, 0, 25, 0], OpenLayers.Renderer.symbol["fa-hexagon"] = [50, 0, 5, 20, 5, 80, 50, 100, 95, 80, 95, 20, 50, 0], OpenLayers.Renderer.symbol["fa-blazon"] = [5, 0, 0, 5, 0, 95, 5, 100, 30, 100, 50, 120, 70, 100, 95, 100, 100, 95, 100, 5, 95, 0, 5, 0], OpenLayers.Renderer.symbol["fa-shield"] = [5, 0, 0, 5, 0, 90, 5, 95, 50, 115, 95, 95, 100, 90, 100, 5, 95, 0, 5, 0], OpenLayers.Renderer.symbol["fa-bookmark"] = [0, 0, 0, 120, 50, 100, 100, 120, 100, 0, 0, 0], OpenLayers.Renderer.symbol["fa-tag"] = [100, 50, 100, 55, 97, 67, 61, 143, 58, 147, 53, 150, 50, 150, 47, 150, 42, 147, 39, 143, 3, 67, 0, 55, 0, 50, 1, 40, 4, 31, 8, 22, 15, 15, 22, 8, 31, 4, 40, 1, 50, 0, 60, 1, 69, 4, 78, 8, 85, 15, 92, 22, 96, 31, 99, 40], OpenLayers.Renderer.symbol["fa-marker"] = [99, 49, 98, 54, 98, 59, 96, 64, 95, 69, 93, 73, 90, 77, 87, 81, 49, 125, 11, 81, 8, 77, 6, 73, 4, 69, 2, 64, 1, 59, 0, 54, 0, 49, 0, 44, 1, 39, 2, 35, 4, 30, 6, 26, 8, 22, 11, 18, 14, 14, 18, 11, 22, 8, 26, 6, 30, 4, 35, 2, 39, 1, 44, 0, 49, 0, 54, 0, 59, 1, 64, 2, 69, 4, 73, 6, 77, 8, 81, 11, 84, 14, 87, 18, 90, 22, 93, 26, 95, 30, 96, 35, 98, 39, 98, 44], OpenLayers.Renderer.symbol["fa-pin"] = [99, 59, 91, 78, 78, 91, 60, 99, 50, 99, 50, 165, 50, 99, 40, 99, 21, 91, 8, 78, 0, 60, 0, 40, 8, 21, 21, 8, 39, 0, 59, 0, 78, 8, 91, 21, 99, 40, 99, 59], OpenLayers.Renderer.symbol["fa-bubble"] = [99, 50, 99, 55, 98, 59, 97, 64, 95, 69, 93, 73, 91, 77, 88, 81, 85, 85, 81, 88, 77, 91, 73, 93, 69, 95, 64, 97, 50, 132, 35, 97, 30, 95, 26, 93, 22, 91, 18, 88, 14, 85, 11, 81, 8, 77, 6, 73, 4, 69, 2, 64, 1, 59, 0, 55, 0, 50, 0, 44, 1, 40, 2, 35, 4, 30, 6, 26, 8, 22, 11, 18, 14, 14, 18, 11, 22, 8, 26, 6, 30, 4, 35, 2, 40, 1, 44, 0, 50, 0, 55, 0, 59, 1, 64, 2, 69, 4, 73, 6, 77, 8, 81, 11, 85, 14, 88, 18, 91, 22, 93, 26, 95, 30, 97, 35, 98, 40, 99, 44], OpenLayers.Renderer.symbol["fa-gear"] = [8, 22, 22, 8, 33, 16, 39, 14, 41, 0, 59, 0, 61, 14, 67, 16, 78, 8, 91, 22, 83, 33, 86, 39, 100, 41, 100, 59, 86, 61, 83, 67, 92, 78, 78, 92, 67, 83, 61, 86, 59, 100, 41, 100, 39, 86, 33, 83, 22, 92, 8, 78, 17, 67, 14, 61, 0, 59, 0, 40, 14, 38, 17, 32], OpenLayers.Renderer.symbol["fa-coma"] = [38, 1, 29, 5, 21, 9, 14, 16, 8, 23, 4, 31, 1, 41, 0, 50, 1, 61, 4, 70, 9, 79, 15, 86, 22, 92, 31, 97, 31, 97, 46, 102, 46, 102, 46, 102, 58, 110, 58, 110, 58, 110, 61, 117, 61, 117, 61, 117, 61, 125, 61, 125, 61, 125, 58, 137, 58, 137, 58, 137, 50, 151, 62, 144, 72, 135, 80, 124, 87, 111, 92, 97, 96, 82, 100, 61, 101, 50, 100, 40, 97, 31, 92, 22, 86, 15, 78, 9, 70, 4, 60, 1, 50, 0, 38, 1]
    }(), /* Copyright (c) 2006-2012 by OpenLayers Contributors (see authors.txt for
 * full list of contributors). Published under the 2-clause BSD license.
 * See license.txt in the OpenLayers distribution or repository for the
 * full text of the license. */
    OpenLayers.Renderer.Heatmap = OpenLayers.Class(OpenLayers.Renderer.Canvas, {
        hitDetection: !1,
        drawPoint: function (e, t) {
            var i = this.getLocalXY(e), n = i[0], s = i[1];
            if (t.weight && !isNaN(n) && !isNaN(s)) {
                var r = this.canvas.createRadialGradient(n, s, 0, n, s, t.pointRadius);
                r.addColorStop(0, "rgba(255, 255, 255," + String(t.weight) + ")"), r.addColorStop(1, "rgba(255, 255, 255, 0)"), this.canvas.fillStyle = r, this.canvas.fillRect(n - t.pointRadius, s - t.pointRadius, 2 * t.pointRadius, 2 * t.pointRadius)
            }
        },
        drawLineString: function () {
        },
        drawLinearRing: function () {
        },
        drawPolygon: function () {
        },
        redraw: function () {
            if (OpenLayers.Renderer.Canvas.prototype.redraw.apply(this, arguments), !this.locked) {
                for (var e = this.canvas.getImageData(0, 0, this.root.width, this.root.height), t = 0; t < this.root.width; t++)for (var i = 0; i < this.root.height; i++) {
                    var n = 4 * (i * this.root.width + t), s = e.data[n + 3];
                    if (s > 0) {
                        var r = 270 * (1 - s / 255), a = OpenLayers.Util.hsl2rgb([r, 100, 50]);
                        e.data[n] = a[0], e.data[n + 1] = a[1], e.data[n + 2] = a[2]
                    }
                }
                this.canvas.putImageData(e, 0, 0)
            }
        },
        CLASS_NAME: "OpenLayers.Renderer.Heatmap"
    }), OpenLayers.Util.hsl2rgb = function (e) {
    var t, i, n, s, r, a = e[0] / 360, o = e[1] / 100, l = e[2] / 100;
    if (0 == o)return r = 255 * l, [r, r, r];
    i = .5 > l ? l * (1 + o) : l + o - l * o, t = 2 * l - i, s = [0, 0, 0];
    for (var h = 0; 3 > h; h++)n = a + 1 / 3 * -(h - 1), 0 > n && n++, n > 1 && n--, r = 1 > 6 * n ? t + 6 * (i - t) * n : 1 > 2 * n ? i : 2 > 3 * n ? t + 6 * (i - t) * (2 / 3 - n) : t, s[h] = 255 * r;
    return s
};
var bootcards = bootcards || {portraitModeEnabled: !1, _isXS: null, isFullScreen: !1};
bootcards.init = function (e) {
    this.isFullScreen = "standalone" in navigator && navigator.standalone, $(document).ready(function () {
        Bootcards.init(e), Bootcards.OffCanvas.init(), Bootcards.options.enableTabletPortraitMode && bootcards._initTabletPortraitMode(), Bootcards.options.disableRubberBanding && bootcards.disableRubberBanding()
    }), this.isFullScreen && e.disableBreakoutSelector && $(document).on("click", e.disableBreakoutSelector, function (e) {
        e.preventDefault(), location.href = $(e.target).prop("href")
    })
}, bootcards.isXS = function () {
    if (null === this._isXS) {
        var e = $("<div class='visible-xs'>").appendTo($("body"));
        this._isXS = e.is(":visible"), e.remove()
    }
    return this._isXS
}, bootcards.disableRubberBanding = function () {
    document.body.addEventListener("touchstart", function () {
        document.body.addEventListener("touchmove", function e(t) {
            document.body.removeEventListener("touchmove", e);
            var i = t.target;
            do {
                var n = parseInt(window.getComputedStyle(i, null).height, 10), s = i.scrollHeight;
                if (s > n)return
            } while (i != document.body && i.parentElement != document.body && (i = i.parentElement));
            t.preventDefault()
        })
    })
};
var Bootcards = function () {
    return this.$mainContentEl = null, this.options = null, {
        init: function (e) {
            this.$mainContentEl = $(".bootcards-container"), this.options = $.extend({}, Bootcards.DEFAULTS, e)
        }
    }
}();
Bootcards.DEFAULTS = {
    offCanvasHideOnMainClick: !1,
    offCanvasBackdrop: !1,
    enableTabletPortraitMode: !1,
    disableRubberBanding: !1,
    disableBreakoutSelector: null
}, function (e) {
    return e.OffCanvas = {
        $backdrop: null,
        $toggleEl: null,
        $menuEl: null,
        $menuTitleEl: null,
        offCanvasHideOnMainClick: !1,
        offCanvasBackdrop: !1,
        init: function () {
            this.offCanvasHideOnMainClick = e.options.offCanvasHideOnMainClick, this.offCanvasBackdrop = e.options.offCanvasBackdrop, this.$toggleEl = $("[data-toggle=offcanvas]"), this.$menuEl = $(".offcanvas"), this.$menuEl.length > 0 && this.$toggleEl.length > 0 && this.$toggleEl.on("click", function () {
                e.OffCanvas.toggle()
            }), this.offCanvasHideOnMainClick && e.$mainContentEl && e.$mainContentEl.on("click", function () {
                e.OffCanvas.hide()
            })
        },
        toggle: function () {
            this.$menuEl.hasClass("active") ? this.hide() : this.show()
        },
        show: function () {
            this.showBackdrop(), this.$toggleEl.css("opacity", ""), this.$menuEl.addClass("active"), this.offCanvasHideOnMainClick && e.$mainContentEl && e.$mainContentEl.addClass("active-left")
        },
        hide: function () {
            this.hideBackdrop(), this.$toggleEl && this.$toggleEl.css("opacity", "1"), this.$menuEl && this.$menuEl.removeClass("active"), this.offCanvasHideOnMainClick && e.$mainContentEl && e.$mainContentEl.removeClass("active-left"), this.$menuTitleEl && this.$menuTitleEl.removeClass("active")
        },
        showBackdrop: function () {
            this.offCanvasBackdrop && (this.$backdrop = $('<div class="modal-backdrop fade in" />').appendTo(e.$mainContentEl))
        },
        hideBackdrop: function () {
            this.offCanvasBackdrop && (this.$backdrop && this.$backdrop.remove(), this.$backdrop = null)
        },
        showToggleEl: function () {
            this.$toggleEl && this.$toggleEl.show()
        },
        hideToggleEl: function () {
            this.$toggleEl && this.$toggleEl.hide()
        },
        insertToggleButton: function (t) {
            this.$menuTitleEl = $("<div class='offcanvas-list offcanvas-list-title'><span>Menu</span></div>"), this.$menuEl.before(this.$menuTitleEl), this.$toggleEl.clone(!1).prependTo(t).on("click", function () {
                e.OffCanvas.$menuEl.toggleClass("active"), e.OffCanvas.$menuTitleEl.toggleClass("active")
            }).children("i").removeClass("fa-bars").addClass("fa-angle-left")
        }
    }, e
}(Bootcards), bootcards.enablePortraitMode = function () {
    return "undefined" == typeof window.orientation || bootcards.isXS() ? !1 : !0
}, bootcards._initTabletPortraitMode = function () {
    "undefined" == typeof window.orientation || bootcards.isXS() || (bootcards.portraitModeEnabled = !0, $(window).on("resize", function () {
        setTimeout(function () {
            bootcards._setOrientation(!1)
        }, 250)
    }).on("load", bootcards._setOrientation(!0)))
}, bootcards._setOrientation = function (e) {
    if (bootcards.portraitModeEnabled) {
        var t = $(window).width() > $(window).height() ? !1 : !0;
        if (Bootcards.OffCanvas.hide(), bootcards._initListEl(), bootcards._initCardsEl(), t) {
            if (0 === bootcards.listEl.length)return void Bootcards.OffCanvas.showToggleEl();
            e && bootcards.listEl.hide(), bootcards.cardsEl.removeClass(bootcards.cardsColClass).addClass("col-xs-12"), $(".bootcards-az-picker").hide(), bootcards.listOffcanvasToggle || (bootcards.listOffcanvasToggle = $('<button type="button" class="btn btn-default pull-left offcanvaslist-toggle"><i class="fa fa-lg fa-angle-left"></i><span>' + bootcards.listTitle + "</span></button>").on("click", function () {
                bootcards.listTitleEl.hasClass("active") ? Bootcards.OffCanvas.hideBackdrop() : Bootcards.OffCanvas.showBackdrop(), bootcards.listEl.toggleClass("active"), bootcards.listTitleEl.toggleClass("active")
            }), bootcards.listTitleEl = $("<div class='offcanvas-list offcanvas-list-title'><span>" + bootcards.listTitle + "</span></div>"), Bootcards.OffCanvas.$toggleEl && Bootcards.OffCanvas.insertToggleButton(bootcards.listTitleEl), $(".navbar-header").after(bootcards.listTitleEl, bootcards.listOffcanvasToggle), Bootcards.$mainContentEl.on("click", function () {
                bootcards.listEl.removeClass("active"), bootcards.listTitleEl.removeClass("active"), Bootcards.OffCanvas.$menuTitleEl.removeClass("active"), Bootcards.OffCanvas.hideBackdrop()
            }), bootcards.listEl.on("click", function () {
                bootcards.listEl.removeClass("active"), bootcards.listTitleEl.removeClass("active"), Bootcards.OffCanvas.hideBackdrop()
            }), Bootcards.OffCanvas.$menuEl && Bootcards.OffCanvas.$menuEl.addClass("offcanvas-list").on("click", function () {
                var e = $(this);
                e.removeClass("active"), Bootcards.OffCanvas.hide(), bootcards.listEl && bootcards.listEl.removeClass("active"), bootcards.listTitleEl && bootcards.listTitleEl.removeClass("active")
            })), Bootcards.OffCanvas.hideToggleEl(), bootcards.listOffcanvasToggle.show(), bootcards.listEl.removeClass(bootcards.listColClass).addClass("offcanvas-list").show()
        } else Bootcards.OffCanvas.showToggleEl(), bootcards.listEl && bootcards.listEl.hasClass("offcanvas-list") && (bootcards.listEl.removeClass("offcanvas-list active").addClass(bootcards.listColClass).show(), bootcards.listEl.css("overflow", "hidden"), setTimeout(function () {
            bootcards.listEl.css("overflow-y", "auto")
        }, 300)), bootcards.listOffcanvasToggle && (bootcards.listOffcanvasToggle.hide(), bootcards.listTitleEl.removeClass("active")), bootcards.cardsEl && bootcards.cardsEl.removeClass("col-xs-12").addClass(bootcards.cardsColClass), $(".bootcards-az-picker").show()
    }
}, bootcards._initListEl = function () {
    return null != bootcards.listEl ? bootcards.listEl : (bootcards.listEl = $(".bootcards-list"), bootcards.listColClass = "", void(bootcards.listEl.length > 0 && (bootcards.listTitle = bootcards.listEl.data("title") || "List", $.each(bootcards.listEl.prop("class").split(" "), function (e, t) {
        0 === t.indexOf("col") && (bootcards.listColClass += t + " ")
    }))))
}, bootcards._initCardsEl = function () {
    return null != bootcards.cardsEl ? bootcards.cardsEl : (bootcards.cardsEl = $(".bootcards-cards"), bootcards.cardsColClass = "", void(bootcards.cardsEl.length > 0 && $.each(bootcards.cardsEl.prop("class").split(" "), function (e, t) {
        0 === t.indexOf("col") && (bootcards.cardsColClass += t + " ")
    })))
}, bootcards.initAZPicker = function (e) {
    var t = $(e);
    if (t.length > 0) {
        $("a", t).off().on("click", function (e) {
            var t = $(this);
            return e.stopPropagation(), bootcards._jumpToLetter(t, e), !1
        });
        var i = t.parents(".bootcards-list");
        if (i.length > 0) {
            var n = i.attr("class").split(/\s+/), s = "";
            $.each(n, function (e, t) {
                return 0 === t.indexOf("col-") ? void(s = t) : void 0
            });
            var r = s.substring(s.lastIndexOf("-") + 1), a = s.substring(0, s.lastIndexOf("-")) + "-push-" + r;
            t.appendTo($(".bootcards-container")).addClass(a)
        }
    }
}, bootcards._jumpToLetter = function (e) {
    var t = $("#list");
    t.animate({scrollTop: 0}, 0);
    var i = e.text().toLowerCase(), n = "#list .list-group a";
    $(".bootcards-list-subheading").length > 0 && (n = ".bootcards-list-subheading");
    var s = $(n), r = !1;
    if (s.each(function (e, n) {
            var s = $(n), a = "";
            a = "a" == s.prop("tagName").toLowerCase() ? s.find("h4").text() : s.text();
            var o = a.substring(0, 1).toLowerCase(), l = null;
            return o == i ? l = s.offset().top - 60 : o > i && (l = s.offset().top - 120), null !== l ? (t.animate({scrollTop: l}, 0), r = !0, !1) : void 0
        }), !r) {
        var a = $(s[s.length - 1]);
        t.animate({scrollTop: a.offset().top - 120}, 0)
    }
}, /*!
 * Bootstrap-select v1.10.0 (http://silviomoreto.github.io/bootstrap-select)
 *
 * Copyright 2013-2016 bootstrap-select
 * Licensed under MIT (https://github.com/silviomoreto/bootstrap-select/blob/master/LICENSE)
 */
    !function (e, t) {
        "function" == typeof define && define.amd ? define(["jquery"], function (e) {
            return t(e)
        }) : "object" == typeof exports ? module.exports = t(require("jquery")) : t(jQuery)
    }(this, function (e) {
        !function (e) {
            "use strict";
            function t(t) {
                var i = [{re: /[\xC0-\xC6]/g, ch: "A"}, {re: /[\xE0-\xE6]/g, ch: "a"}, {
                    re: /[\xC8-\xCB]/g,
                    ch: "E"
                }, {re: /[\xE8-\xEB]/g, ch: "e"}, {re: /[\xCC-\xCF]/g, ch: "I"}, {
                    re: /[\xEC-\xEF]/g,
                    ch: "i"
                }, {re: /[\xD2-\xD6]/g, ch: "O"}, {re: /[\xF2-\xF6]/g, ch: "o"}, {
                    re: /[\xD9-\xDC]/g,
                    ch: "U"
                }, {re: /[\xF9-\xFC]/g, ch: "u"}, {re: /[\xC7-\xE7]/g, ch: "c"}, {
                    re: /[\xD1]/g,
                    ch: "N"
                }, {re: /[\xF1]/g, ch: "n"}];
                return e.each(i, function () {
                    t = t.replace(this.re, this.ch)
                }), t
            }

            function i(e) {
                var t = {
                    "&": "&amp;",
                    "<": "&lt;",
                    ">": "&gt;",
                    '"': "&quot;",
                    "'": "&#x27;",
                    "`": "&#x60;"
                }, i = "(?:" + Object.keys(t).join("|") + ")", n = new RegExp(i), s = new RegExp(i, "g"), r = null == e ? "" : "" + e;
                return n.test(r) ? r.replace(s, function (e) {
                    return t[e]
                }) : r
            }

            function n(t, i) {
                var n = arguments, r = t, a = i;
                [].shift.apply(n);
                var o, l = this.each(function () {
                    var t = e(this);
                    if (t.is("select")) {
                        var i = t.data("selectpicker"), l = "object" == typeof r && r;
                        if (i) {
                            if (l)for (var h in l)l.hasOwnProperty(h) && (i.options[h] = l[h])
                        } else {
                            var u = e.extend({}, s.DEFAULTS, e.fn.selectpicker.defaults || {}, t.data(), l);
                            u.template = e.extend({}, s.DEFAULTS.template, e.fn.selectpicker.defaults ? e.fn.selectpicker.defaults.template : {}, t.data().template, l.template), t.data("selectpicker", i = new s(this, u, a))
                        }
                        "string" == typeof r && (o = i[r] instanceof Function ? i[r].apply(i, n) : i.options[r])
                    }
                });
                return "undefined" != typeof o ? o : l
            }

            String.prototype.includes || !function () {
                var e = {}.toString, t = function () {
                    try {
                        var e = {}, t = Object.defineProperty, i = t(e, e, e) && t
                    } catch (n) {
                    }
                    return i
                }(), i = "".indexOf, n = function (t) {
                    if (null == this)throw new TypeError;
                    var n = String(this);
                    if (t && "[object RegExp]" == e.call(t))throw new TypeError;
                    var s = n.length, r = String(t), a = r.length, o = arguments.length > 1 ? arguments[1] : void 0, l = o ? Number(o) : 0;
                    l != l && (l = 0);
                    var h = Math.min(Math.max(l, 0), s);
                    return a + h > s ? !1 : -1 != i.call(n, r, l)
                };
                t ? t(String.prototype, "includes", {
                    value: n,
                    configurable: !0,
                    writable: !0
                }) : String.prototype.includes = n
            }(), String.prototype.startsWith || !function () {
                var e = function () {
                    try {
                        var e = {}, t = Object.defineProperty, i = t(e, e, e) && t
                    } catch (n) {
                    }
                    return i
                }(), t = {}.toString, i = function (e) {
                    if (null == this)throw new TypeError;
                    var i = String(this);
                    if (e && "[object RegExp]" == t.call(e))throw new TypeError;
                    var n = i.length, s = String(e), r = s.length, a = arguments.length > 1 ? arguments[1] : void 0, o = a ? Number(a) : 0;
                    o != o && (o = 0);
                    var l = Math.min(Math.max(o, 0), n);
                    if (r + l > n)return !1;
                    for (var h = -1; ++h < r;)if (i.charCodeAt(l + h) != s.charCodeAt(h))return !1;
                    return !0
                };
                e ? e(String.prototype, "startsWith", {
                    value: i,
                    configurable: !0,
                    writable: !0
                }) : String.prototype.startsWith = i
            }(), Object.keys || (Object.keys = function (e, t, i) {
                i = [];
                for (t in e)i.hasOwnProperty.call(e, t) && i.push(t);
                return i
            }), e.fn.triggerNative = function (e) {
                var t, i = this[0];
                i.dispatchEvent ? ("function" == typeof Event ? t = new Event(e, {bubbles: !0}) : (t = document.createEvent("Event"), t.initEvent(e, !0, !1)), i.dispatchEvent(t)) : (i.fireEvent && (t = document.createEventObject(), t.eventType = e, i.fireEvent("on" + e, t)), this.trigger(e))
            }, e.expr[":"].icontains = function (t, i, n) {
                var s = e(t), r = (s.data("tokens") || s.text()).toUpperCase();
                return r.includes(n[3].toUpperCase())
            }, e.expr[":"].ibegins = function (t, i, n) {
                var s = e(t), r = (s.data("tokens") || s.text()).toUpperCase();
                return r.startsWith(n[3].toUpperCase())
            }, e.expr[":"].aicontains = function (t, i, n) {
                var s = e(t), r = (s.data("tokens") || s.data("normalizedText") || s.text()).toUpperCase();
                return r.includes(n[3].toUpperCase())
            }, e.expr[":"].aibegins = function (t, i, n) {
                var s = e(t), r = (s.data("tokens") || s.data("normalizedText") || s.text()).toUpperCase();
                return r.startsWith(n[3].toUpperCase())
            };
            var s = function (t, i, n) {
                n && (n.stopPropagation(), n.preventDefault()), this.$element = e(t), this.$newElement = null, this.$button = null, this.$menu = null, this.$lis = null, this.options = i, null === this.options.title && (this.options.title = this.$element.attr("title")), this.val = s.prototype.val, this.render = s.prototype.render, this.refresh = s.prototype.refresh, this.setStyle = s.prototype.setStyle, this.selectAll = s.prototype.selectAll, this.deselectAll = s.prototype.deselectAll, this.destroy = s.prototype.destroy, this.remove = s.prototype.remove, this.show = s.prototype.show, this.hide = s.prototype.hide, this.init()
            };
            s.VERSION = "1.10.0", s.DEFAULTS = {
                noneSelectedText: "Nothing selected",
                noneResultsText: "No results matched {0}",
                countSelectedText: function (e) {
                    return 1 == e ? "{0} item selected" : "{0} items selected"
                },
                maxOptionsText: function (e, t) {
                    return [1 == e ? "Limit reached ({n} item max)" : "Limit reached ({n} items max)", 1 == t ? "Group limit reached ({n} item max)" : "Group limit reached ({n} items max)"]
                },
                selectAllText: "Select All",
                deselectAllText: "Deselect All",
                doneButton: !1,
                doneButtonText: "Close",
                multipleSeparator: ", ",
                styleBase: "btn",
                style: "btn-default",
                size: "auto",
                title: null,
                selectedTextFormat: "values",
                width: !1,
                container: !1,
                hideDisabled: !1,
                showSubtext: !1,
                showIcon: !0,
                showContent: !0,
                dropupAuto: !0,
                header: !1,
                liveSearch: !1,
                liveSearchPlaceholder: null,
                liveSearchNormalize: !1,
                liveSearchStyle: "contains",
                actionsBox: !1,
                iconBase: "glyphicon",
                tickIcon: "glyphicon-ok",
                showTick: !1,
                template: {caret: '<span class="caret"></span>'},
                maxOptions: !1,
                mobile: !1,
                selectOnTab: !1,
                dropdownAlignRight: !1
            }, s.prototype = {
                constructor: s, init: function () {
                    var t = this, i = this.$element.attr("id");
                    this.$element.addClass("bs-select-hidden"), this.liObj = {}, this.multiple = this.$element.prop("multiple"), this.autofocus = this.$element.prop("autofocus"), this.$newElement = this.createView(), this.$element.after(this.$newElement).appendTo(this.$newElement), this.$button = this.$newElement.children("button"), this.$menu = this.$newElement.children(".dropdown-menu"), this.$menuInner = this.$menu.children(".inner"), this.$searchbox = this.$menu.find("input"), this.$element.removeClass("bs-select-hidden"), this.options.dropdownAlignRight && this.$menu.addClass("dropdown-menu-right"), "undefined" != typeof i && (this.$button.attr("data-id", i), e('label[for="' + i + '"]').click(function (e) {
                        e.preventDefault(), t.$button.focus()
                    })), this.checkDisabled(), this.clickListener(), this.options.liveSearch && this.liveSearchListener(), this.render(), this.setStyle(), this.setWidth(), this.options.container && this.selectPosition(), this.$menu.data("this", this), this.$newElement.data("this", this), this.options.mobile && this.mobile(), this.$newElement.on({
                        "hide.bs.dropdown": function (e) {
                            t.$element.trigger("hide.bs.select", e)
                        }, "hidden.bs.dropdown": function (e) {
                            t.$element.trigger("hidden.bs.select", e)
                        }, "show.bs.dropdown": function (e) {
                            t.$element.trigger("show.bs.select", e)
                        }, "shown.bs.dropdown": function (e) {
                            t.$element.trigger("shown.bs.select", e)
                        }
                    }), t.$element[0].hasAttribute("required") && this.$element.on("invalid", function () {
                        t.$button.addClass("bs-invalid").focus(), t.$element.on({
                            "focus.bs.select": function () {
                                t.$button.focus(), t.$element.off("focus.bs.select")
                            }, "shown.bs.select": function () {
                                t.$element.val(t.$element.val()).off("shown.bs.select")
                            }, "rendered.bs.select": function () {
                                this.validity.valid && t.$button.removeClass("bs-invalid"), t.$element.off("rendered.bs.select")
                            }
                        })
                    }), setTimeout(function () {
                        t.$element.trigger("loaded.bs.select")
                    })
                }, createDropdown: function () {
                    var t = this.multiple || this.options.showTick ? " show-tick" : "", n = this.$element.parent().hasClass("input-group") ? " input-group-btn" : "", s = this.autofocus ? " autofocus" : "", r = this.options.header ? '<div class="popover-title"><button type="button" class="close" aria-hidden="true">&times;</button>' + this.options.header + "</div>" : "", a = this.options.liveSearch ? '<div class="bs-searchbox"><input type="text" class="form-control" autocomplete="off"' + (null === this.options.liveSearchPlaceholder ? "" : ' placeholder="' + i(this.options.liveSearchPlaceholder) + '"') + "></div>" : "", o = this.multiple && this.options.actionsBox ? '<div class="bs-actionsbox"><div class="btn-group btn-group-sm btn-block"><button type="button" class="actions-btn bs-select-all btn btn-default">' + this.options.selectAllText + '</button><button type="button" class="actions-btn bs-deselect-all btn btn-default">' + this.options.deselectAllText + "</button></div></div>" : "", l = this.multiple && this.options.doneButton ? '<div class="bs-donebutton"><div class="btn-group btn-block"><button type="button" class="btn btn-sm btn-default">' + this.options.doneButtonText + "</button></div></div>" : "", h = '<div class="btn-group bootstrap-select' + t + n + '"><button type="button" class="' + this.options.styleBase + ' dropdown-toggle" data-toggle="dropdown"' + s + '><span class="filter-option pull-left"></span>&nbsp;<span class="bs-caret">' + this.options.template.caret + '</span></button><div class="dropdown-menu open">' + r + a + o + '<ul class="dropdown-menu inner" role="menu"></ul>' + l + "</div></div>";
                    return e(h)
                }, createView: function () {
                    var e = this.createDropdown(), t = this.createLi();
                    return e.find("ul")[0].innerHTML = t, e
                }, reloadLi: function () {
                    this.destroyLi();
                    var e = this.createLi();
                    this.$menuInner[0].innerHTML = e
                }, destroyLi: function () {
                    this.$menu.find("li").remove()
                }, createLi: function () {
                    var n = this, s = [], r = 0, a = document.createElement("option"), o = -1, l = function (e, t, i, n) {
                        return "<li" + ("undefined" != typeof i & "" !== i ? ' class="' + i + '"' : "") + ("undefined" != typeof t & null !== t ? ' data-original-index="' + t + '"' : "") + ("undefined" != typeof n & null !== n ? 'data-optgroup="' + n + '"' : "") + ">" + e + "</li>"
                    }, h = function (e, s, r, a) {
                        return '<a tabindex="0"' + ("undefined" != typeof s ? ' class="' + s + '"' : "") + ("undefined" != typeof r ? ' style="' + r + '"' : "") + (n.options.liveSearchNormalize ? ' data-normalized-text="' + t(i(e)) + '"' : "") + ("undefined" != typeof a || null !== a ? ' data-tokens="' + a + '"' : "") + ">" + e + '<span class="' + n.options.iconBase + " " + n.options.tickIcon + ' check-mark"></span></a>'
                    };
                    if (this.options.title && !this.multiple && (o--, !this.$element.find(".bs-title-option").length)) {
                        var u = this.$element[0];
                        a.className = "bs-title-option", a.appendChild(document.createTextNode(this.options.title)), a.value = "", u.insertBefore(a, u.firstChild), void 0 === e(u.options[u.selectedIndex]).attr("selected") && (a.selected = !0)
                    }
                    return this.$element.find("option").each(function (t) {
                        var i = e(this);
                        if (o++, !i.hasClass("bs-title-option")) {
                            var a = this.className || "", u = this.style.cssText, c = i.data("content") ? i.data("content") : i.html(), p = i.data("tokens") ? i.data("tokens") : null, d = "undefined" != typeof i.data("subtext") ? '<small class="text-muted">' + i.data("subtext") + "</small>" : "", f = "undefined" != typeof i.data("icon") ? '<span class="' + n.options.iconBase + " " + i.data("icon") + '"></span> ' : "", m = "OPTGROUP" === this.parentNode.tagName, g = this.disabled || m && this.parentNode.disabled;
                            if ("" !== f && g && (f = "<span>" + f + "</span>"), n.options.hideDisabled && g && !m)return void o--;
                            if (i.data("content") || (c = f + '<span class="text">' + c + d + "</span>"), m && i.data("divider") !== !0) {
                                var y = " " + this.parentNode.className || "";
                                if (0 === i.index()) {
                                    r += 1;
                                    var v = this.parentNode.label, b = "undefined" != typeof i.parent().data("subtext") ? '<small class="text-muted">' + i.parent().data("subtext") + "</small>" : "", L = i.parent().data("icon") ? '<span class="' + n.options.iconBase + " " + i.parent().data("icon") + '"></span> ' : "";
                                    v = L + '<span class="text">' + v + b + "</span>", 0 !== t && s.length > 0 && (o++, s.push(l("", null, "divider", r + "div"))), o++, s.push(l(v, null, "dropdown-header" + y, r))
                                }
                                if (n.options.hideDisabled && g)return void o--;
                                s.push(l(h(c, "opt " + a + y, u, p), t, "", r))
                            } else i.data("divider") === !0 ? s.push(l("", t, "divider")) : i.data("hidden") === !0 ? s.push(l(h(c, a, u, p), t, "hidden is-hidden")) : (this.previousElementSibling && "OPTGROUP" === this.previousElementSibling.tagName && (o++, s.push(l("", null, "divider", r + "div"))), s.push(l(h(c, a, u, p), t)));
                            n.liObj[t] = o
                        }
                    }), this.multiple || 0 !== this.$element.find("option:selected").length || this.options.title || this.$element.find("option").eq(0).prop("selected", !0).attr("selected", "selected"), s.join("")
                }, findLis: function () {
                    return null == this.$lis && (this.$lis = this.$menu.find("li")), this.$lis
                }, render: function (t) {
                    var i, n = this;
                    t !== !1 && this.$element.find("option").each(function (e) {
                        var t = n.findLis().eq(n.liObj[e]);
                        n.setDisabled(e, this.disabled || "OPTGROUP" === this.parentNode.tagName && this.parentNode.disabled, t), n.setSelected(e, this.selected, t)
                    }), this.tabIndex();
                    var s = this.$element.find("option").map(function () {
                        if (this.selected) {
                            if (n.options.hideDisabled && (this.disabled || "OPTGROUP" === this.parentNode.tagName && this.parentNode.disabled))return;
                            var t, i = e(this), s = i.data("icon") && n.options.showIcon ? '<i class="' + n.options.iconBase + " " + i.data("icon") + '"></i> ' : "";
                            return t = n.options.showSubtext && i.data("subtext") && !n.multiple ? ' <small class="text-muted">' + i.data("subtext") + "</small>" : "", "undefined" != typeof i.attr("title") ? i.attr("title") : i.data("content") && n.options.showContent ? i.data("content") : s + i.html() + t
                        }
                    }).toArray(), r = this.multiple ? s.join(this.options.multipleSeparator) : s[0];
                    if (this.multiple && this.options.selectedTextFormat.indexOf("count") > -1) {
                        var a = this.options.selectedTextFormat.split(">");
                        if (a.length > 1 && s.length > a[1] || 1 == a.length && s.length >= 2) {
                            i = this.options.hideDisabled ? ", [disabled]" : "";
                            var o = this.$element.find("option").not('[data-divider="true"], [data-hidden="true"]' + i).length, l = "function" == typeof this.options.countSelectedText ? this.options.countSelectedText(s.length, o) : this.options.countSelectedText;
                            r = l.replace("{0}", s.length.toString()).replace("{1}", o.toString())
                        }
                    }
                    void 0 == this.options.title && (this.options.title = this.$element.attr("title")), "static" == this.options.selectedTextFormat && (r = this.options.title), r || (r = "undefined" != typeof this.options.title ? this.options.title : this.options.noneSelectedText), this.$button.attr("title", e.trim(r.replace(/<[^>]*>?/g, ""))), this.$button.children(".filter-option").html(r), this.$element.trigger("rendered.bs.select")
                }, setStyle: function (e, t) {
                    this.$element.attr("class") && this.$newElement.addClass(this.$element.attr("class").replace(/selectpicker|mobile-device|bs-select-hidden|validate\[.*\]/gi, ""));
                    var i = e ? e : this.options.style;
                    "add" == t ? this.$button.addClass(i) : "remove" == t ? this.$button.removeClass(i) : (this.$button.removeClass(this.options.style), this.$button.addClass(i))
                }, liHeight: function (t) {
                    if (t || this.options.size !== !1 && !this.sizeInfo) {
                        var i = document.createElement("div"), n = document.createElement("div"), s = document.createElement("ul"), r = document.createElement("li"), a = document.createElement("li"), o = document.createElement("a"), l = document.createElement("span"), h = this.options.header && this.$menu.find(".popover-title").length > 0 ? this.$menu.find(".popover-title")[0].cloneNode(!0) : null, u = this.options.liveSearch ? document.createElement("div") : null, c = this.options.actionsBox && this.multiple && this.$menu.find(".bs-actionsbox").length > 0 ? this.$menu.find(".bs-actionsbox")[0].cloneNode(!0) : null, p = this.options.doneButton && this.multiple && this.$menu.find(".bs-donebutton").length > 0 ? this.$menu.find(".bs-donebutton")[0].cloneNode(!0) : null;
                        if (l.className = "text", i.className = this.$menu[0].parentNode.className + " open", n.className = "dropdown-menu open", s.className = "dropdown-menu inner", r.className = "divider", l.appendChild(document.createTextNode("Inner text")), o.appendChild(l), a.appendChild(o), s.appendChild(a), s.appendChild(r), h && n.appendChild(h), u) {
                            var d = document.createElement("span");
                            u.className = "bs-searchbox", d.className = "form-control", u.appendChild(d), n.appendChild(u)
                        }
                        c && n.appendChild(c), n.appendChild(s), p && n.appendChild(p), i.appendChild(n), document.body.appendChild(i);
                        var f = o.offsetHeight, m = h ? h.offsetHeight : 0, g = u ? u.offsetHeight : 0, y = c ? c.offsetHeight : 0, v = p ? p.offsetHeight : 0, b = e(r).outerHeight(!0), L = "function" == typeof getComputedStyle ? getComputedStyle(n) : !1, w = L ? null : e(n), O = parseInt(L ? L.paddingTop : w.css("paddingTop")) + parseInt(L ? L.paddingBottom : w.css("paddingBottom")) + parseInt(L ? L.borderTopWidth : w.css("borderTopWidth")) + parseInt(L ? L.borderBottomWidth : w.css("borderBottomWidth")), C = O + parseInt(L ? L.marginTop : w.css("marginTop")) + parseInt(L ? L.marginBottom : w.css("marginBottom")) + 2;
                        document.body.removeChild(i), this.sizeInfo = {
                            liHeight: f,
                            headerHeight: m,
                            searchHeight: g,
                            actionsHeight: y,
                            doneButtonHeight: v,
                            dividerHeight: b,
                            menuPadding: O,
                            menuExtras: C
                        }
                    }
                }, setSize: function () {
                    if (this.findLis(), this.liHeight(), this.options.header && this.$menu.css("padding-top", 0), this.options.size !== !1) {
                        var t, i, n, s, r = this, a = this.$menu, o = this.$menuInner, l = e(window), h = this.$newElement[0].offsetHeight, u = this.sizeInfo.liHeight, c = this.sizeInfo.headerHeight, p = this.sizeInfo.searchHeight, d = this.sizeInfo.actionsHeight, f = this.sizeInfo.doneButtonHeight, m = this.sizeInfo.dividerHeight, g = this.sizeInfo.menuPadding, y = this.sizeInfo.menuExtras, v = this.options.hideDisabled ? ".disabled" : "", b = function () {
                            n = r.$newElement.offset().top - l.scrollTop(), s = l.height() - n - h
                        };
                        if (b(), "auto" === this.options.size) {
                            var L = function () {
                                var l, h = function (t, i) {
                                    return function (n) {
                                        return i ? n.classList ? n.classList.contains(t) : e(n).hasClass(t) : !(n.classList ? n.classList.contains(t) : e(n).hasClass(t))
                                    }
                                }, m = r.$menuInner[0].getElementsByTagName("li"), v = Array.prototype.filter ? Array.prototype.filter.call(m, h("hidden", !1)) : r.$lis.not(".hidden"), L = Array.prototype.filter ? Array.prototype.filter.call(v, h("dropdown-header", !0)) : v.filter(".dropdown-header");
                                b(), t = s - y, r.options.container ? (a.data("height") || a.data("height", a.height()), i = a.data("height")) : i = a.height(), r.options.dropupAuto && r.$newElement.toggleClass("dropup", n > s && i > t - y), r.$newElement.hasClass("dropup") && (t = n - y), l = v.length + L.length > 3 ? 3 * u + y - 2 : 0, a.css({
                                    "max-height": t + "px",
                                    overflow: "hidden",
                                    "min-height": l + c + p + d + f + "px"
                                }), o.css({
                                    "max-height": t - c - p - d - f - g + "px",
                                    "overflow-y": "auto",
                                    "min-height": Math.max(l - g, 0) + "px"
                                })
                            };
                            L(), this.$searchbox.off("input.getSize propertychange.getSize").on("input.getSize propertychange.getSize", L), l.off("resize.getSize scroll.getSize").on("resize.getSize scroll.getSize", L)
                        } else if (this.options.size && "auto" != this.options.size && this.$lis.not(v).length > this.options.size) {
                            var w = this.$lis.not(".divider").not(v).children().slice(0, this.options.size).last().parent().index(), O = this.$lis.slice(0, w + 1).filter(".divider").length;
                            t = u * this.options.size + O * m + g, r.options.container ? (a.data("height") || a.data("height", a.height()), i = a.data("height")) : i = a.height(), r.options.dropupAuto && this.$newElement.toggleClass("dropup", n > s && i > t - y), a.css({
                                "max-height": t + c + p + d + f + "px",
                                overflow: "hidden",
                                "min-height": ""
                            }), o.css({"max-height": t - g + "px", "overflow-y": "auto", "min-height": ""})
                        }
                    }
                }, setWidth: function () {
                    if ("auto" === this.options.width) {
                        this.$menu.css("min-width", "0");
                        var e = this.$menu.parent().clone().appendTo("body"), t = this.options.container ? this.$newElement.clone().appendTo("body") : e, i = e.children(".dropdown-menu").outerWidth(), n = t.css("width", "auto").children("button").outerWidth();
                        e.remove(), t.remove(), this.$newElement.css("width", Math.max(i, n) + "px")
                    } else"fit" === this.options.width ? (this.$menu.css("min-width", ""), this.$newElement.css("width", "").addClass("fit-width")) : this.options.width ? (this.$menu.css("min-width", ""), this.$newElement.css("width", this.options.width)) : (this.$menu.css("min-width", ""), this.$newElement.css("width", ""));
                    this.$newElement.hasClass("fit-width") && "fit" !== this.options.width && this.$newElement.removeClass("fit-width")
                }, selectPosition: function () {
                    this.$bsContainer = e('<div class="bs-container" />');
                    var t, i, n = this, s = function (e) {
                        n.$bsContainer.addClass(e.attr("class").replace(/form-control|fit-width/gi, "")).toggleClass("dropup", e.hasClass("dropup")), t = e.offset(), i = e.hasClass("dropup") ? 0 : e[0].offsetHeight, n.$bsContainer.css({
                            top: t.top + i,
                            left: t.left,
                            width: e[0].offsetWidth
                        })
                    };
                    this.$button.on("click", function () {
                        var t = e(this);
                        n.isDisabled() || (s(n.$newElement), n.$bsContainer.appendTo(n.options.container).toggleClass("open", !t.hasClass("open")).append(n.$menu))
                    }), e(window).on("resize scroll", function () {
                        s(n.$newElement)
                    }), this.$element.on("hide.bs.select", function () {
                        n.$menu.data("height", n.$menu.height()), n.$bsContainer.detach()
                    })
                }, setSelected: function (e, t, i) {
                    i || (i = this.findLis().eq(this.liObj[e])), i.toggleClass("selected", t)
                }, setDisabled: function (e, t, i) {
                    i || (i = this.findLis().eq(this.liObj[e])), t ? i.addClass("disabled").children("a").attr("href", "#").attr("tabindex", -1) : i.removeClass("disabled").children("a").removeAttr("href").attr("tabindex", 0)
                }, isDisabled: function () {
                    return this.$element[0].disabled
                }, checkDisabled: function () {
                    var e = this;
                    this.isDisabled() ? (this.$newElement.addClass("disabled"), this.$button.addClass("disabled").attr("tabindex", -1)) : (this.$button.hasClass("disabled") && (this.$newElement.removeClass("disabled"), this.$button.removeClass("disabled")), -1 != this.$button.attr("tabindex") || this.$element.data("tabindex") || this.$button.removeAttr("tabindex")), this.$button.click(function () {
                        return !e.isDisabled()
                    })
                }, tabIndex: function () {
                    this.$element.data("tabindex") !== this.$element.attr("tabindex") && -98 !== this.$element.attr("tabindex") && "-98" !== this.$element.attr("tabindex") && (this.$element.data("tabindex", this.$element.attr("tabindex")), this.$button.attr("tabindex", this.$element.data("tabindex"))), this.$element.attr("tabindex", -98)
                }, clickListener: function () {
                    var t = this, i = e(document);
                    this.$newElement.on("touchstart.dropdown", ".dropdown-menu", function (e) {
                        e.stopPropagation()
                    }), i.data("spaceSelect", !1), this.$button.on("keyup", function (e) {
                        /(32)/.test(e.keyCode.toString(10)) && i.data("spaceSelect") && (e.preventDefault(), i.data("spaceSelect", !1))
                    }), this.$button.on("click", function () {
                        t.setSize()
                    }), this.$element.on("shown.bs.select", function () {
                        if (t.options.liveSearch || t.multiple) {
                            if (!t.multiple) {
                                var e = t.liObj[t.$element[0].selectedIndex];
                                if ("number" != typeof e || t.options.size === !1)return;
                                var i = t.$lis.eq(e)[0].offsetTop - t.$menuInner[0].offsetTop;
                                i = i - t.$menuInner[0].offsetHeight / 2 + t.sizeInfo.liHeight / 2, t.$menuInner[0].scrollTop = i
                            }
                        } else t.$menuInner.find(".selected a").focus()
                    }), this.$menuInner.on("click", "li a", function (i) {
                        var n = e(this), s = n.parent().data("originalIndex"), r = t.$element.val(), a = t.$element.prop("selectedIndex");
                        if (t.multiple && i.stopPropagation(), i.preventDefault(), !t.isDisabled() && !n.parent().hasClass("disabled")) {
                            var o = t.$element.find("option"), l = o.eq(s), h = l.prop("selected"), u = l.parent("optgroup"), c = t.options.maxOptions, p = u.data("maxOptions") || !1;
                            if (t.multiple) {
                                if (l.prop("selected", !h), t.setSelected(s, !h), n.blur(), c !== !1 || p !== !1) {
                                    var d = c < o.filter(":selected").length, f = p < u.find("option:selected").length;
                                    if (c && d || p && f)if (c && 1 == c) o.prop("selected", !1), l.prop("selected", !0), t.$menuInner.find(".selected").removeClass("selected"), t.setSelected(s, !0); else if (p && 1 == p) {
                                        u.find("option:selected").prop("selected", !1), l.prop("selected", !0);
                                        var m = n.parent().data("optgroup");
                                        t.$menuInner.find('[data-optgroup="' + m + '"]').removeClass("selected"), t.setSelected(s, !0)
                                    } else {
                                        var g = "function" == typeof t.options.maxOptionsText ? t.options.maxOptionsText(c, p) : t.options.maxOptionsText, y = g[0].replace("{n}", c), v = g[1].replace("{n}", p), b = e('<div class="notify"></div>');
                                        g[2] && (y = y.replace("{var}", g[2][c > 1 ? 0 : 1]), v = v.replace("{var}", g[2][p > 1 ? 0 : 1])), l.prop("selected", !1), t.$menu.append(b), c && d && (b.append(e("<div>" + y + "</div>")), t.$element.trigger("maxReached.bs.select")), p && f && (b.append(e("<div>" + v + "</div>")), t.$element.trigger("maxReachedGrp.bs.select")), setTimeout(function () {
                                            t.setSelected(s, !1)
                                        }, 10), b.delay(750).fadeOut(300, function () {
                                            e(this).remove()
                                        })
                                    }
                                }
                            } else o.prop("selected", !1), l.prop("selected", !0), t.$menuInner.find(".selected").removeClass("selected"), t.setSelected(s, !0);
                            t.multiple ? t.options.liveSearch && t.$searchbox.focus() : t.$button.focus(), (r != t.$element.val() && t.multiple || a != t.$element.prop("selectedIndex") && !t.multiple) && t.$element.trigger("changed.bs.select", [s, l.prop("selected"), h]).triggerNative("change")
                        }
                    }), this.$menu.on("click", "li.disabled a, .popover-title, .popover-title :not(.close)", function (i) {
                        i.currentTarget == this && (i.preventDefault(), i.stopPropagation(), t.options.liveSearch && !e(i.target).hasClass("close") ? t.$searchbox.focus() : t.$button.focus())
                    }), this.$menuInner.on("click", ".divider, .dropdown-header", function (e) {
                        e.preventDefault(), e.stopPropagation(), t.options.liveSearch ? t.$searchbox.focus() : t.$button.focus()
                    }), this.$menu.on("click", ".popover-title .close", function () {
                        t.$button.click()
                    }), this.$searchbox.on("click", function (e) {
                        e.stopPropagation()
                    }), this.$menu.on("click", ".actions-btn", function (i) {
                        t.options.liveSearch ? t.$searchbox.focus() : t.$button.focus(), i.preventDefault(), i.stopPropagation(), e(this).hasClass("bs-select-all") ? t.selectAll() : t.deselectAll()
                    }), this.$element.change(function () {
                        t.render(!1)
                    })
                }, liveSearchListener: function () {
                    var n = this, s = e('<li class="no-results"></li>');
                    this.$button.on("click.dropdown.data-api touchstart.dropdown.data-api", function () {
                        n.$menuInner.find(".active").removeClass("active"), n.$searchbox.val() && (n.$searchbox.val(""), n.$lis.not(".is-hidden").removeClass("hidden"), s.parent().length && s.remove()), n.multiple || n.$menuInner.find(".selected").addClass("active"), setTimeout(function () {
                            n.$searchbox.focus()
                        }, 10)
                    }), this.$searchbox.on("click.dropdown.data-api focus.dropdown.data-api touchend.dropdown.data-api", function (e) {
                        e.stopPropagation()
                    }), this.$searchbox.on("input propertychange", function () {
                        if (n.$searchbox.val()) {
                            var r = n.$lis.not(".is-hidden").removeClass("hidden").children("a");
                            r = n.options.liveSearchNormalize ? r.not(":a" + n._searchStyle() + '("' + t(n.$searchbox.val()) + '")') : r.not(":" + n._searchStyle() + '("' + n.$searchbox.val() + '")'), r.parent().addClass("hidden"), n.$lis.filter(".dropdown-header").each(function () {
                                var t = e(this), i = t.data("optgroup");
                                0 === n.$lis.filter("[data-optgroup=" + i + "]").not(t).not(".hidden").length && (t.addClass("hidden"), n.$lis.filter("[data-optgroup=" + i + "div]").addClass("hidden"))
                            });
                            var a = n.$lis.not(".hidden");
                            a.each(function (t) {
                                var i = e(this);
                                i.hasClass("divider") && (i.index() === a.first().index() || i.index() === a.last().index() || a.eq(t + 1).hasClass("divider")) && i.addClass("hidden")
                            }), n.$lis.not(".hidden, .no-results").length ? s.parent().length && s.remove() : (s.parent().length && s.remove(), s.html(n.options.noneResultsText.replace("{0}", '"' + i(n.$searchbox.val()) + '"')).show(), n.$menuInner.append(s))
                        } else n.$lis.not(".is-hidden").removeClass("hidden"), s.parent().length && s.remove();
                        n.$lis.filter(".active").removeClass("active"), n.$searchbox.val() && n.$lis.not(".hidden, .divider, .dropdown-header").eq(0).addClass("active").children("a").focus(), e(this).focus()
                    })
                }, _searchStyle: function () {
                    var e = {begins: "ibegins", startsWith: "ibegins"};
                    return e[this.options.liveSearchStyle] || "icontains"
                }, val: function (e) {
                    return "undefined" != typeof e ? (this.$element.val(e), this.render(), this.$element) : this.$element.val()
                }, changeAll: function (t) {
                    "undefined" == typeof t && (t = !0), this.findLis();
                    for (var i = this.$element.find("option"), n = this.$lis.not(".divider, .dropdown-header, .disabled, .hidden").toggleClass("selected", t), s = n.length, r = [], a = 0; s > a; a++) {
                        var o = n[a].getAttribute("data-original-index");
                        r[r.length] = i.eq(o)[0]
                    }
                    e(r).prop("selected", t), this.render(!1), this.$element.trigger("changed.bs.select").triggerNative("change")
                }, selectAll: function () {
                    return this.changeAll(!0)
                }, deselectAll: function () {
                    return this.changeAll(!1)
                }, toggle: function (e) {
                    e = e || window.event, e && e.stopPropagation(), this.$button.trigger("click")
                }, keydown: function (i) {
                    var n, s, r, a, o, l, h, u, c, p = e(this), d = p.is("input") ? p.parent().parent() : p.parent(), f = d.data("this"), m = ":not(.disabled, .hidden, .dropdown-header, .divider)", g = {
                        32: " ",
                        48: "0",
                        49: "1",
                        50: "2",
                        51: "3",
                        52: "4",
                        53: "5",
                        54: "6",
                        55: "7",
                        56: "8",
                        57: "9",
                        59: ";",
                        65: "a",
                        66: "b",
                        67: "c",
                        68: "d",
                        69: "e",
                        70: "f",
                        71: "g",
                        72: "h",
                        73: "i",
                        74: "j",
                        75: "k",
                        76: "l",
                        77: "m",
                        78: "n",
                        79: "o",
                        80: "p",
                        81: "q",
                        82: "r",
                        83: "s",
                        84: "t",
                        85: "u",
                        86: "v",
                        87: "w",
                        88: "x",
                        89: "y",
                        90: "z",
                        96: "0",
                        97: "1",
                        98: "2",
                        99: "3",
                        100: "4",
                        101: "5",
                        102: "6",
                        103: "7",
                        104: "8",
                        105: "9"
                    };
                    if (f.options.liveSearch && (d = p.parent().parent()), f.options.container && (d = f.$menu), n = e("[role=menu] li", d), c = f.$newElement.hasClass("open"), !c && (i.keyCode >= 48 && i.keyCode <= 57 || i.keyCode >= 96 && i.keyCode <= 105 || i.keyCode >= 65 && i.keyCode <= 90) && (f.options.container ? f.$button.trigger("click") : (f.setSize(), f.$menu.parent().addClass("open"), c = !0), f.$searchbox.focus()), f.options.liveSearch && (/(^9$|27)/.test(i.keyCode.toString(10)) && c && 0 === f.$menu.find(".active").length && (i.preventDefault(), f.$menu.parent().removeClass("open"), f.options.container && f.$newElement.removeClass("open"), f.$button.focus()), n = e("[role=menu] li" + m, d), p.val() || /(38|40)/.test(i.keyCode.toString(10)) || 0 === n.filter(".active").length && (n = f.$menuInner.find("li"), n = f.options.liveSearchNormalize ? n.filter(":a" + f._searchStyle() + "(" + t(g[i.keyCode]) + ")") : n.filter(":" + f._searchStyle() + "(" + g[i.keyCode] + ")"))), n.length) {
                        if (/(38|40)/.test(i.keyCode.toString(10))) s = n.index(n.find("a").filter(":focus").parent()), a = n.filter(m).first().index(), o = n.filter(m).last().index(), r = n.eq(s).nextAll(m).eq(0).index(), l = n.eq(s).prevAll(m).eq(0).index(), h = n.eq(r).prevAll(m).eq(0).index(), f.options.liveSearch && (n.each(function (t) {
                            e(this).hasClass("disabled") || e(this).data("index", t)
                        }), s = n.index(n.filter(".active")), a = n.first().data("index"), o = n.last().data("index"), r = n.eq(s).nextAll().eq(0).data("index"), l = n.eq(s).prevAll().eq(0).data("index"), h = n.eq(r).prevAll().eq(0).data("index")), u = p.data("prevIndex"), 38 == i.keyCode ? (f.options.liveSearch && s--, s != h && s > l && (s = l), a > s && (s = a), s == u && (s = o)) : 40 == i.keyCode && (f.options.liveSearch && s++, -1 == s && (s = 0), s != h && r > s && (s = r), s > o && (s = o), s == u && (s = a)), p.data("prevIndex", s), f.options.liveSearch ? (i.preventDefault(), p.hasClass("dropdown-toggle") || (n.removeClass("active").eq(s).addClass("active").children("a").focus(), p.focus())) : n.eq(s).children("a").focus(); else if (!p.is("input")) {
                            var y, v, b = [];
                            n.each(function () {
                                e(this).hasClass("disabled") || e.trim(e(this).children("a").text().toLowerCase()).substring(0, 1) == g[i.keyCode] && b.push(e(this).index())
                            }), y = e(document).data("keycount"), y++, e(document).data("keycount", y), v = e.trim(e(":focus").text().toLowerCase()).substring(0, 1), v != g[i.keyCode] ? (y = 1, e(document).data("keycount", y)) : y >= b.length && (e(document).data("keycount", 0), y > b.length && (y = 1)), n.eq(b[y - 1]).children("a").focus()
                        }
                        if ((/(13|32)/.test(i.keyCode.toString(10)) || /(^9$)/.test(i.keyCode.toString(10)) && f.options.selectOnTab) && c) {
                            if (/(32)/.test(i.keyCode.toString(10)) || i.preventDefault(), f.options.liveSearch) /(32)/.test(i.keyCode.toString(10)) || (f.$menuInner.find(".active a").click(), p.focus()); else {
                                var L = e(":focus");
                                L.click(), L.focus(), i.preventDefault(), e(document).data("spaceSelect", !0)
                            }
                            e(document).data("keycount", 0)
                        }
                        (/(^9$|27)/.test(i.keyCode.toString(10)) && c && (f.multiple || f.options.liveSearch) || /(27)/.test(i.keyCode.toString(10)) && !c) && (f.$menu.parent().removeClass("open"), f.options.container && f.$newElement.removeClass("open"), f.$button.focus())
                    }
                }, mobile: function () {
                    this.$element.addClass("mobile-device")
                }, refresh: function () {
                    this.$lis = null, this.liObj = {}, this.reloadLi(), this.render(), this.checkDisabled(), this.liHeight(!0), this.setStyle(), this.setWidth(), this.$lis && this.$searchbox.trigger("propertychange"), this.$element.trigger("refreshed.bs.select")
                }, hide: function () {
                    this.$newElement.hide()
                }, show: function () {
                    this.$newElement.show()
                }, remove: function () {
                    this.$newElement.remove(), this.$element.remove()
                }, destroy: function () {
                    this.$newElement.before(this.$element).remove(), this.$bsContainer ? this.$bsContainer.remove() : this.$menu.remove(), this.$element.off(".bs.select").removeData("selectpicker").removeClass("bs-select-hidden selectpicker")
                }
            };
            var r = e.fn.selectpicker;
            e.fn.selectpicker = n, e.fn.selectpicker.Constructor = s, e.fn.selectpicker.noConflict = function () {
                return e.fn.selectpicker = r, this
            }, e(document).data("keycount", 0).on("keydown.bs.select", '.bootstrap-select [data-toggle=dropdown], .bootstrap-select [role="menu"], .bs-searchbox input', s.prototype.keydown).on("focusin.modal", '.bootstrap-select [data-toggle=dropdown], .bootstrap-select [role="menu"], .bs-searchbox input', function (e) {
                e.stopPropagation()
            }), e(window).on("load.bs.select.data-api", function () {
                e(".selectpicker").each(function () {
                    var t = e(this);
                    n.call(t, t.data())
                })
            })
        }(e)
    }), /* Copyright (c) 2015 by Jean-Marc.Viglino [at]ign.fr
 * Dual-licensed under the CeCILL-B Licence (http://www.cecill.info/)
 * and the Beerware license (http://en.wikipedia.org/wiki/Beerware),
 * feel free to use and abuse it in your projects (the code, not the beer ;-).
 */
    OpenLayers.Renderer.fontawesomeicons = {
        "fa-glass": "",
        "fa-music": "",
        "fa-search": "",
        "fa-envelope-o": "",
        "fa-heart": "",
        "fa-star": "",
        "fa-star-o": "",
        "fa-user": "",
        "fa-film": "",
        "fa-th-large": "",
        "fa-th": "",
        "fa-th-list": "",
        "fa-check": "",
        "fa-remove": "",
        "fa-close": "",
        "fa-times": "",
        "fa-search-plus": "",
        "fa-search-minus": "",
        "fa-power-off": "",
        "fa-signal": "",
        "fa-gear": "",
        "fa-cog": "",
        "fa-trash-o": "",
        "fa-home": "",
        "fa-file-o": "",
        "fa-clock-o": "",
        "fa-road": "",
        "fa-download": "",
        "fa-arrow-circle-o-down": "",
        "fa-arrow-circle-o-up": "",
        "fa-inbox": "",
        "fa-play-circle-o": "",
        "fa-rotate-right": "",
        "fa-repeat": "",
        "fa-refresh": "",
        "fa-list-alt": "",
        "fa-lock": "",
        "fa-flag": "",
        "fa-headphones": "",
        "fa-volume-off": "",
        "fa-volume-down": "",
        "fa-volume-up": "",
        "fa-qrcode": "",
        "fa-barcode": "",
        "fa-tag": "",
        "fa-tags": "",
        "fa-book": "",
        "fa-bookmark": "",
        "fa-print": "",
        "fa-camera": "",
        "fa-font": "",
        "fa-bold": "",
        "fa-italic": "",
        "fa-text-height": "",
        "fa-text-width": "",
        "fa-align-left": "",
        "fa-align-center": "",
        "fa-align-right": "",
        "fa-align-justify": "",
        "fa-list": "",
        "fa-dedent": "",
        "fa-outdent": "",
        "fa-indent": "",
        "fa-video-camera": "",
        "fa-photo": "",
        "fa-image": "",
        "fa-picture-o": "",
        "fa-pencil": "",
        "fa-map-marker": "",
        "fa-adjust": "",
        "fa-tint": "",
        "fa-edit": "",
        "fa-pencil-square-o": "",
        "fa-share-square-o": "",
        "fa-check-square-o": "",
        "fa-arrows": "",
        "fa-step-backward": "",
        "fa-fast-backward": "",
        "fa-backward": "",
        "fa-play": "",
        "fa-pause": "",
        "fa-stop": "",
        "fa-forward": "",
        "fa-fast-forward": "",
        "fa-step-forward": "",
        "fa-eject": "",
        "fa-chevron-left": "",
        "fa-chevron-right": "",
        "fa-plus-circle": "",
        "fa-minus-circle": "",
        "fa-times-circle": "",
        "fa-check-circle": "",
        "fa-question-circle": "",
        "fa-info-circle": "",
        "fa-crosshairs": "",
        "fa-times-circle-o": "",
        "fa-check-circle-o": "",
        "fa-ban": "",
        "fa-arrow-left": "",
        "fa-arrow-right": "",
        "fa-arrow-up": "",
        "fa-arrow-down": "",
        "fa-mail-forward": "",
        "fa-share": "",
        "fa-expand": "",
        "fa-compress": "",
        "fa-plus": "",
        "fa-minus": "",
        "fa-asterisk": "",
        "fa-exclamation-circle": "",
        "fa-gift": "",
        "fa-leaf": "",
        "fa-fire": "",
        "fa-eye": "",
        "fa-eye-slash": "",
        "fa-warning": "",
        "fa-exclamation-triangle": "",
        "fa-plane": "",
        "fa-calendar": "",
        "fa-random": "",
        "fa-comment": "",
        "fa-magnet": "",
        "fa-chevron-up": "",
        "fa-chevron-down": "",
        "fa-retweet": "",
        "fa-shopping-cart": "",
        "fa-folder": "",
        "fa-folder-open": "",
        "fa-arrows-v": "",
        "fa-arrows-h": "",
        "fa-bar-chart-o": "",
        "fa-bar-chart": "",
        "fa-twitter-square": "",
        "fa-facebook-square": "",
        "fa-camera-retro": "",
        "fa-key": "",
        "fa-gears": "",
        "fa-cogs": "",
        "fa-comments": "",
        "fa-thumbs-o-up": "",
        "fa-thumbs-o-down": "",
        "fa-star-half": "",
        "fa-heart-o": "",
        "fa-sign-out": "",
        "fa-linkedin-square": "",
        "fa-thumb-tack": "",
        "fa-external-link": "",
        "fa-sign-in": "",
        "fa-trophy": "",
        "fa-github-square": "",
        "fa-upload": "",
        "fa-lemon-o": "",
        "fa-phone": "",
        "fa-square-o": "",
        "fa-bookmark-o": "",
        "fa-phone-square": "",
        "fa-twitter": "",
        "fa-facebook-f": "",
        "fa-facebook": "",
        "fa-github": "",
        "fa-unlock": "",
        "fa-credit-card": "",
        "fa-rss": "",
        "fa-hdd-o": "",
        "fa-bullhorn": "",
        "fa-bell": "",
        "fa-certificate": "",
        "fa-hand-o-right": "",
        "fa-hand-o-left": "",
        "fa-hand-o-up": "",
        "fa-hand-o-down": "",
        "fa-arrow-circle-left": "",
        "fa-arrow-circle-right": "",
        "fa-arrow-circle-up": "",
        "fa-arrow-circle-down": "",
        "fa-globe": "",
        "fa-wrench": "",
        "fa-tasks": "",
        "fa-filter": "",
        "fa-briefcase": "",
        "fa-arrows-alt": "",
        "fa-group": "",
        "fa-users": "",
        "fa-chain": "",
        "fa-link": "",
        "fa-cloud": "",
        "fa-flask": "",
        "fa-cut": "",
        "fa-scissors": "",
        "fa-copy": "",
        "fa-files-o": "",
        "fa-paperclip": "",
        "fa-save": "",
        "fa-floppy-o": "",
        "fa-square": "",
        "fa-navicon": "",
        "fa-reorder": "",
        "fa-bars": "",
        "fa-list-ul": "",
        "fa-list-ol": "",
        "fa-strikethrough": "",
        "fa-underline": "",
        "fa-table": "",
        "fa-magic": "",
        "fa-truck": "",
        "fa-pinterest": "",
        "fa-pinterest-square": "",
        "fa-google-plus-square": "",
        "fa-google-plus": "",
        "fa-money": "",
        "fa-caret-down": "",
        "fa-caret-up": "",
        "fa-caret-left": "",
        "fa-caret-right": "",
        "fa-columns": "",
        "fa-unsorted": "",
        "fa-sort": "",
        "fa-sort-down": "",
        "fa-sort-desc": "",
        "fa-sort-up": "",
        "fa-sort-asc": "",
        "fa-envelope": "",
        "fa-linkedin": "",
        "fa-rotate-left": "",
        "fa-undo": "",
        "fa-legal": "",
        "fa-gavel": "",
        "fa-dashboard": "",
        "fa-tachometer": "",
        "fa-comment-o": "",
        "fa-comments-o": "",
        "fa-flash": "",
        "fa-bolt": "",
        "fa-sitemap": "",
        "fa-umbrella": "",
        "fa-paste": "",
        "fa-clipboard": "",
        "fa-lightbulb-o": "",
        "fa-exchange": "",
        "fa-cloud-download": "",
        "fa-cloud-upload": "",
        "fa-user-md": "",
        "fa-stethoscope": "",
        "fa-suitcase": "",
        "fa-bell-o": "",
        "fa-coffee": "",
        "fa-cutlery": "",
        "fa-file-text-o": "",
        "fa-building-o": "",
        "fa-hospital-o": "",
        "fa-ambulance": "",
        "fa-medkit": "",
        "fa-fighter-jet": "",
        "fa-beer": "",
        "fa-h-square": "",
        "fa-plus-square": "",
        "fa-angle-double-left": "",
        "fa-angle-double-right": "",
        "fa-angle-double-up": "",
        "fa-angle-double-down": "",
        "fa-angle-left": "",
        "fa-angle-right": "",
        "fa-angle-up": "",
        "fa-angle-down": "",
        "fa-desktop": "",
        "fa-laptop": "",
        "fa-tablet": "",
        "fa-mobile-phone": "",
        "fa-mobile": "",
        "fa-circle-o": "",
        "fa-quote-left": "",
        "fa-quote-right": "",
        "fa-spinner": "",
        "fa-circle": "",
        "fa-mail-reply": "",
        "fa-reply": "",
        "fa-github-alt": "",
        "fa-folder-o": "",
        "fa-folder-open-o": "",
        "fa-smile-o": "",
        "fa-frown-o": "",
        "fa-meh-o": "",
        "fa-gamepad": "",
        "fa-keyboard-o": "",
        "fa-flag-o": "",
        "fa-flag-checkered": "",
        "fa-terminal": "",
        "fa-code": "",
        "fa-mail-reply-all": "",
        "fa-reply-all": "",
        "fa-star-half-empty": "",
        "fa-star-half-full": "",
        "fa-star-half-o": "",
        "fa-location-arrow": "",
        "fa-crop": "",
        "fa-code-fork": "",
        "fa-unlink": "",
        "fa-chain-broken": "",
        "fa-question": "",
        "fa-info": "",
        "fa-exclamation": "",
        "fa-superscript": "",
        "fa-subscript": "",
        "fa-eraser": "",
        "fa-puzzle-piece": "",
        "fa-microphone": "",
        "fa-microphone-slash": "",
        "fa-shield": "",
        "fa-calendar-o": "",
        "fa-fire-extinguisher": "",
        "fa-rocket": "",
        "fa-maxcdn": "",
        "fa-chevron-circle-left": "",
        "fa-chevron-circle-right": "",
        "fa-chevron-circle-up": "",
        "fa-chevron-circle-down": "",
        "fa-html5": "",
        "fa-css3": "",
        "fa-anchor": "",
        "fa-unlock-alt": "",
        "fa-bullseye": "",
        "fa-ellipsis-h": "",
        "fa-ellipsis-v": "",
        "fa-rss-square": "",
        "fa-play-circle": "",
        "fa-ticket": "",
        "fa-minus-square": "",
        "fa-minus-square-o": "",
        "fa-level-up": "",
        "fa-level-down": "",
        "fa-check-square": "",
        "fa-pencil-square": "",
        "fa-external-link-square": "",
        "fa-share-square": "",
        "fa-compass": "",
        "fa-toggle-down": "",
        "fa-caret-square-o-down": "",
        "fa-toggle-up": "",
        "fa-caret-square-o-up": "",
        "fa-toggle-right": "",
        "fa-caret-square-o-right": "",
        "fa-euro": "",
        "fa-eur": "",
        "fa-gbp": "",
        "fa-dollar": "",
        "fa-usd": "",
        "fa-rupee": "",
        "fa-inr": "",
        "fa-cny": "",
        "fa-rmb": "",
        "fa-yen": "",
        "fa-jpy": "",
        "fa-ruble": "",
        "fa-rouble": "",
        "fa-rub": "",
        "fa-won": "",
        "fa-krw": "",
        "fa-bitcoin": "",
        "fa-btc": "",
        "fa-file": "",
        "fa-file-text": "",
        "fa-sort-alpha-asc": "",
        "fa-sort-alpha-desc": "",
        "fa-sort-amount-asc": "",
        "fa-sort-amount-desc": "",
        "fa-sort-numeric-asc": "",
        "fa-sort-numeric-desc": "",
        "fa-thumbs-up": "",
        "fa-thumbs-down": "",
        "fa-youtube-square": "",
        "fa-youtube": "",
        "fa-xing": "",
        "fa-xing-square": "",
        "fa-youtube-play": "",
        "fa-dropbox": "",
        "fa-stack-overflow": "",
        "fa-instagram": "",
        "fa-flickr": "",
        "fa-adn": "",
        "fa-bitbucket": "",
        "fa-bitbucket-square": "",
        "fa-tumblr": "",
        "fa-tumblr-square": "",
        "fa-long-arrow-down": "",
        "fa-long-arrow-up": "",
        "fa-long-arrow-left": "",
        "fa-long-arrow-right": "",
        "fa-apple": "",
        "fa-windows": "",
        "fa-android": "",
        "fa-linux": "",
        "fa-dribbble": "",
        "fa-skype": "",
        "fa-foursquare": "",
        "fa-trello": "",
        "fa-female": "",
        "fa-male": "",
        "fa-gittip": "",
        "fa-gratipay": "",
        "fa-sun-o": "",
        "fa-moon-o": "",
        "fa-archive": "",
        "fa-bug": "",
        "fa-vk": "",
        "fa-weibo": "",
        "fa-renren": "",
        "fa-pagelines": "",
        "fa-stack-exchange": "",
        "fa-arrow-circle-o-right": "",
        "fa-arrow-circle-o-left": "",
        "fa-toggle-left": "",
        "fa-caret-square-o-left": "",
        "fa-dot-circle-o": "",
        "fa-wheelchair": "",
        "fa-vimeo-square": "",
        "fa-turkish-lira": "",
        "fa-try": "",
        "fa-plus-square-o": "",
        "fa-space-shuttle": "",
        "fa-slack": "",
        "fa-envelope-square": "",
        "fa-wordpress": "",
        "fa-openid": "",
        "fa-institution": "",
        "fa-bank": "",
        "fa-university": "",
        "fa-mortar-board": "",
        "fa-graduation-cap": "",
        "fa-yahoo": "",
        "fa-google": "",
        "fa-reddit": "",
        "fa-reddit-square": "",
        "fa-stumbleupon-circle": "",
        "fa-stumbleupon": "",
        "fa-delicious": "",
        "fa-digg": "",
        "fa-pied-piper": "",
        "fa-pied-piper-alt": "",
        "fa-drupal": "",
        "fa-joomla": "",
        "fa-language": "",
        "fa-fax": "",
        "fa-building": "",
        "fa-child": "",
        "fa-paw": "",
        "fa-spoon": "",
        "fa-cube": "",
        "fa-cubes": "",
        "fa-behance": "",
        "fa-behance-square": "",
        "fa-steam": "",
        "fa-steam-square": "",
        "fa-recycle": "",
        "fa-automobile": "",
        "fa-car": "",
        "fa-cab": "",
        "fa-taxi": "",
        "fa-tree": "",
        "fa-spotify": "",
        "fa-deviantart": "",
        "fa-soundcloud": "",
        "fa-database": "",
        "fa-file-pdf-o": "",
        "fa-file-word-o": "",
        "fa-file-excel-o": "",
        "fa-file-powerpoint-o": "",
        "fa-file-photo-o": "",
        "fa-file-picture-o": "",
        "fa-file-image-o": "",
        "fa-file-zip-o": "",
        "fa-file-archive-o": "",
        "fa-file-sound-o": "",
        "fa-file-audio-o": "",
        "fa-file-movie-o": "",
        "fa-file-video-o": "",
        "fa-file-code-o": "",
        "fa-vine": "",
        "fa-codepen": "",
        "fa-jsfiddle": "",
        "fa-life-bouy": "",
        "fa-life-buoy": "",
        "fa-life-saver": "",
        "fa-support": "",
        "fa-life-ring": "",
        "fa-circle-o-notch": "",
        "fa-ra": "",
        "fa-rebel": "",
        "fa-ge": "",
        "fa-empire": "",
        "fa-git-square": "",
        "fa-git": "",
        "fa-hacker-news": "",
        "fa-tencent-weibo": "",
        "fa-qq": "",
        "fa-wechat": "",
        "fa-weixin": "",
        "fa-send": "",
        "fa-paper-plane": "",
        "fa-send-o": "",
        "fa-paper-plane-o": "",
        "fa-history": "",
        "fa-genderless": "",
        "fa-circle-thin": "",
        "fa-header": "",
        "fa-paragraph": "",
        "fa-sliders": "",
        "fa-share-alt": "",
        "fa-share-alt-square": "",
        "fa-bomb": "",
        "fa-soccer-ball-o": "",
        "fa-futbol-o": "",
        "fa-tty": "",
        "fa-binoculars": "",
        "fa-plug": "",
        "fa-slideshare": "",
        "fa-twitch": "",
        "fa-yelp": "",
        "fa-newspaper-o": "",
        "fa-wifi": "",
        "fa-calculator": "",
        "fa-paypal": "",
        "fa-google-wallet": "",
        "fa-cc-visa": "",
        "fa-cc-mastercard": "",
        "fa-cc-discover": "",
        "fa-cc-amex": "",
        "fa-cc-paypal": "",
        "fa-cc-stripe": "",
        "fa-bell-slash": "",
        "fa-bell-slash-o": "",
        "fa-trash": "",
        "fa-copyright": "",
        "fa-at": "",
        "fa-eyedropper": "",
        "fa-paint-brush": "",
        "fa-birthday-cake": "",
        "fa-area-chart": "",
        "fa-pie-chart": "",
        "fa-line-chart": "",
        "fa-lastfm": "",
        "fa-lastfm-square": "",
        "fa-toggle-off": "",
        "fa-toggle-on": "",
        "fa-bicycle": "",
        "fa-bus": "",
        "fa-ioxhost": "",
        "fa-angellist": "",
        "fa-cc": "",
        "fa-shekel": "",
        "fa-sheqel": "",
        "fa-ils": "",
        "fa-meanpath": "",
        "fa-buysellads": "",
        "fa-connectdevelop": "",
        "fa-dashcube": "",
        "fa-forumbee": "",
        "fa-leanpub": "",
        "fa-sellsy": "",
        "fa-shirtsinbulk": "",
        "fa-simplybuilt": "",
        "fa-skyatlas": "",
        "fa-cart-plus": "",
        "fa-cart-arrow-down": "",
        "fa-diamond": "",
        "fa-ship": "",
        "fa-user-secret": "",
        "fa-motorcycle": "",
        "fa-street-view": "",
        "fa-heartbeat": "",
        "fa-venus": "",
        "fa-mars": "",
        "fa-mercury": "",
        "fa-transgender": "",
        "fa-transgender-alt": "",
        "fa-venus-double": "",
        "fa-mars-double": "",
        "fa-venus-mars": "",
        "fa-mars-stroke": "",
        "fa-mars-stroke-v": "",
        "fa-mars-stroke-h": "",
        "fa-neuter": "",
        "fa-facebook-official": "",
        "fa-pinterest-p": "",
        "fa-whatsapp": "",
        "fa-server": "",
        "fa-user-plus": "",
        "fa-user-times": "",
        "fa-hotel": "",
        "fa-bed": "",
        "fa-viacoin": "",
        "fa-train": "",
        "fa-subway": "",
        "fa-medium": ""
    };
var Interface = function (e, t) {
    if (2 != arguments.length)throw new Error("Interface constructor called with " + arguments.length + "arguments, but expected exactly 2.");
    this.name = e, this.methods = [];
    for (var i = 0, n = t.length; n > i; i++) {
        if ("string" != typeof t[i])throw new Error("Interface constructor expects method names to be passed in as a string.");
        this.methods.push(t[i])
    }
};
Interface.ensureImplements = function (e) {
    if (arguments.length < 2)throw new Error("Interface.ensureImplements was called with " + arguments.length + "arguments, but expected at least 2.");
    for (var t = 1, i = arguments.length; i > t; t++) {
        var n = arguments[t];
        if (n.constructor !== Interface)throw new Error("Interface.ensureImplements expects the second argument to be an instance of the 'Interface' constructor.");
        for (var s = 0, r = n.methods.length; r > s; s++) {
            var a = n.methods[s];
            if (!e[a] || "function" != typeof e[a])throw new Error("This Class does not implement the '" + n.name + "' interface correctly. The method '" + a + "' was not found.")
        }
    }
};
var MapTableModel = new Interface("MapTableModel", ["addListener", "removeListener", "trigger", "select", "unselect", "isSelected", "show", "hide", "hidden", "redraw", "setStatus", "getCenter", "getFloor", "getInfo", "getId"]), ModelPainter = new Interface("ModelPainter", ["_onModelEvent", "redraw", "addListener"]), BackendResource = new Interface("BackendResource", ["save", "destroy", "onSaveSuccess", "onDestroySuccess", "onBackendFailure", "setId", "persistableData"]);
/*! jQuery UI - v1.9.2 - 2012-12-05
 * http://jqueryui.com
 * Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.position.js, jquery.ui.draggable.js, jquery.ui.droppable.js, jquery.ui.resizable.js, jquery.ui.selectable.js, jquery.ui.sortable.js, jquery.ui.accordion.js, jquery.ui.autocomplete.js, jquery.ui.button.js, jquery.ui.datepicker.js, jquery.ui.dialog.js, jquery.ui.menu.js, jquery.ui.progressbar.js, jquery.ui.slider.js, jquery.ui.spinner.js, jquery.ui.tabs.js, jquery.ui.tooltip.js, jquery.ui.effect.js, jquery.ui.effect-blind.js, jquery.ui.effect-bounce.js, jquery.ui.effect-clip.js, jquery.ui.effect-drop.js, jquery.ui.effect-explode.js, jquery.ui.effect-fade.js, jquery.ui.effect-fold.js, jquery.ui.effect-highlight.js, jquery.ui.effect-pulsate.js, jquery.ui.effect-scale.js, jquery.ui.effect-shake.js, jquery.ui.effect-slide.js, jquery.ui.effect-transfer.js
 * Copyright (c) 2012 jQuery Foundation and other contributors Licensed MIT */
!function (e, t) {
    function i(t, i) {
        var s, r, a, o = t.nodeName.toLowerCase();
        return "area" === o ? (s = t.parentNode, r = s.name, t.href && r && "map" === s.nodeName.toLowerCase() ? (a = e("img[usemap=#" + r + "]")[0], !!a && n(a)) : !1) : (/input|select|textarea|button|object/.test(o) ? !t.disabled : "a" === o ? t.href || i : i) && n(t)
    }

    function n(t) {
        return e.expr.filters.visible(t) && !e(t).parents().andSelf().filter(function () {
                return "hidden" === e.css(this, "visibility")
            }).length
    }

    var s = 0, r = /^ui-id-\d+$/;
    e.ui = e.ui || {}, e.ui.version || (e.extend(e.ui, {
        version: "1.9.2",
        keyCode: {
            BACKSPACE: 8,
            COMMA: 188,
            DELETE: 46,
            DOWN: 40,
            END: 35,
            ENTER: 13,
            ESCAPE: 27,
            HOME: 36,
            LEFT: 37,
            NUMPAD_ADD: 107,
            NUMPAD_DECIMAL: 110,
            NUMPAD_DIVIDE: 111,
            NUMPAD_ENTER: 108,
            NUMPAD_MULTIPLY: 106,
            NUMPAD_SUBTRACT: 109,
            PAGE_DOWN: 34,
            PAGE_UP: 33,
            PERIOD: 190,
            RIGHT: 39,
            SPACE: 32,
            TAB: 9,
            UP: 38
        }
    }), e.fn.extend({
        _focus: e.fn.focus, focus: function (t, i) {
            return "number" == typeof t ? this.each(function () {
                var n = this;
                setTimeout(function () {
                    e(n).focus(), i && i.call(n)
                }, t)
            }) : this._focus.apply(this, arguments)
        }, scrollParent: function () {
            var t;
            return t = e.ui.ie && /(static|relative)/.test(this.css("position")) || /absolute/.test(this.css("position")) ? this.parents().filter(function () {
                return /(relative|absolute|fixed)/.test(e.css(this, "position")) && /(auto|scroll)/.test(e.css(this, "overflow") + e.css(this, "overflow-y") + e.css(this, "overflow-x"))
            }).eq(0) : this.parents().filter(function () {
                return /(auto|scroll)/.test(e.css(this, "overflow") + e.css(this, "overflow-y") + e.css(this, "overflow-x"))
            }).eq(0), /fixed/.test(this.css("position")) || !t.length ? e(document) : t
        }, zIndex: function (i) {
            if (i !== t)return this.css("zIndex", i);
            if (this.length)for (var n, s, r = e(this[0]); r.length && r[0] !== document;) {
                if (n = r.css("position"), ("absolute" === n || "relative" === n || "fixed" === n) && (s = parseInt(r.css("zIndex"), 10), !isNaN(s) && 0 !== s))return s;
                r = r.parent()
            }
            return 0
        }, uniqueId: function () {
            return this.each(function () {
                this.id || (this.id = "ui-id-" + ++s)
            })
        }, removeUniqueId: function () {
            return this.each(function () {
                r.test(this.id) && e(this).removeAttr("id")
            })
        }
    }), e.extend(e.expr[":"], {
        data: e.expr.createPseudo ? e.expr.createPseudo(function (t) {
            return function (i) {
                return !!e.data(i, t)
            }
        }) : function (t, i, n) {
            return !!e.data(t, n[3])
        }, focusable: function (t) {
            return i(t, !isNaN(e.attr(t, "tabindex")))
        }, tabbable: function (t) {
            var n = e.attr(t, "tabindex"), s = isNaN(n);
            return (s || n >= 0) && i(t, !s)
        }
    }), e(function () {
        var t = document.body, i = t.appendChild(i = document.createElement("div"));
        i.offsetHeight, e.extend(i.style, {
            minHeight: "100px",
            height: "auto",
            padding: 0,
            borderWidth: 0
        }), e.support.minHeight = 100 === i.offsetHeight, e.support.selectstart = "onselectstart" in i, t.removeChild(i).style.display = "none"
    }), e("<a>").outerWidth(1).jquery || e.each(["Width", "Height"], function (i, n) {
        function s(t, i, n, s) {
            return e.each(r, function () {
                i -= parseFloat(e.css(t, "padding" + this)) || 0, n && (i -= parseFloat(e.css(t, "border" + this + "Width")) || 0), s && (i -= parseFloat(e.css(t, "margin" + this)) || 0)
            }), i
        }

        var r = "Width" === n ? ["Left", "Right"] : ["Top", "Bottom"], a = n.toLowerCase(), o = {
            innerWidth: e.fn.innerWidth,
            innerHeight: e.fn.innerHeight,
            outerWidth: e.fn.outerWidth,
            outerHeight: e.fn.outerHeight
        };
        e.fn["inner" + n] = function (i) {
            return i === t ? o["inner" + n].call(this) : this.each(function () {
                e(this).css(a, s(this, i) + "px")
            })
        }, e.fn["outer" + n] = function (t, i) {
            return "number" != typeof t ? o["outer" + n].call(this, t) : this.each(function () {
                e(this).css(a, s(this, t, !0, i) + "px")
            })
        }
    }), e("<a>").data("a-b", "a").removeData("a-b").data("a-b") && (e.fn.removeData = function (t) {
        return function (i) {
            return arguments.length ? t.call(this, e.camelCase(i)) : t.call(this)
        }
    }(e.fn.removeData)), function () {
        var t = /msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase()) || [];
        e.ui.ie = t.length ? !0 : !1, e.ui.ie6 = 6 === parseFloat(t[1], 10)
    }(), e.fn.extend({
        disableSelection: function () {
            return this.bind((e.support.selectstart ? "selectstart" : "mousedown") + ".ui-disableSelection", function (e) {
                e.preventDefault()
            })
        }, enableSelection: function () {
            return this.unbind(".ui-disableSelection")
        }
    }), e.extend(e.ui, {
        plugin: {
            add: function (t, i, n) {
                var s, r = e.ui[t].prototype;
                for (s in n)r.plugins[s] = r.plugins[s] || [], r.plugins[s].push([i, n[s]])
            }, call: function (e, t, i) {
                var n, s = e.plugins[t];
                if (s && e.element[0].parentNode && 11 !== e.element[0].parentNode.nodeType)for (n = 0; n < s.length; n++)e.options[s[n][0]] && s[n][1].apply(e.element, i)
            }
        }, contains: e.contains, hasScroll: function (t, i) {
            if ("hidden" === e(t).css("overflow"))return !1;
            var n = i && "left" === i ? "scrollLeft" : "scrollTop", s = !1;
            return t[n] > 0 ? !0 : (t[n] = 1, s = t[n] > 0, t[n] = 0, s)
        }, isOverAxis: function (e, t, i) {
            return e > t && t + i > e
        }, isOver: function (t, i, n, s, r, a) {
            return e.ui.isOverAxis(t, n, r) && e.ui.isOverAxis(i, s, a)
        }
    }))
}(jQuery), function (e, t) {
    var i = 0, n = Array.prototype.slice, s = e.cleanData;
    e.cleanData = function (t) {
        for (var i, n = 0; null != (i = t[n]); n++)try {
            e(i).triggerHandler("remove")
        } catch (r) {
        }
        s(t)
    }, e.widget = function (t, i, n) {
        var s, r, a, o, l = t.split(".")[0];
        t = t.split(".")[1], s = l + "-" + t, n || (n = i, i = e.Widget), e.expr[":"][s.toLowerCase()] = function (t) {
            return !!e.data(t, s)
        }, e[l] = e[l] || {}, r = e[l][t], a = e[l][t] = function (e, t) {
            return this._createWidget ? (arguments.length && this._createWidget(e, t), void 0) : new a(e, t)
        }, e.extend(a, r, {
            version: n.version,
            _proto: e.extend({}, n),
            _childConstructors: []
        }), o = new i, o.options = e.widget.extend({}, o.options), e.each(n, function (t, s) {
            e.isFunction(s) && (n[t] = function () {
                var e = function () {
                    return i.prototype[t].apply(this, arguments)
                }, n = function (e) {
                    return i.prototype[t].apply(this, e)
                };
                return function () {
                    var t, i = this._super, r = this._superApply;
                    return this._super = e, this._superApply = n, t = s.apply(this, arguments), this._super = i, this._superApply = r, t
                }
            }())
        }), a.prototype = e.widget.extend(o, {widgetEventPrefix: r ? o.widgetEventPrefix : t}, n, {
            constructor: a,
            namespace: l,
            widgetName: t,
            widgetBaseClass: s,
            widgetFullName: s
        }), r ? (e.each(r._childConstructors, function (t, i) {
            var n = i.prototype;
            e.widget(n.namespace + "." + n.widgetName, a, i._proto)
        }), delete r._childConstructors) : i._childConstructors.push(a), e.widget.bridge(t, a)
    }, e.widget.extend = function (i) {
        for (var s, r, a = n.call(arguments, 1), o = 0, l = a.length; l > o; o++)for (s in a[o])r = a[o][s], a[o].hasOwnProperty(s) && r !== t && (i[s] = e.isPlainObject(r) ? e.isPlainObject(i[s]) ? e.widget.extend({}, i[s], r) : e.widget.extend({}, r) : r);
        return i
    }, e.widget.bridge = function (i, s) {
        var r = s.prototype.widgetFullName || i;
        e.fn[i] = function (a) {
            var o = "string" == typeof a, l = n.call(arguments, 1), h = this;
            return a = !o && l.length ? e.widget.extend.apply(null, [a].concat(l)) : a, o ? this.each(function () {
                var n, s = e.data(this, r);
                return s ? e.isFunction(s[a]) && "_" !== a.charAt(0) ? (n = s[a].apply(s, l), n !== s && n !== t ? (h = n && n.jquery ? h.pushStack(n.get()) : n, !1) : void 0) : e.error("no such method '" + a + "' for " + i + " widget instance") : e.error("cannot call methods on " + i + " prior to initialization; " + "attempted to call method '" + a + "'")
            }) : this.each(function () {
                var t = e.data(this, r);
                t ? t.option(a || {})._init() : e.data(this, r, new s(a, this))
            }), h
        }
    }, e.Widget = function () {
    }, e.Widget._childConstructors = [], e.Widget.prototype = {
        widgetName: "widget",
        widgetEventPrefix: "",
        defaultElement: "<div>",
        options: {disabled: !1, create: null},
        _createWidget: function (t, n) {
            n = e(n || this.defaultElement || this)[0], this.element = e(n), this.uuid = i++, this.eventNamespace = "." + this.widgetName + this.uuid, this.options = e.widget.extend({}, this.options, this._getCreateOptions(), t), this.bindings = e(), this.hoverable = e(), this.focusable = e(), n !== this && (e.data(n, this.widgetName, this), e.data(n, this.widgetFullName, this), this._on(!0, this.element, {
                remove: function (e) {
                    e.target === n && this.destroy()
                }
            }), this.document = e(n.style ? n.ownerDocument : n.document || n), this.window = e(this.document[0].defaultView || this.document[0].parentWindow)), this._create(), this._trigger("create", null, this._getCreateEventData()), this._init()
        },
        _getCreateOptions: e.noop,
        _getCreateEventData: e.noop,
        _create: e.noop,
        _init: e.noop,
        destroy: function () {
            this._destroy(), this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)), this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled " + "ui-state-disabled"), this.bindings.unbind(this.eventNamespace), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")
        },
        _destroy: e.noop,
        widget: function () {
            return this.element
        },
        option: function (i, n) {
            var s, r, a, o = i;
            if (0 === arguments.length)return e.widget.extend({}, this.options);
            if ("string" == typeof i)if (o = {}, s = i.split("."), i = s.shift(), s.length) {
                for (r = o[i] = e.widget.extend({}, this.options[i]), a = 0; a < s.length - 1; a++)r[s[a]] = r[s[a]] || {}, r = r[s[a]];
                if (i = s.pop(), n === t)return r[i] === t ? null : r[i];
                r[i] = n
            } else {
                if (n === t)return this.options[i] === t ? null : this.options[i];
                o[i] = n
            }
            return this._setOptions(o), this
        },
        _setOptions: function (e) {
            var t;
            for (t in e)this._setOption(t, e[t]);
            return this
        },
        _setOption: function (e, t) {
            return this.options[e] = t, "disabled" === e && (this.widget().toggleClass(this.widgetFullName + "-disabled ui-state-disabled", !!t).attr("aria-disabled", t), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")), this
        },
        enable: function () {
            return this._setOption("disabled", !1)
        },
        disable: function () {
            return this._setOption("disabled", !0)
        },
        _on: function (t, i, n) {
            var s, r = this;
            "boolean" != typeof t && (n = i, i = t, t = !1), n ? (i = s = e(i), this.bindings = this.bindings.add(i)) : (n = i, i = this.element, s = this.widget()), e.each(n, function (n, a) {
                function o() {
                    return t || r.options.disabled !== !0 && !e(this).hasClass("ui-state-disabled") ? ("string" == typeof a ? r[a] : a).apply(r, arguments) : void 0
                }

                "string" != typeof a && (o.guid = a.guid = a.guid || o.guid || e.guid++);
                var l = n.match(/^(\w+)\s*(.*)$/), h = l[1] + r.eventNamespace, u = l[2];
                u ? s.delegate(u, h, o) : i.bind(h, o)
            })
        },
        _off: function (e, t) {
            t = (t || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace, e.unbind(t).undelegate(t)
        },
        _delay: function (e, t) {
            function i() {
                return ("string" == typeof e ? n[e] : e).apply(n, arguments)
            }

            var n = this;
            return setTimeout(i, t || 0)
        },
        _hoverable: function (t) {
            this.hoverable = this.hoverable.add(t), this._on(t, {
                mouseenter: function (t) {
                    e(t.currentTarget).addClass("ui-state-hover")
                }, mouseleave: function (t) {
                    e(t.currentTarget).removeClass("ui-state-hover")
                }
            })
        },
        _focusable: function (t) {
            this.focusable = this.focusable.add(t), this._on(t, {
                focusin: function (t) {
                    e(t.currentTarget).addClass("ui-state-focus")
                }, focusout: function (t) {
                    e(t.currentTarget).removeClass("ui-state-focus")
                }
            })
        },
        _trigger: function (t, i, n) {
            var s, r, a = this.options[t];
            if (n = n || {}, i = e.Event(i), i.type = (t === this.widgetEventPrefix ? t : this.widgetEventPrefix + t).toLowerCase(), i.target = this.element[0], r = i.originalEvent, r)for (s in r)s in i || (i[s] = r[s]);
            return this.element.trigger(i, n), !(e.isFunction(a) && a.apply(this.element[0], [i].concat(n)) === !1 || i.isDefaultPrevented())
        }
    }, e.each({show: "fadeIn", hide: "fadeOut"}, function (t, i) {
        e.Widget.prototype["_" + t] = function (n, s, r) {
            "string" == typeof s && (s = {effect: s});
            var a, o = s ? s === !0 || "number" == typeof s ? i : s.effect || i : t;
            s = s || {}, "number" == typeof s && (s = {duration: s}), a = !e.isEmptyObject(s), s.complete = r, s.delay && n.delay(s.delay), a && e.effects && (e.effects.effect[o] || e.uiBackCompat !== !1 && e.effects[o]) ? n[t](s) : o !== t && n[o] ? n[o](s.duration, s.easing, r) : n.queue(function (i) {
                e(this)[t](), r && r.call(n[0]), i()
            })
        }
    }), e.uiBackCompat !== !1 && (e.Widget.prototype._getCreateOptions = function () {
        return e.metadata && e.metadata.get(this.element[0])[this.widgetName]
    })
}(jQuery), function (e) {
    var t = !1;
    e(document).mouseup(function () {
        t = !1
    }), e.widget("ui.mouse", {
        version: "1.9.2",
        options: {cancel: "input,textarea,button,select,option", distance: 1, delay: 0},
        _mouseInit: function () {
            var t = this;
            this.element.bind("mousedown." + this.widgetName, function (e) {
                return t._mouseDown(e)
            }).bind("click." + this.widgetName, function (i) {
                return !0 === e.data(i.target, t.widgetName + ".preventClickEvent") ? (e.removeData(i.target, t.widgetName + ".preventClickEvent"), i.stopImmediatePropagation(), !1) : void 0
            }), this.started = !1
        },
        _mouseDestroy: function () {
            this.element.unbind("." + this.widgetName), this._mouseMoveDelegate && e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate)
        },
        _mouseDown: function (i) {
            if (!t) {
                this._mouseStarted && this._mouseUp(i), this._mouseDownEvent = i;
                var n = this, s = 1 === i.which, r = "string" == typeof this.options.cancel && i.target.nodeName ? e(i.target).closest(this.options.cancel).length : !1;
                return s && !r && this._mouseCapture(i) ? (this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function () {
                    n.mouseDelayMet = !0
                }, this.options.delay)), this._mouseDistanceMet(i) && this._mouseDelayMet(i) && (this._mouseStarted = this._mouseStart(i) !== !1, !this._mouseStarted) ? (i.preventDefault(), !0) : (!0 === e.data(i.target, this.widgetName + ".preventClickEvent") && e.removeData(i.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function (e) {
                    return n._mouseMove(e)
                }, this._mouseUpDelegate = function (e) {
                    return n._mouseUp(e)
                }, e(document).bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), i.preventDefault(), t = !0, !0)) : !0
            }
        },
        _mouseMove: function (t) {
            return !e.ui.ie || document.documentMode >= 9 || t.button ? this._mouseStarted ? (this._mouseDrag(t), t.preventDefault()) : (this._mouseDistanceMet(t) && this._mouseDelayMet(t) && (this._mouseStarted = this._mouseStart(this._mouseDownEvent, t) !== !1, this._mouseStarted ? this._mouseDrag(t) : this._mouseUp(t)), !this._mouseStarted) : this._mouseUp(t)
        },
        _mouseUp: function (t) {
            return e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, t.target === this._mouseDownEvent.target && e.data(t.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(t)), !1
        },
        _mouseDistanceMet: function (e) {
            return Math.max(Math.abs(this._mouseDownEvent.pageX - e.pageX), Math.abs(this._mouseDownEvent.pageY - e.pageY)) >= this.options.distance
        },
        _mouseDelayMet: function () {
            return this.mouseDelayMet
        },
        _mouseStart: function () {
        },
        _mouseDrag: function () {
        },
        _mouseStop: function () {
        },
        _mouseCapture: function () {
            return !0
        }
    })
}(jQuery), function (e, t) {
    function i(e, t, i) {
        return [parseInt(e[0], 10) * (p.test(e[0]) ? t / 100 : 1), parseInt(e[1], 10) * (p.test(e[1]) ? i / 100 : 1)]
    }

    function n(t, i) {
        return parseInt(e.css(t, i), 10) || 0
    }

    e.ui = e.ui || {};
    var s, r = Math.max, a = Math.abs, o = Math.round, l = /left|center|right/, h = /top|center|bottom/, u = /[\+\-]\d+%?/, c = /^\w+/, p = /%$/, d = e.fn.position;
    e.position = {
        scrollbarWidth: function () {
            if (s !== t)return s;
            var i, n, r = e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"), a = r.children()[0];
            return e("body").append(r), i = a.offsetWidth, r.css("overflow", "scroll"), n = a.offsetWidth, i === n && (n = r[0].clientWidth), r.remove(), s = i - n
        }, getScrollInfo: function (t) {
            var i = t.isWindow ? "" : t.element.css("overflow-x"), n = t.isWindow ? "" : t.element.css("overflow-y"), s = "scroll" === i || "auto" === i && t.width < t.element[0].scrollWidth, r = "scroll" === n || "auto" === n && t.height < t.element[0].scrollHeight;
            return {width: s ? e.position.scrollbarWidth() : 0, height: r ? e.position.scrollbarWidth() : 0}
        }, getWithinInfo: function (t) {
            var i = e(t || window), n = e.isWindow(i[0]);
            return {
                element: i,
                isWindow: n,
                offset: i.offset() || {left: 0, top: 0},
                scrollLeft: i.scrollLeft(),
                scrollTop: i.scrollTop(),
                width: n ? i.width() : i.outerWidth(),
                height: n ? i.height() : i.outerHeight()
            }
        }
    }, e.fn.position = function (t) {
        if (!t || !t.of)return d.apply(this, arguments);
        t = e.extend({}, t);
        var s, p, f, m, g, y = e(t.of), v = e.position.getWithinInfo(t.within), b = e.position.getScrollInfo(v), L = y[0], w = (t.collision || "flip").split(" "), O = {};
        return 9 === L.nodeType ? (p = y.width(), f = y.height(), m = {
            top: 0,
            left: 0
        }) : e.isWindow(L) ? (p = y.width(), f = y.height(), m = {
            top: y.scrollTop(),
            left: y.scrollLeft()
        }) : L.preventDefault ? (t.at = "left top", p = f = 0, m = {
            top: L.pageY,
            left: L.pageX
        }) : (p = y.outerWidth(), f = y.outerHeight(), m = y.offset()), g = e.extend({}, m), e.each(["my", "at"], function () {
            var e, i, n = (t[this] || "").split(" ");
            1 === n.length && (n = l.test(n[0]) ? n.concat(["center"]) : h.test(n[0]) ? ["center"].concat(n) : ["center", "center"]), n[0] = l.test(n[0]) ? n[0] : "center", n[1] = h.test(n[1]) ? n[1] : "center", e = u.exec(n[0]), i = u.exec(n[1]), O[this] = [e ? e[0] : 0, i ? i[0] : 0], t[this] = [c.exec(n[0])[0], c.exec(n[1])[0]]
        }), 1 === w.length && (w[1] = w[0]), "right" === t.at[0] ? g.left += p : "center" === t.at[0] && (g.left += p / 2), "bottom" === t.at[1] ? g.top += f : "center" === t.at[1] && (g.top += f / 2), s = i(O.at, p, f), g.left += s[0], g.top += s[1], this.each(function () {
            var l, h, u = e(this), c = u.outerWidth(), d = u.outerHeight(), L = n(this, "marginLeft"), C = n(this, "marginTop"), x = c + L + n(this, "marginRight") + b.width, S = d + C + n(this, "marginBottom") + b.height, _ = e.extend({}, g), T = i(O.my, u.outerWidth(), u.outerHeight());
            "right" === t.my[0] ? _.left -= c : "center" === t.my[0] && (_.left -= c / 2), "bottom" === t.my[1] ? _.top -= d : "center" === t.my[1] && (_.top -= d / 2), _.left += T[0], _.top += T[1], e.support.offsetFractions || (_.left = o(_.left), _.top = o(_.top)), l = {
                marginLeft: L,
                marginTop: C
            }, e.each(["left", "top"], function (i, n) {
                e.ui.position[w[i]] && e.ui.position[w[i]][n](_, {
                    targetWidth: p,
                    targetHeight: f,
                    elemWidth: c,
                    elemHeight: d,
                    collisionPosition: l,
                    collisionWidth: x,
                    collisionHeight: S,
                    offset: [s[0] + T[0], s[1] + T[1]],
                    my: t.my,
                    at: t.at,
                    within: v,
                    elem: u
                })
            }), e.fn.bgiframe && u.bgiframe(), t.using && (h = function (e) {
                var i = m.left - _.left, n = i + p - c, s = m.top - _.top, o = s + f - d, l = {
                    target: {
                        element: y,
                        left: m.left,
                        top: m.top,
                        width: p,
                        height: f
                    },
                    element: {element: u, left: _.left, top: _.top, width: c, height: d},
                    horizontal: 0 > n ? "left" : i > 0 ? "right" : "center",
                    vertical: 0 > o ? "top" : s > 0 ? "bottom" : "middle"
                };
                c > p && a(i + n) < p && (l.horizontal = "center"), d > f && a(s + o) < f && (l.vertical = "middle"), l.important = r(a(i), a(n)) > r(a(s), a(o)) ? "horizontal" : "vertical", t.using.call(this, e, l)
            }), u.offset(e.extend(_, {using: h}))
        })
    }, e.ui.position = {
        fit: {
            left: function (e, t) {
                var i, n = t.within, s = n.isWindow ? n.scrollLeft : n.offset.left, a = n.width, o = e.left - t.collisionPosition.marginLeft, l = s - o, h = o + t.collisionWidth - a - s;
                t.collisionWidth > a ? l > 0 && 0 >= h ? (i = e.left + l + t.collisionWidth - a - s, e.left += l - i) : e.left = h > 0 && 0 >= l ? s : l > h ? s + a - t.collisionWidth : s : l > 0 ? e.left += l : h > 0 ? e.left -= h : e.left = r(e.left - o, e.left)
            }, top: function (e, t) {
                var i, n = t.within, s = n.isWindow ? n.scrollTop : n.offset.top, a = t.within.height, o = e.top - t.collisionPosition.marginTop, l = s - o, h = o + t.collisionHeight - a - s;
                t.collisionHeight > a ? l > 0 && 0 >= h ? (i = e.top + l + t.collisionHeight - a - s, e.top += l - i) : e.top = h > 0 && 0 >= l ? s : l > h ? s + a - t.collisionHeight : s : l > 0 ? e.top += l : h > 0 ? e.top -= h : e.top = r(e.top - o, e.top)
            }
        }, flip: {
            left: function (e, t) {
                var i, n, s = t.within, r = s.offset.left + s.scrollLeft, o = s.width, l = s.isWindow ? s.scrollLeft : s.offset.left, h = e.left - t.collisionPosition.marginLeft, u = h - l, c = h + t.collisionWidth - o - l, p = "left" === t.my[0] ? -t.elemWidth : "right" === t.my[0] ? t.elemWidth : 0, d = "left" === t.at[0] ? t.targetWidth : "right" === t.at[0] ? -t.targetWidth : 0, f = -2 * t.offset[0];
                0 > u ? (i = e.left + p + d + f + t.collisionWidth - o - r, (0 > i || i < a(u)) && (e.left += p + d + f)) : c > 0 && (n = e.left - t.collisionPosition.marginLeft + p + d + f - l, (n > 0 || a(n) < c) && (e.left += p + d + f))
            }, top: function (e, t) {
                var i, n, s = t.within, r = s.offset.top + s.scrollTop, o = s.height, l = s.isWindow ? s.scrollTop : s.offset.top, h = e.top - t.collisionPosition.marginTop, u = h - l, c = h + t.collisionHeight - o - l, p = "top" === t.my[1], d = p ? -t.elemHeight : "bottom" === t.my[1] ? t.elemHeight : 0, f = "top" === t.at[1] ? t.targetHeight : "bottom" === t.at[1] ? -t.targetHeight : 0, m = -2 * t.offset[1];
                0 > u ? (n = e.top + d + f + m + t.collisionHeight - o - r, e.top + d + f + m > u && (0 > n || n < a(u)) && (e.top += d + f + m)) : c > 0 && (i = e.top - t.collisionPosition.marginTop + d + f + m - l, e.top + d + f + m > c && (i > 0 || a(i) < c) && (e.top += d + f + m))
            }
        }, flipfit: {
            left: function () {
                e.ui.position.flip.left.apply(this, arguments), e.ui.position.fit.left.apply(this, arguments)
            }, top: function () {
                e.ui.position.flip.top.apply(this, arguments), e.ui.position.fit.top.apply(this, arguments)
            }
        }
    }, function () {
        var t, i, n, s, r, a = document.getElementsByTagName("body")[0], o = document.createElement("div");
        t = document.createElement(a ? "div" : "body"), n = {
            visibility: "hidden",
            width: 0,
            height: 0,
            border: 0,
            margin: 0,
            background: "none"
        }, a && e.extend(n, {position: "absolute", left: "-1000px", top: "-1000px"});
        for (r in n)t.style[r] = n[r];
        t.appendChild(o), i = a || document.documentElement, i.insertBefore(t, i.firstChild), o.style.cssText = "position: absolute; left: 10.7432222px;", s = e(o).offset().left, e.support.offsetFractions = s > 10 && 11 > s, t.innerHTML = "", i.removeChild(t)
    }(), e.uiBackCompat !== !1 && function (e) {
        var i = e.fn.position;
        e.fn.position = function (n) {
            if (!n || !n.offset)return i.call(this, n);
            var s = n.offset.split(" "), r = n.at.split(" ");
            return 1 === s.length && (s[1] = s[0]), /^\d/.test(s[0]) && (s[0] = "+" + s[0]), /^\d/.test(s[1]) && (s[1] = "+" + s[1]), 1 === r.length && (/left|center|right/.test(r[0]) ? r[1] = "center" : (r[1] = r[0], r[0] = "center")), i.call(this, e.extend(n, {
                at: r[0] + s[0] + " " + r[1] + s[1],
                offset: t
            }))
        }
    }(jQuery)
}(jQuery), function (e) {
    e.widget("ui.draggable", e.ui.mouse, {
        version: "1.9.2",
        widgetEventPrefix: "drag",
        options: {
            addClasses: !0,
            appendTo: "parent",
            axis: !1,
            connectToSortable: !1,
            containment: !1,
            cursor: "auto",
            cursorAt: !1,
            grid: !1,
            handle: !1,
            helper: "original",
            iframeFix: !1,
            opacity: !1,
            refreshPositions: !1,
            revert: !1,
            revertDuration: 500,
            scope: "default",
            scroll: !0,
            scrollSensitivity: 20,
            scrollSpeed: 20,
            snap: !1,
            snapMode: "both",
            snapTolerance: 20,
            stack: !1,
            zIndex: !1
        },
        _create: function () {
            "original" == this.options.helper && !/^(?:r|a|f)/.test(this.element.css("position")) && (this.element[0].style.position = "relative"), this.options.addClasses && this.element.addClass("ui-draggable"), this.options.disabled && this.element.addClass("ui-draggable-disabled"), this._mouseInit()
        },
        _destroy: function () {
            this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"), this._mouseDestroy()
        },
        _mouseCapture: function (t) {
            var i = this.options;
            return this.helper || i.disabled || e(t.target).is(".ui-resizable-handle") ? !1 : (this.handle = this._getHandle(t), this.handle ? (e(i.iframeFix === !0 ? "iframe" : i.iframeFix).each(function () {
                e('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({
                    width: this.offsetWidth + "px",
                    height: this.offsetHeight + "px",
                    position: "absolute",
                    opacity: "0.001",
                    zIndex: 1e3
                }).css(e(this).offset()).appendTo("body")
            }), !0) : !1)
        },
        _mouseStart: function (t) {
            var i = this.options;
            return this.helper = this._createHelper(t), this.helper.addClass("ui-draggable-dragging"), this._cacheHelperProportions(), e.ui.ddmanager && (e.ui.ddmanager.current = this), this._cacheMargins(), this.cssPosition = this.helper.css("position"), this.scrollParent = this.helper.scrollParent(), this.offset = this.positionAbs = this.element.offset(), this.offset = {
                top: this.offset.top - this.margins.top,
                left: this.offset.left - this.margins.left
            }, e.extend(this.offset, {
                click: {left: t.pageX - this.offset.left, top: t.pageY - this.offset.top},
                parent: this._getParentOffset(),
                relative: this._getRelativeOffset()
            }), this.originalPosition = this.position = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, i.cursorAt && this._adjustOffsetFromHelper(i.cursorAt), i.containment && this._setContainment(), this._trigger("start", t) === !1 ? (this._clear(), !1) : (this._cacheHelperProportions(), e.ui.ddmanager && !i.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), this._mouseDrag(t, !0), e.ui.ddmanager && e.ui.ddmanager.dragStart(this, t), !0)
        },
        _mouseDrag: function (t, i) {
            if (this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute"), !i) {
                var n = this._uiHash();
                if (this._trigger("drag", t, n) === !1)return this._mouseUp({}), !1;
                this.position = n.position
            }
            return this.options.axis && "y" == this.options.axis || (this.helper[0].style.left = this.position.left + "px"), this.options.axis && "x" == this.options.axis || (this.helper[0].style.top = this.position.top + "px"), e.ui.ddmanager && e.ui.ddmanager.drag(this, t), !1
        },
        _mouseStop: function (t) {
            var i = !1;
            e.ui.ddmanager && !this.options.dropBehaviour && (i = e.ui.ddmanager.drop(this, t)), this.dropped && (i = this.dropped, this.dropped = !1);
            for (var n = this.element[0], s = !1; n && (n = n.parentNode);)n == document && (s = !0);
            if (!s && "original" === this.options.helper)return !1;
            if ("invalid" == this.options.revert && !i || "valid" == this.options.revert && i || this.options.revert === !0 || e.isFunction(this.options.revert) && this.options.revert.call(this.element, i)) {
                var r = this;
                e(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function () {
                    r._trigger("stop", t) !== !1 && r._clear()
                })
            } else this._trigger("stop", t) !== !1 && this._clear();
            return !1
        },
        _mouseUp: function (t) {
            return e("div.ui-draggable-iframeFix").each(function () {
                this.parentNode.removeChild(this)
            }), e.ui.ddmanager && e.ui.ddmanager.dragStop(this, t), e.ui.mouse.prototype._mouseUp.call(this, t)
        },
        cancel: function () {
            return this.helper.is(".ui-draggable-dragging") ? this._mouseUp({}) : this._clear(), this
        },
        _getHandle: function (t) {
            var i = this.options.handle && e(this.options.handle, this.element).length ? !1 : !0;
            return e(this.options.handle, this.element).find("*").andSelf().each(function () {
                this == t.target && (i = !0)
            }), i
        },
        _createHelper: function (t) {
            var i = this.options, n = e.isFunction(i.helper) ? e(i.helper.apply(this.element[0], [t])) : "clone" == i.helper ? this.element.clone().removeAttr("id") : this.element;
            return n.parents("body").length || n.appendTo("parent" == i.appendTo ? this.element[0].parentNode : i.appendTo), n[0] != this.element[0] && !/(fixed|absolute)/.test(n.css("position")) && n.css("position", "absolute"), n
        },
        _adjustOffsetFromHelper: function (t) {
            "string" == typeof t && (t = t.split(" ")), e.isArray(t) && (t = {
                left: +t[0],
                top: +t[1] || 0
            }), "left" in t && (this.offset.click.left = t.left + this.margins.left), "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left), "top" in t && (this.offset.click.top = t.top + this.margins.top), "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top)
        },
        _getParentOffset: function () {
            this.offsetParent = this.helper.offsetParent();
            var t = this.offsetParent.offset();
            return "absolute" == this.cssPosition && this.scrollParent[0] != document && e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop()), (this.offsetParent[0] == document.body || this.offsetParent[0].tagName && "html" == this.offsetParent[0].tagName.toLowerCase() && e.ui.ie) && (t = {
                top: 0,
                left: 0
            }), {
                top: t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
                left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
            }
        },
        _getRelativeOffset: function () {
            if ("relative" == this.cssPosition) {
                var e = this.element.position();
                return {
                    top: e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),
                    left: e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()
                }
            }
            return {top: 0, left: 0}
        },
        _cacheMargins: function () {
            this.margins = {
                left: parseInt(this.element.css("marginLeft"), 10) || 0,
                top: parseInt(this.element.css("marginTop"), 10) || 0,
                right: parseInt(this.element.css("marginRight"), 10) || 0,
                bottom: parseInt(this.element.css("marginBottom"), 10) || 0
            }
        },
        _cacheHelperProportions: function () {
            this.helperProportions = {width: this.helper.outerWidth(), height: this.helper.outerHeight()}
        },
        _setContainment: function () {
            var t = this.options;
            if ("parent" == t.containment && (t.containment = this.helper[0].parentNode), ("document" == t.containment || "window" == t.containment) && (this.containment = ["document" == t.containment ? 0 : e(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left, "document" == t.containment ? 0 : e(window).scrollTop() - this.offset.relative.top - this.offset.parent.top, ("document" == t.containment ? 0 : e(window).scrollLeft()) + e("document" == t.containment ? document : window).width() - this.helperProportions.width - this.margins.left, ("document" == t.containment ? 0 : e(window).scrollTop()) + (e("document" == t.containment ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]), /^(document|window|parent)$/.test(t.containment) || t.containment.constructor == Array) t.containment.constructor == Array && (this.containment = t.containment); else {
                var i = e(t.containment), n = i[0];
                if (!n)return;
                var s = (i.offset(), "hidden" != e(n).css("overflow"));
                this.containment = [(parseInt(e(n).css("borderLeftWidth"), 10) || 0) + (parseInt(e(n).css("paddingLeft"), 10) || 0), (parseInt(e(n).css("borderTopWidth"), 10) || 0) + (parseInt(e(n).css("paddingTop"), 10) || 0), (s ? Math.max(n.scrollWidth, n.offsetWidth) : n.offsetWidth) - (parseInt(e(n).css("borderLeftWidth"), 10) || 0) - (parseInt(e(n).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right, (s ? Math.max(n.scrollHeight, n.offsetHeight) : n.offsetHeight) - (parseInt(e(n).css("borderTopWidth"), 10) || 0) - (parseInt(e(n).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom], this.relative_container = i
            }
        },
        _convertPositionTo: function (t, i) {
            i || (i = this.position);
            var n = "absolute" == t ? 1 : -1, s = (this.options, "absolute" != this.cssPosition || this.scrollParent[0] != document && e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent), r = /(html|body)/i.test(s[0].tagName);
            return {
                top: i.top + this.offset.relative.top * n + this.offset.parent.top * n - ("fixed" == this.cssPosition ? -this.scrollParent.scrollTop() : r ? 0 : s.scrollTop()) * n,
                left: i.left + this.offset.relative.left * n + this.offset.parent.left * n - ("fixed" == this.cssPosition ? -this.scrollParent.scrollLeft() : r ? 0 : s.scrollLeft()) * n
            }
        },
        _generatePosition: function (t) {
            var i = this.options, n = "absolute" != this.cssPosition || this.scrollParent[0] != document && e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, s = /(html|body)/i.test(n[0].tagName), r = t.pageX, a = t.pageY;
            if (this.originalPosition) {
                var o;
                if (this.containment) {
                    if (this.relative_container) {
                        var l = this.relative_container.offset();
                        o = [this.containment[0] + l.left, this.containment[1] + l.top, this.containment[2] + l.left, this.containment[3] + l.top]
                    } else o = this.containment;
                    t.pageX - this.offset.click.left < o[0] && (r = o[0] + this.offset.click.left), t.pageY - this.offset.click.top < o[1] && (a = o[1] + this.offset.click.top), t.pageX - this.offset.click.left > o[2] && (r = o[2] + this.offset.click.left), t.pageY - this.offset.click.top > o[3] && (a = o[3] + this.offset.click.top)
                }
                if (i.grid) {
                    var h = i.grid[1] ? this.originalPageY + Math.round((a - this.originalPageY) / i.grid[1]) * i.grid[1] : this.originalPageY;
                    a = o ? h - this.offset.click.top < o[1] || h - this.offset.click.top > o[3] ? h - this.offset.click.top < o[1] ? h + i.grid[1] : h - i.grid[1] : h : h;
                    var u = i.grid[0] ? this.originalPageX + Math.round((r - this.originalPageX) / i.grid[0]) * i.grid[0] : this.originalPageX;
                    r = o ? u - this.offset.click.left < o[0] || u - this.offset.click.left > o[2] ? u - this.offset.click.left < o[0] ? u + i.grid[0] : u - i.grid[0] : u : u
                }
            }
            return {
                top: a - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + ("fixed" == this.cssPosition ? -this.scrollParent.scrollTop() : s ? 0 : n.scrollTop()),
                left: r - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + ("fixed" == this.cssPosition ? -this.scrollParent.scrollLeft() : s ? 0 : n.scrollLeft())
            }
        },
        _clear: function () {
            this.helper.removeClass("ui-draggable-dragging"), this.helper[0] != this.element[0] && !this.cancelHelperRemoval && this.helper.remove(), this.helper = null, this.cancelHelperRemoval = !1
        },
        _trigger: function (t, i, n) {
            return n = n || this._uiHash(), e.ui.plugin.call(this, t, [i, n]), "drag" == t && (this.positionAbs = this._convertPositionTo("absolute")), e.Widget.prototype._trigger.call(this, t, i, n)
        },
        plugins: {},
        _uiHash: function () {
            return {
                helper: this.helper,
                position: this.position,
                originalPosition: this.originalPosition,
                offset: this.positionAbs
            }
        }
    }), e.ui.plugin.add("draggable", "connectToSortable", {
        start: function (t, i) {
            var n = e(this).data("draggable"), s = n.options, r = e.extend({}, i, {item: n.element});
            n.sortables = [], e(s.connectToSortable).each(function () {
                var i = e.data(this, "sortable");
                i && !i.options.disabled && (n.sortables.push({
                    instance: i,
                    shouldRevert: i.options.revert
                }), i.refreshPositions(), i._trigger("activate", t, r))
            })
        }, stop: function (t, i) {
            var n = e(this).data("draggable"), s = e.extend({}, i, {item: n.element});
            e.each(n.sortables, function () {
                this.instance.isOver ? (this.instance.isOver = 0, n.cancelHelperRemoval = !0, this.instance.cancelHelperRemoval = !1, this.shouldRevert && (this.instance.options.revert = !0), this.instance._mouseStop(t), this.instance.options.helper = this.instance.options._helper, "original" == n.options.helper && this.instance.currentItem.css({
                    top: "auto",
                    left: "auto"
                })) : (this.instance.cancelHelperRemoval = !1, this.instance._trigger("deactivate", t, s))
            })
        }, drag: function (t, i) {
            var n = e(this).data("draggable"), s = this;
            e.each(n.sortables, function () {
                var r = !1, a = this;
                this.instance.positionAbs = n.positionAbs, this.instance.helperProportions = n.helperProportions, this.instance.offset.click = n.offset.click, this.instance._intersectsWith(this.instance.containerCache) && (r = !0, e.each(n.sortables, function () {
                    return this.instance.positionAbs = n.positionAbs, this.instance.helperProportions = n.helperProportions, this.instance.offset.click = n.offset.click, this != a && this.instance._intersectsWith(this.instance.containerCache) && e.ui.contains(a.instance.element[0], this.instance.element[0]) && (r = !1), r
                })), r ? (this.instance.isOver || (this.instance.isOver = 1, this.instance.currentItem = e(s).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item", !0), this.instance.options._helper = this.instance.options.helper, this.instance.options.helper = function () {
                    return i.helper[0]
                }, t.target = this.instance.currentItem[0], this.instance._mouseCapture(t, !0), this.instance._mouseStart(t, !0, !0), this.instance.offset.click.top = n.offset.click.top, this.instance.offset.click.left = n.offset.click.left, this.instance.offset.parent.left -= n.offset.parent.left - this.instance.offset.parent.left, this.instance.offset.parent.top -= n.offset.parent.top - this.instance.offset.parent.top, n._trigger("toSortable", t), n.dropped = this.instance.element, n.currentItem = n.element, this.instance.fromOutside = n), this.instance.currentItem && this.instance._mouseDrag(t)) : this.instance.isOver && (this.instance.isOver = 0, this.instance.cancelHelperRemoval = !0, this.instance.options.revert = !1, this.instance._trigger("out", t, this.instance._uiHash(this.instance)), this.instance._mouseStop(t, !0), this.instance.options.helper = this.instance.options._helper, this.instance.currentItem.remove(), this.instance.placeholder && this.instance.placeholder.remove(), n._trigger("fromSortable", t), n.dropped = !1)
            })
        }
    }), e.ui.plugin.add("draggable", "cursor", {
        start: function () {
            var t = e("body"), i = e(this).data("draggable").options;
            t.css("cursor") && (i._cursor = t.css("cursor")), t.css("cursor", i.cursor)
        }, stop: function () {
            var t = e(this).data("draggable").options;
            t._cursor && e("body").css("cursor", t._cursor)
        }
    }), e.ui.plugin.add("draggable", "opacity", {
        start: function (t, i) {
            var n = e(i.helper), s = e(this).data("draggable").options;
            n.css("opacity") && (s._opacity = n.css("opacity")), n.css("opacity", s.opacity)
        }, stop: function (t, i) {
            var n = e(this).data("draggable").options;
            n._opacity && e(i.helper).css("opacity", n._opacity)
        }
    }), e.ui.plugin.add("draggable", "scroll", {
        start: function () {
            var t = e(this).data("draggable");
            t.scrollParent[0] != document && "HTML" != t.scrollParent[0].tagName && (t.overflowOffset = t.scrollParent.offset())
        }, drag: function (t) {
            var i = e(this).data("draggable"), n = i.options, s = !1;
            i.scrollParent[0] != document && "HTML" != i.scrollParent[0].tagName ? (n.axis && "x" == n.axis || (i.overflowOffset.top + i.scrollParent[0].offsetHeight - t.pageY < n.scrollSensitivity ? i.scrollParent[0].scrollTop = s = i.scrollParent[0].scrollTop + n.scrollSpeed : t.pageY - i.overflowOffset.top < n.scrollSensitivity && (i.scrollParent[0].scrollTop = s = i.scrollParent[0].scrollTop - n.scrollSpeed)), n.axis && "y" == n.axis || (i.overflowOffset.left + i.scrollParent[0].offsetWidth - t.pageX < n.scrollSensitivity ? i.scrollParent[0].scrollLeft = s = i.scrollParent[0].scrollLeft + n.scrollSpeed : t.pageX - i.overflowOffset.left < n.scrollSensitivity && (i.scrollParent[0].scrollLeft = s = i.scrollParent[0].scrollLeft - n.scrollSpeed))) : (n.axis && "x" == n.axis || (t.pageY - e(document).scrollTop() < n.scrollSensitivity ? s = e(document).scrollTop(e(document).scrollTop() - n.scrollSpeed) : e(window).height() - (t.pageY - e(document).scrollTop()) < n.scrollSensitivity && (s = e(document).scrollTop(e(document).scrollTop() + n.scrollSpeed))), n.axis && "y" == n.axis || (t.pageX - e(document).scrollLeft() < n.scrollSensitivity ? s = e(document).scrollLeft(e(document).scrollLeft() - n.scrollSpeed) : e(window).width() - (t.pageX - e(document).scrollLeft()) < n.scrollSensitivity && (s = e(document).scrollLeft(e(document).scrollLeft() + n.scrollSpeed)))), s !== !1 && e.ui.ddmanager && !n.dropBehaviour && e.ui.ddmanager.prepareOffsets(i, t)
        }
    }), e.ui.plugin.add("draggable", "snap", {
        start: function () {
            var t = e(this).data("draggable"), i = t.options;
            t.snapElements = [], e(i.snap.constructor != String ? i.snap.items || ":data(draggable)" : i.snap).each(function () {
                var i = e(this), n = i.offset();
                this != t.element[0] && t.snapElements.push({
                    item: this,
                    width: i.outerWidth(),
                    height: i.outerHeight(),
                    top: n.top,
                    left: n.left
                })
            })
        }, drag: function (t, i) {
            for (var n = e(this).data("draggable"), s = n.options, r = s.snapTolerance, a = i.offset.left, o = a + n.helperProportions.width, l = i.offset.top, h = l + n.helperProportions.height, u = n.snapElements.length - 1; u >= 0; u--) {
                var c = n.snapElements[u].left, p = c + n.snapElements[u].width, d = n.snapElements[u].top, f = d + n.snapElements[u].height;
                if (a > c - r && p + r > a && l > d - r && f + r > l || a > c - r && p + r > a && h > d - r && f + r > h || o > c - r && p + r > o && l > d - r && f + r > l || o > c - r && p + r > o && h > d - r && f + r > h) {
                    if ("inner" != s.snapMode) {
                        var m = Math.abs(d - h) <= r, g = Math.abs(f - l) <= r, y = Math.abs(c - o) <= r, v = Math.abs(p - a) <= r;
                        m && (i.position.top = n._convertPositionTo("relative", {
                                top: d - n.helperProportions.height,
                                left: 0
                            }).top - n.margins.top), g && (i.position.top = n._convertPositionTo("relative", {
                                top: f,
                                left: 0
                            }).top - n.margins.top), y && (i.position.left = n._convertPositionTo("relative", {
                                top: 0,
                                left: c - n.helperProportions.width
                            }).left - n.margins.left), v && (i.position.left = n._convertPositionTo("relative", {
                                top: 0,
                                left: p
                            }).left - n.margins.left)
                    }
                    var b = m || g || y || v;
                    if ("outer" != s.snapMode) {
                        var m = Math.abs(d - l) <= r, g = Math.abs(f - h) <= r, y = Math.abs(c - a) <= r, v = Math.abs(p - o) <= r;
                        m && (i.position.top = n._convertPositionTo("relative", {
                                top: d,
                                left: 0
                            }).top - n.margins.top), g && (i.position.top = n._convertPositionTo("relative", {
                                top: f - n.helperProportions.height,
                                left: 0
                            }).top - n.margins.top), y && (i.position.left = n._convertPositionTo("relative", {
                                top: 0,
                                left: c
                            }).left - n.margins.left), v && (i.position.left = n._convertPositionTo("relative", {
                                top: 0,
                                left: p - n.helperProportions.width
                            }).left - n.margins.left)
                    }
                    !n.snapElements[u].snapping && (m || g || y || v || b) && n.options.snap.snap && n.options.snap.snap.call(n.element, t, e.extend(n._uiHash(), {snapItem: n.snapElements[u].item})), n.snapElements[u].snapping = m || g || y || v || b
                } else n.snapElements[u].snapping && n.options.snap.release && n.options.snap.release.call(n.element, t, e.extend(n._uiHash(), {snapItem: n.snapElements[u].item})), n.snapElements[u].snapping = !1
            }
        }
    }), e.ui.plugin.add("draggable", "stack", {
        start: function () {
            var t = e(this).data("draggable").options, i = e.makeArray(e(t.stack)).sort(function (t, i) {
                return (parseInt(e(t).css("zIndex"), 10) || 0) - (parseInt(e(i).css("zIndex"), 10) || 0)
            });
            if (i.length) {
                var n = parseInt(i[0].style.zIndex) || 0;
                e(i).each(function (e) {
                    this.style.zIndex = n + e
                }), this[0].style.zIndex = n + i.length
            }
        }
    }), e.ui.plugin.add("draggable", "zIndex", {
        start: function (t, i) {
            var n = e(i.helper), s = e(this).data("draggable").options;
            n.css("zIndex") && (s._zIndex = n.css("zIndex")), n.css("zIndex", s.zIndex)
        }, stop: function (t, i) {
            var n = e(this).data("draggable").options;
            n._zIndex && e(i.helper).css("zIndex", n._zIndex)
        }
    })
}(jQuery), function (e) {
    e.widget("ui.droppable", {
        version: "1.9.2",
        widgetEventPrefix: "drop",
        options: {
            accept: "*",
            activeClass: !1,
            addClasses: !0,
            greedy: !1,
            hoverClass: !1,
            scope: "default",
            tolerance: "intersect"
        },
        _create: function () {
            var t = this.options, i = t.accept;
            this.isover = 0, this.isout = 1, this.accept = e.isFunction(i) ? i : function (e) {
                return e.is(i)
            }, this.proportions = {
                width: this.element[0].offsetWidth,
                height: this.element[0].offsetHeight
            }, e.ui.ddmanager.droppables[t.scope] = e.ui.ddmanager.droppables[t.scope] || [], e.ui.ddmanager.droppables[t.scope].push(this), t.addClasses && this.element.addClass("ui-droppable")
        },
        _destroy: function () {
            for (var t = e.ui.ddmanager.droppables[this.options.scope], i = 0; i < t.length; i++)t[i] == this && t.splice(i, 1);
            this.element.removeClass("ui-droppable ui-droppable-disabled")
        },
        _setOption: function (t, i) {
            "accept" == t && (this.accept = e.isFunction(i) ? i : function (e) {
                return e.is(i)
            }), e.Widget.prototype._setOption.apply(this, arguments)
        },
        _activate: function (t) {
            var i = e.ui.ddmanager.current;
            this.options.activeClass && this.element.addClass(this.options.activeClass), i && this._trigger("activate", t, this.ui(i))
        },
        _deactivate: function (t) {
            var i = e.ui.ddmanager.current;
            this.options.activeClass && this.element.removeClass(this.options.activeClass), i && this._trigger("deactivate", t, this.ui(i))
        },
        _over: function (t) {
            var i = e.ui.ddmanager.current;
            i && (i.currentItem || i.element)[0] != this.element[0] && this.accept.call(this.element[0], i.currentItem || i.element) && (this.options.hoverClass && this.element.addClass(this.options.hoverClass), this._trigger("over", t, this.ui(i)))
        },
        _out: function (t) {
            var i = e.ui.ddmanager.current;
            i && (i.currentItem || i.element)[0] != this.element[0] && this.accept.call(this.element[0], i.currentItem || i.element) && (this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("out", t, this.ui(i)))
        },
        _drop: function (t, i) {
            var n = i || e.ui.ddmanager.current;
            if (!n || (n.currentItem || n.element)[0] == this.element[0])return !1;
            var s = !1;
            return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function () {
                var t = e.data(this, "droppable");
                return t.options.greedy && !t.options.disabled && t.options.scope == n.options.scope && t.accept.call(t.element[0], n.currentItem || n.element) && e.ui.intersect(n, e.extend(t, {offset: t.element.offset()}), t.options.tolerance) ? (s = !0, !1) : void 0
            }), s ? !1 : this.accept.call(this.element[0], n.currentItem || n.element) ? (this.options.activeClass && this.element.removeClass(this.options.activeClass), this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("drop", t, this.ui(n)), this.element) : !1
        },
        ui: function (e) {
            return {
                draggable: e.currentItem || e.element,
                helper: e.helper,
                position: e.position,
                offset: e.positionAbs
            }
        }
    }), e.ui.intersect = function (t, i, n) {
        if (!i.offset)return !1;
        var s = (t.positionAbs || t.position.absolute).left, r = s + t.helperProportions.width, a = (t.positionAbs || t.position.absolute).top, o = a + t.helperProportions.height, l = i.offset.left, h = l + i.proportions.width, u = i.offset.top, c = u + i.proportions.height;
        switch (n) {
            case"fit":
                return s >= l && h >= r && a >= u && c >= o;
            case"intersect":
                return l < s + t.helperProportions.width / 2 && r - t.helperProportions.width / 2 < h && u < a + t.helperProportions.height / 2 && o - t.helperProportions.height / 2 < c;
            case"pointer":
                var p = (t.positionAbs || t.position.absolute).left + (t.clickOffset || t.offset.click).left, d = (t.positionAbs || t.position.absolute).top + (t.clickOffset || t.offset.click).top, f = e.ui.isOver(d, p, u, l, i.proportions.height, i.proportions.width);
                return f;
            case"touch":
                return (a >= u && c >= a || o >= u && c >= o || u > a && o > c) && (s >= l && h >= s || r >= l && h >= r || l > s && r > h);
            default:
                return !1
        }
    }, e.ui.ddmanager = {
        current: null, droppables: {"default": []}, prepareOffsets: function (t, i) {
            var n = e.ui.ddmanager.droppables[t.options.scope] || [], s = i ? i.type : null, r = (t.currentItem || t.element).find(":data(droppable)").andSelf();
            e:for (var a = 0; a < n.length; a++)if (!(n[a].options.disabled || t && !n[a].accept.call(n[a].element[0], t.currentItem || t.element))) {
                for (var o = 0; o < r.length; o++)if (r[o] == n[a].element[0]) {
                    n[a].proportions.height = 0;
                    continue e
                }
                n[a].visible = "none" != n[a].element.css("display"), n[a].visible && ("mousedown" == s && n[a]._activate.call(n[a], i), n[a].offset = n[a].element.offset(), n[a].proportions = {
                    width: n[a].element[0].offsetWidth,
                    height: n[a].element[0].offsetHeight
                })
            }
        }, drop: function (t, i) {
            var n = !1;
            return e.each(e.ui.ddmanager.droppables[t.options.scope] || [], function () {
                this.options && (!this.options.disabled && this.visible && e.ui.intersect(t, this, this.options.tolerance) && (n = this._drop.call(this, i) || n), !this.options.disabled && this.visible && this.accept.call(this.element[0], t.currentItem || t.element) && (this.isout = 1, this.isover = 0, this._deactivate.call(this, i)))
            }), n
        }, dragStart: function (t, i) {
            t.element.parentsUntil("body").bind("scroll.droppable", function () {
                t.options.refreshPositions || e.ui.ddmanager.prepareOffsets(t, i)
            })
        }, drag: function (t, i) {
            t.options.refreshPositions && e.ui.ddmanager.prepareOffsets(t, i), e.each(e.ui.ddmanager.droppables[t.options.scope] || [], function () {
                if (!this.options.disabled && !this.greedyChild && this.visible) {
                    var n = e.ui.intersect(t, this, this.options.tolerance), s = n || 1 != this.isover ? n && 0 == this.isover ? "isover" : null : "isout";
                    if (s) {
                        var r;
                        if (this.options.greedy) {
                            var a = this.options.scope, o = this.element.parents(":data(droppable)").filter(function () {
                                return e.data(this, "droppable").options.scope === a
                            });
                            o.length && (r = e.data(o[0], "droppable"), r.greedyChild = "isover" == s ? 1 : 0)
                        }
                        r && "isover" == s && (r.isover = 0, r.isout = 1, r._out.call(r, i)), this[s] = 1, this["isout" == s ? "isover" : "isout"] = 0, this["isover" == s ? "_over" : "_out"].call(this, i), r && "isout" == s && (r.isout = 0, r.isover = 1, r._over.call(r, i))
                    }
                }
            })
        }, dragStop: function (t, i) {
            t.element.parentsUntil("body").unbind("scroll.droppable"), t.options.refreshPositions || e.ui.ddmanager.prepareOffsets(t, i)
        }
    }
}(jQuery), function (e) {
    e.widget("ui.resizable", e.ui.mouse, {
        version: "1.9.2",
        widgetEventPrefix: "resize",
        options: {
            alsoResize: !1,
            animate: !1,
            animateDuration: "slow",
            animateEasing: "swing",
            aspectRatio: !1,
            autoHide: !1,
            containment: !1,
            ghost: !1,
            grid: !1,
            handles: "e,s,se",
            helper: !1,
            maxHeight: null,
            maxWidth: null,
            minHeight: 10,
            minWidth: 10,
            zIndex: 1e3
        },
        _create: function () {
            var t = this, i = this.options;
            if (this.element.addClass("ui-resizable"), e.extend(this, {
                    _aspectRatio: !!i.aspectRatio,
                    aspectRatio: i.aspectRatio,
                    originalElement: this.element,
                    _proportionallyResizeElements: [],
                    _helper: i.helper || i.ghost || i.animate ? i.helper || "ui-resizable-helper" : null
                }), this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i) && (this.element.wrap(e('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({
                    position: this.element.css("position"),
                    width: this.element.outerWidth(),
                    height: this.element.outerHeight(),
                    top: this.element.css("top"),
                    left: this.element.css("left")
                })), this.element = this.element.parent().data("resizable", this.element.data("resizable")), this.elementIsWrapper = !0, this.element.css({
                    marginLeft: this.originalElement.css("marginLeft"),
                    marginTop: this.originalElement.css("marginTop"),
                    marginRight: this.originalElement.css("marginRight"),
                    marginBottom: this.originalElement.css("marginBottom")
                }), this.originalElement.css({
                    marginLeft: 0,
                    marginTop: 0,
                    marginRight: 0,
                    marginBottom: 0
                }), this.originalResizeStyle = this.originalElement.css("resize"), this.originalElement.css("resize", "none"), this._proportionallyResizeElements.push(this.originalElement.css({
                    position: "static",
                    zoom: 1,
                    display: "block"
                })), this.originalElement.css({margin: this.originalElement.css("margin")}), this._proportionallyResize()), this.handles = i.handles || (e(".ui-resizable-handle", this.element).length ? {
                        n: ".ui-resizable-n",
                        e: ".ui-resizable-e",
                        s: ".ui-resizable-s",
                        w: ".ui-resizable-w",
                        se: ".ui-resizable-se",
                        sw: ".ui-resizable-sw",
                        ne: ".ui-resizable-ne",
                        nw: ".ui-resizable-nw"
                    } : "e,s,se"), this.handles.constructor == String) {
                "all" == this.handles && (this.handles = "n,e,s,w,se,sw,ne,nw");
                var n = this.handles.split(",");
                this.handles = {};
                for (var s = 0; s < n.length; s++) {
                    var r = e.trim(n[s]), a = "ui-resizable-" + r, o = e('<div class="ui-resizable-handle ' + a + '"></div>');
                    o.css({zIndex: i.zIndex}), "se" == r && o.addClass("ui-icon ui-icon-gripsmall-diagonal-se"), this.handles[r] = ".ui-resizable-" + r, this.element.append(o)
                }
            }
            this._renderAxis = function (t) {
                t = t || this.element;
                for (var i in this.handles) {
                    if (this.handles[i].constructor == String && (this.handles[i] = e(this.handles[i], this.element).show()), this.elementIsWrapper && this.originalElement[0].nodeName.match(/textarea|input|select|button/i)) {
                        var n = e(this.handles[i], this.element), s = 0;
                        s = /sw|ne|nw|se|n|s/.test(i) ? n.outerHeight() : n.outerWidth();
                        var r = ["padding", /ne|nw|n/.test(i) ? "Top" : /se|sw|s/.test(i) ? "Bottom" : /^e$/.test(i) ? "Right" : "Left"].join("");
                        t.css(r, s), this._proportionallyResize()
                    }
                    e(this.handles[i]).length
                }
            }, this._renderAxis(this.element), this._handles = e(".ui-resizable-handle", this.element).disableSelection(), this._handles.mouseover(function () {
                if (!t.resizing) {
                    if (this.className)var e = this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);
                    t.axis = e && e[1] ? e[1] : "se"
                }
            }), i.autoHide && (this._handles.hide(), e(this.element).addClass("ui-resizable-autohide").mouseenter(function () {
                i.disabled || (e(this).removeClass("ui-resizable-autohide"), t._handles.show())
            }).mouseleave(function () {
                i.disabled || t.resizing || (e(this).addClass("ui-resizable-autohide"), t._handles.hide())
            })), this._mouseInit()
        },
        _destroy: function () {
            this._mouseDestroy();
            var t = function (t) {
                e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()
            };
            if (this.elementIsWrapper) {
                t(this.element);
                var i = this.element;
                this.originalElement.css({
                    position: i.css("position"),
                    width: i.outerWidth(),
                    height: i.outerHeight(),
                    top: i.css("top"),
                    left: i.css("left")
                }).insertAfter(i), i.remove()
            }
            return this.originalElement.css("resize", this.originalResizeStyle), t(this.originalElement), this
        },
        _mouseCapture: function (t) {
            var i = !1;
            for (var n in this.handles)e(this.handles[n])[0] == t.target && (i = !0);
            return !this.options.disabled && i
        },
        _mouseStart: function (i) {
            var n = this.options, s = this.element.position(), r = this.element;
            this.resizing = !0, this.documentScroll = {
                top: e(document).scrollTop(),
                left: e(document).scrollLeft()
            }, (r.is(".ui-draggable") || /absolute/.test(r.css("position"))) && r.css({
                position: "absolute",
                top: s.top,
                left: s.left
            }), this._renderProxy();
            var a = t(this.helper.css("left")), o = t(this.helper.css("top"));
            n.containment && (a += e(n.containment).scrollLeft() || 0, o += e(n.containment).scrollTop() || 0), this.offset = this.helper.offset(), this.position = {
                left: a,
                top: o
            }, this.size = this._helper ? {width: r.outerWidth(), height: r.outerHeight()} : {
                width: r.width(),
                height: r.height()
            }, this.originalSize = this._helper ? {width: r.outerWidth(), height: r.outerHeight()} : {
                width: r.width(),
                height: r.height()
            }, this.originalPosition = {left: a, top: o}, this.sizeDiff = {
                width: r.outerWidth() - r.width(),
                height: r.outerHeight() - r.height()
            }, this.originalMousePosition = {
                left: i.pageX,
                top: i.pageY
            }, this.aspectRatio = "number" == typeof n.aspectRatio ? n.aspectRatio : this.originalSize.width / this.originalSize.height || 1;
            var l = e(".ui-resizable-" + this.axis).css("cursor");
            return e("body").css("cursor", "auto" == l ? this.axis + "-resize" : l), r.addClass("ui-resizable-resizing"), this._propagate("start", i), !0
        },
        _mouseDrag: function (e) {
            var t = this.helper, i = (this.options, this.originalMousePosition), n = this.axis, s = e.pageX - i.left || 0, r = e.pageY - i.top || 0, a = this._change[n];
            if (!a)return !1;
            var o = a.apply(this, [e, s, r]);
            return this._updateVirtualBoundaries(e.shiftKey), (this._aspectRatio || e.shiftKey) && (o = this._updateRatio(o, e)), o = this._respectSize(o, e), this._propagate("resize", e), t.css({
                top: this.position.top + "px",
                left: this.position.left + "px",
                width: this.size.width + "px",
                height: this.size.height + "px"
            }), !this._helper && this._proportionallyResizeElements.length && this._proportionallyResize(), this._updateCache(o), this._trigger("resize", e, this.ui()), !1
        },
        _mouseStop: function (t) {
            this.resizing = !1;
            var i = this.options, n = this;
            if (this._helper) {
                var s = this._proportionallyResizeElements, r = s.length && /textarea/i.test(s[0].nodeName), a = r && e.ui.hasScroll(s[0], "left") ? 0 : n.sizeDiff.height, o = r ? 0 : n.sizeDiff.width, l = {
                    width: n.helper.width() - o,
                    height: n.helper.height() - a
                }, h = parseInt(n.element.css("left"), 10) + (n.position.left - n.originalPosition.left) || null, u = parseInt(n.element.css("top"), 10) + (n.position.top - n.originalPosition.top) || null;
                i.animate || this.element.css(e.extend(l, {
                    top: u,
                    left: h
                })), n.helper.height(n.size.height), n.helper.width(n.size.width), this._helper && !i.animate && this._proportionallyResize()
            }
            return e("body").css("cursor", "auto"), this.element.removeClass("ui-resizable-resizing"), this._propagate("stop", t), this._helper && this.helper.remove(), !1
        },
        _updateVirtualBoundaries: function (e) {
            var t, n, s, r, a, o = this.options;
            a = {
                minWidth: i(o.minWidth) ? o.minWidth : 0,
                maxWidth: i(o.maxWidth) ? o.maxWidth : 1 / 0,
                minHeight: i(o.minHeight) ? o.minHeight : 0,
                maxHeight: i(o.maxHeight) ? o.maxHeight : 1 / 0
            }, (this._aspectRatio || e) && (t = a.minHeight * this.aspectRatio, s = a.minWidth / this.aspectRatio, n = a.maxHeight * this.aspectRatio, r = a.maxWidth / this.aspectRatio, t > a.minWidth && (a.minWidth = t), s > a.minHeight && (a.minHeight = s), n < a.maxWidth && (a.maxWidth = n), r < a.maxHeight && (a.maxHeight = r)), this._vBoundaries = a
        },
        _updateCache: function (e) {
            this.options, this.offset = this.helper.offset(), i(e.left) && (this.position.left = e.left), i(e.top) && (this.position.top = e.top), i(e.height) && (this.size.height = e.height), i(e.width) && (this.size.width = e.width)
        },
        _updateRatio: function (e) {
            var t = (this.options, this.position), n = this.size, s = this.axis;
            return i(e.height) ? e.width = e.height * this.aspectRatio : i(e.width) && (e.height = e.width / this.aspectRatio), "sw" == s && (e.left = t.left + (n.width - e.width), e.top = null), "nw" == s && (e.top = t.top + (n.height - e.height), e.left = t.left + (n.width - e.width)), e
        },
        _respectSize: function (e, t) {
            var n = (this.helper, this._vBoundaries), s = (this._aspectRatio || t.shiftKey, this.axis), r = i(e.width) && n.maxWidth && n.maxWidth < e.width, a = i(e.height) && n.maxHeight && n.maxHeight < e.height, o = i(e.width) && n.minWidth && n.minWidth > e.width, l = i(e.height) && n.minHeight && n.minHeight > e.height;
            o && (e.width = n.minWidth), l && (e.height = n.minHeight), r && (e.width = n.maxWidth), a && (e.height = n.maxHeight);
            var h = this.originalPosition.left + this.originalSize.width, u = this.position.top + this.size.height, c = /sw|nw|w/.test(s), p = /nw|ne|n/.test(s);
            o && c && (e.left = h - n.minWidth), r && c && (e.left = h - n.maxWidth), l && p && (e.top = u - n.minHeight), a && p && (e.top = u - n.maxHeight);
            var d = !e.width && !e.height;
            return d && !e.left && e.top ? e.top = null : d && !e.top && e.left && (e.left = null), e
        },
        _proportionallyResize: function () {
            if (this.options, this._proportionallyResizeElements.length)for (var t = this.helper || this.element, i = 0; i < this._proportionallyResizeElements.length; i++) {
                var n = this._proportionallyResizeElements[i];
                if (!this.borderDif) {
                    var s = [n.css("borderTopWidth"), n.css("borderRightWidth"), n.css("borderBottomWidth"), n.css("borderLeftWidth")], r = [n.css("paddingTop"), n.css("paddingRight"), n.css("paddingBottom"), n.css("paddingLeft")];
                    this.borderDif = e.map(s, function (e, t) {
                        var i = parseInt(e, 10) || 0, n = parseInt(r[t], 10) || 0;
                        return i + n
                    })
                }
                n.css({
                    height: t.height() - this.borderDif[0] - this.borderDif[2] || 0,
                    width: t.width() - this.borderDif[1] - this.borderDif[3] || 0
                })
            }
        },
        _renderProxy: function () {
            var t = this.element, i = this.options;
            if (this.elementOffset = t.offset(), this._helper) {
                this.helper = this.helper || e('<div style="overflow:hidden;"></div>');
                var n = e.ui.ie6 ? 1 : 0, s = e.ui.ie6 ? 2 : -1;
                this.helper.addClass(this._helper).css({
                    width: this.element.outerWidth() + s,
                    height: this.element.outerHeight() + s,
                    position: "absolute",
                    left: this.elementOffset.left - n + "px",
                    top: this.elementOffset.top - n + "px",
                    zIndex: ++i.zIndex
                }), this.helper.appendTo("body").disableSelection()
            } else this.helper = this.element
        },
        _change: {
            e: function (e, t) {
                return {width: this.originalSize.width + t}
            }, w: function (e, t) {
                var i = (this.options, this.originalSize), n = this.originalPosition;
                return {left: n.left + t, width: i.width - t}
            }, n: function (e, t, i) {
                var n = (this.options, this.originalSize), s = this.originalPosition;
                return {top: s.top + i, height: n.height - i}
            }, s: function (e, t, i) {
                return {height: this.originalSize.height + i}
            }, se: function (t, i, n) {
                return e.extend(this._change.s.apply(this, arguments), this._change.e.apply(this, [t, i, n]))
            }, sw: function (t, i, n) {
                return e.extend(this._change.s.apply(this, arguments), this._change.w.apply(this, [t, i, n]))
            }, ne: function (t, i, n) {
                return e.extend(this._change.n.apply(this, arguments), this._change.e.apply(this, [t, i, n]))
            }, nw: function (t, i, n) {
                return e.extend(this._change.n.apply(this, arguments), this._change.w.apply(this, [t, i, n]))
            }
        },
        _propagate: function (t, i) {
            e.ui.plugin.call(this, t, [i, this.ui()]), "resize" != t && this._trigger(t, i, this.ui())
        },
        plugins: {},
        ui: function () {
            return {
                originalElement: this.originalElement,
                element: this.element,
                helper: this.helper,
                position: this.position,
                size: this.size,
                originalSize: this.originalSize,
                originalPosition: this.originalPosition
            }
        }
    }), e.ui.plugin.add("resizable", "alsoResize", {
        start: function () {
            var t = e(this).data("resizable"), i = t.options, n = function (t) {
                e(t).each(function () {
                    var t = e(this);
                    t.data("resizable-alsoresize", {
                        width: parseInt(t.width(), 10),
                        height: parseInt(t.height(), 10),
                        left: parseInt(t.css("left"), 10),
                        top: parseInt(t.css("top"), 10)
                    })
                })
            };
            "object" != typeof i.alsoResize || i.alsoResize.parentNode ? n(i.alsoResize) : i.alsoResize.length ? (i.alsoResize = i.alsoResize[0], n(i.alsoResize)) : e.each(i.alsoResize, function (e) {
                n(e)
            })
        }, resize: function (t, i) {
            var n = e(this).data("resizable"), s = n.options, r = n.originalSize, a = n.originalPosition, o = {
                height: n.size.height - r.height || 0,
                width: n.size.width - r.width || 0,
                top: n.position.top - a.top || 0,
                left: n.position.left - a.left || 0
            }, l = function (t, n) {
                e(t).each(function () {
                    var t = e(this), s = e(this).data("resizable-alsoresize"), r = {}, a = n && n.length ? n : t.parents(i.originalElement[0]).length ? ["width", "height"] : ["width", "height", "top", "left"];
                    e.each(a, function (e, t) {
                        var i = (s[t] || 0) + (o[t] || 0);
                        i && i >= 0 && (r[t] = i || null)
                    }), t.css(r)
                })
            };
            "object" != typeof s.alsoResize || s.alsoResize.nodeType ? l(s.alsoResize) : e.each(s.alsoResize, function (e, t) {
                l(e, t)
            })
        }, stop: function () {
            e(this).removeData("resizable-alsoresize")
        }
    }), e.ui.plugin.add("resizable", "animate", {
        stop: function (t) {
            var i = e(this).data("resizable"), n = i.options, s = i._proportionallyResizeElements, r = s.length && /textarea/i.test(s[0].nodeName), a = r && e.ui.hasScroll(s[0], "left") ? 0 : i.sizeDiff.height, o = r ? 0 : i.sizeDiff.width, l = {
                width: i.size.width - o,
                height: i.size.height - a
            }, h = parseInt(i.element.css("left"), 10) + (i.position.left - i.originalPosition.left) || null, u = parseInt(i.element.css("top"), 10) + (i.position.top - i.originalPosition.top) || null;
            i.element.animate(e.extend(l, u && h ? {top: u, left: h} : {}), {
                duration: n.animateDuration,
                easing: n.animateEasing,
                step: function () {
                    var n = {
                        width: parseInt(i.element.css("width"), 10),
                        height: parseInt(i.element.css("height"), 10),
                        top: parseInt(i.element.css("top"), 10),
                        left: parseInt(i.element.css("left"), 10)
                    };
                    s && s.length && e(s[0]).css({
                        width: n.width,
                        height: n.height
                    }), i._updateCache(n), i._propagate("resize", t)
                }
            })
        }
    }), e.ui.plugin.add("resizable", "containment", {
        start: function () {
            var i = e(this).data("resizable"), n = i.options, s = i.element, r = n.containment, a = r instanceof e ? r.get(0) : /parent/.test(r) ? s.parent().get(0) : r;
            if (a)if (i.containerElement = e(a), /document/.test(r) || r == document) i.containerOffset = {
                left: 0,
                top: 0
            }, i.containerPosition = {left: 0, top: 0}, i.parentData = {
                element: e(document),
                left: 0,
                top: 0,
                width: e(document).width(),
                height: e(document).height() || document.body.parentNode.scrollHeight
            }; else {
                var o = e(a), l = [];
                e(["Top", "Right", "Left", "Bottom"]).each(function (e, i) {
                    l[e] = t(o.css("padding" + i))
                }), i.containerOffset = o.offset(), i.containerPosition = o.position(), i.containerSize = {
                    height: o.innerHeight() - l[3],
                    width: o.innerWidth() - l[1]
                };
                var h = i.containerOffset, u = i.containerSize.height, c = i.containerSize.width, p = e.ui.hasScroll(a, "left") ? a.scrollWidth : c, d = e.ui.hasScroll(a) ? a.scrollHeight : u;
                i.parentData = {element: a, left: h.left, top: h.top, width: p, height: d}
            }
        }, resize: function (t) {
            var i = e(this).data("resizable"), n = i.options, s = (i.containerSize, i.containerOffset), r = (i.size, i.position), a = i._aspectRatio || t.shiftKey, o = {
                top: 0,
                left: 0
            }, l = i.containerElement;
            l[0] != document && /static/.test(l.css("position")) && (o = s), r.left < (i._helper ? s.left : 0) && (i.size.width = i.size.width + (i._helper ? i.position.left - s.left : i.position.left - o.left), a && (i.size.height = i.size.width / i.aspectRatio), i.position.left = n.helper ? s.left : 0), r.top < (i._helper ? s.top : 0) && (i.size.height = i.size.height + (i._helper ? i.position.top - s.top : i.position.top), a && (i.size.width = i.size.height * i.aspectRatio), i.position.top = i._helper ? s.top : 0), i.offset.left = i.parentData.left + i.position.left, i.offset.top = i.parentData.top + i.position.top;
            var h = Math.abs((i._helper ? i.offset.left - o.left : i.offset.left - o.left) + i.sizeDiff.width), u = Math.abs((i._helper ? i.offset.top - o.top : i.offset.top - s.top) + i.sizeDiff.height), c = i.containerElement.get(0) == i.element.parent().get(0), p = /relative|absolute/.test(i.containerElement.css("position"));
            c && p && (h -= i.parentData.left), h + i.size.width >= i.parentData.width && (i.size.width = i.parentData.width - h, a && (i.size.height = i.size.width / i.aspectRatio)), u + i.size.height >= i.parentData.height && (i.size.height = i.parentData.height - u, a && (i.size.width = i.size.height * i.aspectRatio))
        }, stop: function () {
            var t = e(this).data("resizable"), i = t.options, n = (t.position, t.containerOffset), s = t.containerPosition, r = t.containerElement, a = e(t.helper), o = a.offset(), l = a.outerWidth() - t.sizeDiff.width, h = a.outerHeight() - t.sizeDiff.height;
            t._helper && !i.animate && /relative/.test(r.css("position")) && e(this).css({
                left: o.left - s.left - n.left,
                width: l,
                height: h
            }), t._helper && !i.animate && /static/.test(r.css("position")) && e(this).css({
                left: o.left - s.left - n.left,
                width: l,
                height: h
            })
        }
    }), e.ui.plugin.add("resizable", "ghost", {
        start: function () {
            var t = e(this).data("resizable"), i = t.options, n = t.size;
            t.ghost = t.originalElement.clone(), t.ghost.css({
                opacity: .25,
                display: "block",
                position: "relative",
                height: n.height,
                width: n.width,
                margin: 0,
                left: 0,
                top: 0
            }).addClass("ui-resizable-ghost").addClass("string" == typeof i.ghost ? i.ghost : ""), t.ghost.appendTo(t.helper)
        }, resize: function () {
            var t = e(this).data("resizable");
            t.options, t.ghost && t.ghost.css({position: "relative", height: t.size.height, width: t.size.width})
        }, stop: function () {
            var t = e(this).data("resizable");
            t.options, t.ghost && t.helper && t.helper.get(0).removeChild(t.ghost.get(0))
        }
    }), e.ui.plugin.add("resizable", "grid", {
        resize: function (t) {
            var i = e(this).data("resizable"), n = i.options, s = i.size, r = i.originalSize, a = i.originalPosition, o = i.axis;
            n._aspectRatio || t.shiftKey, n.grid = "number" == typeof n.grid ? [n.grid, n.grid] : n.grid;
            var l = Math.round((s.width - r.width) / (n.grid[0] || 1)) * (n.grid[0] || 1), h = Math.round((s.height - r.height) / (n.grid[1] || 1)) * (n.grid[1] || 1);
            /^(se|s|e)$/.test(o) ? (i.size.width = r.width + l, i.size.height = r.height + h) : /^(ne)$/.test(o) ? (i.size.width = r.width + l, i.size.height = r.height + h, i.position.top = a.top - h) : /^(sw)$/.test(o) ? (i.size.width = r.width + l, i.size.height = r.height + h, i.position.left = a.left - l) : (i.size.width = r.width + l, i.size.height = r.height + h, i.position.top = a.top - h, i.position.left = a.left - l)
        }
    });
    var t = function (e) {
        return parseInt(e, 10) || 0
    }, i = function (e) {
        return !isNaN(parseInt(e, 10))
    }
}(jQuery), function (e) {
    e.widget("ui.selectable", e.ui.mouse, {
        version: "1.9.2",
        options: {appendTo: "body", autoRefresh: !0, distance: 0, filter: "*", tolerance: "touch"},
        _create: function () {
            var t = this;
            this.element.addClass("ui-selectable"), this.dragged = !1;
            var i;
            this.refresh = function () {
                i = e(t.options.filter, t.element[0]), i.addClass("ui-selectee"), i.each(function () {
                    var t = e(this), i = t.offset();
                    e.data(this, "selectable-item", {
                        element: this,
                        $element: t,
                        left: i.left,
                        top: i.top,
                        right: i.left + t.outerWidth(),
                        bottom: i.top + t.outerHeight(),
                        startselected: !1,
                        selected: t.hasClass("ui-selected"),
                        selecting: t.hasClass("ui-selecting"),
                        unselecting: t.hasClass("ui-unselecting")
                    })
                })
            }, this.refresh(), this.selectees = i.addClass("ui-selectee"), this._mouseInit(), this.helper = e("<div class='ui-selectable-helper'></div>")
        },
        _destroy: function () {
            this.selectees.removeClass("ui-selectee").removeData("selectable-item"), this.element.removeClass("ui-selectable ui-selectable-disabled"), this._mouseDestroy()
        },
        _mouseStart: function (t) {
            var i = this;
            if (this.opos = [t.pageX, t.pageY], !this.options.disabled) {
                var n = this.options;
                this.selectees = e(n.filter, this.element[0]), this._trigger("start", t), e(n.appendTo).append(this.helper), this.helper.css({
                    left: t.clientX,
                    top: t.clientY,
                    width: 0,
                    height: 0
                }), n.autoRefresh && this.refresh(), this.selectees.filter(".ui-selected").each(function () {
                    var n = e.data(this, "selectable-item");
                    n.startselected = !0, !t.metaKey && !t.ctrlKey && (n.$element.removeClass("ui-selected"), n.selected = !1, n.$element.addClass("ui-unselecting"), n.unselecting = !0, i._trigger("unselecting", t, {unselecting: n.element}))
                }), e(t.target).parents().andSelf().each(function () {
                    var n = e.data(this, "selectable-item");
                    if (n) {
                        var s = !t.metaKey && !t.ctrlKey || !n.$element.hasClass("ui-selected");
                        return n.$element.removeClass(s ? "ui-unselecting" : "ui-selected").addClass(s ? "ui-selecting" : "ui-unselecting"), n.unselecting = !s, n.selecting = s, n.selected = s, s ? i._trigger("selecting", t, {selecting: n.element}) : i._trigger("unselecting", t, {unselecting: n.element}), !1
                    }
                })
            }
        },
        _mouseDrag: function (t) {
            var i = this;
            if (this.dragged = !0, !this.options.disabled) {
                var n = this.options, s = this.opos[0], r = this.opos[1], a = t.pageX, o = t.pageY;
                if (s > a) {
                    var l = a;
                    a = s, s = l
                }
                if (r > o) {
                    var l = o;
                    o = r, r = l
                }
                return this.helper.css({
                    left: s,
                    top: r,
                    width: a - s,
                    height: o - r
                }), this.selectees.each(function () {
                    var l = e.data(this, "selectable-item");
                    if (l && l.element != i.element[0]) {
                        var h = !1;
                        "touch" == n.tolerance ? h = !(l.left > a || l.right < s || l.top > o || l.bottom < r) : "fit" == n.tolerance && (h = l.left > s && l.right < a && l.top > r && l.bottom < o), h ? (l.selected && (l.$element.removeClass("ui-selected"), l.selected = !1), l.unselecting && (l.$element.removeClass("ui-unselecting"), l.unselecting = !1), l.selecting || (l.$element.addClass("ui-selecting"), l.selecting = !0, i._trigger("selecting", t, {selecting: l.element}))) : (l.selecting && ((t.metaKey || t.ctrlKey) && l.startselected ? (l.$element.removeClass("ui-selecting"), l.selecting = !1, l.$element.addClass("ui-selected"), l.selected = !0) : (l.$element.removeClass("ui-selecting"), l.selecting = !1, l.startselected && (l.$element.addClass("ui-unselecting"), l.unselecting = !0), i._trigger("unselecting", t, {unselecting: l.element}))), l.selected && !t.metaKey && !t.ctrlKey && !l.startselected && (l.$element.removeClass("ui-selected"), l.selected = !1, l.$element.addClass("ui-unselecting"), l.unselecting = !0, i._trigger("unselecting", t, {unselecting: l.element})))
                    }
                }), !1
            }
        },
        _mouseStop: function (t) {
            var i = this;
            return this.dragged = !1, this.options, e(".ui-unselecting", this.element[0]).each(function () {
                var n = e.data(this, "selectable-item");
                n.$element.removeClass("ui-unselecting"), n.unselecting = !1, n.startselected = !1, i._trigger("unselected", t, {unselected: n.element})
            }), e(".ui-selecting", this.element[0]).each(function () {
                var n = e.data(this, "selectable-item");
                n.$element.removeClass("ui-selecting").addClass("ui-selected"), n.selecting = !1, n.selected = !0, n.startselected = !0, i._trigger("selected", t, {selected: n.element})
            }), this._trigger("stop", t), this.helper.remove(), !1
        }
    })
}(jQuery), function (e) {
    e.widget("ui.sortable", e.ui.mouse, {
        version: "1.9.2",
        widgetEventPrefix: "sort",
        ready: !1,
        options: {
            appendTo: "parent",
            axis: !1,
            connectWith: !1,
            containment: !1,
            cursor: "auto",
            cursorAt: !1,
            dropOnEmpty: !0,
            forcePlaceholderSize: !1,
            forceHelperSize: !1,
            grid: !1,
            handle: !1,
            helper: "original",
            items: "> *",
            opacity: !1,
            placeholder: !1,
            revert: !1,
            scroll: !0,
            scrollSensitivity: 20,
            scrollSpeed: 20,
            scope: "default",
            tolerance: "intersect",
            zIndex: 1e3
        },
        _create: function () {
            var e = this.options;
            this.containerCache = {}, this.element.addClass("ui-sortable"), this.refresh(), this.floating = this.items.length ? "x" === e.axis || /left|right/.test(this.items[0].item.css("float")) || /inline|table-cell/.test(this.items[0].item.css("display")) : !1, this.offset = this.element.offset(), this._mouseInit(), this.ready = !0
        },
        _destroy: function () {
            this.element.removeClass("ui-sortable ui-sortable-disabled"), this._mouseDestroy();
            for (var e = this.items.length - 1; e >= 0; e--)this.items[e].item.removeData(this.widgetName + "-item");
            return this
        },
        _setOption: function (t, i) {
            "disabled" === t ? (this.options[t] = i, this.widget().toggleClass("ui-sortable-disabled", !!i)) : e.Widget.prototype._setOption.apply(this, arguments)
        },
        _mouseCapture: function (t, i) {
            var n = this;
            if (this.reverting)return !1;
            if (this.options.disabled || "static" == this.options.type)return !1;
            this._refreshItems(t);
            var s = null;
            if (e(t.target).parents().each(function () {
                    return e.data(this, n.widgetName + "-item") == n ? (s = e(this), !1) : void 0
                }), e.data(t.target, n.widgetName + "-item") == n && (s = e(t.target)), !s)return !1;
            if (this.options.handle && !i) {
                var r = !1;
                if (e(this.options.handle, s).find("*").andSelf().each(function () {
                        this == t.target && (r = !0)
                    }), !r)return !1
            }
            return this.currentItem = s, this._removeCurrentsFromItems(), !0
        },
        _mouseStart: function (t, i, n) {
            var s = this.options;
            if (this.currentContainer = this, this.refreshPositions(), this.helper = this._createHelper(t), this._cacheHelperProportions(), this._cacheMargins(), this.scrollParent = this.helper.scrollParent(), this.offset = this.currentItem.offset(), this.offset = {
                    top: this.offset.top - this.margins.top,
                    left: this.offset.left - this.margins.left
                }, e.extend(this.offset, {
                    click: {left: t.pageX - this.offset.left, top: t.pageY - this.offset.top},
                    parent: this._getParentOffset(),
                    relative: this._getRelativeOffset()
                }), this.helper.css("position", "absolute"), this.cssPosition = this.helper.css("position"), this.originalPosition = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, s.cursorAt && this._adjustOffsetFromHelper(s.cursorAt), this.domPosition = {
                    prev: this.currentItem.prev()[0],
                    parent: this.currentItem.parent()[0]
                }, this.helper[0] != this.currentItem[0] && this.currentItem.hide(), this._createPlaceholder(), s.containment && this._setContainment(), s.cursor && (e("body").css("cursor") && (this._storedCursor = e("body").css("cursor")), e("body").css("cursor", s.cursor)), s.opacity && (this.helper.css("opacity") && (this._storedOpacity = this.helper.css("opacity")), this.helper.css("opacity", s.opacity)), s.zIndex && (this.helper.css("zIndex") && (this._storedZIndex = this.helper.css("zIndex")), this.helper.css("zIndex", s.zIndex)), this.scrollParent[0] != document && "HTML" != this.scrollParent[0].tagName && (this.overflowOffset = this.scrollParent.offset()), this._trigger("start", t, this._uiHash()), this._preserveHelperProportions || this._cacheHelperProportions(), !n)for (var r = this.containers.length - 1; r >= 0; r--)this.containers[r]._trigger("activate", t, this._uiHash(this));
            return e.ui.ddmanager && (e.ui.ddmanager.current = this), e.ui.ddmanager && !s.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), this.dragging = !0, this.helper.addClass("ui-sortable-helper"), this._mouseDrag(t), !0
        },
        _mouseDrag: function (t) {
            if (this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute"), this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs), this.options.scroll) {
                var i = this.options, n = !1;
                this.scrollParent[0] != document && "HTML" != this.scrollParent[0].tagName ? (this.overflowOffset.top + this.scrollParent[0].offsetHeight - t.pageY < i.scrollSensitivity ? this.scrollParent[0].scrollTop = n = this.scrollParent[0].scrollTop + i.scrollSpeed : t.pageY - this.overflowOffset.top < i.scrollSensitivity && (this.scrollParent[0].scrollTop = n = this.scrollParent[0].scrollTop - i.scrollSpeed), this.overflowOffset.left + this.scrollParent[0].offsetWidth - t.pageX < i.scrollSensitivity ? this.scrollParent[0].scrollLeft = n = this.scrollParent[0].scrollLeft + i.scrollSpeed : t.pageX - this.overflowOffset.left < i.scrollSensitivity && (this.scrollParent[0].scrollLeft = n = this.scrollParent[0].scrollLeft - i.scrollSpeed)) : (t.pageY - e(document).scrollTop() < i.scrollSensitivity ? n = e(document).scrollTop(e(document).scrollTop() - i.scrollSpeed) : e(window).height() - (t.pageY - e(document).scrollTop()) < i.scrollSensitivity && (n = e(document).scrollTop(e(document).scrollTop() + i.scrollSpeed)), t.pageX - e(document).scrollLeft() < i.scrollSensitivity ? n = e(document).scrollLeft(e(document).scrollLeft() - i.scrollSpeed) : e(window).width() - (t.pageX - e(document).scrollLeft()) < i.scrollSensitivity && (n = e(document).scrollLeft(e(document).scrollLeft() + i.scrollSpeed))), n !== !1 && e.ui.ddmanager && !i.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t)
            }
            this.positionAbs = this._convertPositionTo("absolute"), this.options.axis && "y" == this.options.axis || (this.helper[0].style.left = this.position.left + "px"), this.options.axis && "x" == this.options.axis || (this.helper[0].style.top = this.position.top + "px");
            for (var s = this.items.length - 1; s >= 0; s--) {
                var r = this.items[s], a = r.item[0], o = this._intersectsWithPointer(r);
                if (o && r.instance === this.currentContainer && a != this.currentItem[0] && this.placeholder[1 == o ? "next" : "prev"]()[0] != a && !e.contains(this.placeholder[0], a) && ("semi-dynamic" == this.options.type ? !e.contains(this.element[0], a) : !0)) {
                    if (this.direction = 1 == o ? "down" : "up", "pointer" != this.options.tolerance && !this._intersectsWithSides(r))break;
                    this._rearrange(t, r), this._trigger("change", t, this._uiHash());
                    break
                }
            }
            return this._contactContainers(t), e.ui.ddmanager && e.ui.ddmanager.drag(this, t), this._trigger("sort", t, this._uiHash()), this.lastPositionAbs = this.positionAbs, !1
        },
        _mouseStop: function (t, i) {
            if (t) {
                if (e.ui.ddmanager && !this.options.dropBehaviour && e.ui.ddmanager.drop(this, t), this.options.revert) {
                    var n = this, s = this.placeholder.offset();
                    this.reverting = !0, e(this.helper).animate({
                        left: s.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] == document.body ? 0 : this.offsetParent[0].scrollLeft),
                        top: s.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] == document.body ? 0 : this.offsetParent[0].scrollTop)
                    }, parseInt(this.options.revert, 10) || 500, function () {
                        n._clear(t)
                    })
                } else this._clear(t, i);
                return !1
            }
        },
        cancel: function () {
            if (this.dragging) {
                this._mouseUp({target: null}), "original" == this.options.helper ? this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper") : this.currentItem.show();
                for (var t = this.containers.length - 1; t >= 0; t--)this.containers[t]._trigger("deactivate", null, this._uiHash(this)), this.containers[t].containerCache.over && (this.containers[t]._trigger("out", null, this._uiHash(this)), this.containers[t].containerCache.over = 0)
            }
            return this.placeholder && (this.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]), "original" != this.options.helper && this.helper && this.helper[0].parentNode && this.helper.remove(), e.extend(this, {
                helper: null,
                dragging: !1,
                reverting: !1,
                _noFinalSort: null
            }), this.domPosition.prev ? e(this.domPosition.prev).after(this.currentItem) : e(this.domPosition.parent).prepend(this.currentItem)), this
        },
        serialize: function (t) {
            var i = this._getItemsAsjQuery(t && t.connected), n = [];
            return t = t || {}, e(i).each(function () {
                var i = (e(t.item || this).attr(t.attribute || "id") || "").match(t.expression || /(.+)[-=_](.+)/);
                i && n.push((t.key || i[1] + "[]") + "=" + (t.key && t.expression ? i[1] : i[2]))
            }), !n.length && t.key && n.push(t.key + "="), n.join("&")
        },
        toArray: function (t) {
            var i = this._getItemsAsjQuery(t && t.connected), n = [];
            return t = t || {}, i.each(function () {
                n.push(e(t.item || this).attr(t.attribute || "id") || "")
            }), n
        },
        _intersectsWith: function (e) {
            var t = this.positionAbs.left, i = t + this.helperProportions.width, n = this.positionAbs.top, s = n + this.helperProportions.height, r = e.left, a = r + e.width, o = e.top, l = o + e.height, h = this.offset.click.top, u = this.offset.click.left, c = n + h > o && l > n + h && t + u > r && a > t + u;
            return "pointer" == this.options.tolerance || this.options.forcePointerForContainers || "pointer" != this.options.tolerance && this.helperProportions[this.floating ? "width" : "height"] > e[this.floating ? "width" : "height"] ? c : r < t + this.helperProportions.width / 2 && i - this.helperProportions.width / 2 < a && o < n + this.helperProportions.height / 2 && s - this.helperProportions.height / 2 < l
        },
        _intersectsWithPointer: function (t) {
            var i = "x" === this.options.axis || e.ui.isOverAxis(this.positionAbs.top + this.offset.click.top, t.top, t.height), n = "y" === this.options.axis || e.ui.isOverAxis(this.positionAbs.left + this.offset.click.left, t.left, t.width), s = i && n, r = this._getDragVerticalDirection(), a = this._getDragHorizontalDirection();
            return s ? this.floating ? a && "right" == a || "down" == r ? 2 : 1 : r && ("down" == r ? 2 : 1) : !1
        },
        _intersectsWithSides: function (t) {
            var i = e.ui.isOverAxis(this.positionAbs.top + this.offset.click.top, t.top + t.height / 2, t.height), n = e.ui.isOverAxis(this.positionAbs.left + this.offset.click.left, t.left + t.width / 2, t.width), s = this._getDragVerticalDirection(), r = this._getDragHorizontalDirection();
            return this.floating && r ? "right" == r && n || "left" == r && !n : s && ("down" == s && i || "up" == s && !i)
        },
        _getDragVerticalDirection: function () {
            var e = this.positionAbs.top - this.lastPositionAbs.top;
            return 0 != e && (e > 0 ? "down" : "up")
        },
        _getDragHorizontalDirection: function () {
            var e = this.positionAbs.left - this.lastPositionAbs.left;
            return 0 != e && (e > 0 ? "right" : "left")
        },
        refresh: function (e) {
            return this._refreshItems(e), this.refreshPositions(), this
        },
        _connectWith: function () {
            var e = this.options;
            return e.connectWith.constructor == String ? [e.connectWith] : e.connectWith
        },
        _getItemsAsjQuery: function (t) {
            var i = [], n = [], s = this._connectWith();
            if (s && t)for (var r = s.length - 1; r >= 0; r--)for (var a = e(s[r]), o = a.length - 1; o >= 0; o--) {
                var l = e.data(a[o], this.widgetName);
                l && l != this && !l.options.disabled && n.push([e.isFunction(l.options.items) ? l.options.items.call(l.element) : e(l.options.items, l.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), l])
            }
            n.push([e.isFunction(this.options.items) ? this.options.items.call(this.element, null, {
                options: this.options,
                item: this.currentItem
            }) : e(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]);
            for (var r = n.length - 1; r >= 0; r--)n[r][0].each(function () {
                i.push(this)
            });
            return e(i)
        },
        _removeCurrentsFromItems: function () {
            var t = this.currentItem.find(":data(" + this.widgetName + "-item)");
            this.items = e.grep(this.items, function (e) {
                for (var i = 0; i < t.length; i++)if (t[i] == e.item[0])return !1;
                return !0
            })
        },
        _refreshItems: function (t) {
            this.items = [], this.containers = [this];
            var i = this.items, n = [[e.isFunction(this.options.items) ? this.options.items.call(this.element[0], t, {item: this.currentItem}) : e(this.options.items, this.element), this]], s = this._connectWith();
            if (s && this.ready)for (var r = s.length - 1; r >= 0; r--)for (var a = e(s[r]), o = a.length - 1; o >= 0; o--) {
                var l = e.data(a[o], this.widgetName);
                l && l != this && !l.options.disabled && (n.push([e.isFunction(l.options.items) ? l.options.items.call(l.element[0], t, {item: this.currentItem}) : e(l.options.items, l.element), l]), this.containers.push(l))
            }
            for (var r = n.length - 1; r >= 0; r--)for (var h = n[r][1], u = n[r][0], o = 0, c = u.length; c > o; o++) {
                var p = e(u[o]);
                p.data(this.widgetName + "-item", h), i.push({
                    item: p,
                    instance: h,
                    width: 0,
                    height: 0,
                    left: 0,
                    top: 0
                })
            }
        },
        refreshPositions: function (t) {
            this.offsetParent && this.helper && (this.offset.parent = this._getParentOffset());
            for (var i = this.items.length - 1; i >= 0; i--) {
                var n = this.items[i];
                if (n.instance == this.currentContainer || !this.currentContainer || n.item[0] == this.currentItem[0]) {
                    var s = this.options.toleranceElement ? e(this.options.toleranceElement, n.item) : n.item;
                    t || (n.width = s.outerWidth(), n.height = s.outerHeight());
                    var r = s.offset();
                    n.left = r.left, n.top = r.top
                }
            }
            if (this.options.custom && this.options.custom.refreshContainers) this.options.custom.refreshContainers.call(this); else for (var i = this.containers.length - 1; i >= 0; i--) {
                var r = this.containers[i].element.offset();
                this.containers[i].containerCache.left = r.left, this.containers[i].containerCache.top = r.top, this.containers[i].containerCache.width = this.containers[i].element.outerWidth(), this.containers[i].containerCache.height = this.containers[i].element.outerHeight()
            }
            return this
        },
        _createPlaceholder: function (t) {
            t = t || this;
            var i = t.options;
            if (!i.placeholder || i.placeholder.constructor == String) {
                var n = i.placeholder;
                i.placeholder = {
                    element: function () {
                        var i = e(document.createElement(t.currentItem[0].nodeName)).addClass(n || t.currentItem[0].className + " ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];
                        return n || (i.style.visibility = "hidden"), i
                    }, update: function (e, s) {
                        (!n || i.forcePlaceholderSize) && (s.height() || s.height(t.currentItem.innerHeight() - parseInt(t.currentItem.css("paddingTop") || 0, 10) - parseInt(t.currentItem.css("paddingBottom") || 0, 10)), s.width() || s.width(t.currentItem.innerWidth() - parseInt(t.currentItem.css("paddingLeft") || 0, 10) - parseInt(t.currentItem.css("paddingRight") || 0, 10)))
                    }
                }
            }
            t.placeholder = e(i.placeholder.element.call(t.element, t.currentItem)), t.currentItem.after(t.placeholder), i.placeholder.update(t, t.placeholder)
        },
        _contactContainers: function (t) {
            for (var i = null, n = null, s = this.containers.length - 1; s >= 0; s--)if (!e.contains(this.currentItem[0], this.containers[s].element[0]))if (this._intersectsWith(this.containers[s].containerCache)) {
                if (i && e.contains(this.containers[s].element[0], i.element[0]))continue;
                i = this.containers[s], n = s
            } else this.containers[s].containerCache.over && (this.containers[s]._trigger("out", t, this._uiHash(this)), this.containers[s].containerCache.over = 0);
            if (i)if (1 === this.containers.length) this.containers[n]._trigger("over", t, this._uiHash(this)), this.containers[n].containerCache.over = 1; else {
                for (var r = 1e4, a = null, o = this.containers[n].floating ? "left" : "top", l = this.containers[n].floating ? "width" : "height", h = this.positionAbs[o] + this.offset.click[o], u = this.items.length - 1; u >= 0; u--)if (e.contains(this.containers[n].element[0], this.items[u].item[0]) && this.items[u].item[0] != this.currentItem[0]) {
                    var c = this.items[u].item.offset()[o], p = !1;
                    Math.abs(c - h) > Math.abs(c + this.items[u][l] - h) && (p = !0, c += this.items[u][l]), Math.abs(c - h) < r && (r = Math.abs(c - h), a = this.items[u], this.direction = p ? "up" : "down")
                }
                if (!a && !this.options.dropOnEmpty)return;
                this.currentContainer = this.containers[n], a ? this._rearrange(t, a, null, !0) : this._rearrange(t, null, this.containers[n].element, !0), this._trigger("change", t, this._uiHash()), this.containers[n]._trigger("change", t, this._uiHash(this)), this.options.placeholder.update(this.currentContainer, this.placeholder), this.containers[n]._trigger("over", t, this._uiHash(this)), this.containers[n].containerCache.over = 1
            }
        },
        _createHelper: function (t) {
            var i = this.options, n = e.isFunction(i.helper) ? e(i.helper.apply(this.element[0], [t, this.currentItem])) : "clone" == i.helper ? this.currentItem.clone() : this.currentItem;
            return n.parents("body").length || e("parent" != i.appendTo ? i.appendTo : this.currentItem[0].parentNode)[0].appendChild(n[0]), n[0] == this.currentItem[0] && (this._storedCSS = {
                width: this.currentItem[0].style.width,
                height: this.currentItem[0].style.height,
                position: this.currentItem.css("position"),
                top: this.currentItem.css("top"),
                left: this.currentItem.css("left")
            }), ("" == n[0].style.width || i.forceHelperSize) && n.width(this.currentItem.width()), ("" == n[0].style.height || i.forceHelperSize) && n.height(this.currentItem.height()), n
        },
        _adjustOffsetFromHelper: function (t) {
            "string" == typeof t && (t = t.split(" ")), e.isArray(t) && (t = {
                left: +t[0],
                top: +t[1] || 0
            }), "left" in t && (this.offset.click.left = t.left + this.margins.left), "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left), "top" in t && (this.offset.click.top = t.top + this.margins.top), "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top)
        },
        _getParentOffset: function () {
            this.offsetParent = this.helper.offsetParent();
            var t = this.offsetParent.offset();
            return "absolute" == this.cssPosition && this.scrollParent[0] != document && e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop()), (this.offsetParent[0] == document.body || this.offsetParent[0].tagName && "html" == this.offsetParent[0].tagName.toLowerCase() && e.ui.ie) && (t = {
                top: 0,
                left: 0
            }), {
                top: t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
                left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
            }
        },
        _getRelativeOffset: function () {
            if ("relative" == this.cssPosition) {
                var e = this.currentItem.position();
                return {
                    top: e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),
                    left: e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()
                }
            }
            return {top: 0, left: 0}
        },
        _cacheMargins: function () {
            this.margins = {
                left: parseInt(this.currentItem.css("marginLeft"), 10) || 0,
                top: parseInt(this.currentItem.css("marginTop"), 10) || 0
            }
        },
        _cacheHelperProportions: function () {
            this.helperProportions = {width: this.helper.outerWidth(), height: this.helper.outerHeight()}
        },
        _setContainment: function () {
            var t = this.options;
            if ("parent" == t.containment && (t.containment = this.helper[0].parentNode), ("document" == t.containment || "window" == t.containment) && (this.containment = [0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top - this.offset.parent.top, e("document" == t.containment ? document : window).width() - this.helperProportions.width - this.margins.left, (e("document" == t.containment ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]), !/^(document|window|parent)$/.test(t.containment)) {
                var i = e(t.containment)[0], n = e(t.containment).offset(), s = "hidden" != e(i).css("overflow");
                this.containment = [n.left + (parseInt(e(i).css("borderLeftWidth"), 10) || 0) + (parseInt(e(i).css("paddingLeft"), 10) || 0) - this.margins.left, n.top + (parseInt(e(i).css("borderTopWidth"), 10) || 0) + (parseInt(e(i).css("paddingTop"), 10) || 0) - this.margins.top, n.left + (s ? Math.max(i.scrollWidth, i.offsetWidth) : i.offsetWidth) - (parseInt(e(i).css("borderLeftWidth"), 10) || 0) - (parseInt(e(i).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, n.top + (s ? Math.max(i.scrollHeight, i.offsetHeight) : i.offsetHeight) - (parseInt(e(i).css("borderTopWidth"), 10) || 0) - (parseInt(e(i).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top]
            }
        },
        _convertPositionTo: function (t, i) {
            i || (i = this.position);
            var n = "absolute" == t ? 1 : -1, s = (this.options, "absolute" != this.cssPosition || this.scrollParent[0] != document && e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent), r = /(html|body)/i.test(s[0].tagName);
            return {
                top: i.top + this.offset.relative.top * n + this.offset.parent.top * n - ("fixed" == this.cssPosition ? -this.scrollParent.scrollTop() : r ? 0 : s.scrollTop()) * n,
                left: i.left + this.offset.relative.left * n + this.offset.parent.left * n - ("fixed" == this.cssPosition ? -this.scrollParent.scrollLeft() : r ? 0 : s.scrollLeft()) * n
            }
        },
        _generatePosition: function (t) {
            var i = this.options, n = "absolute" != this.cssPosition || this.scrollParent[0] != document && e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, s = /(html|body)/i.test(n[0].tagName);
            "relative" == this.cssPosition && (this.scrollParent[0] == document || this.scrollParent[0] == this.offsetParent[0]) && (this.offset.relative = this._getRelativeOffset());
            var r = t.pageX, a = t.pageY;
            if (this.originalPosition && (this.containment && (t.pageX - this.offset.click.left < this.containment[0] && (r = this.containment[0] + this.offset.click.left), t.pageY - this.offset.click.top < this.containment[1] && (a = this.containment[1] + this.offset.click.top), t.pageX - this.offset.click.left > this.containment[2] && (r = this.containment[2] + this.offset.click.left), t.pageY - this.offset.click.top > this.containment[3] && (a = this.containment[3] + this.offset.click.top)), i.grid)) {
                var o = this.originalPageY + Math.round((a - this.originalPageY) / i.grid[1]) * i.grid[1];
                a = this.containment ? o - this.offset.click.top < this.containment[1] || o - this.offset.click.top > this.containment[3] ? o - this.offset.click.top < this.containment[1] ? o + i.grid[1] : o - i.grid[1] : o : o;
                var l = this.originalPageX + Math.round((r - this.originalPageX) / i.grid[0]) * i.grid[0];
                r = this.containment ? l - this.offset.click.left < this.containment[0] || l - this.offset.click.left > this.containment[2] ? l - this.offset.click.left < this.containment[0] ? l + i.grid[0] : l - i.grid[0] : l : l
            }
            return {
                top: a - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + ("fixed" == this.cssPosition ? -this.scrollParent.scrollTop() : s ? 0 : n.scrollTop()),
                left: r - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + ("fixed" == this.cssPosition ? -this.scrollParent.scrollLeft() : s ? 0 : n.scrollLeft())
            }
        },
        _rearrange: function (e, t, i, n) {
            i ? i[0].appendChild(this.placeholder[0]) : t.item[0].parentNode.insertBefore(this.placeholder[0], "down" == this.direction ? t.item[0] : t.item[0].nextSibling), this.counter = this.counter ? ++this.counter : 1;
            var s = this.counter;
            this._delay(function () {
                s == this.counter && this.refreshPositions(!n)
            })
        },
        _clear: function (t, i) {
            this.reverting = !1;
            var n = [];
            if (!this._noFinalSort && this.currentItem.parent().length && this.placeholder.before(this.currentItem), this._noFinalSort = null, this.helper[0] == this.currentItem[0]) {
                for (var s in this._storedCSS)("auto" == this._storedCSS[s] || "static" == this._storedCSS[s]) && (this._storedCSS[s] = "");
                this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")
            } else this.currentItem.show();
            this.fromOutside && !i && n.push(function (e) {
                this._trigger("receive", e, this._uiHash(this.fromOutside))
            }), (this.fromOutside || this.domPosition.prev != this.currentItem.prev().not(".ui-sortable-helper")[0] || this.domPosition.parent != this.currentItem.parent()[0]) && !i && n.push(function (e) {
                this._trigger("update", e, this._uiHash())
            }), this !== this.currentContainer && (i || (n.push(function (e) {
                this._trigger("remove", e, this._uiHash())
            }), n.push(function (e) {
                return function (t) {
                    e._trigger("receive", t, this._uiHash(this))
                }
            }.call(this, this.currentContainer)), n.push(function (e) {
                return function (t) {
                    e._trigger("update", t, this._uiHash(this))
                }
            }.call(this, this.currentContainer))));
            for (var s = this.containers.length - 1; s >= 0; s--)i || n.push(function (e) {
                return function (t) {
                    e._trigger("deactivate", t, this._uiHash(this))
                }
            }.call(this, this.containers[s])), this.containers[s].containerCache.over && (n.push(function (e) {
                return function (t) {
                    e._trigger("out", t, this._uiHash(this))
                }
            }.call(this, this.containers[s])), this.containers[s].containerCache.over = 0);
            if (this._storedCursor && e("body").css("cursor", this._storedCursor), this._storedOpacity && this.helper.css("opacity", this._storedOpacity), this._storedZIndex && this.helper.css("zIndex", "auto" == this._storedZIndex ? "" : this._storedZIndex), this.dragging = !1, this.cancelHelperRemoval) {
                if (!i) {
                    this._trigger("beforeStop", t, this._uiHash());
                    for (var s = 0; s < n.length; s++)n[s].call(this, t);
                    this._trigger("stop", t, this._uiHash())
                }
                return this.fromOutside = !1, !1
            }
            if (i || this._trigger("beforeStop", t, this._uiHash()), this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.helper[0] != this.currentItem[0] && this.helper.remove(), this.helper = null, !i) {
                for (var s = 0; s < n.length; s++)n[s].call(this, t);
                this._trigger("stop", t, this._uiHash())
            }
            return this.fromOutside = !1, !0
        },
        _trigger: function () {
            e.Widget.prototype._trigger.apply(this, arguments) === !1 && this.cancel()
        },
        _uiHash: function (t) {
            var i = t || this;
            return {
                helper: i.helper,
                placeholder: i.placeholder || e([]),
                position: i.position,
                originalPosition: i.originalPosition,
                offset: i.positionAbs,
                item: i.currentItem,
                sender: t ? t.element : null
            }
        }
    })
}(jQuery), function (e) {
    var t = 0, i = {}, n = {};
    i.height = i.paddingTop = i.paddingBottom = i.borderTopWidth = i.borderBottomWidth = "hide", n.height = n.paddingTop = n.paddingBottom = n.borderTopWidth = n.borderBottomWidth = "show", e.widget("ui.accordion", {
        version: "1.9.2",
        options: {
            active: 0,
            animate: {},
            collapsible: !1,
            event: "click",
            header: "> li > :first-child,> :not(li):even",
            heightStyle: "auto",
            icons: {activeHeader: "ui-icon-triangle-1-s", header: "ui-icon-triangle-1-e"},
            activate: null,
            beforeActivate: null
        },
        _create: function () {
            var i = this.accordionId = "ui-accordion-" + (this.element.attr("id") || ++t), n = this.options;
            this.prevShow = this.prevHide = e(), this.element.addClass("ui-accordion ui-widget ui-helper-reset"), this.headers = this.element.find(n.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"), this._hoverable(this.headers), this._focusable(this.headers), this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide(), !n.collapsible && (n.active === !1 || null == n.active) && (n.active = 0), n.active < 0 && (n.active += this.headers.length), this.active = this._findActive(n.active).addClass("ui-accordion-header-active ui-state-active").toggleClass("ui-corner-all ui-corner-top"), this.active.next().addClass("ui-accordion-content-active").show(), this._createIcons(), this.refresh(), this.element.attr("role", "tablist"), this.headers.attr("role", "tab").each(function (t) {
                var n = e(this), s = n.attr("id"), r = n.next(), a = r.attr("id");
                s || (s = i + "-header-" + t, n.attr("id", s)), a || (a = i + "-panel-" + t, r.attr("id", a)), n.attr("aria-controls", a), r.attr("aria-labelledby", s)
            }).next().attr("role", "tabpanel"), this.headers.not(this.active).attr({
                "aria-selected": "false",
                tabIndex: -1
            }).next().attr({
                "aria-expanded": "false",
                "aria-hidden": "true"
            }).hide(), this.active.length ? this.active.attr({
                "aria-selected": "true",
                tabIndex: 0
            }).next().attr({
                "aria-expanded": "true",
                "aria-hidden": "false"
            }) : this.headers.eq(0).attr("tabIndex", 0), this._on(this.headers, {keydown: "_keydown"}), this._on(this.headers.next(), {keydown: "_panelKeyDown"}), this._setupEvents(n.event)
        },
        _getCreateEventData: function () {
            return {header: this.active, content: this.active.length ? this.active.next() : e()}
        },
        _createIcons: function () {
            var t = this.options.icons;
            t && (e("<span>").addClass("ui-accordion-header-icon ui-icon " + t.header).prependTo(this.headers), this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader), this.headers.addClass("ui-accordion-icons"))
        },
        _destroyIcons: function () {
            this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()
        },
        _destroy: function () {
            var e;
            this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"), this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function () {
                /^ui-accordion/.test(this.id) && this.removeAttribute("id")
            }), this._destroyIcons(), e = this.headers.next().css("display", "").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function () {
                /^ui-accordion/.test(this.id) && this.removeAttribute("id")
            }), "content" !== this.options.heightStyle && e.css("height", "")
        },
        _setOption: function (e, t) {
            return "active" === e ? (this._activate(t), void 0) : ("event" === e && (this.options.event && this._off(this.headers, this.options.event), this._setupEvents(t)), this._super(e, t), "collapsible" === e && !t && this.options.active === !1 && this._activate(0), "icons" === e && (this._destroyIcons(), t && this._createIcons()), "disabled" === e && this.headers.add(this.headers.next()).toggleClass("ui-state-disabled", !!t), void 0)
        },
        _keydown: function (t) {
            if (!t.altKey && !t.ctrlKey) {
                var i = e.ui.keyCode, n = this.headers.length, s = this.headers.index(t.target), r = !1;
                switch (t.keyCode) {
                    case i.RIGHT:
                    case i.DOWN:
                        r = this.headers[(s + 1) % n];
                        break;
                    case i.LEFT:
                    case i.UP:
                        r = this.headers[(s - 1 + n) % n];
                        break;
                    case i.SPACE:
                    case i.ENTER:
                        this._eventHandler(t);
                        break;
                    case i.HOME:
                        r = this.headers[0];
                        break;
                    case i.END:
                        r = this.headers[n - 1]
                }
                r && (e(t.target).attr("tabIndex", -1), e(r).attr("tabIndex", 0), r.focus(), t.preventDefault())
            }
        },
        _panelKeyDown: function (t) {
            t.keyCode === e.ui.keyCode.UP && t.ctrlKey && e(t.currentTarget).prev().focus()
        },
        refresh: function () {
            var t, i, n = this.options.heightStyle, s = this.element.parent();
            "fill" === n ? (e.support.minHeight || (i = s.css("overflow"), s.css("overflow", "hidden")), t = s.height(), this.element.siblings(":visible").each(function () {
                var i = e(this), n = i.css("position");
                "absolute" !== n && "fixed" !== n && (t -= i.outerHeight(!0))
            }), i && s.css("overflow", i), this.headers.each(function () {
                t -= e(this).outerHeight(!0)
            }), this.headers.next().each(function () {
                e(this).height(Math.max(0, t - e(this).innerHeight() + e(this).height()))
            }).css("overflow", "auto")) : "auto" === n && (t = 0, this.headers.next().each(function () {
                t = Math.max(t, e(this).css("height", "").height())
            }).height(t))
        },
        _activate: function (t) {
            var i = this._findActive(t)[0];
            i !== this.active[0] && (i = i || this.active[0], this._eventHandler({
                target: i,
                currentTarget: i,
                preventDefault: e.noop
            }))
        },
        _findActive: function (t) {
            return "number" == typeof t ? this.headers.eq(t) : e()
        },
        _setupEvents: function (t) {
            var i = {};
            t && (e.each(t.split(" "), function (e, t) {
                i[t] = "_eventHandler"
            }), this._on(this.headers, i))
        },
        _eventHandler: function (t) {
            var i = this.options, n = this.active, s = e(t.currentTarget), r = s[0] === n[0], a = r && i.collapsible, o = a ? e() : s.next(), l = n.next(), h = {
                oldHeader: n,
                oldPanel: l,
                newHeader: a ? e() : s,
                newPanel: o
            };
            t.preventDefault(), r && !i.collapsible || this._trigger("beforeActivate", t, h) === !1 || (i.active = a ? !1 : this.headers.index(s), this.active = r ? e() : s, this._toggle(h), n.removeClass("ui-accordion-header-active ui-state-active"), i.icons && n.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header), r || (s.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"), i.icons && s.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader), s.next().addClass("ui-accordion-content-active")))
        },
        _toggle: function (t) {
            var i = t.newPanel, n = this.prevShow.length ? this.prevShow : t.oldPanel;
            this.prevShow.add(this.prevHide).stop(!0, !0), this.prevShow = i, this.prevHide = n, this.options.animate ? this._animate(i, n, t) : (n.hide(), i.show(), this._toggleComplete(t)), n.attr({
                "aria-expanded": "false",
                "aria-hidden": "true"
            }), n.prev().attr("aria-selected", "false"), i.length && n.length ? n.prev().attr("tabIndex", -1) : i.length && this.headers.filter(function () {
                return 0 === e(this).attr("tabIndex")
            }).attr("tabIndex", -1), i.attr({
                "aria-expanded": "true",
                "aria-hidden": "false"
            }).prev().attr({"aria-selected": "true", tabIndex: 0})
        },
        _animate: function (e, t, s) {
            var r, a, o, l = this, h = 0, u = e.length && (!t.length || e.index() < t.index()), c = this.options.animate || {}, p = u && c.down || c, d = function () {
                l._toggleComplete(s)
            };
            return "number" == typeof p && (o = p), "string" == typeof p && (a = p), a = a || p.easing || c.easing, o = o || p.duration || c.duration, t.length ? e.length ? (r = e.show().outerHeight(), t.animate(i, {
                duration: o,
                easing: a,
                step: function (e, t) {
                    t.now = Math.round(e)
                }
            }), e.hide().animate(n, {
                duration: o, easing: a, complete: d, step: function (e, i) {
                    i.now = Math.round(e), "height" !== i.prop ? h += i.now : "content" !== l.options.heightStyle && (i.now = Math.round(r - t.outerHeight() - h), h = 0)
                }
            }), void 0) : t.animate(i, o, a, d) : e.animate(n, o, a, d)
        },
        _toggleComplete: function (e) {
            var t = e.oldPanel;
            t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"), t.length && (t.parent()[0].className = t.parent()[0].className), this._trigger("activate", null, e)
        }
    }), e.uiBackCompat !== !1 && (function (e, t) {
        e.extend(t.options, {
            navigation: !1, navigationFilter: function () {
                return this.href.toLowerCase() === location.href.toLowerCase()
            }
        });
        var i = t._create;
        t._create = function () {
            if (this.options.navigation) {
                var t = this, n = this.element.find(this.options.header), s = n.next(), r = n.add(s).find("a").filter(this.options.navigationFilter)[0];
                r && n.add(s).each(function (i) {
                    return e.contains(this, r) ? (t.options.active = Math.floor(i / 2), !1) : void 0
                })
            }
            i.call(this)
        }
    }(jQuery, jQuery.ui.accordion.prototype), function (e, t) {
        e.extend(t.options, {heightStyle: null, autoHeight: !0, clearStyle: !1, fillSpace: !1});
        var i = t._create, n = t._setOption;
        e.extend(t, {
            _create: function () {
                this.options.heightStyle = this.options.heightStyle || this._mergeHeightStyle(), i.call(this)
            }, _setOption: function (e) {
                ("autoHeight" === e || "clearStyle" === e || "fillSpace" === e) && (this.options.heightStyle = this._mergeHeightStyle()), n.apply(this, arguments)
            }, _mergeHeightStyle: function () {
                var e = this.options;
                return e.fillSpace ? "fill" : e.clearStyle ? "content" : e.autoHeight ? "auto" : void 0
            }
        })
    }(jQuery, jQuery.ui.accordion.prototype), function (e, t) {
        e.extend(t.options.icons, {activeHeader: null, headerSelected: "ui-icon-triangle-1-s"});
        var i = t._createIcons;
        t._createIcons = function () {
            this.options.icons && (this.options.icons.activeHeader = this.options.icons.activeHeader || this.options.icons.headerSelected), i.call(this)
        }
    }(jQuery, jQuery.ui.accordion.prototype), function (e, t) {
        t.activate = t._activate;
        var i = t._findActive;
        t._findActive = function (e) {
            return -1 === e && (e = !1), e && "number" != typeof e && (e = this.headers.index(this.headers.filter(e)), -1 === e && (e = !1)), i.call(this, e)
        }
    }(jQuery, jQuery.ui.accordion.prototype), jQuery.ui.accordion.prototype.resize = jQuery.ui.accordion.prototype.refresh, function (e, t) {
        e.extend(t.options, {change: null, changestart: null});
        var i = t._trigger;
        t._trigger = function (e, t, n) {
            var s = i.apply(this, arguments);
            return s ? ("beforeActivate" === e ? s = i.call(this, "changestart", t, {
                oldHeader: n.oldHeader,
                oldContent: n.oldPanel,
                newHeader: n.newHeader,
                newContent: n.newPanel
            }) : "activate" === e && (s = i.call(this, "change", t, {
                oldHeader: n.oldHeader,
                oldContent: n.oldPanel,
                newHeader: n.newHeader,
                newContent: n.newPanel
            })), s) : !1
        }
    }(jQuery, jQuery.ui.accordion.prototype), function (e, t) {
        e.extend(t.options, {animate: null, animated: "slide"});
        var i = t._create;
        t._create = function () {
            var e = this.options;
            null === e.animate && (e.animate = e.animated ? "slide" === e.animated ? 300 : "bounceslide" === e.animated ? {
                duration: 200,
                down: {easing: "easeOutBounce", duration: 1e3}
            } : e.animated : !1), i.call(this)
        }
    }(jQuery, jQuery.ui.accordion.prototype))
}(jQuery), function (e) {
    var t = 0;
    e.widget("ui.autocomplete", {
        version: "1.9.2",
        defaultElement: "<input>",
        options: {
            appendTo: "body",
            autoFocus: !1,
            delay: 300,
            minLength: 1,
            position: {my: "left top", at: "left bottom", collision: "none"},
            source: null,
            change: null,
            close: null,
            focus: null,
            open: null,
            response: null,
            search: null,
            select: null
        },
        pending: 0,
        _create: function () {
            var t, i, n;
            this.isMultiLine = this._isMultiLine(), this.valueMethod = this.element[this.element.is("input,textarea") ? "val" : "text"], this.isNewMenu = !0, this.element.addClass("ui-autocomplete-input").attr("autocomplete", "off"), this._on(this.element, {
                keydown: function (s) {
                    if (this.element.prop("readOnly"))return t = !0, n = !0, i = !0, void 0;
                    t = !1, n = !1, i = !1;
                    var r = e.ui.keyCode;
                    switch (s.keyCode) {
                        case r.PAGE_UP:
                            t = !0, this._move("previousPage", s);
                            break;
                        case r.PAGE_DOWN:
                            t = !0, this._move("nextPage", s);
                            break;
                        case r.UP:
                            t = !0, this._keyEvent("previous", s);
                            break;
                        case r.DOWN:
                            t = !0, this._keyEvent("next", s);
                            break;
                        case r.ENTER:
                        case r.NUMPAD_ENTER:
                            this.menu.active && (t = !0, s.preventDefault(), this.menu.select(s));
                            break;
                        case r.TAB:
                            this.menu.active && this.menu.select(s);
                            break;
                        case r.ESCAPE:
                            this.menu.element.is(":visible") && (this._value(this.term), this.close(s), s.preventDefault());
                            break;
                        default:
                            i = !0, this._searchTimeout(s)
                    }
                }, keypress: function (n) {
                    if (t)return t = !1, n.preventDefault(), void 0;
                    if (!i) {
                        var s = e.ui.keyCode;
                        switch (n.keyCode) {
                            case s.PAGE_UP:
                                this._move("previousPage", n);
                                break;
                            case s.PAGE_DOWN:
                                this._move("nextPage", n);
                                break;
                            case s.UP:
                                this._keyEvent("previous", n);
                                break;
                            case s.DOWN:
                                this._keyEvent("next", n)
                        }
                    }
                }, input: function (e) {
                    return n ? (n = !1, e.preventDefault(), void 0) : (this._searchTimeout(e), void 0)
                }, focus: function () {
                    this.selectedItem = null, this.previous = this._value()
                }, blur: function (e) {
                    return this.cancelBlur ? (delete this.cancelBlur, void 0) : (clearTimeout(this.searching), this.close(e), this._change(e), void 0)
                }
            }), this._initSource(), this.menu = e("<ul>").addClass("ui-autocomplete").appendTo(this.document.find(this.options.appendTo || "body")[0]).menu({
                input: e(),
                role: null
            }).zIndex(this.element.zIndex() + 1).hide().data("menu"), this._on(this.menu.element, {
                mousedown: function (t) {
                    t.preventDefault(), this.cancelBlur = !0, this._delay(function () {
                        delete this.cancelBlur
                    });
                    var i = this.menu.element[0];
                    e(t.target).closest(".ui-menu-item").length || this._delay(function () {
                        var t = this;
                        this.document.one("mousedown", function (n) {
                            n.target !== t.element[0] && n.target !== i && !e.contains(i, n.target) && t.close()
                        })
                    })
                }, menufocus: function (t, i) {
                    if (this.isNewMenu && (this.isNewMenu = !1, t.originalEvent && /^mouse/.test(t.originalEvent.type)))return this.menu.blur(), this.document.one("mousemove", function () {
                        e(t.target).trigger(t.originalEvent)
                    }), void 0;
                    var n = i.item.data("ui-autocomplete-item") || i.item.data("item.autocomplete");
                    !1 !== this._trigger("focus", t, {item: n}) ? t.originalEvent && /^key/.test(t.originalEvent.type) && this._value(n.value) : this.liveRegion.text(n.value)
                }, menuselect: function (e, t) {
                    var i = t.item.data("ui-autocomplete-item") || t.item.data("item.autocomplete"), n = this.previous;
                    this.element[0] !== this.document[0].activeElement && (this.element.focus(), this.previous = n, this._delay(function () {
                        this.previous = n, this.selectedItem = i
                    })), !1 !== this._trigger("select", e, {item: i}) && this._value(i.value), this.term = this._value(), this.close(e), this.selectedItem = i
                }
            }), this.liveRegion = e("<span>", {
                role: "status",
                "aria-live": "polite"
            }).addClass("ui-helper-hidden-accessible").insertAfter(this.element), e.fn.bgiframe && this.menu.element.bgiframe(), this._on(this.window, {
                beforeunload: function () {
                    this.element.removeAttr("autocomplete")
                }
            })
        },
        _destroy: function () {
            clearTimeout(this.searching), this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"), this.menu.element.remove(), this.liveRegion.remove()
        },
        _setOption: function (e, t) {
            this._super(e, t), "source" === e && this._initSource(), "appendTo" === e && this.menu.element.appendTo(this.document.find(t || "body")[0]), "disabled" === e && t && this.xhr && this.xhr.abort()
        },
        _isMultiLine: function () {
            return this.element.is("textarea") ? !0 : this.element.is("input") ? !1 : this.element.prop("isContentEditable")
        },
        _initSource: function () {
            var t, i, n = this;
            e.isArray(this.options.source) ? (t = this.options.source, this.source = function (i, n) {
                n(e.ui.autocomplete.filter(t, i.term))
            }) : "string" == typeof this.options.source ? (i = this.options.source, this.source = function (t, s) {
                n.xhr && n.xhr.abort(), n.xhr = e.ajax({
                    url: i, data: t, dataType: "json", success: function (e) {
                        s(e)
                    }, error: function () {
                        s([])
                    }
                })
            }) : this.source = this.options.source
        },
        _searchTimeout: function (e) {
            clearTimeout(this.searching), this.searching = this._delay(function () {
                this.term !== this._value() && (this.selectedItem = null, this.search(null, e))
            }, this.options.delay)
        },
        search: function (e, t) {
            return e = null != e ? e : this._value(), this.term = this._value(), e.length < this.options.minLength ? this.close(t) : this._trigger("search", t) !== !1 ? this._search(e) : void 0
        },
        _search: function (e) {
            this.pending++, this.element.addClass("ui-autocomplete-loading"), this.cancelSearch = !1, this.source({term: e}, this._response())
        },
        _response: function () {
            var e = this, i = ++t;
            return function (n) {
                i === t && e.__response(n), e.pending--, e.pending || e.element.removeClass("ui-autocomplete-loading")
            }
        },
        __response: function (e) {
            e && (e = this._normalize(e)), this._trigger("response", null, {content: e}), !this.options.disabled && e && e.length && !this.cancelSearch ? (this._suggest(e), this._trigger("open")) : this._close()
        },
        close: function (e) {
            this.cancelSearch = !0, this._close(e)
        },
        _close: function (e) {
            this.menu.element.is(":visible") && (this.menu.element.hide(), this.menu.blur(), this.isNewMenu = !0, this._trigger("close", e))
        },
        _change: function (e) {
            this.previous !== this._value() && this._trigger("change", e, {item: this.selectedItem})
        },
        _normalize: function (t) {
            return t.length && t[0].label && t[0].value ? t : e.map(t, function (t) {
                return "string" == typeof t ? {label: t, value: t} : e.extend({
                    label: t.label || t.value,
                    value: t.value || t.label
                }, t)
            })
        },
        _suggest: function (t) {
            var i = this.menu.element.empty().zIndex(this.element.zIndex() + 1);
            this._renderMenu(i, t), this.menu.refresh(), i.show(), this._resizeMenu(), i.position(e.extend({of: this.element}, this.options.position)), this.options.autoFocus && this.menu.next()
        },
        _resizeMenu: function () {
            var e = this.menu.element;
            e.outerWidth(Math.max(e.width("").outerWidth() + 1, this.element.outerWidth()))
        },
        _renderMenu: function (t, i) {
            var n = this;
            e.each(i, function (e, i) {
                n._renderItemData(t, i)
            })
        },
        _renderItemData: function (e, t) {
            return this._renderItem(e, t).data("ui-autocomplete-item", t)
        },
        _renderItem: function (t, i) {
            return e("<li>").append(e("<a>").text(i.label)).appendTo(t)
        },
        _move: function (e, t) {
            return this.menu.element.is(":visible") ? this.menu.isFirstItem() && /^previous/.test(e) || this.menu.isLastItem() && /^next/.test(e) ? (this._value(this.term), this.menu.blur(), void 0) : (this.menu[e](t), void 0) : (this.search(null, t), void 0)
        },
        widget: function () {
            return this.menu.element
        },
        _value: function () {
            return this.valueMethod.apply(this.element, arguments)
        },
        _keyEvent: function (e, t) {
            (!this.isMultiLine || this.menu.element.is(":visible")) && (this._move(e, t), t.preventDefault())
        }
    }), e.extend(e.ui.autocomplete, {
        escapeRegex: function (e) {
            return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&")
        }, filter: function (t, i) {
            var n = new RegExp(e.ui.autocomplete.escapeRegex(i), "i");
            return e.grep(t, function (e) {
                return n.test(e.label || e.value || e)
            })
        }
    }), e.widget("ui.autocomplete", e.ui.autocomplete, {
        options: {
            messages: {
                noResults: "No search results.",
                results: function (e) {
                    return e + (e > 1 ? " results are" : " result is") + " available, use up and down arrow keys to navigate."
                }
            }
        }, __response: function (e) {
            var t;
            this._superApply(arguments), this.options.disabled || this.cancelSearch || (t = e && e.length ? this.options.messages.results(e.length) : this.options.messages.noResults, this.liveRegion.text(t))
        }
    })
}(jQuery), function (e) {
    var t, i, n, s, r = "ui-button ui-widget ui-state-default ui-corner-all", a = "ui-state-hover ui-state-active ", o = "ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only", l = function () {
        var t = e(this).find(":ui-button");
        setTimeout(function () {
            t.button("refresh")
        }, 1)
    }, h = function (t) {
        var i = t.name, n = t.form, s = e([]);
        return i && (s = n ? e(n).find("[name='" + i + "']") : e("[name='" + i + "']", t.ownerDocument).filter(function () {
            return !this.form
        })), s
    };
    e.widget("ui.button", {
        version: "1.9.2",
        defaultElement: "<button>",
        options: {disabled: null, text: !0, label: null, icons: {primary: null, secondary: null}},
        _create: function () {
            this.element.closest("form").unbind("reset" + this.eventNamespace).bind("reset" + this.eventNamespace, l), "boolean" != typeof this.options.disabled ? this.options.disabled = !!this.element.prop("disabled") : this.element.prop("disabled", this.options.disabled), this._determineButtonType(), this.hasTitle = !!this.buttonElement.attr("title");
            var a = this, o = this.options, u = "checkbox" === this.type || "radio" === this.type, c = u ? "" : "ui-state-active", p = "ui-state-focus";
            null === o.label && (o.label = "input" === this.type ? this.buttonElement.val() : this.buttonElement.html()), this._hoverable(this.buttonElement), this.buttonElement.addClass(r).attr("role", "button").bind("mouseenter" + this.eventNamespace, function () {
                o.disabled || this === t && e(this).addClass("ui-state-active")
            }).bind("mouseleave" + this.eventNamespace, function () {
                o.disabled || e(this).removeClass(c)
            }).bind("click" + this.eventNamespace, function (e) {
                o.disabled && (e.preventDefault(), e.stopImmediatePropagation())
            }), this.element.bind("focus" + this.eventNamespace, function () {
                a.buttonElement.addClass(p)
            }).bind("blur" + this.eventNamespace, function () {
                a.buttonElement.removeClass(p)
            }), u && (this.element.bind("change" + this.eventNamespace, function () {
                s || a.refresh()
            }), this.buttonElement.bind("mousedown" + this.eventNamespace, function (e) {
                o.disabled || (s = !1, i = e.pageX, n = e.pageY)
            }).bind("mouseup" + this.eventNamespace, function (e) {
                o.disabled || (i !== e.pageX || n !== e.pageY) && (s = !0)
            })), "checkbox" === this.type ? this.buttonElement.bind("click" + this.eventNamespace, function () {
                return o.disabled || s ? !1 : (e(this).toggleClass("ui-state-active"), a.buttonElement.attr("aria-pressed", a.element[0].checked), void 0)
            }) : "radio" === this.type ? this.buttonElement.bind("click" + this.eventNamespace, function () {
                if (o.disabled || s)return !1;
                e(this).addClass("ui-state-active"), a.buttonElement.attr("aria-pressed", "true");
                var t = a.element[0];
                h(t).not(t).map(function () {
                    return e(this).button("widget")[0]
                }).removeClass("ui-state-active").attr("aria-pressed", "false")
            }) : (this.buttonElement.bind("mousedown" + this.eventNamespace, function () {
                return o.disabled ? !1 : (e(this).addClass("ui-state-active"), t = this, a.document.one("mouseup", function () {
                    t = null
                }), void 0)
            }).bind("mouseup" + this.eventNamespace, function () {
                return o.disabled ? !1 : (e(this).removeClass("ui-state-active"), void 0)
            }).bind("keydown" + this.eventNamespace, function (t) {
                return o.disabled ? !1 : ((t.keyCode === e.ui.keyCode.SPACE || t.keyCode === e.ui.keyCode.ENTER) && e(this).addClass("ui-state-active"), void 0)
            }).bind("keyup" + this.eventNamespace, function () {
                e(this).removeClass("ui-state-active")
            }), this.buttonElement.is("a") && this.buttonElement.keyup(function (t) {
                t.keyCode === e.ui.keyCode.SPACE && e(this).click()
            })), this._setOption("disabled", o.disabled), this._resetButton()
        },
        _determineButtonType: function () {
            var e, t, i;
            this.type = this.element.is("[type=checkbox]") ? "checkbox" : this.element.is("[type=radio]") ? "radio" : this.element.is("input") ? "input" : "button", "checkbox" === this.type || "radio" === this.type ? (e = this.element.parents().last(), t = "label[for='" + this.element.attr("id") + "']", this.buttonElement = e.find(t), this.buttonElement.length || (e = e.length ? e.siblings() : this.element.siblings(), this.buttonElement = e.filter(t), this.buttonElement.length || (this.buttonElement = e.find(t))), this.element.addClass("ui-helper-hidden-accessible"), i = this.element.is(":checked"), i && this.buttonElement.addClass("ui-state-active"), this.buttonElement.prop("aria-pressed", i)) : this.buttonElement = this.element
        },
        widget: function () {
            return this.buttonElement
        },
        _destroy: function () {
            this.element.removeClass("ui-helper-hidden-accessible"), this.buttonElement.removeClass(r + " " + a + " " + o).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()), this.hasTitle || this.buttonElement.removeAttr("title")
        },
        _setOption: function (e, t) {
            return this._super(e, t), "disabled" === e ? (t ? this.element.prop("disabled", !0) : this.element.prop("disabled", !1), void 0) : (this._resetButton(), void 0)
        },
        refresh: function () {
            var t = this.element.is("input, button") ? this.element.is(":disabled") : this.element.hasClass("ui-button-disabled");
            t !== this.options.disabled && this._setOption("disabled", t), "radio" === this.type ? h(this.element[0]).each(function () {
                e(this).is(":checked") ? e(this).button("widget").addClass("ui-state-active").attr("aria-pressed", "true") : e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed", "false")
            }) : "checkbox" === this.type && (this.element.is(":checked") ? this.buttonElement.addClass("ui-state-active").attr("aria-pressed", "true") : this.buttonElement.removeClass("ui-state-active").attr("aria-pressed", "false"))
        },
        _resetButton: function () {
            if ("input" === this.type)return this.options.label && this.element.val(this.options.label), void 0;
            var t = this.buttonElement.removeClass(o), i = e("<span></span>", this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(), n = this.options.icons, s = n.primary && n.secondary, r = [];
            n.primary || n.secondary ? (this.options.text && r.push("ui-button-text-icon" + (s ? "s" : n.primary ? "-primary" : "-secondary")), n.primary && t.prepend("<span class='ui-button-icon-primary ui-icon " + n.primary + "'></span>"), n.secondary && t.append("<span class='ui-button-icon-secondary ui-icon " + n.secondary + "'></span>"), this.options.text || (r.push(s ? "ui-button-icons-only" : "ui-button-icon-only"), this.hasTitle || t.attr("title", e.trim(i)))) : r.push("ui-button-text-only"), t.addClass(r.join(" "))
        }
    }), e.widget("ui.buttonset", {
        version: "1.9.2",
        options: {items: "button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(button)"},
        _create: function () {
            this.element.addClass("ui-buttonset")
        },
        _init: function () {
            this.refresh()
        },
        _setOption: function (e, t) {
            "disabled" === e && this.buttons.button("option", e, t), this._super(e, t)
        },
        refresh: function () {
            var t = "rtl" === this.element.css("direction");
            this.buttons = this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function () {
                return e(this).button("widget")[0]
            }).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t ? "ui-corner-right" : "ui-corner-left").end().filter(":last").addClass(t ? "ui-corner-left" : "ui-corner-right").end().end()
        },
        _destroy: function () {
            this.element.removeClass("ui-buttonset"), this.buttons.map(function () {
                return e(this).button("widget")[0]
            }).removeClass("ui-corner-left ui-corner-right").end().button("destroy")
        }
    })
}(jQuery), function ($, undefined) {
    function Datepicker() {
        this.debug = !1, this._curInst = null, this._keyEvent = !1, this._disabledInputs = [], this._datepickerShowing = !1, this._inDialog = !1, this._mainDivId = "ui-datepicker-div", this._inlineClass = "ui-datepicker-inline", this._appendClass = "ui-datepicker-append", this._triggerClass = "ui-datepicker-trigger", this._dialogClass = "ui-datepicker-dialog", this._disableClass = "ui-datepicker-disabled", this._unselectableClass = "ui-datepicker-unselectable", this._currentClass = "ui-datepicker-current-day", this._dayOverClass = "ui-datepicker-days-cell-over", this.regional = [], this.regional[""] = {
            closeText: "Done",
            prevText: "Prev",
            nextText: "Next",
            currentText: "Today",
            monthNames: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
            monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
            dayNames: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
            dayNamesShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
            dayNamesMin: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"],
            weekHeader: "Wk",
            dateFormat: "mm/dd/yy",
            firstDay: 0,
            isRTL: !1,
            showMonthAfterYear: !1,
            yearSuffix: ""
        }, this._defaults = {
            showOn: "focus",
            showAnim: "fadeIn",
            showOptions: {},
            defaultDate: null,
            appendText: "",
            buttonText: "...",
            buttonImage: "",
            buttonImageOnly: !1,
            hideIfNoPrevNext: !1,
            navigationAsDateFormat: !1,
            gotoCurrent: !1,
            changeMonth: !1,
            changeYear: !1,
            yearRange: "c-10:c+10",
            showOtherMonths: !1,
            selectOtherMonths: !1,
            showWeek: !1,
            calculateWeek: this.iso8601Week,
            shortYearCutoff: "+10",
            minDate: null,
            maxDate: null,
            duration: "fast",
            beforeShowDay: null,
            beforeShow: null,
            onSelect: null,
            onChangeMonthYear: null,
            onClose: null,
            numberOfMonths: 1,
            showCurrentAtPos: 0,
            stepMonths: 1,
            stepBigMonths: 12,
            altField: "",
            altFormat: "",
            constrainInput: !0,
            showButtonPanel: !1,
            autoSize: !1,
            disabled: !1
        }, $.extend(this._defaults, this.regional[""]), this.dpDiv = bindHover($('<div id="' + this._mainDivId + '" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))
    }

    function bindHover(e) {
        var t = "button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";
        return e.delegate(t, "mouseout", function () {
            $(this).removeClass("ui-state-hover"), -1 != this.className.indexOf("ui-datepicker-prev") && $(this).removeClass("ui-datepicker-prev-hover"), -1 != this.className.indexOf("ui-datepicker-next") && $(this).removeClass("ui-datepicker-next-hover")
        }).delegate(t, "mouseover", function () {
            $.datepicker._isDisabledDatepicker(instActive.inline ? e.parent()[0] : instActive.input[0]) || ($(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"), $(this).addClass("ui-state-hover"), -1 != this.className.indexOf("ui-datepicker-prev") && $(this).addClass("ui-datepicker-prev-hover"), -1 != this.className.indexOf("ui-datepicker-next") && $(this).addClass("ui-datepicker-next-hover"))
        })
    }

    function extendRemove(e, t) {
        $.extend(e, t);
        for (var i in t)(null == t[i] || t[i] == undefined) && (e[i] = t[i]);
        return e
    }

    $.extend($.ui, {datepicker: {version: "1.9.2"}});
    var PROP_NAME = "datepicker", dpuuid = (new Date).getTime(), instActive;
    $.extend(Datepicker.prototype, {
        markerClassName: "hasDatepicker",
        maxRows: 4,
        log: function () {
            this.debug && console.log.apply("", arguments)
        },
        _widgetDatepicker: function () {
            return this.dpDiv
        },
        setDefaults: function (e) {
            return extendRemove(this._defaults, e || {}), this
        },
        _attachDatepicker: function (target, settings) {
            var inlineSettings = null;
            for (var attrName in this._defaults) {
                var attrValue = target.getAttribute("date:" + attrName);
                if (attrValue) {
                    inlineSettings = inlineSettings || {};
                    try {
                        inlineSettings[attrName] = eval(attrValue)
                    } catch (err) {
                        inlineSettings[attrName] = attrValue
                    }
                }
            }
            var nodeName = target.nodeName.toLowerCase(), inline = "div" == nodeName || "span" == nodeName;
            target.id || (this.uuid += 1, target.id = "dp" + this.uuid);
            var inst = this._newInst($(target), inline);
            inst.settings = $.extend({}, settings || {}, inlineSettings || {}), "input" == nodeName ? this._connectDatepicker(target, inst) : inline && this._inlineDatepicker(target, inst)
        },
        _newInst: function (e, t) {
            var i = e[0].id.replace(/([^A-Za-z0-9_-])/g, "\\\\$1");
            return {
                id: i,
                input: e,
                selectedDay: 0,
                selectedMonth: 0,
                selectedYear: 0,
                drawMonth: 0,
                drawYear: 0,
                inline: t,
                dpDiv: t ? bindHover($('<div class="' + this._inlineClass + ' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')) : this.dpDiv
            }
        },
        _connectDatepicker: function (e, t) {
            var i = $(e);
            t.append = $([]), t.trigger = $([]), i.hasClass(this.markerClassName) || (this._attachments(i, t), i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker", function (e, i, n) {
                t.settings[i] = n
            }).bind("getData.datepicker", function (e, i) {
                return this._get(t, i)
            }), this._autoSize(t), $.data(e, PROP_NAME, t), t.settings.disabled && this._disableDatepicker(e))
        },
        _attachments: function (e, t) {
            var i = this._get(t, "appendText"), n = this._get(t, "isRTL");
            t.append && t.append.remove(), i && (t.append = $('<span class="' + this._appendClass + '">' + i + "</span>"), e[n ? "before" : "after"](t.append)), e.unbind("focus", this._showDatepicker), t.trigger && t.trigger.remove();
            var s = this._get(t, "showOn");
            if (("focus" == s || "both" == s) && e.focus(this._showDatepicker), "button" == s || "both" == s) {
                var r = this._get(t, "buttonText"), a = this._get(t, "buttonImage");
                t.trigger = $(this._get(t, "buttonImageOnly") ? $("<img/>").addClass(this._triggerClass).attr({
                    src: a,
                    alt: r,
                    title: r
                }) : $('<button type="button"></button>').addClass(this._triggerClass).html("" == a ? r : $("<img/>").attr({
                    src: a,
                    alt: r,
                    title: r
                }))), e[n ? "before" : "after"](t.trigger), t.trigger.click(function () {
                    return $.datepicker._datepickerShowing && $.datepicker._lastInput == e[0] ? $.datepicker._hideDatepicker() : $.datepicker._datepickerShowing && $.datepicker._lastInput != e[0] ? ($.datepicker._hideDatepicker(), $.datepicker._showDatepicker(e[0])) : $.datepicker._showDatepicker(e[0]), !1
                })
            }
        },
        _autoSize: function (e) {
            if (this._get(e, "autoSize") && !e.inline) {
                var t = new Date(2009, 11, 20), i = this._get(e, "dateFormat");
                if (i.match(/[DM]/)) {
                    var n = function (e) {
                        for (var t = 0, i = 0, n = 0; n < e.length; n++)e[n].length > t && (t = e[n].length, i = n);
                        return i
                    };
                    t.setMonth(n(this._get(e, i.match(/MM/) ? "monthNames" : "monthNamesShort"))), t.setDate(n(this._get(e, i.match(/DD/) ? "dayNames" : "dayNamesShort")) + 20 - t.getDay())
                }
                e.input.attr("size", this._formatDate(e, t).length)
            }
        },
        _inlineDatepicker: function (e, t) {
            var i = $(e);
            i.hasClass(this.markerClassName) || (i.addClass(this.markerClassName).append(t.dpDiv).bind("setData.datepicker", function (e, i, n) {
                t.settings[i] = n
            }).bind("getData.datepicker", function (e, i) {
                return this._get(t, i)
            }), $.data(e, PROP_NAME, t), this._setDate(t, this._getDefaultDate(t), !0), this._updateDatepicker(t), this._updateAlternate(t), t.settings.disabled && this._disableDatepicker(e), t.dpDiv.css("display", "block"))
        },
        _dialogDatepicker: function (e, t, i, n, s) {
            var r = this._dialogInst;
            if (!r) {
                this.uuid += 1;
                var a = "dp" + this.uuid;
                this._dialogInput = $('<input type="text" id="' + a + '" style="position: absolute; top: -100px; width: 0px;"/>'), this._dialogInput.keydown(this._doKeyDown), $("body").append(this._dialogInput), r = this._dialogInst = this._newInst(this._dialogInput, !1), r.settings = {}, $.data(this._dialogInput[0], PROP_NAME, r)
            }
            if (extendRemove(r.settings, n || {}), t = t && t.constructor == Date ? this._formatDate(r, t) : t, this._dialogInput.val(t), this._pos = s ? s.length ? s : [s.pageX, s.pageY] : null, !this._pos) {
                var o = document.documentElement.clientWidth, l = document.documentElement.clientHeight, h = document.documentElement.scrollLeft || document.body.scrollLeft, u = document.documentElement.scrollTop || document.body.scrollTop;
                this._pos = [o / 2 - 100 + h, l / 2 - 150 + u]
            }
            return this._dialogInput.css("left", this._pos[0] + 20 + "px").css("top", this._pos[1] + "px"), r.settings.onSelect = i, this._inDialog = !0, this.dpDiv.addClass(this._dialogClass), this._showDatepicker(this._dialogInput[0]), $.blockUI && $.blockUI(this.dpDiv), $.data(this._dialogInput[0], PROP_NAME, r), this
        },
        _destroyDatepicker: function (e) {
            var t = $(e), i = $.data(e, PROP_NAME);
            if (t.hasClass(this.markerClassName)) {
                var n = e.nodeName.toLowerCase();
                $.removeData(e, PROP_NAME), "input" == n ? (i.append.remove(), i.trigger.remove(), t.removeClass(this.markerClassName).unbind("focus", this._showDatepicker).unbind("keydown", this._doKeyDown).unbind("keypress", this._doKeyPress).unbind("keyup", this._doKeyUp)) : ("div" == n || "span" == n) && t.removeClass(this.markerClassName).empty()
            }
        },
        _enableDatepicker: function (e) {
            var t = $(e), i = $.data(e, PROP_NAME);
            if (t.hasClass(this.markerClassName)) {
                var n = e.nodeName.toLowerCase();
                if ("input" == n) e.disabled = !1, i.trigger.filter("button").each(function () {
                    this.disabled = !1
                }).end().filter("img").css({opacity: "1.0", cursor: ""}); else if ("div" == n || "span" == n) {
                    var s = t.children("." + this._inlineClass);
                    s.children().removeClass("ui-state-disabled"), s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled", !1)
                }
                this._disabledInputs = $.map(this._disabledInputs, function (t) {
                    return t == e ? null : t
                })
            }
        },
        _disableDatepicker: function (e) {
            var t = $(e), i = $.data(e, PROP_NAME);
            if (t.hasClass(this.markerClassName)) {
                var n = e.nodeName.toLowerCase();
                if ("input" == n) e.disabled = !0, i.trigger.filter("button").each(function () {
                    this.disabled = !0
                }).end().filter("img").css({opacity: "0.5", cursor: "default"}); else if ("div" == n || "span" == n) {
                    var s = t.children("." + this._inlineClass);
                    s.children().addClass("ui-state-disabled"), s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled", !0)
                }
                this._disabledInputs = $.map(this._disabledInputs, function (t) {
                    return t == e ? null : t
                }), this._disabledInputs[this._disabledInputs.length] = e
            }
        },
        _isDisabledDatepicker: function (e) {
            if (!e)return !1;
            for (var t = 0; t < this._disabledInputs.length; t++)if (this._disabledInputs[t] == e)return !0;
            return !1
        },
        _getInst: function (e) {
            try {
                return $.data(e, PROP_NAME)
            } catch (t) {
                throw"Missing instance data for this datepicker"
            }
        },
        _optionDatepicker: function (e, t, i) {
            var n = this._getInst(e);
            if (2 == arguments.length && "string" == typeof t)return "defaults" == t ? $.extend({}, $.datepicker._defaults) : n ? "all" == t ? $.extend({}, n.settings) : this._get(n, t) : null;
            var s = t || {};
            if ("string" == typeof t && (s = {}, s[t] = i), n) {
                this._curInst == n && this._hideDatepicker();
                var r = this._getDateDatepicker(e, !0), a = this._getMinMaxDate(n, "min"), o = this._getMinMaxDate(n, "max");
                extendRemove(n.settings, s), null !== a && s.dateFormat !== undefined && s.minDate === undefined && (n.settings.minDate = this._formatDate(n, a)), null !== o && s.dateFormat !== undefined && s.maxDate === undefined && (n.settings.maxDate = this._formatDate(n, o)), this._attachments($(e), n), this._autoSize(n), this._setDate(n, r), this._updateAlternate(n), this._updateDatepicker(n)
            }
        },
        _changeDatepicker: function (e, t, i) {
            this._optionDatepicker(e, t, i)
        },
        _refreshDatepicker: function (e) {
            var t = this._getInst(e);
            t && this._updateDatepicker(t)
        },
        _setDateDatepicker: function (e, t) {
            var i = this._getInst(e);
            i && (this._setDate(i, t), this._updateDatepicker(i), this._updateAlternate(i))
        },
        _getDateDatepicker: function (e, t) {
            var i = this._getInst(e);
            return i && !i.inline && this._setDateFromField(i, t), i ? this._getDate(i) : null
        },
        _doKeyDown: function (e) {
            var t = $.datepicker._getInst(e.target), i = !0, n = t.dpDiv.is(".ui-datepicker-rtl");
            if (t._keyEvent = !0, $.datepicker._datepickerShowing)switch (e.keyCode) {
                case 9:
                    $.datepicker._hideDatepicker(), i = !1;
                    break;
                case 13:
                    var s = $("td." + $.datepicker._dayOverClass + ":not(." + $.datepicker._currentClass + ")", t.dpDiv);
                    s[0] && $.datepicker._selectDay(e.target, t.selectedMonth, t.selectedYear, s[0]);
                    var r = $.datepicker._get(t, "onSelect");
                    if (r) {
                        var a = $.datepicker._formatDate(t);
                        r.apply(t.input ? t.input[0] : null, [a, t])
                    } else $.datepicker._hideDatepicker();
                    return !1;
                case 27:
                    $.datepicker._hideDatepicker();
                    break;
                case 33:
                    $.datepicker._adjustDate(e.target, e.ctrlKey ? -$.datepicker._get(t, "stepBigMonths") : -$.datepicker._get(t, "stepMonths"), "M");
                    break;
                case 34:
                    $.datepicker._adjustDate(e.target, e.ctrlKey ? +$.datepicker._get(t, "stepBigMonths") : +$.datepicker._get(t, "stepMonths"), "M");
                    break;
                case 35:
                    (e.ctrlKey || e.metaKey) && $.datepicker._clearDate(e.target), i = e.ctrlKey || e.metaKey;
                    break;
                case 36:
                    (e.ctrlKey || e.metaKey) && $.datepicker._gotoToday(e.target), i = e.ctrlKey || e.metaKey;
                    break;
                case 37:
                    (e.ctrlKey || e.metaKey) && $.datepicker._adjustDate(e.target, n ? 1 : -1, "D"), i = e.ctrlKey || e.metaKey, e.originalEvent.altKey && $.datepicker._adjustDate(e.target, e.ctrlKey ? -$.datepicker._get(t, "stepBigMonths") : -$.datepicker._get(t, "stepMonths"), "M");
                    break;
                case 38:
                    (e.ctrlKey || e.metaKey) && $.datepicker._adjustDate(e.target, -7, "D"), i = e.ctrlKey || e.metaKey;
                    break;
                case 39:
                    (e.ctrlKey || e.metaKey) && $.datepicker._adjustDate(e.target, n ? -1 : 1, "D"), i = e.ctrlKey || e.metaKey, e.originalEvent.altKey && $.datepicker._adjustDate(e.target, e.ctrlKey ? +$.datepicker._get(t, "stepBigMonths") : +$.datepicker._get(t, "stepMonths"), "M");
                    break;
                case 40:
                    (e.ctrlKey || e.metaKey) && $.datepicker._adjustDate(e.target, 7, "D"), i = e.ctrlKey || e.metaKey;
                    break;
                default:
                    i = !1
            } else 36 == e.keyCode && e.ctrlKey ? $.datepicker._showDatepicker(this) : i = !1;
            i && (e.preventDefault(), e.stopPropagation())
        },
        _doKeyPress: function (e) {
            var t = $.datepicker._getInst(e.target);
            if ($.datepicker._get(t, "constrainInput")) {
                var i = $.datepicker._possibleChars($.datepicker._get(t, "dateFormat")), n = String.fromCharCode(e.charCode == undefined ? e.keyCode : e.charCode);
                return e.ctrlKey || e.metaKey || " " > n || !i || i.indexOf(n) > -1
            }
        },
        _doKeyUp: function (e) {
            var t = $.datepicker._getInst(e.target);
            if (t.input.val() != t.lastVal)try {
                var i = $.datepicker.parseDate($.datepicker._get(t, "dateFormat"), t.input ? t.input.val() : null, $.datepicker._getFormatConfig(t));
                i && ($.datepicker._setDateFromField(t), $.datepicker._updateAlternate(t), $.datepicker._updateDatepicker(t))
            } catch (n) {
                $.datepicker.log(n)
            }
            return !0
        },
        _showDatepicker: function (e) {
            if (e = e.target || e, "input" != e.nodeName.toLowerCase() && (e = $("input", e.parentNode)[0]), !$.datepicker._isDisabledDatepicker(e) && $.datepicker._lastInput != e) {
                var t = $.datepicker._getInst(e);
                $.datepicker._curInst && $.datepicker._curInst != t && ($.datepicker._curInst.dpDiv.stop(!0, !0), t && $.datepicker._datepickerShowing && $.datepicker._hideDatepicker($.datepicker._curInst.input[0]));
                var i = $.datepicker._get(t, "beforeShow"), n = i ? i.apply(e, [e, t]) : {};
                if (n !== !1) {
                    extendRemove(t.settings, n), t.lastVal = null, $.datepicker._lastInput = e, $.datepicker._setDateFromField(t), $.datepicker._inDialog && (e.value = ""), $.datepicker._pos || ($.datepicker._pos = $.datepicker._findPos(e), $.datepicker._pos[1] += e.offsetHeight);
                    var s = !1;
                    $(e).parents().each(function () {
                        return s |= "fixed" == $(this).css("position"), !s
                    });
                    var r = {left: $.datepicker._pos[0], top: $.datepicker._pos[1]};
                    if ($.datepicker._pos = null, t.dpDiv.empty(), t.dpDiv.css({
                            position: "absolute",
                            display: "block",
                            top: "-1000px"
                        }), $.datepicker._updateDatepicker(t), r = $.datepicker._checkOffset(t, r, s), t.dpDiv.css({
                            position: $.datepicker._inDialog && $.blockUI ? "static" : s ? "fixed" : "absolute",
                            display: "none",
                            left: r.left + "px",
                            top: r.top + "px"
                        }), !t.inline) {
                        var a = $.datepicker._get(t, "showAnim"), o = $.datepicker._get(t, "duration"), l = function () {
                            var e = t.dpDiv.find("iframe.ui-datepicker-cover");
                            if (e.length) {
                                var i = $.datepicker._getBorders(t.dpDiv);
                                e.css({
                                    left: -i[0],
                                    top: -i[1],
                                    width: t.dpDiv.outerWidth(),
                                    height: t.dpDiv.outerHeight()
                                })
                            }
                        };
                        t.dpDiv.zIndex($(e).zIndex() + 1), $.datepicker._datepickerShowing = !0, $.effects && ($.effects.effect[a] || $.effects[a]) ? t.dpDiv.show(a, $.datepicker._get(t, "showOptions"), o, l) : t.dpDiv[a || "show"](a ? o : null, l), (!a || !o) && l(), t.input.is(":visible") && !t.input.is(":disabled") && t.input.focus(), $.datepicker._curInst = t
                    }
                }
            }
        },
        _updateDatepicker: function (e) {
            this.maxRows = 4;
            var t = $.datepicker._getBorders(e.dpDiv);
            instActive = e, e.dpDiv.empty().append(this._generateHTML(e)), this._attachHandlers(e);
            var i = e.dpDiv.find("iframe.ui-datepicker-cover");
            !i.length || i.css({
                left: -t[0],
                top: -t[1],
                width: e.dpDiv.outerWidth(),
                height: e.dpDiv.outerHeight()
            }), e.dpDiv.find("." + this._dayOverClass + " a").mouseover();
            var n = this._getNumberOfMonths(e), s = n[1], r = 17;
            if (e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""), s > 1 && e.dpDiv.addClass("ui-datepicker-multi-" + s).css("width", r * s + "em"), e.dpDiv[(1 != n[0] || 1 != n[1] ? "add" : "remove") + "Class"]("ui-datepicker-multi"), e.dpDiv[(this._get(e, "isRTL") ? "add" : "remove") + "Class"]("ui-datepicker-rtl"), e == $.datepicker._curInst && $.datepicker._datepickerShowing && e.input && e.input.is(":visible") && !e.input.is(":disabled") && e.input[0] != document.activeElement && e.input.focus(), e.yearshtml) {
                var a = e.yearshtml;
                setTimeout(function () {
                    a === e.yearshtml && e.yearshtml && e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml), a = e.yearshtml = null
                }, 0)
            }
        },
        _getBorders: function (e) {
            var t = function (e) {
                return {thin: 1, medium: 2, thick: 3}[e] || e
            };
            return [parseFloat(t(e.css("border-left-width"))), parseFloat(t(e.css("border-top-width")))]
        },
        _checkOffset: function (e, t, i) {
            var n = e.dpDiv.outerWidth(), s = e.dpDiv.outerHeight(), r = e.input ? e.input.outerWidth() : 0, a = e.input ? e.input.outerHeight() : 0, o = document.documentElement.clientWidth + (i ? 0 : $(document).scrollLeft()), l = document.documentElement.clientHeight + (i ? 0 : $(document).scrollTop());
            return t.left -= this._get(e, "isRTL") ? n - r : 0, t.left -= i && t.left == e.input.offset().left ? $(document).scrollLeft() : 0, t.top -= i && t.top == e.input.offset().top + a ? $(document).scrollTop() : 0, t.left -= Math.min(t.left, t.left + n > o && o > n ? Math.abs(t.left + n - o) : 0), t.top -= Math.min(t.top, t.top + s > l && l > s ? Math.abs(s + a) : 0), t
        },
        _findPos: function (e) {
            for (var t = this._getInst(e), i = this._get(t, "isRTL"); e && ("hidden" == e.type || 1 != e.nodeType || $.expr.filters.hidden(e));)e = e[i ? "previousSibling" : "nextSibling"];
            var n = $(e).offset();
            return [n.left, n.top]
        },
        _hideDatepicker: function (e) {
            var t = this._curInst;
            if (t && (!e || t == $.data(e, PROP_NAME)) && this._datepickerShowing) {
                var i = this._get(t, "showAnim"), n = this._get(t, "duration"), s = function () {
                    $.datepicker._tidyDialog(t)
                };
                $.effects && ($.effects.effect[i] || $.effects[i]) ? t.dpDiv.hide(i, $.datepicker._get(t, "showOptions"), n, s) : t.dpDiv["slideDown" == i ? "slideUp" : "fadeIn" == i ? "fadeOut" : "hide"](i ? n : null, s), i || s(), this._datepickerShowing = !1;
                var r = this._get(t, "onClose");
                r && r.apply(t.input ? t.input[0] : null, [t.input ? t.input.val() : "", t]), this._lastInput = null, this._inDialog && (this._dialogInput.css({
                    position: "absolute",
                    left: "0",
                    top: "-100px"
                }), $.blockUI && ($.unblockUI(), $("body").append(this.dpDiv))), this._inDialog = !1
            }
        },
        _tidyDialog: function (e) {
            e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")
        },
        _checkExternalClick: function (e) {
            if ($.datepicker._curInst) {
                var t = $(e.target), i = $.datepicker._getInst(t[0]);
                (t[0].id != $.datepicker._mainDivId && 0 == t.parents("#" + $.datepicker._mainDivId).length && !t.hasClass($.datepicker.markerClassName) && !t.closest("." + $.datepicker._triggerClass).length && $.datepicker._datepickerShowing && (!$.datepicker._inDialog || !$.blockUI) || t.hasClass($.datepicker.markerClassName) && $.datepicker._curInst != i) && $.datepicker._hideDatepicker()
            }
        },
        _adjustDate: function (e, t, i) {
            var n = $(e), s = this._getInst(n[0]);
            this._isDisabledDatepicker(n[0]) || (this._adjustInstDate(s, t + ("M" == i ? this._get(s, "showCurrentAtPos") : 0), i), this._updateDatepicker(s))
        },
        _gotoToday: function (e) {
            var t = $(e), i = this._getInst(t[0]);
            if (this._get(i, "gotoCurrent") && i.currentDay) i.selectedDay = i.currentDay, i.drawMonth = i.selectedMonth = i.currentMonth, i.drawYear = i.selectedYear = i.currentYear; else {
                var n = new Date;
                i.selectedDay = n.getDate(), i.drawMonth = i.selectedMonth = n.getMonth(), i.drawYear = i.selectedYear = n.getFullYear()
            }
            this._notifyChange(i), this._adjustDate(t)
        },
        _selectMonthYear: function (e, t, i) {
            var n = $(e), s = this._getInst(n[0]);
            s["selected" + ("M" == i ? "Month" : "Year")] = s["draw" + ("M" == i ? "Month" : "Year")] = parseInt(t.options[t.selectedIndex].value, 10), this._notifyChange(s), this._adjustDate(n)
        },
        _selectDay: function (e, t, i, n) {
            var s = $(e);
            if (!$(n).hasClass(this._unselectableClass) && !this._isDisabledDatepicker(s[0])) {
                var r = this._getInst(s[0]);
                r.selectedDay = r.currentDay = $("a", n).html(), r.selectedMonth = r.currentMonth = t, r.selectedYear = r.currentYear = i, this._selectDate(e, this._formatDate(r, r.currentDay, r.currentMonth, r.currentYear))
            }
        },
        _clearDate: function (e) {
            var t = $(e);
            this._getInst(t[0]), this._selectDate(t, "")
        },
        _selectDate: function (e, t) {
            var i = $(e), n = this._getInst(i[0]);
            t = null != t ? t : this._formatDate(n), n.input && n.input.val(t), this._updateAlternate(n);
            var s = this._get(n, "onSelect");
            s ? s.apply(n.input ? n.input[0] : null, [t, n]) : n.input && n.input.trigger("change"), n.inline ? this._updateDatepicker(n) : (this._hideDatepicker(), this._lastInput = n.input[0], "object" != typeof n.input[0] && n.input.focus(), this._lastInput = null)
        },
        _updateAlternate: function (e) {
            var t = this._get(e, "altField");
            if (t) {
                var i = this._get(e, "altFormat") || this._get(e, "dateFormat"), n = this._getDate(e), s = this.formatDate(i, n, this._getFormatConfig(e));
                $(t).each(function () {
                    $(this).val(s)
                })
            }
        },
        noWeekends: function (e) {
            var t = e.getDay();
            return [t > 0 && 6 > t, ""]
        },
        iso8601Week: function (e) {
            var t = new Date(e.getTime());
            t.setDate(t.getDate() + 4 - (t.getDay() || 7));
            var i = t.getTime();
            return t.setMonth(0), t.setDate(1), Math.floor(Math.round((i - t) / 864e5) / 7) + 1
        },
        parseDate: function (e, t, i) {
            if (null == e || null == t)throw"Invalid arguments";
            if (t = "object" == typeof t ? t.toString() : t + "", "" == t)return null;
            var n = (i ? i.shortYearCutoff : null) || this._defaults.shortYearCutoff;
            n = "string" != typeof n ? n : (new Date).getFullYear() % 100 + parseInt(n, 10);
            for (var s = (i ? i.dayNamesShort : null) || this._defaults.dayNamesShort, r = (i ? i.dayNames : null) || this._defaults.dayNames, a = (i ? i.monthNamesShort : null) || this._defaults.monthNamesShort, o = (i ? i.monthNames : null) || this._defaults.monthNames, l = -1, h = -1, u = -1, c = -1, p = !1, d = function (t) {
                var i = v + 1 < e.length && e.charAt(v + 1) == t;
                return i && v++, i
            }, f = function (e) {
                var i = d(e), n = "@" == e ? 14 : "!" == e ? 20 : "y" == e && i ? 4 : "o" == e ? 3 : 2, s = new RegExp("^\\d{1," + n + "}"), r = t.substring(y).match(s);
                if (!r)throw"Missing number at position " + y;
                return y += r[0].length, parseInt(r[0], 10)
            }, m = function (e, i, n) {
                var s = $.map(d(e) ? n : i, function (e, t) {
                    return [[t, e]]
                }).sort(function (e, t) {
                    return -(e[1].length - t[1].length)
                }), r = -1;
                if ($.each(s, function (e, i) {
                        var n = i[1];
                        return t.substr(y, n.length).toLowerCase() == n.toLowerCase() ? (r = i[0], y += n.length, !1) : void 0
                    }), -1 != r)return r + 1;
                throw"Unknown name at position " + y
            }, g = function () {
                if (t.charAt(y) != e.charAt(v))throw"Unexpected literal at position " + y;
                y++
            }, y = 0, v = 0; v < e.length; v++)if (p) "'" != e.charAt(v) || d("'") ? g() : p = !1; else switch (e.charAt(v)) {
                case"d":
                    u = f("d");
                    break;
                case"D":
                    m("D", s, r);
                    break;
                case"o":
                    c = f("o");
                    break;
                case"m":
                    h = f("m");
                    break;
                case"M":
                    h = m("M", a, o);
                    break;
                case"y":
                    l = f("y");
                    break;
                case"@":
                    var b = new Date(f("@"));
                    l = b.getFullYear(), h = b.getMonth() + 1, u = b.getDate();
                    break;
                case"!":
                    var b = new Date((f("!") - this._ticksTo1970) / 1e4);
                    l = b.getFullYear(), h = b.getMonth() + 1, u = b.getDate();
                    break;
                case"'":
                    d("'") ? g() : p = !0;
                    break;
                default:
                    g()
            }
            if (y < t.length) {
                var L = t.substr(y);
                if (!/^\s+/.test(L))throw"Extra/unparsed characters found in date: " + L
            }
            if (-1 == l ? l = (new Date).getFullYear() : 100 > l && (l += (new Date).getFullYear() - (new Date).getFullYear() % 100 + (n >= l ? 0 : -100)), c > -1)for (h = 1, u = c; ;) {
                var w = this._getDaysInMonth(l, h - 1);
                if (w >= u)break;
                h++, u -= w
            }
            var b = this._daylightSavingAdjust(new Date(l, h - 1, u));
            if (b.getFullYear() != l || b.getMonth() + 1 != h || b.getDate() != u)throw"Invalid date";
            return b
        },
        ATOM: "yy-mm-dd",
        COOKIE: "D, dd M yy",
        ISO_8601: "yy-mm-dd",
        RFC_822: "D, d M y",
        RFC_850: "DD, dd-M-y",
        RFC_1036: "D, d M y",
        RFC_1123: "D, d M yy",
        RFC_2822: "D, d M yy",
        RSS: "D, d M y",
        TICKS: "!",
        TIMESTAMP: "@",
        W3C: "yy-mm-dd",
        _ticksTo1970: 1e7 * 60 * 60 * 24 * (718685 + Math.floor(492.5) - Math.floor(19.7) + Math.floor(4.925)),
        formatDate: function (e, t, i) {
            if (!t)return "";
            var n = (i ? i.dayNamesShort : null) || this._defaults.dayNamesShort, s = (i ? i.dayNames : null) || this._defaults.dayNames, r = (i ? i.monthNamesShort : null) || this._defaults.monthNamesShort, a = (i ? i.monthNames : null) || this._defaults.monthNames, o = function (t) {
                var i = p + 1 < e.length && e.charAt(p + 1) == t;
                return i && p++, i
            }, l = function (e, t, i) {
                var n = "" + t;
                if (o(e))for (; n.length < i;)n = "0" + n;
                return n
            }, h = function (e, t, i, n) {
                return o(e) ? n[t] : i[t]
            }, u = "", c = !1;
            if (t)for (var p = 0; p < e.length; p++)if (c) "'" != e.charAt(p) || o("'") ? u += e.charAt(p) : c = !1; else switch (e.charAt(p)) {
                case"d":
                    u += l("d", t.getDate(), 2);
                    break;
                case"D":
                    u += h("D", t.getDay(), n, s);
                    break;
                case"o":
                    u += l("o", Math.round((new Date(t.getFullYear(), t.getMonth(), t.getDate()).getTime() - new Date(t.getFullYear(), 0, 0).getTime()) / 864e5), 3);
                    break;
                case"m":
                    u += l("m", t.getMonth() + 1, 2);
                    break;
                case"M":
                    u += h("M", t.getMonth(), r, a);
                    break;
                case"y":
                    u += o("y") ? t.getFullYear() : (t.getYear() % 100 < 10 ? "0" : "") + t.getYear() % 100;
                    break;
                case"@":
                    u += t.getTime();
                    break;
                case"!":
                    u += 1e4 * t.getTime() + this._ticksTo1970;
                    break;
                case"'":
                    o("'") ? u += "'" : c = !0;
                    break;
                default:
                    u += e.charAt(p)
            }
            return u
        },
        _possibleChars: function (e) {
            for (var t = "", i = !1, n = function (t) {
                var i = s + 1 < e.length && e.charAt(s + 1) == t;
                return i && s++, i
            }, s = 0; s < e.length; s++)if (i) "'" != e.charAt(s) || n("'") ? t += e.charAt(s) : i = !1; else switch (e.charAt(s)) {
                case"d":
                case"m":
                case"y":
                case"@":
                    t += "0123456789";
                    break;
                case"D":
                case"M":
                    return null;
                case"'":
                    n("'") ? t += "'" : i = !0;
                    break;
                default:
                    t += e.charAt(s)
            }
            return t
        },
        _get: function (e, t) {
            return e.settings[t] !== undefined ? e.settings[t] : this._defaults[t]
        },
        _setDateFromField: function (e, t) {
            if (e.input.val() != e.lastVal) {
                var i, n, s = this._get(e, "dateFormat"), r = e.lastVal = e.input ? e.input.val() : null;
                i = n = this._getDefaultDate(e);
                var a = this._getFormatConfig(e);
                try {
                    i = this.parseDate(s, r, a) || n
                } catch (o) {
                    this.log(o), r = t ? "" : r
                }
                e.selectedDay = i.getDate(), e.drawMonth = e.selectedMonth = i.getMonth(), e.drawYear = e.selectedYear = i.getFullYear(), e.currentDay = r ? i.getDate() : 0, e.currentMonth = r ? i.getMonth() : 0, e.currentYear = r ? i.getFullYear() : 0, this._adjustInstDate(e)
            }
        },
        _getDefaultDate: function (e) {
            return this._restrictMinMax(e, this._determineDate(e, this._get(e, "defaultDate"), new Date))
        },
        _determineDate: function (e, t, i) {
            var n = function (e) {
                var t = new Date;
                return t.setDate(t.getDate() + e), t
            }, s = function (t) {
                try {
                    return $.datepicker.parseDate($.datepicker._get(e, "dateFormat"), t, $.datepicker._getFormatConfig(e))
                } catch (i) {
                }
                for (var n = (t.toLowerCase().match(/^c/) ? $.datepicker._getDate(e) : null) || new Date, s = n.getFullYear(), r = n.getMonth(), a = n.getDate(), o = /([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g, l = o.exec(t); l;) {
                    switch (l[2] || "d") {
                        case"d":
                        case"D":
                            a += parseInt(l[1], 10);
                            break;
                        case"w":
                        case"W":
                            a += 7 * parseInt(l[1], 10);
                            break;
                        case"m":
                        case"M":
                            r += parseInt(l[1], 10), a = Math.min(a, $.datepicker._getDaysInMonth(s, r));
                            break;
                        case"y":
                        case"Y":
                            s += parseInt(l[1], 10), a = Math.min(a, $.datepicker._getDaysInMonth(s, r))
                    }
                    l = o.exec(t)
                }
                return new Date(s, r, a)
            }, r = null == t || "" === t ? i : "string" == typeof t ? s(t) : "number" == typeof t ? isNaN(t) ? i : n(t) : new Date(t.getTime());
            return r = r && "Invalid Date" == r.toString() ? i : r, r && (r.setHours(0), r.setMinutes(0), r.setSeconds(0), r.setMilliseconds(0)), this._daylightSavingAdjust(r)
        },
        _daylightSavingAdjust: function (e) {
            return e ? (e.setHours(e.getHours() > 12 ? e.getHours() + 2 : 0), e) : null
        },
        _setDate: function (e, t, i) {
            var n = !t, s = e.selectedMonth, r = e.selectedYear, a = this._restrictMinMax(e, this._determineDate(e, t, new Date));
            e.selectedDay = e.currentDay = a.getDate(), e.drawMonth = e.selectedMonth = e.currentMonth = a.getMonth(), e.drawYear = e.selectedYear = e.currentYear = a.getFullYear(), (s != e.selectedMonth || r != e.selectedYear) && !i && this._notifyChange(e), this._adjustInstDate(e), e.input && e.input.val(n ? "" : this._formatDate(e))
        },
        _getDate: function (e) {
            var t = !e.currentYear || e.input && "" == e.input.val() ? null : this._daylightSavingAdjust(new Date(e.currentYear, e.currentMonth, e.currentDay));
            return t
        },
        _attachHandlers: function (e) {
            var t = this._get(e, "stepMonths"), i = "#" + e.id.replace(/\\\\/g, "\\");
            e.dpDiv.find("[data-handler]").map(function () {
                var e = {
                    prev: function () {
                        window["DP_jQuery_" + dpuuid].datepicker._adjustDate(i, -t, "M")
                    }, next: function () {
                        window["DP_jQuery_" + dpuuid].datepicker._adjustDate(i, +t, "M")
                    }, hide: function () {
                        window["DP_jQuery_" + dpuuid].datepicker._hideDatepicker()
                    }, today: function () {
                        window["DP_jQuery_" + dpuuid].datepicker._gotoToday(i)
                    }, selectDay: function () {
                        return window["DP_jQuery_" + dpuuid].datepicker._selectDay(i, +this.getAttribute("data-month"), +this.getAttribute("data-year"), this), !1
                    }, selectMonth: function () {
                        return window["DP_jQuery_" + dpuuid].datepicker._selectMonthYear(i, this, "M"), !1
                    }, selectYear: function () {
                        return window["DP_jQuery_" + dpuuid].datepicker._selectMonthYear(i, this, "Y"), !1
                    }
                };
                $(this).bind(this.getAttribute("data-event"), e[this.getAttribute("data-handler")])
            })
        },
        _generateHTML: function (e) {
            var t = new Date;
            t = this._daylightSavingAdjust(new Date(t.getFullYear(), t.getMonth(), t.getDate()));
            var i = this._get(e, "isRTL"), n = this._get(e, "showButtonPanel"), s = this._get(e, "hideIfNoPrevNext"), r = this._get(e, "navigationAsDateFormat"), a = this._getNumberOfMonths(e), o = this._get(e, "showCurrentAtPos"), l = this._get(e, "stepMonths"), h = 1 != a[0] || 1 != a[1], u = this._daylightSavingAdjust(e.currentDay ? new Date(e.currentYear, e.currentMonth, e.currentDay) : new Date(9999, 9, 9)), c = this._getMinMaxDate(e, "min"), p = this._getMinMaxDate(e, "max"), d = e.drawMonth - o, f = e.drawYear;
            if (0 > d && (d += 12, f--), p) {
                var m = this._daylightSavingAdjust(new Date(p.getFullYear(), p.getMonth() - a[0] * a[1] + 1, p.getDate()));
                for (m = c && c > m ? c : m; this._daylightSavingAdjust(new Date(f, d, 1)) > m;)d--, 0 > d && (d = 11, f--)
            }
            e.drawMonth = d, e.drawYear = f;
            var g = this._get(e, "prevText");
            g = r ? this.formatDate(g, this._daylightSavingAdjust(new Date(f, d - l, 1)), this._getFormatConfig(e)) : g;
            var y = this._canAdjustMonth(e, -1, f, d) ? '<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="' + g + '"><span class="ui-icon ui-icon-circle-triangle-' + (i ? "e" : "w") + '">' + g + "</span></a>" : s ? "" : '<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="' + g + '"><span class="ui-icon ui-icon-circle-triangle-' + (i ? "e" : "w") + '">' + g + "</span></a>", v = this._get(e, "nextText");
            v = r ? this.formatDate(v, this._daylightSavingAdjust(new Date(f, d + l, 1)), this._getFormatConfig(e)) : v;
            var b = this._canAdjustMonth(e, 1, f, d) ? '<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="' + v + '"><span class="ui-icon ui-icon-circle-triangle-' + (i ? "w" : "e") + '">' + v + "</span></a>" : s ? "" : '<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="' + v + '"><span class="ui-icon ui-icon-circle-triangle-' + (i ? "w" : "e") + '">' + v + "</span></a>", L = this._get(e, "currentText"), w = this._get(e, "gotoCurrent") && e.currentDay ? u : t;
            L = r ? this.formatDate(L, w, this._getFormatConfig(e)) : L;
            var O = e.inline ? "" : '<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">' + this._get(e, "closeText") + "</button>", C = n ? '<div class="ui-datepicker-buttonpane ui-widget-content">' + (i ? O : "") + (this._isInRange(e, w) ? '<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">' + L + "</button>" : "") + (i ? "" : O) + "</div>" : "", x = parseInt(this._get(e, "firstDay"), 10);
            x = isNaN(x) ? 0 : x;
            for (var S = this._get(e, "showWeek"), _ = this._get(e, "dayNames"), T = (this._get(e, "dayNamesShort"), this._get(e, "dayNamesMin")), E = this._get(e, "monthNames"), N = this._get(e, "monthNamesShort"), P = this._get(e, "beforeShowDay"), M = this._get(e, "showOtherMonths"), k = this._get(e, "selectOtherMonths"), F = (this._get(e, "calculateWeek") || this.iso8601Week, this._getDefaultDate(e)), D = "", A = 0; A < a[0]; A++) {
                var I = "";
                this.maxRows = 4;
                for (var R = 0; R < a[1]; R++) {
                    var z = this._daylightSavingAdjust(new Date(f, d, e.selectedDay)), B = " ui-corner-all", U = "";
                    if (h) {
                        if (U += '<div class="ui-datepicker-group', a[1] > 1)switch (R) {
                            case 0:
                                U += " ui-datepicker-group-first", B = " ui-corner-" + (i ? "right" : "left");
                                break;
                            case a[1] - 1:
                                U += " ui-datepicker-group-last", B = " ui-corner-" + (i ? "left" : "right");
                                break;
                            default:
                                U += " ui-datepicker-group-middle", B = ""
                        }
                        U += '">'
                    }
                    U += '<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix' + B + '">' + (/all|left/.test(B) && 0 == A ? i ? b : y : "") + (/all|right/.test(B) && 0 == A ? i ? y : b : "") + this._generateMonthYearHeader(e, d, f, c, p, A > 0 || R > 0, E, N) + '</div><table class="ui-datepicker-calendar"><thead>' + "<tr>";
                    for (var j = S ? '<th class="ui-datepicker-week-col">' + this._get(e, "weekHeader") + "</th>" : "", H = 0; 7 > H; H++) {
                        var G = (H + x) % 7;
                        j += "<th" + ((H + x + 6) % 7 >= 5 ? ' class="ui-datepicker-week-end"' : "") + ">" + '<span title="' + _[G] + '">' + T[G] + "</span></th>"
                    }
                    U += j + "</tr></thead><tbody>";
                    var W = this._getDaysInMonth(f, d);
                    f == e.selectedYear && d == e.selectedMonth && (e.selectedDay = Math.min(e.selectedDay, W));
                    var V = (this._getFirstDayOfMonth(f, d) - x + 7) % 7, q = Math.ceil((V + W) / 7), X = h ? this.maxRows > q ? this.maxRows : q : q;
                    this.maxRows = X;
                    for (var Y = this._daylightSavingAdjust(new Date(f, d, 1 - V)), Z = 0; X > Z; Z++) {
                        U += "<tr>";
                        for (var K = S ? '<td class="ui-datepicker-week-col">' + this._get(e, "calculateWeek")(Y) + "</td>" : "", H = 0; 7 > H; H++) {
                            var J = P ? P.apply(e.input ? e.input[0] : null, [Y]) : [!0, ""], Q = Y.getMonth() != d, et = Q && !k || !J[0] || c && c > Y || p && Y > p;
                            K += '<td class="' + ((H + x + 6) % 7 >= 5 ? " ui-datepicker-week-end" : "") + (Q ? " ui-datepicker-other-month" : "") + (Y.getTime() == z.getTime() && d == e.selectedMonth && e._keyEvent || F.getTime() == Y.getTime() && F.getTime() == z.getTime() ? " " + this._dayOverClass : "") + (et ? " " + this._unselectableClass + " ui-state-disabled" : "") + (Q && !M ? "" : " " + J[1] + (Y.getTime() == u.getTime() ? " " + this._currentClass : "") + (Y.getTime() == t.getTime() ? " ui-datepicker-today" : "")) + '"' + (Q && !M || !J[2] ? "" : ' title="' + J[2] + '"') + (et ? "" : ' data-handler="selectDay" data-event="click" data-month="' + Y.getMonth() + '" data-year="' + Y.getFullYear() + '"') + ">" + (Q && !M ? "&#xa0;" : et ? '<span class="ui-state-default">' + Y.getDate() + "</span>" : '<a class="ui-state-default' + (Y.getTime() == t.getTime() ? " ui-state-highlight" : "") + (Y.getTime() == u.getTime() ? " ui-state-active" : "") + (Q ? " ui-priority-secondary" : "") + '" href="#">' + Y.getDate() + "</a>") + "</td>", Y.setDate(Y.getDate() + 1), Y = this._daylightSavingAdjust(Y)
                        }
                        U += K + "</tr>"
                    }
                    d++, d > 11 && (d = 0, f++), U += "</tbody></table>" + (h ? "</div>" + (a[0] > 0 && R == a[1] - 1 ? '<div class="ui-datepicker-row-break"></div>' : "") : ""), I += U
                }
                D += I
            }
            return D += C + ($.ui.ie6 && !e.inline ? '<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>' : ""), e._keyEvent = !1, D
        },
        _generateMonthYearHeader: function (e, t, i, n, s, r, a, o) {
            var l = this._get(e, "changeMonth"), h = this._get(e, "changeYear"), u = this._get(e, "showMonthAfterYear"), c = '<div class="ui-datepicker-title">', p = "";
            if (r || !l) p += '<span class="ui-datepicker-month">' + a[t] + "</span>"; else {
                var d = n && n.getFullYear() == i, f = s && s.getFullYear() == i;
                p += '<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">';
                for (var m = 0; 12 > m; m++)(!d || m >= n.getMonth()) && (!f || m <= s.getMonth()) && (p += '<option value="' + m + '"' + (m == t ? ' selected="selected"' : "") + ">" + o[m] + "</option>");
                p += "</select>"
            }
            if (u || (c += p + (!r && l && h ? "" : "&#xa0;")), !e.yearshtml)if (e.yearshtml = "", r || !h) c += '<span class="ui-datepicker-year">' + i + "</span>"; else {
                var g = this._get(e, "yearRange").split(":"), y = (new Date).getFullYear(), v = function (e) {
                    var t = e.match(/c[+-].*/) ? i + parseInt(e.substring(1), 10) : e.match(/[+-].*/) ? y + parseInt(e, 10) : parseInt(e, 10);
                    return isNaN(t) ? y : t
                }, b = v(g[0]), L = Math.max(b, v(g[1] || ""));
                for (b = n ? Math.max(b, n.getFullYear()) : b, L = s ? Math.min(L, s.getFullYear()) : L, e.yearshtml += '<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">'; L >= b; b++)e.yearshtml += '<option value="' + b + '"' + (b == i ? ' selected="selected"' : "") + ">" + b + "</option>";
                e.yearshtml += "</select>", c += e.yearshtml, e.yearshtml = null
            }
            return c += this._get(e, "yearSuffix"), u && (c += (!r && l && h ? "" : "&#xa0;") + p), c += "</div>"
        },
        _adjustInstDate: function (e, t, i) {
            var n = e.drawYear + ("Y" == i ? t : 0), s = e.drawMonth + ("M" == i ? t : 0), r = Math.min(e.selectedDay, this._getDaysInMonth(n, s)) + ("D" == i ? t : 0), a = this._restrictMinMax(e, this._daylightSavingAdjust(new Date(n, s, r)));
            e.selectedDay = a.getDate(), e.drawMonth = e.selectedMonth = a.getMonth(), e.drawYear = e.selectedYear = a.getFullYear(), ("M" == i || "Y" == i) && this._notifyChange(e)
        },
        _restrictMinMax: function (e, t) {
            var i = this._getMinMaxDate(e, "min"), n = this._getMinMaxDate(e, "max"), s = i && i > t ? i : t;
            return s = n && s > n ? n : s
        },
        _notifyChange: function (e) {
            var t = this._get(e, "onChangeMonthYear");
            t && t.apply(e.input ? e.input[0] : null, [e.selectedYear, e.selectedMonth + 1, e])
        },
        _getNumberOfMonths: function (e) {
            var t = this._get(e, "numberOfMonths");
            return null == t ? [1, 1] : "number" == typeof t ? [1, t] : t
        },
        _getMinMaxDate: function (e, t) {
            return this._determineDate(e, this._get(e, t + "Date"), null)
        },
        _getDaysInMonth: function (e, t) {
            return 32 - this._daylightSavingAdjust(new Date(e, t, 32)).getDate()
        },
        _getFirstDayOfMonth: function (e, t) {
            return new Date(e, t, 1).getDay()
        },
        _canAdjustMonth: function (e, t, i, n) {
            var s = this._getNumberOfMonths(e), r = this._daylightSavingAdjust(new Date(i, n + (0 > t ? t : s[0] * s[1]), 1));
            return 0 > t && r.setDate(this._getDaysInMonth(r.getFullYear(), r.getMonth())), this._isInRange(e, r)
        },
        _isInRange: function (e, t) {
            var i = this._getMinMaxDate(e, "min"), n = this._getMinMaxDate(e, "max");
            return (!i || t.getTime() >= i.getTime()) && (!n || t.getTime() <= n.getTime())
        },
        _getFormatConfig: function (e) {
            var t = this._get(e, "shortYearCutoff");
            return t = "string" != typeof t ? t : (new Date).getFullYear() % 100 + parseInt(t, 10), {
                shortYearCutoff: t,
                dayNamesShort: this._get(e, "dayNamesShort"),
                dayNames: this._get(e, "dayNames"),
                monthNamesShort: this._get(e, "monthNamesShort"),
                monthNames: this._get(e, "monthNames")
            }
        },
        _formatDate: function (e, t, i, n) {
            t || (e.currentDay = e.selectedDay, e.currentMonth = e.selectedMonth, e.currentYear = e.selectedYear);
            var s = t ? "object" == typeof t ? t : this._daylightSavingAdjust(new Date(n, i, t)) : this._daylightSavingAdjust(new Date(e.currentYear, e.currentMonth, e.currentDay));
            return this.formatDate(this._get(e, "dateFormat"), s, this._getFormatConfig(e))
        }
    }), $.fn.datepicker = function (e) {
        if (!this.length)return this;
        $.datepicker.initialized || ($(document).mousedown($.datepicker._checkExternalClick).find(document.body).append($.datepicker.dpDiv), $.datepicker.initialized = !0);
        var t = Array.prototype.slice.call(arguments, 1);
        return "string" != typeof e || "isDisabled" != e && "getDate" != e && "widget" != e ? "option" == e && 2 == arguments.length && "string" == typeof arguments[1] ? $.datepicker["_" + e + "Datepicker"].apply($.datepicker, [this[0]].concat(t)) : this.each(function () {
            "string" == typeof e ? $.datepicker["_" + e + "Datepicker"].apply($.datepicker, [this].concat(t)) : $.datepicker._attachDatepicker(this, e)
        }) : $.datepicker["_" + e + "Datepicker"].apply($.datepicker, [this[0]].concat(t))
    }, $.datepicker = new Datepicker, $.datepicker.initialized = !1, $.datepicker.uuid = (new Date).getTime(), $.datepicker.version = "1.9.2", window["DP_jQuery_" + dpuuid] = $
}(jQuery), function (e, t) {
    var i = "ui-dialog ui-widget ui-widget-content ui-corner-all ", n = {
        buttons: !0,
        height: !0,
        maxHeight: !0,
        maxWidth: !0,
        minHeight: !0,
        minWidth: !0,
        width: !0
    }, s = {maxHeight: !0, maxWidth: !0, minHeight: !0, minWidth: !0};
    e.widget("ui.dialog", {
        version: "1.9.2",
        options: {
            autoOpen: !0,
            buttons: {},
            closeOnEscape: !0,
            closeText: "close",
            dialogClass: "",
            draggable: !0,
            hide: null,
            height: "auto",
            maxHeight: !1,
            maxWidth: !1,
            minHeight: 150,
            minWidth: 150,
            modal: !1,
            position: {
                my: "center", at: "center", of: window, collision: "fit", using: function (t) {
                    var i = e(this).css(t).offset().top;
                    0 > i && e(this).css("top", t.top - i)
                }
            },
            resizable: !0,
            show: null,
            stack: !0,
            title: "",
            width: 300,
            zIndex: 1e3
        },
        _create: function () {
            this.originalTitle = this.element.attr("title"), "string" != typeof this.originalTitle && (this.originalTitle = ""), this.oldPosition = {
                parent: this.element.parent(),
                index: this.element.parent().children().index(this.element)
            }, this.options.title = this.options.title || this.originalTitle;
            var t, n, s, r, a, o = this, l = this.options, h = l.title || "&#160;";
            t = (this.uiDialog = e("<div>")).addClass(i + l.dialogClass).css({
                display: "none",
                outline: 0,
                zIndex: l.zIndex
            }).attr("tabIndex", -1).keydown(function (t) {
                l.closeOnEscape && !t.isDefaultPrevented() && t.keyCode && t.keyCode === e.ui.keyCode.ESCAPE && (o.close(t), t.preventDefault())
            }).mousedown(function (e) {
                o.moveToTop(!1, e)
            }).appendTo("body"), this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(t), n = (this.uiDialogTitlebar = e("<div>")).addClass("ui-dialog-titlebar  ui-widget-header  ui-corner-all  ui-helper-clearfix").bind("mousedown", function () {
                t.focus()
            }).prependTo(t), s = e("<a href='#'></a>").addClass("ui-dialog-titlebar-close  ui-corner-all").attr("role", "button").click(function (e) {
                e.preventDefault(), o.close(e)
            }).appendTo(n), (this.uiDialogTitlebarCloseText = e("<span>")).addClass("ui-icon ui-icon-closethick").text(l.closeText).appendTo(s), r = e("<span>").uniqueId().addClass("ui-dialog-title").html(h).prependTo(n), a = (this.uiDialogButtonPane = e("<div>")).addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"), (this.uiButtonSet = e("<div>")).addClass("ui-dialog-buttonset").appendTo(a), t.attr({
                role: "dialog",
                "aria-labelledby": r.attr("id")
            }), n.find("*").add(n).disableSelection(), this._hoverable(s), this._focusable(s), l.draggable && e.fn.draggable && this._makeDraggable(), l.resizable && e.fn.resizable && this._makeResizable(), this._createButtons(l.buttons), this._isOpen = !1, e.fn.bgiframe && t.bgiframe(), this._on(t, {
                keydown: function (i) {
                    if (l.modal && i.keyCode === e.ui.keyCode.TAB) {
                        var n = e(":tabbable", t), s = n.filter(":first"), r = n.filter(":last");
                        return i.target !== r[0] || i.shiftKey ? i.target === s[0] && i.shiftKey ? (r.focus(1), !1) : void 0 : (s.focus(1), !1)
                    }
                }
            })
        },
        _init: function () {
            this.options.autoOpen && this.open()
        },
        _destroy: function () {
            var e, t = this.oldPosition;
            this.overlay && this.overlay.destroy(), this.uiDialog.hide(), this.element.removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"), this.uiDialog.remove(), this.originalTitle && this.element.attr("title", this.originalTitle), e = t.parent.children().eq(t.index), e.length && e[0] !== this.element[0] ? e.before(this.element) : t.parent.append(this.element)
        },
        widget: function () {
            return this.uiDialog
        },
        close: function (t) {
            var i, n, s = this;
            if (this._isOpen && !1 !== this._trigger("beforeClose", t))return this._isOpen = !1, this.overlay && this.overlay.destroy(), this.options.hide ? this._hide(this.uiDialog, this.options.hide, function () {
                s._trigger("close", t)
            }) : (this.uiDialog.hide(), this._trigger("close", t)), e.ui.dialog.overlay.resize(), this.options.modal && (i = 0, e(".ui-dialog").each(function () {
                this !== s.uiDialog[0] && (n = e(this).css("z-index"), isNaN(n) || (i = Math.max(i, n)))
            }), e.ui.dialog.maxZ = i), this
        },
        isOpen: function () {
            return this._isOpen
        },
        moveToTop: function (t, i) {
            var n, s = this.options;
            return s.modal && !t || !s.stack && !s.modal ? this._trigger("focus", i) : (s.zIndex > e.ui.dialog.maxZ && (e.ui.dialog.maxZ = s.zIndex), this.overlay && (e.ui.dialog.maxZ += 1, e.ui.dialog.overlay.maxZ = e.ui.dialog.maxZ, this.overlay.$el.css("z-index", e.ui.dialog.overlay.maxZ)), n = {
                scrollTop: this.element.scrollTop(),
                scrollLeft: this.element.scrollLeft()
            }, e.ui.dialog.maxZ += 1, this.uiDialog.css("z-index", e.ui.dialog.maxZ), this.element.attr(n), this._trigger("focus", i), this)
        },
        open: function () {
            if (!this._isOpen) {
                var t, i = this.options, n = this.uiDialog;
                return this._size(), this._position(i.position), n.show(i.show), this.overlay = i.modal ? new e.ui.dialog.overlay(this) : null, this.moveToTop(!0), t = this.element.find(":tabbable"), t.length || (t = this.uiDialogButtonPane.find(":tabbable"), t.length || (t = n)), t.eq(0).focus(), this._isOpen = !0, this._trigger("open"), this
            }
        },
        _createButtons: function (t) {
            var i = this, n = !1;
            this.uiDialogButtonPane.remove(), this.uiButtonSet.empty(), "object" == typeof t && null !== t && e.each(t, function () {
                return !(n = !0)
            }), n ? (e.each(t, function (t, n) {
                var s, r;
                n = e.isFunction(n) ? {
                    click: n,
                    text: t
                } : n, n = e.extend({type: "button"}, n), r = n.click, n.click = function () {
                    r.apply(i.element[0], arguments)
                }, s = e("<button></button>", n).appendTo(i.uiButtonSet), e.fn.button && s.button()
            }), this.uiDialog.addClass("ui-dialog-buttons"), this.uiDialogButtonPane.appendTo(this.uiDialog)) : this.uiDialog.removeClass("ui-dialog-buttons")
        },
        _makeDraggable: function () {
            function t(e) {
                return {position: e.position, offset: e.offset}
            }

            var i = this, n = this.options;
            this.uiDialog.draggable({
                cancel: ".ui-dialog-content, .ui-dialog-titlebar-close",
                handle: ".ui-dialog-titlebar",
                containment: "document",
                start: function (n, s) {
                    e(this).addClass("ui-dialog-dragging"), i._trigger("dragStart", n, t(s))
                },
                drag: function (e, n) {
                    i._trigger("drag", e, t(n))
                },
                stop: function (s, r) {
                    n.position = [r.position.left - i.document.scrollLeft(), r.position.top - i.document.scrollTop()], e(this).removeClass("ui-dialog-dragging"), i._trigger("dragStop", s, t(r)), e.ui.dialog.overlay.resize()
                }
            })
        },
        _makeResizable: function (i) {
            function n(e) {
                return {
                    originalPosition: e.originalPosition,
                    originalSize: e.originalSize,
                    position: e.position,
                    size: e.size
                }
            }

            i = i === t ? this.options.resizable : i;
            var s = this, r = this.options, a = this.uiDialog.css("position"), o = "string" == typeof i ? i : "n,e,s,w,se,sw,ne,nw";
            this.uiDialog.resizable({
                cancel: ".ui-dialog-content",
                containment: "document",
                alsoResize: this.element,
                maxWidth: r.maxWidth,
                maxHeight: r.maxHeight,
                minWidth: r.minWidth,
                minHeight: this._minHeight(),
                handles: o,
                start: function (t, i) {
                    e(this).addClass("ui-dialog-resizing"), s._trigger("resizeStart", t, n(i))
                },
                resize: function (e, t) {
                    s._trigger("resize", e, n(t))
                },
                stop: function (t, i) {
                    e(this).removeClass("ui-dialog-resizing"), r.height = e(this).height(), r.width = e(this).width(), s._trigger("resizeStop", t, n(i)), e.ui.dialog.overlay.resize()
                }
            }).css("position", a).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")
        },
        _minHeight: function () {
            var e = this.options;
            return "auto" === e.height ? e.minHeight : Math.min(e.minHeight, e.height)
        },
        _position: function (t) {
            var i, n = [], s = [0, 0];
            t ? (("string" == typeof t || "object" == typeof t && "0" in t) && (n = t.split ? t.split(" ") : [t[0], t[1]], 1 === n.length && (n[1] = n[0]), e.each(["left", "top"], function (e, t) {
                +n[e] === n[e] && (s[e] = n[e], n[e] = t)
            }), t = {
                my: n[0] + (s[0] < 0 ? s[0] : "+" + s[0]) + " " + n[1] + (s[1] < 0 ? s[1] : "+" + s[1]),
                at: n.join(" ")
            }), t = e.extend({}, e.ui.dialog.prototype.options.position, t)) : t = e.ui.dialog.prototype.options.position, i = this.uiDialog.is(":visible"), i || this.uiDialog.show(), this.uiDialog.position(t), i || this.uiDialog.hide()
        },
        _setOptions: function (t) {
            var i = this, r = {}, a = !1;
            e.each(t, function (e, t) {
                i._setOption(e, t), e in n && (a = !0), e in s && (r[e] = t)
            }), a && this._size(), this.uiDialog.is(":data(resizable)") && this.uiDialog.resizable("option", r)
        },
        _setOption: function (t, n) {
            var s, r, a = this.uiDialog;
            switch (t) {
                case"buttons":
                    this._createButtons(n);
                    break;
                case"closeText":
                    this.uiDialogTitlebarCloseText.text("" + n);
                    break;
                case"dialogClass":
                    a.removeClass(this.options.dialogClass).addClass(i + n);
                    break;
                case"disabled":
                    n ? a.addClass("ui-dialog-disabled") : a.removeClass("ui-dialog-disabled");
                    break;
                case"draggable":
                    s = a.is(":data(draggable)"), s && !n && a.draggable("destroy"), !s && n && this._makeDraggable();
                    break;
                case"position":
                    this._position(n);
                    break;
                case"resizable":
                    r = a.is(":data(resizable)"), r && !n && a.resizable("destroy"), r && "string" == typeof n && a.resizable("option", "handles", n), !r && n !== !1 && this._makeResizable(n);
                    break;
                case"title":
                    e(".ui-dialog-title", this.uiDialogTitlebar).html("" + (n || "&#160;"))
            }
            this._super(t, n)
        },
        _size: function () {
            var t, i, n, s = this.options, r = this.uiDialog.is(":visible");
            this.element.show().css({
                width: "auto",
                minHeight: 0,
                height: 0
            }), s.minWidth > s.width && (s.width = s.minWidth), t = this.uiDialog.css({
                height: "auto",
                width: s.width
            }).outerHeight(), i = Math.max(0, s.minHeight - t), "auto" === s.height ? e.support.minHeight ? this.element.css({
                minHeight: i,
                height: "auto"
            }) : (this.uiDialog.show(), n = this.element.css("height", "auto").height(), r || this.uiDialog.hide(), this.element.height(Math.max(n, i))) : this.element.height(Math.max(s.height - t, 0)), this.uiDialog.is(":data(resizable)") && this.uiDialog.resizable("option", "minHeight", this._minHeight())
        }
    }), e.extend(e.ui.dialog, {
        uuid: 0, maxZ: 0, getTitleId: function (e) {
            var t = e.attr("id");
            return t || (this.uuid += 1, t = this.uuid), "ui-dialog-title-" + t
        }, overlay: function (t) {
            this.$el = e.ui.dialog.overlay.create(t)
        }
    }), e.extend(e.ui.dialog.overlay, {
        instances: [],
        oldInstances: [],
        maxZ: 0,
        events: e.map("focus,mousedown,mouseup,keydown,keypress,click".split(","), function (e) {
            return e + ".dialog-overlay"
        }).join(" "),
        create: function (t) {
            0 === this.instances.length && (setTimeout(function () {
                e.ui.dialog.overlay.instances.length && e(document).bind(e.ui.dialog.overlay.events, function (t) {
                    return e(t.target).zIndex() < e.ui.dialog.overlay.maxZ ? !1 : void 0
                })
            }, 1), e(window).bind("resize.dialog-overlay", e.ui.dialog.overlay.resize));
            var i = this.oldInstances.pop() || e("<div>").addClass("ui-widget-overlay");
            return e(document).bind("keydown.dialog-overlay", function (n) {
                var s = e.ui.dialog.overlay.instances;
                0 !== s.length && s[s.length - 1] === i && t.options.closeOnEscape && !n.isDefaultPrevented() && n.keyCode && n.keyCode === e.ui.keyCode.ESCAPE && (t.close(n), n.preventDefault())
            }), i.appendTo(document.body).css({
                width: this.width(),
                height: this.height()
            }), e.fn.bgiframe && i.bgiframe(), this.instances.push(i), i
        },
        destroy: function (t) {
            var i = e.inArray(t, this.instances), n = 0;
            -1 !== i && this.oldInstances.push(this.instances.splice(i, 1)[0]), 0 === this.instances.length && e([document, window]).unbind(".dialog-overlay"), t.height(0).width(0).remove(), e.each(this.instances, function () {
                n = Math.max(n, this.css("z-index"))
            }), this.maxZ = n
        },
        height: function () {
            var t, i;
            return e.ui.ie ? (t = Math.max(document.documentElement.scrollHeight, document.body.scrollHeight), i = Math.max(document.documentElement.offsetHeight, document.body.offsetHeight), i > t ? e(window).height() + "px" : t + "px") : e(document).height() + "px"
        },
        width: function () {
            var t, i;
            return e.ui.ie ? (t = Math.max(document.documentElement.scrollWidth, document.body.scrollWidth), i = Math.max(document.documentElement.offsetWidth, document.body.offsetWidth), i > t ? e(window).width() + "px" : t + "px") : e(document).width() + "px"
        },
        resize: function () {
            var t = e([]);
            e.each(e.ui.dialog.overlay.instances, function () {
                t = t.add(this)
            }), t.css({width: 0, height: 0}).css({
                width: e.ui.dialog.overlay.width(),
                height: e.ui.dialog.overlay.height()
            })
        }
    }), e.extend(e.ui.dialog.overlay.prototype, {
        destroy: function () {
            e.ui.dialog.overlay.destroy(this.$el)
        }
    })
}(jQuery), function (e) {
    var t = !1;
    e.widget("ui.menu", {
        version: "1.9.2",
        defaultElement: "<ul>",
        delay: 300,
        options: {
            icons: {submenu: "ui-icon-carat-1-e"},
            menus: "ul",
            position: {my: "left top", at: "right top"},
            role: "menu",
            blur: null,
            focus: null,
            select: null
        },
        _create: function () {
            this.activeMenu = this.element, this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons", !!this.element.find(".ui-icon").length).attr({
                role: this.options.role,
                tabIndex: 0
            }).bind("click" + this.eventNamespace, e.proxy(function (e) {
                this.options.disabled && e.preventDefault()
            }, this)), this.options.disabled && this.element.addClass("ui-state-disabled").attr("aria-disabled", "true"), this._on({
                "mousedown .ui-menu-item > a": function (e) {
                    e.preventDefault()
                }, "click .ui-state-disabled > a": function (e) {
                    e.preventDefault()
                }, "click .ui-menu-item:has(a)": function (i) {
                    var n = e(i.target).closest(".ui-menu-item");
                    !t && n.not(".ui-state-disabled").length && (t = !0, this.select(i), n.has(".ui-menu").length ? this.expand(i) : this.element.is(":focus") || (this.element.trigger("focus", [!0]), this.active && 1 === this.active.parents(".ui-menu").length && clearTimeout(this.timer)))
                }, "mouseenter .ui-menu-item": function (t) {
                    var i = e(t.currentTarget);
                    i.siblings().children(".ui-state-active").removeClass("ui-state-active"), this.focus(t, i)
                }, mouseleave: "collapseAll", "mouseleave .ui-menu": "collapseAll", focus: function (e, t) {
                    var i = this.active || this.element.children(".ui-menu-item").eq(0);
                    t || this.focus(e, i)
                }, blur: function (t) {
                    this._delay(function () {
                        e.contains(this.element[0], this.document[0].activeElement) || this.collapseAll(t)
                    })
                }, keydown: "_keydown"
            }), this.refresh(), this._on(this.document, {
                click: function (i) {
                    e(i.target).closest(".ui-menu").length || this.collapseAll(i), t = !1
                }
            })
        },
        _destroy: function () {
            this.element.removeAttr("aria-activedescendant").find(".ui-menu").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(), this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function () {
                var t = e(this);
                t.data("ui-menu-submenu-carat") && t.remove()
            }), this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")
        },
        _keydown: function (t) {
            function i(e) {
                return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&")
            }

            var n, s, r, a, o, l = !0;
            switch (t.keyCode) {
                case e.ui.keyCode.PAGE_UP:
                    this.previousPage(t);
                    break;
                case e.ui.keyCode.PAGE_DOWN:
                    this.nextPage(t);
                    break;
                case e.ui.keyCode.HOME:
                    this._move("first", "first", t);
                    break;
                case e.ui.keyCode.END:
                    this._move("last", "last", t);
                    break;
                case e.ui.keyCode.UP:
                    this.previous(t);
                    break;
                case e.ui.keyCode.DOWN:
                    this.next(t);
                    break;
                case e.ui.keyCode.LEFT:
                    this.collapse(t);
                    break;
                case e.ui.keyCode.RIGHT:
                    this.active && !this.active.is(".ui-state-disabled") && this.expand(t);
                    break;
                case e.ui.keyCode.ENTER:
                case e.ui.keyCode.SPACE:
                    this._activate(t);
                    break;
                case e.ui.keyCode.ESCAPE:
                    this.collapse(t);
                    break;
                default:
                    l = !1, s = this.previousFilter || "", r = String.fromCharCode(t.keyCode), a = !1, clearTimeout(this.filterTimer), r === s ? a = !0 : r = s + r, o = new RegExp("^" + i(r), "i"), n = this.activeMenu.children(".ui-menu-item").filter(function () {
                        return o.test(e(this).children("a").text())
                    }), n = a && -1 !== n.index(this.active.next()) ? this.active.nextAll(".ui-menu-item") : n, n.length || (r = String.fromCharCode(t.keyCode), o = new RegExp("^" + i(r), "i"), n = this.activeMenu.children(".ui-menu-item").filter(function () {
                        return o.test(e(this).children("a").text())
                    })), n.length ? (this.focus(t, n), n.length > 1 ? (this.previousFilter = r, this.filterTimer = this._delay(function () {
                        delete this.previousFilter
                    }, 1e3)) : delete this.previousFilter) : delete this.previousFilter
            }
            l && t.preventDefault()
        },
        _activate: function (e) {
            this.active.is(".ui-state-disabled") || (this.active.children("a[aria-haspopup='true']").length ? this.expand(e) : this.select(e))
        },
        refresh: function () {
            var t, i = this.options.icons.submenu, n = this.element.find(this.options.menus);
            n.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({
                role: this.options.role,
                "aria-hidden": "true",
                "aria-expanded": "false"
            }).each(function () {
                var t = e(this), n = t.prev("a"), s = e("<span>").addClass("ui-menu-icon ui-icon " + i).data("ui-menu-submenu-carat", !0);
                n.attr("aria-haspopup", "true").prepend(s), t.attr("aria-labelledby", n.attr("id"))
            }), t = n.add(this.element), t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role", "presentation").children("a").uniqueId().addClass("ui-corner-all").attr({
                tabIndex: -1,
                role: this._itemRole()
            }), t.children(":not(.ui-menu-item)").each(function () {
                var t = e(this);
                /[^\-—–\s]/.test(t.text()) || t.addClass("ui-widget-content ui-menu-divider")
            }), t.children(".ui-state-disabled").attr("aria-disabled", "true"), this.active && !e.contains(this.element[0], this.active[0]) && this.blur()
        },
        _itemRole: function () {
            return {menu: "menuitem", listbox: "option"}[this.options.role]
        },
        focus: function (e, t) {
            var i, n;
            this.blur(e, e && "focus" === e.type), this._scrollIntoView(t), this.active = t.first(), n = this.active.children("a").addClass("ui-state-focus"), this.options.role && this.element.attr("aria-activedescendant", n.attr("id")), this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"), e && "keydown" === e.type ? this._close() : this.timer = this._delay(function () {
                this._close()
            }, this.delay), i = t.children(".ui-menu"), i.length && /^mouse/.test(e.type) && this._startOpening(i), this.activeMenu = t.parent(), this._trigger("focus", e, {item: t})
        },
        _scrollIntoView: function (t) {
            var i, n, s, r, a, o;
            this._hasScroll() && (i = parseFloat(e.css(this.activeMenu[0], "borderTopWidth")) || 0, n = parseFloat(e.css(this.activeMenu[0], "paddingTop")) || 0, s = t.offset().top - this.activeMenu.offset().top - i - n, r = this.activeMenu.scrollTop(), a = this.activeMenu.height(), o = t.height(), 0 > s ? this.activeMenu.scrollTop(r + s) : s + o > a && this.activeMenu.scrollTop(r + s - a + o))
        },
        blur: function (e, t) {
            t || clearTimeout(this.timer), this.active && (this.active.children("a").removeClass("ui-state-focus"), this.active = null, this._trigger("blur", e, {item: this.active}))
        },
        _startOpening: function (e) {
            clearTimeout(this.timer), "true" === e.attr("aria-hidden") && (this.timer = this._delay(function () {
                this._close(), this._open(e)
            }, this.delay))
        },
        _open: function (t) {
            var i = e.extend({of: this.active}, this.options.position);
            clearTimeout(this.timer), this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden", "true"), t.show().removeAttr("aria-hidden").attr("aria-expanded", "true").position(i)
        },
        collapseAll: function (t, i) {
            clearTimeout(this.timer), this.timer = this._delay(function () {
                var n = i ? this.element : e(t && t.target).closest(this.element.find(".ui-menu"));
                n.length || (n = this.element), this._close(n), this.blur(t), this.activeMenu = n
            }, this.delay)
        },
        _close: function (e) {
            e || (e = this.active ? this.active.parent() : this.element), e.find(".ui-menu").hide().attr("aria-hidden", "true").attr("aria-expanded", "false").end().find("a.ui-state-active").removeClass("ui-state-active")
        },
        collapse: function (e) {
            var t = this.active && this.active.parent().closest(".ui-menu-item", this.element);
            t && t.length && (this._close(), this.focus(e, t))
        },
        expand: function (e) {
            var t = this.active && this.active.children(".ui-menu ").children(".ui-menu-item").first();
            t && t.length && (this._open(t.parent()), this._delay(function () {
                this.focus(e, t)
            }))
        },
        next: function (e) {
            this._move("next", "first", e)
        },
        previous: function (e) {
            this._move("prev", "last", e)
        },
        isFirstItem: function () {
            return this.active && !this.active.prevAll(".ui-menu-item").length
        },
        isLastItem: function () {
            return this.active && !this.active.nextAll(".ui-menu-item").length
        },
        _move: function (e, t, i) {
            var n;
            this.active && (n = "first" === e || "last" === e ? this.active["first" === e ? "prevAll" : "nextAll"](".ui-menu-item").eq(-1) : this.active[e + "All"](".ui-menu-item").eq(0)), n && n.length && this.active || (n = this.activeMenu.children(".ui-menu-item")[t]()), this.focus(i, n)
        },
        nextPage: function (t) {
            var i, n, s;
            return this.active ? (this.isLastItem() || (this._hasScroll() ? (n = this.active.offset().top, s = this.element.height(), this.active.nextAll(".ui-menu-item").each(function () {
                return i = e(this), i.offset().top - n - s < 0
            }), this.focus(t, i)) : this.focus(t, this.activeMenu.children(".ui-menu-item")[this.active ? "last" : "first"]())), void 0) : (this.next(t), void 0)
        },
        previousPage: function (t) {
            var i, n, s;
            return this.active ? (this.isFirstItem() || (this._hasScroll() ? (n = this.active.offset().top, s = this.element.height(), this.active.prevAll(".ui-menu-item").each(function () {
                return i = e(this), i.offset().top - n + s > 0
            }), this.focus(t, i)) : this.focus(t, this.activeMenu.children(".ui-menu-item").first())), void 0) : (this.next(t), void 0)
        },
        _hasScroll: function () {
            return this.element.outerHeight() < this.element.prop("scrollHeight")
        },
        select: function (t) {
            this.active = this.active || e(t.target).closest(".ui-menu-item");
            var i = {item: this.active};
            this.active.has(".ui-menu").length || this.collapseAll(t, !0), this._trigger("select", t, i)
        }
    })
}(jQuery), function (e, t) {
    e.widget("ui.progressbar", {
        version: "1.9.2", options: {value: 0, max: 100}, min: 0, _create: function () {
            this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({
                role: "progressbar",
                "aria-valuemin": this.min,
                "aria-valuemax": this.options.max,
                "aria-valuenow": this._value()
            }), this.valueDiv = e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element), this.oldValue = this._value(), this._refreshValue()
        }, _destroy: function () {
            this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"), this.valueDiv.remove()
        }, value: function (e) {
            return e === t ? this._value() : (this._setOption("value", e), this)
        }, _setOption: function (e, t) {
            "value" === e && (this.options.value = t, this._refreshValue(), this._value() === this.options.max && this._trigger("complete")), this._super(e, t)
        }, _value: function () {
            var e = this.options.value;
            return "number" != typeof e && (e = 0), Math.min(this.options.max, Math.max(this.min, e))
        }, _percentage: function () {
            return 100 * this._value() / this.options.max
        }, _refreshValue: function () {
            var e = this.value(), t = this._percentage();
            this.oldValue !== e && (this.oldValue = e, this._trigger("change")), this.valueDiv.toggle(e > this.min).toggleClass("ui-corner-right", e === this.options.max).width(t.toFixed(0) + "%"), this.element.attr("aria-valuenow", e)
        }
    })
}(jQuery), function (e) {
    var t = 5;
    e.widget("ui.slider", e.ui.mouse, {
        version: "1.9.2",
        widgetEventPrefix: "slide",
        options: {
            animate: !1,
            distance: 0,
            max: 100,
            min: 0,
            orientation: "horizontal",
            range: !1,
            step: 1,
            value: 0,
            values: null
        },
        _create: function () {
            var i, n, s = this.options, r = this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"), a = "<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>", o = [];
            for (this._keySliding = !1, this._mouseSliding = !1, this._animateOff = !0, this._handleIndex = null, this._detectOrientation(), this._mouseInit(), this.element.addClass("ui-slider ui-slider-" + this.orientation + " ui-widget" + " ui-widget-content" + " ui-corner-all" + (s.disabled ? " ui-slider-disabled ui-disabled" : "")), this.range = e([]), s.range && (s.range === !0 && (s.values || (s.values = [this._valueMin(), this._valueMin()]), s.values.length && 2 !== s.values.length && (s.values = [s.values[0], s.values[0]])), this.range = e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header" + ("min" === s.range || "max" === s.range ? " ui-slider-range-" + s.range : ""))), n = s.values && s.values.length || 1, i = r.length; n > i; i++)o.push(a);
            this.handles = r.add(e(o.join("")).appendTo(this.element)), this.handle = this.handles.eq(0), this.handles.add(this.range).filter("a").click(function (e) {
                e.preventDefault()
            }).mouseenter(function () {
                s.disabled || e(this).addClass("ui-state-hover")
            }).mouseleave(function () {
                e(this).removeClass("ui-state-hover")
            }).focus(function () {
                s.disabled ? e(this).blur() : (e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"), e(this).addClass("ui-state-focus"))
            }).blur(function () {
                e(this).removeClass("ui-state-focus")
            }), this.handles.each(function (t) {
                e(this).data("ui-slider-handle-index", t)
            }), this._on(this.handles, {
                keydown: function (i) {
                    var n, s, r, a, o = e(i.target).data("ui-slider-handle-index");
                    switch (i.keyCode) {
                        case e.ui.keyCode.HOME:
                        case e.ui.keyCode.END:
                        case e.ui.keyCode.PAGE_UP:
                        case e.ui.keyCode.PAGE_DOWN:
                        case e.ui.keyCode.UP:
                        case e.ui.keyCode.RIGHT:
                        case e.ui.keyCode.DOWN:
                        case e.ui.keyCode.LEFT:
                            if (i.preventDefault(), !this._keySliding && (this._keySliding = !0, e(i.target).addClass("ui-state-active"), n = this._start(i, o), n === !1))return
                    }
                    switch (a = this.options.step, s = r = this.options.values && this.options.values.length ? this.values(o) : this.value(), i.keyCode) {
                        case e.ui.keyCode.HOME:
                            r = this._valueMin();
                            break;
                        case e.ui.keyCode.END:
                            r = this._valueMax();
                            break;
                        case e.ui.keyCode.PAGE_UP:
                            r = this._trimAlignValue(s + (this._valueMax() - this._valueMin()) / t);
                            break;
                        case e.ui.keyCode.PAGE_DOWN:
                            r = this._trimAlignValue(s - (this._valueMax() - this._valueMin()) / t);
                            break;
                        case e.ui.keyCode.UP:
                        case e.ui.keyCode.RIGHT:
                            if (s === this._valueMax())return;
                            r = this._trimAlignValue(s + a);
                            break;
                        case e.ui.keyCode.DOWN:
                        case e.ui.keyCode.LEFT:
                            if (s === this._valueMin())return;
                            r = this._trimAlignValue(s - a)
                    }
                    this._slide(i, o, r)
                }, keyup: function (t) {
                    var i = e(t.target).data("ui-slider-handle-index");
                    this._keySliding && (this._keySliding = !1, this._stop(t, i), this._change(t, i), e(t.target).removeClass("ui-state-active"))
                }
            }), this._refreshValue(), this._animateOff = !1
        },
        _destroy: function () {
            this.handles.remove(), this.range.remove(), this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all"), this._mouseDestroy()
        },
        _mouseCapture: function (t) {
            var i, n, s, r, a, o, l, h, u = this, c = this.options;
            return c.disabled ? !1 : (this.elementSize = {
                width: this.element.outerWidth(),
                height: this.element.outerHeight()
            }, this.elementOffset = this.element.offset(), i = {
                x: t.pageX,
                y: t.pageY
            }, n = this._normValueFromMouse(i), s = this._valueMax() - this._valueMin() + 1, this.handles.each(function (t) {
                var i = Math.abs(n - u.values(t));
                s > i && (s = i, r = e(this), a = t)
            }), c.range === !0 && this.values(1) === c.min && (a += 1, r = e(this.handles[a])), o = this._start(t, a), o === !1 ? !1 : (this._mouseSliding = !0, this._handleIndex = a, r.addClass("ui-state-active").focus(), l = r.offset(), h = !e(t.target).parents().andSelf().is(".ui-slider-handle"), this._clickOffset = h ? {
                left: 0,
                top: 0
            } : {
                left: t.pageX - l.left - r.width() / 2,
                top: t.pageY - l.top - r.height() / 2 - (parseInt(r.css("borderTopWidth"), 10) || 0) - (parseInt(r.css("borderBottomWidth"), 10) || 0) + (parseInt(r.css("marginTop"), 10) || 0)
            }, this.handles.hasClass("ui-state-hover") || this._slide(t, a, n), this._animateOff = !0, !0))
        },
        _mouseStart: function () {
            return !0
        },
        _mouseDrag: function (e) {
            var t = {x: e.pageX, y: e.pageY}, i = this._normValueFromMouse(t);
            return this._slide(e, this._handleIndex, i), !1
        },
        _mouseStop: function (e) {
            return this.handles.removeClass("ui-state-active"), this._mouseSliding = !1, this._stop(e, this._handleIndex), this._change(e, this._handleIndex), this._handleIndex = null, this._clickOffset = null, this._animateOff = !1, !1
        },
        _detectOrientation: function () {
            this.orientation = "vertical" === this.options.orientation ? "vertical" : "horizontal"
        },
        _normValueFromMouse: function (e) {
            var t, i, n, s, r;
            return "horizontal" === this.orientation ? (t = this.elementSize.width, i = e.x - this.elementOffset.left - (this._clickOffset ? this._clickOffset.left : 0)) : (t = this.elementSize.height, i = e.y - this.elementOffset.top - (this._clickOffset ? this._clickOffset.top : 0)), n = i / t, n > 1 && (n = 1), 0 > n && (n = 0), "vertical" === this.orientation && (n = 1 - n), s = this._valueMax() - this._valueMin(), r = this._valueMin() + n * s, this._trimAlignValue(r)
        },
        _start: function (e, t) {
            var i = {handle: this.handles[t], value: this.value()};
            return this.options.values && this.options.values.length && (i.value = this.values(t), i.values = this.values()), this._trigger("start", e, i)
        },
        _slide: function (e, t, i) {
            var n, s, r;
            this.options.values && this.options.values.length ? (n = this.values(t ? 0 : 1), 2 === this.options.values.length && this.options.range === !0 && (0 === t && i > n || 1 === t && n > i) && (i = n), i !== this.values(t) && (s = this.values(), s[t] = i, r = this._trigger("slide", e, {
                handle: this.handles[t],
                value: i,
                values: s
            }), n = this.values(t ? 0 : 1), r !== !1 && this.values(t, i, !0))) : i !== this.value() && (r = this._trigger("slide", e, {
                handle: this.handles[t],
                value: i
            }), r !== !1 && this.value(i))
        },
        _stop: function (e, t) {
            var i = {handle: this.handles[t], value: this.value()};
            this.options.values && this.options.values.length && (i.value = this.values(t), i.values = this.values()), this._trigger("stop", e, i)
        },
        _change: function (e, t) {
            if (!this._keySliding && !this._mouseSliding) {
                var i = {handle: this.handles[t], value: this.value()};
                this.options.values && this.options.values.length && (i.value = this.values(t), i.values = this.values()), this._trigger("change", e, i)
            }
        },
        value: function (e) {
            return arguments.length ? (this.options.value = this._trimAlignValue(e), this._refreshValue(), this._change(null, 0), void 0) : this._value()
        },
        values: function (t, i) {
            var n, s, r;
            if (arguments.length > 1)return this.options.values[t] = this._trimAlignValue(i), this._refreshValue(), this._change(null, t), void 0;
            if (!arguments.length)return this._values();
            if (!e.isArray(arguments[0]))return this.options.values && this.options.values.length ? this._values(t) : this.value();
            for (n = this.options.values, s = arguments[0], r = 0; r < n.length; r += 1)n[r] = this._trimAlignValue(s[r]), this._change(null, r);
            this._refreshValue()
        },
        _setOption: function (t, i) {
            var n, s = 0;
            switch (e.isArray(this.options.values) && (s = this.options.values.length), e.Widget.prototype._setOption.apply(this, arguments), t) {
                case"disabled":
                    i ? (this.handles.filter(".ui-state-focus").blur(), this.handles.removeClass("ui-state-hover"), this.handles.prop("disabled", !0), this.element.addClass("ui-disabled")) : (this.handles.prop("disabled", !1), this.element.removeClass("ui-disabled"));
                    break;
                case"orientation":
                    this._detectOrientation(), this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-" + this.orientation), this._refreshValue();
                    break;
                case"value":
                    this._animateOff = !0, this._refreshValue(), this._change(null, 0), this._animateOff = !1;
                    break;
                case"values":
                    for (this._animateOff = !0, this._refreshValue(), n = 0; s > n; n += 1)this._change(null, n);
                    this._animateOff = !1;
                    break;
                case"min":
                case"max":
                    this._animateOff = !0, this._refreshValue(), this._animateOff = !1
            }
        },
        _value: function () {
            var e = this.options.value;
            return e = this._trimAlignValue(e)
        },
        _values: function (e) {
            var t, i, n;
            if (arguments.length)return t = this.options.values[e], t = this._trimAlignValue(t);
            for (i = this.options.values.slice(), n = 0; n < i.length; n += 1)i[n] = this._trimAlignValue(i[n]);
            return i
        },
        _trimAlignValue: function (e) {
            if (e <= this._valueMin())return this._valueMin();
            if (e >= this._valueMax())return this._valueMax();
            var t = this.options.step > 0 ? this.options.step : 1, i = (e - this._valueMin()) % t, n = e - i;
            return 2 * Math.abs(i) >= t && (n += i > 0 ? t : -t), parseFloat(n.toFixed(5))
        },
        _valueMin: function () {
            return this.options.min
        },
        _valueMax: function () {
            return this.options.max
        },
        _refreshValue: function () {
            var t, i, n, s, r, a = this.options.range, o = this.options, l = this, h = this._animateOff ? !1 : o.animate, u = {};
            this.options.values && this.options.values.length ? this.handles.each(function (n) {
                i = 100 * ((l.values(n) - l._valueMin()) / (l._valueMax() - l._valueMin())), u["horizontal" === l.orientation ? "left" : "bottom"] = i + "%", e(this).stop(1, 1)[h ? "animate" : "css"](u, o.animate), l.options.range === !0 && ("horizontal" === l.orientation ? (0 === n && l.range.stop(1, 1)[h ? "animate" : "css"]({left: i + "%"}, o.animate), 1 === n && l.range[h ? "animate" : "css"]({width: i - t + "%"}, {
                    queue: !1,
                    duration: o.animate
                })) : (0 === n && l.range.stop(1, 1)[h ? "animate" : "css"]({bottom: i + "%"}, o.animate), 1 === n && l.range[h ? "animate" : "css"]({height: i - t + "%"}, {
                    queue: !1,
                    duration: o.animate
                }))), t = i
            }) : (n = this.value(), s = this._valueMin(), r = this._valueMax(), i = r !== s ? 100 * ((n - s) / (r - s)) : 0, u["horizontal" === this.orientation ? "left" : "bottom"] = i + "%", this.handle.stop(1, 1)[h ? "animate" : "css"](u, o.animate), "min" === a && "horizontal" === this.orientation && this.range.stop(1, 1)[h ? "animate" : "css"]({width: i + "%"}, o.animate), "max" === a && "horizontal" === this.orientation && this.range[h ? "animate" : "css"]({width: 100 - i + "%"}, {
                queue: !1,
                duration: o.animate
            }), "min" === a && "vertical" === this.orientation && this.range.stop(1, 1)[h ? "animate" : "css"]({height: i + "%"}, o.animate), "max" === a && "vertical" === this.orientation && this.range[h ? "animate" : "css"]({height: 100 - i + "%"}, {
                queue: !1,
                duration: o.animate
            }))
        }
    })
}(jQuery), function (e) {
    function t(e) {
        return function () {
            var t = this.element.val();
            e.apply(this, arguments), this._refresh(), t !== this.element.val() && this._trigger("change")
        }
    }

    e.widget("ui.spinner", {
        version: "1.9.2",
        defaultElement: "<input>",
        widgetEventPrefix: "spin",
        options: {
            culture: null,
            icons: {down: "ui-icon-triangle-1-s", up: "ui-icon-triangle-1-n"},
            incremental: !0,
            max: null,
            min: null,
            numberFormat: null,
            page: 10,
            step: 1,
            change: null,
            spin: null,
            start: null,
            stop: null
        },
        _create: function () {
            this._setOption("max", this.options.max), this._setOption("min", this.options.min), this._setOption("step", this.options.step), this._value(this.element.val(), !0), this._draw(), this._on(this._events), this._refresh(), this._on(this.window, {
                beforeunload: function () {
                    this.element.removeAttr("autocomplete")
                }
            })
        },
        _getCreateOptions: function () {
            var t = {}, i = this.element;
            return e.each(["min", "max", "step"], function (e, n) {
                var s = i.attr(n);
                void 0 !== s && s.length && (t[n] = s)
            }), t
        },
        _events: {
            keydown: function (e) {
                this._start(e) && this._keydown(e) && e.preventDefault()
            }, keyup: "_stop", focus: function () {
                this.previous = this.element.val()
            }, blur: function (e) {
                return this.cancelBlur ? (delete this.cancelBlur, void 0) : (this._refresh(), this.previous !== this.element.val() && this._trigger("change", e), void 0)
            }, mousewheel: function (e, t) {
                return t ? this.spinning || this._start(e) ? (this._spin((t > 0 ? 1 : -1) * this.options.step, e), clearTimeout(this.mousewheelTimer), this.mousewheelTimer = this._delay(function () {
                    this.spinning && this._stop(e)
                }, 100), e.preventDefault(), void 0) : !1 : void 0
            }, "mousedown .ui-spinner-button": function (t) {
                function i() {
                    var e = this.element[0] === this.document[0].activeElement;
                    e || (this.element.focus(), this.previous = n, this._delay(function () {
                        this.previous = n
                    }))
                }

                var n;
                n = this.element[0] === this.document[0].activeElement ? this.previous : this.element.val(), t.preventDefault(), i.call(this), this.cancelBlur = !0, this._delay(function () {
                    delete this.cancelBlur, i.call(this)
                }), this._start(t) !== !1 && this._repeat(null, e(t.currentTarget).hasClass("ui-spinner-up") ? 1 : -1, t)
            }, "mouseup .ui-spinner-button": "_stop", "mouseenter .ui-spinner-button": function (t) {
                return e(t.currentTarget).hasClass("ui-state-active") ? this._start(t) === !1 ? !1 : (this._repeat(null, e(t.currentTarget).hasClass("ui-spinner-up") ? 1 : -1, t), void 0) : void 0
            }, "mouseleave .ui-spinner-button": "_stop"
        },
        _draw: function () {
            var e = this.uiSpinner = this.element.addClass("ui-spinner-input").attr("autocomplete", "off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());
            this.element.attr("role", "spinbutton"), this.buttons = e.find(".ui-spinner-button").attr("tabIndex", -1).button().removeClass("ui-corner-all"), this.buttons.height() > Math.ceil(.5 * e.height()) && e.height() > 0 && e.height(e.height()), this.options.disabled && this.disable()
        },
        _keydown: function (t) {
            var i = this.options, n = e.ui.keyCode;
            switch (t.keyCode) {
                case n.UP:
                    return this._repeat(null, 1, t), !0;
                case n.DOWN:
                    return this._repeat(null, -1, t), !0;
                case n.PAGE_UP:
                    return this._repeat(null, i.page, t), !0;
                case n.PAGE_DOWN:
                    return this._repeat(null, -i.page, t), !0
            }
            return !1
        },
        _uiSpinnerHtml: function () {
            return "<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"
        },
        _buttonHtml: function () {
            return "<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon " + this.options.icons.up + "'>&#9650;</span>" + "</a>" + "<a class='ui-spinner-button ui-spinner-down ui-corner-br'>" + "<span class='ui-icon " + this.options.icons.down + "'>&#9660;</span>" + "</a>"
        },
        _start: function (e) {
            return this.spinning || this._trigger("start", e) !== !1 ? (this.counter || (this.counter = 1), this.spinning = !0, !0) : !1
        },
        _repeat: function (e, t, i) {
            e = e || 500, clearTimeout(this.timer), this.timer = this._delay(function () {
                this._repeat(40, t, i)
            }, e), this._spin(t * this.options.step, i)
        },
        _spin: function (e, t) {
            var i = this.value() || 0;
            this.counter || (this.counter = 1), i = this._adjustValue(i + e * this._increment(this.counter)), this.spinning && this._trigger("spin", t, {value: i}) === !1 || (this._value(i), this.counter++)
        },
        _increment: function (t) {
            var i = this.options.incremental;
            return i ? e.isFunction(i) ? i(t) : Math.floor(t * t * t / 5e4 - t * t / 500 + 17 * t / 200 + 1) : 1
        },
        _precision: function () {
            var e = this._precisionOf(this.options.step);
            return null !== this.options.min && (e = Math.max(e, this._precisionOf(this.options.min))), e
        },
        _precisionOf: function (e) {
            var t = e.toString(), i = t.indexOf(".");
            return -1 === i ? 0 : t.length - i - 1
        },
        _adjustValue: function (e) {
            var t, i, n = this.options;
            return t = null !== n.min ? n.min : 0, i = e - t, i = Math.round(i / n.step) * n.step, e = t + i, e = parseFloat(e.toFixed(this._precision())), null !== n.max && e > n.max ? n.max : null !== n.min && e < n.min ? n.min : e
        },
        _stop: function (e) {
            this.spinning && (clearTimeout(this.timer), clearTimeout(this.mousewheelTimer), this.counter = 0, this.spinning = !1, this._trigger("stop", e))
        },
        _setOption: function (e, t) {
            if ("culture" === e || "numberFormat" === e) {
                var i = this._parse(this.element.val());
                return this.options[e] = t, this.element.val(this._format(i)), void 0
            }
            ("max" === e || "min" === e || "step" === e) && "string" == typeof t && (t = this._parse(t)), this._super(e, t), "disabled" === e && (t ? (this.element.prop("disabled", !0), this.buttons.button("disable")) : (this.element.prop("disabled", !1), this.buttons.button("enable")))
        },
        _setOptions: t(function (e) {
            this._super(e), this._value(this.element.val())
        }),
        _parse: function (e) {
            return "string" == typeof e && "" !== e && (e = window.Globalize && this.options.numberFormat ? Globalize.parseFloat(e, 10, this.options.culture) : +e), "" === e || isNaN(e) ? null : e
        },
        _format: function (e) {
            return "" === e ? "" : window.Globalize && this.options.numberFormat ? Globalize.format(e, this.options.numberFormat, this.options.culture) : e
        },
        _refresh: function () {
            this.element.attr({
                "aria-valuemin": this.options.min,
                "aria-valuemax": this.options.max,
                "aria-valuenow": this._parse(this.element.val())
            })
        },
        _value: function (e, t) {
            var i;
            "" !== e && (i = this._parse(e), null !== i && (t || (i = this._adjustValue(i)), e = this._format(i))), this.element.val(e), this._refresh()
        },
        _destroy: function () {
            this.element.removeClass("ui-spinner-input").prop("disabled", !1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"), this.uiSpinner.replaceWith(this.element)
        },
        stepUp: t(function (e) {
            this._stepUp(e)
        }),
        _stepUp: function (e) {
            this._spin((e || 1) * this.options.step)
        },
        stepDown: t(function (e) {
            this._stepDown(e)
        }),
        _stepDown: function (e) {
            this._spin((e || 1) * -this.options.step)
        },
        pageUp: t(function (e) {
            this._stepUp((e || 1) * this.options.page)
        }),
        pageDown: t(function (e) {
            this._stepDown((e || 1) * this.options.page)
        }),
        value: function (e) {
            return arguments.length ? (t(this._value).call(this, e), void 0) : this._parse(this.element.val())
        },
        widget: function () {
            return this.uiSpinner
        }
    })
}(jQuery), function (e, t) {
    function i() {
        return ++s
    }

    function n(e) {
        return e.hash.length > 1 && e.href.replace(r, "") === location.href.replace(r, "").replace(/\s/g, "%20")
    }

    var s = 0, r = /#.*$/;
    e.widget("ui.tabs", {
        version: "1.9.2",
        delay: 300,
        options: {
            active: null,
            collapsible: !1,
            event: "click",
            heightStyle: "content",
            hide: null,
            show: null,
            activate: null,
            beforeActivate: null,
            beforeLoad: null,
            load: null
        },
        _create: function () {
            var t = this, i = this.options, n = i.active, s = location.hash.substring(1);
            this.running = !1, this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible", i.collapsible).delegate(".ui-tabs-nav > li", "mousedown" + this.eventNamespace, function (t) {
                e(this).is(".ui-state-disabled") && t.preventDefault()
            }).delegate(".ui-tabs-anchor", "focus" + this.eventNamespace, function () {
                e(this).closest("li").is(".ui-state-disabled") && this.blur()
            }), this._processTabs(), null === n && (s && this.tabs.each(function (t, i) {
                return e(i).attr("aria-controls") === s ? (n = t, !1) : void 0
            }), null === n && (n = this.tabs.index(this.tabs.filter(".ui-tabs-active"))), (null === n || -1 === n) && (n = this.tabs.length ? 0 : !1)), n !== !1 && (n = this.tabs.index(this.tabs.eq(n)), -1 === n && (n = i.collapsible ? !1 : 0)), i.active = n, !i.collapsible && i.active === !1 && this.anchors.length && (i.active = 0), e.isArray(i.disabled) && (i.disabled = e.unique(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"), function (e) {
                return t.tabs.index(e)
            }))).sort()), this.active = this.options.active !== !1 && this.anchors.length ? this._findActive(this.options.active) : e(), this._refresh(), this.active.length && this.load(i.active)
        },
        _getCreateEventData: function () {
            return {tab: this.active, panel: this.active.length ? this._getPanelForTab(this.active) : e()}
        },
        _tabKeydown: function (t) {
            var i = e(this.document[0].activeElement).closest("li"), n = this.tabs.index(i), s = !0;
            if (!this._handlePageNav(t)) {
                switch (t.keyCode) {
                    case e.ui.keyCode.RIGHT:
                    case e.ui.keyCode.DOWN:
                        n++;
                        break;
                    case e.ui.keyCode.UP:
                    case e.ui.keyCode.LEFT:
                        s = !1, n--;
                        break;
                    case e.ui.keyCode.END:
                        n = this.anchors.length - 1;
                        break;
                    case e.ui.keyCode.HOME:
                        n = 0;
                        break;
                    case e.ui.keyCode.SPACE:
                        return t.preventDefault(), clearTimeout(this.activating), this._activate(n), void 0;
                    case e.ui.keyCode.ENTER:
                        return t.preventDefault(), clearTimeout(this.activating), this._activate(n === this.options.active ? !1 : n), void 0;
                    default:
                        return
                }
                t.preventDefault(), clearTimeout(this.activating), n = this._focusNextTab(n, s), t.ctrlKey || (i.attr("aria-selected", "false"), this.tabs.eq(n).attr("aria-selected", "true"), this.activating = this._delay(function () {
                    this.option("active", n)
                }, this.delay))
            }
        },
        _panelKeydown: function (t) {
            this._handlePageNav(t) || t.ctrlKey && t.keyCode === e.ui.keyCode.UP && (t.preventDefault(), this.active.focus())
        },
        _handlePageNav: function (t) {
            return t.altKey && t.keyCode === e.ui.keyCode.PAGE_UP ? (this._activate(this._focusNextTab(this.options.active - 1, !1)), !0) : t.altKey && t.keyCode === e.ui.keyCode.PAGE_DOWN ? (this._activate(this._focusNextTab(this.options.active + 1, !0)), !0) : void 0
        },
        _findNextTab: function (t, i) {
            function n() {
                return t > s && (t = 0), 0 > t && (t = s), t
            }

            for (var s = this.tabs.length - 1; -1 !== e.inArray(n(), this.options.disabled);)t = i ? t + 1 : t - 1;
            return t
        },
        _focusNextTab: function (e, t) {
            return e = this._findNextTab(e, t), this.tabs.eq(e).focus(), e
        },
        _setOption: function (e, t) {
            return "active" === e ? (this._activate(t), void 0) : "disabled" === e ? (this._setupDisabled(t), void 0) : (this._super(e, t), "collapsible" === e && (this.element.toggleClass("ui-tabs-collapsible", t), !t && this.options.active === !1 && this._activate(0)), "event" === e && this._setupEvents(t), "heightStyle" === e && this._setupHeightStyle(t), void 0)
        },
        _tabId: function (e) {
            return e.attr("aria-controls") || "ui-tabs-" + i()
        },
        _sanitizeSelector: function (e) {
            return e ? e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g, "\\$&") : ""
        },
        refresh: function () {
            var t = this.options, i = this.tablist.children(":has(a[href])");
            t.disabled = e.map(i.filter(".ui-state-disabled"), function (e) {
                return i.index(e)
            }), this._processTabs(), t.active !== !1 && this.anchors.length ? this.active.length && !e.contains(this.tablist[0], this.active[0]) ? this.tabs.length === t.disabled.length ? (t.active = !1, this.active = e()) : this._activate(this._findNextTab(Math.max(0, t.active - 1), !1)) : t.active = this.tabs.index(this.active) : (t.active = !1, this.active = e()), this._refresh()
        },
        _refresh: function () {
            this._setupDisabled(this.options.disabled), this._setupEvents(this.options.event), this._setupHeightStyle(this.options.heightStyle), this.tabs.not(this.active).attr({
                "aria-selected": "false",
                tabIndex: -1
            }), this.panels.not(this._getPanelForTab(this.active)).hide().attr({
                "aria-expanded": "false",
                "aria-hidden": "true"
            }), this.active.length ? (this.active.addClass("ui-tabs-active ui-state-active").attr({
                "aria-selected": "true",
                tabIndex: 0
            }), this._getPanelForTab(this.active).show().attr({
                "aria-expanded": "true",
                "aria-hidden": "false"
            })) : this.tabs.eq(0).attr("tabIndex", 0)
        },
        _processTabs: function () {
            var t = this;
            this.tablist = this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role", "tablist"), this.tabs = this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({
                role: "tab",
                tabIndex: -1
            }), this.anchors = this.tabs.map(function () {
                return e("a", this)[0]
            }).addClass("ui-tabs-anchor").attr({
                role: "presentation",
                tabIndex: -1
            }), this.panels = e(), this.anchors.each(function (i, s) {
                var r, a, o, l = e(s).uniqueId().attr("id"), h = e(s).closest("li"), u = h.attr("aria-controls");
                n(s) ? (r = s.hash, a = t.element.find(t._sanitizeSelector(r))) : (o = t._tabId(h), r = "#" + o, a = t.element.find(r), a.length || (a = t._createPanel(o), a.insertAfter(t.panels[i - 1] || t.tablist)), a.attr("aria-live", "polite")), a.length && (t.panels = t.panels.add(a)), u && h.data("ui-tabs-aria-controls", u), h.attr({
                    "aria-controls": r.substring(1),
                    "aria-labelledby": l
                }), a.attr("aria-labelledby", l)
            }), this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role", "tabpanel")
        },
        _getList: function () {
            return this.element.find("ol,ul").eq(0)
        },
        _createPanel: function (t) {
            return e("<div>").attr("id", t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy", !0)
        },
        _setupDisabled: function (t) {
            e.isArray(t) && (t.length ? t.length === this.anchors.length && (t = !0) : t = !1);
            for (var i, n = 0; i = this.tabs[n]; n++)t === !0 || -1 !== e.inArray(n, t) ? e(i).addClass("ui-state-disabled").attr("aria-disabled", "true") : e(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");
            this.options.disabled = t
        },
        _setupEvents: function (t) {
            var i = {
                click: function (e) {
                    e.preventDefault()
                }
            };
            t && e.each(t.split(" "), function (e, t) {
                i[t] = "_eventHandler"
            }), this._off(this.anchors.add(this.tabs).add(this.panels)), this._on(this.anchors, i), this._on(this.tabs, {keydown: "_tabKeydown"}), this._on(this.panels, {keydown: "_panelKeydown"}), this._focusable(this.tabs), this._hoverable(this.tabs)
        },
        _setupHeightStyle: function (t) {
            var i, n, s = this.element.parent();
            "fill" === t ? (e.support.minHeight || (n = s.css("overflow"), s.css("overflow", "hidden")), i = s.height(), this.element.siblings(":visible").each(function () {
                var t = e(this), n = t.css("position");
                "absolute" !== n && "fixed" !== n && (i -= t.outerHeight(!0))
            }), n && s.css("overflow", n), this.element.children().not(this.panels).each(function () {
                i -= e(this).outerHeight(!0)
            }), this.panels.each(function () {
                e(this).height(Math.max(0, i - e(this).innerHeight() + e(this).height()))
            }).css("overflow", "auto")) : "auto" === t && (i = 0, this.panels.each(function () {
                i = Math.max(i, e(this).height("").height())
            }).height(i))
        },
        _eventHandler: function (t) {
            var i = this.options, n = this.active, s = e(t.currentTarget), r = s.closest("li"), a = r[0] === n[0], o = a && i.collapsible, l = o ? e() : this._getPanelForTab(r), h = n.length ? this._getPanelForTab(n) : e(), u = {
                oldTab: n,
                oldPanel: h,
                newTab: o ? e() : r,
                newPanel: l
            };
            t.preventDefault(), r.hasClass("ui-state-disabled") || r.hasClass("ui-tabs-loading") || this.running || a && !i.collapsible || this._trigger("beforeActivate", t, u) === !1 || (i.active = o ? !1 : this.tabs.index(r), this.active = a ? e() : r, this.xhr && this.xhr.abort(), !h.length && !l.length && e.error("jQuery UI Tabs: Mismatching fragment identifier."), l.length && this.load(this.tabs.index(r), t), this._toggle(t, u))
        },
        _toggle: function (t, i) {
            function n() {
                r.running = !1, r._trigger("activate", t, i)
            }

            function s() {
                i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"), a.length && r.options.show ? r._show(a, r.options.show, n) : (a.show(), n())
            }

            var r = this, a = i.newPanel, o = i.oldPanel;
            this.running = !0, o.length && this.options.hide ? this._hide(o, this.options.hide, function () {
                i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"), s()
            }) : (i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"), o.hide(), s()), o.attr({
                "aria-expanded": "false",
                "aria-hidden": "true"
            }), i.oldTab.attr("aria-selected", "false"), a.length && o.length ? i.oldTab.attr("tabIndex", -1) : a.length && this.tabs.filter(function () {
                return 0 === e(this).attr("tabIndex")
            }).attr("tabIndex", -1), a.attr({
                "aria-expanded": "true",
                "aria-hidden": "false"
            }), i.newTab.attr({"aria-selected": "true", tabIndex: 0})
        },
        _activate: function (t) {
            var i, n = this._findActive(t);
            n[0] !== this.active[0] && (n.length || (n = this.active), i = n.find(".ui-tabs-anchor")[0], this._eventHandler({
                target: i,
                currentTarget: i,
                preventDefault: e.noop
            }))
        },
        _findActive: function (t) {
            return t === !1 ? e() : this.tabs.eq(t)
        },
        _getIndex: function (e) {
            return "string" == typeof e && (e = this.anchors.index(this.anchors.filter("[href$='" + e + "']"))), e
        },
        _destroy: function () {
            this.xhr && this.xhr.abort(), this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"), this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"), this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeData("href.tabs").removeData("load.tabs").removeUniqueId(), this.tabs.add(this.panels).each(function () {
                e.data(this, "ui-tabs-destroy") ? e(this).remove() : e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")
            }), this.tabs.each(function () {
                var t = e(this), i = t.data("ui-tabs-aria-controls");
                i ? t.attr("aria-controls", i) : t.removeAttr("aria-controls")
            }), this.panels.show(), "content" !== this.options.heightStyle && this.panels.css("height", "")
        },
        enable: function (i) {
            var n = this.options.disabled;
            n !== !1 && (i === t ? n = !1 : (i = this._getIndex(i), n = e.isArray(n) ? e.map(n, function (e) {
                return e !== i ? e : null
            }) : e.map(this.tabs, function (e, t) {
                return t !== i ? t : null
            })), this._setupDisabled(n))
        },
        disable: function (i) {
            var n = this.options.disabled;
            if (n !== !0) {
                if (i === t) n = !0; else {
                    if (i = this._getIndex(i), -1 !== e.inArray(i, n))return;
                    n = e.isArray(n) ? e.merge([i], n).sort() : [i]
                }
                this._setupDisabled(n)
            }
        },
        load: function (t, i) {
            t = this._getIndex(t);
            var s = this, r = this.tabs.eq(t), a = r.find(".ui-tabs-anchor"), o = this._getPanelForTab(r), l = {
                tab: r,
                panel: o
            };
            n(a[0]) || (this.xhr = e.ajax(this._ajaxSettings(a, i, l)), this.xhr && "canceled" !== this.xhr.statusText && (r.addClass("ui-tabs-loading"), o.attr("aria-busy", "true"), this.xhr.success(function (e) {
                setTimeout(function () {
                    o.html(e), s._trigger("load", i, l)
                }, 1)
            }).complete(function (e, t) {
                setTimeout(function () {
                    "abort" === t && s.panels.stop(!1, !0), r.removeClass("ui-tabs-loading"), o.removeAttr("aria-busy"), e === s.xhr && delete s.xhr
                }, 1)
            })))
        },
        _ajaxSettings: function (t, i, n) {
            var s = this;
            return {
                url: t.attr("href"), beforeSend: function (t, r) {
                    return s._trigger("beforeLoad", i, e.extend({jqXHR: t, ajaxSettings: r}, n))
                }
            }
        },
        _getPanelForTab: function (t) {
            var i = e(t).attr("aria-controls");
            return this.element.find(this._sanitizeSelector("#" + i))
        }
    }), e.uiBackCompat !== !1 && (e.ui.tabs.prototype._ui = function (e, t) {
        return {tab: e, panel: t, index: this.anchors.index(e)}
    }, e.widget("ui.tabs", e.ui.tabs, {
        url: function (e, t) {
            this.anchors.eq(e).attr("href", t)
        }
    }), e.widget("ui.tabs", e.ui.tabs, {
        options: {ajaxOptions: null, cache: !1}, _create: function () {
            this._super();
            var t = this;
            this._on({
                tabsbeforeload: function (i, n) {
                    return e.data(n.tab[0], "cache.tabs") ? (i.preventDefault(), void 0) : (n.jqXHR.success(function () {
                        t.options.cache && e.data(n.tab[0], "cache.tabs", !0)
                    }), void 0)
                }
            })
        }, _ajaxSettings: function (t, i, n) {
            var s = this.options.ajaxOptions;
            return e.extend({}, s, {
                error: function (e, t) {
                    try {
                        s.error(e, t, n.tab.closest("li").index(), n.tab[0])
                    } catch (i) {
                    }
                }
            }, this._superApply(arguments))
        }, _setOption: function (e, t) {
            "cache" === e && t === !1 && this.anchors.removeData("cache.tabs"), this._super(e, t)
        }, _destroy: function () {
            this.anchors.removeData("cache.tabs"), this._super()
        }, url: function (e) {
            this.anchors.eq(e).removeData("cache.tabs"), this._superApply(arguments)
        }
    }), e.widget("ui.tabs", e.ui.tabs, {
        abort: function () {
            this.xhr && this.xhr.abort()
        }
    }), e.widget("ui.tabs", e.ui.tabs, {
        options: {spinner: "<em>Loading&#8230;</em>"}, _create: function () {
            this._super(), this._on({
                tabsbeforeload: function (e, t) {
                    if (e.target === this.element[0] && this.options.spinner) {
                        var i = t.tab.find("span"), n = i.html();
                        i.html(this.options.spinner), t.jqXHR.complete(function () {
                            i.html(n)
                        })
                    }
                }
            })
        }
    }), e.widget("ui.tabs", e.ui.tabs, {
        options: {enable: null, disable: null}, enable: function (t) {
            var i, n = this.options;
            (t && n.disabled === !0 || e.isArray(n.disabled) && -1 !== e.inArray(t, n.disabled)) && (i = !0), this._superApply(arguments), i && this._trigger("enable", null, this._ui(this.anchors[t], this.panels[t]))
        }, disable: function (t) {
            var i, n = this.options;
            (t && n.disabled === !1 || e.isArray(n.disabled) && -1 === e.inArray(t, n.disabled)) && (i = !0), this._superApply(arguments), i && this._trigger("disable", null, this._ui(this.anchors[t], this.panels[t]))
        }
    }), e.widget("ui.tabs", e.ui.tabs, {
        options: {
            add: null,
            remove: null,
            tabTemplate: "<li><a href='#{href}'><span>#{label}</span></a></li>"
        }, add: function (i, n, s) {
            s === t && (s = this.anchors.length);
            var r, a, o = this.options, l = e(o.tabTemplate.replace(/#\{href\}/g, i).replace(/#\{label\}/g, n)), h = i.indexOf("#") ? this._tabId(l) : i.replace("#", "");
            return l.addClass("ui-state-default ui-corner-top").data("ui-tabs-destroy", !0), l.attr("aria-controls", h), r = s >= this.tabs.length, a = this.element.find("#" + h), a.length || (a = this._createPanel(h), r ? s > 0 ? a.insertAfter(this.panels.eq(-1)) : a.appendTo(this.element) : a.insertBefore(this.panels[s])), a.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").hide(), r ? l.appendTo(this.tablist) : l.insertBefore(this.tabs[s]), o.disabled = e.map(o.disabled, function (e) {
                return e >= s ? ++e : e
            }), this.refresh(), 1 === this.tabs.length && o.active === !1 && this.option("active", 0), this._trigger("add", null, this._ui(this.anchors[s], this.panels[s])), this
        }, remove: function (t) {
            t = this._getIndex(t);
            var i = this.options, n = this.tabs.eq(t).remove(), s = this._getPanelForTab(n).remove();
            return n.hasClass("ui-tabs-active") && this.anchors.length > 2 && this._activate(t + (t + 1 < this.anchors.length ? 1 : -1)), i.disabled = e.map(e.grep(i.disabled, function (e) {
                return e !== t
            }), function (e) {
                return e >= t ? --e : e
            }), this.refresh(), this._trigger("remove", null, this._ui(n.find("a")[0], s[0])), this
        }
    }), e.widget("ui.tabs", e.ui.tabs, {
        length: function () {
            return this.anchors.length
        }
    }), e.widget("ui.tabs", e.ui.tabs, {
        options: {idPrefix: "ui-tabs-"}, _tabId: function (t) {
            var n = t.is("li") ? t.find("a[href]") : t;
            return n = n[0], e(n).closest("li").attr("aria-controls") || n.title && n.title.replace(/\s/g, "_").replace(/[^\w\u00c0-\uFFFF\-]/g, "") || this.options.idPrefix + i()
        }
    }), e.widget("ui.tabs", e.ui.tabs, {
        options: {panelTemplate: "<div></div>"}, _createPanel: function (t) {
            return e(this.options.panelTemplate).attr("id", t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy", !0)
        }
    }), e.widget("ui.tabs", e.ui.tabs, {
        _create: function () {
            var e = this.options;
            null === e.active && e.selected !== t && (e.active = -1 === e.selected ? !1 : e.selected), this._super(), e.selected = e.active, e.selected === !1 && (e.selected = -1)
        }, _setOption: function (e, t) {
            if ("selected" !== e)return this._super(e, t);
            var i = this.options;
            this._super("active", -1 === t ? !1 : t), i.selected = i.active, i.selected === !1 && (i.selected = -1)
        }, _eventHandler: function () {
            this._superApply(arguments), this.options.selected = this.options.active, this.options.selected === !1 && (this.options.selected = -1)
        }
    }), e.widget("ui.tabs", e.ui.tabs, {
        options: {show: null, select: null}, _create: function () {
            this._super(), this.options.active !== !1 && this._trigger("show", null, this._ui(this.active.find(".ui-tabs-anchor")[0], this._getPanelForTab(this.active)[0]))
        }, _trigger: function (e, t, i) {
            var n, s, r = this._superApply(arguments);
            return r ? ("beforeActivate" === e ? (n = i.newTab.length ? i.newTab : i.oldTab, s = i.newPanel.length ? i.newPanel : i.oldPanel, r = this._super("select", t, {
                tab: n.find(".ui-tabs-anchor")[0],
                panel: s[0],
                index: n.closest("li").index()
            })) : "activate" === e && i.newTab.length && (r = this._super("show", t, {
                tab: i.newTab.find(".ui-tabs-anchor")[0],
                panel: i.newPanel[0],
                index: i.newTab.closest("li").index()
            })), r) : !1
        }
    }), e.widget("ui.tabs", e.ui.tabs, {
        select: function (e) {
            if (e = this._getIndex(e), -1 === e) {
                if (!this.options.collapsible || -1 === this.options.selected)return;
                e = this.options.selected
            }
            this.anchors.eq(e).trigger(this.options.event + this.eventNamespace)
        }
    }), function () {
        var t = 0;
        e.widget("ui.tabs", e.ui.tabs, {
            options: {cookie: null}, _create: function () {
                var e, t = this.options;
                null == t.active && t.cookie && (e = parseInt(this._cookie(), 10), -1 === e && (e = !1), t.active = e), this._super()
            }, _cookie: function (i) {
                var n = [this.cookie || (this.cookie = this.options.cookie.name || "ui-tabs-" + ++t)];
                return arguments.length && (n.push(i === !1 ? -1 : i), n.push(this.options.cookie)), e.cookie.apply(null, n)
            }, _refresh: function () {
                this._super(), this.options.cookie && this._cookie(this.options.active, this.options.cookie)
            }, _eventHandler: function () {
                this._superApply(arguments), this.options.cookie && this._cookie(this.options.active, this.options.cookie)
            }, _destroy: function () {
                this._super(), this.options.cookie && this._cookie(null, this.options.cookie)
            }
        })
    }(), e.widget("ui.tabs", e.ui.tabs, {
        _trigger: function (t, i, n) {
            var s = e.extend({}, n);
            return "load" === t && (s.panel = s.panel[0], s.tab = s.tab.find(".ui-tabs-anchor")[0]), this._super(t, i, s)
        }
    }), e.widget("ui.tabs", e.ui.tabs, {
        options: {fx: null}, _getFx: function () {
            var t, i, n = this.options.fx;
            return n && (e.isArray(n) ? (t = n[0], i = n[1]) : t = i = n), n ? {show: i, hide: t} : null
        }, _toggle: function (e, t) {
            function i() {
                s.running = !1, s._trigger("activate", e, t)
            }

            function n() {
                t.newTab.closest("li").addClass("ui-tabs-active ui-state-active"), r.length && o.show ? r.animate(o.show, o.show.duration, function () {
                    i()
                }) : (r.show(), i())
            }

            var s = this, r = t.newPanel, a = t.oldPanel, o = this._getFx();
            return o ? (s.running = !0, a.length && o.hide ? a.animate(o.hide, o.hide.duration, function () {
                t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"), n()
            }) : (t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"), a.hide(), n()), void 0) : this._super(e, t)
        }
    }))
}(jQuery), function (e) {
    function t(t, i) {
        var n = (t.attr("aria-describedby") || "").split(/\s+/);
        n.push(i), t.data("ui-tooltip-id", i).attr("aria-describedby", e.trim(n.join(" ")))
    }

    function i(t) {
        var i = t.data("ui-tooltip-id"), n = (t.attr("aria-describedby") || "").split(/\s+/), s = e.inArray(i, n);
        -1 !== s && n.splice(s, 1), t.removeData("ui-tooltip-id"), n = e.trim(n.join(" ")), n ? t.attr("aria-describedby", n) : t.removeAttr("aria-describedby")
    }

    var n = 0;
    e.widget("ui.tooltip", {
        version: "1.9.2", options: {
            content: function () {
                return e(this).attr("title")
            },
            hide: !0,
            items: "[title]:not([disabled])",
            position: {my: "left top+15", at: "left bottom", collision: "flipfit flip"},
            show: !0,
            tooltipClass: null,
            track: !1,
            close: null,
            open: null
        }, _create: function () {
            this._on({
                mouseover: "open",
                focusin: "open"
            }), this.tooltips = {}, this.parents = {}, this.options.disabled && this._disable()
        }, _setOption: function (t, i) {
            var n = this;
            return "disabled" === t ? (this[i ? "_disable" : "_enable"](), this.options[t] = i, void 0) : (this._super(t, i), "content" === t && e.each(this.tooltips, function (e, t) {
                n._updateContent(t)
            }), void 0)
        }, _disable: function () {
            var t = this;
            e.each(this.tooltips, function (i, n) {
                var s = e.Event("blur");
                s.target = s.currentTarget = n[0], t.close(s, !0)
            }), this.element.find(this.options.items).andSelf().each(function () {
                var t = e(this);
                t.is("[title]") && t.data("ui-tooltip-title", t.attr("title")).attr("title", "")
            })
        }, _enable: function () {
            this.element.find(this.options.items).andSelf().each(function () {
                var t = e(this);
                t.data("ui-tooltip-title") && t.attr("title", t.data("ui-tooltip-title"))
            })
        }, open: function (t) {
            var i = this, n = e(t ? t.target : this.element).closest(this.options.items);
            n.length && !n.data("ui-tooltip-id") && (n.attr("title") && n.data("ui-tooltip-title", n.attr("title")), n.data("ui-tooltip-open", !0), t && "mouseover" === t.type && n.parents().each(function () {
                var t, n = e(this);
                n.data("ui-tooltip-open") && (t = e.Event("blur"), t.target = t.currentTarget = this, i.close(t, !0)), n.attr("title") && (n.uniqueId(), i.parents[this.id] = {
                    element: this,
                    title: n.attr("title")
                }, n.attr("title", ""))
            }), this._updateContent(n, t))
        }, _updateContent: function (e, t) {
            var i, n = this.options.content, s = this, r = t ? t.type : null;
            return "string" == typeof n ? this._open(t, e, n) : (i = n.call(e[0], function (i) {
                e.data("ui-tooltip-open") && s._delay(function () {
                    t && (t.type = r), this._open(t, e, i)
                })
            }), i && this._open(t, e, i), void 0)
        }, _open: function (i, n, s) {
            function r(e) {
                h.of = e, a.is(":hidden") || a.position(h)
            }

            var a, o, l, h = e.extend({}, this.options.position);
            if (s) {
                if (a = this._find(n), a.length)return a.find(".ui-tooltip-content").html(s), void 0;
                n.is("[title]") && (i && "mouseover" === i.type ? n.attr("title", "") : n.removeAttr("title")), a = this._tooltip(n), t(n, a.attr("id")), a.find(".ui-tooltip-content").html(s), this.options.track && i && /^mouse/.test(i.type) ? (this._on(this.document, {mousemove: r}), r(i)) : a.position(e.extend({of: n}, this.options.position)), a.hide(), this._show(a, this.options.show), this.options.show && this.options.show.delay && (l = setInterval(function () {
                    a.is(":visible") && (r(h.of), clearInterval(l))
                }, e.fx.interval)), this._trigger("open", i, {tooltip: a}), o = {
                    keyup: function (t) {
                        if (t.keyCode === e.ui.keyCode.ESCAPE) {
                            var i = e.Event(t);
                            i.currentTarget = n[0], this.close(i, !0)
                        }
                    }, remove: function () {
                        this._removeTooltip(a)
                    }
                }, i && "mouseover" !== i.type || (o.mouseleave = "close"), i && "focusin" !== i.type || (o.focusout = "close"), this._on(!0, n, o)
            }
        }, close: function (t) {
            var n = this, s = e(t ? t.currentTarget : this.element), r = this._find(s);
            this.closing || (s.data("ui-tooltip-title") && s.attr("title", s.data("ui-tooltip-title")), i(s), r.stop(!0), this._hide(r, this.options.hide, function () {
                n._removeTooltip(e(this))
            }), s.removeData("ui-tooltip-open"), this._off(s, "mouseleave focusout keyup"), s[0] !== this.element[0] && this._off(s, "remove"), this._off(this.document, "mousemove"), t && "mouseleave" === t.type && e.each(this.parents, function (t, i) {
                e(i.element).attr("title", i.title), delete n.parents[t]
            }), this.closing = !0, this._trigger("close", t, {tooltip: r}), this.closing = !1)
        }, _tooltip: function (t) {
            var i = "ui-tooltip-" + n++, s = e("<div>").attr({
                id: i,
                role: "tooltip"
            }).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content " + (this.options.tooltipClass || ""));
            return e("<div>").addClass("ui-tooltip-content").appendTo(s), s.appendTo(this.document[0].body), e.fn.bgiframe && s.bgiframe(), this.tooltips[i] = t, s
        }, _find: function (t) {
            var i = t.data("ui-tooltip-id");
            return i ? e("#" + i) : e()
        }, _removeTooltip: function (e) {
            e.remove(), delete this.tooltips[e.attr("id")]
        }, _destroy: function () {
            var t = this;
            e.each(this.tooltips, function (i, n) {
                var s = e.Event("blur");
                s.target = s.currentTarget = n[0], t.close(s, !0), e("#" + i).remove(), n.data("ui-tooltip-title") && (n.attr("title", n.data("ui-tooltip-title")), n.removeData("ui-tooltip-title"))
            })
        }
    })
}(jQuery), jQuery.effects || function (e, t) {
    var i = e.uiBackCompat !== !1, n = "ui-effects-";
    e.effects = {effect: {}}, function (t, i) {
        function n(e, t, i) {
            var n = p[t.type] || {};
            return null == e ? i || !t.def ? null : t.def : (e = n.floor ? ~~e : parseFloat(e), isNaN(e) ? t.def : n.mod ? (e + n.mod) % n.mod : 0 > e ? 0 : n.max < e ? n.max : e)
        }

        function s(e) {
            var i = u(), n = i._rgba = [];
            return e = e.toLowerCase(), m(h, function (t, s) {
                var r, a = s.re.exec(e), o = a && s.parse(a), l = s.space || "rgba";
                return o ? (r = i[l](o), i[c[l].cache] = r[c[l].cache], n = i._rgba = r._rgba, !1) : void 0
            }), n.length ? ("0,0,0,0" === n.join() && t.extend(n, a.transparent), i) : a[e]
        }

        function r(e, t, i) {
            return i = (i + 1) % 1, 1 > 6 * i ? e + 6 * (t - e) * i : 1 > 2 * i ? t : 2 > 3 * i ? e + 6 * (t - e) * (2 / 3 - i) : e
        }

        var a, o = "backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor".split(" "), l = /^([\-+])=\s*(\d+\.?\d*)/, h = [{
            re: /rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,
            parse: function (e) {
                return [e[1], e[2], e[3], e[4]]
            }
        }, {
            re: /rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,
            parse: function (e) {
                return [2.55 * e[1], 2.55 * e[2], 2.55 * e[3], e[4]]
            }
        }, {
            re: /#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/, parse: function (e) {
                return [parseInt(e[1], 16), parseInt(e[2], 16), parseInt(e[3], 16)]
            }
        }, {
            re: /#([a-f0-9])([a-f0-9])([a-f0-9])/, parse: function (e) {
                return [parseInt(e[1] + e[1], 16), parseInt(e[2] + e[2], 16), parseInt(e[3] + e[3], 16)]
            }
        }, {
            re: /hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,
            space: "hsla",
            parse: function (e) {
                return [e[1], e[2] / 100, e[3] / 100, e[4]]
            }
        }], u = t.Color = function (e, i, n, s) {
            return new t.Color.fn.parse(e, i, n, s)
        }, c = {
            rgba: {
                props: {
                    red: {idx: 0, type: "byte"},
                    green: {idx: 1, type: "byte"},
                    blue: {idx: 2, type: "byte"}
                }
            },
            hsla: {
                props: {
                    hue: {idx: 0, type: "degrees"},
                    saturation: {idx: 1, type: "percent"},
                    lightness: {idx: 2, type: "percent"}
                }
            }
        }, p = {
            "byte": {floor: !0, max: 255},
            percent: {max: 1},
            degrees: {mod: 360, floor: !0}
        }, d = u.support = {}, f = t("<p>")[0], m = t.each;
        f.style.cssText = "background-color:rgba(1,1,1,.5)", d.rgba = f.style.backgroundColor.indexOf("rgba") > -1, m(c, function (e, t) {
            t.cache = "_" + e, t.props.alpha = {idx: 3, type: "percent", def: 1}
        }), u.fn = t.extend(u.prototype, {
            parse: function (r, o, l, h) {
                if (r === i)return this._rgba = [null, null, null, null], this;
                (r.jquery || r.nodeType) && (r = t(r).css(o), o = i);
                var p = this, d = t.type(r), f = this._rgba = [];
                return o !== i && (r = [r, o, l, h], d = "array"), "string" === d ? this.parse(s(r) || a._default) : "array" === d ? (m(c.rgba.props, function (e, t) {
                    f[t.idx] = n(r[t.idx], t)
                }), this) : "object" === d ? (r instanceof u ? m(c, function (e, t) {
                    r[t.cache] && (p[t.cache] = r[t.cache].slice())
                }) : m(c, function (t, i) {
                    var s = i.cache;
                    m(i.props, function (e, t) {
                        if (!p[s] && i.to) {
                            if ("alpha" === e || null == r[e])return;
                            p[s] = i.to(p._rgba)
                        }
                        p[s][t.idx] = n(r[e], t, !0)
                    }), p[s] && e.inArray(null, p[s].slice(0, 3)) < 0 && (p[s][3] = 1, i.from && (p._rgba = i.from(p[s])))
                }), this) : void 0
            }, is: function (e) {
                var t = u(e), i = !0, n = this;
                return m(c, function (e, s) {
                    var r, a = t[s.cache];
                    return a && (r = n[s.cache] || s.to && s.to(n._rgba) || [], m(s.props, function (e, t) {
                        return null != a[t.idx] ? i = a[t.idx] === r[t.idx] : void 0
                    })), i
                }), i
            }, _space: function () {
                var e = [], t = this;
                return m(c, function (i, n) {
                    t[n.cache] && e.push(i)
                }), e.pop()
            }, transition: function (e, t) {
                var i = u(e), s = i._space(), r = c[s], a = 0 === this.alpha() ? u("transparent") : this, o = a[r.cache] || r.to(a._rgba), l = o.slice();
                return i = i[r.cache], m(r.props, function (e, s) {
                    var r = s.idx, a = o[r], h = i[r], u = p[s.type] || {};
                    null !== h && (null === a ? l[r] = h : (u.mod && (h - a > u.mod / 2 ? a += u.mod : a - h > u.mod / 2 && (a -= u.mod)), l[r] = n((h - a) * t + a, s)))
                }), this[s](l)
            }, blend: function (e) {
                if (1 === this._rgba[3])return this;
                var i = this._rgba.slice(), n = i.pop(), s = u(e)._rgba;
                return u(t.map(i, function (e, t) {
                    return (1 - n) * s[t] + n * e
                }))
            }, toRgbaString: function () {
                var e = "rgba(", i = t.map(this._rgba, function (e, t) {
                    return null == e ? t > 2 ? 1 : 0 : e
                });
                return 1 === i[3] && (i.pop(), e = "rgb("), e + i.join() + ")"
            }, toHslaString: function () {
                var e = "hsla(", i = t.map(this.hsla(), function (e, t) {
                    return null == e && (e = t > 2 ? 1 : 0), t && 3 > t && (e = Math.round(100 * e) + "%"), e
                });
                return 1 === i[3] && (i.pop(), e = "hsl("), e + i.join() + ")"
            }, toHexString: function (e) {
                var i = this._rgba.slice(), n = i.pop();
                return e && i.push(~~(255 * n)), "#" + t.map(i, function (e) {
                    return e = (e || 0).toString(16), 1 === e.length ? "0" + e : e
                }).join("")
            }, toString: function () {
                return 0 === this._rgba[3] ? "transparent" : this.toRgbaString()
            }
        }), u.fn.parse.prototype = u.fn, c.hsla.to = function (e) {
            if (null == e[0] || null == e[1] || null == e[2])return [null, null, null, e[3]];
            var t, i, n = e[0] / 255, s = e[1] / 255, r = e[2] / 255, a = e[3], o = Math.max(n, s, r), l = Math.min(n, s, r), h = o - l, u = o + l, c = .5 * u;
            return t = l === o ? 0 : n === o ? 60 * (s - r) / h + 360 : s === o ? 60 * (r - n) / h + 120 : 60 * (n - s) / h + 240, i = 0 === c || 1 === c ? c : .5 >= c ? h / u : h / (2 - u), [Math.round(t) % 360, i, c, null == a ? 1 : a]
        }, c.hsla.from = function (e) {
            if (null == e[0] || null == e[1] || null == e[2])return [null, null, null, e[3]];
            var t = e[0] / 360, i = e[1], n = e[2], s = e[3], a = .5 >= n ? n * (1 + i) : n + i - n * i, o = 2 * n - a;
            return [Math.round(255 * r(o, a, t + 1 / 3)), Math.round(255 * r(o, a, t)), Math.round(255 * r(o, a, t - 1 / 3)), s]
        }, m(c, function (e, s) {
            var r = s.props, a = s.cache, o = s.to, h = s.from;
            u.fn[e] = function (e) {
                if (o && !this[a] && (this[a] = o(this._rgba)), e === i)return this[a].slice();
                var s, l = t.type(e), c = "array" === l || "object" === l ? e : arguments, p = this[a].slice();
                return m(r, function (e, t) {
                    var i = c["object" === l ? e : t.idx];
                    null == i && (i = p[t.idx]), p[t.idx] = n(i, t)
                }), h ? (s = u(h(p)), s[a] = p, s) : u(p)
            }, m(r, function (i, n) {
                u.fn[i] || (u.fn[i] = function (s) {
                    var r, a = t.type(s), o = "alpha" === i ? this._hsla ? "hsla" : "rgba" : e, h = this[o](), u = h[n.idx];
                    return "undefined" === a ? u : ("function" === a && (s = s.call(this, u), a = t.type(s)), null == s && n.empty ? this : ("string" === a && (r = l.exec(s), r && (s = u + parseFloat(r[2]) * ("+" === r[1] ? 1 : -1))), h[n.idx] = s, this[o](h)))
                })
            })
        }), m(o, function (e, i) {
            t.cssHooks[i] = {
                set: function (e, n) {
                    var r, a, o = "";
                    if ("string" !== t.type(n) || (r = s(n))) {
                        if (n = u(r || n), !d.rgba && 1 !== n._rgba[3]) {
                            for (a = "backgroundColor" === i ? e.parentNode : e; ("" === o || "transparent" === o) && a && a.style;)try {
                                o = t.css(a, "backgroundColor"), a = a.parentNode
                            } catch (l) {
                            }
                            n = n.blend(o && "transparent" !== o ? o : "_default")
                        }
                        n = n.toRgbaString()
                    }
                    try {
                        e.style[i] = n
                    } catch (h) {
                    }
                }
            }, t.fx.step[i] = function (e) {
                e.colorInit || (e.start = u(e.elem, i), e.end = u(e.end), e.colorInit = !0), t.cssHooks[i].set(e.elem, e.start.transition(e.end, e.pos))
            }
        }), t.cssHooks.borderColor = {
            expand: function (e) {
                var t = {};
                return m(["Top", "Right", "Bottom", "Left"], function (i, n) {
                    t["border" + n + "Color"] = e
                }), t
            }
        }, a = t.Color.names = {
            aqua: "#00ffff",
            black: "#000000",
            blue: "#0000ff",
            fuchsia: "#ff00ff",
            gray: "#808080",
            green: "#008000",
            lime: "#00ff00",
            maroon: "#800000",
            navy: "#000080",
            olive: "#808000",
            purple: "#800080",
            red: "#ff0000",
            silver: "#c0c0c0",
            teal: "#008080",
            white: "#ffffff",
            yellow: "#ffff00",
            transparent: [null, null, null, 0],
            _default: "#ffffff"
        }
    }(jQuery), function () {
        function i() {
            var t, i, n = this.ownerDocument.defaultView ? this.ownerDocument.defaultView.getComputedStyle(this, null) : this.currentStyle, s = {};
            if (n && n.length && n[0] && n[n[0]])for (i = n.length; i--;)t = n[i], "string" == typeof n[t] && (s[e.camelCase(t)] = n[t]); else for (t in n)"string" == typeof n[t] && (s[t] = n[t]);
            return s
        }

        function n(t, i) {
            var n, s, a = {};
            for (n in i)s = i[n], t[n] !== s && !r[n] && (e.fx.step[n] || !isNaN(parseFloat(s))) && (a[n] = s);
            return a
        }

        var s = ["add", "remove", "toggle"], r = {
            border: 1,
            borderBottom: 1,
            borderColor: 1,
            borderLeft: 1,
            borderRight: 1,
            borderTop: 1,
            borderWidth: 1,
            margin: 1,
            padding: 1
        };
        e.each(["borderLeftStyle", "borderRightStyle", "borderBottomStyle", "borderTopStyle"], function (t, i) {
            e.fx.step[i] = function (e) {
                ("none" !== e.end && !e.setAttr || 1 === e.pos && !e.setAttr) && (jQuery.style(e.elem, i, e.end), e.setAttr = !0)
            }
        }), e.effects.animateClass = function (t, r, a, o) {
            var l = e.speed(r, a, o);
            return this.queue(function () {
                var r, a = e(this), o = a.attr("class") || "", h = l.children ? a.find("*").andSelf() : a;
                h = h.map(function () {
                    var t = e(this);
                    return {el: t, start: i.call(this)}
                }), r = function () {
                    e.each(s, function (e, i) {
                        t[i] && a[i + "Class"](t[i])
                    })
                }, r(), h = h.map(function () {
                    return this.end = i.call(this.el[0]), this.diff = n(this.start, this.end), this
                }), a.attr("class", o), h = h.map(function () {
                    var t = this, i = e.Deferred(), n = jQuery.extend({}, l, {
                        queue: !1, complete: function () {
                            i.resolve(t)
                        }
                    });
                    return this.el.animate(this.diff, n), i.promise()
                }), e.when.apply(e, h.get()).done(function () {
                    r(), e.each(arguments, function () {
                        var t = this.el;
                        e.each(this.diff, function (e) {
                            t.css(e, "")
                        })
                    }), l.complete.call(a[0])
                })
            })
        }, e.fn.extend({
            _addClass: e.fn.addClass, addClass: function (t, i, n, s) {
                return i ? e.effects.animateClass.call(this, {add: t}, i, n, s) : this._addClass(t)
            }, _removeClass: e.fn.removeClass, removeClass: function (t, i, n, s) {
                return i ? e.effects.animateClass.call(this, {remove: t}, i, n, s) : this._removeClass(t)
            }, _toggleClass: e.fn.toggleClass, toggleClass: function (i, n, s, r, a) {
                return "boolean" == typeof n || n === t ? s ? e.effects.animateClass.call(this, n ? {add: i} : {remove: i}, s, r, a) : this._toggleClass(i, n) : e.effects.animateClass.call(this, {toggle: i}, n, s, r)
            }, switchClass: function (t, i, n, s, r) {
                return e.effects.animateClass.call(this, {add: i, remove: t}, n, s, r)
            }
        })
    }(), function () {
        function s(t, i, n, s) {
            return e.isPlainObject(t) && (i = t, t = t.effect), t = {effect: t}, null == i && (i = {}), e.isFunction(i) && (s = i, n = null, i = {}), ("number" == typeof i || e.fx.speeds[i]) && (s = n, n = i, i = {}), e.isFunction(n) && (s = n, n = null), i && e.extend(t, i), n = n || i.duration, t.duration = e.fx.off ? 0 : "number" == typeof n ? n : n in e.fx.speeds ? e.fx.speeds[n] : e.fx.speeds._default, t.complete = s || i.complete, t
        }

        function r(t) {
            return !t || "number" == typeof t || e.fx.speeds[t] ? !0 : "string" != typeof t || e.effects.effect[t] ? !1 : i && e.effects[t] ? !1 : !0
        }

        e.extend(e.effects, {
            version: "1.9.2", save: function (e, t) {
                for (var i = 0; i < t.length; i++)null !== t[i] && e.data(n + t[i], e[0].style[t[i]])
            }, restore: function (e, i) {
                var s, r;
                for (r = 0; r < i.length; r++)null !== i[r] && (s = e.data(n + i[r]), s === t && (s = ""), e.css(i[r], s))
            }, setMode: function (e, t) {
                return "toggle" === t && (t = e.is(":hidden") ? "show" : "hide"), t
            }, getBaseline: function (e, t) {
                var i, n;
                switch (e[0]) {
                    case"top":
                        i = 0;
                        break;
                    case"middle":
                        i = .5;
                        break;
                    case"bottom":
                        i = 1;
                        break;
                    default:
                        i = e[0] / t.height
                }
                switch (e[1]) {
                    case"left":
                        n = 0;
                        break;
                    case"center":
                        n = .5;
                        break;
                    case"right":
                        n = 1;
                        break;
                    default:
                        n = e[1] / t.width
                }
                return {x: n, y: i}
            }, createWrapper: function (t) {
                if (t.parent().is(".ui-effects-wrapper"))return t.parent();
                var i = {
                    width: t.outerWidth(!0),
                    height: t.outerHeight(!0),
                    "float": t.css("float")
                }, n = e("<div></div>").addClass("ui-effects-wrapper").css({
                    fontSize: "100%",
                    background: "transparent",
                    border: "none",
                    margin: 0,
                    padding: 0
                }), s = {width: t.width(), height: t.height()}, r = document.activeElement;
                try {
                    r.id
                } catch (a) {
                    r = document.body
                }
                return t.wrap(n), (t[0] === r || e.contains(t[0], r)) && e(r).focus(), n = t.parent(), "static" === t.css("position") ? (n.css({position: "relative"}), t.css({position: "relative"})) : (e.extend(i, {
                    position: t.css("position"),
                    zIndex: t.css("z-index")
                }), e.each(["top", "left", "bottom", "right"], function (e, n) {
                    i[n] = t.css(n), isNaN(parseInt(i[n], 10)) && (i[n] = "auto")
                }), t.css({
                    position: "relative",
                    top: 0,
                    left: 0,
                    right: "auto",
                    bottom: "auto"
                })), t.css(s), n.css(i).show()
            }, removeWrapper: function (t) {
                var i = document.activeElement;
                return t.parent().is(".ui-effects-wrapper") && (t.parent().replaceWith(t), (t[0] === i || e.contains(t[0], i)) && e(i).focus()), t
            }, setTransition: function (t, i, n, s) {
                return s = s || {}, e.each(i, function (e, i) {
                    var r = t.cssUnit(i);
                    r[0] > 0 && (s[i] = r[0] * n + r[1])
                }), s
            }
        }), e.fn.extend({
            effect: function () {
                function t(t) {
                    function i() {
                        e.isFunction(r) && r.call(s[0]), e.isFunction(t) && t()
                    }

                    var s = e(this), r = n.complete, a = n.mode;
                    (s.is(":hidden") ? "hide" === a : "show" === a) ? i() : o.call(s[0], n, i)
                }

                var n = s.apply(this, arguments), r = n.mode, a = n.queue, o = e.effects.effect[n.effect], l = !o && i && e.effects[n.effect];
                return e.fx.off || !o && !l ? r ? this[r](n.duration, n.complete) : this.each(function () {
                    n.complete && n.complete.call(this)
                }) : o ? a === !1 ? this.each(t) : this.queue(a || "fx", t) : l.call(this, {
                    options: n,
                    duration: n.duration,
                    callback: n.complete,
                    mode: n.mode
                })
            }, _show: e.fn.show, show: function (e) {
                if (r(e))return this._show.apply(this, arguments);
                var t = s.apply(this, arguments);
                return t.mode = "show", this.effect.call(this, t)
            }, _hide: e.fn.hide, hide: function (e) {
                if (r(e))return this._hide.apply(this, arguments);
                var t = s.apply(this, arguments);
                return t.mode = "hide", this.effect.call(this, t)
            }, __toggle: e.fn.toggle, toggle: function (t) {
                if (r(t) || "boolean" == typeof t || e.isFunction(t))return this.__toggle.apply(this, arguments);
                var i = s.apply(this, arguments);
                return i.mode = "toggle", this.effect.call(this, i)
            }, cssUnit: function (t) {
                var i = this.css(t), n = [];
                return e.each(["em", "px", "%", "pt"], function (e, t) {
                    i.indexOf(t) > 0 && (n = [parseFloat(i), t])
                }), n
            }
        })
    }(), function () {
        var t = {};
        e.each(["Quad", "Cubic", "Quart", "Quint", "Expo"], function (e, i) {
            t[i] = function (t) {
                return Math.pow(t, e + 2)
            }
        }), e.extend(t, {
            Sine: function (e) {
                return 1 - Math.cos(e * Math.PI / 2)
            }, Circ: function (e) {
                return 1 - Math.sqrt(1 - e * e)
            }, Elastic: function (e) {
                return 0 === e || 1 === e ? e : -Math.pow(2, 8 * (e - 1)) * Math.sin((80 * (e - 1) - 7.5) * Math.PI / 15)
            }, Back: function (e) {
                return e * e * (3 * e - 2)
            }, Bounce: function (e) {
                for (var t, i = 4; e < ((t = Math.pow(2, --i)) - 1) / 11;);
                return 1 / Math.pow(4, 3 - i) - 7.5625 * Math.pow((3 * t - 2) / 22 - e, 2)
            }
        }), e.each(t, function (t, i) {
            e.easing["easeIn" + t] = i, e.easing["easeOut" + t] = function (e) {
                return 1 - i(1 - e)
            }, e.easing["easeInOut" + t] = function (e) {
                return .5 > e ? i(2 * e) / 2 : 1 - i(-2 * e + 2) / 2
            }
        })
    }()
}(jQuery), function (e) {
    var t = /up|down|vertical/, i = /up|left|vertical|horizontal/;
    e.effects.effect.blind = function (n, s) {
        var r, a, o, l = e(this), h = ["position", "top", "bottom", "left", "right", "height", "width"], u = e.effects.setMode(l, n.mode || "hide"), c = n.direction || "up", p = t.test(c), d = p ? "height" : "width", f = p ? "top" : "left", m = i.test(c), g = {}, y = "show" === u;
        l.parent().is(".ui-effects-wrapper") ? e.effects.save(l.parent(), h) : e.effects.save(l, h), l.show(), r = e.effects.createWrapper(l).css({overflow: "hidden"}), a = r[d](), o = parseFloat(r.css(f)) || 0, g[d] = y ? a : 0, m || (l.css(p ? "bottom" : "right", 0).css(p ? "top" : "left", "auto").css({position: "absolute"}), g[f] = y ? o : a + o), y && (r.css(d, 0), m || r.css(f, o + a)), r.animate(g, {
            duration: n.duration,
            easing: n.easing,
            queue: !1,
            complete: function () {
                "hide" === u && l.hide(), e.effects.restore(l, h), e.effects.removeWrapper(l), s()
            }
        })
    }
}(jQuery), function (e) {
    e.effects.effect.bounce = function (t, i) {
        var n, s, r, a = e(this), o = ["position", "top", "bottom", "left", "right", "height", "width"], l = e.effects.setMode(a, t.mode || "effect"), h = "hide" === l, u = "show" === l, c = t.direction || "up", p = t.distance, d = t.times || 5, f = 2 * d + (u || h ? 1 : 0), m = t.duration / f, g = t.easing, y = "up" === c || "down" === c ? "top" : "left", v = "up" === c || "left" === c, b = a.queue(), L = b.length;
        for ((u || h) && o.push("opacity"), e.effects.save(a, o), a.show(), e.effects.createWrapper(a), p || (p = a["top" === y ? "outerHeight" : "outerWidth"]() / 3), u && (r = {opacity: 1}, r[y] = 0, a.css("opacity", 0).css(y, v ? 2 * -p : 2 * p).animate(r, m, g)), h && (p /= Math.pow(2, d - 1)), r = {}, r[y] = 0, n = 0; d > n; n++)s = {}, s[y] = (v ? "-=" : "+=") + p, a.animate(s, m, g).animate(r, m, g), p = h ? 2 * p : p / 2;
        h && (s = {opacity: 0}, s[y] = (v ? "-=" : "+=") + p, a.animate(s, m, g)), a.queue(function () {
            h && a.hide(), e.effects.restore(a, o), e.effects.removeWrapper(a), i()
        }), L > 1 && b.splice.apply(b, [1, 0].concat(b.splice(L, f + 1))), a.dequeue()
    }
}(jQuery), function (e) {
    e.effects.effect.clip = function (t, i) {
        var n, s, r, a = e(this), o = ["position", "top", "bottom", "left", "right", "height", "width"], l = e.effects.setMode(a, t.mode || "hide"), h = "show" === l, u = t.direction || "vertical", c = "vertical" === u, p = c ? "height" : "width", d = c ? "top" : "left", f = {};
        e.effects.save(a, o), a.show(), n = e.effects.createWrapper(a).css({overflow: "hidden"}), s = "IMG" === a[0].tagName ? n : a, r = s[p](), h && (s.css(p, 0), s.css(d, r / 2)), f[p] = h ? r : 0, f[d] = h ? 0 : r / 2, s.animate(f, {
            queue: !1,
            duration: t.duration,
            easing: t.easing,
            complete: function () {
                h || a.hide(), e.effects.restore(a, o), e.effects.removeWrapper(a), i()
            }
        })
    }
}(jQuery), function (e) {
    e.effects.effect.drop = function (t, i) {
        var n, s = e(this), r = ["position", "top", "bottom", "left", "right", "opacity", "height", "width"], a = e.effects.setMode(s, t.mode || "hide"), o = "show" === a, l = t.direction || "left", h = "up" === l || "down" === l ? "top" : "left", u = "up" === l || "left" === l ? "pos" : "neg", c = {opacity: o ? 1 : 0};
        e.effects.save(s, r), s.show(), e.effects.createWrapper(s), n = t.distance || s["top" === h ? "outerHeight" : "outerWidth"](!0) / 2, o && s.css("opacity", 0).css(h, "pos" === u ? -n : n), c[h] = (o ? "pos" === u ? "+=" : "-=" : "pos" === u ? "-=" : "+=") + n, s.animate(c, {
            queue: !1,
            duration: t.duration,
            easing: t.easing,
            complete: function () {
                "hide" === a && s.hide(), e.effects.restore(s, r), e.effects.removeWrapper(s), i()
            }
        })
    }
}(jQuery), function (e) {
    e.effects.effect.explode = function (t, i) {
        function n() {
            b.push(this), b.length === c * p && s()
        }

        function s() {
            d.css({visibility: "visible"}), e(b).remove(), m || d.hide(), i()
        }

        var r, a, o, l, h, u, c = t.pieces ? Math.round(Math.sqrt(t.pieces)) : 3, p = c, d = e(this), f = e.effects.setMode(d, t.mode || "hide"), m = "show" === f, g = d.show().css("visibility", "hidden").offset(), y = Math.ceil(d.outerWidth() / p), v = Math.ceil(d.outerHeight() / c), b = [];
        for (r = 0; c > r; r++)for (l = g.top + r * v, u = r - (c - 1) / 2, a = 0; p > a; a++)o = g.left + a * y, h = a - (p - 1) / 2, d.clone().appendTo("body").wrap("<div></div>").css({
            position: "absolute",
            visibility: "visible",
            left: -a * y,
            top: -r * v
        }).parent().addClass("ui-effects-explode").css({
            position: "absolute",
            overflow: "hidden",
            width: y,
            height: v,
            left: o + (m ? h * y : 0),
            top: l + (m ? u * v : 0),
            opacity: m ? 0 : 1
        }).animate({
            left: o + (m ? 0 : h * y),
            top: l + (m ? 0 : u * v),
            opacity: m ? 1 : 0
        }, t.duration || 500, t.easing, n)
    }
}(jQuery), function (e) {
    e.effects.effect.fade = function (t, i) {
        var n = e(this), s = e.effects.setMode(n, t.mode || "toggle");
        n.animate({opacity: s}, {queue: !1, duration: t.duration, easing: t.easing, complete: i})
    }
}(jQuery), function (e) {
    e.effects.effect.fold = function (t, i) {
        var n, s, r = e(this), a = ["position", "top", "bottom", "left", "right", "height", "width"], o = e.effects.setMode(r, t.mode || "hide"), l = "show" === o, h = "hide" === o, u = t.size || 15, c = /([0-9]+)%/.exec(u), p = !!t.horizFirst, d = l !== p, f = d ? ["width", "height"] : ["height", "width"], m = t.duration / 2, g = {}, y = {};
        e.effects.save(r, a), r.show(), n = e.effects.createWrapper(r).css({overflow: "hidden"}), s = d ? [n.width(), n.height()] : [n.height(), n.width()], c && (u = parseInt(c[1], 10) / 100 * s[h ? 0 : 1]), l && n.css(p ? {
            height: 0,
            width: u
        } : {
            height: u,
            width: 0
        }), g[f[0]] = l ? s[0] : u, y[f[1]] = l ? s[1] : 0, n.animate(g, m, t.easing).animate(y, m, t.easing, function () {
            h && r.hide(), e.effects.restore(r, a), e.effects.removeWrapper(r), i()
        })
    }
}(jQuery), function (e) {
    e.effects.effect.highlight = function (t, i) {
        var n = e(this), s = ["backgroundImage", "backgroundColor", "opacity"], r = e.effects.setMode(n, t.mode || "show"), a = {backgroundColor: n.css("backgroundColor")};
        "hide" === r && (a.opacity = 0), e.effects.save(n, s), n.show().css({
            backgroundImage: "none",
            backgroundColor: t.color || "#ffff99"
        }).animate(a, {
            queue: !1, duration: t.duration, easing: t.easing, complete: function () {
                "hide" === r && n.hide(), e.effects.restore(n, s), i()
            }
        })
    }
}(jQuery), function (e) {
    e.effects.effect.pulsate = function (t, i) {
        var n, s = e(this), r = e.effects.setMode(s, t.mode || "show"), a = "show" === r, o = "hide" === r, l = a || "hide" === r, h = 2 * (t.times || 5) + (l ? 1 : 0), u = t.duration / h, c = 0, p = s.queue(), d = p.length;
        for ((a || !s.is(":visible")) && (s.css("opacity", 0).show(), c = 1), n = 1; h > n; n++)s.animate({opacity: c}, u, t.easing), c = 1 - c;
        s.animate({opacity: c}, u, t.easing), s.queue(function () {
            o && s.hide(), i()
        }), d > 1 && p.splice.apply(p, [1, 0].concat(p.splice(d, h + 1))), s.dequeue()
    }
}(jQuery), function (e) {
    e.effects.effect.puff = function (t, i) {
        var n = e(this), s = e.effects.setMode(n, t.mode || "hide"), r = "hide" === s, a = parseInt(t.percent, 10) || 150, o = a / 100, l = {
            height: n.height(),
            width: n.width(),
            outerHeight: n.outerHeight(),
            outerWidth: n.outerWidth()
        };
        e.extend(t, {
            effect: "scale",
            queue: !1,
            fade: !0,
            mode: s,
            complete: i,
            percent: r ? a : 100,
            from: r ? l : {
                height: l.height * o,
                width: l.width * o,
                outerHeight: l.outerHeight * o,
                outerWidth: l.outerWidth * o
            }
        }), n.effect(t)
    }, e.effects.effect.scale = function (t, i) {
        var n = e(this), s = e.extend(!0, {}, t), r = e.effects.setMode(n, t.mode || "effect"), a = parseInt(t.percent, 10) || (0 === parseInt(t.percent, 10) ? 0 : "hide" === r ? 0 : 100), o = t.direction || "both", l = t.origin, h = {
            height: n.height(),
            width: n.width(),
            outerHeight: n.outerHeight(),
            outerWidth: n.outerWidth()
        }, u = {y: "horizontal" !== o ? a / 100 : 1, x: "vertical" !== o ? a / 100 : 1};
        s.effect = "size", s.queue = !1, s.complete = i, "effect" !== r && (s.origin = l || ["middle", "center"], s.restore = !0), s.from = t.from || ("show" === r ? {
                height: 0,
                width: 0,
                outerHeight: 0,
                outerWidth: 0
            } : h), s.to = {
            height: h.height * u.y,
            width: h.width * u.x,
            outerHeight: h.outerHeight * u.y,
            outerWidth: h.outerWidth * u.x
        }, s.fade && ("show" === r && (s.from.opacity = 0, s.to.opacity = 1), "hide" === r && (s.from.opacity = 1, s.to.opacity = 0)), n.effect(s)
    }, e.effects.effect.size = function (t, i) {
        var n, s, r, a = e(this), o = ["position", "top", "bottom", "left", "right", "width", "height", "overflow", "opacity"], l = ["position", "top", "bottom", "left", "right", "overflow", "opacity"], h = ["width", "height", "overflow"], u = ["fontSize"], c = ["borderTopWidth", "borderBottomWidth", "paddingTop", "paddingBottom"], p = ["borderLeftWidth", "borderRightWidth", "paddingLeft", "paddingRight"], d = e.effects.setMode(a, t.mode || "effect"), f = t.restore || "effect" !== d, m = t.scale || "both", g = t.origin || ["middle", "center"], y = a.css("position"), v = f ? o : l, b = {
            height: 0,
            width: 0,
            outerHeight: 0,
            outerWidth: 0
        };
        "show" === d && a.show(), n = {
            height: a.height(),
            width: a.width(),
            outerHeight: a.outerHeight(),
            outerWidth: a.outerWidth()
        }, "toggle" === t.mode && "show" === d ? (a.from = t.to || b, a.to = t.from || n) : (a.from = t.from || ("show" === d ? b : n), a.to = t.to || ("hide" === d ? b : n)), r = {
            from: {
                y: a.from.height / n.height,
                x: a.from.width / n.width
            }, to: {y: a.to.height / n.height, x: a.to.width / n.width}
        }, ("box" === m || "both" === m) && (r.from.y !== r.to.y && (v = v.concat(c), a.from = e.effects.setTransition(a, c, r.from.y, a.from), a.to = e.effects.setTransition(a, c, r.to.y, a.to)), r.from.x !== r.to.x && (v = v.concat(p), a.from = e.effects.setTransition(a, p, r.from.x, a.from), a.to = e.effects.setTransition(a, p, r.to.x, a.to))), ("content" === m || "both" === m) && r.from.y !== r.to.y && (v = v.concat(u).concat(h), a.from = e.effects.setTransition(a, u, r.from.y, a.from), a.to = e.effects.setTransition(a, u, r.to.y, a.to)), e.effects.save(a, v), a.show(), e.effects.createWrapper(a), a.css("overflow", "hidden").css(a.from), g && (s = e.effects.getBaseline(g, n), a.from.top = (n.outerHeight - a.outerHeight()) * s.y, a.from.left = (n.outerWidth - a.outerWidth()) * s.x, a.to.top = (n.outerHeight - a.to.outerHeight) * s.y, a.to.left = (n.outerWidth - a.to.outerWidth) * s.x), a.css(a.from), ("content" === m || "both" === m) && (c = c.concat(["marginTop", "marginBottom"]).concat(u), p = p.concat(["marginLeft", "marginRight"]), h = o.concat(c).concat(p), a.find("*[width]").each(function () {
            var i = e(this), n = {
                height: i.height(),
                width: i.width(),
                outerHeight: i.outerHeight(),
                outerWidth: i.outerWidth()
            };
            f && e.effects.save(i, h), i.from = {
                height: n.height * r.from.y,
                width: n.width * r.from.x,
                outerHeight: n.outerHeight * r.from.y,
                outerWidth: n.outerWidth * r.from.x
            }, i.to = {
                height: n.height * r.to.y,
                width: n.width * r.to.x,
                outerHeight: n.height * r.to.y,
                outerWidth: n.width * r.to.x
            }, r.from.y !== r.to.y && (i.from = e.effects.setTransition(i, c, r.from.y, i.from), i.to = e.effects.setTransition(i, c, r.to.y, i.to)), r.from.x !== r.to.x && (i.from = e.effects.setTransition(i, p, r.from.x, i.from), i.to = e.effects.setTransition(i, p, r.to.x, i.to)), i.css(i.from), i.animate(i.to, t.duration, t.easing, function () {
                f && e.effects.restore(i, h)
            })
        })), a.animate(a.to, {
            queue: !1, duration: t.duration, easing: t.easing, complete: function () {
                0 === a.to.opacity && a.css("opacity", a.from.opacity), "hide" === d && a.hide(), e.effects.restore(a, v), f || ("static" === y ? a.css({
                    position: "relative",
                    top: a.to.top,
                    left: a.to.left
                }) : e.each(["top", "left"], function (e, t) {
                    a.css(t, function (t, i) {
                        var n = parseInt(i, 10), s = e ? a.to.left : a.to.top;
                        return "auto" === i ? s + "px" : n + s + "px"
                    })
                })), e.effects.removeWrapper(a), i()
            }
        })
    }
}(jQuery), function (e) {
    e.effects.effect.shake = function (t, i) {
        var n, s = e(this), r = ["position", "top", "bottom", "left", "right", "height", "width"], a = e.effects.setMode(s, t.mode || "effect"), o = t.direction || "left", l = t.distance || 20, h = t.times || 3, u = 2 * h + 1, c = Math.round(t.duration / u), p = "up" === o || "down" === o ? "top" : "left", d = "up" === o || "left" === o, f = {}, m = {}, g = {}, y = s.queue(), v = y.length;
        for (e.effects.save(s, r), s.show(), e.effects.createWrapper(s), f[p] = (d ? "-=" : "+=") + l, m[p] = (d ? "+=" : "-=") + 2 * l, g[p] = (d ? "-=" : "+=") + 2 * l, s.animate(f, c, t.easing), n = 1; h > n; n++)s.animate(m, c, t.easing).animate(g, c, t.easing);
        s.animate(m, c, t.easing).animate(f, c / 2, t.easing).queue(function () {
            "hide" === a && s.hide(), e.effects.restore(s, r), e.effects.removeWrapper(s), i()
        }), v > 1 && y.splice.apply(y, [1, 0].concat(y.splice(v, u + 1))), s.dequeue()
    }
}(jQuery), function (e) {
    e.effects.effect.slide = function (t, i) {
        var n, s = e(this), r = ["position", "top", "bottom", "left", "right", "width", "height"], a = e.effects.setMode(s, t.mode || "show"), o = "show" === a, l = t.direction || "left", h = "up" === l || "down" === l ? "top" : "left", u = "up" === l || "left" === l, c = {};
        e.effects.save(s, r), s.show(), n = t.distance || s["top" === h ? "outerHeight" : "outerWidth"](!0), e.effects.createWrapper(s).css({overflow: "hidden"}), o && s.css(h, u ? isNaN(n) ? "-" + n : -n : n), c[h] = (o ? u ? "+=" : "-=" : u ? "-=" : "+=") + n, s.animate(c, {
            queue: !1,
            duration: t.duration,
            easing: t.easing,
            complete: function () {
                "hide" === a && s.hide(), e.effects.restore(s, r), e.effects.removeWrapper(s), i()
            }
        })
    }
}(jQuery), function (e) {
    e.effects.effect.transfer = function (t, i) {
        var n = e(this), s = e(t.to), r = "fixed" === s.css("position"), a = e("body"), o = r ? a.scrollTop() : 0, l = r ? a.scrollLeft() : 0, h = s.offset(), u = {
            top: h.top - o,
            left: h.left - l,
            height: s.innerHeight(),
            width: s.innerWidth()
        }, c = n.offset(), p = e('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(t.className).css({
            top: c.top - o,
            left: c.left - l,
            height: n.innerHeight(),
            width: n.innerWidth(),
            position: r ? "fixed" : "absolute"
        }).animate(u, t.duration, t.easing, function () {
            p.remove(), i()
        })
    }
}(jQuery), COMPLEXIFY_BANLIST = "000000|111111|11111111|112233|121212|123123|123456|1234567|12345678|123456789|131313|232323|654321|666666|696969|777777|7777777|8675309|987654|nnnnnn|nop123|nopqrs|noteglh|npprff|npprff14|npgvba|nyoreg|nyoregb|nyrkvf|nyrwnaqen|nyrwnaqeb|nznaqn|nzngrhe|nzrevpn|naqern|naqerj|natryn|natryf|navzny|nagubal|ncbyyb|nccyrf|nefrany|neguhe|nfqstu|nfuyrl|nffubyr|nhthfg|nhfgva|onqobl|onvyrl|onanan|onearl|onfronyy|ongzna|orngevm|ornire|ornivf|ovtpbpx|ovtqnqql|ovtqvpx|ovtqbt|ovtgvgf|oveqvr|ovgpurf|ovgrzr|oynmre|oybaqr|oybaqrf|oybjwbo|oybjzr|obaq007|obavgn|obaavr|obbobb|obbtre|obbzre|obfgba|oenaqba|oenaql|oenirf|oenmvy|oebapb|oebapbf|ohyyqbt|ohfgre|ohggre|ohggurnq|pnyiva|pnzneb|pnzreba|pnanqn|pncgnva|pneybf|pnegre|pnfcre|puneyrf|puneyvr|purrfr|puryfrn|purfgre|puvpntb|puvpxra|pbpnpbyn|pbssrr|pbyyrtr|pbzcnd|pbzchgre|pbafhzre|pbbxvr|pbbcre|pbeirggr|pbjobl|pbjoblf|pelfgny|phzzvat|phzfubg|qnxbgn|qnyynf|qnavry|qnavryyr|qroovr|qraavf|qvnoyb|qvnzbaq|qbpgbe|qbttvr|qbycuva|qbycuvaf|qbanyq|qentba|qernzf|qevire|rntyr1|rntyrf|rqjneq|rvafgrva|rebgvp|rfgeryyn|rkgerzr|snypba|sraqre|sreenev|sveroveq|svfuvat|sybevqn|sybjre|sylref|sbbgonyy|sberire|serqql|serrqbz|shpxrq|shpxre|shpxvat|shpxzr|shpxlbh|tnaqnys|tngrjnl|tngbef|trzvav|trbetr|tvnagf|tvatre|tvmzbqb|tbyqra|tbysre|tbeqba|tertbel|thvgne|thaare|unzzre|unaanu|uneqpber|uneyrl|urngure|uryczr|uragnv|ubpxrl|ubbgref|ubearl|ubgqbt|uhagre|uhagvat|vprzna|vybirlbh|vagrearg|vjnagh|wnpxvr|wnpxfba|wnthne|wnfzvar|wnfcre|wraavsre|wrerzl|wrffvpn|wbuaal|wbuafba|wbeqna|wbfrcu|wbfuhn|whavbe|whfgva|xvyyre|xavtug|ynqvrf|ynxref|ynhera|yrngure|yrtraq|yrgzrva|yvggyr|ybaqba|ybiref|znqqbt|znqvfba|znttvr|zntahz|znevar|znevcbfn|zneyobeb|znegva|zneiva|znfgre|zngevk|znggurj|znirevpx|znkjryy|zryvffn|zrzore|zreprqrf|zreyva|zvpunry|zvpuryyr|zvpxrl|zvqavtug|zvyyre|zvfgerff|zbavpn|zbaxrl|zbafgre|zbetna|zbgure|zbhagnva|zhssva|zhecul|zhfgnat|anxrq|anfpne|anguna|anhtugl|app1701|arjlbex|avpubynf|avpbyr|avccyr|avccyrf|byvire|benatr|cnpxref|cnagure|cnagvrf|cnexre|cnffjbeq|cnffjbeq1|cnffjbeq12|cnffjbeq123|cngevpx|crnpurf|crnahg|crccre|cunagbz|cubravk|cynlre|cyrnfr|cbbxvr|cbefpur|cevapr|cevaprff|cevingr|checyr|chffvrf|dnmjfk|djregl|djreglhv|enoovg|enpury|enpvat|envqref|envaobj|enatre|enatref|erorppn|erqfxvaf|erqfbk|erqjvatf|evpuneq|eboreg|eboregb|ebpxrg|ebfrohq|ehaare|ehfu2112|ehffvn|fnznagun|fnzzl|fnzfba|fnaqen|fnghea|fpbbol|fpbbgre|fpbecvb|fpbecvba|fronfgvna|frperg|frkfrk|funqbj|funaaba|funirq|fvreen|fvyire|fxvccl|fynlre|fzbxrl|fabbcl|fbppre|fbcuvr|fcnaxl|fcnexl|fcvqre|fdhveg|fevavinf|fgnegerx|fgnejnef|fgrryref|fgrira|fgvpxl|fghcvq|fhpprff|fhpxvg|fhzzre|fhafuvar|fhcrezna|fhesre|fjvzzvat|flqarl|grdhvreb|gnlybe|graavf|grerfn|grfgre|grfgvat|gurzna|gubznf|guhaqre|guk1138|gvssnal|gvtref|gvttre|gbzpng|gbctha|gblbgn|genivf|gebhoyr|gehfgab1|ghpxre|ghegyr|gjvggre|havgrq|intvan|ivpgbe|ivpgbevn|ivxvat|ibbqbb|iblntre|jnygre|jneevbe|jrypbzr|jungrire|jvyyvnz|jvyyvr|jvyfba|jvaare|jvafgba|jvagre|jvmneq|knivre|kkkkkk|kkkkkkkk|lnznun|lnaxrr|lnaxrrf|lryybj|mkpioa|mkpioaz|mmmmmm|password|1234|pussy|12345|dragon|qwerty|mustang|letmein|baseball|master|michael|football|shadow|monkey|abc123|pass|fuckme|6969|jordan|harley|ranger|iwantu|jennifer|hunter|fuck|2000|test|batman|trustno1|thomas|tigger|robert|access|love|buster|soccer|hockey|killer|george|sexy|andrew|charlie|superman|asshole|fuckyou|dallas|jessica|panties|pepper|1111|austin|william|daniel|golfer|summer|heather|hammer|yankees|joshua|maggie|biteme|enter|ashley|thunder|cowboy|silver|richard|fucker|orange|merlin|michelle|corvette|bigdog|cheese|matthew|patrick|martin|freedom|ginger|blowjob|nicole|sparky|yellow|camaro|secret|dick|falcon|taylor|bitch|hello|scooter|please|porsche|guitar|chelsea|black|diamond|nascar|jackson|cameron|computer|amanda|wizard|xxxxxxxx|money|phoenix|mickey|bailey|knight|iceman|tigers|purple|andrea|horny|dakota|aaaaaa|player|sunshine|morgan|starwars|boomer|cowboys|edward|charles|girls|booboo|coffee|xxxxxx|bulldog|ncc1701|rabbit|peanut|john|johnny|gandalf|spanky|winter|brandy|compaq|carlos|tennis|james|mike|brandon|fender|anthony|blowme|ferrari|cookie|chicken|maverick|chicago|joseph|diablo|sexsex|hardcore|willie|welcome|chris|panther|yamaha|justin|banana|driver|marine|angels|fishing|david|maddog|hooters|wilson|butthead|dennis|fucking|captain|bigdick|chester|smokey|xavier|steven|viking|snoopy|blue|eagles|winner|samantha|house|miller|flower|jack|firebird|butter|united|turtle|steelers|tiffany|zxcvbn|tomcat|golf|bond007|bear|tiger|doctor|gateway|gators|angel|junior|thx1138|porno|badboy|debbie|spider|melissa|booger|1212|flyers|fish|porn|matrix|teens|scooby|jason|walter|cumshot|boston|braves|yankee|lover|barney|victor|tucker|princess|mercedes|5150|doggie|zzzzzz|gunner|horney|bubba|2112|fred|johnson|xxxxx|tits|member|boobs|donald|bigdaddy|bronco|penis|voyager|rangers|birdie|trouble|white|topgun|bigtits|bitches|green|super|qazwsx|magic|lakers|rachel|slayer|scott|2222|asdf|video|london|7777|marlboro|srinivas|internet|action|carter|jasper|monster|teresa|jeremy|bill|crystal|peter|pussies|cock|beer|rocket|theman|oliver|prince|beach|amateur|muffin|redsox|star|testing|shannon|murphy|frank|hannah|dave|eagle1|11111|mother|nathan|raiders|steve|forever|angela|viper|ou812|jake|lovers|suckit|gregory|buddy|whatever|young|nicholas|lucky|helpme|jackie|monica|midnight|college|baby|cunt|brian|mark|startrek|sierra|leather|4444|beavis|bigcock|happy|sophie|ladies|naughty|giants|booty|blonde|fucked|golden|fire|sandra|pookie|packers|einstein|dolphins|chevy|winston|warrior|sammy|slut|zxcvbnm|nipples|power|victoria|asdfgh|vagina|toyota|travis|hotdog|paris|rock|xxxx|extreme|redskins|erotic|dirty|ford|freddy|arsenal|access14|wolf|nipple|iloveyou|alex|florida|eric|legend|movie|success|rosebud|jaguar|great|cool|cooper|1313|scorpio|mountain|madison|brazil|lauren|japan|naked|squirt|stars|apple|alexis|aaaa|bonnie|peaches|jasmine|kevin|matt|qwertyui|danielle|beaver|4321|4128|runner|swimming|dolphin|gordon|casper|stupid|shit|saturn|gemini|apples|august|3333|canada|blazer|cumming|hunting|kitty|rainbow|arthur|cream|calvin|shaved|surfer|samson|kelly|paul|mine|king|racing|5555|eagle|hentai|newyork|little|redwings|smith|sticky|cocacola|animal|broncos|private|skippy|marvin|blondes|enjoy|girl|apollo|parker|qwert|time|sydney|women|voodoo|magnum|juice|abgrtyu|dreams|maxwell|music|rush2112|russia|scorpion|rebecca|tester|mistress|phantom|billy|6666|albert|abcdef|password1|password12|password123|twitter".split("|"), function (e) {
    e.fn.extend({
        complexify: function (t, i) {
            function n(e, t) {
                for (var i = e.length - 1; i >= 0; i--)if (t[0] <= e.charCodeAt(i) && e.charCodeAt(i) <= t[1])return t[1] - t[0] + 1;
                return 0
            }

            function s(i) {
                if ("strict" === t.banMode) {
                    for (var n = 0; n < t.bannedPasswords.length; n++)if (-1 !== i.toLowerCase().indexOf(t.bannedPasswords[n].toLowerCase()))return !0;
                    return !1
                }
                return e.inArray(i, t.bannedPasswords) > -1 ? !0 : !1
            }

            function r() {
                var r = e(this).val(), h = 0, u = !1;
                if (s(r)) h = 1; else for (var c = l.length - 1; c >= 0; c--)h += n(r, l[c]);
                h = Math.log(Math.pow(h, r.length)) * (1 / t.strengthScaleFactor), u = h > a && r.length >= t.minimumChars, h = 100 * (h / o), h = h > 100 ? 100 : h, i.call(this, u, h)
            }

            var a = 49, o = 120, l = [[32, 32], [48, 57], [65, 90], [97, 122], [33, 47], [58, 64], [91, 96], [123, 126], [128, 255], [256, 383], [384, 591], [592, 687], [688, 767], [768, 879], [880, 1023], [1024, 1279], [1328, 1423], [1424, 1535], [1536, 1791], [1792, 1871], [1920, 1983], [2304, 2431], [2432, 2559], [2560, 2687], [2688, 2815], [2816, 2943], [2944, 3071], [3072, 3199], [3200, 3327], [3328, 3455], [3456, 3583], [3584, 3711], [3712, 3839], [3840, 4095], [4096, 4255], [4256, 4351], [4352, 4607], [4608, 4991], [5024, 5119], [5120, 5759], [5760, 5791], [5792, 5887], [6016, 6143], [6144, 6319], [7680, 7935], [7936, 8191], [8192, 8303], [8304, 8351], [8352, 8399], [8400, 8447], [8448, 8527], [8528, 8591], [8592, 8703], [8704, 8959], [8960, 9215], [9216, 9279], [9280, 9311], [9312, 9471], [9472, 9599], [9600, 9631], [9632, 9727], [9728, 9983], [9984, 10175], [10240, 10495], [11904, 12031], [12032, 12255], [12272, 12287], [12288, 12351], [12352, 12447], [12448, 12543], [12544, 12591], [12592, 12687], [12688, 12703], [12704, 12735], [12800, 13055], [13056, 13311], [13312, 19893], [19968, 40959], [40960, 42127], [42128, 42191], [44032, 55203], [55296, 56191], [56192, 56319], [56320, 57343], [57344, 63743], [63744, 64255], [64256, 64335], [64336, 65023], [65056, 65071], [65072, 65103], [65104, 65135], [65136, 65278], [65279, 65279], [65280, 65519], [65520, 65533]], h = {
                minimumChars: 8,
                strengthScaleFactor: 1,
                bannedPasswords: window.COMPLEXIFY_BANLIST || [],
                banMode: "strict"
            };
            return e.isFunction(t) && !i && (i = t, t = {}), t = e.extend(h, t), this.each(function () {
                e(this).val() && r.apply(this)
            }), this.each(function () {
                e(this).bind("keyup focus input propertychange mouseup", r)
            })
        }
    })
}(jQuery), function (e) {
    e.color = {}, e.color.make = function (t, i, n, s) {
        var r = {};
        return r.r = t || 0, r.g = i || 0, r.b = n || 0, r.a = null != s ? s : 1, r.add = function (e, t) {
            for (var i = 0; i < e.length; ++i)r[e.charAt(i)] += t;
            return r.normalize()
        }, r.scale = function (e, t) {
            for (var i = 0; i < e.length; ++i)r[e.charAt(i)] *= t;
            return r.normalize()
        }, r.toString = function () {
            return r.a >= 1 ? "rgb(" + [r.r, r.g, r.b].join(",") + ")" : "rgba(" + [r.r, r.g, r.b, r.a].join(",") + ")"
        }, r.normalize = function () {
            function e(e, t, i) {
                return e > t ? e : t > i ? i : t
            }

            return r.r = e(0, parseInt(r.r), 255), r.g = e(0, parseInt(r.g), 255), r.b = e(0, parseInt(r.b), 255), r.a = e(0, r.a, 1), r
        }, r.clone = function () {
            return e.color.make(r.r, r.b, r.g, r.a)
        }, r.normalize()
    }, e.color.extract = function (t, i) {
        var n;
        do {
            if (n = t.css(i).toLowerCase(), "" != n && "transparent" != n)break;
            t = t.parent()
        } while (!e.nodeName(t.get(0), "body"));
        return "rgba(0, 0, 0, 0)" == n && (n = "transparent"), e.color.parse(n)
    }, e.color.parse = function (i) {
        var n, s = e.color.make;
        if (n = /rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(i))return s(parseInt(n[1], 10), parseInt(n[2], 10), parseInt(n[3], 10));
        if (n = /rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(i))return s(parseInt(n[1], 10), parseInt(n[2], 10), parseInt(n[3], 10), parseFloat(n[4]));
        if (n = /rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(i))return s(2.55 * parseFloat(n[1]), 2.55 * parseFloat(n[2]), 2.55 * parseFloat(n[3]));
        if (n = /rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(i))return s(2.55 * parseFloat(n[1]), 2.55 * parseFloat(n[2]), 2.55 * parseFloat(n[3]), parseFloat(n[4]));
        if (n = /#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(i))return s(parseInt(n[1], 16), parseInt(n[2], 16), parseInt(n[3], 16));
        if (n = /#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(i))return s(parseInt(n[1] + n[1], 16), parseInt(n[2] + n[2], 16), parseInt(n[3] + n[3], 16));
        var r = e.trim(i).toLowerCase();
        return "transparent" == r ? s(255, 255, 255, 0) : (n = t[r] || [0, 0, 0], s(n[0], n[1], n[2]))
    };
    var t = {
        aqua: [0, 255, 255],
        azure: [240, 255, 255],
        beige: [245, 245, 220],
        black: [0, 0, 0],
        blue: [0, 0, 255],
        brown: [165, 42, 42],
        cyan: [0, 255, 255],
        darkblue: [0, 0, 139],
        darkcyan: [0, 139, 139],
        darkgrey: [169, 169, 169],
        darkgreen: [0, 100, 0],
        darkkhaki: [189, 183, 107],
        darkmagenta: [139, 0, 139],
        darkolivegreen: [85, 107, 47],
        darkorange: [255, 140, 0],
        darkorchid: [153, 50, 204],
        darkred: [139, 0, 0],
        darksalmon: [233, 150, 122],
        darkviolet: [148, 0, 211],
        fuchsia: [255, 0, 255],
        gold: [255, 215, 0],
        green: [0, 128, 0],
        indigo: [75, 0, 130],
        khaki: [240, 230, 140],
        lightblue: [173, 216, 230],
        lightcyan: [224, 255, 255],
        lightgreen: [144, 238, 144],
        lightgrey: [211, 211, 211],
        lightpink: [255, 182, 193],
        lightyellow: [255, 255, 224],
        lime: [0, 255, 0],
        magenta: [255, 0, 255],
        maroon: [128, 0, 0],
        navy: [0, 0, 128],
        olive: [128, 128, 0],
        orange: [255, 165, 0],
        pink: [255, 192, 203],
        purple: [128, 0, 128],
        violet: [128, 0, 128],
        red: [255, 0, 0],
        silver: [192, 192, 192],
        white: [255, 255, 255],
        yellow: [255, 255, 0]
    }
}(jQuery), function (e) {
    function t(t, s, r, a) {
        function o(e, t) {
            t = [Lt].concat(t);
            for (var i = 0; i < e.length; ++i)e[i].apply(this, t)
        }

        function l() {
            for (var t = 0; t < a.length; ++t) {
                var i = a[t];
                i.init(Lt), i.options && e.extend(!0, at, i.options)
            }
        }

        function h(t) {
            var i;
            for (e.extend(!0, at, t), null == at.xaxis.color && (at.xaxis.color = at.grid.color), null == at.yaxis.color && (at.yaxis.color = at.grid.color), null == at.xaxis.tickColor && (at.xaxis.tickColor = at.grid.tickColor), null == at.yaxis.tickColor && (at.yaxis.tickColor = at.grid.tickColor), null == at.grid.borderColor && (at.grid.borderColor = at.grid.color), null == at.grid.tickColor && (at.grid.tickColor = e.color.parse(at.grid.color).scale("a", .22).toString()), i = 0; i < Math.max(1, at.xaxes.length); ++i)at.xaxes[i] = e.extend(!0, {}, at.xaxis, at.xaxes[i]);
            for (i = 0; i < Math.max(1, at.yaxes.length); ++i)at.yaxes[i] = e.extend(!0, {}, at.yaxis, at.yaxes[i]);
            for (at.xaxis.noTicks && null == at.xaxis.ticks && (at.xaxis.ticks = at.xaxis.noTicks), at.yaxis.noTicks && null == at.yaxis.ticks && (at.yaxis.ticks = at.yaxis.noTicks), at.x2axis && (at.xaxes[1] = e.extend(!0, {}, at.xaxis, at.x2axis), at.xaxes[1].position = "top"), at.y2axis && (at.yaxes[1] = e.extend(!0, {}, at.yaxis, at.y2axis), at.yaxes[1].position = "right"), at.grid.coloredAreas && (at.grid.markings = at.grid.coloredAreas), at.grid.coloredAreasColor && (at.grid.markingsColor = at.grid.coloredAreasColor), at.lines && e.extend(!0, at.series.lines, at.lines), at.points && e.extend(!0, at.series.points, at.points), at.bars && e.extend(!0, at.series.bars, at.bars), null != at.shadowSize && (at.series.shadowSize = at.shadowSize), i = 0; i < at.xaxes.length; ++i)g(pt, i + 1).options = at.xaxes[i];
            for (i = 0; i < at.yaxes.length; ++i)g(dt, i + 1).options = at.yaxes[i];
            for (var n in bt)at.hooks[n] && at.hooks[n].length && (bt[n] = bt[n].concat(at.hooks[n]));
            o(bt.processOptions, [at])
        }

        function u(e) {
            rt = c(e), y(), v()
        }

        function c(t) {
            for (var i = [], n = 0; n < t.length; ++n) {
                var s = e.extend(!0, {}, at.series);
                null != t[n].data ? (s.data = t[n].data, delete t[n].data, e.extend(!0, s, t[n]), t[n].data = s.data) : s.data = t[n], i.push(s)
            }
            return i
        }

        function p(e, t) {
            var i = e[t + "axis"];
            return "object" == typeof i && (i = i.n), "number" != typeof i && (i = 1), i
        }

        function d() {
            return e.grep(pt.concat(dt), function (e) {
                return e
            })
        }

        function f(e) {
            var t, i, n = {};
            for (t = 0; t < pt.length; ++t)i = pt[t], i && i.used && (n["x" + i.n] = i.c2p(e.left));
            for (t = 0; t < dt.length; ++t)i = dt[t], i && i.used && (n["y" + i.n] = i.c2p(e.top));
            return void 0 !== n.x1 && (n.x = n.x1), void 0 !== n.y1 && (n.y = n.y1), n
        }

        function m(e) {
            var t, i, n, s = {};
            for (t = 0; t < pt.length; ++t)if (i = pt[t], i && i.used && (n = "x" + i.n, null == e[n] && 1 == i.n && (n = "x"), null != e[n])) {
                s.left = i.p2c(e[n]);
                break
            }
            for (t = 0; t < dt.length; ++t)if (i = dt[t], i && i.used && (n = "y" + i.n, null == e[n] && 1 == i.n && (n = "y"), null != e[n])) {
                s.top = i.p2c(e[n]);
                break
            }
            return s
        }

        function g(t, i) {
            return t[i - 1] || (t[i - 1] = {
                n: i,
                direction: t == pt ? "x" : "y",
                options: e.extend(!0, {}, t == pt ? at.xaxis : at.yaxis)
            }), t[i - 1]
        }

        function y() {
            var t, i = rt.length, n = [], s = [];
            for (t = 0; t < rt.length; ++t) {
                var r = rt[t].color;
                null != r && (--i, "number" == typeof r ? s.push(r) : n.push(e.color.parse(rt[t].color)))
            }
            for (t = 0; t < s.length; ++t)i = Math.max(i, s[t] + 1);
            var a = [], o = 0;
            for (t = 0; a.length < i;) {
                var l;
                l = at.colors.length == t ? e.color.make(100, 100, 100) : e.color.parse(at.colors[t]);
                var h = 1 == o % 2 ? -1 : 1;
                l.scale("rgb", 1 + .2 * h * Math.ceil(o / 2)), a.push(l), ++t, t >= at.colors.length && (t = 0, ++o)
            }
            var u, c = 0;
            for (t = 0; t < rt.length; ++t) {
                if (u = rt[t], null == u.color ? (u.color = a[c].toString(), ++c) : "number" == typeof u.color && (u.color = a[u.color].toString()), null == u.lines.show) {
                    var d, f = !0;
                    for (d in u)if (u[d] && u[d].show) {
                        f = !1;
                        break
                    }
                    f && (u.lines.show = !0)
                }
                u.xaxis = g(pt, p(u, "x")), u.yaxis = g(dt, p(u, "y"))
            }
        }

        function v() {
            function t(e, t, i) {
                t < e.datamin && t != -g && (e.datamin = t), i > e.datamax && i != g && (e.datamax = i)
            }

            var i, n, s, r, a, l, h, u, c, p, f = Number.POSITIVE_INFINITY, m = Number.NEGATIVE_INFINITY, g = Number.MAX_VALUE;
            for (e.each(d(), function (e, t) {
                t.datamin = f, t.datamax = m, t.used = !1
            }), i = 0; i < rt.length; ++i)a = rt[i], a.datapoints = {points: []}, o(bt.processRawData, [a, a.data, a.datapoints]);
            for (i = 0; i < rt.length; ++i) {
                a = rt[i];
                var y = a.data, v = a.datapoints.format;
                if (v || (v = [], v.push({x: !0, number: !0, required: !0}), v.push({
                        y: !0,
                        number: !0,
                        required: !0
                    }), (a.bars.show || a.lines.show && a.lines.fill) && (v.push({
                        y: !0,
                        number: !0,
                        required: !1,
                        defaultValue: 0
                    }), a.bars.horizontal && (delete v[v.length - 1].y, v[v.length - 1].x = !0)), a.datapoints.format = v), null == a.datapoints.pointsize)for (a.datapoints.pointsize = v.length, h = a.datapoints.pointsize, l = a.datapoints.points, insertSteps = a.lines.show && a.lines.steps, a.xaxis.used = a.yaxis.used = !0, n = s = 0; n < y.length; ++n, s += h) {
                    p = y[n];
                    var b = null == p;
                    if (!b)for (r = 0; h > r; ++r)u = p[r], c = v[r], c && (c.number && null != u && (u = +u, isNaN(u) ? u = null : 1 / 0 == u ? u = g : u == -1 / 0 && (u = -g)), null == u && (c.required && (b = !0), null != c.defaultValue && (u = c.defaultValue))), l[s + r] = u;
                    if (b)for (r = 0; h > r; ++r)u = l[s + r], null != u && (c = v[r], c.x && t(a.xaxis, u, u), c.y && t(a.yaxis, u, u)), l[s + r] = null; else if (insertSteps && s > 0 && null != l[s - h] && l[s - h] != l[s] && l[s - h + 1] != l[s + 1]) {
                        for (r = 0; h > r; ++r)l[s + h + r] = l[s + r];
                        l[s + 1] = l[s - h + 1], s += h
                    }
                }
            }
            for (i = 0; i < rt.length; ++i)a = rt[i], o(bt.processDatapoints, [a, a.datapoints]);
            for (i = 0; i < rt.length; ++i) {
                a = rt[i], l = a.datapoints.points, h = a.datapoints.pointsize;
                var L = f, w = f, O = m, C = m;
                for (n = 0; n < l.length; n += h)if (null != l[n])for (r = 0; h > r; ++r)u = l[n + r], c = v[r], c && u != g && u != -g && (c.x && (L > u && (L = u), u > O && (O = u)), c.y && (w > u && (w = u), u > C && (C = u)));
                if (a.bars.show) {
                    var x = "left" == a.bars.align ? 0 : -a.bars.barWidth / 2;
                    a.bars.horizontal ? (w += x, C += x + a.bars.barWidth) : (L += x, O += x + a.bars.barWidth)
                }
                t(a.xaxis, L, O), t(a.yaxis, w, C)
            }
            e.each(d(), function (e, t) {
                t.datamin == f && (t.datamin = null), t.datamax == m && (t.datamax = null)
            })
        }

        function b(i, n) {
            var s = document.createElement("canvas");
            return s.className = n, s.width = mt, s.height = gt, i || e(s).css({
                position: "absolute",
                left: 0,
                top: 0
            }), e(s).appendTo(t), s.getContext || (s = window.G_vmlCanvasManager.initElement(s)), s.getContext("2d").save(), s
        }

        function L() {
            if (mt = t.width(), gt = t.height(), 0 >= mt || 0 >= gt)throw"Invalid dimensions for plot, width = " + mt + ", height = " + gt
        }

        function w(e) {
            e.width != mt && (e.width = mt), e.height != gt && (e.height = gt);
            var t = e.getContext("2d");
            t.restore(), t.save()
        }

        function O() {
            var i, n = t.children("canvas.base"), s = t.children("canvas.overlay");
            0 == n.length || 0 == s ? (t.html(""), t.css({padding: 0}), "static" == t.css("position") && t.css("position", "relative"), L(), ot = b(!0, "base"), lt = b(!1, "overlay"), i = !1) : (ot = n.get(0), lt = s.get(0), i = !0), ut = ot.getContext("2d"), ct = lt.getContext("2d"), ht = e([lt, ot]), i && (t.data("plot").shutdown(), Lt.resize(), ct.clearRect(0, 0, mt, gt), ht.unbind(), t.children().not([ot, lt]).remove()), t.data("plot", Lt)
        }

        function C() {
            at.grid.hoverable && (ht.mousemove(q), ht.mouseleave(X)), at.grid.clickable && ht.click(Y), o(bt.bindEvents, [ht])
        }

        function x() {
            Ot && clearTimeout(Ot), ht.unbind("mousemove", q), ht.unbind("mouseleave", X), ht.unbind("click", Y), o(bt.shutdown, [ht])
        }

        function S(e) {
            function t(e) {
                return e
            }

            var i, n, s = e.options.transform || t, r = e.options.inverseTransform;
            "x" == e.direction ? (i = e.scale = yt / Math.abs(s(e.max) - s(e.min)), n = Math.min(s(e.max), s(e.min))) : (i = e.scale = vt / Math.abs(s(e.max) - s(e.min)), i = -i, n = Math.max(s(e.max), s(e.min))), e.p2c = s == t ? function (e) {
                return (e - n) * i
            } : function (e) {
                return (s(e) - n) * i
            }, e.c2p = r ? function (e) {
                return r(n + e / i)
            } : function (e) {
                return n + e / i
            }
        }

        function _(i) {
            function n(n, s) {
                return e('<div style="position:absolute;top:-10000px;' + s + 'font-size:smaller">' + '<div class="' + i.direction + "Axis " + i.direction + i.n + 'Axis">' + n.join("") + "</div></div>").appendTo(t)
            }

            var s, r, a, o = i.options, l = i.ticks || [], h = [], u = o.labelWidth, c = o.labelHeight;
            if ("x" == i.direction) {
                if (null == u && (u = Math.floor(mt / (l.length > 0 ? l.length : 1))), null == c) {
                    for (h = [], s = 0; s < l.length; ++s)r = l[s].label, r && h.push('<div class="tickLabel" style="float:left;width:' + u + 'px">' + r + "</div>");
                    h.length > 0 && (h.push('<div style="clear:left"></div>'), a = n(h, "width:10000px;"), c = a.height(), a.remove())
                }
            } else if (null == u || null == c) {
                for (s = 0; s < l.length; ++s)r = l[s].label, r && h.push('<div class="tickLabel">' + r + "</div>");
                h.length > 0 && (a = n(h, ""), null == u && (u = a.children().width()), null == c && (c = a.find("div.tickLabel").height()), a.remove())
            }
            null == u && (u = 0), null == c && (c = 0), i.labelWidth = u, i.labelHeight = c
        }

        function T(t) {
            var i = t.labelWidth, n = t.labelHeight, s = t.options.position, r = t.options.tickLength, a = at.grid.axisMargin, o = at.grid.labelMargin, l = "x" == t.direction ? pt : dt, h = e.grep(l, function (e) {
                return e && e.options.position == s && e.reserveSpace
            });
            e.inArray(t, h) == h.length - 1 && (a = 0), null == r && (r = "full");
            var u = e.grep(l, function (e) {
                return e && e.reserveSpace
            }), c = 0 == e.inArray(t, u);
            c || "full" != r || (r = 5), isNaN(+r) || (o += +r), "x" == t.direction ? (n += o, "bottom" == s ? (ft.bottom += n + a, t.box = {
                top: gt - ft.bottom,
                height: n
            }) : (t.box = {
                top: ft.top + a,
                height: n
            }, ft.top += n + a)) : (i += o, "left" == s ? (t.box = {
                left: ft.left + a,
                width: i
            }, ft.left += i + a) : (ft.right += i + a, t.box = {
                left: mt - ft.right,
                width: i
            })), t.position = s, t.tickLength = r, t.box.padding = o, t.innermost = c
        }

        function E(e) {
            "x" == e.direction ? (e.box.left = ft.left, e.box.width = yt) : (e.box.top = ft.top, e.box.height = vt)
        }

        function N() {
            var t, i = d();
            if (e.each(i, function (e, t) {
                    t.show = t.options.show, null == t.show && (t.show = t.used), t.reserveSpace = t.show || t.options.reserveSpace, P(t)
                }), allocatedAxes = e.grep(i, function (e) {
                    return e.reserveSpace
                }), ft.left = ft.right = ft.top = ft.bottom = 0, at.grid.show) {
                for (e.each(allocatedAxes, function (e, t) {
                    M(t), k(t), F(t, t.ticks), _(t)
                }), t = allocatedAxes.length - 1; t >= 0; --t)T(allocatedAxes[t]);
                var n = at.grid.minBorderMargin;
                if (null == n)for (n = 0, t = 0; t < rt.length; ++t)n = Math.max(n, rt[t].points.radius + rt[t].points.lineWidth / 2);
                for (var s in ft)ft[s] += at.grid.borderWidth, ft[s] = Math.max(n, ft[s])
            }
            yt = mt - ft.left - ft.right, vt = gt - ft.bottom - ft.top, e.each(i, function (e, t) {
                S(t)
            }), at.grid.show && (e.each(allocatedAxes, function (e, t) {
                E(t)
            }), z()), W()
        }

        function P(e) {
            var t = e.options, i = +(null != t.min ? t.min : e.datamin), n = +(null != t.max ? t.max : e.datamax), s = n - i;
            if (0 == s) {
                var r = 0 == n ? 1 : .01;
                null == t.min && (i -= r), (null == t.max || null != t.min) && (n += r)
            } else {
                var a = t.autoscaleMargin;
                null != a && (null == t.min && (i -= s * a, 0 > i && null != e.datamin && e.datamin >= 0 && (i = 0)), null == t.max && (n += s * a, n > 0 && null != e.datamax && e.datamax <= 0 && (n = 0)))
            }
            e.min = i, e.max = n
        }

        function M(t) {
            var i, s = t.options;
            i = "number" == typeof s.ticks && s.ticks > 0 ? s.ticks : .3 * Math.sqrt("x" == t.direction ? mt : gt);
            var r, a, o, l, h, u, c, p = (t.max - t.min) / i;
            if ("time" == s.mode) {
                var d = {
                    second: 1e3,
                    minute: 6e4,
                    hour: 36e5,
                    day: 864e5,
                    month: 2592e6,
                    year: 1e3 * 525949.2 * 60
                }, f = [[1, "second"], [2, "second"], [5, "second"], [10, "second"], [30, "second"], [1, "minute"], [2, "minute"], [5, "minute"], [10, "minute"], [30, "minute"], [1, "hour"], [2, "hour"], [4, "hour"], [8, "hour"], [12, "hour"], [1, "day"], [2, "day"], [3, "day"], [.25, "month"], [.5, "month"], [1, "month"], [2, "month"], [3, "month"], [6, "month"], [1, "year"]], m = 0;
                null != s.minTickSize && (m = "number" == typeof s.tickSize ? s.tickSize : s.minTickSize[0] * d[s.minTickSize[1]]);
                for (var h = 0; h < f.length - 1 && !(p < (f[h][0] * d[f[h][1]] + f[h + 1][0] * d[f[h + 1][1]]) / 2 && f[h][0] * d[f[h][1]] >= m); ++h);
                r = f[h][0], o = f[h][1], "year" == o && (u = Math.pow(10, Math.floor(Math.log(p / d.year) / Math.LN10)), c = p / d.year / u, r = 1.5 > c ? 1 : 3 > c ? 2 : 7.5 > c ? 5 : 10, r *= u), t.tickSize = s.tickSize || [r, o], a = function (e) {
                    var t = [], i = e.tickSize[0], s = e.tickSize[1], r = new Date(e.min), a = i * d[s];
                    "second" == s && r.setUTCSeconds(n(r.getUTCSeconds(), i)), "minute" == s && r.setUTCMinutes(n(r.getUTCMinutes(), i)), "hour" == s && r.setUTCHours(n(r.getUTCHours(), i)), "month" == s && r.setUTCMonth(n(r.getUTCMonth(), i)), "year" == s && r.setUTCFullYear(n(r.getUTCFullYear(), i)), r.setUTCMilliseconds(0), a >= d.minute && r.setUTCSeconds(0), a >= d.hour && r.setUTCMinutes(0), a >= d.day && r.setUTCHours(0), a >= 4 * d.day && r.setUTCDate(1), a >= d.year && r.setUTCMonth(0);
                    var o, l = 0, h = Number.NaN;
                    do if (o = h, h = r.getTime(), t.push(h), "month" == s)if (1 > i) {
                        r.setUTCDate(1);
                        var u = r.getTime();
                        r.setUTCMonth(r.getUTCMonth() + 1);
                        var c = r.getTime();
                        r.setTime(h + l * d.hour + (c - u) * i), l = r.getUTCHours(), r.setUTCHours(0)
                    } else r.setUTCMonth(r.getUTCMonth() + i); else"year" == s ? r.setUTCFullYear(r.getUTCFullYear() + i) : r.setTime(h + a); while (h < e.max && h != o);
                    return t
                }, l = function (t, i) {
                    var n = new Date(t);
                    if (null != s.timeformat)return e.plot.formatDate(n, s.timeformat, s.monthNames);
                    var r = i.tickSize[0] * d[i.tickSize[1]], a = i.max - i.min, o = s.twelveHourClock ? " %p" : "";
                    return fmt = r < d.minute ? "%h:%M:%S" + o : r < d.day ? a < 2 * d.day ? "%h:%M" + o : "%b %d %h:%M" + o : r < d.month ? "%b %d" : r < d.year ? a < d.year ? "%b" : "%b %y" : "%y", e.plot.formatDate(n, fmt, s.monthNames)
                }
            } else {
                var g = s.tickDecimals, y = -Math.floor(Math.log(p) / Math.LN10);
                null != g && y > g && (y = g), u = Math.pow(10, -y), c = p / u, 1.5 > c ? r = 1 : 3 > c ? (r = 2, c > 2.25 && (null == g || g >= y + 1) && (r = 2.5, ++y)) : r = 7.5 > c ? 5 : 10, r *= u, null != s.minTickSize && r < s.minTickSize && (r = s.minTickSize), t.tickDecimals = Math.max(0, null != g ? g : y), t.tickSize = s.tickSize || r, a = function (e) {
                    var t, i = [], s = n(e.min, e.tickSize), r = 0, a = Number.NaN;
                    do t = a, a = s + r * e.tickSize, i.push(a), ++r; while (a < e.max && a != t);
                    return i
                }, l = function (e, t) {
                    return e.toFixed(t.tickDecimals)
                }
            }
            if (null != s.alignTicksWithAxis) {
                var v = ("x" == t.direction ? pt : dt)[s.alignTicksWithAxis - 1];
                if (v && v.used && v != t) {
                    var b = a(t);
                    if (b.length > 0 && (null == s.min && (t.min = Math.min(t.min, b[0])), null == s.max && b.length > 1 && (t.max = Math.max(t.max, b[b.length - 1]))), a = function (e) {
                            var t, i, n = [];
                            for (i = 0; i < v.ticks.length; ++i)t = (v.ticks[i].v - v.min) / (v.max - v.min), t = e.min + t * (e.max - e.min), n.push(t);
                            return n
                        }, "time" != t.mode && null == s.tickDecimals) {
                        var L = Math.max(0, -Math.floor(Math.log(p) / Math.LN10) + 1), w = a(t);
                        w.length > 1 && /\..*0$/.test((w[1] - w[0]).toFixed(L)) || (t.tickDecimals = L)
                    }
                }
            }
            t.tickGenerator = a, t.tickFormatter = e.isFunction(s.tickFormatter) ? function (e, t) {
                return "" + s.tickFormatter(e, t)
            } : l
        }

        function k(t) {
            var i = t.options.ticks, n = [];
            null == i || "number" == typeof i && i > 0 ? n = t.tickGenerator(t) : i && (n = e.isFunction(i) ? i({
                min: t.min,
                max: t.max
            }) : i);
            var s, r;
            for (t.ticks = [], s = 0; s < n.length; ++s) {
                var a = null, o = n[s];
                "object" == typeof o ? (r = +o[0], o.length > 1 && (a = o[1])) : r = +o, null == a && (a = t.tickFormatter(r, t)), isNaN(r) || t.ticks.push({
                    v: r,
                    label: a
                })
            }
        }

        function F(e, t) {
            e.options.autoscaleMargin && t.length > 0 && (null == e.options.min && (e.min = Math.min(e.min, t[0].v)), null == e.options.max && t.length > 1 && (e.max = Math.max(e.max, t[t.length - 1].v)))
        }

        function D() {
            ut.clearRect(0, 0, mt, gt);
            var e = at.grid;
            e.show && e.backgroundColor && I(), e.show && !e.aboveData && R();
            for (var t = 0; t < rt.length; ++t)o(bt.drawSeries, [ut, rt[t]]), B(rt[t]);
            o(bt.draw, [ut]), e.show && e.aboveData && R()
        }

        function A(e, t) {
            var n, s, r, a, o = d();
            for (i = 0; i < o.length; ++i)if (n = o[i], n.direction == t && (a = t + n.n + "axis", e[a] || 1 != n.n || (a = t + "axis"), e[a])) {
                s = e[a].from, r = e[a].to;
                break
            }
            if (e[a] || (n = "x" == t ? pt[0] : dt[0], s = e[t + "1"], r = e[t + "2"]), null != s && null != r && s > r) {
                var l = s;
                s = r, r = l
            }
            return {from: s, to: r, axis: n}
        }

        function I() {
            ut.save(), ut.translate(ft.left, ft.top), ut.fillStyle = st(at.grid.backgroundColor, vt, 0, "rgba(255, 255, 255, 0)"), ut.fillRect(0, 0, yt, vt), ut.restore()
        }

        function R() {
            var t;
            ut.save(), ut.translate(ft.left, ft.top);
            var i = at.grid.markings;
            if (i) {
                if (e.isFunction(i)) {
                    var n = Lt.getAxes();
                    n.xmin = n.xaxis.min, n.xmax = n.xaxis.max, n.ymin = n.yaxis.min, n.ymax = n.yaxis.max, i = i(n)
                }
                for (t = 0; t < i.length; ++t) {
                    var s = i[t], r = A(s, "x"), a = A(s, "y");
                    null == r.from && (r.from = r.axis.min), null == r.to && (r.to = r.axis.max), null == a.from && (a.from = a.axis.min), null == a.to && (a.to = a.axis.max), r.to < r.axis.min || r.from > r.axis.max || a.to < a.axis.min || a.from > a.axis.max || (r.from = Math.max(r.from, r.axis.min), r.to = Math.min(r.to, r.axis.max), a.from = Math.max(a.from, a.axis.min), a.to = Math.min(a.to, a.axis.max), (r.from != r.to || a.from != a.to) && (r.from = r.axis.p2c(r.from), r.to = r.axis.p2c(r.to), a.from = a.axis.p2c(a.from), a.to = a.axis.p2c(a.to), r.from == r.to || a.from == a.to ? (ut.beginPath(), ut.strokeStyle = s.color || at.grid.markingsColor, ut.lineWidth = s.lineWidth || at.grid.markingsLineWidth, ut.moveTo(r.from, a.from), ut.lineTo(r.to, a.to), ut.stroke()) : (ut.fillStyle = s.color || at.grid.markingsColor, ut.fillRect(r.from, a.to, r.to - r.from, a.from - a.to))))
                }
            }
            for (var n = d(), o = at.grid.borderWidth, l = 0; l < n.length; ++l) {
                var h, u, c, p, f = n[l], m = f.box, g = f.tickLength;
                if (f.show && 0 != f.ticks.length) {
                    for (ut.strokeStyle = f.options.tickColor || e.color.parse(f.options.color).scale("a", .22).toString(), ut.lineWidth = 1, "x" == f.direction ? (h = 0, u = "full" == g ? "top" == f.position ? 0 : vt : m.top - ft.top + ("top" == f.position ? m.height : 0)) : (u = 0, h = "full" == g ? "left" == f.position ? 0 : yt : m.left - ft.left + ("left" == f.position ? m.width : 0)), f.innermost || (ut.beginPath(), c = p = 0, "x" == f.direction ? c = yt : p = vt, 1 == ut.lineWidth && (h = Math.floor(h) + .5, u = Math.floor(u) + .5), ut.moveTo(h, u), ut.lineTo(h + c, u + p), ut.stroke()), ut.beginPath(), t = 0; t < f.ticks.length; ++t) {
                        var y = f.ticks[t].v;
                        c = p = 0, y < f.min || y > f.max || "full" == g && o > 0 && (y == f.min || y == f.max) || ("x" == f.direction ? (h = f.p2c(y), p = "full" == g ? -vt : g, "top" == f.position && (p = -p)) : (u = f.p2c(y), c = "full" == g ? -yt : g, "left" == f.position && (c = -c)), 1 == ut.lineWidth && ("x" == f.direction ? h = Math.floor(h) + .5 : u = Math.floor(u) + .5), ut.moveTo(h, u), ut.lineTo(h + c, u + p))
                    }
                    ut.stroke()
                }
            }
            o && (ut.lineWidth = o, ut.strokeStyle = at.grid.borderColor, ut.strokeRect(-o / 2, -o / 2, yt + o, vt + o)), ut.restore()
        }

        function z() {
            t.find(".tickLabels").remove();
            for (var e = ['<div class="tickLabels" style="font-size:smaller">'], i = d(), n = 0; n < i.length; ++n) {
                var s = i[n], r = s.box;
                if (s.show) {
                    e.push('<div class="' + s.direction + "Axis " + s.direction + s.n + 'Axis" style="color:' + s.options.color + '">');
                    for (var a = 0; a < s.ticks.length; ++a) {
                        var o = s.ticks[a];
                        if (!(!o.label || o.v < s.min || o.v > s.max)) {
                            var l, h = {};
                            "x" == s.direction ? (l = "center", h.left = Math.round(ft.left + s.p2c(o.v) - s.labelWidth / 2), "bottom" == s.position ? h.top = r.top + r.padding : h.bottom = gt - (r.top + r.height - r.padding)) : (h.top = Math.round(ft.top + s.p2c(o.v) - s.labelHeight / 2), "left" == s.position ? (h.right = mt - (r.left + r.width - r.padding), l = "right") : (h.left = r.left + r.padding, l = "left")), h.width = s.labelWidth;
                            var u = ["position:absolute", "text-align:" + l];
                            for (var c in h)u.push(c + ":" + h[c] + "px");
                            e.push('<div class="tickLabel" style="' + u.join(";") + '">' + o.label + "</div>")
                        }
                    }
                    e.push("</div>")
                }
            }
            e.push("</div>"), t.append(e.join(""))
        }

        function B(e) {
            e.lines.show && U(e), e.bars.show && G(e), e.points.show && j(e)
        }

        function U(e) {
            function t(e, t, i, n, s) {
                var r = e.points, a = e.pointsize, o = null, l = null;
                ut.beginPath();
                for (var h = a; h < r.length; h += a) {
                    var u = r[h - a], c = r[h - a + 1], p = r[h], d = r[h + 1];
                    if (null != u && null != p) {
                        if (d >= c && c < s.min) {
                            if (d < s.min)continue;
                            u = (s.min - c) / (d - c) * (p - u) + u, c = s.min
                        } else if (c >= d && d < s.min) {
                            if (c < s.min)continue;
                            p = (s.min - c) / (d - c) * (p - u) + u, d = s.min
                        }
                        if (c >= d && c > s.max) {
                            if (d > s.max)continue;
                            u = (s.max - c) / (d - c) * (p - u) + u, c = s.max
                        } else if (d >= c && d > s.max) {
                            if (c > s.max)continue;
                            p = (s.max - c) / (d - c) * (p - u) + u, d = s.max
                        }
                        if (p >= u && u < n.min) {
                            if (p < n.min)continue;
                            c = (n.min - u) / (p - u) * (d - c) + c, u = n.min
                        } else if (u >= p && p < n.min) {
                            if (u < n.min)continue;
                            d = (n.min - u) / (p - u) * (d - c) + c, p = n.min
                        }
                        if (u >= p && u > n.max) {
                            if (p > n.max)continue;
                            c = (n.max - u) / (p - u) * (d - c) + c, u = n.max
                        } else if (p >= u && p > n.max) {
                            if (u > n.max)continue;
                            d = (n.max - u) / (p - u) * (d - c) + c, p = n.max
                        }
                        (u != o || c != l) && ut.moveTo(n.p2c(u) + t, s.p2c(c) + i), o = p, l = d, ut.lineTo(n.p2c(p) + t, s.p2c(d) + i)
                    }
                }
                ut.stroke()
            }

            function i(e, t, i) {
                for (var n = e.points, s = e.pointsize, r = Math.min(Math.max(0, i.min), i.max), a = 0, o = !1, l = 1, h = 0, u = 0; ;) {
                    if (s > 0 && a > n.length + s)break;
                    a += s;
                    var c = n[a - s], p = n[a - s + l], d = n[a], f = n[a + l];
                    if (o) {
                        if (s > 0 && null != c && null == d) {
                            u = a, s = -s, l = 2;
                            continue
                        }
                        if (0 > s && a == h + s) {
                            ut.fill(), o = !1, s = -s, l = 1, a = h = u + s;
                            continue
                        }
                    }
                    if (null != c && null != d) {
                        if (d >= c && c < t.min) {
                            if (d < t.min)continue;
                            p = (t.min - c) / (d - c) * (f - p) + p, c = t.min
                        } else if (c >= d && d < t.min) {
                            if (c < t.min)continue;
                            f = (t.min - c) / (d - c) * (f - p) + p, d = t.min
                        }
                        if (c >= d && c > t.max) {
                            if (d > t.max)continue;
                            p = (t.max - c) / (d - c) * (f - p) + p, c = t.max
                        } else if (d >= c && d > t.max) {
                            if (c > t.max)continue;
                            f = (t.max - c) / (d - c) * (f - p) + p, d = t.max
                        }
                        if (o || (ut.beginPath(), ut.moveTo(t.p2c(c), i.p2c(r)), o = !0), p >= i.max && f >= i.max) ut.lineTo(t.p2c(c), i.p2c(i.max)), ut.lineTo(t.p2c(d), i.p2c(i.max)); else if (p <= i.min && f <= i.min) ut.lineTo(t.p2c(c), i.p2c(i.min)), ut.lineTo(t.p2c(d), i.p2c(i.min)); else {
                            var m = c, g = d;
                            f >= p && p < i.min && f >= i.min ? (c = (i.min - p) / (f - p) * (d - c) + c, p = i.min) : p >= f && f < i.min && p >= i.min && (d = (i.min - p) / (f - p) * (d - c) + c, f = i.min), p >= f && p > i.max && f <= i.max ? (c = (i.max - p) / (f - p) * (d - c) + c, p = i.max) : f >= p && f > i.max && p <= i.max && (d = (i.max - p) / (f - p) * (d - c) + c, f = i.max), c != m && ut.lineTo(t.p2c(m), i.p2c(p)), ut.lineTo(t.p2c(c), i.p2c(p)), ut.lineTo(t.p2c(d), i.p2c(f)), d != g && (ut.lineTo(t.p2c(d), i.p2c(f)), ut.lineTo(t.p2c(g), i.p2c(f)))
                        }
                    }
                }
            }

            ut.save(), ut.translate(ft.left, ft.top), ut.lineJoin = "round";
            var n = e.lines.lineWidth, s = e.shadowSize;
            if (n > 0 && s > 0) {
                ut.lineWidth = s, ut.strokeStyle = "rgba(0,0,0,0.1)";
                var r = Math.PI / 18;
                t(e.datapoints, Math.sin(r) * (n / 2 + s / 2), Math.cos(r) * (n / 2 + s / 2), e.xaxis, e.yaxis), ut.lineWidth = s / 2, t(e.datapoints, Math.sin(r) * (n / 2 + s / 4), Math.cos(r) * (n / 2 + s / 4), e.xaxis, e.yaxis)
            }
            ut.lineWidth = n, ut.strokeStyle = e.color;
            var a = $(e.lines, e.color, 0, vt);
            a && (ut.fillStyle = a, i(e.datapoints, e.xaxis, e.yaxis)), n > 0 && t(e.datapoints, 0, 0, e.xaxis, e.yaxis), ut.restore()
        }

        function j(e) {
            function t(e, t, i, n, s, r, a, o) {
                for (var l = e.points, h = e.pointsize, u = 0; u < l.length; u += h) {
                    var c = l[u], p = l[u + 1];
                    null == c || c < r.min || c > r.max || p < a.min || p > a.max || (ut.beginPath(), c = r.p2c(c), p = a.p2c(p) + n, "circle" == o ? ut.arc(c, p, t, 0, s ? Math.PI : 2 * Math.PI, !1) : o(ut, c, p, t, s), ut.closePath(), i && (ut.fillStyle = i, ut.fill()), ut.stroke())
                }
            }

            ut.save(), ut.translate(ft.left, ft.top);
            var i = e.points.lineWidth, n = e.shadowSize, s = e.points.radius, r = e.points.symbol;
            if (i > 0 && n > 0) {
                var a = n / 2;
                ut.lineWidth = a, ut.strokeStyle = "rgba(0,0,0,0.1)", t(e.datapoints, s, null, a + a / 2, !0, e.xaxis, e.yaxis, r), ut.strokeStyle = "rgba(0,0,0,0.2)", t(e.datapoints, s, null, a / 2, !0, e.xaxis, e.yaxis, r)
            }
            ut.lineWidth = i, ut.strokeStyle = e.color, t(e.datapoints, s, $(e.points, e.color), 0, !1, e.xaxis, e.yaxis, r), ut.restore()
        }

        function H(e, t, i, n, s, r, a, o, l, h, u, c) {
            var p, d, f, m, g, y, v, b, L;
            u ? (b = y = v = !0, g = !1, p = i, d = e, m = t + n, f = t + s, p > d && (L = d, d = p, p = L, g = !0, y = !1)) : (g = y = v = !0, b = !1, p = e + n, d = e + s, f = i, m = t, f > m && (L = m, m = f, f = L, b = !0, v = !1)), d < o.min || p > o.max || m < l.min || f > l.max || (p < o.min && (p = o.min, g = !1), d > o.max && (d = o.max, y = !1), f < l.min && (f = l.min, b = !1), m > l.max && (m = l.max, v = !1), p = o.p2c(p), f = l.p2c(f), d = o.p2c(d), m = l.p2c(m), a && (h.beginPath(), h.moveTo(p, f), h.lineTo(p, m), h.lineTo(d, m), h.lineTo(d, f), h.fillStyle = a(f, m), h.fill()), c > 0 && (g || y || v || b) && (h.beginPath(), h.moveTo(p, f + r), g ? h.lineTo(p, m + r) : h.moveTo(p, m + r), v ? h.lineTo(d, m + r) : h.moveTo(d, m + r), y ? h.lineTo(d, f + r) : h.moveTo(d, f + r), b ? h.lineTo(p, f + r) : h.moveTo(p, f + r), h.stroke()))
        }

        function G(e) {
            function t(t, i, n, s, r, a, o) {
                for (var l = t.points, h = t.pointsize, u = 0; u < l.length; u += h)null != l[u] && H(l[u], l[u + 1], l[u + 2], i, n, s, r, a, o, ut, e.bars.horizontal, e.bars.lineWidth)
            }

            ut.save(), ut.translate(ft.left, ft.top), ut.lineWidth = e.bars.lineWidth, ut.strokeStyle = e.color;
            var i = "left" == e.bars.align ? 0 : -e.bars.barWidth / 2, n = e.bars.fill ? function (t, i) {
                return $(e.bars, e.color, t, i)
            } : null;
            t(e.datapoints, i, i + e.bars.barWidth, 0, n, e.xaxis, e.yaxis), ut.restore()
        }

        function $(t, i, n, s) {
            var r = t.fill;
            if (!r)return null;
            if (t.fillColor)return st(t.fillColor, n, s, i);
            var a = e.color.parse(i);
            return a.a = "number" == typeof r ? r : .4, a.normalize(), a.toString()
        }

        function W() {
            if (t.find(".legend").remove(), at.legend.show) {
                for (var i, n, s = [], r = !1, a = at.legend.labelFormatter, o = 0; o < rt.length; ++o)i = rt[o], n = i.label, n && (0 == o % at.legend.noColumns && (r && s.push("</tr>"), s.push("<tr>"), r = !0), a && (n = a(n, i)), s.push('<td class="legendColorBox"><div style="border:1px solid ' + at.legend.labelBoxBorderColor + ';padding:1px"><div style="width:4px;height:0;border:5px solid ' + i.color + ';overflow:hidden"></div></div></td>' + '<td class="legendLabel">' + n + "</td>"));
                if (r && s.push("</tr>"), 0 != s.length) {
                    var l = '<table style="font-size:smaller;color:' + at.grid.color + '">' + s.join("") + "</table>";
                    if (null != at.legend.container) e(at.legend.container).html(l); else {
                        var h = "", u = at.legend.position, c = at.legend.margin;
                        null == c[0] && (c = [c, c]), "n" == u.charAt(0) ? h += "top:" + (c[1] + ft.top) + "px;" : "s" == u.charAt(0) && (h += "bottom:" + (c[1] + ft.bottom) + "px;"), "e" == u.charAt(1) ? h += "right:" + (c[0] + ft.right) + "px;" : "w" == u.charAt(1) && (h += "left:" + (c[0] + ft.left) + "px;");
                        var p = e('<div class="legend">' + l.replace('style="', 'style="position:absolute;' + h + ";") + "</div>").appendTo(t);
                        if (0 != at.legend.backgroundOpacity) {
                            var d = at.legend.backgroundColor;
                            null == d && (d = at.grid.backgroundColor, d = d && "string" == typeof d ? e.color.parse(d) : e.color.extract(p, "background-color"), d.a = 1, d = d.toString());
                            var f = p.children();
                            e('<div style="position:absolute;width:' + f.width() + "px;height:" + f.height() + "px;" + h + "background-color:" + d + ';"> </div>').prependTo(p).css("opacity", at.legend.backgroundOpacity)
                        }
                    }
                }
            }
        }

        function V(e, t, i) {
            var n, s, r = at.grid.mouseActiveRadius, a = r * r + 1, o = null;
            for (n = rt.length - 1; n >= 0; --n)if (i(rt[n])) {
                var l = rt[n], h = l.xaxis, u = l.yaxis, c = l.datapoints.points, p = l.datapoints.pointsize, d = h.c2p(e), f = u.c2p(t), m = r / h.scale, g = r / u.scale;
                if (h.options.inverseTransform && (m = Number.MAX_VALUE), u.options.inverseTransform && (g = Number.MAX_VALUE), l.lines.show || l.points.show)for (s = 0; s < c.length; s += p) {
                    var y = c[s], v = c[s + 1];
                    if (null != y && !(y - d > m || -m > y - d || v - f > g || -g > v - f)) {
                        var b = Math.abs(h.p2c(y) - e), L = Math.abs(u.p2c(v) - t), w = b * b + L * L;
                        a > w && (a = w, o = [n, s / p])
                    }
                }
                if (l.bars.show && !o) {
                    var O = "left" == l.bars.align ? 0 : -l.bars.barWidth / 2, C = O + l.bars.barWidth;
                    for (s = 0; s < c.length; s += p) {
                        var y = c[s], v = c[s + 1], x = c[s + 2];
                        null != y && (rt[n].bars.horizontal ? d <= Math.max(x, y) && d >= Math.min(x, y) && f >= v + O && v + C >= f : d >= y + O && y + C >= d && f >= Math.min(x, v) && f <= Math.max(x, v)) && (o = [n, s / p])
                    }
                }
            }
            return o ? (n = o[0], s = o[1], p = rt[n].datapoints.pointsize, {
                datapoint: rt[n].datapoints.points.slice(s * p, (s + 1) * p),
                dataIndex: s,
                series: rt[n],
                seriesIndex: n
            }) : null
        }

        function q(e) {
            at.grid.hoverable && Z("plothover", e, function (e) {
                return 0 != e.hoverable
            })
        }

        function X(e) {
            at.grid.hoverable && Z("plothover", e, function () {
                return !1
            })
        }

        function Y(e) {
            Z("plotclick", e, function (e) {
                return 0 != e.clickable
            })
        }

        function Z(e, i, n) {
            var s = ht.offset(), r = i.pageX - s.left - ft.left, a = i.pageY - s.top - ft.top, o = f({left: r, top: a});
            o.pageX = i.pageX, o.pageY = i.pageY;
            var l = V(r, a, n);
            if (l && (l.pageX = parseInt(l.series.xaxis.p2c(l.datapoint[0]) + s.left + ft.left), l.pageY = parseInt(l.series.yaxis.p2c(l.datapoint[1]) + s.top + ft.top)), at.grid.autoHighlight) {
                for (var h = 0; h < wt.length; ++h) {
                    var u = wt[h];
                    u.auto != e || l && u.series == l.series && u.point[0] == l.datapoint[0] && u.point[1] == l.datapoint[1] || et(u.series, u.point)
                }
                l && Q(l.series, l.datapoint, e)
            }
            t.trigger(e, [o, l])
        }

        function K() {
            Ot || (Ot = setTimeout(J, 30))
        }

        function J() {
            Ot = null, ct.save(), ct.clearRect(0, 0, mt, gt), ct.translate(ft.left, ft.top);
            var e, t;
            for (e = 0; e < wt.length; ++e)t = wt[e], t.series.bars.show ? nt(t.series, t.point) : it(t.series, t.point);
            ct.restore(), o(bt.drawOverlay, [ct])
        }

        function Q(e, t, i) {
            if ("number" == typeof e && (e = rt[e]), "number" == typeof t) {
                var n = e.datapoints.pointsize;
                t = e.datapoints.points.slice(n * t, n * (t + 1))
            }
            var s = tt(e, t);
            -1 == s ? (wt.push({series: e, point: t, auto: i}), K()) : i || (wt[s].auto = !1)
        }

        function et(e, t) {
            null == e && null == t && (wt = [], K()), "number" == typeof e && (e = rt[e]), "number" == typeof t && (t = e.data[t]);
            var i = tt(e, t);
            -1 != i && (wt.splice(i, 1), K())
        }

        function tt(e, t) {
            for (var i = 0; i < wt.length; ++i) {
                var n = wt[i];
                if (n.series == e && n.point[0] == t[0] && n.point[1] == t[1])return i
            }
            return -1
        }

        function it(t, i) {
            var n = i[0], s = i[1], r = t.xaxis, a = t.yaxis;
            if (!(n < r.min || n > r.max || s < a.min || s > a.max)) {
                var o = t.points.radius + t.points.lineWidth / 2;
                ct.lineWidth = o, ct.strokeStyle = e.color.parse(t.color).scale("a", .5).toString();
                var l = 1.5 * o, n = r.p2c(n), s = a.p2c(s);
                ct.beginPath(), "circle" == t.points.symbol ? ct.arc(n, s, l, 0, 2 * Math.PI, !1) : t.points.symbol(ct, n, s, l, !1), ct.closePath(), ct.stroke()
            }
        }

        function nt(t, i) {
            ct.lineWidth = t.bars.lineWidth, ct.strokeStyle = e.color.parse(t.color).scale("a", .5).toString();
            var n = e.color.parse(t.color).scale("a", .5).toString(), s = "left" == t.bars.align ? 0 : -t.bars.barWidth / 2;
            H(i[0], i[1], i[2] || 0, s, s + t.bars.barWidth, 0, function () {
                return n
            }, t.xaxis, t.yaxis, ct, t.bars.horizontal, t.bars.lineWidth)
        }

        function st(t, i, n, s) {
            if ("string" == typeof t)return t;
            for (var r = ut.createLinearGradient(0, n, 0, i), a = 0, o = t.colors.length; o > a; ++a) {
                var l = t.colors[a];
                if ("string" != typeof l) {
                    var h = e.color.parse(s);
                    null != l.brightness && (h = h.scale("rgb", l.brightness)), null != l.opacity && (h.a *= l.opacity), l = h.toString()
                }
                r.addColorStop(a / (o - 1), l)
            }
            return r
        }

        var rt = [], at = {
            colors: ["#edc240", "#afd8f8", "#cb4b4b", "#4da74d", "#9440ed"],
            legend: {
                show: !0,
                noColumns: 1,
                labelFormatter: null,
                labelBoxBorderColor: "#ccc",
                container: null,
                position: "ne",
                margin: 5,
                backgroundColor: null,
                backgroundOpacity: .85
            },
            xaxis: {
                show: null,
                position: "bottom",
                mode: null,
                color: null,
                tickColor: null,
                transform: null,
                inverseTransform: null,
                min: null,
                max: null,
                autoscaleMargin: null,
                ticks: null,
                tickFormatter: null,
                labelWidth: null,
                labelHeight: null,
                reserveSpace: null,
                tickLength: null,
                alignTicksWithAxis: null,
                tickDecimals: null,
                tickSize: null,
                minTickSize: null,
                monthNames: null,
                timeformat: null,
                twelveHourClock: !1
            },
            yaxis: {autoscaleMargin: .02, position: "left"},
            xaxes: [],
            yaxes: [],
            series: {
                points: {show: !1, radius: 3, lineWidth: 2, fill: !0, fillColor: "#ffffff", symbol: "circle"},
                lines: {lineWidth: 2, fill: !1, fillColor: null, steps: !1},
                bars: {show: !1, lineWidth: 2, barWidth: 1, fill: !0, fillColor: null, align: "left", horizontal: !1},
                shadowSize: 3
            },
            grid: {
                show: !0,
                aboveData: !1,
                color: "#545454",
                backgroundColor: null,
                borderColor: null,
                tickColor: null,
                labelMargin: 5,
                axisMargin: 8,
                borderWidth: 2,
                minBorderMargin: null,
                markings: null,
                markingsColor: "#f4f4f4",
                markingsLineWidth: 2,
                clickable: !1,
                hoverable: !1,
                autoHighlight: !0,
                mouseActiveRadius: 10
            },
            hooks: {}
        }, ot = null, lt = null, ht = null, ut = null, ct = null, pt = [], dt = [], ft = {
            left: 0,
            right: 0,
            top: 0,
            bottom: 0
        }, mt = 0, gt = 0, yt = 0, vt = 0, bt = {
            processOptions: [],
            processRawData: [],
            processDatapoints: [],
            drawSeries: [],
            draw: [],
            bindEvents: [],
            drawOverlay: [],
            shutdown: []
        }, Lt = this;
        Lt.setData = u, Lt.setupGrid = N, Lt.draw = D, Lt.getPlaceholder = function () {
            return t
        }, Lt.getCanvas = function () {
            return ot
        }, Lt.getPlotOffset = function () {
            return ft
        }, Lt.width = function () {
            return yt
        }, Lt.height = function () {
            return vt
        }, Lt.offset = function () {
            var e = ht.offset();
            return e.left += ft.left, e.top += ft.top, e
        }, Lt.getData = function () {
            return rt
        }, Lt.getAxes = function () {
            var t = {};
            return e.each(pt.concat(dt), function (e, i) {
                i && (t[i.direction + (1 != i.n ? i.n : "") + "axis"] = i)
            }), t
        }, Lt.getXAxes = function () {
            return pt
        }, Lt.getYAxes = function () {
            return dt
        }, Lt.c2p = f, Lt.p2c = m, Lt.getOptions = function () {
            return at
        }, Lt.highlight = Q, Lt.unhighlight = et, Lt.triggerRedrawOverlay = K, Lt.pointOffset = function (e) {
            return {
                left: parseInt(pt[p(e, "x") - 1].p2c(+e.x) + ft.left),
                top: parseInt(dt[p(e, "y") - 1].p2c(+e.y) + ft.top)
            }
        }, Lt.shutdown = x, Lt.resize = function () {
            L(), w(ot), w(lt)
        }, Lt.hooks = bt, l(Lt), h(r), O(), u(s), N(), D(), C();
        var wt = [], Ot = null
    }

    function n(e, t) {
        return t * Math.floor(e / t)
    }

    e.plot = function (i, n, s) {
        var r = new t(e(i), n, s, e.plot.plugins);
        return r
    }, e.plot.version = "0.7", e.plot.plugins = [], e.plot.formatDate = function (e, t, i) {
        var n = function (e) {
            return e = "" + e, 1 == e.length ? "0" + e : e
        }, s = [], r = !1, a = !1, o = e.getUTCHours(), l = 12 > o;
        null == i && (i = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]), -1 != t.search(/%p|%P/) && (o > 12 ? o -= 12 : 0 == o && (o = 12));
        for (var h = 0; h < t.length; ++h) {
            var u = t.charAt(h);
            if (r) {
                switch (u) {
                    case"h":
                        u = "" + o;
                        break;
                    case"H":
                        u = n(o);
                        break;
                    case"M":
                        u = n(e.getUTCMinutes());
                        break;
                    case"S":
                        u = n(e.getUTCSeconds());
                        break;
                    case"d":
                        u = "" + e.getUTCDate();
                        break;
                    case"m":
                        u = "" + (e.getUTCMonth() + 1);
                        break;
                    case"y":
                        u = "" + e.getUTCFullYear();
                        break;
                    case"b":
                        u = "" + i[e.getUTCMonth()];
                        break;
                    case"p":
                        u = l ? "am" : "pm";
                        break;
                    case"P":
                        u = l ? "AM" : "PM";
                        break;
                    case"0":
                        u = "", a = !0
                }
                u && a && (u = n(u), a = !1), s.push(u), a || (r = !1)
            } else"%" == u ? r = !0 : s.push(u)
        }
        return s.join("")
    }
}(jQuery), function (e) {
    function t(t) {
        function s(e, t) {
            t.series.pie.show && (t.grid.show = !1, "auto" == t.series.pie.label.show && (t.series.pie.label.show = t.legend.show ? !1 : !0), "auto" == t.series.pie.radius && (t.series.pie.radius = t.series.pie.label.show ? .75 : 1), t.series.pie.tilt > 1 && (t.series.pie.tilt = 1), t.series.pie.tilt < 0 && (t.series.pie.tilt = 0), e.hooks.processDatapoints.push(o), e.hooks.drawOverlay.push(O), e.hooks.draw.push(c))
        }

        function r(e, t) {
            var i = e.getOptions();
            i.series.pie.show && i.grid.hoverable && t.unbind("mousemove").mousemove(m), i.series.pie.show && i.grid.clickable && t.unbind("click").click(g)
        }

        function a(e) {
            for (var t = 0; t < e.length; ++t) {
                var i = parseFloat(e[t].data[0][1]);
                i && (N += i)
            }
        }

        function o(t) {
            D || (D = !0, C = t.getCanvas(), S = e(C).parent(), n = t.getOptions(), t.setData(u(t.getData())))
        }

        function l() {
            F = S.children().filter(".legend").children().width(), _ = Math.min(C.width, C.height / n.series.pie.tilt) / 2, E = C.height / 2 + n.series.pie.offset.top, T = C.width / 2, "auto" == n.series.pie.offset.left ? n.legend.position.match("w") ? T += F / 2 : T -= F / 2 : T += n.series.pie.offset.left, _ > T ? T = _ : T > C.width - _ && (T = C.width - _)
        }

        function h(e) {
            for (var t = 0; t < e.length; ++t)"number" == typeof e[t].data ? e[t].data = [[1, e[t].data]] : ("undefined" == typeof e[t].data || "undefined" == typeof e[t].data[0]) && ("undefined" != typeof e[t].data && "undefined" != typeof e[t].data.label && (e[t].label = e[t].data.label), e[t].data = [[1, 0]]);
            return e
        }

        function u(e) {
            e = h(e), a(e);
            for (var t = 0, i = 0, s = n.series.pie.combine.color, r = [], o = 0; o < e.length; ++o)e[o].data[0][1] = parseFloat(e[o].data[0][1]), e[o].data[0][1] || (e[o].data[0][1] = 0), e[o].data[0][1] / N <= n.series.pie.combine.threshold ? (t += e[o].data[0][1], i++, s || (s = e[o].color)) : r.push({
                data: [[1, e[o].data[0][1]]],
                color: e[o].color,
                label: e[o].label,
                angle: e[o].data[0][1] * 2 * Math.PI / N,
                percent: 100 * (e[o].data[0][1] / N)
            });
            return i > 0 && r.push({
                data: [[1, t]],
                color: s,
                label: n.series.pie.combine.label,
                angle: t * 2 * Math.PI / N,
                percent: 100 * (t / N)
            }), r
        }

        function c(t, i) {
            function s() {
                ctx.clearRect(0, 0, C.width, C.height), S.children().filter(".pieLabel, .pieLabelBackground").remove()
            }

            function r() {
                var e = 5, t = 15, i = 10, s = .02;
                if (n.series.pie.radius > 1)var r = n.series.pie.radius; else var r = _ * n.series.pie.radius;
                if (!(r >= C.width / 2 - e || r * n.series.pie.tilt >= C.height / 2 - t || i >= r)) {
                    ctx.save(), ctx.translate(e, t), ctx.globalAlpha = s, ctx.fillStyle = "#000", ctx.translate(T, E), ctx.scale(1, n.series.pie.tilt);
                    for (var a = 1; i >= a; a++)ctx.beginPath(), ctx.arc(0, 0, r, 0, 2 * Math.PI, !1), ctx.fill(), r -= a;
                    ctx.restore()
                }
            }

            function a() {
                function t(t, i, n) {
                    0 >= t || (n ? ctx.fillStyle = i : (ctx.strokeStyle = i, ctx.lineJoin = "round"), ctx.beginPath(), Math.abs(t - 2 * Math.PI) > 1e-9 ? ctx.moveTo(0, 0) : e.browser.msie && (t -= 1e-4), ctx.arc(0, 0, s, r, r + t, !1), ctx.closePath(), r += t, n ? ctx.fill() : ctx.stroke())
                }

                function i() {
                    function t(t, i, r) {
                        if (0 != t.data[0][1]) {
                            var a, o = n.legend.labelFormatter, l = n.series.pie.label.formatter;
                            a = o ? o(t.label, t) : t.label, l && (a = l(a, t));
                            var h = (i + t.angle + i) / 2, u = T + Math.round(Math.cos(h) * s), c = E + Math.round(Math.sin(h) * s) * n.series.pie.tilt, p = '<span class="pieLabel" id="pieLabel' + r + '" style="position:absolute;top:' + c + "px;left:" + u + 'px;">' + a + "</span>";
                            S.append(p);
                            var d = S.children("#pieLabel" + r), f = c - d.height() / 2, m = u - d.width() / 2;
                            if (d.css("top", f), d.css("left", m), (0 - f > 0 || 0 - m > 0 || C.height - (f + d.height()) < 0 || C.width - (m + d.width()) < 0) && (P = !0), 0 != n.series.pie.label.background.opacity) {
                                var g = n.series.pie.label.background.color;
                                null == g && (g = t.color);
                                var y = "top:" + f + "px;left:" + m + "px;";
                                e('<div class="pieLabelBackground" style="position:absolute;width:' + d.width() + "px;height:" + d.height() + "px;" + y + "background-color:" + g + ';"> </div>').insertBefore(d).css("opacity", n.series.pie.label.background.opacity)
                            }
                        }
                    }

                    var i = startAngle;
                    if (n.series.pie.label.radius > 1)var s = n.series.pie.label.radius; else var s = _ * n.series.pie.label.radius;
                    for (var r = 0; r < o.length; ++r)o[r].percent >= 100 * n.series.pie.label.threshold && t(o[r], i, r), i += o[r].angle
                }

                if (startAngle = Math.PI * n.series.pie.startAngle, n.series.pie.radius > 1)var s = n.series.pie.radius; else var s = _ * n.series.pie.radius;
                ctx.save(), ctx.translate(T, E), ctx.scale(1, n.series.pie.tilt), ctx.save();
                for (var r = startAngle, a = 0; a < o.length; ++a)o[a].startAngle = r, t(o[a].angle, o[a].color, !0);
                ctx.restore(), ctx.save(), ctx.lineWidth = n.series.pie.stroke.width, r = startAngle;
                for (var a = 0; a < o.length; ++a)t(o[a].angle, n.series.pie.stroke.color, !1);
                ctx.restore(), p(ctx), n.series.pie.label.show && i(), ctx.restore()
            }

            if (S) {
                ctx = i, l();
                for (var o = t.getData(), h = 0; P && M > h;)P = !1, h > 0 && (_ *= k), h += 1, s(), n.series.pie.tilt <= .8 && r(), a();
                h >= M && (s(), S.prepend('<div class="error">Could not draw pie with labels contained inside canvas</div>')), t.setSeries && t.insertLegend && (t.setSeries(o), t.insertLegend())
            }
        }

        function p(e) {
            n.series.pie.innerRadius > 0 && (e.save(), innerRadius = n.series.pie.innerRadius > 1 ? n.series.pie.innerRadius : _ * n.series.pie.innerRadius, e.globalCompositeOperation = "destination-out", e.beginPath(), e.fillStyle = n.series.pie.stroke.color, e.arc(0, 0, innerRadius, 0, 2 * Math.PI, !1), e.fill(), e.closePath(), e.restore(), e.save(), e.beginPath(), e.strokeStyle = n.series.pie.stroke.color, e.arc(0, 0, innerRadius, 0, 2 * Math.PI, !1), e.stroke(), e.closePath(), e.restore())
        }

        function d(e, t) {
            for (var i = !1, n = -1, s = e.length, r = s - 1; ++n < s; r = n)(e[n][1] <= t[1] && t[1] < e[r][1] || e[r][1] <= t[1] && t[1] < e[n][1]) && t[0] < (e[r][0] - e[n][0]) * (t[1] - e[n][1]) / (e[r][1] - e[n][1]) + e[n][0] && (i = !i);
            return i
        }

        function f(e, i) {
            for (var n = t.getData(), s = t.getOptions(), r = s.series.pie.radius > 1 ? s.series.pie.radius : _ * s.series.pie.radius, a = 0; a < n.length; ++a) {
                var o = n[a];
                if (o.pie.show) {
                    if (ctx.save(), ctx.beginPath(), ctx.moveTo(0, 0), ctx.arc(0, 0, r, o.startAngle, o.startAngle + o.angle, !1), ctx.closePath(), x = e - T, y = i - E, ctx.isPointInPath) {
                        if (ctx.isPointInPath(e - T, i - E))return ctx.restore(), {
                            datapoint: [o.percent, o.data],
                            dataIndex: 0,
                            series: o,
                            seriesIndex: a
                        }
                    } else if (p1X = r * Math.cos(o.startAngle), p1Y = r * Math.sin(o.startAngle), p2X = r * Math.cos(o.startAngle + o.angle / 4), p2Y = r * Math.sin(o.startAngle + o.angle / 4), p3X = r * Math.cos(o.startAngle + o.angle / 2), p3Y = r * Math.sin(o.startAngle + o.angle / 2), p4X = r * Math.cos(o.startAngle + o.angle / 1.5), p4Y = r * Math.sin(o.startAngle + o.angle / 1.5), p5X = r * Math.cos(o.startAngle + o.angle), p5Y = r * Math.sin(o.startAngle + o.angle), arrPoly = [[0, 0], [p1X, p1Y], [p2X, p2Y], [p3X, p3Y], [p4X, p4Y], [p5X, p5Y]], arrPoint = [x, y], d(arrPoly, arrPoint))return ctx.restore(), {
                        datapoint: [o.percent, o.data],
                        dataIndex: 0,
                        series: o,
                        seriesIndex: a
                    };
                    ctx.restore()
                }
            }
            return null
        }

        function m(e) {
            v("plothover", e)
        }

        function g(e) {
            v("plotclick", e)
        }

        function v(e, i) {
            var s = t.offset(), r = parseInt(i.pageX - s.left), a = parseInt(i.pageY - s.top), o = f(r, a);
            if (n.grid.autoHighlight)for (var l = 0; l < A.length; ++l) {
                var h = A[l];
                h.auto != e || o && h.series == o.series || L(h.series)
            }
            o && b(o.series, e);
            var u = {pageX: i.pageX, pageY: i.pageY};
            S.trigger(e, [u, o])
        }

        function b(e, i) {
            "number" == typeof e && (e = series[e]);
            var n = w(e);
            -1 == n ? (A.push({series: e, auto: i}), t.triggerRedrawOverlay()) : i || (A[n].auto = !1)
        }

        function L(e) {
            null == e && (A = [], t.triggerRedrawOverlay()), "number" == typeof e && (e = series[e]);
            var i = w(e);
            -1 != i && (A.splice(i, 1), t.triggerRedrawOverlay())
        }

        function w(e) {
            for (var t = 0; t < A.length; ++t) {
                var i = A[t];
                if (i.series == e)return t
            }
            return -1
        }

        function O(e, t) {
            function n(e) {
                e.angle < 0 || (t.fillStyle = "rgba(255, 255, 255, " + s.series.pie.highlight.opacity + ")", t.beginPath(), Math.abs(e.angle - 2 * Math.PI) > 1e-9 && t.moveTo(0, 0), t.arc(0, 0, r, e.startAngle, e.startAngle + e.angle, !1), t.closePath(), t.fill())
            }

            var s = e.getOptions(), r = s.series.pie.radius > 1 ? s.series.pie.radius : _ * s.series.pie.radius;
            for (t.save(), t.translate(T, E), t.scale(1, s.series.pie.tilt), i = 0; i < A.length; ++i)n(A[i].series);
            p(t), t.restore()
        }

        var C = null, S = null, _ = null, T = null, E = null, N = 0, P = !0, M = 10, k = .95, F = 0, D = !1, A = [];
        t.hooks.processOptions.push(s), t.hooks.bindEvents.push(r)
    }

    var n = {
        series: {
            pie: {
                show: !1,
                radius: "auto",
                innerRadius: 0,
                startAngle: 1.5,
                tilt: 1,
                offset: {top: 0, left: "auto"},
                stroke: {color: "#FFF", width: 1},
                label: {
                    show: "auto", formatter: function (e, t) {
                        return '<div style="font-size:x-small;text-align:center;padding:2px;color:' + t.color + ';">' + e + "<br/>" + Math.round(t.percent) + "%</div>"
                    }, radius: 1, background: {color: null, opacity: 0}, threshold: 0
                },
                combine: {threshold: -1, color: null, label: "Other"},
                highlight: {opacity: .5}
            }
        }
    };
    e.plot.plugins.push({init: t, options: n, name: "pie", version: "1.0"})
}(jQuery), function (e, t, i) {
    function n(e) {
        var t = {}, n = /^jQuery\d+$/;
        return i.each(e.attributes, function (e, i) {
            i.specified && !n.test(i.name) && (t[i.name] = i.value)
        }), t
    }

    function s(e, n) {
        var s = this, r = i(s);
        if (s.value == r.attr("placeholder") && r.hasClass("placeholder"))if (r.data("placeholder-password")) {
            if (r = r.hide().next().show().attr("id", r.removeAttr("id").data("placeholder-id")), e === !0)return r[0].value = n;
            r.focus()
        } else s.value = "", r.removeClass("placeholder"), s == t.activeElement && s.select()
    }

    function r() {
        var e, t = this, r = i(t), a = this.id;
        if ("" == t.value) {
            if ("password" == t.type) {
                if (!r.data("placeholder-textinput")) {
                    try {
                        e = r.clone().attr({type: "text"})
                    } catch (o) {
                        e = i("<input>").attr(i.extend(n(this), {type: "text"}))
                    }
                    e.removeAttr("name").data({
                        "placeholder-password": !0,
                        "placeholder-id": a
                    }).bind("focus.placeholder", s), r.data({"placeholder-textinput": e, "placeholder-id": a}).before(e)
                }
                r = r.removeAttr("id").hide().prev().attr("id", a).show()
            }
            r.addClass("placeholder"), r[0].value = r.attr("placeholder")
        } else r.removeClass("placeholder")
    }

    var a, o, l = "placeholder" in t.createElement("input"), h = "placeholder" in t.createElement("textarea"), u = i.fn, c = i.valHooks;
    l && h ? (o = u.placeholder = function () {
        return this
    }, o.input = o.textarea = !0) : (o = u.placeholder = function () {
        var e = this;
        return e.filter((l ? "textarea" : ":input") + "[placeholder]").not(".placeholder").bind({
            "focus.placeholder": s,
            "blur.placeholder": r
        }).data("placeholder-enabled", !0).trigger("blur.placeholder"), e
    }, o.input = l, o.textarea = h, a = {
        get: function (e) {
            var t = i(e);
            return t.data("placeholder-enabled") && t.hasClass("placeholder") ? "" : e.value
        }, set: function (e, n) {
            var a = i(e);
            return a.data("placeholder-enabled") ? ("" == n ? (e.value = n, e != t.activeElement && r.call(e)) : a.hasClass("placeholder") ? s.call(e, !0, n) || (e.value = n) : e.value = n, a) : e.value = n
        }
    }, l || (c.input = a), h || (c.textarea = a), i(function () {
        i(t).delegate("form", "submit.placeholder", function () {
            var e = i(".placeholder", this).each(s);
            setTimeout(function () {
                e.each(r)
            }, 10)
        })
    }), i(e).bind("beforeunload.placeholder", function () {
        i(".placeholder").each(function () {
            this.value = ""
        })
    }))
}(this, document, jQuery);
var Model = function (e, t) {
    var i = function (t) {
        this.attributes = Model.Utils.extend({}, t), this.changes = {}, this.errors = new Model.Errors(this), this.uid = [e, Model.UID.generate()].join("-"), Model.Utils.isFunction(this.initialize) && this.initialize()
    };
    return Model.Module.extend.call(i, Model.Module), i._name = e, i.collection = [], i.unique_key = "id", i.extend(Model.Callbacks).extend(Model.ClassMethods), i.prototype = new Model.Base, i.prototype.constructor = i, Model.Utils.isFunction(t) && t.call(i, i, i.prototype), i
};
Model.Callbacks = {
    bind: function (e, t) {
        return this.callbacks = this.callbacks || {}, this.callbacks[e] = this.callbacks[e] || [], this.callbacks[e].push(t), this
    }, trigger: function (e, t) {
        this.callbacks = this.callbacks || {};
        var i = this.callbacks[e];
        if (i)for (var n = 0; n < i.length; n++)i[n].apply(this, t || []);
        return this
    }, unbind: function (e, t) {
        if (this.callbacks = this.callbacks || {}, t)for (var i = this.callbacks[e] || [], n = 0; n < i.length; n++)i[n] === t && this.callbacks[e].splice(n, 1); else delete this.callbacks[e];
        return this
    }
}, Model.ClassMethods = {
    add: function (e) {
        var t = e.id();
        return -1 !== Model.Utils.inArray(this.collection, e) || t && this.find(t) || (this.collection.push(e), this.trigger("add", [e])), this
    }, all: function () {
        return this.collection.slice()
    }, chain: function (e) {
        return Model.Utils.extend({}, this, {collection: e || []})
    }, count: function () {
        return this.all().length
    }, detect: function (e) {
        for (var t, i = this.all(), n = 0, s = i.length; s > n; n++)if (t = i[n], e.call(t, t, n))return t
    }, each: function (e, t) {
        for (var i = this.all(), n = 0, s = i.length; s > n; n++)e.call(t || i[n], i[n], n, i);
        return this
    }, find: function (e) {
        return this.detect(function () {
            return this.id() == e
        })
    }, first: function () {
        return this.all()[0]
    }, load: function (e) {
        if (this._persistence) {
            var t = this;
            this._persistence.read(function (i) {
                for (var n = 0, s = i.length; s > n; n++)t.add(i[n]);
                e && e.call(t, i)
            })
        }
        return this
    }, last: function () {
        var e = this.all();
        return e[e.length - 1]
    }, map: function (e, t) {
        for (var i = this.all(), n = [], s = 0, r = i.length; r > s; s++)n.push(e.call(t || i[s], i[s], s, i));
        return n
    }, persistence: function (e) {
        if (0 == arguments.length)return this._persistence;
        var t = Array.prototype.slice.call(arguments, 1);
        return t.unshift(this), this._persistence = e.apply(e, t), this
    }, pluck: function (e) {
        for (var t = this.all(), i = [], n = 0, s = t.length; s > n; n++)i.push(t[n].attr(e));
        return i
    }, remove: function (e) {
        for (var t, i = 0, n = this.collection.length; n > i; i++)if (this.collection[i] === e) {
            t = i;
            break
        }
        return void 0 != t ? (this.collection.splice(t, 1), this.trigger("remove", [e]), !0) : !1
    }, reverse: function () {
        return this.chain(this.all().reverse())
    }, select: function (e, t) {
        for (var i, n = this.all(), s = [], r = 0, a = n.length; a > r; r++)i = n[r], e.call(t || i, i, r, n) && s.push(i);
        return this.chain(s)
    }, sort: function (e) {
        var t = this.all().sort(e);
        return this.chain(t)
    }, sortBy: function (e) {
        var t = Model.Utils.isFunction(e), i = function (t) {
            return e.call(t)
        };
        return this.sort(function (n, s) {
            var r = t ? i(n) : n.attr(e), a = t ? i(s) : s.attr(e);
            return a > r ? -1 : r > a ? 1 : 0
        })
    }, use: function (e) {
        var t = Array.prototype.slice.call(arguments, 1);
        return t.unshift(this), e.apply(this, t), this
    }
}, Model.Errors = function (e) {
    this.errors = {}, this.model = e
}, Model.Errors.prototype = {
    add: function (e, t) {
        return this.errors[e] || (this.errors[e] = []), this.errors[e].push(t), this
    }, all: function () {
        return this.errors
    }, clear: function () {
        return this.errors = {}, this
    }, each: function (e) {
        for (var t in this.errors)for (var i = 0; i < this.errors[t].length; i++)e.call(this, t, this.errors[t][i]);
        return this
    }, on: function (e) {
        return this.errors[e] || []
    }, size: function () {
        var e = 0;
        return this.each(function () {
            e++
        }), e
    }
}, Model.InstanceMethods = {
    asJSON: function () {
        return this.attr()
    }, attr: function (e, t) {
        if (0 === arguments.length)return Model.Utils.extend({}, this.attributes, this.changes);
        if (2 === arguments.length)return this.attributes[e] === t ? delete this.changes[e] : this.changes[e] = t, this.trigger("change:" + e, [this]), this;
        if ("object" == typeof e) {
            for (var i in e)this.attr(i, e[i]);
            return this.trigger("change", [this]), this
        }
        return e in this.changes ? this.changes[e] : this.attributes[e]
    }, callPersistMethod: function (e, t) {
        var i = this, n = function () {
            "destroy" === e ? i.constructor.remove(i) : i.constructor.add(i)
        }, s = function (s) {
            s && (i.merge(i.changes).reset(), n(), i.trigger(e));
            var r;
            return t && (r = t.apply(i, arguments)), r
        };
        this.constructor._persistence ? this.constructor._persistence[e](this, s) : s.call(this, !0)
    }, destroy: function (e) {
        return this.callPersistMethod("destroy", e), this
    }, id: function () {
        return this.attributes[this.constructor.unique_key]
    }, merge: function (e) {
        return Model.Utils.extend(this.attributes, e), this
    }, newRecord: function () {
        return void 0 === this.id()
    }, reset: function () {
        return this.errors.clear(), this.changes = {}, this
    }, save: function (e) {
        if (this.valid()) {
            var t = this.newRecord() ? "create" : "update";
            this.callPersistMethod(t, e)
        } else e && e(!1);
        return this
    }, valid: function () {
        return this.errors.clear(), this.validate(), 0 === this.errors.size()
    }, validate: function () {
        return this
    }
}, Model.localStorage = function (e) {
    if (!window.localStorage)return {
        create: function (e, t) {
            t(!0)
        }, destroy: function (e, t) {
            t(!0)
        }, read: function (e) {
            e([])
        }, update: function (e, t) {
            t(!0)
        }
    };
    var t = [e._name, "collection"].join("-"), i = function () {
        var e = localStorage[t];
        return e ? JSON.parse(e) : []
    }, n = function (e) {
        localStorage.setItem(t, JSON.stringify(e))
    }, s = function (e) {
        var t = i();
        -1 === Model.Utils.inArray(t, e) && (t.push(e), n(t))
    }, r = function (e) {
        var t = i(), s = Model.Utils.inArray(t, e);
        s > -1 && (t.splice(s, 1), n(t))
    }, a = function (e) {
        localStorage.setItem(e.uid, JSON.stringify(e.asJSON())), s(e.uid)
    };
    return {
        create: function (e, t) {
            a(e), t(!0)
        }, destroy: function (e, t) {
            localStorage.removeItem(e.uid), r(e.uid), t(!0)
        }, read: function (t) {
            if (!t)return !1;
            for (var n, s, r, a = e.map(function () {
                return this.uid
            }), o = i(), l = [], h = 0, u = o.length; u > h; h++)r = o[h], -1 == Model.Utils.inArray(a, r) && (n = JSON.parse(localStorage[r]), s = new e(n), s.uid = r, l.push(s));
            t(l)
        }, update: function (e, t) {
            a(e), t(!0)
        }
    }
}, Model.Log = function () {
    window.console && window.console.log.apply(window.console, arguments)
}, Model.Module = {
    extend: function (e) {
        return Model.Utils.extend(this, e), this
    }, include: function (e) {
        return Model.Utils.extend(this.prototype, e), this
    }
}, Model.REST = function (e, t, i) {
    var n = /:([\w\d]+)/g, s = function () {
        for (var e, i = []; null !== (e = n.exec(t));)i.push(e[1]);
        return i
    }();
    return Model.Utils.extend({
        path: function (e) {
            var i = t;
            return jQuery.each(s, function (t, n) {
                i = i.replace(":" + n, e.attributes[n])
            }), i
        }, create: function (e, t) {
            return this.xhr("POST", this.create_path(e), e, t)
        }, create_path: function (e) {
            return this.path(e)
        }, destroy: function (e, t) {
            return this.xhr("DELETE", this.destroy_path(e), e, t)
        }, destroy_path: function (e) {
            return this.update_path(e)
        }, params: function (e) {
            var t;
            if (e) {
                var i = e.asJSON();
                delete i[e.constructor.unique_key], t = {}, t[e.constructor._name.toLowerCase()] = i
            } else t = null;
            return jQuery.ajaxSettings.data && (t = Model.Utils.extend({}, jQuery.ajaxSettings.data, t)), JSON.stringify(t)
        }, read: function (t) {
            return this.xhr("GET", this.read_path(), null, function (i, n, s) {
                s = jQuery.makeArray(s);
                for (var r = [], a = 0, o = s.length; o > a; a++)r.push(new e(s[a]));
                t(r)
            })
        }, read_path: function () {
            return t
        }, update: function (e, t) {
            return this.xhr("PUT", this.update_path(e), e, t)
        }, update_path: function (e) {
            return [this.path(e), e.id()].join("/")
        }, xhr: function (e, t, i, n) {
            var s = this, r = "GET" == e ? void 0 : this.params(i);
            return jQuery.ajax({
                type: e,
                url: t,
                contentType: "application/json",
                dataType: "json",
                data: r,
                dataFilter: function (e) {
                    return /\S/.test(e) ? e : void 0
                },
                complete: function (e, t) {
                    s.xhrComplete(e, t, i, n)
                }
            })
        }, xhrComplete: function (e, t, i, n) {
            var s = Model.REST["handle" + e.status];
            s && s.call(this, e, t, i);
            var r = "success" === t || "nocontent" === t, a = Model.REST.parseResponseData(e);
            r && i && a && i.attr(a), n && n.call(i, r, e, a)
        }
    }, i)
}, Model.RestPersistence = Model.REST, Model.REST.handle422 = function (e, t, i) {
    var n = Model.REST.parseResponseData(e);
    if (n) {
        i.errors.clear();
        for (var s in n)for (var r = 0; r < n[s].length; r++)i.errors.add(s, n[s][r])
    }
}, Model.REST.parseResponseData = function (e) {
    try {
        return /\S/.test(e.responseText) ? jQuery.parseJSON(e.responseText) : void 0
    } catch (t) {
        Model.Log(t)
    }
}, Model.UID = {
    counter: 0, generate: function () {
        return [(new Date).valueOf(), this.counter++].join("-")
    }, reset: function () {
        return this.counter = 0, this
    }
}, Model.Utils = {
    extend: function (e) {
        for (var t = Array.prototype.slice.call(arguments, 1), i = 0, n = t.length; n > i; i++)for (var s in t[i])e[s] = t[i][s];
        return e
    }, inArray: function (e, t) {
        if (e.indexOf)return e.indexOf(t);
        for (var i = 0, n = e.length; n > i; i++)if (e[i] === t)return i;
        return -1
    }, isFunction: function (e) {
        return "[object Function]" === Object.prototype.toString.call(e)
    }
}, Model.VERSION = "0.11.0", Model.Base = function () {
    function e() {
    }

    return e.prototype = Model.Utils.extend({}, Model.Callbacks, Model.InstanceMethods), e
}(), !function (e, t, i) {
    function n(t, i) {
        this.element = e(t), this.settings = e.extend({}, r, i), this._defaults = r, this._name = s, this.init()
    }

    var s = "metisMenu", r = {toggle: !0, doubleTapToGo: !1};
    n.prototype = {
        init: function () {
            var t = this.element, n = this.settings.toggle, r = this;
            this.isIE() <= 9 ? (t.find("li.active").has("ul").children("ul").collapse("show"), t.find("li").not(".active").has("ul").children("ul").collapse("hide")) : (t.find("li.active").has("ul").children("ul").addClass("collapse in"), t.find("li").not(".active").has("ul").children("ul").addClass("collapse")), r.settings.doubleTapToGo && t.find("li.active").has("ul").children("a").addClass("doubleTapToGo"), t.find("li").has("ul").children("a").on("click." + s, function (t) {
                return t.preventDefault(), r.settings.doubleTapToGo && r.doubleTapToGo(e(this)) && "#" !== e(this).attr("href") && "" !== e(this).attr("href") ? (t.stopPropagation(), void(i.location = e(this).attr("href"))) : (e(this).parent("li").toggleClass("active").children("ul").collapse("toggle"), void(n && e(this).parent("li").siblings().removeClass("active").children("ul.in").collapse("hide")))
            })
        }, isIE: function () {
            for (var e, t = 3, n = i.createElement("div"), s = n.getElementsByTagName("i"); n.innerHTML = "<!--[if gt IE " + ++t + "]><i></i><![endif]-->", s[0];)return t > 4 ? t : e
        }, doubleTapToGo: function (e) {
            var t = this.element;
            return e.hasClass("doubleTapToGo") ? (e.removeClass("doubleTapToGo"), !0) : e.parent().children("ul").length ? (t.find(".doubleTapToGo").removeClass("doubleTapToGo"), e.addClass("doubleTapToGo"), !1) : void 0
        }, remove: function () {
            this.element.off("." + s), this.element.removeData(s)
        }
    }, e.fn[s] = function (t) {
        return this.each(function () {
            var i = e(this);
            i.data(s) && i.data(s).remove(), i.data(s, new n(this, t))
        }), this
    }
}(jQuery, window, document), jQuery(function (e) {
    window.NestedFormEvents = function () {
        this.addFields = e.proxy(this.addFields, this), this.removeFields = e.proxy(this.removeFields, this)
    }, NestedFormEvents.prototype = {
        addFields: function (t) {
            var i = t.currentTarget, n = e(i).data("association"), s = e("#" + e(i).data("blueprint-id")), r = s.data("blueprint"), a = (e(i).closest(".fields").closestChild("input, textarea, select").eq(0).attr("name") || "").replace(new RegExp("[[a-z_]+]$"), "");
            if (a)for (var o = a.match(/[a-z_]+_attributes/g) || [], l = a.match(/[0-9]+/g) || [], h = 0; h < o.length; h++)l[h] && (r = r.replace(new RegExp("(_" + o[h] + ")_.+?_", "g"), "$1_" + l[h] + "_"), r = r.replace(new RegExp("(\\[" + o[h] + "\\])\\[.+?\\]", "g"), "$1[" + l[h] + "]"));
            var u = new RegExp("new_" + n, "g"), c = (new Date).getTime();
            r = r.replace(u, c);
            var p = this.insertFields(r, n, i);
            return p.trigger({type: "nested:fieldAdded", field: p}).trigger({
                type: "nested:fieldAdded:" + n,
                field: p
            }), !1
        }, insertFields: function (t, i, n) {
            return e(t).insertBefore(n)
        }, removeFields: function (t) {
            var i = e(t.currentTarget), n = i.data("association"), s = i.prev("input[type=hidden]");
            s.val("1");
            var r = i.closest(".fields");
            return r.hide(), r.trigger({type: "nested:fieldRemoved", field: r}).trigger({
                type: "nested:fieldRemoved:" + n,
                field: r
            }), !1
        }
    }, window.nestedFormEvents = new NestedFormEvents, e(document).delegate("form a.add_nested_fields", "click", nestedFormEvents.addFields).delegate("form a.remove_nested_fields", "click", nestedFormEvents.removeFields)
}), /*
 * Copyright 2011, Tobias Lindig
 *
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 */
    function (e) {
        e.fn.closestChild = function (t) {
            if (t && "" != t) {
                var i = [];
                for (i.push(this); i.length > 0;)for (var n = i.shift(), s = n.children(), r = 0; r < s.length; ++r) {
                    var a = e(s[r]);
                    if (a.is(t))return a;
                    i.push(a)
                }
            }
            return e()
        }
    }(jQuery), function () {
    function e(e) {
        function t(t, i, n, s, r, a) {
            for (; r >= 0 && a > r; r += e) {
                var o = s ? s[r] : r;
                n = i(n, t[o], o, t)
            }
            return n
        }

        return function (i, n, s, r) {
            n = b(n, r, 4);
            var a = !_(i) && v.keys(i), o = (a || i).length, l = e > 0 ? 0 : o - 1;
            return arguments.length < 3 && (s = i[a ? a[l] : l], l += e), t(i, n, s, a, l, o)
        }
    }

    function t(e) {
        return function (t, i, n) {
            i = L(i, n);
            for (var s = S(t), r = e > 0 ? 0 : s - 1; r >= 0 && s > r; r += e)if (i(t[r], r, t))return r;
            return -1
        }
    }

    function i(e, t, i) {
        return function (n, s, r) {
            var a = 0, o = S(n);
            if ("number" == typeof r) e > 0 ? a = r >= 0 ? r : Math.max(r + o, a) : o = r >= 0 ? Math.min(r + 1, o) : r + o + 1; else if (i && r && o)return r = i(n, s), n[r] === s ? r : -1;
            if (s !== s)return r = t(u.call(n, a, o), v.isNaN), r >= 0 ? r + a : -1;
            for (r = e > 0 ? a : o - 1; r >= 0 && o > r; r += e)if (n[r] === s)return r;
            return -1
        }
    }

    function n(e, t) {
        var i = M.length, n = e.constructor, s = v.isFunction(n) && n.prototype || o, r = "constructor";
        for (v.has(e, r) && !v.contains(t, r) && t.push(r); i--;)r = M[i], r in e && e[r] !== s[r] && !v.contains(t, r) && t.push(r)
    }

    var s = this, r = s._, a = Array.prototype, o = Object.prototype, l = Function.prototype, h = a.push, u = a.slice, c = o.toString, p = o.hasOwnProperty, d = Array.isArray, f = Object.keys, m = l.bind, g = Object.create, y = function () {
    }, v = function (e) {
        return e instanceof v ? e : this instanceof v ? void(this._wrapped = e) : new v(e)
    };
    "undefined" != typeof exports ? ("undefined" != typeof module && module.exports && (exports = module.exports = v), exports._ = v) : s._ = v, v.VERSION = "1.8.3";
    var b = function (e, t, i) {
        if (void 0 === t)return e;
        switch (null == i ? 3 : i) {
            case 1:
                return function (i) {
                    return e.call(t, i)
                };
            case 2:
                return function (i, n) {
                    return e.call(t, i, n)
                };
            case 3:
                return function (i, n, s) {
                    return e.call(t, i, n, s)
                };
            case 4:
                return function (i, n, s, r) {
                    return e.call(t, i, n, s, r)
                }
        }
        return function () {
            return e.apply(t, arguments)
        }
    }, L = function (e, t, i) {
        return null == e ? v.identity : v.isFunction(e) ? b(e, t, i) : v.isObject(e) ? v.matcher(e) : v.property(e)
    };
    v.iteratee = function (e, t) {
        return L(e, t, 1 / 0)
    };
    var w = function (e, t) {
        return function (i) {
            var n = arguments.length;
            if (2 > n || null == i)return i;
            for (var s = 1; n > s; s++)for (var r = arguments[s], a = e(r), o = a.length, l = 0; o > l; l++) {
                var h = a[l];
                t && void 0 !== i[h] || (i[h] = r[h])
            }
            return i
        }
    }, O = function (e) {
        if (!v.isObject(e))return {};
        if (g)return g(e);
        y.prototype = e;
        var t = new y;
        return y.prototype = null, t
    }, C = function (e) {
        return function (t) {
            return null == t ? void 0 : t[e]
        }
    }, x = Math.pow(2, 53) - 1, S = C("length"), _ = function (e) {
        var t = S(e);
        return "number" == typeof t && t >= 0 && x >= t
    };
    v.each = v.forEach = function (e, t, i) {
        t = b(t, i);
        var n, s;
        if (_(e))for (n = 0, s = e.length; s > n; n++)t(e[n], n, e); else {
            var r = v.keys(e);
            for (n = 0, s = r.length; s > n; n++)t(e[r[n]], r[n], e)
        }
        return e
    }, v.map = v.collect = function (e, t, i) {
        t = L(t, i);
        for (var n = !_(e) && v.keys(e), s = (n || e).length, r = Array(s), a = 0; s > a; a++) {
            var o = n ? n[a] : a;
            r[a] = t(e[o], o, e)
        }
        return r
    }, v.reduce = v.foldl = v.inject = e(1), v.reduceRight = v.foldr = e(-1), v.find = v.detect = function (e, t, i) {
        var n;
        return n = _(e) ? v.findIndex(e, t, i) : v.findKey(e, t, i), void 0 !== n && -1 !== n ? e[n] : void 0
    }, v.filter = v.select = function (e, t, i) {
        var n = [];
        return t = L(t, i), v.each(e, function (e, i, s) {
            t(e, i, s) && n.push(e)
        }), n
    }, v.reject = function (e, t, i) {
        return v.filter(e, v.negate(L(t)), i)
    }, v.every = v.all = function (e, t, i) {
        t = L(t, i);
        for (var n = !_(e) && v.keys(e), s = (n || e).length, r = 0; s > r; r++) {
            var a = n ? n[r] : r;
            if (!t(e[a], a, e))return !1
        }
        return !0
    }, v.some = v.any = function (e, t, i) {
        t = L(t, i);
        for (var n = !_(e) && v.keys(e), s = (n || e).length, r = 0; s > r; r++) {
            var a = n ? n[r] : r;
            if (t(e[a], a, e))return !0
        }
        return !1
    }, v.contains = v.includes = v.include = function (e, t, i, n) {
        return _(e) || (e = v.values(e)), ("number" != typeof i || n) && (i = 0), v.indexOf(e, t, i) >= 0
    }, v.invoke = function (e, t) {
        var i = u.call(arguments, 2), n = v.isFunction(t);
        return v.map(e, function (e) {
            var s = n ? t : e[t];
            return null == s ? s : s.apply(e, i)
        })
    }, v.pluck = function (e, t) {
        return v.map(e, v.property(t))
    }, v.where = function (e, t) {
        return v.filter(e, v.matcher(t))
    }, v.findWhere = function (e, t) {
        return v.find(e, v.matcher(t))
    }, v.max = function (e, t, i) {
        var n, s, r = -1 / 0, a = -1 / 0;
        if (null == t && null != e) {
            e = _(e) ? e : v.values(e);
            for (var o = 0, l = e.length; l > o; o++)n = e[o], n > r && (r = n)
        } else t = L(t, i), v.each(e, function (e, i, n) {
            s = t(e, i, n), (s > a || s === -1 / 0 && r === -1 / 0) && (r = e, a = s)
        });
        return r
    }, v.min = function (e, t, i) {
        var n, s, r = 1 / 0, a = 1 / 0;
        if (null == t && null != e) {
            e = _(e) ? e : v.values(e);
            for (var o = 0, l = e.length; l > o; o++)n = e[o], r > n && (r = n)
        } else t = L(t, i), v.each(e, function (e, i, n) {
            s = t(e, i, n), (a > s || 1 / 0 === s && 1 / 0 === r) && (r = e, a = s)
        });
        return r
    }, v.shuffle = function (e) {
        for (var t, i = _(e) ? e : v.values(e), n = i.length, s = Array(n), r = 0; n > r; r++)t = v.random(0, r), t !== r && (s[r] = s[t]), s[t] = i[r];
        return s
    }, v.sample = function (e, t, i) {
        return null == t || i ? (_(e) || (e = v.values(e)), e[v.random(e.length - 1)]) : v.shuffle(e).slice(0, Math.max(0, t))
    }, v.sortBy = function (e, t, i) {
        return t = L(t, i), v.pluck(v.map(e, function (e, i, n) {
            return {value: e, index: i, criteria: t(e, i, n)}
        }).sort(function (e, t) {
            var i = e.criteria, n = t.criteria;
            if (i !== n) {
                if (i > n || void 0 === i)return 1;
                if (n > i || void 0 === n)return -1
            }
            return e.index - t.index
        }), "value")
    };
    var T = function (e) {
        return function (t, i, n) {
            var s = {};
            return i = L(i, n), v.each(t, function (n, r) {
                var a = i(n, r, t);
                e(s, n, a)
            }), s
        }
    };
    v.groupBy = T(function (e, t, i) {
        v.has(e, i) ? e[i].push(t) : e[i] = [t]
    }), v.indexBy = T(function (e, t, i) {
        e[i] = t
    }), v.countBy = T(function (e, t, i) {
        v.has(e, i) ? e[i]++ : e[i] = 1
    }), v.toArray = function (e) {
        return e ? v.isArray(e) ? u.call(e) : _(e) ? v.map(e, v.identity) : v.values(e) : []
    }, v.size = function (e) {
        return null == e ? 0 : _(e) ? e.length : v.keys(e).length
    }, v.partition = function (e, t, i) {
        t = L(t, i);
        var n = [], s = [];
        return v.each(e, function (e, i, r) {
            (t(e, i, r) ? n : s).push(e)
        }), [n, s]
    }, v.first = v.head = v.take = function (e, t, i) {
        return null == e ? void 0 : null == t || i ? e[0] : v.initial(e, e.length - t)
    }, v.initial = function (e, t, i) {
        return u.call(e, 0, Math.max(0, e.length - (null == t || i ? 1 : t)))
    }, v.last = function (e, t, i) {
        return null == e ? void 0 : null == t || i ? e[e.length - 1] : v.rest(e, Math.max(0, e.length - t))
    }, v.rest = v.tail = v.drop = function (e, t, i) {
        return u.call(e, null == t || i ? 1 : t)
    }, v.compact = function (e) {
        return v.filter(e, v.identity)
    };
    var E = function (e, t, i, n) {
        for (var s = [], r = 0, a = n || 0, o = S(e); o > a; a++) {
            var l = e[a];
            if (_(l) && (v.isArray(l) || v.isArguments(l))) {
                t || (l = E(l, t, i));
                var h = 0, u = l.length;
                for (s.length += u; u > h;)s[r++] = l[h++]
            } else i || (s[r++] = l)
        }
        return s
    };
    v.flatten = function (e, t) {
        return E(e, t, !1)
    }, v.without = function (e) {
        return v.difference(e, u.call(arguments, 1))
    }, v.uniq = v.unique = function (e, t, i, n) {
        v.isBoolean(t) || (n = i, i = t, t = !1), null != i && (i = L(i, n));
        for (var s = [], r = [], a = 0, o = S(e); o > a; a++) {
            var l = e[a], h = i ? i(l, a, e) : l;
            t ? (a && r === h || s.push(l), r = h) : i ? v.contains(r, h) || (r.push(h), s.push(l)) : v.contains(s, l) || s.push(l)
        }
        return s
    }, v.union = function () {
        return v.uniq(E(arguments, !0, !0))
    }, v.intersection = function (e) {
        for (var t = [], i = arguments.length, n = 0, s = S(e); s > n; n++) {
            var r = e[n];
            if (!v.contains(t, r)) {
                for (var a = 1; i > a && v.contains(arguments[a], r); a++);
                a === i && t.push(r)
            }
        }
        return t
    }, v.difference = function (e) {
        var t = E(arguments, !0, !0, 1);
        return v.filter(e, function (e) {
            return !v.contains(t, e)
        })
    }, v.zip = function () {
        return v.unzip(arguments)
    }, v.unzip = function (e) {
        for (var t = e && v.max(e, S).length || 0, i = Array(t), n = 0; t > n; n++)i[n] = v.pluck(e, n);
        return i
    }, v.object = function (e, t) {
        for (var i = {}, n = 0, s = S(e); s > n; n++)t ? i[e[n]] = t[n] : i[e[n][0]] = e[n][1];
        return i
    }, v.findIndex = t(1), v.findLastIndex = t(-1), v.sortedIndex = function (e, t, i, n) {
        i = L(i, n, 1);
        for (var s = i(t), r = 0, a = S(e); a > r;) {
            var o = Math.floor((r + a) / 2);
            i(e[o]) < s ? r = o + 1 : a = o
        }
        return r
    }, v.indexOf = i(1, v.findIndex, v.sortedIndex), v.lastIndexOf = i(-1, v.findLastIndex), v.range = function (e, t, i) {
        null == t && (t = e || 0, e = 0), i = i || 1;
        for (var n = Math.max(Math.ceil((t - e) / i), 0), s = Array(n), r = 0; n > r; r++, e += i)s[r] = e;
        return s
    };
    var N = function (e, t, i, n, s) {
        if (!(n instanceof t))return e.apply(i, s);
        var r = O(e.prototype), a = e.apply(r, s);
        return v.isObject(a) ? a : r
    };
    v.bind = function (e, t) {
        if (m && e.bind === m)return m.apply(e, u.call(arguments, 1));
        if (!v.isFunction(e))throw new TypeError("Bind must be called on a function");
        var i = u.call(arguments, 2), n = function () {
            return N(e, n, t, this, i.concat(u.call(arguments)))
        };
        return n
    }, v.partial = function (e) {
        var t = u.call(arguments, 1), i = function () {
            for (var n = 0, s = t.length, r = Array(s), a = 0; s > a; a++)r[a] = t[a] === v ? arguments[n++] : t[a];
            for (; n < arguments.length;)r.push(arguments[n++]);
            return N(e, i, this, this, r)
        };
        return i
    }, v.bindAll = function (e) {
        var t, i, n = arguments.length;
        if (1 >= n)throw new Error("bindAll must be passed function names");
        for (t = 1; n > t; t++)i = arguments[t], e[i] = v.bind(e[i], e);
        return e
    }, v.memoize = function (e, t) {
        var i = function (n) {
            var s = i.cache, r = "" + (t ? t.apply(this, arguments) : n);
            return v.has(s, r) || (s[r] = e.apply(this, arguments)), s[r]
        };
        return i.cache = {}, i
    }, v.delay = function (e, t) {
        var i = u.call(arguments, 2);
        return setTimeout(function () {
            return e.apply(null, i)
        }, t)
    }, v.defer = v.partial(v.delay, v, 1), v.throttle = function (e, t, i) {
        var n, s, r, a = null, o = 0;
        i || (i = {});
        var l = function () {
            o = i.leading === !1 ? 0 : v.now(), a = null, r = e.apply(n, s), a || (n = s = null)
        };
        return function () {
            var h = v.now();
            o || i.leading !== !1 || (o = h);
            var u = t - (h - o);
            return n = this, s = arguments, 0 >= u || u > t ? (a && (clearTimeout(a), a = null), o = h, r = e.apply(n, s), a || (n = s = null)) : a || i.trailing === !1 || (a = setTimeout(l, u)), r
        }
    }, v.debounce = function (e, t, i) {
        var n, s, r, a, o, l = function () {
            var h = v.now() - a;
            t > h && h >= 0 ? n = setTimeout(l, t - h) : (n = null, i || (o = e.apply(r, s), n || (r = s = null)))
        };
        return function () {
            r = this, s = arguments, a = v.now();
            var h = i && !n;
            return n || (n = setTimeout(l, t)), h && (o = e.apply(r, s), r = s = null), o
        }
    }, v.wrap = function (e, t) {
        return v.partial(t, e)
    }, v.negate = function (e) {
        return function () {
            return !e.apply(this, arguments)
        }
    }, v.compose = function () {
        var e = arguments, t = e.length - 1;
        return function () {
            for (var i = t, n = e[t].apply(this, arguments); i--;)n = e[i].call(this, n);
            return n
        }
    }, v.after = function (e, t) {
        return function () {
            return --e < 1 ? t.apply(this, arguments) : void 0
        }
    }, v.before = function (e, t) {
        var i;
        return function () {
            return --e > 0 && (i = t.apply(this, arguments)), 1 >= e && (t = null), i
        }
    }, v.once = v.partial(v.before, 2);
    var P = !{toString: null}.propertyIsEnumerable("toString"), M = ["valueOf", "isPrototypeOf", "toString", "propertyIsEnumerable", "hasOwnProperty", "toLocaleString"];
    v.keys = function (e) {
        if (!v.isObject(e))return [];
        if (f)return f(e);
        var t = [];
        for (var i in e)v.has(e, i) && t.push(i);
        return P && n(e, t), t
    }, v.allKeys = function (e) {
        if (!v.isObject(e))return [];
        var t = [];
        for (var i in e)t.push(i);
        return P && n(e, t), t
    }, v.values = function (e) {
        for (var t = v.keys(e), i = t.length, n = Array(i), s = 0; i > s; s++)n[s] = e[t[s]];
        return n
    }, v.mapObject = function (e, t, i) {
        t = L(t, i);
        for (var n, s = v.keys(e), r = s.length, a = {}, o = 0; r > o; o++)n = s[o], a[n] = t(e[n], n, e);
        return a
    }, v.pairs = function (e) {
        for (var t = v.keys(e), i = t.length, n = Array(i), s = 0; i > s; s++)n[s] = [t[s], e[t[s]]];
        return n
    }, v.invert = function (e) {
        for (var t = {}, i = v.keys(e), n = 0, s = i.length; s > n; n++)t[e[i[n]]] = i[n];
        return t
    }, v.functions = v.methods = function (e) {
        var t = [];
        for (var i in e)v.isFunction(e[i]) && t.push(i);
        return t.sort()
    }, v.extend = w(v.allKeys), v.extendOwn = v.assign = w(v.keys), v.findKey = function (e, t, i) {
        t = L(t, i);
        for (var n, s = v.keys(e), r = 0, a = s.length; a > r; r++)if (n = s[r], t(e[n], n, e))return n
    }, v.pick = function (e, t, i) {
        var n, s, r = {}, a = e;
        if (null == a)return r;
        v.isFunction(t) ? (s = v.allKeys(a), n = b(t, i)) : (s = E(arguments, !1, !1, 1), n = function (e, t, i) {
            return t in i
        }, a = Object(a));
        for (var o = 0, l = s.length; l > o; o++) {
            var h = s[o], u = a[h];
            n(u, h, a) && (r[h] = u)
        }
        return r
    }, v.omit = function (e, t, i) {
        if (v.isFunction(t)) t = v.negate(t); else {
            var n = v.map(E(arguments, !1, !1, 1), String);
            t = function (e, t) {
                return !v.contains(n, t)
            }
        }
        return v.pick(e, t, i)
    }, v.defaults = w(v.allKeys, !0), v.create = function (e, t) {
        var i = O(e);
        return t && v.extendOwn(i, t), i
    }, v.clone = function (e) {
        return v.isObject(e) ? v.isArray(e) ? e.slice() : v.extend({}, e) : e
    }, v.tap = function (e, t) {
        return t(e), e
    }, v.isMatch = function (e, t) {
        var i = v.keys(t), n = i.length;
        if (null == e)return !n;
        for (var s = Object(e), r = 0; n > r; r++) {
            var a = i[r];
            if (t[a] !== s[a] || !(a in s))return !1
        }
        return !0
    };
    var k = function (e, t, i, n) {
        if (e === t)return 0 !== e || 1 / e === 1 / t;
        if (null == e || null == t)return e === t;
        e instanceof v && (e = e._wrapped), t instanceof v && (t = t._wrapped);
        var s = c.call(e);
        if (s !== c.call(t))return !1;
        switch (s) {
            case"[object RegExp]":
            case"[object String]":
                return "" + e == "" + t;
            case"[object Number]":
                return +e !== +e ? +t !== +t : 0 === +e ? 1 / +e === 1 / t : +e === +t;
            case"[object Date]":
            case"[object Boolean]":
                return +e === +t
        }
        var r = "[object Array]" === s;
        if (!r) {
            if ("object" != typeof e || "object" != typeof t)return !1;
            var a = e.constructor, o = t.constructor;
            if (a !== o && !(v.isFunction(a) && a instanceof a && v.isFunction(o) && o instanceof o) && "constructor" in e && "constructor" in t)return !1
        }
        i = i || [], n = n || [];
        for (var l = i.length; l--;)if (i[l] === e)return n[l] === t;
        if (i.push(e), n.push(t), r) {
            if (l = e.length, l !== t.length)return !1;
            for (; l--;)if (!k(e[l], t[l], i, n))return !1
        } else {
            var h, u = v.keys(e);
            if (l = u.length, v.keys(t).length !== l)return !1;
            for (; l--;)if (h = u[l], !v.has(t, h) || !k(e[h], t[h], i, n))return !1
        }
        return i.pop(), n.pop(), !0
    };
    v.isEqual = function (e, t) {
        return k(e, t)
    }, v.isEmpty = function (e) {
        return null == e ? !0 : _(e) && (v.isArray(e) || v.isString(e) || v.isArguments(e)) ? 0 === e.length : 0 === v.keys(e).length
    }, v.isElement = function (e) {
        return !(!e || 1 !== e.nodeType)
    }, v.isArray = d || function (e) {
            return "[object Array]" === c.call(e)
        }, v.isObject = function (e) {
        var t = typeof e;
        return "function" === t || "object" === t && !!e
    }, v.each(["Arguments", "Function", "String", "Number", "Date", "RegExp", "Error"], function (e) {
        v["is" + e] = function (t) {
            return c.call(t) === "[object " + e + "]"
        }
    }), v.isArguments(arguments) || (v.isArguments = function (e) {
        return v.has(e, "callee")
    }), "function" != typeof/./ && "object" != typeof Int8Array && (v.isFunction = function (e) {
        return "function" == typeof e || !1
    }), v.isFinite = function (e) {
        return isFinite(e) && !isNaN(parseFloat(e))
    }, v.isNaN = function (e) {
        return v.isNumber(e) && e !== +e
    }, v.isBoolean = function (e) {
        return e === !0 || e === !1 || "[object Boolean]" === c.call(e)
    }, v.isNull = function (e) {
        return null === e
    }, v.isUndefined = function (e) {
        return void 0 === e
    }, v.has = function (e, t) {
        return null != e && p.call(e, t)
    }, v.noConflict = function () {
        return s._ = r, this
    }, v.identity = function (e) {
        return e
    }, v.constant = function (e) {
        return function () {
            return e
        }
    }, v.noop = function () {
    }, v.property = C, v.propertyOf = function (e) {
        return null == e ? function () {
        } : function (t) {
            return e[t]
        }
    }, v.matcher = v.matches = function (e) {
        return e = v.extendOwn({}, e), function (t) {
            return v.isMatch(t, e)
        }
    }, v.times = function (e, t, i) {
        var n = Array(Math.max(0, e));
        t = b(t, i, 1);
        for (var s = 0; e > s; s++)n[s] = t(s);
        return n
    }, v.random = function (e, t) {
        return null == t && (t = e, e = 0), e + Math.floor(Math.random() * (t - e + 1))
    }, v.now = Date.now || function () {
            return (new Date).getTime()
        };
    var F = {
        "&": "&amp;",
        "<": "&lt;",
        ">": "&gt;",
        '"': "&quot;",
        "'": "&#x27;",
        "`": "&#x60;"
    }, D = v.invert(F), A = function (e) {
        var t = function (t) {
            return e[t]
        }, i = "(?:" + v.keys(e).join("|") + ")", n = RegExp(i), s = RegExp(i, "g");
        return function (e) {
            return e = null == e ? "" : "" + e, n.test(e) ? e.replace(s, t) : e
        }
    };
    v.escape = A(F), v.unescape = A(D), v.result = function (e, t, i) {
        var n = null == e ? void 0 : e[t];
        return void 0 === n && (n = i), v.isFunction(n) ? n.call(e) : n
    };
    var I = 0;
    v.uniqueId = function (e) {
        var t = ++I + "";
        return e ? e + t : t
    }, v.templateSettings = {evaluate: /<%([\s\S]+?)%>/g, interpolate: /<%=([\s\S]+?)%>/g, escape: /<%-([\s\S]+?)%>/g};
    var R = /(.)^/, z = {
        "'": "'",
        "\\": "\\",
        "\r": "r",
        "\n": "n",
        "\u2028": "u2028",
        "\u2029": "u2029"
    }, B = /\\|'|\r|\n|\u2028|\u2029/g, U = function (e) {
        return "\\" + z[e]
    };
    v.template = function (e, t, i) {
        !t && i && (t = i), t = v.defaults({}, t, v.templateSettings);
        var n = RegExp([(t.escape || R).source, (t.interpolate || R).source, (t.evaluate || R).source].join("|") + "|$", "g"), s = 0, r = "__p+='";
        e.replace(n, function (t, i, n, a, o) {
            return r += e.slice(s, o).replace(B, U), s = o + t.length, i ? r += "'+\n((__t=(" + i + "))==null?'':_.escape(__t))+\n'" : n ? r += "'+\n((__t=(" + n + "))==null?'':__t)+\n'" : a && (r += "';\n" + a + "\n__p+='"), t
        }), r += "';\n", t.variable || (r = "with(obj||{}){\n" + r + "}\n"), r = "var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n" + r + "return __p;\n";
        try {
            var a = new Function(t.variable || "obj", "_", r)
        } catch (o) {
            throw o.source = r, o
        }
        var l = function (e) {
            return a.call(this, e, v)
        }, h = t.variable || "obj";
        return l.source = "function(" + h + "){\n" + r + "}", l
    }, v.chain = function (e) {
        var t = v(e);
        return t._chain = !0, t
    };
    var j = function (e, t) {
        return e._chain ? v(t).chain() : t
    };
    v.mixin = function (e) {
        v.each(v.functions(e), function (t) {
            var i = v[t] = e[t];
            v.prototype[t] = function () {
                var e = [this._wrapped];
                return h.apply(e, arguments), j(this, i.apply(v, e))
            }
        })
    }, v.mixin(v), v.each(["pop", "push", "reverse", "shift", "sort", "splice", "unshift"], function (e) {
        var t = a[e];
        v.prototype[e] = function () {
            var i = this._wrapped;
            return t.apply(i, arguments), "shift" !== e && "splice" !== e || 0 !== i.length || delete i[0], j(this, i)
        }
    }), v.each(["concat", "join", "slice"], function (e) {
        var t = a[e];
        v.prototype[e] = function () {
            return j(this, t.apply(this._wrapped, arguments))
        }
    }), v.prototype.value = function () {
        return this._wrapped
    }, v.prototype.valueOf = v.prototype.toJSON = v.prototype.value, v.prototype.toString = function () {
        return "" + this._wrapped
    }, "function" == typeof define && define.amd && define("underscore", [], function () {
        return v
    })
}.call(this);
var BUTTON_ICONS = {
    Add: [3, 5],
    Edit: [9, 9],
    Save: [2, 8],
    Delete: [7, 6],
    Cancel: [5, 3],
    Back: [11, 4],
    Email: [1, 1],
    Call: [3, 7],
    Marker: [8, 10],
    Move: [1, 11],
    Pin: [9, 10],
    List: [6, 3],
    Map: [5, 2],
    Graph: [2, 11],
    MicelloLogo: [3, 11],
    APLayer: [4, 11],
    GraphLayer: [5, 11],
    MapLayer: [6, 11],
    TrajLayer: [7, 11],
    Apply: [4, 9],
    Rot180: [4, 12],
    Rot90R: [5, 12],
    Rot90L: [6, 12],
    Measure: [7, 12]
}, BUTTON_PANEL = "https://ncpasst.s3.amazonaws.com/assets/palette-29676d32142b83e24a93d46d45e5267a.png", HOVERED_BUTTON_PANEL = "https://ncpasst.s3.amazonaws.com/assets/palette_hover.png", TRANSPARENT_IMG = "https://ncpasst.s3.amazonaws.com/assets/pixel_transparent-e7d9deb87ab731375f0c37284e29ad7c.gif", buttonCounter = 0, checBoxCounter = 0;
jQuery.support.cors = !0;
var data_table_counter = 0, ICON_SHOW_MORE = "https://ncpasst.s3.amazonaws.com/assets/icon_show_comments-17a668d2f63de9eb10afbf99ecd0485f.png", ICON_HIDE_MORE = "https://ncpasst.s3.amazonaws.com/assets/icon_hide_comments-7a35e7316fa1549346171388fd184d32.png";
$.fn.dataTableExt.oApi.fnGetHiddenTrNodes = function (e) {
    for (var t = this.oApi._fnGetTrNodes(e), i = $("tbody tr", e.nTable), n = 0; n < i.length; n++) {
        var s = jQuery.inArray(i[n], t);
        -1 != s && t.splice(s, 1)
    }
    return t
};
var PSFAButtonCounter = 0, mapButtonPanels = {}, tableButtonPanels = {}, panelCounter = 0, sliderCounter = 0;